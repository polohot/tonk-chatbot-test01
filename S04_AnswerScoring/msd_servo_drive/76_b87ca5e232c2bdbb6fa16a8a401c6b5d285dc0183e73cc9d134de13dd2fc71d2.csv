,NODE_FILE_NAME,NODE_NUMBER,NODE_HASH,NODE_TEXT,Q,A_NUMBER,A,helpfulness,correctness,coherence,complexity,verbosity
0,msd_servo_drive.txt,76,b87ca5e232c2bdbb6fa16a8a401c6b5d285dc0183e73cc9d134de13dd2fc71d2,"MOOG ID No.:CB40859-001 Date:11/2020

MSD ServoDrive - DeviceHelp 267

# 8 Motion profile

MOOG ID No.:CB40859-001 Date:11/2020 MSD ServoDrive - DeviceHelp 268

# Deceleration

With ...

- P 194 - MPRO_TAB_TDec (for torque control) or
- P 197 - MPRO_TAB_SDec (for speed control) or
- P 200 - MPRO_TAB_PDec (for position control)

and indexes 0–15, the deceleration for each individual motion task can be defined. The input must not be zero.

# Wait time in Auto mode

P 204 - MPRO_TAB_WaitTime is used to define the wait time before the next motion task is carried out.

# Maximum table index in Auto mode

P 206[0] - MPRO_Tab_MaxIdx is used to define the table index up to which driving jobs will be carried out in one of the auto modes.

# Current table index

P 207[0] - MPRO_Tab_ActIdx will show the index for the motion task that is currently active. If parameter P 205 MPRO_TAB_Mode is set to “Para(0)”, a driving set can be entered and approached directly.

# Activation of reference table

The following procedures can be used in order to activate the setpoint table for operation.

|ID|Index Name|Unit|Description|
|---|---|---|---|
|193|MPRO_TAB_TAcc|TAB: Torque mode acceleration|Nm/ms|
|193|0|MPRO_TAB_TAcc|Nm/ms|
|193|1 - 15|MPRO_TAB_TAcc|Nm/ms|
|194|MPRO_TAB_TDec|TAB: Torque mode deceleration| |
|194|0|MPRO_TAB_TDec|Nm/ms|
|194|1 - 15|MPRO_TAB_TDec|Nm/ms|

# Table 8.23: Activation of table references

# Table 8.24: “Setpoint table settings” parameters

# Table 8.24: “Setpoint table settings” parameters (continue)

|ID|Index Name|Unit|Description|ID|Index Name|Unit|Description|
|---|---|---|---|---|---|---|---|
|195|MPRO_TAB_TRef|Nm|TAB: Torque mode reference value|208|MPRO_TAB_OutputNo| |OSD TAB: actual table index and target|
|195|MPRO_TAB_TRef|Nm| |208|MPRO_TAB_OutputNo| | |
|196|MPRO_TAB_SAcc|rev/min/s|TAB: Speed mode acceleration|269|MPRO_TAB_Ctrl| |TAB: control word|
|196|MPRO_TAB_SAcc|rev/min/s| | | | | |
|197|MPRO_TAB_SDec|rev/min/s|TAB: Speed mode deceleration| | | | |
|197|MPRO_TAB_SDec|rev/min/s| | | | | |
|198|MPRO_TAB_SRef|rev/min|TAB: Speed mode reference value| | | | |
|198|MPRO_TAB_SRef|rev/min| | | | | |
|199|MPRO_TAB_PAcc|rev/min/s|TAB: Position control mode acceleration| | | | |
|199|MPRO_TAB_PAcc|rev/min/s| | | | | |
|200|MPRO_TAB_PDec|rev/min/s|TAB: Position control mode Acceleration| | | | |
|200|MPRO_TAB_PDec|rev/min/s| | | | | |
|201|MPRO_TAB_PSpd|rev/min|TAB: Position control mode speed| | | | |
|201|MPRO_TAB_PSpd|rev/min| | | | | |
|202|MPRO_TAB_PPos|mDegree|TAB: Position control mode reference value| | | | |
|202|MPRO_TAB_PPos|mDegree| | | | | |
|203|MPRO_TAB_PMode| |Position control table:Mode| | | | |
|203|MPRO_TAB_PMode| | | | | | |
|204|MPRO_TAB_WaitTime|ms|TAB: Wait time| | | | |
|204|MPRO_TAB_WaitTime|ms| | | | | |
|205|MPRO_TAB_Mode| |TAB mode| | | | |
|206|MPRO_Tab_MaxIdx| |TAB: Max index in AUTO mode| | | | |
|207|MPRO_TAB_ActIdx| |TAB: Actual index| | | | |

MOOG ID No.:CB40859-001 Date:11/2020

MSD ServoDrive - DeviceHelp

# 8 Motion profile

MOOG ID No.:CB40859-001 Date:11/2020

MSD ServoDrive - DeviceHelp 270

# 8.8 Analog channel (ISA00 und ISA01)

# Offset (O)

This parameter (P 174 - MPRO_ANA0_SOffset for ISA00, P 184 - MPRO_ANA1_SOffset for ISA01) compensates for component variations and is used for offset compensation purposes. Depending on the control mode being used (see Section ""Basic settings"" on page 110), the value will be stored in parameter index [0] (torque control), [1] (speed control) or [2] (position control).

# Backlash (B)

This parameter (P 175 - MPRO_ANA0_SThreshold for ISA00, P 185 - MPRO_ANA1_SThreshold for ISA01) can suppress axis motion close to the standstill (stop) position. Depending on the control mode being used (see Section ""Basic settings"" on page 110), the value will be stored in parameter index [0] (torque control), [1] (speed control) or [2] (position control).

Image 8.68: “Analog channel” screen

# Acceleration ramp

Two standard analog inputs (ISA00, ISA01) are available. These inputs can be configured...

- with negative values for analog setpoint settings
- with positive values for digital setpoint processing

(P 109[0] - MPRO_INPUT_FS_ISA00 and P 110[0] - MPRO_INPUT_FS_ISA01).

see also section ""Analog Inputs"" on page 303. By using the ""REV(-2) = Analog setpoint"" setting, an analog input voltage of ±10 V can be processed as a setpoint.

# Deceleration ramp

This parameter serves as a deceleration ramp for torque control (P 176[1] - MPRO_ANA0_TRamp for ISA00, P 186[1] - MPRO_ANA1_TRamp for ISA01) or speed control (P 177[1] - MPRO_ANA0_SRamp for ISA00, P 187[1] - MPRO_ANA1_SRamp for ISA01). Depending on the control mode being used (see Section ""Basic settings"" on page 110), the value will be stored in parameter index [0] (torque control), [1] (speed control) or [2] (position control).

This parameter (P 173 - MPRO_ANA0_Scale for ISA00, P 183 - MPRO_ANA1_Scale for ISA01) is used to define which speed / which torque / which position corresponds to the maximum analog value. Depending on the control mode being used (see Section ""Basic settings"" on page 110), the value will be stored in parameter index [0] (torque control), [1] (speed control) or [2] (position control).

# 8.8.1 Special characteristics of position control mode

A threshold value can also be specified which generates a run-on range around the last reference value. A ramp function calculates a motion profile for the position reference from pre-defined acceleration and speed limits.

The position references on the analog channel are not applied immediately, but dependent on a digital input. Accordingly, one of the ISD00 to ISD06 digital inputs must be set to a value of ""REFANAEN(28) = Enable analog reference value"" (see Section ""Digital inputs"" on page 290). The position setpoint being received will only be applied if the corresponding digital input is active. The acceleration is entered using P 173[0] - MPRO_ANA0_TScale or P 183[0] - MPRO_ANA1_TScale.

# 8.8.2 Wire Break Monitoring

P 399 - CON_ANAWireBrk_Th can be used to configure wire break monitoring for the analog inputs. For details see Section ""Wire Break Monitoring"" on page 306.

|Function|TLIM (-4)|OVR (-3)|REFV (-2)|leer (-1)|OFF (0)|
|---|---|---|---|---|---|
|Digital|(1)-(28)|(1)-(28)|(1)-(28)|(1)-(28)|(1)-(28)|
|Analog channel|Filter|Scale|Offset|Profile|generator|

Control

Image 8.69: Reference processing structure

MOOG ID No.:CB40859-001 Date:11/2020

MSD ServoDrive - DeviceHelp 271

# 8 Motion profile

# 8 Motion profile

MOOG ID No.:CB40859-001 Date:11/2020

|ID|Index Name|Unit|Description|ID|
|---|---|---|---|---|
|395|CON_ANA_Isaf_Scaled| |Analog inputs: Values (filt, norm, comp, scaled)|174|
|395|0 ISA00| |Scaled, compensated, filtered, normalized value|175|
|395|1 ISA01| |Scaled, compensated, filtered, normalized value| |
|396|CON_ANA_Scale_ThUpper| |Analog inputs: Upper scaling limits|175|
|396|0 ISA00|%|Upper scaling (@ 10 V) threshold|175|
|396|1 ISA01|%|Upper scaling (@ 10 V) threshold| |
|397|CON_ANA_Scale_ThZero| |Analog inputs: Zero scaling thresholds|176|
|397|0 ISA00|V|Zero scaling threshold (+/-)|176|
|397|1 ISA01|V|Zero scaling threshold (+/-)| |
|398|CON_ANA_Scale_ThLower| |Analog inputs: Lower scaling limits|177|
|398|0 ISA00|%|Lower scaling (@ zero threshold) threshold|177|
|398|1 ISA01|%|Lower scaling (@ zero threshold) threshold| |
|399|CON_ANA_WireBrk_Th| |Analog inputs: Wire break thresholds|Table 8.26:|
|399|0 ISA00|V|Wire break detection threshold| |
|399|1 ISA01|V|Wire break detection threshold| |
|405|0 CON_ANA_Filt0|ms|Analog input ISA00: Filter time constant (PT 1)|ID|
|408|CON_ANA_Isaf_Norm| |Analog inputs: Values (filt, norm)|183|
|408|0 ISA00| |Filtered, normalized value|183|
|408|1 ISA01| |Filtered, normalized value|183|

Table 8.25: “Analog channel” parameters

|ID|Index Name|Unit|Description|ID|
|---|---|---|---|---|
|173|MPRO_ANA0_Scale| |ANA0: scale factors|184|
|173|0 MPRO_ANA0_TScale|Nm|ANA0: scale factor torque reference|185|
|173|1 MPRO_ANA0_SScale|rev/min|ANA0: scale factor speed reference|185|
|173|2 MPRO_ANA0_PScale|mDegree|ANA0: scale factor position reference| |
|174|MPRO_ANA0_Offset| |ANA0: offsets|185|
|174|0 MPRO_ANA0_TOffset|Nm|ANA0: offsets for torque reference|185|

Table 8.26: “Analog channel ISA00” parameters

|Index Name|Unit|Description|
|---|---|---|
|1 MPRO_ANA0_SOffset|rev/min|ANA0: offsets for speed reference|
|2 MPRO_ANA0_POffset|mDegree|ANA0: offsets for position reference|
|MPRO_ANA0_Threshold| |ANA0: thresholds|
|0 MPRO_ANA0_TThreshold|Nm|ANA0: threshold for torque reference|
|1 MPRO_ANA0_SThreshold|rev/min|ANA0: threshold for speed reference|
|2 MPRO_ANA0_PThreshold|mDegree|ANA0: threshold for position reference|
|MPRO_ANA0_TRamp| |ANA0: Torque mode acceleration [0] and deceleration [1]|
|0 MPRO_ANA0_TRamp|Nm/s| |
|1 MPRO_ANA0_TRamp|Nm/s| |
|MPRO_ANA0_SRamp| |ANA0: Speed mode acceleration [0] and deceleration [1]|
|0 MPRO_ANA0_SRamp|SPEED/s| |
|1 MPRO_ANA0_SRamp|SPEED/s| |

“Analog channel ISA00” parameters (continue)

|Index Name|Unit|Description|
|---|---|---|
|MPRO_ANA1_Scale| |ANA1: scale factors|
|0 MPRO_ANA1_TScale|Nm|ANA0: scale factor torque reference|
|1 MPRO_ANA1_SScale|rev/min|ANA0: scale factor speed reference|
|2 MPRO_ANA1_PScale|mDegree|ANA0: scale factor position reference|
|MPRO_ANA1_Offset| |ANA1: offsets|
|0 MPRO_ANA1_TOffset|Nm|ANA1: offsets for torque reference|
|1 MPRO_ANA1_SOffset|rev/min|ANA1: offsets for speed reference|
|2 MPRO_ANA1_POffset|mDegree|ANA1: offsets for position reference|
|MPRO_ANA1_Threshold| |ANA1: thresholds|
|0 MPRO_ANA1_TThreshold|Nm|ANA1: threshold for torque reference|
|1 MPRO_ANA1_SThreshold|rev/min|ANA1: threshold for speed reference|
|2 MPRO_ANA1_PThreshold|mDegree|ANA1: threshold for position reference|

“Analog channel ISA01” parameters

# 8 Motion profile

|ID|Index Name|Unit|Description|
|---|---|---|---|
|186|MPRO_ANA1_TRamp|Nm/s|ANA1: Torque mode acceleration [0] and deceleration[1]|
|186|MPRO_ANA1_TRamp|Nm/s| |
|187|MPRO_ANA1_SRamp|SPEED/s|ANA1: Speed mode acceleration [0] and deceleration [1]|
|187|MPRO_ANA1_SRamp|SPEED/s| |

# Table 8.27: “Analog channel ISA01” parameters (continue)

Display

- System state
- Initialization on device startup
- Not ready (DC link voltage possibly too low)
- Start inhibit (DC link voltage present, power stage off)
- Starting lockout
- Ready for start
- Control initialization: Auto commutation, flux build-up etc.

# Table 8.28: Central state machine according to CiA 402 device display

MOOG ID No.:CB40859-001 Date:11/2020

MSD ServoDrive - DeviceHelp 273

# 8 Motion profile

MOOG ID No.:CB40859-001 Date:11/2020

MSD ServoDrive - DeviceHelp 274

|Display|System state|power disabled|fault|
|---|---|---|---|
|Control enabled|0|Start|7|
| |fault reaction active|0|14|
|Quick stop active|1|not ready|8|
| |to switch on|1|17|
|Error reaction active|2|switch on|disabled|
| |2|7| |
|Error state (in this state the error is indicated directly on the display.)|3|ready to|switch on|
|Device is reset (display flashes)|power enabled|3|6|
| |10|12| |
|• Number [5.] flashes when “STO” (Safe Torque Off) input is active. Display goes out when STO inactive.| | | |
|• The dot on the display flashes when the power stage is active.| | | |

Table 8.28: Central state machine according to CiA 402 device display (continue)

NOTE

l The system states indicated on the display may differ from the states in the table depending on the drive profile setting.

Image 8.70: State machine diagram based on CANopen communications

⓪ to ① State number

1 to 17 State transition (No. 17: DC link voltage cut off)

Legend for “State machine diagram based on CANopen communications” figure

# 8.10 Touch probe

|ID|Index Name / Setting|
|---|---|
|241|0 MPRO_TP_Position|
|241|1 MPRO_TP_Position|
|241|2 MPRO_TP_Position|
|241|3 MPRO_TP_Position|
|241|4 MPRO_TP_Position|
|1400|0 MPRO_TP_Config|
| |TP_TP (0)|
| |AB (1)|
| |PD_UP (2)|
| |PD_DOWN (3)|
| |PC_PC (4)|
| |PC_TP (5)|
| |TP_PC (6)|
| |ENC_ENC (7)|
| |ENC_TP (8)|
| |TP_ENC (9)|

Using the touch probe inputs, touch probe functions can be performed. In order to be able to do this, P 106[0] - MPRO_INPUT_FS_ISD05 and P 107[0] - MPRO_INPUT_FS_ISD06 must be used to set digital inputs ISD05 and ISD06 to ""PROBE(15) = Touch probe (only ISD05/06)"" (see Section ""Digital inputs"" on page 290). HTL encoders can be evaluated or pulse counters implemented using the MSD PLC.

The touch probe can be triggered with P 240 - MPRO_TP_Ctrl. This enables triggering on a positive or negative edge, or on both edges, of the signal detected on the touch probe inputs. After the measurement, the parameter jumps back to the value ""NONE (0)"" and the latch position is mapped in the corresponding subindex of parameter P 241 - MPRO_TP_Position. A continuous touch probe mode is not possible at present, so the touch probe has to be reactivated after the measurement.

P 1402 - MPRO_TP_Channel can be used to select various positions as actual value sources of the latch position for the touch probe functionality. The following table provides an overview of the available settings. The counters are accessed via the MSD PLC or a bus system.

|ID|Index Name / Setting|Unit|Description|
|---|---|---|---|
|240|MPRO_TP_Ctrl|Touch probe: Control| |
| |0| |NONE (0) = No function|
| |1| |POS (1) = Positive edge|
| |2| |NEG (2) = Negative edge|
| |3| |BOTH (3) = Both edges|
|240|0 MPRO_TP_Ctrl| | |
|240|1 MPRO_TP_Ctrl| | |
|240|2 MPRO_TP_Ctrl| | |
|241|MPRO_TP_Position|Probe: Pos. high/low edge of TP0/1, encoder zero pulse| |

Table 8.29: “Touch probe” parameters

MOOG ID No.:CB40859-001 Date:11/2020

# 8 Motion profile

|Unit|Description|
|---|---|
|mDegree|Touch probe: Configuration|
|mDegree|TP0, TP1 touch probe|
|mDegree|TP0, TP1 as encoder, A/B as quadrature counting|
|mDegree|TP0, TP1 as encoder, pulse (TP0) / direction (TP1), count up on direction high|
|mDegree|TP0, TP1 as encoder, pulse (TP0) / direction (TP1), count down on direction high|
|mDegree|TP0 pulse counter, TP1 pulse counter|
|mDegree|TP0 pulse counter, TP1 touch probe|
|mDegree|TP1 touch probe, TP0 pulse counter|
|mDegree|TP0 encoder counter, TP1 encoder counter|
|mDegree|TP0 encoder counter, TP1 touch probe|
|mDegree|TP0 touch probe, TP1 encoder counter|

Touch probe: Channel

|Unit|Description|
|---|---|
|ACTPOS (0)|Actual position in user units|
|ACTPOSINC (1)|Actual position in increments|
|MASTERPOS (2)|Master position in increments|
|ENCPOS_CH1 (3)|Encoder position Channel 1|
|ENCPOS_CH1_INC (4)|Encoder position Channel 1 in increments|
|ENCPOS_CH2 (5)|Encoder position Channel 2|
|ENCPOS_CH2_INC (6)|Encoder position Channel 2 in increments|

# 8 Motion profile

MOOG ID No.:CB40859-001 Date:11/2020 MSD ServoDrive - DeviceHelp 276

|ID|Index Name / Setting|Unit|Description|
|---|---|---|---|
|7|ENCPOS_CH3 (7)| |Encoder position Channel 3|
|8|ENCPOS_CH3_INC (8)| |Encoder position Channel 3 in increments|
|9|ENCPOS_CH4 (9)| |Encoder position Channel 4|
|10|ENCPOS_CH4_INC (10)| |Encoder position Channel 4 in increments|
|11|ACTPOS2 (11)| |Actual position of redundant encoder in user units|
|12|Sercos (12)| |Referred to Sercos profile parameters S-x-0426, S-x-0427|
|13|UserRefPos(13)| |Reference position in user units|
|14|MasterPosST(14)| |Master position (ECAM, EGEAR) singleturn, always steps|
|15|CommonMasterPos(15)| |Master position (ECAM, EGEAR) singleturn, always steps|
|16|CommonMasterPosST(15)| |Master position (ECAM, EGEAR) singleturn, always steps|
|1402|MPRO_TP_Channel| | |
|1402|MPRO_TP_Channel| | |
|1402|MPRO_TP_Channel| | |
|1404|MPRO_TP_Lines| |Touch probe: Lines @ pulse counter on channel x|
|1404|MPRO_TP_Lines| | |
|1404|MPRO_TP_Lines| | |

Image 8.71: “Synchronized motion” screen

There are various modes available in the “synchronization mode” drop-down menu (P 242[0] - MPRO_ECAM_SyncModMode):

- Off(0) = Synchronized motion off
- ECAM_iPlc(1) = Electronic cam plate via MSD PLC
- EGEAR_iPlc(2) = Electr. gear unit via MSD PLC
- ECAM_PARA(3) = Electronic camming via parameters
- EGEAR_PARA(4) = Electronic gearing via parameters

NOTE: For more information refer to the bus system User Manuals or the description of the MSD PLC.

# 8.11.1 Electronic cam plate

The other parameters are configured in separate screens that can be accessed with the corresponding buttons.

- Master configuration (see Section ""Master configuration"" on page 280)
- Electronic gearing (see Section ""Electronic gearing"" on page 283)
- Electronic camming (see Section ""Electronic cam plate"" on page 277)

P 1318[0] - MPRO_ECAM_ControlWord is the control word for “synchronized motion” (see Section ""Control word for synchronized motion"" on page 279).

P 1326[0] - MPRO_ECAM_StatusWord is the status word for “synchronized motion” (see Section ""Status word for synchronized motion"" on page 279).

# 8.11.1.1 Table selection

|ID|Index Name|Unit|Description|
|---|---|---|---|
|1300|MPRO_ECAM_CTS_| |ECAM: CamTableSelect - Master reference|
|1301|MasterRef| | |
|1305|MPRO_ECAM_CTS_| |ECAM: CamTableSelect - Method for changing the camtable|
|1306|MPRO_ECAM_CTS_| |ECAM: CamTableSelect - Mode for changing the camtable|
|1307|MPRO_ECAM_CTS_|incr|ECAM: CamTableSelect - Distance for changing the camtable|
|242|MPRO_ECAM_| |ECAM / EGEAR: Mode of synchronized motion SyncModMode|
|265|MPRO_ECAM_| |ECAM / EGEAR: Slave speed factor (1 = 100%).|
|266|CamSlave_SpeedFactor| | |
|268|MPRO_ECAM_| |ECAM / EGEAR: Mode of switching off sync. motion|

# 8.11.1.2 Synchronization

|ID|Index Name|Unit|Description|
|---|---|---|---|
|1342|MPRO_ECAM_CI_|incr|ECAM: CamIn - Synchronization position (multiturn part)|
|1343|MPRO_ECAM_CO_|incr|ECAM: CamOut - Decoupling pos. (multiturn part)|
|1303|MPRO_ECAM_CI_|incr|ECAM: CamIn - Master offset|
|1308|MPRO_ECAM_CI_| |ECAM: CamIn - Master reference|
|1309|MPRO_ECAM_CI_| |ECAM: CamIn - Slave reference|
|1310|MPRO_ECAM_CI_| |ECAM: CamIn - Coupling mode|
|1311|MPRO_ECAM_CI_|incr|ECAM: CamIn - Coupling distance|
|1312|MPRO_ECAM_CI_|incr|ECAM: CamIn - Synchronization position|

Table 8.31: “Electronic camming - Table selection” parameters

Table 8.30: “Synchronized motion” parameters

Table 8.32: “Electronic camming - Synchronization” parameters

MOOG ID No.:CB40859-001 Date:11/2020

MSD ServoDrive - DeviceHelp 277

# 8 Motion profile

MOOG ID No.:CB40859-001 Date:11/2020 MSD ServoDrive - DeviceHelp 278

|ID|Index|Name|Unit|Description|
|---|---|---|---|---|
|1313|0|MPRO_ECAM_CO_SyncPosST|(singleturn part)|ECAM: CamOut - Slave reference|
|1314|0|MPRO_ECAM_CO_DecouplingMode|63|ECAM: CamOut - Decoupling mode|
|1315|0|MPRO_ECAM_CO_BreakingPosST|incr|ECAM: CamOut - Decoupling position|
|1316|0|MPRO_ECAM_CO_DecouplingDist|incr|ECAM: CamOut - Decoupling distance|
|1317|0|MPRO_ECAM_CO_StandstillPos|mDegree|ECAM: CamOut - Slave standstill position|

# Table 8.32: “Electronic camming - Synchronization” parameters (continue)

|ID|Index|Name|Unit|Description|
|---|---|---|---|---|
|1346| |MPRO_ECAM_SP_Table| |ECAM: Setpoint table interface|
|1346|0|Index| |Index of setpoint table|
|1346|1|Value| |Value at index of setpoint table|
|1347|0 to 31|MPRO_ECAM_SP_Index| |ECAM: Setpoint segments start index|
|1348|0 to 31|MPRO_ECAM_SP_Length| |ECAM: Setpoint segments length|
|1349|0 to 31|Length| | |
|1350|0|MPRO_ECAM_SP_MaDist| |ECAM: Setpoint segments master distance|
|1351|0|MPRO_ECAM_SP_IpoType| |ECAM: Setpoint segments interpolation type|
|1352|0 to 31|Checksum| |ECAM: Setpoint table checksum|
|1353|0 to 31|GainNum| |ECAM: Setpoint segments gain numerator|
| | |GainDen| |ECAM: Setpoint segments gain denominator|

# Table 8.33: “Electronic camming - Table segments” parameters

|ID|Index|Name|Unit|Description|
|---|---|---|---|---|
|1329|0 to 63|MPRO_ECAM_SegData_IndexNext| |ECAM: Index of the following segment|
|1330|0 to 63|MPRO_ECAM_SegData_IndexPrev| |ECAM: Index of the previous segment|
|1331|0 to 63|MPRO_ECAM_SegData_ProfileMode| |ECAM: Profile mode of the current segment|
|1332|0 to 63|MPRO_ECAM_SegData_DistMaster| |ECAM: Length of the master section of the current segment|
|1333|0 to 63|MPRO_ECAM_SegData_DistSlave| |ECAM: Length of the slave section of the current segment|
|1334|0 to 63|MPRO_ECAM_SegData_Lambda| |ECAM: Lambda value of the current segment|
|1335|0 to 63|MPRO_ECAM_SegData_StatusWord| |ECAM: Status word of the current segment|
|1336|0 to 63|MPRO_ECAM_SegData_ControlWord| |ECAM: Control word of the current segment|

# 8.11.2 Control word for synchronized motion

|Bit|Function|PLC function|Bit number|Description|
|---|---|---|---|---|
|0-7|Start segment (8-bit value)|-|0-7|Actual segment (8-bit value)|
|8-15|Reserved|-| |Actual ECAM / EGEAR state machine state (4 Bit value)|
|16|Absolute (true) / relative (false) master relationship|-| |- 0: ECAM / EGEAR asynchronous
- 1: ECAM / EGEAR synchronous
|
|17|Absolute (true) / relative (false) master (CAM) relationship at cam in|-| |- 2: ECAM / EGEAR synchronizing
- 3: ECAM / EGEAR desynchronizing
|
|18|Absolute (true) / relative (false) slave (CAM) relationship at cam in|-| |- 4: ECAM / EGEAR active and waiting for going asynchronous
|
|19-23|Reserved|-| |- 5: ECAM / EGEAR inactive and waiting for going synchronous
|
|24|Change gear ratio of the electronic gear online|MCB_GearRatioChange| | |
|25|Disable master calculation|MCB_Cam_MasterEnable| | |
|26|Enable master calculation|MCB_Cam_MasterEnable| | |
|27|Select CAM table|MCB_CamTableSelect| | |
|28|Start Ecam|MCB_CamIn| | |
|29|Stop Ecam|MCB_CamOut| | |
|30|Start Egear|MCB_GearIn| | |
|31|Stop Egear|MCB_GearOut| | |

# 8.11.3 Status word for synchronized motion

|Bit|Function|PLC function|Bit number|Description|
|---|---|---|---|---|
|12-26|Reserved|-| | |
|27|ECAM / EGEAR is active|-| | |
|28|Valid segments chosen|-| | |
|29|Master data are valid|-| | |
|30|Master is initialized|-| | |
|31|Master calculation is active|-| | |

Table 8.35: Control word ECAM (P 1318[0] - MPRO_ECAM_ControlWord)

Table 8.36: ECAM status word (P 1326[0] - MPRO_ECAM_StatusWord)

MOOG ID No.:CB40859-001 Date:11/2020 MSD ServoDrive - DeviceHelp 279

# 8 Motion profile

# 8 Motion profile

MOOG ID No.:CB40859-001 Date:11/2020

MSD ServoDrive - DeviceHelp 280

# 8.11.4 Master configuration

the master encoder, you will need to set the resolution relative to a single motor revolution in P 250 - MPRO_ECAM_PARAMaster_Amplitude (see below).

- ENC CH1 (3) = Encoder channel 1 X7 (Sin/Cos)
- ENC CH2 (4) = Encoder channel 2 X6 (Resolver)
- ENC CH3 (5) = Encoder channel 3 X8 (optional)

This function is only available if an external interface X8 (option module) is present.

- TP0 (6) = Pulse counter on probe channel 0 (TP0)
- TP1 (7) = Pulse counter on probe channel 1 (TP1)
- ENC_CH4 (8) = Encoder channel 4 (p. e. fieldbus)
- TWIN_POS (9) = TWIN remote reference position (P-2607)

Image 8.72: “Master configuration” screen

# Channel selection (master encoder)

P 1319[0] - MPRO_ECAM_CamMaster_AxisType is used to define the master encoder.

- NO AXIS (0) = No axis
- VIRTUAL MASTER (1) = Virtual master

If you select this function, you will be able to configure additional settings by clicking on the enabled “Options...” button (see Section ""Virtual Master"" on page 286).

- PARA (2) = Master parameter interface

If you select this function because a higher-level controller is being used as

# Anti-reverse mode

Slave only starts moving along with it again as soon as the master reaches the zero position.

P 1320[0] - MPRO_ECAM_CamMaster_RevLockMode is used to define the reverse lock mode, which can be used either with or without path compensation. The dashed lines in the following diagrams indicate what the engagement distance is:

# Example:

If the master, which has moved two motor revolutions in the direction blocked for the slave, then moves in the unblocked direction again, the slave only moves off when the master has traversed the zero point.

- INACTIVE (0) = Reverse lock inactive
- ACTIVE (2) = Reverse lock enabled - without path optimization
- ACTIVE WAY COMP (1) = Reverse lock active - with way compensation

While the slave accelerates to the speed of the master during engagement, the master and slave do not move synchronously. This function needs to be selected in order to quickly catch up to the master that is running ahead.

# Example:

- Master (black line) rotates in the blocked direction
- The slave (blue line) remains stopped
- Master rotates in the unblocked direction again
- The slave follows the master directly in the unblocked direction

Assume the master has moved two motor revolutions in the direction for which the slave lock is enabled. If the master now moves in the direction for which there is no lock, the slave will immediately start running in that direction.

MOOG ID No.:CB40859-001 Date:11/2020

MSD ServoDrive - DeviceHelp 281

# 8 Motion profile

MOOG ID No.:CB40859-001 Date:11/2020 MSD ServoDrive - DeviceHelp 282

|Filter type|ID|Index Name|Unit|Description|
|---|---|---|---|---|
|When using a real master encoder, encoder signals may be subject to noise.|P 1340|1319|0|MPRO_ECAM_CamMaster_AxisType|
| | |MPRO_ECAM_CamMaster_SpeedFilTyp| |ECAM / EGEAR: Channel selection of internal master input|
| | |1320|0|MPRO_ECAM_CamMaster_RevLockMode|
| | |1321|0|MPRO_ECAM_CamMaster_Amplitude|
| | |1322|0|MPRO_ECAM_CamMaster_GearNum|
| | |1323|0|MPRO_ECAM_CamMaster_GearDen|
|Filter time|1327|0|ms|ECAM / EGEAR: Filter time constant of master|
|If P 1340[0] is used to enable a filter, P 1327[0] - MPRO_ECAM_CamMaster_SpeedTFil can be used to define the corresponding filter time.|1328|0|speed|ECAM / EGEAR: Speed factor of the internal master|
|Speed factor|1340|0| |MPRO_ECAM_CamMaster_SpeedFilTyp|
|The master encoder can be assigned an additional speed factor P 1328[0] - MPRO_ECAM_CamMaster_SpeedFactor.|1341|0|incr|ECAM / EGEAR: Master drive offset|

Table 8.37: “Synchronized motion - Master configuration” parameters (continue)

| | | |ID|Index Name|Unit|Description|
|---|---|---|---|---|---|---|
|247|0|MPRO_ECAM_ParaMaster_ActPos|incr|ECAM / EGEAR: Parameter interface master position| | |
|248|0|MPRO_ECAM_ParaMaster_ActSpeed|rpm|ECAM / EGEAR: Parameter interface master speed| | |
|249|0|MPRO_ECAM_ParaMaster_ActAcc|rpm|ECAM / EGEAR: Parameter interface master acceleration| | |
| |250|0|MPRO_ECAM_ParaMaster_Amplitude| |ECAM / EGEAR: Parameter interface master amplitude| |

Table 8.37: “Synchronized motion - Master configuration” parameters

# 8.11.5 Electronic gearing

# Gear ratio

The gear ratio is specified as a fraction. This ensures that the position references can be translated to the motor shaft with no rounding error.

- ""Slave"" (P 252[0] - MPRO_ECAM_Egear_GearNum) is the numerator
- ""Master"" (P 251[0] - MPRO_ECAM_Egear_GearDen) is the denominator

# Scaling of speed pre-control

Defined with P 265[0] - MPRO_ECAM_CamSlave_SpeedFactor definiert.

# Scaling of torque pre-control

Defined with P 266[0] - MPRO_ECAM_CamSlave_TorqueFactor.

# Engagement

See Section ""Engagement"" on page 284.

# Disengagement

See Section ""Disengagement"" on page 285.

|ID|Index Name|Unit|Description|
|---|---|---|---|
|251|0 MPRO_ECAM_Egear_GearDen| |EGEAR: Gear denominator|
|252|0 MPRO_ECAM_Egear_GearNum| |EGEAR: Numerator of gear ratio|
|1344|0 MPRO_ECAM_Egear_LimRefAcc|rpm/s|EGEAR: Acceleration limit for reference|
|1345|0 MPRO_ECAM_Egear_LimRefJerk|rpm/s²|EGEAR: Jerk limit for reference|

Table 8.38: “Synchronized motion - Electronic gearing” parameters

Image 8.73: ""Electronic gearing"" screen

MOOG ID No.:CB40859-001 Date:11/2020 MSD ServoDrive - DeviceHelp 283

# 8 Motion profile

# 8 Motion profile

MOOG ID No.:CB40859-001 Date:11/2020

MSD ServoDrive - DeviceHelp 284

# 8.11.6 Engagement

used to define the engagement distance (between the dashed lines).

P 253[0] - MPRO_ECAM_Egear_GearInMode is used to define the mode for engagement.

- DIRECT (0) = Direct
- Direct engagement: Angular synchronous; with jerking (no ramps).
- CROSSFADE (3) = Crossfading
- Engagement with crossfading function (5th degree polynomial): Angular synchronous; jerk-limited; speed will overshoot during engagement.
- RAMP (1) = Linear speed ramp
- Engagement with linear acceleration: Not angular synchronous; with jerking.
- FADE (2) = Engagement fade-out
- Engagement with fade-in function (5th degree polynomial): Not angular synchronous; jerk-limited. The position is ignored. ",How are the analog inputs ISA00 and ISA01 configured in the 'MSD ServoDrive - DeviceHelp' document?,A1,They can be configured with negative values for analog setpoint settings or positive values for digital setpoint processing.,0.58984375,0.53515625,3.25,1.2734375,0.18359375
1,msd_servo_drive.txt,76,b87ca5e232c2bdbb6fa16a8a401c6b5d285dc0183e73cc9d134de13dd2fc71d2,"MOOG ID No.:CB40859-001 Date:11/2020

MSD ServoDrive - DeviceHelp 267

# 8 Motion profile

MOOG ID No.:CB40859-001 Date:11/2020 MSD ServoDrive - DeviceHelp 268

# Deceleration

With ...

- P 194 - MPRO_TAB_TDec (for torque control) or
- P 197 - MPRO_TAB_SDec (for speed control) or
- P 200 - MPRO_TAB_PDec (for position control)

and indexes 0–15, the deceleration for each individual motion task can be defined. The input must not be zero.

# Wait time in Auto mode

P 204 - MPRO_TAB_WaitTime is used to define the wait time before the next motion task is carried out.

# Maximum table index in Auto mode

P 206[0] - MPRO_Tab_MaxIdx is used to define the table index up to which driving jobs will be carried out in one of the auto modes.

# Current table index

P 207[0] - MPRO_Tab_ActIdx will show the index for the motion task that is currently active. If parameter P 205 MPRO_TAB_Mode is set to “Para(0)”, a driving set can be entered and approached directly.

# Activation of reference table

The following procedures can be used in order to activate the setpoint table for operation.

|ID|Index Name|Unit|Description|
|---|---|---|---|
|193|MPRO_TAB_TAcc|TAB: Torque mode acceleration|Nm/ms|
|193|0|MPRO_TAB_TAcc|Nm/ms|
|193|1 - 15|MPRO_TAB_TAcc|Nm/ms|
|194|MPRO_TAB_TDec|TAB: Torque mode deceleration| |
|194|0|MPRO_TAB_TDec|Nm/ms|
|194|1 - 15|MPRO_TAB_TDec|Nm/ms|

# Table 8.23: Activation of table references

# Table 8.24: “Setpoint table settings” parameters

# Table 8.24: “Setpoint table settings” parameters (continue)

|ID|Index Name|Unit|Description|ID|Index Name|Unit|Description|
|---|---|---|---|---|---|---|---|
|195|MPRO_TAB_TRef|Nm|TAB: Torque mode reference value|208|MPRO_TAB_OutputNo| |OSD TAB: actual table index and target|
|195|MPRO_TAB_TRef|Nm| |208|MPRO_TAB_OutputNo| | |
|196|MPRO_TAB_SAcc|rev/min/s|TAB: Speed mode acceleration|269|MPRO_TAB_Ctrl| |TAB: control word|
|196|MPRO_TAB_SAcc|rev/min/s| | | | | |
|197|MPRO_TAB_SDec|rev/min/s|TAB: Speed mode deceleration| | | | |
|197|MPRO_TAB_SDec|rev/min/s| | | | | |
|198|MPRO_TAB_SRef|rev/min|TAB: Speed mode reference value| | | | |
|198|MPRO_TAB_SRef|rev/min| | | | | |
|199|MPRO_TAB_PAcc|rev/min/s|TAB: Position control mode acceleration| | | | |
|199|MPRO_TAB_PAcc|rev/min/s| | | | | |
|200|MPRO_TAB_PDec|rev/min/s|TAB: Position control mode Acceleration| | | | |
|200|MPRO_TAB_PDec|rev/min/s| | | | | |
|201|MPRO_TAB_PSpd|rev/min|TAB: Position control mode speed| | | | |
|201|MPRO_TAB_PSpd|rev/min| | | | | |
|202|MPRO_TAB_PPos|mDegree|TAB: Position control mode reference value| | | | |
|202|MPRO_TAB_PPos|mDegree| | | | | |
|203|MPRO_TAB_PMode| |Position control table:Mode| | | | |
|203|MPRO_TAB_PMode| | | | | | |
|204|MPRO_TAB_WaitTime|ms|TAB: Wait time| | | | |
|204|MPRO_TAB_WaitTime|ms| | | | | |
|205|MPRO_TAB_Mode| |TAB mode| | | | |
|206|MPRO_Tab_MaxIdx| |TAB: Max index in AUTO mode| | | | |
|207|MPRO_TAB_ActIdx| |TAB: Actual index| | | | |

MOOG ID No.:CB40859-001 Date:11/2020

MSD ServoDrive - DeviceHelp

# 8 Motion profile

MOOG ID No.:CB40859-001 Date:11/2020

MSD ServoDrive - DeviceHelp 270

# 8.8 Analog channel (ISA00 und ISA01)

# Offset (O)

This parameter (P 174 - MPRO_ANA0_SOffset for ISA00, P 184 - MPRO_ANA1_SOffset for ISA01) compensates for component variations and is used for offset compensation purposes. Depending on the control mode being used (see Section ""Basic settings"" on page 110), the value will be stored in parameter index [0] (torque control), [1] (speed control) or [2] (position control).

# Backlash (B)

This parameter (P 175 - MPRO_ANA0_SThreshold for ISA00, P 185 - MPRO_ANA1_SThreshold for ISA01) can suppress axis motion close to the standstill (stop) position. Depending on the control mode being used (see Section ""Basic settings"" on page 110), the value will be stored in parameter index [0] (torque control), [1] (speed control) or [2] (position control).

Image 8.68: “Analog channel” screen

# Acceleration ramp

Two standard analog inputs (ISA00, ISA01) are available. These inputs can be configured...

- with negative values for analog setpoint settings
- with positive values for digital setpoint processing

(P 109[0] - MPRO_INPUT_FS_ISA00 and P 110[0] - MPRO_INPUT_FS_ISA01).

see also section ""Analog Inputs"" on page 303. By using the ""REV(-2) = Analog setpoint"" setting, an analog input voltage of ±10 V can be processed as a setpoint.

# Deceleration ramp

This parameter serves as a deceleration ramp for torque control (P 176[1] - MPRO_ANA0_TRamp for ISA00, P 186[1] - MPRO_ANA1_TRamp for ISA01) or speed control (P 177[1] - MPRO_ANA0_SRamp for ISA00, P 187[1] - MPRO_ANA1_SRamp for ISA01). Depending on the control mode being used (see Section ""Basic settings"" on page 110), the value will be stored in parameter index [0] (torque control), [1] (speed control) or [2] (position control).

This parameter (P 173 - MPRO_ANA0_Scale for ISA00, P 183 - MPRO_ANA1_Scale for ISA01) is used to define which speed / which torque / which position corresponds to the maximum analog value. Depending on the control mode being used (see Section ""Basic settings"" on page 110), the value will be stored in parameter index [0] (torque control), [1] (speed control) or [2] (position control).

# 8.8.1 Special characteristics of position control mode

A threshold value can also be specified which generates a run-on range around the last reference value. A ramp function calculates a motion profile for the position reference from pre-defined acceleration and speed limits.

The position references on the analog channel are not applied immediately, but dependent on a digital input. Accordingly, one of the ISD00 to ISD06 digital inputs must be set to a value of ""REFANAEN(28) = Enable analog reference value"" (see Section ""Digital inputs"" on page 290). The position setpoint being received will only be applied if the corresponding digital input is active. The acceleration is entered using P 173[0] - MPRO_ANA0_TScale or P 183[0] - MPRO_ANA1_TScale.

# 8.8.2 Wire Break Monitoring

P 399 - CON_ANAWireBrk_Th can be used to configure wire break monitoring for the analog inputs. For details see Section ""Wire Break Monitoring"" on page 306.

|Function|TLIM (-4)|OVR (-3)|REFV (-2)|leer (-1)|OFF (0)|
|---|---|---|---|---|---|
|Digital|(1)-(28)|(1)-(28)|(1)-(28)|(1)-(28)|(1)-(28)|
|Analog channel|Filter|Scale|Offset|Profile|generator|

Control

Image 8.69: Reference processing structure

MOOG ID No.:CB40859-001 Date:11/2020

MSD ServoDrive - DeviceHelp 271

# 8 Motion profile

# 8 Motion profile

MOOG ID No.:CB40859-001 Date:11/2020

|ID|Index Name|Unit|Description|ID|
|---|---|---|---|---|
|395|CON_ANA_Isaf_Scaled| |Analog inputs: Values (filt, norm, comp, scaled)|174|
|395|0 ISA00| |Scaled, compensated, filtered, normalized value|175|
|395|1 ISA01| |Scaled, compensated, filtered, normalized value| |
|396|CON_ANA_Scale_ThUpper| |Analog inputs: Upper scaling limits|175|
|396|0 ISA00|%|Upper scaling (@ 10 V) threshold|175|
|396|1 ISA01|%|Upper scaling (@ 10 V) threshold| |
|397|CON_ANA_Scale_ThZero| |Analog inputs: Zero scaling thresholds|176|
|397|0 ISA00|V|Zero scaling threshold (+/-)|176|
|397|1 ISA01|V|Zero scaling threshold (+/-)| |
|398|CON_ANA_Scale_ThLower| |Analog inputs: Lower scaling limits|177|
|398|0 ISA00|%|Lower scaling (@ zero threshold) threshold|177|
|398|1 ISA01|%|Lower scaling (@ zero threshold) threshold| |
|399|CON_ANA_WireBrk_Th| |Analog inputs: Wire break thresholds|Table 8.26:|
|399|0 ISA00|V|Wire break detection threshold| |
|399|1 ISA01|V|Wire break detection threshold| |
|405|0 CON_ANA_Filt0|ms|Analog input ISA00: Filter time constant (PT 1)|ID|
|408|CON_ANA_Isaf_Norm| |Analog inputs: Values (filt, norm)|183|
|408|0 ISA00| |Filtered, normalized value|183|
|408|1 ISA01| |Filtered, normalized value|183|

Table 8.25: “Analog channel” parameters

|ID|Index Name|Unit|Description|ID|
|---|---|---|---|---|
|173|MPRO_ANA0_Scale| |ANA0: scale factors|184|
|173|0 MPRO_ANA0_TScale|Nm|ANA0: scale factor torque reference|185|
|173|1 MPRO_ANA0_SScale|rev/min|ANA0: scale factor speed reference|185|
|173|2 MPRO_ANA0_PScale|mDegree|ANA0: scale factor position reference| |
|174|MPRO_ANA0_Offset| |ANA0: offsets|185|
|174|0 MPRO_ANA0_TOffset|Nm|ANA0: offsets for torque reference|185|

Table 8.26: “Analog channel ISA00” parameters

|Index Name|Unit|Description|
|---|---|---|
|1 MPRO_ANA0_SOffset|rev/min|ANA0: offsets for speed reference|
|2 MPRO_ANA0_POffset|mDegree|ANA0: offsets for position reference|
|MPRO_ANA0_Threshold| |ANA0: thresholds|
|0 MPRO_ANA0_TThreshold|Nm|ANA0: threshold for torque reference|
|1 MPRO_ANA0_SThreshold|rev/min|ANA0: threshold for speed reference|
|2 MPRO_ANA0_PThreshold|mDegree|ANA0: threshold for position reference|
|MPRO_ANA0_TRamp| |ANA0: Torque mode acceleration [0] and deceleration [1]|
|0 MPRO_ANA0_TRamp|Nm/s| |
|1 MPRO_ANA0_TRamp|Nm/s| |
|MPRO_ANA0_SRamp| |ANA0: Speed mode acceleration [0] and deceleration [1]|
|0 MPRO_ANA0_SRamp|SPEED/s| |
|1 MPRO_ANA0_SRamp|SPEED/s| |

“Analog channel ISA00” parameters (continue)

|Index Name|Unit|Description|
|---|---|---|
|MPRO_ANA1_Scale| |ANA1: scale factors|
|0 MPRO_ANA1_TScale|Nm|ANA0: scale factor torque reference|
|1 MPRO_ANA1_SScale|rev/min|ANA0: scale factor speed reference|
|2 MPRO_ANA1_PScale|mDegree|ANA0: scale factor position reference|
|MPRO_ANA1_Offset| |ANA1: offsets|
|0 MPRO_ANA1_TOffset|Nm|ANA1: offsets for torque reference|
|1 MPRO_ANA1_SOffset|rev/min|ANA1: offsets for speed reference|
|2 MPRO_ANA1_POffset|mDegree|ANA1: offsets for position reference|
|MPRO_ANA1_Threshold| |ANA1: thresholds|
|0 MPRO_ANA1_TThreshold|Nm|ANA1: threshold for torque reference|
|1 MPRO_ANA1_SThreshold|rev/min|ANA1: threshold for speed reference|
|2 MPRO_ANA1_PThreshold|mDegree|ANA1: threshold for position reference|

“Analog channel ISA01” parameters

# 8 Motion profile

|ID|Index Name|Unit|Description|
|---|---|---|---|
|186|MPRO_ANA1_TRamp|Nm/s|ANA1: Torque mode acceleration [0] and deceleration[1]|
|186|MPRO_ANA1_TRamp|Nm/s| |
|187|MPRO_ANA1_SRamp|SPEED/s|ANA1: Speed mode acceleration [0] and deceleration [1]|
|187|MPRO_ANA1_SRamp|SPEED/s| |

# Table 8.27: “Analog channel ISA01” parameters (continue)

Display

- System state
- Initialization on device startup
- Not ready (DC link voltage possibly too low)
- Start inhibit (DC link voltage present, power stage off)
- Starting lockout
- Ready for start
- Control initialization: Auto commutation, flux build-up etc.

# Table 8.28: Central state machine according to CiA 402 device display

MOOG ID No.:CB40859-001 Date:11/2020

MSD ServoDrive - DeviceHelp 273

# 8 Motion profile

MOOG ID No.:CB40859-001 Date:11/2020

MSD ServoDrive - DeviceHelp 274

|Display|System state|power disabled|fault|
|---|---|---|---|
|Control enabled|0|Start|7|
| |fault reaction active|0|14|
|Quick stop active|1|not ready|8|
| |to switch on|1|17|
|Error reaction active|2|switch on|disabled|
| |2|7| |
|Error state (in this state the error is indicated directly on the display.)|3|ready to|switch on|
|Device is reset (display flashes)|power enabled|3|6|
| |10|12| |
|• Number [5.] flashes when “STO” (Safe Torque Off) input is active. Display goes out when STO inactive.| | | |
|• The dot on the display flashes when the power stage is active.| | | |

Table 8.28: Central state machine according to CiA 402 device display (continue)

NOTE

l The system states indicated on the display may differ from the states in the table depending on the drive profile setting.

Image 8.70: State machine diagram based on CANopen communications

⓪ to ① State number

1 to 17 State transition (No. 17: DC link voltage cut off)

Legend for “State machine diagram based on CANopen communications” figure

# 8.10 Touch probe

|ID|Index Name / Setting|
|---|---|
|241|0 MPRO_TP_Position|
|241|1 MPRO_TP_Position|
|241|2 MPRO_TP_Position|
|241|3 MPRO_TP_Position|
|241|4 MPRO_TP_Position|
|1400|0 MPRO_TP_Config|
| |TP_TP (0)|
| |AB (1)|
| |PD_UP (2)|
| |PD_DOWN (3)|
| |PC_PC (4)|
| |PC_TP (5)|
| |TP_PC (6)|
| |ENC_ENC (7)|
| |ENC_TP (8)|
| |TP_ENC (9)|

Using the touch probe inputs, touch probe functions can be performed. In order to be able to do this, P 106[0] - MPRO_INPUT_FS_ISD05 and P 107[0] - MPRO_INPUT_FS_ISD06 must be used to set digital inputs ISD05 and ISD06 to ""PROBE(15) = Touch probe (only ISD05/06)"" (see Section ""Digital inputs"" on page 290). HTL encoders can be evaluated or pulse counters implemented using the MSD PLC.

The touch probe can be triggered with P 240 - MPRO_TP_Ctrl. This enables triggering on a positive or negative edge, or on both edges, of the signal detected on the touch probe inputs. After the measurement, the parameter jumps back to the value ""NONE (0)"" and the latch position is mapped in the corresponding subindex of parameter P 241 - MPRO_TP_Position. A continuous touch probe mode is not possible at present, so the touch probe has to be reactivated after the measurement.

P 1402 - MPRO_TP_Channel can be used to select various positions as actual value sources of the latch position for the touch probe functionality. The following table provides an overview of the available settings. The counters are accessed via the MSD PLC or a bus system.

|ID|Index Name / Setting|Unit|Description|
|---|---|---|---|
|240|MPRO_TP_Ctrl|Touch probe: Control| |
| |0| |NONE (0) = No function|
| |1| |POS (1) = Positive edge|
| |2| |NEG (2) = Negative edge|
| |3| |BOTH (3) = Both edges|
|240|0 MPRO_TP_Ctrl| | |
|240|1 MPRO_TP_Ctrl| | |
|240|2 MPRO_TP_Ctrl| | |
|241|MPRO_TP_Position|Probe: Pos. high/low edge of TP0/1, encoder zero pulse| |

Table 8.29: “Touch probe” parameters

MOOG ID No.:CB40859-001 Date:11/2020

# 8 Motion profile

|Unit|Description|
|---|---|
|mDegree|Touch probe: Configuration|
|mDegree|TP0, TP1 touch probe|
|mDegree|TP0, TP1 as encoder, A/B as quadrature counting|
|mDegree|TP0, TP1 as encoder, pulse (TP0) / direction (TP1), count up on direction high|
|mDegree|TP0, TP1 as encoder, pulse (TP0) / direction (TP1), count down on direction high|
|mDegree|TP0 pulse counter, TP1 pulse counter|
|mDegree|TP0 pulse counter, TP1 touch probe|
|mDegree|TP1 touch probe, TP0 pulse counter|
|mDegree|TP0 encoder counter, TP1 encoder counter|
|mDegree|TP0 encoder counter, TP1 touch probe|
|mDegree|TP0 touch probe, TP1 encoder counter|

Touch probe: Channel

|Unit|Description|
|---|---|
|ACTPOS (0)|Actual position in user units|
|ACTPOSINC (1)|Actual position in increments|
|MASTERPOS (2)|Master position in increments|
|ENCPOS_CH1 (3)|Encoder position Channel 1|
|ENCPOS_CH1_INC (4)|Encoder position Channel 1 in increments|
|ENCPOS_CH2 (5)|Encoder position Channel 2|
|ENCPOS_CH2_INC (6)|Encoder position Channel 2 in increments|

# 8 Motion profile

MOOG ID No.:CB40859-001 Date:11/2020 MSD ServoDrive - DeviceHelp 276

|ID|Index Name / Setting|Unit|Description|
|---|---|---|---|
|7|ENCPOS_CH3 (7)| |Encoder position Channel 3|
|8|ENCPOS_CH3_INC (8)| |Encoder position Channel 3 in increments|
|9|ENCPOS_CH4 (9)| |Encoder position Channel 4|
|10|ENCPOS_CH4_INC (10)| |Encoder position Channel 4 in increments|
|11|ACTPOS2 (11)| |Actual position of redundant encoder in user units|
|12|Sercos (12)| |Referred to Sercos profile parameters S-x-0426, S-x-0427|
|13|UserRefPos(13)| |Reference position in user units|
|14|MasterPosST(14)| |Master position (ECAM, EGEAR) singleturn, always steps|
|15|CommonMasterPos(15)| |Master position (ECAM, EGEAR) singleturn, always steps|
|16|CommonMasterPosST(15)| |Master position (ECAM, EGEAR) singleturn, always steps|
|1402|MPRO_TP_Channel| | |
|1402|MPRO_TP_Channel| | |
|1402|MPRO_TP_Channel| | |
|1404|MPRO_TP_Lines| |Touch probe: Lines @ pulse counter on channel x|
|1404|MPRO_TP_Lines| | |
|1404|MPRO_TP_Lines| | |

Image 8.71: “Synchronized motion” screen

There are various modes available in the “synchronization mode” drop-down menu (P 242[0] - MPRO_ECAM_SyncModMode):

- Off(0) = Synchronized motion off
- ECAM_iPlc(1) = Electronic cam plate via MSD PLC
- EGEAR_iPlc(2) = Electr. gear unit via MSD PLC
- ECAM_PARA(3) = Electronic camming via parameters
- EGEAR_PARA(4) = Electronic gearing via parameters

NOTE: For more information refer to the bus system User Manuals or the description of the MSD PLC.

# 8.11.1 Electronic cam plate

The other parameters are configured in separate screens that can be accessed with the corresponding buttons.

- Master configuration (see Section ""Master configuration"" on page 280)
- Electronic gearing (see Section ""Electronic gearing"" on page 283)
- Electronic camming (see Section ""Electronic cam plate"" on page 277)

P 1318[0] - MPRO_ECAM_ControlWord is the control word for “synchronized motion” (see Section ""Control word for synchronized motion"" on page 279).

P 1326[0] - MPRO_ECAM_StatusWord is the status word for “synchronized motion” (see Section ""Status word for synchronized motion"" on page 279).

# 8.11.1.1 Table selection

|ID|Index Name|Unit|Description|
|---|---|---|---|
|1300|MPRO_ECAM_CTS_| |ECAM: CamTableSelect - Master reference|
|1301|MasterRef| | |
|1305|MPRO_ECAM_CTS_| |ECAM: CamTableSelect - Method for changing the camtable|
|1306|MPRO_ECAM_CTS_| |ECAM: CamTableSelect - Mode for changing the camtable|
|1307|MPRO_ECAM_CTS_|incr|ECAM: CamTableSelect - Distance for changing the camtable|
|242|MPRO_ECAM_| |ECAM / EGEAR: Mode of synchronized motion SyncModMode|
|265|MPRO_ECAM_| |ECAM / EGEAR: Slave speed factor (1 = 100%).|
|266|CamSlave_SpeedFactor| | |
|268|MPRO_ECAM_| |ECAM / EGEAR: Mode of switching off sync. motion|

# 8.11.1.2 Synchronization

|ID|Index Name|Unit|Description|
|---|---|---|---|
|1342|MPRO_ECAM_CI_|incr|ECAM: CamIn - Synchronization position (multiturn part)|
|1343|MPRO_ECAM_CO_|incr|ECAM: CamOut - Decoupling pos. (multiturn part)|
|1303|MPRO_ECAM_CI_|incr|ECAM: CamIn - Master offset|
|1308|MPRO_ECAM_CI_| |ECAM: CamIn - Master reference|
|1309|MPRO_ECAM_CI_| |ECAM: CamIn - Slave reference|
|1310|MPRO_ECAM_CI_| |ECAM: CamIn - Coupling mode|
|1311|MPRO_ECAM_CI_|incr|ECAM: CamIn - Coupling distance|
|1312|MPRO_ECAM_CI_|incr|ECAM: CamIn - Synchronization position|

Table 8.31: “Electronic camming - Table selection” parameters

Table 8.30: “Synchronized motion” parameters

Table 8.32: “Electronic camming - Synchronization” parameters

MOOG ID No.:CB40859-001 Date:11/2020

MSD ServoDrive - DeviceHelp 277

# 8 Motion profile

MOOG ID No.:CB40859-001 Date:11/2020 MSD ServoDrive - DeviceHelp 278

|ID|Index|Name|Unit|Description|
|---|---|---|---|---|
|1313|0|MPRO_ECAM_CO_SyncPosST|(singleturn part)|ECAM: CamOut - Slave reference|
|1314|0|MPRO_ECAM_CO_DecouplingMode|63|ECAM: CamOut - Decoupling mode|
|1315|0|MPRO_ECAM_CO_BreakingPosST|incr|ECAM: CamOut - Decoupling position|
|1316|0|MPRO_ECAM_CO_DecouplingDist|incr|ECAM: CamOut - Decoupling distance|
|1317|0|MPRO_ECAM_CO_StandstillPos|mDegree|ECAM: CamOut - Slave standstill position|

# Table 8.32: “Electronic camming - Synchronization” parameters (continue)

|ID|Index|Name|Unit|Description|
|---|---|---|---|---|
|1346| |MPRO_ECAM_SP_Table| |ECAM: Setpoint table interface|
|1346|0|Index| |Index of setpoint table|
|1346|1|Value| |Value at index of setpoint table|
|1347|0 to 31|MPRO_ECAM_SP_Index| |ECAM: Setpoint segments start index|
|1348|0 to 31|MPRO_ECAM_SP_Length| |ECAM: Setpoint segments length|
|1349|0 to 31|Length| | |
|1350|0|MPRO_ECAM_SP_MaDist| |ECAM: Setpoint segments master distance|
|1351|0|MPRO_ECAM_SP_IpoType| |ECAM: Setpoint segments interpolation type|
|1352|0 to 31|Checksum| |ECAM: Setpoint table checksum|
|1353|0 to 31|GainNum| |ECAM: Setpoint segments gain numerator|
| | |GainDen| |ECAM: Setpoint segments gain denominator|

# Table 8.33: “Electronic camming - Table segments” parameters

|ID|Index|Name|Unit|Description|
|---|---|---|---|---|
|1329|0 to 63|MPRO_ECAM_SegData_IndexNext| |ECAM: Index of the following segment|
|1330|0 to 63|MPRO_ECAM_SegData_IndexPrev| |ECAM: Index of the previous segment|
|1331|0 to 63|MPRO_ECAM_SegData_ProfileMode| |ECAM: Profile mode of the current segment|
|1332|0 to 63|MPRO_ECAM_SegData_DistMaster| |ECAM: Length of the master section of the current segment|
|1333|0 to 63|MPRO_ECAM_SegData_DistSlave| |ECAM: Length of the slave section of the current segment|
|1334|0 to 63|MPRO_ECAM_SegData_Lambda| |ECAM: Lambda value of the current segment|
|1335|0 to 63|MPRO_ECAM_SegData_StatusWord| |ECAM: Status word of the current segment|
|1336|0 to 63|MPRO_ECAM_SegData_ControlWord| |ECAM: Control word of the current segment|

# 8.11.2 Control word for synchronized motion

|Bit|Function|PLC function|Bit number|Description|
|---|---|---|---|---|
|0-7|Start segment (8-bit value)|-|0-7|Actual segment (8-bit value)|
|8-15|Reserved|-| |Actual ECAM / EGEAR state machine state (4 Bit value)|
|16|Absolute (true) / relative (false) master relationship|-| |- 0: ECAM / EGEAR asynchronous
- 1: ECAM / EGEAR synchronous
|
|17|Absolute (true) / relative (false) master (CAM) relationship at cam in|-| |- 2: ECAM / EGEAR synchronizing
- 3: ECAM / EGEAR desynchronizing
|
|18|Absolute (true) / relative (false) slave (CAM) relationship at cam in|-| |- 4: ECAM / EGEAR active and waiting for going asynchronous
|
|19-23|Reserved|-| |- 5: ECAM / EGEAR inactive and waiting for going synchronous
|
|24|Change gear ratio of the electronic gear online|MCB_GearRatioChange| | |
|25|Disable master calculation|MCB_Cam_MasterEnable| | |
|26|Enable master calculation|MCB_Cam_MasterEnable| | |
|27|Select CAM table|MCB_CamTableSelect| | |
|28|Start Ecam|MCB_CamIn| | |
|29|Stop Ecam|MCB_CamOut| | |
|30|Start Egear|MCB_GearIn| | |
|31|Stop Egear|MCB_GearOut| | |

# 8.11.3 Status word for synchronized motion

|Bit|Function|PLC function|Bit number|Description|
|---|---|---|---|---|
|12-26|Reserved|-| | |
|27|ECAM / EGEAR is active|-| | |
|28|Valid segments chosen|-| | |
|29|Master data are valid|-| | |
|30|Master is initialized|-| | |
|31|Master calculation is active|-| | |

Table 8.35: Control word ECAM (P 1318[0] - MPRO_ECAM_ControlWord)

Table 8.36: ECAM status word (P 1326[0] - MPRO_ECAM_StatusWord)

MOOG ID No.:CB40859-001 Date:11/2020 MSD ServoDrive - DeviceHelp 279

# 8 Motion profile

# 8 Motion profile

MOOG ID No.:CB40859-001 Date:11/2020

MSD ServoDrive - DeviceHelp 280

# 8.11.4 Master configuration

the master encoder, you will need to set the resolution relative to a single motor revolution in P 250 - MPRO_ECAM_PARAMaster_Amplitude (see below).

- ENC CH1 (3) = Encoder channel 1 X7 (Sin/Cos)
- ENC CH2 (4) = Encoder channel 2 X6 (Resolver)
- ENC CH3 (5) = Encoder channel 3 X8 (optional)

This function is only available if an external interface X8 (option module) is present.

- TP0 (6) = Pulse counter on probe channel 0 (TP0)
- TP1 (7) = Pulse counter on probe channel 1 (TP1)
- ENC_CH4 (8) = Encoder channel 4 (p. e. fieldbus)
- TWIN_POS (9) = TWIN remote reference position (P-2607)

Image 8.72: “Master configuration” screen

# Channel selection (master encoder)

P 1319[0] - MPRO_ECAM_CamMaster_AxisType is used to define the master encoder.

- NO AXIS (0) = No axis
- VIRTUAL MASTER (1) = Virtual master

If you select this function, you will be able to configure additional settings by clicking on the enabled “Options...” button (see Section ""Virtual Master"" on page 286).

- PARA (2) = Master parameter interface

If you select this function because a higher-level controller is being used as

# Anti-reverse mode

Slave only starts moving along with it again as soon as the master reaches the zero position.

P 1320[0] - MPRO_ECAM_CamMaster_RevLockMode is used to define the reverse lock mode, which can be used either with or without path compensation. The dashed lines in the following diagrams indicate what the engagement distance is:

# Example:

If the master, which has moved two motor revolutions in the direction blocked for the slave, then moves in the unblocked direction again, the slave only moves off when the master has traversed the zero point.

- INACTIVE (0) = Reverse lock inactive
- ACTIVE (2) = Reverse lock enabled - without path optimization
- ACTIVE WAY COMP (1) = Reverse lock active - with way compensation

While the slave accelerates to the speed of the master during engagement, the master and slave do not move synchronously. This function needs to be selected in order to quickly catch up to the master that is running ahead.

# Example:

- Master (black line) rotates in the blocked direction
- The slave (blue line) remains stopped
- Master rotates in the unblocked direction again
- The slave follows the master directly in the unblocked direction

Assume the master has moved two motor revolutions in the direction for which the slave lock is enabled. If the master now moves in the direction for which there is no lock, the slave will immediately start running in that direction.

MOOG ID No.:CB40859-001 Date:11/2020

MSD ServoDrive - DeviceHelp 281

# 8 Motion profile

MOOG ID No.:CB40859-001 Date:11/2020 MSD ServoDrive - DeviceHelp 282

|Filter type|ID|Index Name|Unit|Description|
|---|---|---|---|---|
|When using a real master encoder, encoder signals may be subject to noise.|P 1340|1319|0|MPRO_ECAM_CamMaster_AxisType|
| | |MPRO_ECAM_CamMaster_SpeedFilTyp| |ECAM / EGEAR: Channel selection of internal master input|
| | |1320|0|MPRO_ECAM_CamMaster_RevLockMode|
| | |1321|0|MPRO_ECAM_CamMaster_Amplitude|
| | |1322|0|MPRO_ECAM_CamMaster_GearNum|
| | |1323|0|MPRO_ECAM_CamMaster_GearDen|
|Filter time|1327|0|ms|ECAM / EGEAR: Filter time constant of master|
|If P 1340[0] is used to enable a filter, P 1327[0] - MPRO_ECAM_CamMaster_SpeedTFil can be used to define the corresponding filter time.|1328|0|speed|ECAM / EGEAR: Speed factor of the internal master|
|Speed factor|1340|0| |MPRO_ECAM_CamMaster_SpeedFilTyp|
|The master encoder can be assigned an additional speed factor P 1328[0] - MPRO_ECAM_CamMaster_SpeedFactor.|1341|0|incr|ECAM / EGEAR: Master drive offset|

Table 8.37: “Synchronized motion - Master configuration” parameters (continue)

| | | |ID|Index Name|Unit|Description|
|---|---|---|---|---|---|---|
|247|0|MPRO_ECAM_ParaMaster_ActPos|incr|ECAM / EGEAR: Parameter interface master position| | |
|248|0|MPRO_ECAM_ParaMaster_ActSpeed|rpm|ECAM / EGEAR: Parameter interface master speed| | |
|249|0|MPRO_ECAM_ParaMaster_ActAcc|rpm|ECAM / EGEAR: Parameter interface master acceleration| | |
| |250|0|MPRO_ECAM_ParaMaster_Amplitude| |ECAM / EGEAR: Parameter interface master amplitude| |

Table 8.37: “Synchronized motion - Master configuration” parameters

# 8.11.5 Electronic gearing

# Gear ratio

The gear ratio is specified as a fraction. This ensures that the position references can be translated to the motor shaft with no rounding error.

- ""Slave"" (P 252[0] - MPRO_ECAM_Egear_GearNum) is the numerator
- ""Master"" (P 251[0] - MPRO_ECAM_Egear_GearDen) is the denominator

# Scaling of speed pre-control

Defined with P 265[0] - MPRO_ECAM_CamSlave_SpeedFactor definiert.

# Scaling of torque pre-control

Defined with P 266[0] - MPRO_ECAM_CamSlave_TorqueFactor.

# Engagement

See Section ""Engagement"" on page 284.

# Disengagement

See Section ""Disengagement"" on page 285.

|ID|Index Name|Unit|Description|
|---|---|---|---|
|251|0 MPRO_ECAM_Egear_GearDen| |EGEAR: Gear denominator|
|252|0 MPRO_ECAM_Egear_GearNum| |EGEAR: Numerator of gear ratio|
|1344|0 MPRO_ECAM_Egear_LimRefAcc|rpm/s|EGEAR: Acceleration limit for reference|
|1345|0 MPRO_ECAM_Egear_LimRefJerk|rpm/s²|EGEAR: Jerk limit for reference|

Table 8.38: “Synchronized motion - Electronic gearing” parameters

Image 8.73: ""Electronic gearing"" screen

MOOG ID No.:CB40859-001 Date:11/2020 MSD ServoDrive - DeviceHelp 283

# 8 Motion profile

# 8 Motion profile

MOOG ID No.:CB40859-001 Date:11/2020

MSD ServoDrive - DeviceHelp 284

# 8.11.6 Engagement

used to define the engagement distance (between the dashed lines).

P 253[0] - MPRO_ECAM_Egear_GearInMode is used to define the mode for engagement.

- DIRECT (0) = Direct
- Direct engagement: Angular synchronous; with jerking (no ramps).
- CROSSFADE (3) = Crossfading
- Engagement with crossfading function (5th degree polynomial): Angular synchronous; jerk-limited; speed will overshoot during engagement.
- RAMP (1) = Linear speed ramp
- Engagement with linear acceleration: Not angular synchronous; with jerking.
- FADE (2) = Engagement fade-out
- Engagement with fade-in function (5th degree polynomial): Not angular synchronous; jerk-limited. The position is ignored. ",How are the analog inputs ISA00 and ISA01 configured in the 'MSD ServoDrive - DeviceHelp' document?,A2,Configure ISA00 and ISA01 with negative values for analog or positive for digital setpoints.,0.4296875,0.306640625,2.984375,1.2109375,0.345703125
2,msd_servo_drive.txt,76,b87ca5e232c2bdbb6fa16a8a401c6b5d285dc0183e73cc9d134de13dd2fc71d2,"MOOG ID No.:CB40859-001 Date:11/2020

MSD ServoDrive - DeviceHelp 267

# 8 Motion profile

MOOG ID No.:CB40859-001 Date:11/2020 MSD ServoDrive - DeviceHelp 268

# Deceleration

With ...

- P 194 - MPRO_TAB_TDec (for torque control) or
- P 197 - MPRO_TAB_SDec (for speed control) or
- P 200 - MPRO_TAB_PDec (for position control)

and indexes 0–15, the deceleration for each individual motion task can be defined. The input must not be zero.

# Wait time in Auto mode

P 204 - MPRO_TAB_WaitTime is used to define the wait time before the next motion task is carried out.

# Maximum table index in Auto mode

P 206[0] - MPRO_Tab_MaxIdx is used to define the table index up to which driving jobs will be carried out in one of the auto modes.

# Current table index

P 207[0] - MPRO_Tab_ActIdx will show the index for the motion task that is currently active. If parameter P 205 MPRO_TAB_Mode is set to “Para(0)”, a driving set can be entered and approached directly.

# Activation of reference table

The following procedures can be used in order to activate the setpoint table for operation.

|ID|Index Name|Unit|Description|
|---|---|---|---|
|193|MPRO_TAB_TAcc|TAB: Torque mode acceleration|Nm/ms|
|193|0|MPRO_TAB_TAcc|Nm/ms|
|193|1 - 15|MPRO_TAB_TAcc|Nm/ms|
|194|MPRO_TAB_TDec|TAB: Torque mode deceleration| |
|194|0|MPRO_TAB_TDec|Nm/ms|
|194|1 - 15|MPRO_TAB_TDec|Nm/ms|

# Table 8.23: Activation of table references

# Table 8.24: “Setpoint table settings” parameters

# Table 8.24: “Setpoint table settings” parameters (continue)

|ID|Index Name|Unit|Description|ID|Index Name|Unit|Description|
|---|---|---|---|---|---|---|---|
|195|MPRO_TAB_TRef|Nm|TAB: Torque mode reference value|208|MPRO_TAB_OutputNo| |OSD TAB: actual table index and target|
|195|MPRO_TAB_TRef|Nm| |208|MPRO_TAB_OutputNo| | |
|196|MPRO_TAB_SAcc|rev/min/s|TAB: Speed mode acceleration|269|MPRO_TAB_Ctrl| |TAB: control word|
|196|MPRO_TAB_SAcc|rev/min/s| | | | | |
|197|MPRO_TAB_SDec|rev/min/s|TAB: Speed mode deceleration| | | | |
|197|MPRO_TAB_SDec|rev/min/s| | | | | |
|198|MPRO_TAB_SRef|rev/min|TAB: Speed mode reference value| | | | |
|198|MPRO_TAB_SRef|rev/min| | | | | |
|199|MPRO_TAB_PAcc|rev/min/s|TAB: Position control mode acceleration| | | | |
|199|MPRO_TAB_PAcc|rev/min/s| | | | | |
|200|MPRO_TAB_PDec|rev/min/s|TAB: Position control mode Acceleration| | | | |
|200|MPRO_TAB_PDec|rev/min/s| | | | | |
|201|MPRO_TAB_PSpd|rev/min|TAB: Position control mode speed| | | | |
|201|MPRO_TAB_PSpd|rev/min| | | | | |
|202|MPRO_TAB_PPos|mDegree|TAB: Position control mode reference value| | | | |
|202|MPRO_TAB_PPos|mDegree| | | | | |
|203|MPRO_TAB_PMode| |Position control table:Mode| | | | |
|203|MPRO_TAB_PMode| | | | | | |
|204|MPRO_TAB_WaitTime|ms|TAB: Wait time| | | | |
|204|MPRO_TAB_WaitTime|ms| | | | | |
|205|MPRO_TAB_Mode| |TAB mode| | | | |
|206|MPRO_Tab_MaxIdx| |TAB: Max index in AUTO mode| | | | |
|207|MPRO_TAB_ActIdx| |TAB: Actual index| | | | |

MOOG ID No.:CB40859-001 Date:11/2020

MSD ServoDrive - DeviceHelp

# 8 Motion profile

MOOG ID No.:CB40859-001 Date:11/2020

MSD ServoDrive - DeviceHelp 270

# 8.8 Analog channel (ISA00 und ISA01)

# Offset (O)

This parameter (P 174 - MPRO_ANA0_SOffset for ISA00, P 184 - MPRO_ANA1_SOffset for ISA01) compensates for component variations and is used for offset compensation purposes. Depending on the control mode being used (see Section ""Basic settings"" on page 110), the value will be stored in parameter index [0] (torque control), [1] (speed control) or [2] (position control).

# Backlash (B)

This parameter (P 175 - MPRO_ANA0_SThreshold for ISA00, P 185 - MPRO_ANA1_SThreshold for ISA01) can suppress axis motion close to the standstill (stop) position. Depending on the control mode being used (see Section ""Basic settings"" on page 110), the value will be stored in parameter index [0] (torque control), [1] (speed control) or [2] (position control).

Image 8.68: “Analog channel” screen

# Acceleration ramp

Two standard analog inputs (ISA00, ISA01) are available. These inputs can be configured...

- with negative values for analog setpoint settings
- with positive values for digital setpoint processing

(P 109[0] - MPRO_INPUT_FS_ISA00 and P 110[0] - MPRO_INPUT_FS_ISA01).

see also section ""Analog Inputs"" on page 303. By using the ""REV(-2) = Analog setpoint"" setting, an analog input voltage of ±10 V can be processed as a setpoint.

# Deceleration ramp

This parameter serves as a deceleration ramp for torque control (P 176[1] - MPRO_ANA0_TRamp for ISA00, P 186[1] - MPRO_ANA1_TRamp for ISA01) or speed control (P 177[1] - MPRO_ANA0_SRamp for ISA00, P 187[1] - MPRO_ANA1_SRamp for ISA01). Depending on the control mode being used (see Section ""Basic settings"" on page 110), the value will be stored in parameter index [0] (torque control), [1] (speed control) or [2] (position control).

This parameter (P 173 - MPRO_ANA0_Scale for ISA00, P 183 - MPRO_ANA1_Scale for ISA01) is used to define which speed / which torque / which position corresponds to the maximum analog value. Depending on the control mode being used (see Section ""Basic settings"" on page 110), the value will be stored in parameter index [0] (torque control), [1] (speed control) or [2] (position control).

# 8.8.1 Special characteristics of position control mode

A threshold value can also be specified which generates a run-on range around the last reference value. A ramp function calculates a motion profile for the position reference from pre-defined acceleration and speed limits.

The position references on the analog channel are not applied immediately, but dependent on a digital input. Accordingly, one of the ISD00 to ISD06 digital inputs must be set to a value of ""REFANAEN(28) = Enable analog reference value"" (see Section ""Digital inputs"" on page 290). The position setpoint being received will only be applied if the corresponding digital input is active. The acceleration is entered using P 173[0] - MPRO_ANA0_TScale or P 183[0] - MPRO_ANA1_TScale.

# 8.8.2 Wire Break Monitoring

P 399 - CON_ANAWireBrk_Th can be used to configure wire break monitoring for the analog inputs. For details see Section ""Wire Break Monitoring"" on page 306.

|Function|TLIM (-4)|OVR (-3)|REFV (-2)|leer (-1)|OFF (0)|
|---|---|---|---|---|---|
|Digital|(1)-(28)|(1)-(28)|(1)-(28)|(1)-(28)|(1)-(28)|
|Analog channel|Filter|Scale|Offset|Profile|generator|

Control

Image 8.69: Reference processing structure

MOOG ID No.:CB40859-001 Date:11/2020

MSD ServoDrive - DeviceHelp 271

# 8 Motion profile

# 8 Motion profile

MOOG ID No.:CB40859-001 Date:11/2020

|ID|Index Name|Unit|Description|ID|
|---|---|---|---|---|
|395|CON_ANA_Isaf_Scaled| |Analog inputs: Values (filt, norm, comp, scaled)|174|
|395|0 ISA00| |Scaled, compensated, filtered, normalized value|175|
|395|1 ISA01| |Scaled, compensated, filtered, normalized value| |
|396|CON_ANA_Scale_ThUpper| |Analog inputs: Upper scaling limits|175|
|396|0 ISA00|%|Upper scaling (@ 10 V) threshold|175|
|396|1 ISA01|%|Upper scaling (@ 10 V) threshold| |
|397|CON_ANA_Scale_ThZero| |Analog inputs: Zero scaling thresholds|176|
|397|0 ISA00|V|Zero scaling threshold (+/-)|176|
|397|1 ISA01|V|Zero scaling threshold (+/-)| |
|398|CON_ANA_Scale_ThLower| |Analog inputs: Lower scaling limits|177|
|398|0 ISA00|%|Lower scaling (@ zero threshold) threshold|177|
|398|1 ISA01|%|Lower scaling (@ zero threshold) threshold| |
|399|CON_ANA_WireBrk_Th| |Analog inputs: Wire break thresholds|Table 8.26:|
|399|0 ISA00|V|Wire break detection threshold| |
|399|1 ISA01|V|Wire break detection threshold| |
|405|0 CON_ANA_Filt0|ms|Analog input ISA00: Filter time constant (PT 1)|ID|
|408|CON_ANA_Isaf_Norm| |Analog inputs: Values (filt, norm)|183|
|408|0 ISA00| |Filtered, normalized value|183|
|408|1 ISA01| |Filtered, normalized value|183|

Table 8.25: “Analog channel” parameters

|ID|Index Name|Unit|Description|ID|
|---|---|---|---|---|
|173|MPRO_ANA0_Scale| |ANA0: scale factors|184|
|173|0 MPRO_ANA0_TScale|Nm|ANA0: scale factor torque reference|185|
|173|1 MPRO_ANA0_SScale|rev/min|ANA0: scale factor speed reference|185|
|173|2 MPRO_ANA0_PScale|mDegree|ANA0: scale factor position reference| |
|174|MPRO_ANA0_Offset| |ANA0: offsets|185|
|174|0 MPRO_ANA0_TOffset|Nm|ANA0: offsets for torque reference|185|

Table 8.26: “Analog channel ISA00” parameters

|Index Name|Unit|Description|
|---|---|---|
|1 MPRO_ANA0_SOffset|rev/min|ANA0: offsets for speed reference|
|2 MPRO_ANA0_POffset|mDegree|ANA0: offsets for position reference|
|MPRO_ANA0_Threshold| |ANA0: thresholds|
|0 MPRO_ANA0_TThreshold|Nm|ANA0: threshold for torque reference|
|1 MPRO_ANA0_SThreshold|rev/min|ANA0: threshold for speed reference|
|2 MPRO_ANA0_PThreshold|mDegree|ANA0: threshold for position reference|
|MPRO_ANA0_TRamp| |ANA0: Torque mode acceleration [0] and deceleration [1]|
|0 MPRO_ANA0_TRamp|Nm/s| |
|1 MPRO_ANA0_TRamp|Nm/s| |
|MPRO_ANA0_SRamp| |ANA0: Speed mode acceleration [0] and deceleration [1]|
|0 MPRO_ANA0_SRamp|SPEED/s| |
|1 MPRO_ANA0_SRamp|SPEED/s| |

“Analog channel ISA00” parameters (continue)

|Index Name|Unit|Description|
|---|---|---|
|MPRO_ANA1_Scale| |ANA1: scale factors|
|0 MPRO_ANA1_TScale|Nm|ANA0: scale factor torque reference|
|1 MPRO_ANA1_SScale|rev/min|ANA0: scale factor speed reference|
|2 MPRO_ANA1_PScale|mDegree|ANA0: scale factor position reference|
|MPRO_ANA1_Offset| |ANA1: offsets|
|0 MPRO_ANA1_TOffset|Nm|ANA1: offsets for torque reference|
|1 MPRO_ANA1_SOffset|rev/min|ANA1: offsets for speed reference|
|2 MPRO_ANA1_POffset|mDegree|ANA1: offsets for position reference|
|MPRO_ANA1_Threshold| |ANA1: thresholds|
|0 MPRO_ANA1_TThreshold|Nm|ANA1: threshold for torque reference|
|1 MPRO_ANA1_SThreshold|rev/min|ANA1: threshold for speed reference|
|2 MPRO_ANA1_PThreshold|mDegree|ANA1: threshold for position reference|

“Analog channel ISA01” parameters

# 8 Motion profile

|ID|Index Name|Unit|Description|
|---|---|---|---|
|186|MPRO_ANA1_TRamp|Nm/s|ANA1: Torque mode acceleration [0] and deceleration[1]|
|186|MPRO_ANA1_TRamp|Nm/s| |
|187|MPRO_ANA1_SRamp|SPEED/s|ANA1: Speed mode acceleration [0] and deceleration [1]|
|187|MPRO_ANA1_SRamp|SPEED/s| |

# Table 8.27: “Analog channel ISA01” parameters (continue)

Display

- System state
- Initialization on device startup
- Not ready (DC link voltage possibly too low)
- Start inhibit (DC link voltage present, power stage off)
- Starting lockout
- Ready for start
- Control initialization: Auto commutation, flux build-up etc.

# Table 8.28: Central state machine according to CiA 402 device display

MOOG ID No.:CB40859-001 Date:11/2020

MSD ServoDrive - DeviceHelp 273

# 8 Motion profile

MOOG ID No.:CB40859-001 Date:11/2020

MSD ServoDrive - DeviceHelp 274

|Display|System state|power disabled|fault|
|---|---|---|---|
|Control enabled|0|Start|7|
| |fault reaction active|0|14|
|Quick stop active|1|not ready|8|
| |to switch on|1|17|
|Error reaction active|2|switch on|disabled|
| |2|7| |
|Error state (in this state the error is indicated directly on the display.)|3|ready to|switch on|
|Device is reset (display flashes)|power enabled|3|6|
| |10|12| |
|• Number [5.] flashes when “STO” (Safe Torque Off) input is active. Display goes out when STO inactive.| | | |
|• The dot on the display flashes when the power stage is active.| | | |

Table 8.28: Central state machine according to CiA 402 device display (continue)

NOTE

l The system states indicated on the display may differ from the states in the table depending on the drive profile setting.

Image 8.70: State machine diagram based on CANopen communications

⓪ to ① State number

1 to 17 State transition (No. 17: DC link voltage cut off)

Legend for “State machine diagram based on CANopen communications” figure

# 8.10 Touch probe

|ID|Index Name / Setting|
|---|---|
|241|0 MPRO_TP_Position|
|241|1 MPRO_TP_Position|
|241|2 MPRO_TP_Position|
|241|3 MPRO_TP_Position|
|241|4 MPRO_TP_Position|
|1400|0 MPRO_TP_Config|
| |TP_TP (0)|
| |AB (1)|
| |PD_UP (2)|
| |PD_DOWN (3)|
| |PC_PC (4)|
| |PC_TP (5)|
| |TP_PC (6)|
| |ENC_ENC (7)|
| |ENC_TP (8)|
| |TP_ENC (9)|

Using the touch probe inputs, touch probe functions can be performed. In order to be able to do this, P 106[0] - MPRO_INPUT_FS_ISD05 and P 107[0] - MPRO_INPUT_FS_ISD06 must be used to set digital inputs ISD05 and ISD06 to ""PROBE(15) = Touch probe (only ISD05/06)"" (see Section ""Digital inputs"" on page 290). HTL encoders can be evaluated or pulse counters implemented using the MSD PLC.

The touch probe can be triggered with P 240 - MPRO_TP_Ctrl. This enables triggering on a positive or negative edge, or on both edges, of the signal detected on the touch probe inputs. After the measurement, the parameter jumps back to the value ""NONE (0)"" and the latch position is mapped in the corresponding subindex of parameter P 241 - MPRO_TP_Position. A continuous touch probe mode is not possible at present, so the touch probe has to be reactivated after the measurement.

P 1402 - MPRO_TP_Channel can be used to select various positions as actual value sources of the latch position for the touch probe functionality. The following table provides an overview of the available settings. The counters are accessed via the MSD PLC or a bus system.

|ID|Index Name / Setting|Unit|Description|
|---|---|---|---|
|240|MPRO_TP_Ctrl|Touch probe: Control| |
| |0| |NONE (0) = No function|
| |1| |POS (1) = Positive edge|
| |2| |NEG (2) = Negative edge|
| |3| |BOTH (3) = Both edges|
|240|0 MPRO_TP_Ctrl| | |
|240|1 MPRO_TP_Ctrl| | |
|240|2 MPRO_TP_Ctrl| | |
|241|MPRO_TP_Position|Probe: Pos. high/low edge of TP0/1, encoder zero pulse| |

Table 8.29: “Touch probe” parameters

MOOG ID No.:CB40859-001 Date:11/2020

# 8 Motion profile

|Unit|Description|
|---|---|
|mDegree|Touch probe: Configuration|
|mDegree|TP0, TP1 touch probe|
|mDegree|TP0, TP1 as encoder, A/B as quadrature counting|
|mDegree|TP0, TP1 as encoder, pulse (TP0) / direction (TP1), count up on direction high|
|mDegree|TP0, TP1 as encoder, pulse (TP0) / direction (TP1), count down on direction high|
|mDegree|TP0 pulse counter, TP1 pulse counter|
|mDegree|TP0 pulse counter, TP1 touch probe|
|mDegree|TP1 touch probe, TP0 pulse counter|
|mDegree|TP0 encoder counter, TP1 encoder counter|
|mDegree|TP0 encoder counter, TP1 touch probe|
|mDegree|TP0 touch probe, TP1 encoder counter|

Touch probe: Channel

|Unit|Description|
|---|---|
|ACTPOS (0)|Actual position in user units|
|ACTPOSINC (1)|Actual position in increments|
|MASTERPOS (2)|Master position in increments|
|ENCPOS_CH1 (3)|Encoder position Channel 1|
|ENCPOS_CH1_INC (4)|Encoder position Channel 1 in increments|
|ENCPOS_CH2 (5)|Encoder position Channel 2|
|ENCPOS_CH2_INC (6)|Encoder position Channel 2 in increments|

# 8 Motion profile

MOOG ID No.:CB40859-001 Date:11/2020 MSD ServoDrive - DeviceHelp 276

|ID|Index Name / Setting|Unit|Description|
|---|---|---|---|
|7|ENCPOS_CH3 (7)| |Encoder position Channel 3|
|8|ENCPOS_CH3_INC (8)| |Encoder position Channel 3 in increments|
|9|ENCPOS_CH4 (9)| |Encoder position Channel 4|
|10|ENCPOS_CH4_INC (10)| |Encoder position Channel 4 in increments|
|11|ACTPOS2 (11)| |Actual position of redundant encoder in user units|
|12|Sercos (12)| |Referred to Sercos profile parameters S-x-0426, S-x-0427|
|13|UserRefPos(13)| |Reference position in user units|
|14|MasterPosST(14)| |Master position (ECAM, EGEAR) singleturn, always steps|
|15|CommonMasterPos(15)| |Master position (ECAM, EGEAR) singleturn, always steps|
|16|CommonMasterPosST(15)| |Master position (ECAM, EGEAR) singleturn, always steps|
|1402|MPRO_TP_Channel| | |
|1402|MPRO_TP_Channel| | |
|1402|MPRO_TP_Channel| | |
|1404|MPRO_TP_Lines| |Touch probe: Lines @ pulse counter on channel x|
|1404|MPRO_TP_Lines| | |
|1404|MPRO_TP_Lines| | |

Image 8.71: “Synchronized motion” screen

There are various modes available in the “synchronization mode” drop-down menu (P 242[0] - MPRO_ECAM_SyncModMode):

- Off(0) = Synchronized motion off
- ECAM_iPlc(1) = Electronic cam plate via MSD PLC
- EGEAR_iPlc(2) = Electr. gear unit via MSD PLC
- ECAM_PARA(3) = Electronic camming via parameters
- EGEAR_PARA(4) = Electronic gearing via parameters

NOTE: For more information refer to the bus system User Manuals or the description of the MSD PLC.

# 8.11.1 Electronic cam plate

The other parameters are configured in separate screens that can be accessed with the corresponding buttons.

- Master configuration (see Section ""Master configuration"" on page 280)
- Electronic gearing (see Section ""Electronic gearing"" on page 283)
- Electronic camming (see Section ""Electronic cam plate"" on page 277)

P 1318[0] - MPRO_ECAM_ControlWord is the control word for “synchronized motion” (see Section ""Control word for synchronized motion"" on page 279).

P 1326[0] - MPRO_ECAM_StatusWord is the status word for “synchronized motion” (see Section ""Status word for synchronized motion"" on page 279).

# 8.11.1.1 Table selection

|ID|Index Name|Unit|Description|
|---|---|---|---|
|1300|MPRO_ECAM_CTS_| |ECAM: CamTableSelect - Master reference|
|1301|MasterRef| | |
|1305|MPRO_ECAM_CTS_| |ECAM: CamTableSelect - Method for changing the camtable|
|1306|MPRO_ECAM_CTS_| |ECAM: CamTableSelect - Mode for changing the camtable|
|1307|MPRO_ECAM_CTS_|incr|ECAM: CamTableSelect - Distance for changing the camtable|
|242|MPRO_ECAM_| |ECAM / EGEAR: Mode of synchronized motion SyncModMode|
|265|MPRO_ECAM_| |ECAM / EGEAR: Slave speed factor (1 = 100%).|
|266|CamSlave_SpeedFactor| | |
|268|MPRO_ECAM_| |ECAM / EGEAR: Mode of switching off sync. motion|

# 8.11.1.2 Synchronization

|ID|Index Name|Unit|Description|
|---|---|---|---|
|1342|MPRO_ECAM_CI_|incr|ECAM: CamIn - Synchronization position (multiturn part)|
|1343|MPRO_ECAM_CO_|incr|ECAM: CamOut - Decoupling pos. (multiturn part)|
|1303|MPRO_ECAM_CI_|incr|ECAM: CamIn - Master offset|
|1308|MPRO_ECAM_CI_| |ECAM: CamIn - Master reference|
|1309|MPRO_ECAM_CI_| |ECAM: CamIn - Slave reference|
|1310|MPRO_ECAM_CI_| |ECAM: CamIn - Coupling mode|
|1311|MPRO_ECAM_CI_|incr|ECAM: CamIn - Coupling distance|
|1312|MPRO_ECAM_CI_|incr|ECAM: CamIn - Synchronization position|

Table 8.31: “Electronic camming - Table selection” parameters

Table 8.30: “Synchronized motion” parameters

Table 8.32: “Electronic camming - Synchronization” parameters

MOOG ID No.:CB40859-001 Date:11/2020

MSD ServoDrive - DeviceHelp 277

# 8 Motion profile

MOOG ID No.:CB40859-001 Date:11/2020 MSD ServoDrive - DeviceHelp 278

|ID|Index|Name|Unit|Description|
|---|---|---|---|---|
|1313|0|MPRO_ECAM_CO_SyncPosST|(singleturn part)|ECAM: CamOut - Slave reference|
|1314|0|MPRO_ECAM_CO_DecouplingMode|63|ECAM: CamOut - Decoupling mode|
|1315|0|MPRO_ECAM_CO_BreakingPosST|incr|ECAM: CamOut - Decoupling position|
|1316|0|MPRO_ECAM_CO_DecouplingDist|incr|ECAM: CamOut - Decoupling distance|
|1317|0|MPRO_ECAM_CO_StandstillPos|mDegree|ECAM: CamOut - Slave standstill position|

# Table 8.32: “Electronic camming - Synchronization” parameters (continue)

|ID|Index|Name|Unit|Description|
|---|---|---|---|---|
|1346| |MPRO_ECAM_SP_Table| |ECAM: Setpoint table interface|
|1346|0|Index| |Index of setpoint table|
|1346|1|Value| |Value at index of setpoint table|
|1347|0 to 31|MPRO_ECAM_SP_Index| |ECAM: Setpoint segments start index|
|1348|0 to 31|MPRO_ECAM_SP_Length| |ECAM: Setpoint segments length|
|1349|0 to 31|Length| | |
|1350|0|MPRO_ECAM_SP_MaDist| |ECAM: Setpoint segments master distance|
|1351|0|MPRO_ECAM_SP_IpoType| |ECAM: Setpoint segments interpolation type|
|1352|0 to 31|Checksum| |ECAM: Setpoint table checksum|
|1353|0 to 31|GainNum| |ECAM: Setpoint segments gain numerator|
| | |GainDen| |ECAM: Setpoint segments gain denominator|

# Table 8.33: “Electronic camming - Table segments” parameters

|ID|Index|Name|Unit|Description|
|---|---|---|---|---|
|1329|0 to 63|MPRO_ECAM_SegData_IndexNext| |ECAM: Index of the following segment|
|1330|0 to 63|MPRO_ECAM_SegData_IndexPrev| |ECAM: Index of the previous segment|
|1331|0 to 63|MPRO_ECAM_SegData_ProfileMode| |ECAM: Profile mode of the current segment|
|1332|0 to 63|MPRO_ECAM_SegData_DistMaster| |ECAM: Length of the master section of the current segment|
|1333|0 to 63|MPRO_ECAM_SegData_DistSlave| |ECAM: Length of the slave section of the current segment|
|1334|0 to 63|MPRO_ECAM_SegData_Lambda| |ECAM: Lambda value of the current segment|
|1335|0 to 63|MPRO_ECAM_SegData_StatusWord| |ECAM: Status word of the current segment|
|1336|0 to 63|MPRO_ECAM_SegData_ControlWord| |ECAM: Control word of the current segment|

# 8.11.2 Control word for synchronized motion

|Bit|Function|PLC function|Bit number|Description|
|---|---|---|---|---|
|0-7|Start segment (8-bit value)|-|0-7|Actual segment (8-bit value)|
|8-15|Reserved|-| |Actual ECAM / EGEAR state machine state (4 Bit value)|
|16|Absolute (true) / relative (false) master relationship|-| |- 0: ECAM / EGEAR asynchronous
- 1: ECAM / EGEAR synchronous
|
|17|Absolute (true) / relative (false) master (CAM) relationship at cam in|-| |- 2: ECAM / EGEAR synchronizing
- 3: ECAM / EGEAR desynchronizing
|
|18|Absolute (true) / relative (false) slave (CAM) relationship at cam in|-| |- 4: ECAM / EGEAR active and waiting for going asynchronous
|
|19-23|Reserved|-| |- 5: ECAM / EGEAR inactive and waiting for going synchronous
|
|24|Change gear ratio of the electronic gear online|MCB_GearRatioChange| | |
|25|Disable master calculation|MCB_Cam_MasterEnable| | |
|26|Enable master calculation|MCB_Cam_MasterEnable| | |
|27|Select CAM table|MCB_CamTableSelect| | |
|28|Start Ecam|MCB_CamIn| | |
|29|Stop Ecam|MCB_CamOut| | |
|30|Start Egear|MCB_GearIn| | |
|31|Stop Egear|MCB_GearOut| | |

# 8.11.3 Status word for synchronized motion

|Bit|Function|PLC function|Bit number|Description|
|---|---|---|---|---|
|12-26|Reserved|-| | |
|27|ECAM / EGEAR is active|-| | |
|28|Valid segments chosen|-| | |
|29|Master data are valid|-| | |
|30|Master is initialized|-| | |
|31|Master calculation is active|-| | |

Table 8.35: Control word ECAM (P 1318[0] - MPRO_ECAM_ControlWord)

Table 8.36: ECAM status word (P 1326[0] - MPRO_ECAM_StatusWord)

MOOG ID No.:CB40859-001 Date:11/2020 MSD ServoDrive - DeviceHelp 279

# 8 Motion profile

# 8 Motion profile

MOOG ID No.:CB40859-001 Date:11/2020

MSD ServoDrive - DeviceHelp 280

# 8.11.4 Master configuration

the master encoder, you will need to set the resolution relative to a single motor revolution in P 250 - MPRO_ECAM_PARAMaster_Amplitude (see below).

- ENC CH1 (3) = Encoder channel 1 X7 (Sin/Cos)
- ENC CH2 (4) = Encoder channel 2 X6 (Resolver)
- ENC CH3 (5) = Encoder channel 3 X8 (optional)

This function is only available if an external interface X8 (option module) is present.

- TP0 (6) = Pulse counter on probe channel 0 (TP0)
- TP1 (7) = Pulse counter on probe channel 1 (TP1)
- ENC_CH4 (8) = Encoder channel 4 (p. e. fieldbus)
- TWIN_POS (9) = TWIN remote reference position (P-2607)

Image 8.72: “Master configuration” screen

# Channel selection (master encoder)

P 1319[0] - MPRO_ECAM_CamMaster_AxisType is used to define the master encoder.

- NO AXIS (0) = No axis
- VIRTUAL MASTER (1) = Virtual master

If you select this function, you will be able to configure additional settings by clicking on the enabled “Options...” button (see Section ""Virtual Master"" on page 286).

- PARA (2) = Master parameter interface

If you select this function because a higher-level controller is being used as

# Anti-reverse mode

Slave only starts moving along with it again as soon as the master reaches the zero position.

P 1320[0] - MPRO_ECAM_CamMaster_RevLockMode is used to define the reverse lock mode, which can be used either with or without path compensation. The dashed lines in the following diagrams indicate what the engagement distance is:

# Example:

If the master, which has moved two motor revolutions in the direction blocked for the slave, then moves in the unblocked direction again, the slave only moves off when the master has traversed the zero point.

- INACTIVE (0) = Reverse lock inactive
- ACTIVE (2) = Reverse lock enabled - without path optimization
- ACTIVE WAY COMP (1) = Reverse lock active - with way compensation

While the slave accelerates to the speed of the master during engagement, the master and slave do not move synchronously. This function needs to be selected in order to quickly catch up to the master that is running ahead.

# Example:

- Master (black line) rotates in the blocked direction
- The slave (blue line) remains stopped
- Master rotates in the unblocked direction again
- The slave follows the master directly in the unblocked direction

Assume the master has moved two motor revolutions in the direction for which the slave lock is enabled. If the master now moves in the direction for which there is no lock, the slave will immediately start running in that direction.

MOOG ID No.:CB40859-001 Date:11/2020

MSD ServoDrive - DeviceHelp 281

# 8 Motion profile

MOOG ID No.:CB40859-001 Date:11/2020 MSD ServoDrive - DeviceHelp 282

|Filter type|ID|Index Name|Unit|Description|
|---|---|---|---|---|
|When using a real master encoder, encoder signals may be subject to noise.|P 1340|1319|0|MPRO_ECAM_CamMaster_AxisType|
| | |MPRO_ECAM_CamMaster_SpeedFilTyp| |ECAM / EGEAR: Channel selection of internal master input|
| | |1320|0|MPRO_ECAM_CamMaster_RevLockMode|
| | |1321|0|MPRO_ECAM_CamMaster_Amplitude|
| | |1322|0|MPRO_ECAM_CamMaster_GearNum|
| | |1323|0|MPRO_ECAM_CamMaster_GearDen|
|Filter time|1327|0|ms|ECAM / EGEAR: Filter time constant of master|
|If P 1340[0] is used to enable a filter, P 1327[0] - MPRO_ECAM_CamMaster_SpeedTFil can be used to define the corresponding filter time.|1328|0|speed|ECAM / EGEAR: Speed factor of the internal master|
|Speed factor|1340|0| |MPRO_ECAM_CamMaster_SpeedFilTyp|
|The master encoder can be assigned an additional speed factor P 1328[0] - MPRO_ECAM_CamMaster_SpeedFactor.|1341|0|incr|ECAM / EGEAR: Master drive offset|

Table 8.37: “Synchronized motion - Master configuration” parameters (continue)

| | | |ID|Index Name|Unit|Description|
|---|---|---|---|---|---|---|
|247|0|MPRO_ECAM_ParaMaster_ActPos|incr|ECAM / EGEAR: Parameter interface master position| | |
|248|0|MPRO_ECAM_ParaMaster_ActSpeed|rpm|ECAM / EGEAR: Parameter interface master speed| | |
|249|0|MPRO_ECAM_ParaMaster_ActAcc|rpm|ECAM / EGEAR: Parameter interface master acceleration| | |
| |250|0|MPRO_ECAM_ParaMaster_Amplitude| |ECAM / EGEAR: Parameter interface master amplitude| |

Table 8.37: “Synchronized motion - Master configuration” parameters

# 8.11.5 Electronic gearing

# Gear ratio

The gear ratio is specified as a fraction. This ensures that the position references can be translated to the motor shaft with no rounding error.

- ""Slave"" (P 252[0] - MPRO_ECAM_Egear_GearNum) is the numerator
- ""Master"" (P 251[0] - MPRO_ECAM_Egear_GearDen) is the denominator

# Scaling of speed pre-control

Defined with P 265[0] - MPRO_ECAM_CamSlave_SpeedFactor definiert.

# Scaling of torque pre-control

Defined with P 266[0] - MPRO_ECAM_CamSlave_TorqueFactor.

# Engagement

See Section ""Engagement"" on page 284.

# Disengagement

See Section ""Disengagement"" on page 285.

|ID|Index Name|Unit|Description|
|---|---|---|---|
|251|0 MPRO_ECAM_Egear_GearDen| |EGEAR: Gear denominator|
|252|0 MPRO_ECAM_Egear_GearNum| |EGEAR: Numerator of gear ratio|
|1344|0 MPRO_ECAM_Egear_LimRefAcc|rpm/s|EGEAR: Acceleration limit for reference|
|1345|0 MPRO_ECAM_Egear_LimRefJerk|rpm/s²|EGEAR: Jerk limit for reference|

Table 8.38: “Synchronized motion - Electronic gearing” parameters

Image 8.73: ""Electronic gearing"" screen

MOOG ID No.:CB40859-001 Date:11/2020 MSD ServoDrive - DeviceHelp 283

# 8 Motion profile

# 8 Motion profile

MOOG ID No.:CB40859-001 Date:11/2020

MSD ServoDrive - DeviceHelp 284

# 8.11.6 Engagement

used to define the engagement distance (between the dashed lines).

P 253[0] - MPRO_ECAM_Egear_GearInMode is used to define the mode for engagement.

- DIRECT (0) = Direct
- Direct engagement: Angular synchronous; with jerking (no ramps).
- CROSSFADE (3) = Crossfading
- Engagement with crossfading function (5th degree polynomial): Angular synchronous; jerk-limited; speed will overshoot during engagement.
- RAMP (1) = Linear speed ramp
- Engagement with linear acceleration: Not angular synchronous; with jerking.
- FADE (2) = Engagement fade-out
- Engagement with fade-in function (5th degree polynomial): Not angular synchronous; jerk-limited. The position is ignored. ",How are the analog inputs ISA00 and ISA01 configured in the 'MSD ServoDrive - DeviceHelp' document?,A3,Settings P 109[0] and P 110[0] allow configuration for analog or digital setpoint processing.,1.09375,1.15625,3.21875,1.328125,0.2490234375
3,msd_servo_drive.txt,76,b87ca5e232c2bdbb6fa16a8a401c6b5d285dc0183e73cc9d134de13dd2fc71d2,"MOOG ID No.:CB40859-001 Date:11/2020

MSD ServoDrive - DeviceHelp 267

# 8 Motion profile

MOOG ID No.:CB40859-001 Date:11/2020 MSD ServoDrive - DeviceHelp 268

# Deceleration

With ...

- P 194 - MPRO_TAB_TDec (for torque control) or
- P 197 - MPRO_TAB_SDec (for speed control) or
- P 200 - MPRO_TAB_PDec (for position control)

and indexes 0–15, the deceleration for each individual motion task can be defined. The input must not be zero.

# Wait time in Auto mode

P 204 - MPRO_TAB_WaitTime is used to define the wait time before the next motion task is carried out.

# Maximum table index in Auto mode

P 206[0] - MPRO_Tab_MaxIdx is used to define the table index up to which driving jobs will be carried out in one of the auto modes.

# Current table index

P 207[0] - MPRO_Tab_ActIdx will show the index for the motion task that is currently active. If parameter P 205 MPRO_TAB_Mode is set to “Para(0)”, a driving set can be entered and approached directly.

# Activation of reference table

The following procedures can be used in order to activate the setpoint table for operation.

|ID|Index Name|Unit|Description|
|---|---|---|---|
|193|MPRO_TAB_TAcc|TAB: Torque mode acceleration|Nm/ms|
|193|0|MPRO_TAB_TAcc|Nm/ms|
|193|1 - 15|MPRO_TAB_TAcc|Nm/ms|
|194|MPRO_TAB_TDec|TAB: Torque mode deceleration| |
|194|0|MPRO_TAB_TDec|Nm/ms|
|194|1 - 15|MPRO_TAB_TDec|Nm/ms|

# Table 8.23: Activation of table references

# Table 8.24: “Setpoint table settings” parameters

# Table 8.24: “Setpoint table settings” parameters (continue)

|ID|Index Name|Unit|Description|ID|Index Name|Unit|Description|
|---|---|---|---|---|---|---|---|
|195|MPRO_TAB_TRef|Nm|TAB: Torque mode reference value|208|MPRO_TAB_OutputNo| |OSD TAB: actual table index and target|
|195|MPRO_TAB_TRef|Nm| |208|MPRO_TAB_OutputNo| | |
|196|MPRO_TAB_SAcc|rev/min/s|TAB: Speed mode acceleration|269|MPRO_TAB_Ctrl| |TAB: control word|
|196|MPRO_TAB_SAcc|rev/min/s| | | | | |
|197|MPRO_TAB_SDec|rev/min/s|TAB: Speed mode deceleration| | | | |
|197|MPRO_TAB_SDec|rev/min/s| | | | | |
|198|MPRO_TAB_SRef|rev/min|TAB: Speed mode reference value| | | | |
|198|MPRO_TAB_SRef|rev/min| | | | | |
|199|MPRO_TAB_PAcc|rev/min/s|TAB: Position control mode acceleration| | | | |
|199|MPRO_TAB_PAcc|rev/min/s| | | | | |
|200|MPRO_TAB_PDec|rev/min/s|TAB: Position control mode Acceleration| | | | |
|200|MPRO_TAB_PDec|rev/min/s| | | | | |
|201|MPRO_TAB_PSpd|rev/min|TAB: Position control mode speed| | | | |
|201|MPRO_TAB_PSpd|rev/min| | | | | |
|202|MPRO_TAB_PPos|mDegree|TAB: Position control mode reference value| | | | |
|202|MPRO_TAB_PPos|mDegree| | | | | |
|203|MPRO_TAB_PMode| |Position control table:Mode| | | | |
|203|MPRO_TAB_PMode| | | | | | |
|204|MPRO_TAB_WaitTime|ms|TAB: Wait time| | | | |
|204|MPRO_TAB_WaitTime|ms| | | | | |
|205|MPRO_TAB_Mode| |TAB mode| | | | |
|206|MPRO_Tab_MaxIdx| |TAB: Max index in AUTO mode| | | | |
|207|MPRO_TAB_ActIdx| |TAB: Actual index| | | | |

MOOG ID No.:CB40859-001 Date:11/2020

MSD ServoDrive - DeviceHelp

# 8 Motion profile

MOOG ID No.:CB40859-001 Date:11/2020

MSD ServoDrive - DeviceHelp 270

# 8.8 Analog channel (ISA00 und ISA01)

# Offset (O)

This parameter (P 174 - MPRO_ANA0_SOffset for ISA00, P 184 - MPRO_ANA1_SOffset for ISA01) compensates for component variations and is used for offset compensation purposes. Depending on the control mode being used (see Section ""Basic settings"" on page 110), the value will be stored in parameter index [0] (torque control), [1] (speed control) or [2] (position control).

# Backlash (B)

This parameter (P 175 - MPRO_ANA0_SThreshold for ISA00, P 185 - MPRO_ANA1_SThreshold for ISA01) can suppress axis motion close to the standstill (stop) position. Depending on the control mode being used (see Section ""Basic settings"" on page 110), the value will be stored in parameter index [0] (torque control), [1] (speed control) or [2] (position control).

Image 8.68: “Analog channel” screen

# Acceleration ramp

Two standard analog inputs (ISA00, ISA01) are available. These inputs can be configured...

- with negative values for analog setpoint settings
- with positive values for digital setpoint processing

(P 109[0] - MPRO_INPUT_FS_ISA00 and P 110[0] - MPRO_INPUT_FS_ISA01).

see also section ""Analog Inputs"" on page 303. By using the ""REV(-2) = Analog setpoint"" setting, an analog input voltage of ±10 V can be processed as a setpoint.

# Deceleration ramp

This parameter serves as a deceleration ramp for torque control (P 176[1] - MPRO_ANA0_TRamp for ISA00, P 186[1] - MPRO_ANA1_TRamp for ISA01) or speed control (P 177[1] - MPRO_ANA0_SRamp for ISA00, P 187[1] - MPRO_ANA1_SRamp for ISA01). Depending on the control mode being used (see Section ""Basic settings"" on page 110), the value will be stored in parameter index [0] (torque control), [1] (speed control) or [2] (position control).

This parameter (P 173 - MPRO_ANA0_Scale for ISA00, P 183 - MPRO_ANA1_Scale for ISA01) is used to define which speed / which torque / which position corresponds to the maximum analog value. Depending on the control mode being used (see Section ""Basic settings"" on page 110), the value will be stored in parameter index [0] (torque control), [1] (speed control) or [2] (position control).

# 8.8.1 Special characteristics of position control mode

A threshold value can also be specified which generates a run-on range around the last reference value. A ramp function calculates a motion profile for the position reference from pre-defined acceleration and speed limits.

The position references on the analog channel are not applied immediately, but dependent on a digital input. Accordingly, one of the ISD00 to ISD06 digital inputs must be set to a value of ""REFANAEN(28) = Enable analog reference value"" (see Section ""Digital inputs"" on page 290). The position setpoint being received will only be applied if the corresponding digital input is active. The acceleration is entered using P 173[0] - MPRO_ANA0_TScale or P 183[0] - MPRO_ANA1_TScale.

# 8.8.2 Wire Break Monitoring

P 399 - CON_ANAWireBrk_Th can be used to configure wire break monitoring for the analog inputs. For details see Section ""Wire Break Monitoring"" on page 306.

|Function|TLIM (-4)|OVR (-3)|REFV (-2)|leer (-1)|OFF (0)|
|---|---|---|---|---|---|
|Digital|(1)-(28)|(1)-(28)|(1)-(28)|(1)-(28)|(1)-(28)|
|Analog channel|Filter|Scale|Offset|Profile|generator|

Control

Image 8.69: Reference processing structure

MOOG ID No.:CB40859-001 Date:11/2020

MSD ServoDrive - DeviceHelp 271

# 8 Motion profile

# 8 Motion profile

MOOG ID No.:CB40859-001 Date:11/2020

|ID|Index Name|Unit|Description|ID|
|---|---|---|---|---|
|395|CON_ANA_Isaf_Scaled| |Analog inputs: Values (filt, norm, comp, scaled)|174|
|395|0 ISA00| |Scaled, compensated, filtered, normalized value|175|
|395|1 ISA01| |Scaled, compensated, filtered, normalized value| |
|396|CON_ANA_Scale_ThUpper| |Analog inputs: Upper scaling limits|175|
|396|0 ISA00|%|Upper scaling (@ 10 V) threshold|175|
|396|1 ISA01|%|Upper scaling (@ 10 V) threshold| |
|397|CON_ANA_Scale_ThZero| |Analog inputs: Zero scaling thresholds|176|
|397|0 ISA00|V|Zero scaling threshold (+/-)|176|
|397|1 ISA01|V|Zero scaling threshold (+/-)| |
|398|CON_ANA_Scale_ThLower| |Analog inputs: Lower scaling limits|177|
|398|0 ISA00|%|Lower scaling (@ zero threshold) threshold|177|
|398|1 ISA01|%|Lower scaling (@ zero threshold) threshold| |
|399|CON_ANA_WireBrk_Th| |Analog inputs: Wire break thresholds|Table 8.26:|
|399|0 ISA00|V|Wire break detection threshold| |
|399|1 ISA01|V|Wire break detection threshold| |
|405|0 CON_ANA_Filt0|ms|Analog input ISA00: Filter time constant (PT 1)|ID|
|408|CON_ANA_Isaf_Norm| |Analog inputs: Values (filt, norm)|183|
|408|0 ISA00| |Filtered, normalized value|183|
|408|1 ISA01| |Filtered, normalized value|183|

Table 8.25: “Analog channel” parameters

|ID|Index Name|Unit|Description|ID|
|---|---|---|---|---|
|173|MPRO_ANA0_Scale| |ANA0: scale factors|184|
|173|0 MPRO_ANA0_TScale|Nm|ANA0: scale factor torque reference|185|
|173|1 MPRO_ANA0_SScale|rev/min|ANA0: scale factor speed reference|185|
|173|2 MPRO_ANA0_PScale|mDegree|ANA0: scale factor position reference| |
|174|MPRO_ANA0_Offset| |ANA0: offsets|185|
|174|0 MPRO_ANA0_TOffset|Nm|ANA0: offsets for torque reference|185|

Table 8.26: “Analog channel ISA00” parameters

|Index Name|Unit|Description|
|---|---|---|
|1 MPRO_ANA0_SOffset|rev/min|ANA0: offsets for speed reference|
|2 MPRO_ANA0_POffset|mDegree|ANA0: offsets for position reference|
|MPRO_ANA0_Threshold| |ANA0: thresholds|
|0 MPRO_ANA0_TThreshold|Nm|ANA0: threshold for torque reference|
|1 MPRO_ANA0_SThreshold|rev/min|ANA0: threshold for speed reference|
|2 MPRO_ANA0_PThreshold|mDegree|ANA0: threshold for position reference|
|MPRO_ANA0_TRamp| |ANA0: Torque mode acceleration [0] and deceleration [1]|
|0 MPRO_ANA0_TRamp|Nm/s| |
|1 MPRO_ANA0_TRamp|Nm/s| |
|MPRO_ANA0_SRamp| |ANA0: Speed mode acceleration [0] and deceleration [1]|
|0 MPRO_ANA0_SRamp|SPEED/s| |
|1 MPRO_ANA0_SRamp|SPEED/s| |

“Analog channel ISA00” parameters (continue)

|Index Name|Unit|Description|
|---|---|---|
|MPRO_ANA1_Scale| |ANA1: scale factors|
|0 MPRO_ANA1_TScale|Nm|ANA0: scale factor torque reference|
|1 MPRO_ANA1_SScale|rev/min|ANA0: scale factor speed reference|
|2 MPRO_ANA1_PScale|mDegree|ANA0: scale factor position reference|
|MPRO_ANA1_Offset| |ANA1: offsets|
|0 MPRO_ANA1_TOffset|Nm|ANA1: offsets for torque reference|
|1 MPRO_ANA1_SOffset|rev/min|ANA1: offsets for speed reference|
|2 MPRO_ANA1_POffset|mDegree|ANA1: offsets for position reference|
|MPRO_ANA1_Threshold| |ANA1: thresholds|
|0 MPRO_ANA1_TThreshold|Nm|ANA1: threshold for torque reference|
|1 MPRO_ANA1_SThreshold|rev/min|ANA1: threshold for speed reference|
|2 MPRO_ANA1_PThreshold|mDegree|ANA1: threshold for position reference|

“Analog channel ISA01” parameters

# 8 Motion profile

|ID|Index Name|Unit|Description|
|---|---|---|---|
|186|MPRO_ANA1_TRamp|Nm/s|ANA1: Torque mode acceleration [0] and deceleration[1]|
|186|MPRO_ANA1_TRamp|Nm/s| |
|187|MPRO_ANA1_SRamp|SPEED/s|ANA1: Speed mode acceleration [0] and deceleration [1]|
|187|MPRO_ANA1_SRamp|SPEED/s| |

# Table 8.27: “Analog channel ISA01” parameters (continue)

Display

- System state
- Initialization on device startup
- Not ready (DC link voltage possibly too low)
- Start inhibit (DC link voltage present, power stage off)
- Starting lockout
- Ready for start
- Control initialization: Auto commutation, flux build-up etc.

# Table 8.28: Central state machine according to CiA 402 device display

MOOG ID No.:CB40859-001 Date:11/2020

MSD ServoDrive - DeviceHelp 273

# 8 Motion profile

MOOG ID No.:CB40859-001 Date:11/2020

MSD ServoDrive - DeviceHelp 274

|Display|System state|power disabled|fault|
|---|---|---|---|
|Control enabled|0|Start|7|
| |fault reaction active|0|14|
|Quick stop active|1|not ready|8|
| |to switch on|1|17|
|Error reaction active|2|switch on|disabled|
| |2|7| |
|Error state (in this state the error is indicated directly on the display.)|3|ready to|switch on|
|Device is reset (display flashes)|power enabled|3|6|
| |10|12| |
|• Number [5.] flashes when “STO” (Safe Torque Off) input is active. Display goes out when STO inactive.| | | |
|• The dot on the display flashes when the power stage is active.| | | |

Table 8.28: Central state machine according to CiA 402 device display (continue)

NOTE

l The system states indicated on the display may differ from the states in the table depending on the drive profile setting.

Image 8.70: State machine diagram based on CANopen communications

⓪ to ① State number

1 to 17 State transition (No. 17: DC link voltage cut off)

Legend for “State machine diagram based on CANopen communications” figure

# 8.10 Touch probe

|ID|Index Name / Setting|
|---|---|
|241|0 MPRO_TP_Position|
|241|1 MPRO_TP_Position|
|241|2 MPRO_TP_Position|
|241|3 MPRO_TP_Position|
|241|4 MPRO_TP_Position|
|1400|0 MPRO_TP_Config|
| |TP_TP (0)|
| |AB (1)|
| |PD_UP (2)|
| |PD_DOWN (3)|
| |PC_PC (4)|
| |PC_TP (5)|
| |TP_PC (6)|
| |ENC_ENC (7)|
| |ENC_TP (8)|
| |TP_ENC (9)|

Using the touch probe inputs, touch probe functions can be performed. In order to be able to do this, P 106[0] - MPRO_INPUT_FS_ISD05 and P 107[0] - MPRO_INPUT_FS_ISD06 must be used to set digital inputs ISD05 and ISD06 to ""PROBE(15) = Touch probe (only ISD05/06)"" (see Section ""Digital inputs"" on page 290). HTL encoders can be evaluated or pulse counters implemented using the MSD PLC.

The touch probe can be triggered with P 240 - MPRO_TP_Ctrl. This enables triggering on a positive or negative edge, or on both edges, of the signal detected on the touch probe inputs. After the measurement, the parameter jumps back to the value ""NONE (0)"" and the latch position is mapped in the corresponding subindex of parameter P 241 - MPRO_TP_Position. A continuous touch probe mode is not possible at present, so the touch probe has to be reactivated after the measurement.

P 1402 - MPRO_TP_Channel can be used to select various positions as actual value sources of the latch position for the touch probe functionality. The following table provides an overview of the available settings. The counters are accessed via the MSD PLC or a bus system.

|ID|Index Name / Setting|Unit|Description|
|---|---|---|---|
|240|MPRO_TP_Ctrl|Touch probe: Control| |
| |0| |NONE (0) = No function|
| |1| |POS (1) = Positive edge|
| |2| |NEG (2) = Negative edge|
| |3| |BOTH (3) = Both edges|
|240|0 MPRO_TP_Ctrl| | |
|240|1 MPRO_TP_Ctrl| | |
|240|2 MPRO_TP_Ctrl| | |
|241|MPRO_TP_Position|Probe: Pos. high/low edge of TP0/1, encoder zero pulse| |

Table 8.29: “Touch probe” parameters

MOOG ID No.:CB40859-001 Date:11/2020

# 8 Motion profile

|Unit|Description|
|---|---|
|mDegree|Touch probe: Configuration|
|mDegree|TP0, TP1 touch probe|
|mDegree|TP0, TP1 as encoder, A/B as quadrature counting|
|mDegree|TP0, TP1 as encoder, pulse (TP0) / direction (TP1), count up on direction high|
|mDegree|TP0, TP1 as encoder, pulse (TP0) / direction (TP1), count down on direction high|
|mDegree|TP0 pulse counter, TP1 pulse counter|
|mDegree|TP0 pulse counter, TP1 touch probe|
|mDegree|TP1 touch probe, TP0 pulse counter|
|mDegree|TP0 encoder counter, TP1 encoder counter|
|mDegree|TP0 encoder counter, TP1 touch probe|
|mDegree|TP0 touch probe, TP1 encoder counter|

Touch probe: Channel

|Unit|Description|
|---|---|
|ACTPOS (0)|Actual position in user units|
|ACTPOSINC (1)|Actual position in increments|
|MASTERPOS (2)|Master position in increments|
|ENCPOS_CH1 (3)|Encoder position Channel 1|
|ENCPOS_CH1_INC (4)|Encoder position Channel 1 in increments|
|ENCPOS_CH2 (5)|Encoder position Channel 2|
|ENCPOS_CH2_INC (6)|Encoder position Channel 2 in increments|

# 8 Motion profile

MOOG ID No.:CB40859-001 Date:11/2020 MSD ServoDrive - DeviceHelp 276

|ID|Index Name / Setting|Unit|Description|
|---|---|---|---|
|7|ENCPOS_CH3 (7)| |Encoder position Channel 3|
|8|ENCPOS_CH3_INC (8)| |Encoder position Channel 3 in increments|
|9|ENCPOS_CH4 (9)| |Encoder position Channel 4|
|10|ENCPOS_CH4_INC (10)| |Encoder position Channel 4 in increments|
|11|ACTPOS2 (11)| |Actual position of redundant encoder in user units|
|12|Sercos (12)| |Referred to Sercos profile parameters S-x-0426, S-x-0427|
|13|UserRefPos(13)| |Reference position in user units|
|14|MasterPosST(14)| |Master position (ECAM, EGEAR) singleturn, always steps|
|15|CommonMasterPos(15)| |Master position (ECAM, EGEAR) singleturn, always steps|
|16|CommonMasterPosST(15)| |Master position (ECAM, EGEAR) singleturn, always steps|
|1402|MPRO_TP_Channel| | |
|1402|MPRO_TP_Channel| | |
|1402|MPRO_TP_Channel| | |
|1404|MPRO_TP_Lines| |Touch probe: Lines @ pulse counter on channel x|
|1404|MPRO_TP_Lines| | |
|1404|MPRO_TP_Lines| | |

Image 8.71: “Synchronized motion” screen

There are various modes available in the “synchronization mode” drop-down menu (P 242[0] - MPRO_ECAM_SyncModMode):

- Off(0) = Synchronized motion off
- ECAM_iPlc(1) = Electronic cam plate via MSD PLC
- EGEAR_iPlc(2) = Electr. gear unit via MSD PLC
- ECAM_PARA(3) = Electronic camming via parameters
- EGEAR_PARA(4) = Electronic gearing via parameters

NOTE: For more information refer to the bus system User Manuals or the description of the MSD PLC.

# 8.11.1 Electronic cam plate

The other parameters are configured in separate screens that can be accessed with the corresponding buttons.

- Master configuration (see Section ""Master configuration"" on page 280)
- Electronic gearing (see Section ""Electronic gearing"" on page 283)
- Electronic camming (see Section ""Electronic cam plate"" on page 277)

P 1318[0] - MPRO_ECAM_ControlWord is the control word for “synchronized motion” (see Section ""Control word for synchronized motion"" on page 279).

P 1326[0] - MPRO_ECAM_StatusWord is the status word for “synchronized motion” (see Section ""Status word for synchronized motion"" on page 279).

# 8.11.1.1 Table selection

|ID|Index Name|Unit|Description|
|---|---|---|---|
|1300|MPRO_ECAM_CTS_| |ECAM: CamTableSelect - Master reference|
|1301|MasterRef| | |
|1305|MPRO_ECAM_CTS_| |ECAM: CamTableSelect - Method for changing the camtable|
|1306|MPRO_ECAM_CTS_| |ECAM: CamTableSelect - Mode for changing the camtable|
|1307|MPRO_ECAM_CTS_|incr|ECAM: CamTableSelect - Distance for changing the camtable|
|242|MPRO_ECAM_| |ECAM / EGEAR: Mode of synchronized motion SyncModMode|
|265|MPRO_ECAM_| |ECAM / EGEAR: Slave speed factor (1 = 100%).|
|266|CamSlave_SpeedFactor| | |
|268|MPRO_ECAM_| |ECAM / EGEAR: Mode of switching off sync. motion|

# 8.11.1.2 Synchronization

|ID|Index Name|Unit|Description|
|---|---|---|---|
|1342|MPRO_ECAM_CI_|incr|ECAM: CamIn - Synchronization position (multiturn part)|
|1343|MPRO_ECAM_CO_|incr|ECAM: CamOut - Decoupling pos. (multiturn part)|
|1303|MPRO_ECAM_CI_|incr|ECAM: CamIn - Master offset|
|1308|MPRO_ECAM_CI_| |ECAM: CamIn - Master reference|
|1309|MPRO_ECAM_CI_| |ECAM: CamIn - Slave reference|
|1310|MPRO_ECAM_CI_| |ECAM: CamIn - Coupling mode|
|1311|MPRO_ECAM_CI_|incr|ECAM: CamIn - Coupling distance|
|1312|MPRO_ECAM_CI_|incr|ECAM: CamIn - Synchronization position|

Table 8.31: “Electronic camming - Table selection” parameters

Table 8.30: “Synchronized motion” parameters

Table 8.32: “Electronic camming - Synchronization” parameters

MOOG ID No.:CB40859-001 Date:11/2020

MSD ServoDrive - DeviceHelp 277

# 8 Motion profile

MOOG ID No.:CB40859-001 Date:11/2020 MSD ServoDrive - DeviceHelp 278

|ID|Index|Name|Unit|Description|
|---|---|---|---|---|
|1313|0|MPRO_ECAM_CO_SyncPosST|(singleturn part)|ECAM: CamOut - Slave reference|
|1314|0|MPRO_ECAM_CO_DecouplingMode|63|ECAM: CamOut - Decoupling mode|
|1315|0|MPRO_ECAM_CO_BreakingPosST|incr|ECAM: CamOut - Decoupling position|
|1316|0|MPRO_ECAM_CO_DecouplingDist|incr|ECAM: CamOut - Decoupling distance|
|1317|0|MPRO_ECAM_CO_StandstillPos|mDegree|ECAM: CamOut - Slave standstill position|

# Table 8.32: “Electronic camming - Synchronization” parameters (continue)

|ID|Index|Name|Unit|Description|
|---|---|---|---|---|
|1346| |MPRO_ECAM_SP_Table| |ECAM: Setpoint table interface|
|1346|0|Index| |Index of setpoint table|
|1346|1|Value| |Value at index of setpoint table|
|1347|0 to 31|MPRO_ECAM_SP_Index| |ECAM: Setpoint segments start index|
|1348|0 to 31|MPRO_ECAM_SP_Length| |ECAM: Setpoint segments length|
|1349|0 to 31|Length| | |
|1350|0|MPRO_ECAM_SP_MaDist| |ECAM: Setpoint segments master distance|
|1351|0|MPRO_ECAM_SP_IpoType| |ECAM: Setpoint segments interpolation type|
|1352|0 to 31|Checksum| |ECAM: Setpoint table checksum|
|1353|0 to 31|GainNum| |ECAM: Setpoint segments gain numerator|
| | |GainDen| |ECAM: Setpoint segments gain denominator|

# Table 8.33: “Electronic camming - Table segments” parameters

|ID|Index|Name|Unit|Description|
|---|---|---|---|---|
|1329|0 to 63|MPRO_ECAM_SegData_IndexNext| |ECAM: Index of the following segment|
|1330|0 to 63|MPRO_ECAM_SegData_IndexPrev| |ECAM: Index of the previous segment|
|1331|0 to 63|MPRO_ECAM_SegData_ProfileMode| |ECAM: Profile mode of the current segment|
|1332|0 to 63|MPRO_ECAM_SegData_DistMaster| |ECAM: Length of the master section of the current segment|
|1333|0 to 63|MPRO_ECAM_SegData_DistSlave| |ECAM: Length of the slave section of the current segment|
|1334|0 to 63|MPRO_ECAM_SegData_Lambda| |ECAM: Lambda value of the current segment|
|1335|0 to 63|MPRO_ECAM_SegData_StatusWord| |ECAM: Status word of the current segment|
|1336|0 to 63|MPRO_ECAM_SegData_ControlWord| |ECAM: Control word of the current segment|

# 8.11.2 Control word for synchronized motion

|Bit|Function|PLC function|Bit number|Description|
|---|---|---|---|---|
|0-7|Start segment (8-bit value)|-|0-7|Actual segment (8-bit value)|
|8-15|Reserved|-| |Actual ECAM / EGEAR state machine state (4 Bit value)|
|16|Absolute (true) / relative (false) master relationship|-| |- 0: ECAM / EGEAR asynchronous
- 1: ECAM / EGEAR synchronous
|
|17|Absolute (true) / relative (false) master (CAM) relationship at cam in|-| |- 2: ECAM / EGEAR synchronizing
- 3: ECAM / EGEAR desynchronizing
|
|18|Absolute (true) / relative (false) slave (CAM) relationship at cam in|-| |- 4: ECAM / EGEAR active and waiting for going asynchronous
|
|19-23|Reserved|-| |- 5: ECAM / EGEAR inactive and waiting for going synchronous
|
|24|Change gear ratio of the electronic gear online|MCB_GearRatioChange| | |
|25|Disable master calculation|MCB_Cam_MasterEnable| | |
|26|Enable master calculation|MCB_Cam_MasterEnable| | |
|27|Select CAM table|MCB_CamTableSelect| | |
|28|Start Ecam|MCB_CamIn| | |
|29|Stop Ecam|MCB_CamOut| | |
|30|Start Egear|MCB_GearIn| | |
|31|Stop Egear|MCB_GearOut| | |

# 8.11.3 Status word for synchronized motion

|Bit|Function|PLC function|Bit number|Description|
|---|---|---|---|---|
|12-26|Reserved|-| | |
|27|ECAM / EGEAR is active|-| | |
|28|Valid segments chosen|-| | |
|29|Master data are valid|-| | |
|30|Master is initialized|-| | |
|31|Master calculation is active|-| | |

Table 8.35: Control word ECAM (P 1318[0] - MPRO_ECAM_ControlWord)

Table 8.36: ECAM status word (P 1326[0] - MPRO_ECAM_StatusWord)

MOOG ID No.:CB40859-001 Date:11/2020 MSD ServoDrive - DeviceHelp 279

# 8 Motion profile

# 8 Motion profile

MOOG ID No.:CB40859-001 Date:11/2020

MSD ServoDrive - DeviceHelp 280

# 8.11.4 Master configuration

the master encoder, you will need to set the resolution relative to a single motor revolution in P 250 - MPRO_ECAM_PARAMaster_Amplitude (see below).

- ENC CH1 (3) = Encoder channel 1 X7 (Sin/Cos)
- ENC CH2 (4) = Encoder channel 2 X6 (Resolver)
- ENC CH3 (5) = Encoder channel 3 X8 (optional)

This function is only available if an external interface X8 (option module) is present.

- TP0 (6) = Pulse counter on probe channel 0 (TP0)
- TP1 (7) = Pulse counter on probe channel 1 (TP1)
- ENC_CH4 (8) = Encoder channel 4 (p. e. fieldbus)
- TWIN_POS (9) = TWIN remote reference position (P-2607)

Image 8.72: “Master configuration” screen

# Channel selection (master encoder)

P 1319[0] - MPRO_ECAM_CamMaster_AxisType is used to define the master encoder.

- NO AXIS (0) = No axis
- VIRTUAL MASTER (1) = Virtual master

If you select this function, you will be able to configure additional settings by clicking on the enabled “Options...” button (see Section ""Virtual Master"" on page 286).

- PARA (2) = Master parameter interface

If you select this function because a higher-level controller is being used as

# Anti-reverse mode

Slave only starts moving along with it again as soon as the master reaches the zero position.

P 1320[0] - MPRO_ECAM_CamMaster_RevLockMode is used to define the reverse lock mode, which can be used either with or without path compensation. The dashed lines in the following diagrams indicate what the engagement distance is:

# Example:

If the master, which has moved two motor revolutions in the direction blocked for the slave, then moves in the unblocked direction again, the slave only moves off when the master has traversed the zero point.

- INACTIVE (0) = Reverse lock inactive
- ACTIVE (2) = Reverse lock enabled - without path optimization
- ACTIVE WAY COMP (1) = Reverse lock active - with way compensation

While the slave accelerates to the speed of the master during engagement, the master and slave do not move synchronously. This function needs to be selected in order to quickly catch up to the master that is running ahead.

# Example:

- Master (black line) rotates in the blocked direction
- The slave (blue line) remains stopped
- Master rotates in the unblocked direction again
- The slave follows the master directly in the unblocked direction

Assume the master has moved two motor revolutions in the direction for which the slave lock is enabled. If the master now moves in the direction for which there is no lock, the slave will immediately start running in that direction.

MOOG ID No.:CB40859-001 Date:11/2020

MSD ServoDrive - DeviceHelp 281

# 8 Motion profile

MOOG ID No.:CB40859-001 Date:11/2020 MSD ServoDrive - DeviceHelp 282

|Filter type|ID|Index Name|Unit|Description|
|---|---|---|---|---|
|When using a real master encoder, encoder signals may be subject to noise.|P 1340|1319|0|MPRO_ECAM_CamMaster_AxisType|
| | |MPRO_ECAM_CamMaster_SpeedFilTyp| |ECAM / EGEAR: Channel selection of internal master input|
| | |1320|0|MPRO_ECAM_CamMaster_RevLockMode|
| | |1321|0|MPRO_ECAM_CamMaster_Amplitude|
| | |1322|0|MPRO_ECAM_CamMaster_GearNum|
| | |1323|0|MPRO_ECAM_CamMaster_GearDen|
|Filter time|1327|0|ms|ECAM / EGEAR: Filter time constant of master|
|If P 1340[0] is used to enable a filter, P 1327[0] - MPRO_ECAM_CamMaster_SpeedTFil can be used to define the corresponding filter time.|1328|0|speed|ECAM / EGEAR: Speed factor of the internal master|
|Speed factor|1340|0| |MPRO_ECAM_CamMaster_SpeedFilTyp|
|The master encoder can be assigned an additional speed factor P 1328[0] - MPRO_ECAM_CamMaster_SpeedFactor.|1341|0|incr|ECAM / EGEAR: Master drive offset|

Table 8.37: “Synchronized motion - Master configuration” parameters (continue)

| | | |ID|Index Name|Unit|Description|
|---|---|---|---|---|---|---|
|247|0|MPRO_ECAM_ParaMaster_ActPos|incr|ECAM / EGEAR: Parameter interface master position| | |
|248|0|MPRO_ECAM_ParaMaster_ActSpeed|rpm|ECAM / EGEAR: Parameter interface master speed| | |
|249|0|MPRO_ECAM_ParaMaster_ActAcc|rpm|ECAM / EGEAR: Parameter interface master acceleration| | |
| |250|0|MPRO_ECAM_ParaMaster_Amplitude| |ECAM / EGEAR: Parameter interface master amplitude| |

Table 8.37: “Synchronized motion - Master configuration” parameters

# 8.11.5 Electronic gearing

# Gear ratio

The gear ratio is specified as a fraction. This ensures that the position references can be translated to the motor shaft with no rounding error.

- ""Slave"" (P 252[0] - MPRO_ECAM_Egear_GearNum) is the numerator
- ""Master"" (P 251[0] - MPRO_ECAM_Egear_GearDen) is the denominator

# Scaling of speed pre-control

Defined with P 265[0] - MPRO_ECAM_CamSlave_SpeedFactor definiert.

# Scaling of torque pre-control

Defined with P 266[0] - MPRO_ECAM_CamSlave_TorqueFactor.

# Engagement

See Section ""Engagement"" on page 284.

# Disengagement

See Section ""Disengagement"" on page 285.

|ID|Index Name|Unit|Description|
|---|---|---|---|
|251|0 MPRO_ECAM_Egear_GearDen| |EGEAR: Gear denominator|
|252|0 MPRO_ECAM_Egear_GearNum| |EGEAR: Numerator of gear ratio|
|1344|0 MPRO_ECAM_Egear_LimRefAcc|rpm/s|EGEAR: Acceleration limit for reference|
|1345|0 MPRO_ECAM_Egear_LimRefJerk|rpm/s²|EGEAR: Jerk limit for reference|

Table 8.38: “Synchronized motion - Electronic gearing” parameters

Image 8.73: ""Electronic gearing"" screen

MOOG ID No.:CB40859-001 Date:11/2020 MSD ServoDrive - DeviceHelp 283

# 8 Motion profile

# 8 Motion profile

MOOG ID No.:CB40859-001 Date:11/2020

MSD ServoDrive - DeviceHelp 284

# 8.11.6 Engagement

used to define the engagement distance (between the dashed lines).

P 253[0] - MPRO_ECAM_Egear_GearInMode is used to define the mode for engagement.

- DIRECT (0) = Direct
- Direct engagement: Angular synchronous; with jerking (no ramps).
- CROSSFADE (3) = Crossfading
- Engagement with crossfading function (5th degree polynomial): Angular synchronous; jerk-limited; speed will overshoot during engagement.
- RAMP (1) = Linear speed ramp
- Engagement with linear acceleration: Not angular synchronous; with jerking.
- FADE (2) = Engagement fade-out
- Engagement with fade-in function (5th degree polynomial): Not angular synchronous; jerk-limited. The position is ignored. ",How are the analog inputs ISA00 and ISA01 configured in the 'MSD ServoDrive - DeviceHelp' document?,A4,Analog inputs are set up for either analog (negative) or digital (positive) setpoint handling.,1.0390625,1.125,3.203125,1.1328125,0.1513671875
4,msd_servo_drive.txt,76,b87ca5e232c2bdbb6fa16a8a401c6b5d285dc0183e73cc9d134de13dd2fc71d2,"MOOG ID No.:CB40859-001 Date:11/2020

MSD ServoDrive - DeviceHelp 267

# 8 Motion profile

MOOG ID No.:CB40859-001 Date:11/2020 MSD ServoDrive - DeviceHelp 268

# Deceleration

With ...

- P 194 - MPRO_TAB_TDec (for torque control) or
- P 197 - MPRO_TAB_SDec (for speed control) or
- P 200 - MPRO_TAB_PDec (for position control)

and indexes 0–15, the deceleration for each individual motion task can be defined. The input must not be zero.

# Wait time in Auto mode

P 204 - MPRO_TAB_WaitTime is used to define the wait time before the next motion task is carried out.

# Maximum table index in Auto mode

P 206[0] - MPRO_Tab_MaxIdx is used to define the table index up to which driving jobs will be carried out in one of the auto modes.

# Current table index

P 207[0] - MPRO_Tab_ActIdx will show the index for the motion task that is currently active. If parameter P 205 MPRO_TAB_Mode is set to “Para(0)”, a driving set can be entered and approached directly.

# Activation of reference table

The following procedures can be used in order to activate the setpoint table for operation.

|ID|Index Name|Unit|Description|
|---|---|---|---|
|193|MPRO_TAB_TAcc|TAB: Torque mode acceleration|Nm/ms|
|193|0|MPRO_TAB_TAcc|Nm/ms|
|193|1 - 15|MPRO_TAB_TAcc|Nm/ms|
|194|MPRO_TAB_TDec|TAB: Torque mode deceleration| |
|194|0|MPRO_TAB_TDec|Nm/ms|
|194|1 - 15|MPRO_TAB_TDec|Nm/ms|

# Table 8.23: Activation of table references

# Table 8.24: “Setpoint table settings” parameters

# Table 8.24: “Setpoint table settings” parameters (continue)

|ID|Index Name|Unit|Description|ID|Index Name|Unit|Description|
|---|---|---|---|---|---|---|---|
|195|MPRO_TAB_TRef|Nm|TAB: Torque mode reference value|208|MPRO_TAB_OutputNo| |OSD TAB: actual table index and target|
|195|MPRO_TAB_TRef|Nm| |208|MPRO_TAB_OutputNo| | |
|196|MPRO_TAB_SAcc|rev/min/s|TAB: Speed mode acceleration|269|MPRO_TAB_Ctrl| |TAB: control word|
|196|MPRO_TAB_SAcc|rev/min/s| | | | | |
|197|MPRO_TAB_SDec|rev/min/s|TAB: Speed mode deceleration| | | | |
|197|MPRO_TAB_SDec|rev/min/s| | | | | |
|198|MPRO_TAB_SRef|rev/min|TAB: Speed mode reference value| | | | |
|198|MPRO_TAB_SRef|rev/min| | | | | |
|199|MPRO_TAB_PAcc|rev/min/s|TAB: Position control mode acceleration| | | | |
|199|MPRO_TAB_PAcc|rev/min/s| | | | | |
|200|MPRO_TAB_PDec|rev/min/s|TAB: Position control mode Acceleration| | | | |
|200|MPRO_TAB_PDec|rev/min/s| | | | | |
|201|MPRO_TAB_PSpd|rev/min|TAB: Position control mode speed| | | | |
|201|MPRO_TAB_PSpd|rev/min| | | | | |
|202|MPRO_TAB_PPos|mDegree|TAB: Position control mode reference value| | | | |
|202|MPRO_TAB_PPos|mDegree| | | | | |
|203|MPRO_TAB_PMode| |Position control table:Mode| | | | |
|203|MPRO_TAB_PMode| | | | | | |
|204|MPRO_TAB_WaitTime|ms|TAB: Wait time| | | | |
|204|MPRO_TAB_WaitTime|ms| | | | | |
|205|MPRO_TAB_Mode| |TAB mode| | | | |
|206|MPRO_Tab_MaxIdx| |TAB: Max index in AUTO mode| | | | |
|207|MPRO_TAB_ActIdx| |TAB: Actual index| | | | |

MOOG ID No.:CB40859-001 Date:11/2020

MSD ServoDrive - DeviceHelp

# 8 Motion profile

MOOG ID No.:CB40859-001 Date:11/2020

MSD ServoDrive - DeviceHelp 270

# 8.8 Analog channel (ISA00 und ISA01)

# Offset (O)

This parameter (P 174 - MPRO_ANA0_SOffset for ISA00, P 184 - MPRO_ANA1_SOffset for ISA01) compensates for component variations and is used for offset compensation purposes. Depending on the control mode being used (see Section ""Basic settings"" on page 110), the value will be stored in parameter index [0] (torque control), [1] (speed control) or [2] (position control).

# Backlash (B)

This parameter (P 175 - MPRO_ANA0_SThreshold for ISA00, P 185 - MPRO_ANA1_SThreshold for ISA01) can suppress axis motion close to the standstill (stop) position. Depending on the control mode being used (see Section ""Basic settings"" on page 110), the value will be stored in parameter index [0] (torque control), [1] (speed control) or [2] (position control).

Image 8.68: “Analog channel” screen

# Acceleration ramp

Two standard analog inputs (ISA00, ISA01) are available. These inputs can be configured...

- with negative values for analog setpoint settings
- with positive values for digital setpoint processing

(P 109[0] - MPRO_INPUT_FS_ISA00 and P 110[0] - MPRO_INPUT_FS_ISA01).

see also section ""Analog Inputs"" on page 303. By using the ""REV(-2) = Analog setpoint"" setting, an analog input voltage of ±10 V can be processed as a setpoint.

# Deceleration ramp

This parameter serves as a deceleration ramp for torque control (P 176[1] - MPRO_ANA0_TRamp for ISA00, P 186[1] - MPRO_ANA1_TRamp for ISA01) or speed control (P 177[1] - MPRO_ANA0_SRamp for ISA00, P 187[1] - MPRO_ANA1_SRamp for ISA01). Depending on the control mode being used (see Section ""Basic settings"" on page 110), the value will be stored in parameter index [0] (torque control), [1] (speed control) or [2] (position control).

This parameter (P 173 - MPRO_ANA0_Scale for ISA00, P 183 - MPRO_ANA1_Scale for ISA01) is used to define which speed / which torque / which position corresponds to the maximum analog value. Depending on the control mode being used (see Section ""Basic settings"" on page 110), the value will be stored in parameter index [0] (torque control), [1] (speed control) or [2] (position control).

# 8.8.1 Special characteristics of position control mode

A threshold value can also be specified which generates a run-on range around the last reference value. A ramp function calculates a motion profile for the position reference from pre-defined acceleration and speed limits.

The position references on the analog channel are not applied immediately, but dependent on a digital input. Accordingly, one of the ISD00 to ISD06 digital inputs must be set to a value of ""REFANAEN(28) = Enable analog reference value"" (see Section ""Digital inputs"" on page 290). The position setpoint being received will only be applied if the corresponding digital input is active. The acceleration is entered using P 173[0] - MPRO_ANA0_TScale or P 183[0] - MPRO_ANA1_TScale.

# 8.8.2 Wire Break Monitoring

P 399 - CON_ANAWireBrk_Th can be used to configure wire break monitoring for the analog inputs. For details see Section ""Wire Break Monitoring"" on page 306.

|Function|TLIM (-4)|OVR (-3)|REFV (-2)|leer (-1)|OFF (0)|
|---|---|---|---|---|---|
|Digital|(1)-(28)|(1)-(28)|(1)-(28)|(1)-(28)|(1)-(28)|
|Analog channel|Filter|Scale|Offset|Profile|generator|

Control

Image 8.69: Reference processing structure

MOOG ID No.:CB40859-001 Date:11/2020

MSD ServoDrive - DeviceHelp 271

# 8 Motion profile

# 8 Motion profile

MOOG ID No.:CB40859-001 Date:11/2020

|ID|Index Name|Unit|Description|ID|
|---|---|---|---|---|
|395|CON_ANA_Isaf_Scaled| |Analog inputs: Values (filt, norm, comp, scaled)|174|
|395|0 ISA00| |Scaled, compensated, filtered, normalized value|175|
|395|1 ISA01| |Scaled, compensated, filtered, normalized value| |
|396|CON_ANA_Scale_ThUpper| |Analog inputs: Upper scaling limits|175|
|396|0 ISA00|%|Upper scaling (@ 10 V) threshold|175|
|396|1 ISA01|%|Upper scaling (@ 10 V) threshold| |
|397|CON_ANA_Scale_ThZero| |Analog inputs: Zero scaling thresholds|176|
|397|0 ISA00|V|Zero scaling threshold (+/-)|176|
|397|1 ISA01|V|Zero scaling threshold (+/-)| |
|398|CON_ANA_Scale_ThLower| |Analog inputs: Lower scaling limits|177|
|398|0 ISA00|%|Lower scaling (@ zero threshold) threshold|177|
|398|1 ISA01|%|Lower scaling (@ zero threshold) threshold| |
|399|CON_ANA_WireBrk_Th| |Analog inputs: Wire break thresholds|Table 8.26:|
|399|0 ISA00|V|Wire break detection threshold| |
|399|1 ISA01|V|Wire break detection threshold| |
|405|0 CON_ANA_Filt0|ms|Analog input ISA00: Filter time constant (PT 1)|ID|
|408|CON_ANA_Isaf_Norm| |Analog inputs: Values (filt, norm)|183|
|408|0 ISA00| |Filtered, normalized value|183|
|408|1 ISA01| |Filtered, normalized value|183|

Table 8.25: “Analog channel” parameters

|ID|Index Name|Unit|Description|ID|
|---|---|---|---|---|
|173|MPRO_ANA0_Scale| |ANA0: scale factors|184|
|173|0 MPRO_ANA0_TScale|Nm|ANA0: scale factor torque reference|185|
|173|1 MPRO_ANA0_SScale|rev/min|ANA0: scale factor speed reference|185|
|173|2 MPRO_ANA0_PScale|mDegree|ANA0: scale factor position reference| |
|174|MPRO_ANA0_Offset| |ANA0: offsets|185|
|174|0 MPRO_ANA0_TOffset|Nm|ANA0: offsets for torque reference|185|

Table 8.26: “Analog channel ISA00” parameters

|Index Name|Unit|Description|
|---|---|---|
|1 MPRO_ANA0_SOffset|rev/min|ANA0: offsets for speed reference|
|2 MPRO_ANA0_POffset|mDegree|ANA0: offsets for position reference|
|MPRO_ANA0_Threshold| |ANA0: thresholds|
|0 MPRO_ANA0_TThreshold|Nm|ANA0: threshold for torque reference|
|1 MPRO_ANA0_SThreshold|rev/min|ANA0: threshold for speed reference|
|2 MPRO_ANA0_PThreshold|mDegree|ANA0: threshold for position reference|
|MPRO_ANA0_TRamp| |ANA0: Torque mode acceleration [0] and deceleration [1]|
|0 MPRO_ANA0_TRamp|Nm/s| |
|1 MPRO_ANA0_TRamp|Nm/s| |
|MPRO_ANA0_SRamp| |ANA0: Speed mode acceleration [0] and deceleration [1]|
|0 MPRO_ANA0_SRamp|SPEED/s| |
|1 MPRO_ANA0_SRamp|SPEED/s| |

“Analog channel ISA00” parameters (continue)

|Index Name|Unit|Description|
|---|---|---|
|MPRO_ANA1_Scale| |ANA1: scale factors|
|0 MPRO_ANA1_TScale|Nm|ANA0: scale factor torque reference|
|1 MPRO_ANA1_SScale|rev/min|ANA0: scale factor speed reference|
|2 MPRO_ANA1_PScale|mDegree|ANA0: scale factor position reference|
|MPRO_ANA1_Offset| |ANA1: offsets|
|0 MPRO_ANA1_TOffset|Nm|ANA1: offsets for torque reference|
|1 MPRO_ANA1_SOffset|rev/min|ANA1: offsets for speed reference|
|2 MPRO_ANA1_POffset|mDegree|ANA1: offsets for position reference|
|MPRO_ANA1_Threshold| |ANA1: thresholds|
|0 MPRO_ANA1_TThreshold|Nm|ANA1: threshold for torque reference|
|1 MPRO_ANA1_SThreshold|rev/min|ANA1: threshold for speed reference|
|2 MPRO_ANA1_PThreshold|mDegree|ANA1: threshold for position reference|

“Analog channel ISA01” parameters

# 8 Motion profile

|ID|Index Name|Unit|Description|
|---|---|---|---|
|186|MPRO_ANA1_TRamp|Nm/s|ANA1: Torque mode acceleration [0] and deceleration[1]|
|186|MPRO_ANA1_TRamp|Nm/s| |
|187|MPRO_ANA1_SRamp|SPEED/s|ANA1: Speed mode acceleration [0] and deceleration [1]|
|187|MPRO_ANA1_SRamp|SPEED/s| |

# Table 8.27: “Analog channel ISA01” parameters (continue)

Display

- System state
- Initialization on device startup
- Not ready (DC link voltage possibly too low)
- Start inhibit (DC link voltage present, power stage off)
- Starting lockout
- Ready for start
- Control initialization: Auto commutation, flux build-up etc.

# Table 8.28: Central state machine according to CiA 402 device display

MOOG ID No.:CB40859-001 Date:11/2020

MSD ServoDrive - DeviceHelp 273

# 8 Motion profile

MOOG ID No.:CB40859-001 Date:11/2020

MSD ServoDrive - DeviceHelp 274

|Display|System state|power disabled|fault|
|---|---|---|---|
|Control enabled|0|Start|7|
| |fault reaction active|0|14|
|Quick stop active|1|not ready|8|
| |to switch on|1|17|
|Error reaction active|2|switch on|disabled|
| |2|7| |
|Error state (in this state the error is indicated directly on the display.)|3|ready to|switch on|
|Device is reset (display flashes)|power enabled|3|6|
| |10|12| |
|• Number [5.] flashes when “STO” (Safe Torque Off) input is active. Display goes out when STO inactive.| | | |
|• The dot on the display flashes when the power stage is active.| | | |

Table 8.28: Central state machine according to CiA 402 device display (continue)

NOTE

l The system states indicated on the display may differ from the states in the table depending on the drive profile setting.

Image 8.70: State machine diagram based on CANopen communications

⓪ to ① State number

1 to 17 State transition (No. 17: DC link voltage cut off)

Legend for “State machine diagram based on CANopen communications” figure

# 8.10 Touch probe

|ID|Index Name / Setting|
|---|---|
|241|0 MPRO_TP_Position|
|241|1 MPRO_TP_Position|
|241|2 MPRO_TP_Position|
|241|3 MPRO_TP_Position|
|241|4 MPRO_TP_Position|
|1400|0 MPRO_TP_Config|
| |TP_TP (0)|
| |AB (1)|
| |PD_UP (2)|
| |PD_DOWN (3)|
| |PC_PC (4)|
| |PC_TP (5)|
| |TP_PC (6)|
| |ENC_ENC (7)|
| |ENC_TP (8)|
| |TP_ENC (9)|

Using the touch probe inputs, touch probe functions can be performed. In order to be able to do this, P 106[0] - MPRO_INPUT_FS_ISD05 and P 107[0] - MPRO_INPUT_FS_ISD06 must be used to set digital inputs ISD05 and ISD06 to ""PROBE(15) = Touch probe (only ISD05/06)"" (see Section ""Digital inputs"" on page 290). HTL encoders can be evaluated or pulse counters implemented using the MSD PLC.

The touch probe can be triggered with P 240 - MPRO_TP_Ctrl. This enables triggering on a positive or negative edge, or on both edges, of the signal detected on the touch probe inputs. After the measurement, the parameter jumps back to the value ""NONE (0)"" and the latch position is mapped in the corresponding subindex of parameter P 241 - MPRO_TP_Position. A continuous touch probe mode is not possible at present, so the touch probe has to be reactivated after the measurement.

P 1402 - MPRO_TP_Channel can be used to select various positions as actual value sources of the latch position for the touch probe functionality. The following table provides an overview of the available settings. The counters are accessed via the MSD PLC or a bus system.

|ID|Index Name / Setting|Unit|Description|
|---|---|---|---|
|240|MPRO_TP_Ctrl|Touch probe: Control| |
| |0| |NONE (0) = No function|
| |1| |POS (1) = Positive edge|
| |2| |NEG (2) = Negative edge|
| |3| |BOTH (3) = Both edges|
|240|0 MPRO_TP_Ctrl| | |
|240|1 MPRO_TP_Ctrl| | |
|240|2 MPRO_TP_Ctrl| | |
|241|MPRO_TP_Position|Probe: Pos. high/low edge of TP0/1, encoder zero pulse| |

Table 8.29: “Touch probe” parameters

MOOG ID No.:CB40859-001 Date:11/2020

# 8 Motion profile

|Unit|Description|
|---|---|
|mDegree|Touch probe: Configuration|
|mDegree|TP0, TP1 touch probe|
|mDegree|TP0, TP1 as encoder, A/B as quadrature counting|
|mDegree|TP0, TP1 as encoder, pulse (TP0) / direction (TP1), count up on direction high|
|mDegree|TP0, TP1 as encoder, pulse (TP0) / direction (TP1), count down on direction high|
|mDegree|TP0 pulse counter, TP1 pulse counter|
|mDegree|TP0 pulse counter, TP1 touch probe|
|mDegree|TP1 touch probe, TP0 pulse counter|
|mDegree|TP0 encoder counter, TP1 encoder counter|
|mDegree|TP0 encoder counter, TP1 touch probe|
|mDegree|TP0 touch probe, TP1 encoder counter|

Touch probe: Channel

|Unit|Description|
|---|---|
|ACTPOS (0)|Actual position in user units|
|ACTPOSINC (1)|Actual position in increments|
|MASTERPOS (2)|Master position in increments|
|ENCPOS_CH1 (3)|Encoder position Channel 1|
|ENCPOS_CH1_INC (4)|Encoder position Channel 1 in increments|
|ENCPOS_CH2 (5)|Encoder position Channel 2|
|ENCPOS_CH2_INC (6)|Encoder position Channel 2 in increments|

# 8 Motion profile

MOOG ID No.:CB40859-001 Date:11/2020 MSD ServoDrive - DeviceHelp 276

|ID|Index Name / Setting|Unit|Description|
|---|---|---|---|
|7|ENCPOS_CH3 (7)| |Encoder position Channel 3|
|8|ENCPOS_CH3_INC (8)| |Encoder position Channel 3 in increments|
|9|ENCPOS_CH4 (9)| |Encoder position Channel 4|
|10|ENCPOS_CH4_INC (10)| |Encoder position Channel 4 in increments|
|11|ACTPOS2 (11)| |Actual position of redundant encoder in user units|
|12|Sercos (12)| |Referred to Sercos profile parameters S-x-0426, S-x-0427|
|13|UserRefPos(13)| |Reference position in user units|
|14|MasterPosST(14)| |Master position (ECAM, EGEAR) singleturn, always steps|
|15|CommonMasterPos(15)| |Master position (ECAM, EGEAR) singleturn, always steps|
|16|CommonMasterPosST(15)| |Master position (ECAM, EGEAR) singleturn, always steps|
|1402|MPRO_TP_Channel| | |
|1402|MPRO_TP_Channel| | |
|1402|MPRO_TP_Channel| | |
|1404|MPRO_TP_Lines| |Touch probe: Lines @ pulse counter on channel x|
|1404|MPRO_TP_Lines| | |
|1404|MPRO_TP_Lines| | |

Image 8.71: “Synchronized motion” screen

There are various modes available in the “synchronization mode” drop-down menu (P 242[0] - MPRO_ECAM_SyncModMode):

- Off(0) = Synchronized motion off
- ECAM_iPlc(1) = Electronic cam plate via MSD PLC
- EGEAR_iPlc(2) = Electr. gear unit via MSD PLC
- ECAM_PARA(3) = Electronic camming via parameters
- EGEAR_PARA(4) = Electronic gearing via parameters

NOTE: For more information refer to the bus system User Manuals or the description of the MSD PLC.

# 8.11.1 Electronic cam plate

The other parameters are configured in separate screens that can be accessed with the corresponding buttons.

- Master configuration (see Section ""Master configuration"" on page 280)
- Electronic gearing (see Section ""Electronic gearing"" on page 283)
- Electronic camming (see Section ""Electronic cam plate"" on page 277)

P 1318[0] - MPRO_ECAM_ControlWord is the control word for “synchronized motion” (see Section ""Control word for synchronized motion"" on page 279).

P 1326[0] - MPRO_ECAM_StatusWord is the status word for “synchronized motion” (see Section ""Status word for synchronized motion"" on page 279).

# 8.11.1.1 Table selection

|ID|Index Name|Unit|Description|
|---|---|---|---|
|1300|MPRO_ECAM_CTS_| |ECAM: CamTableSelect - Master reference|
|1301|MasterRef| | |
|1305|MPRO_ECAM_CTS_| |ECAM: CamTableSelect - Method for changing the camtable|
|1306|MPRO_ECAM_CTS_| |ECAM: CamTableSelect - Mode for changing the camtable|
|1307|MPRO_ECAM_CTS_|incr|ECAM: CamTableSelect - Distance for changing the camtable|
|242|MPRO_ECAM_| |ECAM / EGEAR: Mode of synchronized motion SyncModMode|
|265|MPRO_ECAM_| |ECAM / EGEAR: Slave speed factor (1 = 100%).|
|266|CamSlave_SpeedFactor| | |
|268|MPRO_ECAM_| |ECAM / EGEAR: Mode of switching off sync. motion|

# 8.11.1.2 Synchronization

|ID|Index Name|Unit|Description|
|---|---|---|---|
|1342|MPRO_ECAM_CI_|incr|ECAM: CamIn - Synchronization position (multiturn part)|
|1343|MPRO_ECAM_CO_|incr|ECAM: CamOut - Decoupling pos. (multiturn part)|
|1303|MPRO_ECAM_CI_|incr|ECAM: CamIn - Master offset|
|1308|MPRO_ECAM_CI_| |ECAM: CamIn - Master reference|
|1309|MPRO_ECAM_CI_| |ECAM: CamIn - Slave reference|
|1310|MPRO_ECAM_CI_| |ECAM: CamIn - Coupling mode|
|1311|MPRO_ECAM_CI_|incr|ECAM: CamIn - Coupling distance|
|1312|MPRO_ECAM_CI_|incr|ECAM: CamIn - Synchronization position|

Table 8.31: “Electronic camming - Table selection” parameters

Table 8.30: “Synchronized motion” parameters

Table 8.32: “Electronic camming - Synchronization” parameters

MOOG ID No.:CB40859-001 Date:11/2020

MSD ServoDrive - DeviceHelp 277

# 8 Motion profile

MOOG ID No.:CB40859-001 Date:11/2020 MSD ServoDrive - DeviceHelp 278

|ID|Index|Name|Unit|Description|
|---|---|---|---|---|
|1313|0|MPRO_ECAM_CO_SyncPosST|(singleturn part)|ECAM: CamOut - Slave reference|
|1314|0|MPRO_ECAM_CO_DecouplingMode|63|ECAM: CamOut - Decoupling mode|
|1315|0|MPRO_ECAM_CO_BreakingPosST|incr|ECAM: CamOut - Decoupling position|
|1316|0|MPRO_ECAM_CO_DecouplingDist|incr|ECAM: CamOut - Decoupling distance|
|1317|0|MPRO_ECAM_CO_StandstillPos|mDegree|ECAM: CamOut - Slave standstill position|

# Table 8.32: “Electronic camming - Synchronization” parameters (continue)

|ID|Index|Name|Unit|Description|
|---|---|---|---|---|
|1346| |MPRO_ECAM_SP_Table| |ECAM: Setpoint table interface|
|1346|0|Index| |Index of setpoint table|
|1346|1|Value| |Value at index of setpoint table|
|1347|0 to 31|MPRO_ECAM_SP_Index| |ECAM: Setpoint segments start index|
|1348|0 to 31|MPRO_ECAM_SP_Length| |ECAM: Setpoint segments length|
|1349|0 to 31|Length| | |
|1350|0|MPRO_ECAM_SP_MaDist| |ECAM: Setpoint segments master distance|
|1351|0|MPRO_ECAM_SP_IpoType| |ECAM: Setpoint segments interpolation type|
|1352|0 to 31|Checksum| |ECAM: Setpoint table checksum|
|1353|0 to 31|GainNum| |ECAM: Setpoint segments gain numerator|
| | |GainDen| |ECAM: Setpoint segments gain denominator|

# Table 8.33: “Electronic camming - Table segments” parameters

|ID|Index|Name|Unit|Description|
|---|---|---|---|---|
|1329|0 to 63|MPRO_ECAM_SegData_IndexNext| |ECAM: Index of the following segment|
|1330|0 to 63|MPRO_ECAM_SegData_IndexPrev| |ECAM: Index of the previous segment|
|1331|0 to 63|MPRO_ECAM_SegData_ProfileMode| |ECAM: Profile mode of the current segment|
|1332|0 to 63|MPRO_ECAM_SegData_DistMaster| |ECAM: Length of the master section of the current segment|
|1333|0 to 63|MPRO_ECAM_SegData_DistSlave| |ECAM: Length of the slave section of the current segment|
|1334|0 to 63|MPRO_ECAM_SegData_Lambda| |ECAM: Lambda value of the current segment|
|1335|0 to 63|MPRO_ECAM_SegData_StatusWord| |ECAM: Status word of the current segment|
|1336|0 to 63|MPRO_ECAM_SegData_ControlWord| |ECAM: Control word of the current segment|

# 8.11.2 Control word for synchronized motion

|Bit|Function|PLC function|Bit number|Description|
|---|---|---|---|---|
|0-7|Start segment (8-bit value)|-|0-7|Actual segment (8-bit value)|
|8-15|Reserved|-| |Actual ECAM / EGEAR state machine state (4 Bit value)|
|16|Absolute (true) / relative (false) master relationship|-| |- 0: ECAM / EGEAR asynchronous
- 1: ECAM / EGEAR synchronous
|
|17|Absolute (true) / relative (false) master (CAM) relationship at cam in|-| |- 2: ECAM / EGEAR synchronizing
- 3: ECAM / EGEAR desynchronizing
|
|18|Absolute (true) / relative (false) slave (CAM) relationship at cam in|-| |- 4: ECAM / EGEAR active and waiting for going asynchronous
|
|19-23|Reserved|-| |- 5: ECAM / EGEAR inactive and waiting for going synchronous
|
|24|Change gear ratio of the electronic gear online|MCB_GearRatioChange| | |
|25|Disable master calculation|MCB_Cam_MasterEnable| | |
|26|Enable master calculation|MCB_Cam_MasterEnable| | |
|27|Select CAM table|MCB_CamTableSelect| | |
|28|Start Ecam|MCB_CamIn| | |
|29|Stop Ecam|MCB_CamOut| | |
|30|Start Egear|MCB_GearIn| | |
|31|Stop Egear|MCB_GearOut| | |

# 8.11.3 Status word for synchronized motion

|Bit|Function|PLC function|Bit number|Description|
|---|---|---|---|---|
|12-26|Reserved|-| | |
|27|ECAM / EGEAR is active|-| | |
|28|Valid segments chosen|-| | |
|29|Master data are valid|-| | |
|30|Master is initialized|-| | |
|31|Master calculation is active|-| | |

Table 8.35: Control word ECAM (P 1318[0] - MPRO_ECAM_ControlWord)

Table 8.36: ECAM status word (P 1326[0] - MPRO_ECAM_StatusWord)

MOOG ID No.:CB40859-001 Date:11/2020 MSD ServoDrive - DeviceHelp 279

# 8 Motion profile

# 8 Motion profile

MOOG ID No.:CB40859-001 Date:11/2020

MSD ServoDrive - DeviceHelp 280

# 8.11.4 Master configuration

the master encoder, you will need to set the resolution relative to a single motor revolution in P 250 - MPRO_ECAM_PARAMaster_Amplitude (see below).

- ENC CH1 (3) = Encoder channel 1 X7 (Sin/Cos)
- ENC CH2 (4) = Encoder channel 2 X6 (Resolver)
- ENC CH3 (5) = Encoder channel 3 X8 (optional)

This function is only available if an external interface X8 (option module) is present.

- TP0 (6) = Pulse counter on probe channel 0 (TP0)
- TP1 (7) = Pulse counter on probe channel 1 (TP1)
- ENC_CH4 (8) = Encoder channel 4 (p. e. fieldbus)
- TWIN_POS (9) = TWIN remote reference position (P-2607)

Image 8.72: “Master configuration” screen

# Channel selection (master encoder)

P 1319[0] - MPRO_ECAM_CamMaster_AxisType is used to define the master encoder.

- NO AXIS (0) = No axis
- VIRTUAL MASTER (1) = Virtual master

If you select this function, you will be able to configure additional settings by clicking on the enabled “Options...” button (see Section ""Virtual Master"" on page 286).

- PARA (2) = Master parameter interface

If you select this function because a higher-level controller is being used as

# Anti-reverse mode

Slave only starts moving along with it again as soon as the master reaches the zero position.

P 1320[0] - MPRO_ECAM_CamMaster_RevLockMode is used to define the reverse lock mode, which can be used either with or without path compensation. The dashed lines in the following diagrams indicate what the engagement distance is:

# Example:

If the master, which has moved two motor revolutions in the direction blocked for the slave, then moves in the unblocked direction again, the slave only moves off when the master has traversed the zero point.

- INACTIVE (0) = Reverse lock inactive
- ACTIVE (2) = Reverse lock enabled - without path optimization
- ACTIVE WAY COMP (1) = Reverse lock active - with way compensation

While the slave accelerates to the speed of the master during engagement, the master and slave do not move synchronously. This function needs to be selected in order to quickly catch up to the master that is running ahead.

# Example:

- Master (black line) rotates in the blocked direction
- The slave (blue line) remains stopped
- Master rotates in the unblocked direction again
- The slave follows the master directly in the unblocked direction

Assume the master has moved two motor revolutions in the direction for which the slave lock is enabled. If the master now moves in the direction for which there is no lock, the slave will immediately start running in that direction.

MOOG ID No.:CB40859-001 Date:11/2020

MSD ServoDrive - DeviceHelp 281

# 8 Motion profile

MOOG ID No.:CB40859-001 Date:11/2020 MSD ServoDrive - DeviceHelp 282

|Filter type|ID|Index Name|Unit|Description|
|---|---|---|---|---|
|When using a real master encoder, encoder signals may be subject to noise.|P 1340|1319|0|MPRO_ECAM_CamMaster_AxisType|
| | |MPRO_ECAM_CamMaster_SpeedFilTyp| |ECAM / EGEAR: Channel selection of internal master input|
| | |1320|0|MPRO_ECAM_CamMaster_RevLockMode|
| | |1321|0|MPRO_ECAM_CamMaster_Amplitude|
| | |1322|0|MPRO_ECAM_CamMaster_GearNum|
| | |1323|0|MPRO_ECAM_CamMaster_GearDen|
|Filter time|1327|0|ms|ECAM / EGEAR: Filter time constant of master|
|If P 1340[0] is used to enable a filter, P 1327[0] - MPRO_ECAM_CamMaster_SpeedTFil can be used to define the corresponding filter time.|1328|0|speed|ECAM / EGEAR: Speed factor of the internal master|
|Speed factor|1340|0| |MPRO_ECAM_CamMaster_SpeedFilTyp|
|The master encoder can be assigned an additional speed factor P 1328[0] - MPRO_ECAM_CamMaster_SpeedFactor.|1341|0|incr|ECAM / EGEAR: Master drive offset|

Table 8.37: “Synchronized motion - Master configuration” parameters (continue)

| | | |ID|Index Name|Unit|Description|
|---|---|---|---|---|---|---|
|247|0|MPRO_ECAM_ParaMaster_ActPos|incr|ECAM / EGEAR: Parameter interface master position| | |
|248|0|MPRO_ECAM_ParaMaster_ActSpeed|rpm|ECAM / EGEAR: Parameter interface master speed| | |
|249|0|MPRO_ECAM_ParaMaster_ActAcc|rpm|ECAM / EGEAR: Parameter interface master acceleration| | |
| |250|0|MPRO_ECAM_ParaMaster_Amplitude| |ECAM / EGEAR: Parameter interface master amplitude| |

Table 8.37: “Synchronized motion - Master configuration” parameters

# 8.11.5 Electronic gearing

# Gear ratio

The gear ratio is specified as a fraction. This ensures that the position references can be translated to the motor shaft with no rounding error.

- ""Slave"" (P 252[0] - MPRO_ECAM_Egear_GearNum) is the numerator
- ""Master"" (P 251[0] - MPRO_ECAM_Egear_GearDen) is the denominator

# Scaling of speed pre-control

Defined with P 265[0] - MPRO_ECAM_CamSlave_SpeedFactor definiert.

# Scaling of torque pre-control

Defined with P 266[0] - MPRO_ECAM_CamSlave_TorqueFactor.

# Engagement

See Section ""Engagement"" on page 284.

# Disengagement

See Section ""Disengagement"" on page 285.

|ID|Index Name|Unit|Description|
|---|---|---|---|
|251|0 MPRO_ECAM_Egear_GearDen| |EGEAR: Gear denominator|
|252|0 MPRO_ECAM_Egear_GearNum| |EGEAR: Numerator of gear ratio|
|1344|0 MPRO_ECAM_Egear_LimRefAcc|rpm/s|EGEAR: Acceleration limit for reference|
|1345|0 MPRO_ECAM_Egear_LimRefJerk|rpm/s²|EGEAR: Jerk limit for reference|

Table 8.38: “Synchronized motion - Electronic gearing” parameters

Image 8.73: ""Electronic gearing"" screen

MOOG ID No.:CB40859-001 Date:11/2020 MSD ServoDrive - DeviceHelp 283

# 8 Motion profile

# 8 Motion profile

MOOG ID No.:CB40859-001 Date:11/2020

MSD ServoDrive - DeviceHelp 284

# 8.11.6 Engagement

used to define the engagement distance (between the dashed lines).

P 253[0] - MPRO_ECAM_Egear_GearInMode is used to define the mode for engagement.

- DIRECT (0) = Direct
- Direct engagement: Angular synchronous; with jerking (no ramps).
- CROSSFADE (3) = Crossfading
- Engagement with crossfading function (5th degree polynomial): Angular synchronous; jerk-limited; speed will overshoot during engagement.
- RAMP (1) = Linear speed ramp
- Engagement with linear acceleration: Not angular synchronous; with jerking.
- FADE (2) = Engagement fade-out
- Engagement with fade-in function (5th degree polynomial): Not angular synchronous; jerk-limited. The position is ignored. ",How are the analog inputs ISA00 and ISA01 configured in the 'MSD ServoDrive - DeviceHelp' document?,A5,The document specifies configuring ISA00 and ISA01 for analog or digital setpoints via P 109[0] and P 110[0].,1.921875,1.9375,3.34375,1.6015625,0.5703125
5,msd_servo_drive.txt,76,b87ca5e232c2bdbb6fa16a8a401c6b5d285dc0183e73cc9d134de13dd2fc71d2,"MOOG ID No.:CB40859-001 Date:11/2020

MSD ServoDrive - DeviceHelp 267

# 8 Motion profile

MOOG ID No.:CB40859-001 Date:11/2020 MSD ServoDrive - DeviceHelp 268

# Deceleration

With ...

- P 194 - MPRO_TAB_TDec (for torque control) or
- P 197 - MPRO_TAB_SDec (for speed control) or
- P 200 - MPRO_TAB_PDec (for position control)

and indexes 0–15, the deceleration for each individual motion task can be defined. The input must not be zero.

# Wait time in Auto mode

P 204 - MPRO_TAB_WaitTime is used to define the wait time before the next motion task is carried out.

# Maximum table index in Auto mode

P 206[0] - MPRO_Tab_MaxIdx is used to define the table index up to which driving jobs will be carried out in one of the auto modes.

# Current table index

P 207[0] - MPRO_Tab_ActIdx will show the index for the motion task that is currently active. If parameter P 205 MPRO_TAB_Mode is set to “Para(0)”, a driving set can be entered and approached directly.

# Activation of reference table

The following procedures can be used in order to activate the setpoint table for operation.

|ID|Index Name|Unit|Description|
|---|---|---|---|
|193|MPRO_TAB_TAcc|TAB: Torque mode acceleration|Nm/ms|
|193|0|MPRO_TAB_TAcc|Nm/ms|
|193|1 - 15|MPRO_TAB_TAcc|Nm/ms|
|194|MPRO_TAB_TDec|TAB: Torque mode deceleration| |
|194|0|MPRO_TAB_TDec|Nm/ms|
|194|1 - 15|MPRO_TAB_TDec|Nm/ms|

# Table 8.23: Activation of table references

# Table 8.24: “Setpoint table settings” parameters

# Table 8.24: “Setpoint table settings” parameters (continue)

|ID|Index Name|Unit|Description|ID|Index Name|Unit|Description|
|---|---|---|---|---|---|---|---|
|195|MPRO_TAB_TRef|Nm|TAB: Torque mode reference value|208|MPRO_TAB_OutputNo| |OSD TAB: actual table index and target|
|195|MPRO_TAB_TRef|Nm| |208|MPRO_TAB_OutputNo| | |
|196|MPRO_TAB_SAcc|rev/min/s|TAB: Speed mode acceleration|269|MPRO_TAB_Ctrl| |TAB: control word|
|196|MPRO_TAB_SAcc|rev/min/s| | | | | |
|197|MPRO_TAB_SDec|rev/min/s|TAB: Speed mode deceleration| | | | |
|197|MPRO_TAB_SDec|rev/min/s| | | | | |
|198|MPRO_TAB_SRef|rev/min|TAB: Speed mode reference value| | | | |
|198|MPRO_TAB_SRef|rev/min| | | | | |
|199|MPRO_TAB_PAcc|rev/min/s|TAB: Position control mode acceleration| | | | |
|199|MPRO_TAB_PAcc|rev/min/s| | | | | |
|200|MPRO_TAB_PDec|rev/min/s|TAB: Position control mode Acceleration| | | | |
|200|MPRO_TAB_PDec|rev/min/s| | | | | |
|201|MPRO_TAB_PSpd|rev/min|TAB: Position control mode speed| | | | |
|201|MPRO_TAB_PSpd|rev/min| | | | | |
|202|MPRO_TAB_PPos|mDegree|TAB: Position control mode reference value| | | | |
|202|MPRO_TAB_PPos|mDegree| | | | | |
|203|MPRO_TAB_PMode| |Position control table:Mode| | | | |
|203|MPRO_TAB_PMode| | | | | | |
|204|MPRO_TAB_WaitTime|ms|TAB: Wait time| | | | |
|204|MPRO_TAB_WaitTime|ms| | | | | |
|205|MPRO_TAB_Mode| |TAB mode| | | | |
|206|MPRO_Tab_MaxIdx| |TAB: Max index in AUTO mode| | | | |
|207|MPRO_TAB_ActIdx| |TAB: Actual index| | | | |

MOOG ID No.:CB40859-001 Date:11/2020

MSD ServoDrive - DeviceHelp

# 8 Motion profile

MOOG ID No.:CB40859-001 Date:11/2020

MSD ServoDrive - DeviceHelp 270

# 8.8 Analog channel (ISA00 und ISA01)

# Offset (O)

This parameter (P 174 - MPRO_ANA0_SOffset for ISA00, P 184 - MPRO_ANA1_SOffset for ISA01) compensates for component variations and is used for offset compensation purposes. Depending on the control mode being used (see Section ""Basic settings"" on page 110), the value will be stored in parameter index [0] (torque control), [1] (speed control) or [2] (position control).

# Backlash (B)

This parameter (P 175 - MPRO_ANA0_SThreshold for ISA00, P 185 - MPRO_ANA1_SThreshold for ISA01) can suppress axis motion close to the standstill (stop) position. Depending on the control mode being used (see Section ""Basic settings"" on page 110), the value will be stored in parameter index [0] (torque control), [1] (speed control) or [2] (position control).

Image 8.68: “Analog channel” screen

# Acceleration ramp

Two standard analog inputs (ISA00, ISA01) are available. These inputs can be configured...

- with negative values for analog setpoint settings
- with positive values for digital setpoint processing

(P 109[0] - MPRO_INPUT_FS_ISA00 and P 110[0] - MPRO_INPUT_FS_ISA01).

see also section ""Analog Inputs"" on page 303. By using the ""REV(-2) = Analog setpoint"" setting, an analog input voltage of ±10 V can be processed as a setpoint.

# Deceleration ramp

This parameter serves as a deceleration ramp for torque control (P 176[1] - MPRO_ANA0_TRamp for ISA00, P 186[1] - MPRO_ANA1_TRamp for ISA01) or speed control (P 177[1] - MPRO_ANA0_SRamp for ISA00, P 187[1] - MPRO_ANA1_SRamp for ISA01). Depending on the control mode being used (see Section ""Basic settings"" on page 110), the value will be stored in parameter index [0] (torque control), [1] (speed control) or [2] (position control).

This parameter (P 173 - MPRO_ANA0_Scale for ISA00, P 183 - MPRO_ANA1_Scale for ISA01) is used to define which speed / which torque / which position corresponds to the maximum analog value. Depending on the control mode being used (see Section ""Basic settings"" on page 110), the value will be stored in parameter index [0] (torque control), [1] (speed control) or [2] (position control).

# 8.8.1 Special characteristics of position control mode

A threshold value can also be specified which generates a run-on range around the last reference value. A ramp function calculates a motion profile for the position reference from pre-defined acceleration and speed limits.

The position references on the analog channel are not applied immediately, but dependent on a digital input. Accordingly, one of the ISD00 to ISD06 digital inputs must be set to a value of ""REFANAEN(28) = Enable analog reference value"" (see Section ""Digital inputs"" on page 290). The position setpoint being received will only be applied if the corresponding digital input is active. The acceleration is entered using P 173[0] - MPRO_ANA0_TScale or P 183[0] - MPRO_ANA1_TScale.

# 8.8.2 Wire Break Monitoring

P 399 - CON_ANAWireBrk_Th can be used to configure wire break monitoring for the analog inputs. For details see Section ""Wire Break Monitoring"" on page 306.

|Function|TLIM (-4)|OVR (-3)|REFV (-2)|leer (-1)|OFF (0)|
|---|---|---|---|---|---|
|Digital|(1)-(28)|(1)-(28)|(1)-(28)|(1)-(28)|(1)-(28)|
|Analog channel|Filter|Scale|Offset|Profile|generator|

Control

Image 8.69: Reference processing structure

MOOG ID No.:CB40859-001 Date:11/2020

MSD ServoDrive - DeviceHelp 271

# 8 Motion profile

# 8 Motion profile

MOOG ID No.:CB40859-001 Date:11/2020

|ID|Index Name|Unit|Description|ID|
|---|---|---|---|---|
|395|CON_ANA_Isaf_Scaled| |Analog inputs: Values (filt, norm, comp, scaled)|174|
|395|0 ISA00| |Scaled, compensated, filtered, normalized value|175|
|395|1 ISA01| |Scaled, compensated, filtered, normalized value| |
|396|CON_ANA_Scale_ThUpper| |Analog inputs: Upper scaling limits|175|
|396|0 ISA00|%|Upper scaling (@ 10 V) threshold|175|
|396|1 ISA01|%|Upper scaling (@ 10 V) threshold| |
|397|CON_ANA_Scale_ThZero| |Analog inputs: Zero scaling thresholds|176|
|397|0 ISA00|V|Zero scaling threshold (+/-)|176|
|397|1 ISA01|V|Zero scaling threshold (+/-)| |
|398|CON_ANA_Scale_ThLower| |Analog inputs: Lower scaling limits|177|
|398|0 ISA00|%|Lower scaling (@ zero threshold) threshold|177|
|398|1 ISA01|%|Lower scaling (@ zero threshold) threshold| |
|399|CON_ANA_WireBrk_Th| |Analog inputs: Wire break thresholds|Table 8.26:|
|399|0 ISA00|V|Wire break detection threshold| |
|399|1 ISA01|V|Wire break detection threshold| |
|405|0 CON_ANA_Filt0|ms|Analog input ISA00: Filter time constant (PT 1)|ID|
|408|CON_ANA_Isaf_Norm| |Analog inputs: Values (filt, norm)|183|
|408|0 ISA00| |Filtered, normalized value|183|
|408|1 ISA01| |Filtered, normalized value|183|

Table 8.25: “Analog channel” parameters

|ID|Index Name|Unit|Description|ID|
|---|---|---|---|---|
|173|MPRO_ANA0_Scale| |ANA0: scale factors|184|
|173|0 MPRO_ANA0_TScale|Nm|ANA0: scale factor torque reference|185|
|173|1 MPRO_ANA0_SScale|rev/min|ANA0: scale factor speed reference|185|
|173|2 MPRO_ANA0_PScale|mDegree|ANA0: scale factor position reference| |
|174|MPRO_ANA0_Offset| |ANA0: offsets|185|
|174|0 MPRO_ANA0_TOffset|Nm|ANA0: offsets for torque reference|185|

Table 8.26: “Analog channel ISA00” parameters

|Index Name|Unit|Description|
|---|---|---|
|1 MPRO_ANA0_SOffset|rev/min|ANA0: offsets for speed reference|
|2 MPRO_ANA0_POffset|mDegree|ANA0: offsets for position reference|
|MPRO_ANA0_Threshold| |ANA0: thresholds|
|0 MPRO_ANA0_TThreshold|Nm|ANA0: threshold for torque reference|
|1 MPRO_ANA0_SThreshold|rev/min|ANA0: threshold for speed reference|
|2 MPRO_ANA0_PThreshold|mDegree|ANA0: threshold for position reference|
|MPRO_ANA0_TRamp| |ANA0: Torque mode acceleration [0] and deceleration [1]|
|0 MPRO_ANA0_TRamp|Nm/s| |
|1 MPRO_ANA0_TRamp|Nm/s| |
|MPRO_ANA0_SRamp| |ANA0: Speed mode acceleration [0] and deceleration [1]|
|0 MPRO_ANA0_SRamp|SPEED/s| |
|1 MPRO_ANA0_SRamp|SPEED/s| |

“Analog channel ISA00” parameters (continue)

|Index Name|Unit|Description|
|---|---|---|
|MPRO_ANA1_Scale| |ANA1: scale factors|
|0 MPRO_ANA1_TScale|Nm|ANA0: scale factor torque reference|
|1 MPRO_ANA1_SScale|rev/min|ANA0: scale factor speed reference|
|2 MPRO_ANA1_PScale|mDegree|ANA0: scale factor position reference|
|MPRO_ANA1_Offset| |ANA1: offsets|
|0 MPRO_ANA1_TOffset|Nm|ANA1: offsets for torque reference|
|1 MPRO_ANA1_SOffset|rev/min|ANA1: offsets for speed reference|
|2 MPRO_ANA1_POffset|mDegree|ANA1: offsets for position reference|
|MPRO_ANA1_Threshold| |ANA1: thresholds|
|0 MPRO_ANA1_TThreshold|Nm|ANA1: threshold for torque reference|
|1 MPRO_ANA1_SThreshold|rev/min|ANA1: threshold for speed reference|
|2 MPRO_ANA1_PThreshold|mDegree|ANA1: threshold for position reference|

“Analog channel ISA01” parameters

# 8 Motion profile

|ID|Index Name|Unit|Description|
|---|---|---|---|
|186|MPRO_ANA1_TRamp|Nm/s|ANA1: Torque mode acceleration [0] and deceleration[1]|
|186|MPRO_ANA1_TRamp|Nm/s| |
|187|MPRO_ANA1_SRamp|SPEED/s|ANA1: Speed mode acceleration [0] and deceleration [1]|
|187|MPRO_ANA1_SRamp|SPEED/s| |

# Table 8.27: “Analog channel ISA01” parameters (continue)

Display

- System state
- Initialization on device startup
- Not ready (DC link voltage possibly too low)
- Start inhibit (DC link voltage present, power stage off)
- Starting lockout
- Ready for start
- Control initialization: Auto commutation, flux build-up etc.

# Table 8.28: Central state machine according to CiA 402 device display

MOOG ID No.:CB40859-001 Date:11/2020

MSD ServoDrive - DeviceHelp 273

# 8 Motion profile

MOOG ID No.:CB40859-001 Date:11/2020

MSD ServoDrive - DeviceHelp 274

|Display|System state|power disabled|fault|
|---|---|---|---|
|Control enabled|0|Start|7|
| |fault reaction active|0|14|
|Quick stop active|1|not ready|8|
| |to switch on|1|17|
|Error reaction active|2|switch on|disabled|
| |2|7| |
|Error state (in this state the error is indicated directly on the display.)|3|ready to|switch on|
|Device is reset (display flashes)|power enabled|3|6|
| |10|12| |
|• Number [5.] flashes when “STO” (Safe Torque Off) input is active. Display goes out when STO inactive.| | | |
|• The dot on the display flashes when the power stage is active.| | | |

Table 8.28: Central state machine according to CiA 402 device display (continue)

NOTE

l The system states indicated on the display may differ from the states in the table depending on the drive profile setting.

Image 8.70: State machine diagram based on CANopen communications

⓪ to ① State number

1 to 17 State transition (No. 17: DC link voltage cut off)

Legend for “State machine diagram based on CANopen communications” figure

# 8.10 Touch probe

|ID|Index Name / Setting|
|---|---|
|241|0 MPRO_TP_Position|
|241|1 MPRO_TP_Position|
|241|2 MPRO_TP_Position|
|241|3 MPRO_TP_Position|
|241|4 MPRO_TP_Position|
|1400|0 MPRO_TP_Config|
| |TP_TP (0)|
| |AB (1)|
| |PD_UP (2)|
| |PD_DOWN (3)|
| |PC_PC (4)|
| |PC_TP (5)|
| |TP_PC (6)|
| |ENC_ENC (7)|
| |ENC_TP (8)|
| |TP_ENC (9)|

Using the touch probe inputs, touch probe functions can be performed. In order to be able to do this, P 106[0] - MPRO_INPUT_FS_ISD05 and P 107[0] - MPRO_INPUT_FS_ISD06 must be used to set digital inputs ISD05 and ISD06 to ""PROBE(15) = Touch probe (only ISD05/06)"" (see Section ""Digital inputs"" on page 290). HTL encoders can be evaluated or pulse counters implemented using the MSD PLC.

The touch probe can be triggered with P 240 - MPRO_TP_Ctrl. This enables triggering on a positive or negative edge, or on both edges, of the signal detected on the touch probe inputs. After the measurement, the parameter jumps back to the value ""NONE (0)"" and the latch position is mapped in the corresponding subindex of parameter P 241 - MPRO_TP_Position. A continuous touch probe mode is not possible at present, so the touch probe has to be reactivated after the measurement.

P 1402 - MPRO_TP_Channel can be used to select various positions as actual value sources of the latch position for the touch probe functionality. The following table provides an overview of the available settings. The counters are accessed via the MSD PLC or a bus system.

|ID|Index Name / Setting|Unit|Description|
|---|---|---|---|
|240|MPRO_TP_Ctrl|Touch probe: Control| |
| |0| |NONE (0) = No function|
| |1| |POS (1) = Positive edge|
| |2| |NEG (2) = Negative edge|
| |3| |BOTH (3) = Both edges|
|240|0 MPRO_TP_Ctrl| | |
|240|1 MPRO_TP_Ctrl| | |
|240|2 MPRO_TP_Ctrl| | |
|241|MPRO_TP_Position|Probe: Pos. high/low edge of TP0/1, encoder zero pulse| |

Table 8.29: “Touch probe” parameters

MOOG ID No.:CB40859-001 Date:11/2020

# 8 Motion profile

|Unit|Description|
|---|---|
|mDegree|Touch probe: Configuration|
|mDegree|TP0, TP1 touch probe|
|mDegree|TP0, TP1 as encoder, A/B as quadrature counting|
|mDegree|TP0, TP1 as encoder, pulse (TP0) / direction (TP1), count up on direction high|
|mDegree|TP0, TP1 as encoder, pulse (TP0) / direction (TP1), count down on direction high|
|mDegree|TP0 pulse counter, TP1 pulse counter|
|mDegree|TP0 pulse counter, TP1 touch probe|
|mDegree|TP1 touch probe, TP0 pulse counter|
|mDegree|TP0 encoder counter, TP1 encoder counter|
|mDegree|TP0 encoder counter, TP1 touch probe|
|mDegree|TP0 touch probe, TP1 encoder counter|

Touch probe: Channel

|Unit|Description|
|---|---|
|ACTPOS (0)|Actual position in user units|
|ACTPOSINC (1)|Actual position in increments|
|MASTERPOS (2)|Master position in increments|
|ENCPOS_CH1 (3)|Encoder position Channel 1|
|ENCPOS_CH1_INC (4)|Encoder position Channel 1 in increments|
|ENCPOS_CH2 (5)|Encoder position Channel 2|
|ENCPOS_CH2_INC (6)|Encoder position Channel 2 in increments|

# 8 Motion profile

MOOG ID No.:CB40859-001 Date:11/2020 MSD ServoDrive - DeviceHelp 276

|ID|Index Name / Setting|Unit|Description|
|---|---|---|---|
|7|ENCPOS_CH3 (7)| |Encoder position Channel 3|
|8|ENCPOS_CH3_INC (8)| |Encoder position Channel 3 in increments|
|9|ENCPOS_CH4 (9)| |Encoder position Channel 4|
|10|ENCPOS_CH4_INC (10)| |Encoder position Channel 4 in increments|
|11|ACTPOS2 (11)| |Actual position of redundant encoder in user units|
|12|Sercos (12)| |Referred to Sercos profile parameters S-x-0426, S-x-0427|
|13|UserRefPos(13)| |Reference position in user units|
|14|MasterPosST(14)| |Master position (ECAM, EGEAR) singleturn, always steps|
|15|CommonMasterPos(15)| |Master position (ECAM, EGEAR) singleturn, always steps|
|16|CommonMasterPosST(15)| |Master position (ECAM, EGEAR) singleturn, always steps|
|1402|MPRO_TP_Channel| | |
|1402|MPRO_TP_Channel| | |
|1402|MPRO_TP_Channel| | |
|1404|MPRO_TP_Lines| |Touch probe: Lines @ pulse counter on channel x|
|1404|MPRO_TP_Lines| | |
|1404|MPRO_TP_Lines| | |

Image 8.71: “Synchronized motion” screen

There are various modes available in the “synchronization mode” drop-down menu (P 242[0] - MPRO_ECAM_SyncModMode):

- Off(0) = Synchronized motion off
- ECAM_iPlc(1) = Electronic cam plate via MSD PLC
- EGEAR_iPlc(2) = Electr. gear unit via MSD PLC
- ECAM_PARA(3) = Electronic camming via parameters
- EGEAR_PARA(4) = Electronic gearing via parameters

NOTE: For more information refer to the bus system User Manuals or the description of the MSD PLC.

# 8.11.1 Electronic cam plate

The other parameters are configured in separate screens that can be accessed with the corresponding buttons.

- Master configuration (see Section ""Master configuration"" on page 280)
- Electronic gearing (see Section ""Electronic gearing"" on page 283)
- Electronic camming (see Section ""Electronic cam plate"" on page 277)

P 1318[0] - MPRO_ECAM_ControlWord is the control word for “synchronized motion” (see Section ""Control word for synchronized motion"" on page 279).

P 1326[0] - MPRO_ECAM_StatusWord is the status word for “synchronized motion” (see Section ""Status word for synchronized motion"" on page 279).

# 8.11.1.1 Table selection

|ID|Index Name|Unit|Description|
|---|---|---|---|
|1300|MPRO_ECAM_CTS_| |ECAM: CamTableSelect - Master reference|
|1301|MasterRef| | |
|1305|MPRO_ECAM_CTS_| |ECAM: CamTableSelect - Method for changing the camtable|
|1306|MPRO_ECAM_CTS_| |ECAM: CamTableSelect - Mode for changing the camtable|
|1307|MPRO_ECAM_CTS_|incr|ECAM: CamTableSelect - Distance for changing the camtable|
|242|MPRO_ECAM_| |ECAM / EGEAR: Mode of synchronized motion SyncModMode|
|265|MPRO_ECAM_| |ECAM / EGEAR: Slave speed factor (1 = 100%).|
|266|CamSlave_SpeedFactor| | |
|268|MPRO_ECAM_| |ECAM / EGEAR: Mode of switching off sync. motion|

# 8.11.1.2 Synchronization

|ID|Index Name|Unit|Description|
|---|---|---|---|
|1342|MPRO_ECAM_CI_|incr|ECAM: CamIn - Synchronization position (multiturn part)|
|1343|MPRO_ECAM_CO_|incr|ECAM: CamOut - Decoupling pos. (multiturn part)|
|1303|MPRO_ECAM_CI_|incr|ECAM: CamIn - Master offset|
|1308|MPRO_ECAM_CI_| |ECAM: CamIn - Master reference|
|1309|MPRO_ECAM_CI_| |ECAM: CamIn - Slave reference|
|1310|MPRO_ECAM_CI_| |ECAM: CamIn - Coupling mode|
|1311|MPRO_ECAM_CI_|incr|ECAM: CamIn - Coupling distance|
|1312|MPRO_ECAM_CI_|incr|ECAM: CamIn - Synchronization position|

Table 8.31: “Electronic camming - Table selection” parameters

Table 8.30: “Synchronized motion” parameters

Table 8.32: “Electronic camming - Synchronization” parameters

MOOG ID No.:CB40859-001 Date:11/2020

MSD ServoDrive - DeviceHelp 277

# 8 Motion profile

MOOG ID No.:CB40859-001 Date:11/2020 MSD ServoDrive - DeviceHelp 278

|ID|Index|Name|Unit|Description|
|---|---|---|---|---|
|1313|0|MPRO_ECAM_CO_SyncPosST|(singleturn part)|ECAM: CamOut - Slave reference|
|1314|0|MPRO_ECAM_CO_DecouplingMode|63|ECAM: CamOut - Decoupling mode|
|1315|0|MPRO_ECAM_CO_BreakingPosST|incr|ECAM: CamOut - Decoupling position|
|1316|0|MPRO_ECAM_CO_DecouplingDist|incr|ECAM: CamOut - Decoupling distance|
|1317|0|MPRO_ECAM_CO_StandstillPos|mDegree|ECAM: CamOut - Slave standstill position|

# Table 8.32: “Electronic camming - Synchronization” parameters (continue)

|ID|Index|Name|Unit|Description|
|---|---|---|---|---|
|1346| |MPRO_ECAM_SP_Table| |ECAM: Setpoint table interface|
|1346|0|Index| |Index of setpoint table|
|1346|1|Value| |Value at index of setpoint table|
|1347|0 to 31|MPRO_ECAM_SP_Index| |ECAM: Setpoint segments start index|
|1348|0 to 31|MPRO_ECAM_SP_Length| |ECAM: Setpoint segments length|
|1349|0 to 31|Length| | |
|1350|0|MPRO_ECAM_SP_MaDist| |ECAM: Setpoint segments master distance|
|1351|0|MPRO_ECAM_SP_IpoType| |ECAM: Setpoint segments interpolation type|
|1352|0 to 31|Checksum| |ECAM: Setpoint table checksum|
|1353|0 to 31|GainNum| |ECAM: Setpoint segments gain numerator|
| | |GainDen| |ECAM: Setpoint segments gain denominator|

# Table 8.33: “Electronic camming - Table segments” parameters

|ID|Index|Name|Unit|Description|
|---|---|---|---|---|
|1329|0 to 63|MPRO_ECAM_SegData_IndexNext| |ECAM: Index of the following segment|
|1330|0 to 63|MPRO_ECAM_SegData_IndexPrev| |ECAM: Index of the previous segment|
|1331|0 to 63|MPRO_ECAM_SegData_ProfileMode| |ECAM: Profile mode of the current segment|
|1332|0 to 63|MPRO_ECAM_SegData_DistMaster| |ECAM: Length of the master section of the current segment|
|1333|0 to 63|MPRO_ECAM_SegData_DistSlave| |ECAM: Length of the slave section of the current segment|
|1334|0 to 63|MPRO_ECAM_SegData_Lambda| |ECAM: Lambda value of the current segment|
|1335|0 to 63|MPRO_ECAM_SegData_StatusWord| |ECAM: Status word of the current segment|
|1336|0 to 63|MPRO_ECAM_SegData_ControlWord| |ECAM: Control word of the current segment|

# 8.11.2 Control word for synchronized motion

|Bit|Function|PLC function|Bit number|Description|
|---|---|---|---|---|
|0-7|Start segment (8-bit value)|-|0-7|Actual segment (8-bit value)|
|8-15|Reserved|-| |Actual ECAM / EGEAR state machine state (4 Bit value)|
|16|Absolute (true) / relative (false) master relationship|-| |- 0: ECAM / EGEAR asynchronous
- 1: ECAM / EGEAR synchronous
|
|17|Absolute (true) / relative (false) master (CAM) relationship at cam in|-| |- 2: ECAM / EGEAR synchronizing
- 3: ECAM / EGEAR desynchronizing
|
|18|Absolute (true) / relative (false) slave (CAM) relationship at cam in|-| |- 4: ECAM / EGEAR active and waiting for going asynchronous
|
|19-23|Reserved|-| |- 5: ECAM / EGEAR inactive and waiting for going synchronous
|
|24|Change gear ratio of the electronic gear online|MCB_GearRatioChange| | |
|25|Disable master calculation|MCB_Cam_MasterEnable| | |
|26|Enable master calculation|MCB_Cam_MasterEnable| | |
|27|Select CAM table|MCB_CamTableSelect| | |
|28|Start Ecam|MCB_CamIn| | |
|29|Stop Ecam|MCB_CamOut| | |
|30|Start Egear|MCB_GearIn| | |
|31|Stop Egear|MCB_GearOut| | |

# 8.11.3 Status word for synchronized motion

|Bit|Function|PLC function|Bit number|Description|
|---|---|---|---|---|
|12-26|Reserved|-| | |
|27|ECAM / EGEAR is active|-| | |
|28|Valid segments chosen|-| | |
|29|Master data are valid|-| | |
|30|Master is initialized|-| | |
|31|Master calculation is active|-| | |

Table 8.35: Control word ECAM (P 1318[0] - MPRO_ECAM_ControlWord)

Table 8.36: ECAM status word (P 1326[0] - MPRO_ECAM_StatusWord)

MOOG ID No.:CB40859-001 Date:11/2020 MSD ServoDrive - DeviceHelp 279

# 8 Motion profile

# 8 Motion profile

MOOG ID No.:CB40859-001 Date:11/2020

MSD ServoDrive - DeviceHelp 280

# 8.11.4 Master configuration

the master encoder, you will need to set the resolution relative to a single motor revolution in P 250 - MPRO_ECAM_PARAMaster_Amplitude (see below).

- ENC CH1 (3) = Encoder channel 1 X7 (Sin/Cos)
- ENC CH2 (4) = Encoder channel 2 X6 (Resolver)
- ENC CH3 (5) = Encoder channel 3 X8 (optional)

This function is only available if an external interface X8 (option module) is present.

- TP0 (6) = Pulse counter on probe channel 0 (TP0)
- TP1 (7) = Pulse counter on probe channel 1 (TP1)
- ENC_CH4 (8) = Encoder channel 4 (p. e. fieldbus)
- TWIN_POS (9) = TWIN remote reference position (P-2607)

Image 8.72: “Master configuration” screen

# Channel selection (master encoder)

P 1319[0] - MPRO_ECAM_CamMaster_AxisType is used to define the master encoder.

- NO AXIS (0) = No axis
- VIRTUAL MASTER (1) = Virtual master

If you select this function, you will be able to configure additional settings by clicking on the enabled “Options...” button (see Section ""Virtual Master"" on page 286).

- PARA (2) = Master parameter interface

If you select this function because a higher-level controller is being used as

# Anti-reverse mode

Slave only starts moving along with it again as soon as the master reaches the zero position.

P 1320[0] - MPRO_ECAM_CamMaster_RevLockMode is used to define the reverse lock mode, which can be used either with or without path compensation. The dashed lines in the following diagrams indicate what the engagement distance is:

# Example:

If the master, which has moved two motor revolutions in the direction blocked for the slave, then moves in the unblocked direction again, the slave only moves off when the master has traversed the zero point.

- INACTIVE (0) = Reverse lock inactive
- ACTIVE (2) = Reverse lock enabled - without path optimization
- ACTIVE WAY COMP (1) = Reverse lock active - with way compensation

While the slave accelerates to the speed of the master during engagement, the master and slave do not move synchronously. This function needs to be selected in order to quickly catch up to the master that is running ahead.

# Example:

- Master (black line) rotates in the blocked direction
- The slave (blue line) remains stopped
- Master rotates in the unblocked direction again
- The slave follows the master directly in the unblocked direction

Assume the master has moved two motor revolutions in the direction for which the slave lock is enabled. If the master now moves in the direction for which there is no lock, the slave will immediately start running in that direction.

MOOG ID No.:CB40859-001 Date:11/2020

MSD ServoDrive - DeviceHelp 281

# 8 Motion profile

MOOG ID No.:CB40859-001 Date:11/2020 MSD ServoDrive - DeviceHelp 282

|Filter type|ID|Index Name|Unit|Description|
|---|---|---|---|---|
|When using a real master encoder, encoder signals may be subject to noise.|P 1340|1319|0|MPRO_ECAM_CamMaster_AxisType|
| | |MPRO_ECAM_CamMaster_SpeedFilTyp| |ECAM / EGEAR: Channel selection of internal master input|
| | |1320|0|MPRO_ECAM_CamMaster_RevLockMode|
| | |1321|0|MPRO_ECAM_CamMaster_Amplitude|
| | |1322|0|MPRO_ECAM_CamMaster_GearNum|
| | |1323|0|MPRO_ECAM_CamMaster_GearDen|
|Filter time|1327|0|ms|ECAM / EGEAR: Filter time constant of master|
|If P 1340[0] is used to enable a filter, P 1327[0] - MPRO_ECAM_CamMaster_SpeedTFil can be used to define the corresponding filter time.|1328|0|speed|ECAM / EGEAR: Speed factor of the internal master|
|Speed factor|1340|0| |MPRO_ECAM_CamMaster_SpeedFilTyp|
|The master encoder can be assigned an additional speed factor P 1328[0] - MPRO_ECAM_CamMaster_SpeedFactor.|1341|0|incr|ECAM / EGEAR: Master drive offset|

Table 8.37: “Synchronized motion - Master configuration” parameters (continue)

| | | |ID|Index Name|Unit|Description|
|---|---|---|---|---|---|---|
|247|0|MPRO_ECAM_ParaMaster_ActPos|incr|ECAM / EGEAR: Parameter interface master position| | |
|248|0|MPRO_ECAM_ParaMaster_ActSpeed|rpm|ECAM / EGEAR: Parameter interface master speed| | |
|249|0|MPRO_ECAM_ParaMaster_ActAcc|rpm|ECAM / EGEAR: Parameter interface master acceleration| | |
| |250|0|MPRO_ECAM_ParaMaster_Amplitude| |ECAM / EGEAR: Parameter interface master amplitude| |

Table 8.37: “Synchronized motion - Master configuration” parameters

# 8.11.5 Electronic gearing

# Gear ratio

The gear ratio is specified as a fraction. This ensures that the position references can be translated to the motor shaft with no rounding error.

- ""Slave"" (P 252[0] - MPRO_ECAM_Egear_GearNum) is the numerator
- ""Master"" (P 251[0] - MPRO_ECAM_Egear_GearDen) is the denominator

# Scaling of speed pre-control

Defined with P 265[0] - MPRO_ECAM_CamSlave_SpeedFactor definiert.

# Scaling of torque pre-control

Defined with P 266[0] - MPRO_ECAM_CamSlave_TorqueFactor.

# Engagement

See Section ""Engagement"" on page 284.

# Disengagement

See Section ""Disengagement"" on page 285.

|ID|Index Name|Unit|Description|
|---|---|---|---|
|251|0 MPRO_ECAM_Egear_GearDen| |EGEAR: Gear denominator|
|252|0 MPRO_ECAM_Egear_GearNum| |EGEAR: Numerator of gear ratio|
|1344|0 MPRO_ECAM_Egear_LimRefAcc|rpm/s|EGEAR: Acceleration limit for reference|
|1345|0 MPRO_ECAM_Egear_LimRefJerk|rpm/s²|EGEAR: Jerk limit for reference|

Table 8.38: “Synchronized motion - Electronic gearing” parameters

Image 8.73: ""Electronic gearing"" screen

MOOG ID No.:CB40859-001 Date:11/2020 MSD ServoDrive - DeviceHelp 283

# 8 Motion profile

# 8 Motion profile

MOOG ID No.:CB40859-001 Date:11/2020

MSD ServoDrive - DeviceHelp 284

# 8.11.6 Engagement

used to define the engagement distance (between the dashed lines).

P 253[0] - MPRO_ECAM_Egear_GearInMode is used to define the mode for engagement.

- DIRECT (0) = Direct
- Direct engagement: Angular synchronous; with jerking (no ramps).
- CROSSFADE (3) = Crossfading
- Engagement with crossfading function (5th degree polynomial): Angular synchronous; jerk-limited; speed will overshoot during engagement.
- RAMP (1) = Linear speed ramp
- Engagement with linear acceleration: Not angular synchronous; with jerking.
- FADE (2) = Engagement fade-out
- Engagement with fade-in function (5th degree polynomial): Not angular synchronous; jerk-limited. The position is ignored. ",How is the maximum table index for auto modes defined in the 'MSD ServoDrive - DeviceHelp' document?,A1,P 206[0] - MPRO_Tab_MaxIdx defines the maximum table index for auto modes.,2.203125,2.21875,3.578125,1.53125,0.37890625
6,msd_servo_drive.txt,76,b87ca5e232c2bdbb6fa16a8a401c6b5d285dc0183e73cc9d134de13dd2fc71d2,"MOOG ID No.:CB40859-001 Date:11/2020

MSD ServoDrive - DeviceHelp 267

# 8 Motion profile

MOOG ID No.:CB40859-001 Date:11/2020 MSD ServoDrive - DeviceHelp 268

# Deceleration

With ...

- P 194 - MPRO_TAB_TDec (for torque control) or
- P 197 - MPRO_TAB_SDec (for speed control) or
- P 200 - MPRO_TAB_PDec (for position control)

and indexes 0–15, the deceleration for each individual motion task can be defined. The input must not be zero.

# Wait time in Auto mode

P 204 - MPRO_TAB_WaitTime is used to define the wait time before the next motion task is carried out.

# Maximum table index in Auto mode

P 206[0] - MPRO_Tab_MaxIdx is used to define the table index up to which driving jobs will be carried out in one of the auto modes.

# Current table index

P 207[0] - MPRO_Tab_ActIdx will show the index for the motion task that is currently active. If parameter P 205 MPRO_TAB_Mode is set to “Para(0)”, a driving set can be entered and approached directly.

# Activation of reference table

The following procedures can be used in order to activate the setpoint table for operation.

|ID|Index Name|Unit|Description|
|---|---|---|---|
|193|MPRO_TAB_TAcc|TAB: Torque mode acceleration|Nm/ms|
|193|0|MPRO_TAB_TAcc|Nm/ms|
|193|1 - 15|MPRO_TAB_TAcc|Nm/ms|
|194|MPRO_TAB_TDec|TAB: Torque mode deceleration| |
|194|0|MPRO_TAB_TDec|Nm/ms|
|194|1 - 15|MPRO_TAB_TDec|Nm/ms|

# Table 8.23: Activation of table references

# Table 8.24: “Setpoint table settings” parameters

# Table 8.24: “Setpoint table settings” parameters (continue)

|ID|Index Name|Unit|Description|ID|Index Name|Unit|Description|
|---|---|---|---|---|---|---|---|
|195|MPRO_TAB_TRef|Nm|TAB: Torque mode reference value|208|MPRO_TAB_OutputNo| |OSD TAB: actual table index and target|
|195|MPRO_TAB_TRef|Nm| |208|MPRO_TAB_OutputNo| | |
|196|MPRO_TAB_SAcc|rev/min/s|TAB: Speed mode acceleration|269|MPRO_TAB_Ctrl| |TAB: control word|
|196|MPRO_TAB_SAcc|rev/min/s| | | | | |
|197|MPRO_TAB_SDec|rev/min/s|TAB: Speed mode deceleration| | | | |
|197|MPRO_TAB_SDec|rev/min/s| | | | | |
|198|MPRO_TAB_SRef|rev/min|TAB: Speed mode reference value| | | | |
|198|MPRO_TAB_SRef|rev/min| | | | | |
|199|MPRO_TAB_PAcc|rev/min/s|TAB: Position control mode acceleration| | | | |
|199|MPRO_TAB_PAcc|rev/min/s| | | | | |
|200|MPRO_TAB_PDec|rev/min/s|TAB: Position control mode Acceleration| | | | |
|200|MPRO_TAB_PDec|rev/min/s| | | | | |
|201|MPRO_TAB_PSpd|rev/min|TAB: Position control mode speed| | | | |
|201|MPRO_TAB_PSpd|rev/min| | | | | |
|202|MPRO_TAB_PPos|mDegree|TAB: Position control mode reference value| | | | |
|202|MPRO_TAB_PPos|mDegree| | | | | |
|203|MPRO_TAB_PMode| |Position control table:Mode| | | | |
|203|MPRO_TAB_PMode| | | | | | |
|204|MPRO_TAB_WaitTime|ms|TAB: Wait time| | | | |
|204|MPRO_TAB_WaitTime|ms| | | | | |
|205|MPRO_TAB_Mode| |TAB mode| | | | |
|206|MPRO_Tab_MaxIdx| |TAB: Max index in AUTO mode| | | | |
|207|MPRO_TAB_ActIdx| |TAB: Actual index| | | | |

MOOG ID No.:CB40859-001 Date:11/2020

MSD ServoDrive - DeviceHelp

# 8 Motion profile

MOOG ID No.:CB40859-001 Date:11/2020

MSD ServoDrive - DeviceHelp 270

# 8.8 Analog channel (ISA00 und ISA01)

# Offset (O)

This parameter (P 174 - MPRO_ANA0_SOffset for ISA00, P 184 - MPRO_ANA1_SOffset for ISA01) compensates for component variations and is used for offset compensation purposes. Depending on the control mode being used (see Section ""Basic settings"" on page 110), the value will be stored in parameter index [0] (torque control), [1] (speed control) or [2] (position control).

# Backlash (B)

This parameter (P 175 - MPRO_ANA0_SThreshold for ISA00, P 185 - MPRO_ANA1_SThreshold for ISA01) can suppress axis motion close to the standstill (stop) position. Depending on the control mode being used (see Section ""Basic settings"" on page 110), the value will be stored in parameter index [0] (torque control), [1] (speed control) or [2] (position control).

Image 8.68: “Analog channel” screen

# Acceleration ramp

Two standard analog inputs (ISA00, ISA01) are available. These inputs can be configured...

- with negative values for analog setpoint settings
- with positive values for digital setpoint processing

(P 109[0] - MPRO_INPUT_FS_ISA00 and P 110[0] - MPRO_INPUT_FS_ISA01).

see also section ""Analog Inputs"" on page 303. By using the ""REV(-2) = Analog setpoint"" setting, an analog input voltage of ±10 V can be processed as a setpoint.

# Deceleration ramp

This parameter serves as a deceleration ramp for torque control (P 176[1] - MPRO_ANA0_TRamp for ISA00, P 186[1] - MPRO_ANA1_TRamp for ISA01) or speed control (P 177[1] - MPRO_ANA0_SRamp for ISA00, P 187[1] - MPRO_ANA1_SRamp for ISA01). Depending on the control mode being used (see Section ""Basic settings"" on page 110), the value will be stored in parameter index [0] (torque control), [1] (speed control) or [2] (position control).

This parameter (P 173 - MPRO_ANA0_Scale for ISA00, P 183 - MPRO_ANA1_Scale for ISA01) is used to define which speed / which torque / which position corresponds to the maximum analog value. Depending on the control mode being used (see Section ""Basic settings"" on page 110), the value will be stored in parameter index [0] (torque control), [1] (speed control) or [2] (position control).

# 8.8.1 Special characteristics of position control mode

A threshold value can also be specified which generates a run-on range around the last reference value. A ramp function calculates a motion profile for the position reference from pre-defined acceleration and speed limits.

The position references on the analog channel are not applied immediately, but dependent on a digital input. Accordingly, one of the ISD00 to ISD06 digital inputs must be set to a value of ""REFANAEN(28) = Enable analog reference value"" (see Section ""Digital inputs"" on page 290). The position setpoint being received will only be applied if the corresponding digital input is active. The acceleration is entered using P 173[0] - MPRO_ANA0_TScale or P 183[0] - MPRO_ANA1_TScale.

# 8.8.2 Wire Break Monitoring

P 399 - CON_ANAWireBrk_Th can be used to configure wire break monitoring for the analog inputs. For details see Section ""Wire Break Monitoring"" on page 306.

|Function|TLIM (-4)|OVR (-3)|REFV (-2)|leer (-1)|OFF (0)|
|---|---|---|---|---|---|
|Digital|(1)-(28)|(1)-(28)|(1)-(28)|(1)-(28)|(1)-(28)|
|Analog channel|Filter|Scale|Offset|Profile|generator|

Control

Image 8.69: Reference processing structure

MOOG ID No.:CB40859-001 Date:11/2020

MSD ServoDrive - DeviceHelp 271

# 8 Motion profile

# 8 Motion profile

MOOG ID No.:CB40859-001 Date:11/2020

|ID|Index Name|Unit|Description|ID|
|---|---|---|---|---|
|395|CON_ANA_Isaf_Scaled| |Analog inputs: Values (filt, norm, comp, scaled)|174|
|395|0 ISA00| |Scaled, compensated, filtered, normalized value|175|
|395|1 ISA01| |Scaled, compensated, filtered, normalized value| |
|396|CON_ANA_Scale_ThUpper| |Analog inputs: Upper scaling limits|175|
|396|0 ISA00|%|Upper scaling (@ 10 V) threshold|175|
|396|1 ISA01|%|Upper scaling (@ 10 V) threshold| |
|397|CON_ANA_Scale_ThZero| |Analog inputs: Zero scaling thresholds|176|
|397|0 ISA00|V|Zero scaling threshold (+/-)|176|
|397|1 ISA01|V|Zero scaling threshold (+/-)| |
|398|CON_ANA_Scale_ThLower| |Analog inputs: Lower scaling limits|177|
|398|0 ISA00|%|Lower scaling (@ zero threshold) threshold|177|
|398|1 ISA01|%|Lower scaling (@ zero threshold) threshold| |
|399|CON_ANA_WireBrk_Th| |Analog inputs: Wire break thresholds|Table 8.26:|
|399|0 ISA00|V|Wire break detection threshold| |
|399|1 ISA01|V|Wire break detection threshold| |
|405|0 CON_ANA_Filt0|ms|Analog input ISA00: Filter time constant (PT 1)|ID|
|408|CON_ANA_Isaf_Norm| |Analog inputs: Values (filt, norm)|183|
|408|0 ISA00| |Filtered, normalized value|183|
|408|1 ISA01| |Filtered, normalized value|183|

Table 8.25: “Analog channel” parameters

|ID|Index Name|Unit|Description|ID|
|---|---|---|---|---|
|173|MPRO_ANA0_Scale| |ANA0: scale factors|184|
|173|0 MPRO_ANA0_TScale|Nm|ANA0: scale factor torque reference|185|
|173|1 MPRO_ANA0_SScale|rev/min|ANA0: scale factor speed reference|185|
|173|2 MPRO_ANA0_PScale|mDegree|ANA0: scale factor position reference| |
|174|MPRO_ANA0_Offset| |ANA0: offsets|185|
|174|0 MPRO_ANA0_TOffset|Nm|ANA0: offsets for torque reference|185|

Table 8.26: “Analog channel ISA00” parameters

|Index Name|Unit|Description|
|---|---|---|
|1 MPRO_ANA0_SOffset|rev/min|ANA0: offsets for speed reference|
|2 MPRO_ANA0_POffset|mDegree|ANA0: offsets for position reference|
|MPRO_ANA0_Threshold| |ANA0: thresholds|
|0 MPRO_ANA0_TThreshold|Nm|ANA0: threshold for torque reference|
|1 MPRO_ANA0_SThreshold|rev/min|ANA0: threshold for speed reference|
|2 MPRO_ANA0_PThreshold|mDegree|ANA0: threshold for position reference|
|MPRO_ANA0_TRamp| |ANA0: Torque mode acceleration [0] and deceleration [1]|
|0 MPRO_ANA0_TRamp|Nm/s| |
|1 MPRO_ANA0_TRamp|Nm/s| |
|MPRO_ANA0_SRamp| |ANA0: Speed mode acceleration [0] and deceleration [1]|
|0 MPRO_ANA0_SRamp|SPEED/s| |
|1 MPRO_ANA0_SRamp|SPEED/s| |

“Analog channel ISA00” parameters (continue)

|Index Name|Unit|Description|
|---|---|---|
|MPRO_ANA1_Scale| |ANA1: scale factors|
|0 MPRO_ANA1_TScale|Nm|ANA0: scale factor torque reference|
|1 MPRO_ANA1_SScale|rev/min|ANA0: scale factor speed reference|
|2 MPRO_ANA1_PScale|mDegree|ANA0: scale factor position reference|
|MPRO_ANA1_Offset| |ANA1: offsets|
|0 MPRO_ANA1_TOffset|Nm|ANA1: offsets for torque reference|
|1 MPRO_ANA1_SOffset|rev/min|ANA1: offsets for speed reference|
|2 MPRO_ANA1_POffset|mDegree|ANA1: offsets for position reference|
|MPRO_ANA1_Threshold| |ANA1: thresholds|
|0 MPRO_ANA1_TThreshold|Nm|ANA1: threshold for torque reference|
|1 MPRO_ANA1_SThreshold|rev/min|ANA1: threshold for speed reference|
|2 MPRO_ANA1_PThreshold|mDegree|ANA1: threshold for position reference|

“Analog channel ISA01” parameters

# 8 Motion profile

|ID|Index Name|Unit|Description|
|---|---|---|---|
|186|MPRO_ANA1_TRamp|Nm/s|ANA1: Torque mode acceleration [0] and deceleration[1]|
|186|MPRO_ANA1_TRamp|Nm/s| |
|187|MPRO_ANA1_SRamp|SPEED/s|ANA1: Speed mode acceleration [0] and deceleration [1]|
|187|MPRO_ANA1_SRamp|SPEED/s| |

# Table 8.27: “Analog channel ISA01” parameters (continue)

Display

- System state
- Initialization on device startup
- Not ready (DC link voltage possibly too low)
- Start inhibit (DC link voltage present, power stage off)
- Starting lockout
- Ready for start
- Control initialization: Auto commutation, flux build-up etc.

# Table 8.28: Central state machine according to CiA 402 device display

MOOG ID No.:CB40859-001 Date:11/2020

MSD ServoDrive - DeviceHelp 273

# 8 Motion profile

MOOG ID No.:CB40859-001 Date:11/2020

MSD ServoDrive - DeviceHelp 274

|Display|System state|power disabled|fault|
|---|---|---|---|
|Control enabled|0|Start|7|
| |fault reaction active|0|14|
|Quick stop active|1|not ready|8|
| |to switch on|1|17|
|Error reaction active|2|switch on|disabled|
| |2|7| |
|Error state (in this state the error is indicated directly on the display.)|3|ready to|switch on|
|Device is reset (display flashes)|power enabled|3|6|
| |10|12| |
|• Number [5.] flashes when “STO” (Safe Torque Off) input is active. Display goes out when STO inactive.| | | |
|• The dot on the display flashes when the power stage is active.| | | |

Table 8.28: Central state machine according to CiA 402 device display (continue)

NOTE

l The system states indicated on the display may differ from the states in the table depending on the drive profile setting.

Image 8.70: State machine diagram based on CANopen communications

⓪ to ① State number

1 to 17 State transition (No. 17: DC link voltage cut off)

Legend for “State machine diagram based on CANopen communications” figure

# 8.10 Touch probe

|ID|Index Name / Setting|
|---|---|
|241|0 MPRO_TP_Position|
|241|1 MPRO_TP_Position|
|241|2 MPRO_TP_Position|
|241|3 MPRO_TP_Position|
|241|4 MPRO_TP_Position|
|1400|0 MPRO_TP_Config|
| |TP_TP (0)|
| |AB (1)|
| |PD_UP (2)|
| |PD_DOWN (3)|
| |PC_PC (4)|
| |PC_TP (5)|
| |TP_PC (6)|
| |ENC_ENC (7)|
| |ENC_TP (8)|
| |TP_ENC (9)|

Using the touch probe inputs, touch probe functions can be performed. In order to be able to do this, P 106[0] - MPRO_INPUT_FS_ISD05 and P 107[0] - MPRO_INPUT_FS_ISD06 must be used to set digital inputs ISD05 and ISD06 to ""PROBE(15) = Touch probe (only ISD05/06)"" (see Section ""Digital inputs"" on page 290). HTL encoders can be evaluated or pulse counters implemented using the MSD PLC.

The touch probe can be triggered with P 240 - MPRO_TP_Ctrl. This enables triggering on a positive or negative edge, or on both edges, of the signal detected on the touch probe inputs. After the measurement, the parameter jumps back to the value ""NONE (0)"" and the latch position is mapped in the corresponding subindex of parameter P 241 - MPRO_TP_Position. A continuous touch probe mode is not possible at present, so the touch probe has to be reactivated after the measurement.

P 1402 - MPRO_TP_Channel can be used to select various positions as actual value sources of the latch position for the touch probe functionality. The following table provides an overview of the available settings. The counters are accessed via the MSD PLC or a bus system.

|ID|Index Name / Setting|Unit|Description|
|---|---|---|---|
|240|MPRO_TP_Ctrl|Touch probe: Control| |
| |0| |NONE (0) = No function|
| |1| |POS (1) = Positive edge|
| |2| |NEG (2) = Negative edge|
| |3| |BOTH (3) = Both edges|
|240|0 MPRO_TP_Ctrl| | |
|240|1 MPRO_TP_Ctrl| | |
|240|2 MPRO_TP_Ctrl| | |
|241|MPRO_TP_Position|Probe: Pos. high/low edge of TP0/1, encoder zero pulse| |

Table 8.29: “Touch probe” parameters

MOOG ID No.:CB40859-001 Date:11/2020

# 8 Motion profile

|Unit|Description|
|---|---|
|mDegree|Touch probe: Configuration|
|mDegree|TP0, TP1 touch probe|
|mDegree|TP0, TP1 as encoder, A/B as quadrature counting|
|mDegree|TP0, TP1 as encoder, pulse (TP0) / direction (TP1), count up on direction high|
|mDegree|TP0, TP1 as encoder, pulse (TP0) / direction (TP1), count down on direction high|
|mDegree|TP0 pulse counter, TP1 pulse counter|
|mDegree|TP0 pulse counter, TP1 touch probe|
|mDegree|TP1 touch probe, TP0 pulse counter|
|mDegree|TP0 encoder counter, TP1 encoder counter|
|mDegree|TP0 encoder counter, TP1 touch probe|
|mDegree|TP0 touch probe, TP1 encoder counter|

Touch probe: Channel

|Unit|Description|
|---|---|
|ACTPOS (0)|Actual position in user units|
|ACTPOSINC (1)|Actual position in increments|
|MASTERPOS (2)|Master position in increments|
|ENCPOS_CH1 (3)|Encoder position Channel 1|
|ENCPOS_CH1_INC (4)|Encoder position Channel 1 in increments|
|ENCPOS_CH2 (5)|Encoder position Channel 2|
|ENCPOS_CH2_INC (6)|Encoder position Channel 2 in increments|

# 8 Motion profile

MOOG ID No.:CB40859-001 Date:11/2020 MSD ServoDrive - DeviceHelp 276

|ID|Index Name / Setting|Unit|Description|
|---|---|---|---|
|7|ENCPOS_CH3 (7)| |Encoder position Channel 3|
|8|ENCPOS_CH3_INC (8)| |Encoder position Channel 3 in increments|
|9|ENCPOS_CH4 (9)| |Encoder position Channel 4|
|10|ENCPOS_CH4_INC (10)| |Encoder position Channel 4 in increments|
|11|ACTPOS2 (11)| |Actual position of redundant encoder in user units|
|12|Sercos (12)| |Referred to Sercos profile parameters S-x-0426, S-x-0427|
|13|UserRefPos(13)| |Reference position in user units|
|14|MasterPosST(14)| |Master position (ECAM, EGEAR) singleturn, always steps|
|15|CommonMasterPos(15)| |Master position (ECAM, EGEAR) singleturn, always steps|
|16|CommonMasterPosST(15)| |Master position (ECAM, EGEAR) singleturn, always steps|
|1402|MPRO_TP_Channel| | |
|1402|MPRO_TP_Channel| | |
|1402|MPRO_TP_Channel| | |
|1404|MPRO_TP_Lines| |Touch probe: Lines @ pulse counter on channel x|
|1404|MPRO_TP_Lines| | |
|1404|MPRO_TP_Lines| | |

Image 8.71: “Synchronized motion” screen

There are various modes available in the “synchronization mode” drop-down menu (P 242[0] - MPRO_ECAM_SyncModMode):

- Off(0) = Synchronized motion off
- ECAM_iPlc(1) = Electronic cam plate via MSD PLC
- EGEAR_iPlc(2) = Electr. gear unit via MSD PLC
- ECAM_PARA(3) = Electronic camming via parameters
- EGEAR_PARA(4) = Electronic gearing via parameters

NOTE: For more information refer to the bus system User Manuals or the description of the MSD PLC.

# 8.11.1 Electronic cam plate

The other parameters are configured in separate screens that can be accessed with the corresponding buttons.

- Master configuration (see Section ""Master configuration"" on page 280)
- Electronic gearing (see Section ""Electronic gearing"" on page 283)
- Electronic camming (see Section ""Electronic cam plate"" on page 277)

P 1318[0] - MPRO_ECAM_ControlWord is the control word for “synchronized motion” (see Section ""Control word for synchronized motion"" on page 279).

P 1326[0] - MPRO_ECAM_StatusWord is the status word for “synchronized motion” (see Section ""Status word for synchronized motion"" on page 279).

# 8.11.1.1 Table selection

|ID|Index Name|Unit|Description|
|---|---|---|---|
|1300|MPRO_ECAM_CTS_| |ECAM: CamTableSelect - Master reference|
|1301|MasterRef| | |
|1305|MPRO_ECAM_CTS_| |ECAM: CamTableSelect - Method for changing the camtable|
|1306|MPRO_ECAM_CTS_| |ECAM: CamTableSelect - Mode for changing the camtable|
|1307|MPRO_ECAM_CTS_|incr|ECAM: CamTableSelect - Distance for changing the camtable|
|242|MPRO_ECAM_| |ECAM / EGEAR: Mode of synchronized motion SyncModMode|
|265|MPRO_ECAM_| |ECAM / EGEAR: Slave speed factor (1 = 100%).|
|266|CamSlave_SpeedFactor| | |
|268|MPRO_ECAM_| |ECAM / EGEAR: Mode of switching off sync. motion|

# 8.11.1.2 Synchronization

|ID|Index Name|Unit|Description|
|---|---|---|---|
|1342|MPRO_ECAM_CI_|incr|ECAM: CamIn - Synchronization position (multiturn part)|
|1343|MPRO_ECAM_CO_|incr|ECAM: CamOut - Decoupling pos. (multiturn part)|
|1303|MPRO_ECAM_CI_|incr|ECAM: CamIn - Master offset|
|1308|MPRO_ECAM_CI_| |ECAM: CamIn - Master reference|
|1309|MPRO_ECAM_CI_| |ECAM: CamIn - Slave reference|
|1310|MPRO_ECAM_CI_| |ECAM: CamIn - Coupling mode|
|1311|MPRO_ECAM_CI_|incr|ECAM: CamIn - Coupling distance|
|1312|MPRO_ECAM_CI_|incr|ECAM: CamIn - Synchronization position|

Table 8.31: “Electronic camming - Table selection” parameters

Table 8.30: “Synchronized motion” parameters

Table 8.32: “Electronic camming - Synchronization” parameters

MOOG ID No.:CB40859-001 Date:11/2020

MSD ServoDrive - DeviceHelp 277

# 8 Motion profile

MOOG ID No.:CB40859-001 Date:11/2020 MSD ServoDrive - DeviceHelp 278

|ID|Index|Name|Unit|Description|
|---|---|---|---|---|
|1313|0|MPRO_ECAM_CO_SyncPosST|(singleturn part)|ECAM: CamOut - Slave reference|
|1314|0|MPRO_ECAM_CO_DecouplingMode|63|ECAM: CamOut - Decoupling mode|
|1315|0|MPRO_ECAM_CO_BreakingPosST|incr|ECAM: CamOut - Decoupling position|
|1316|0|MPRO_ECAM_CO_DecouplingDist|incr|ECAM: CamOut - Decoupling distance|
|1317|0|MPRO_ECAM_CO_StandstillPos|mDegree|ECAM: CamOut - Slave standstill position|

# Table 8.32: “Electronic camming - Synchronization” parameters (continue)

|ID|Index|Name|Unit|Description|
|---|---|---|---|---|
|1346| |MPRO_ECAM_SP_Table| |ECAM: Setpoint table interface|
|1346|0|Index| |Index of setpoint table|
|1346|1|Value| |Value at index of setpoint table|
|1347|0 to 31|MPRO_ECAM_SP_Index| |ECAM: Setpoint segments start index|
|1348|0 to 31|MPRO_ECAM_SP_Length| |ECAM: Setpoint segments length|
|1349|0 to 31|Length| | |
|1350|0|MPRO_ECAM_SP_MaDist| |ECAM: Setpoint segments master distance|
|1351|0|MPRO_ECAM_SP_IpoType| |ECAM: Setpoint segments interpolation type|
|1352|0 to 31|Checksum| |ECAM: Setpoint table checksum|
|1353|0 to 31|GainNum| |ECAM: Setpoint segments gain numerator|
| | |GainDen| |ECAM: Setpoint segments gain denominator|

# Table 8.33: “Electronic camming - Table segments” parameters

|ID|Index|Name|Unit|Description|
|---|---|---|---|---|
|1329|0 to 63|MPRO_ECAM_SegData_IndexNext| |ECAM: Index of the following segment|
|1330|0 to 63|MPRO_ECAM_SegData_IndexPrev| |ECAM: Index of the previous segment|
|1331|0 to 63|MPRO_ECAM_SegData_ProfileMode| |ECAM: Profile mode of the current segment|
|1332|0 to 63|MPRO_ECAM_SegData_DistMaster| |ECAM: Length of the master section of the current segment|
|1333|0 to 63|MPRO_ECAM_SegData_DistSlave| |ECAM: Length of the slave section of the current segment|
|1334|0 to 63|MPRO_ECAM_SegData_Lambda| |ECAM: Lambda value of the current segment|
|1335|0 to 63|MPRO_ECAM_SegData_StatusWord| |ECAM: Status word of the current segment|
|1336|0 to 63|MPRO_ECAM_SegData_ControlWord| |ECAM: Control word of the current segment|

# 8.11.2 Control word for synchronized motion

|Bit|Function|PLC function|Bit number|Description|
|---|---|---|---|---|
|0-7|Start segment (8-bit value)|-|0-7|Actual segment (8-bit value)|
|8-15|Reserved|-| |Actual ECAM / EGEAR state machine state (4 Bit value)|
|16|Absolute (true) / relative (false) master relationship|-| |- 0: ECAM / EGEAR asynchronous
- 1: ECAM / EGEAR synchronous
|
|17|Absolute (true) / relative (false) master (CAM) relationship at cam in|-| |- 2: ECAM / EGEAR synchronizing
- 3: ECAM / EGEAR desynchronizing
|
|18|Absolute (true) / relative (false) slave (CAM) relationship at cam in|-| |- 4: ECAM / EGEAR active and waiting for going asynchronous
|
|19-23|Reserved|-| |- 5: ECAM / EGEAR inactive and waiting for going synchronous
|
|24|Change gear ratio of the electronic gear online|MCB_GearRatioChange| | |
|25|Disable master calculation|MCB_Cam_MasterEnable| | |
|26|Enable master calculation|MCB_Cam_MasterEnable| | |
|27|Select CAM table|MCB_CamTableSelect| | |
|28|Start Ecam|MCB_CamIn| | |
|29|Stop Ecam|MCB_CamOut| | |
|30|Start Egear|MCB_GearIn| | |
|31|Stop Egear|MCB_GearOut| | |

# 8.11.3 Status word for synchronized motion

|Bit|Function|PLC function|Bit number|Description|
|---|---|---|---|---|
|12-26|Reserved|-| | |
|27|ECAM / EGEAR is active|-| | |
|28|Valid segments chosen|-| | |
|29|Master data are valid|-| | |
|30|Master is initialized|-| | |
|31|Master calculation is active|-| | |

Table 8.35: Control word ECAM (P 1318[0] - MPRO_ECAM_ControlWord)

Table 8.36: ECAM status word (P 1326[0] - MPRO_ECAM_StatusWord)

MOOG ID No.:CB40859-001 Date:11/2020 MSD ServoDrive - DeviceHelp 279

# 8 Motion profile

# 8 Motion profile

MOOG ID No.:CB40859-001 Date:11/2020

MSD ServoDrive - DeviceHelp 280

# 8.11.4 Master configuration

the master encoder, you will need to set the resolution relative to a single motor revolution in P 250 - MPRO_ECAM_PARAMaster_Amplitude (see below).

- ENC CH1 (3) = Encoder channel 1 X7 (Sin/Cos)
- ENC CH2 (4) = Encoder channel 2 X6 (Resolver)
- ENC CH3 (5) = Encoder channel 3 X8 (optional)

This function is only available if an external interface X8 (option module) is present.

- TP0 (6) = Pulse counter on probe channel 0 (TP0)
- TP1 (7) = Pulse counter on probe channel 1 (TP1)
- ENC_CH4 (8) = Encoder channel 4 (p. e. fieldbus)
- TWIN_POS (9) = TWIN remote reference position (P-2607)

Image 8.72: “Master configuration” screen

# Channel selection (master encoder)

P 1319[0] - MPRO_ECAM_CamMaster_AxisType is used to define the master encoder.

- NO AXIS (0) = No axis
- VIRTUAL MASTER (1) = Virtual master

If you select this function, you will be able to configure additional settings by clicking on the enabled “Options...” button (see Section ""Virtual Master"" on page 286).

- PARA (2) = Master parameter interface

If you select this function because a higher-level controller is being used as

# Anti-reverse mode

Slave only starts moving along with it again as soon as the master reaches the zero position.

P 1320[0] - MPRO_ECAM_CamMaster_RevLockMode is used to define the reverse lock mode, which can be used either with or without path compensation. The dashed lines in the following diagrams indicate what the engagement distance is:

# Example:

If the master, which has moved two motor revolutions in the direction blocked for the slave, then moves in the unblocked direction again, the slave only moves off when the master has traversed the zero point.

- INACTIVE (0) = Reverse lock inactive
- ACTIVE (2) = Reverse lock enabled - without path optimization
- ACTIVE WAY COMP (1) = Reverse lock active - with way compensation

While the slave accelerates to the speed of the master during engagement, the master and slave do not move synchronously. This function needs to be selected in order to quickly catch up to the master that is running ahead.

# Example:

- Master (black line) rotates in the blocked direction
- The slave (blue line) remains stopped
- Master rotates in the unblocked direction again
- The slave follows the master directly in the unblocked direction

Assume the master has moved two motor revolutions in the direction for which the slave lock is enabled. If the master now moves in the direction for which there is no lock, the slave will immediately start running in that direction.

MOOG ID No.:CB40859-001 Date:11/2020

MSD ServoDrive - DeviceHelp 281

# 8 Motion profile

MOOG ID No.:CB40859-001 Date:11/2020 MSD ServoDrive - DeviceHelp 282

|Filter type|ID|Index Name|Unit|Description|
|---|---|---|---|---|
|When using a real master encoder, encoder signals may be subject to noise.|P 1340|1319|0|MPRO_ECAM_CamMaster_AxisType|
| | |MPRO_ECAM_CamMaster_SpeedFilTyp| |ECAM / EGEAR: Channel selection of internal master input|
| | |1320|0|MPRO_ECAM_CamMaster_RevLockMode|
| | |1321|0|MPRO_ECAM_CamMaster_Amplitude|
| | |1322|0|MPRO_ECAM_CamMaster_GearNum|
| | |1323|0|MPRO_ECAM_CamMaster_GearDen|
|Filter time|1327|0|ms|ECAM / EGEAR: Filter time constant of master|
|If P 1340[0] is used to enable a filter, P 1327[0] - MPRO_ECAM_CamMaster_SpeedTFil can be used to define the corresponding filter time.|1328|0|speed|ECAM / EGEAR: Speed factor of the internal master|
|Speed factor|1340|0| |MPRO_ECAM_CamMaster_SpeedFilTyp|
|The master encoder can be assigned an additional speed factor P 1328[0] - MPRO_ECAM_CamMaster_SpeedFactor.|1341|0|incr|ECAM / EGEAR: Master drive offset|

Table 8.37: “Synchronized motion - Master configuration” parameters (continue)

| | | |ID|Index Name|Unit|Description|
|---|---|---|---|---|---|---|
|247|0|MPRO_ECAM_ParaMaster_ActPos|incr|ECAM / EGEAR: Parameter interface master position| | |
|248|0|MPRO_ECAM_ParaMaster_ActSpeed|rpm|ECAM / EGEAR: Parameter interface master speed| | |
|249|0|MPRO_ECAM_ParaMaster_ActAcc|rpm|ECAM / EGEAR: Parameter interface master acceleration| | |
| |250|0|MPRO_ECAM_ParaMaster_Amplitude| |ECAM / EGEAR: Parameter interface master amplitude| |

Table 8.37: “Synchronized motion - Master configuration” parameters

# 8.11.5 Electronic gearing

# Gear ratio

The gear ratio is specified as a fraction. This ensures that the position references can be translated to the motor shaft with no rounding error.

- ""Slave"" (P 252[0] - MPRO_ECAM_Egear_GearNum) is the numerator
- ""Master"" (P 251[0] - MPRO_ECAM_Egear_GearDen) is the denominator

# Scaling of speed pre-control

Defined with P 265[0] - MPRO_ECAM_CamSlave_SpeedFactor definiert.

# Scaling of torque pre-control

Defined with P 266[0] - MPRO_ECAM_CamSlave_TorqueFactor.

# Engagement

See Section ""Engagement"" on page 284.

# Disengagement

See Section ""Disengagement"" on page 285.

|ID|Index Name|Unit|Description|
|---|---|---|---|
|251|0 MPRO_ECAM_Egear_GearDen| |EGEAR: Gear denominator|
|252|0 MPRO_ECAM_Egear_GearNum| |EGEAR: Numerator of gear ratio|
|1344|0 MPRO_ECAM_Egear_LimRefAcc|rpm/s|EGEAR: Acceleration limit for reference|
|1345|0 MPRO_ECAM_Egear_LimRefJerk|rpm/s²|EGEAR: Jerk limit for reference|

Table 8.38: “Synchronized motion - Electronic gearing” parameters

Image 8.73: ""Electronic gearing"" screen

MOOG ID No.:CB40859-001 Date:11/2020 MSD ServoDrive - DeviceHelp 283

# 8 Motion profile

# 8 Motion profile

MOOG ID No.:CB40859-001 Date:11/2020

MSD ServoDrive - DeviceHelp 284

# 8.11.6 Engagement

used to define the engagement distance (between the dashed lines).

P 253[0] - MPRO_ECAM_Egear_GearInMode is used to define the mode for engagement.

- DIRECT (0) = Direct
- Direct engagement: Angular synchronous; with jerking (no ramps).
- CROSSFADE (3) = Crossfading
- Engagement with crossfading function (5th degree polynomial): Angular synchronous; jerk-limited; speed will overshoot during engagement.
- RAMP (1) = Linear speed ramp
- Engagement with linear acceleration: Not angular synchronous; with jerking.
- FADE (2) = Engagement fade-out
- Engagement with fade-in function (5th degree polynomial): Not angular synchronous; jerk-limited. The position is ignored. ",How is the maximum table index for auto modes defined in the 'MSD ServoDrive - DeviceHelp' document?,A2,The maximum index for auto modes is set by P 206[0].,1.4765625,1.5390625,3.515625,1.171875,0.306640625
7,msd_servo_drive.txt,76,b87ca5e232c2bdbb6fa16a8a401c6b5d285dc0183e73cc9d134de13dd2fc71d2,"MOOG ID No.:CB40859-001 Date:11/2020

MSD ServoDrive - DeviceHelp 267

# 8 Motion profile

MOOG ID No.:CB40859-001 Date:11/2020 MSD ServoDrive - DeviceHelp 268

# Deceleration

With ...

- P 194 - MPRO_TAB_TDec (for torque control) or
- P 197 - MPRO_TAB_SDec (for speed control) or
- P 200 - MPRO_TAB_PDec (for position control)

and indexes 0–15, the deceleration for each individual motion task can be defined. The input must not be zero.

# Wait time in Auto mode

P 204 - MPRO_TAB_WaitTime is used to define the wait time before the next motion task is carried out.

# Maximum table index in Auto mode

P 206[0] - MPRO_Tab_MaxIdx is used to define the table index up to which driving jobs will be carried out in one of the auto modes.

# Current table index

P 207[0] - MPRO_Tab_ActIdx will show the index for the motion task that is currently active. If parameter P 205 MPRO_TAB_Mode is set to “Para(0)”, a driving set can be entered and approached directly.

# Activation of reference table

The following procedures can be used in order to activate the setpoint table for operation.

|ID|Index Name|Unit|Description|
|---|---|---|---|
|193|MPRO_TAB_TAcc|TAB: Torque mode acceleration|Nm/ms|
|193|0|MPRO_TAB_TAcc|Nm/ms|
|193|1 - 15|MPRO_TAB_TAcc|Nm/ms|
|194|MPRO_TAB_TDec|TAB: Torque mode deceleration| |
|194|0|MPRO_TAB_TDec|Nm/ms|
|194|1 - 15|MPRO_TAB_TDec|Nm/ms|

# Table 8.23: Activation of table references

# Table 8.24: “Setpoint table settings” parameters

# Table 8.24: “Setpoint table settings” parameters (continue)

|ID|Index Name|Unit|Description|ID|Index Name|Unit|Description|
|---|---|---|---|---|---|---|---|
|195|MPRO_TAB_TRef|Nm|TAB: Torque mode reference value|208|MPRO_TAB_OutputNo| |OSD TAB: actual table index and target|
|195|MPRO_TAB_TRef|Nm| |208|MPRO_TAB_OutputNo| | |
|196|MPRO_TAB_SAcc|rev/min/s|TAB: Speed mode acceleration|269|MPRO_TAB_Ctrl| |TAB: control word|
|196|MPRO_TAB_SAcc|rev/min/s| | | | | |
|197|MPRO_TAB_SDec|rev/min/s|TAB: Speed mode deceleration| | | | |
|197|MPRO_TAB_SDec|rev/min/s| | | | | |
|198|MPRO_TAB_SRef|rev/min|TAB: Speed mode reference value| | | | |
|198|MPRO_TAB_SRef|rev/min| | | | | |
|199|MPRO_TAB_PAcc|rev/min/s|TAB: Position control mode acceleration| | | | |
|199|MPRO_TAB_PAcc|rev/min/s| | | | | |
|200|MPRO_TAB_PDec|rev/min/s|TAB: Position control mode Acceleration| | | | |
|200|MPRO_TAB_PDec|rev/min/s| | | | | |
|201|MPRO_TAB_PSpd|rev/min|TAB: Position control mode speed| | | | |
|201|MPRO_TAB_PSpd|rev/min| | | | | |
|202|MPRO_TAB_PPos|mDegree|TAB: Position control mode reference value| | | | |
|202|MPRO_TAB_PPos|mDegree| | | | | |
|203|MPRO_TAB_PMode| |Position control table:Mode| | | | |
|203|MPRO_TAB_PMode| | | | | | |
|204|MPRO_TAB_WaitTime|ms|TAB: Wait time| | | | |
|204|MPRO_TAB_WaitTime|ms| | | | | |
|205|MPRO_TAB_Mode| |TAB mode| | | | |
|206|MPRO_Tab_MaxIdx| |TAB: Max index in AUTO mode| | | | |
|207|MPRO_TAB_ActIdx| |TAB: Actual index| | | | |

MOOG ID No.:CB40859-001 Date:11/2020

MSD ServoDrive - DeviceHelp

# 8 Motion profile

MOOG ID No.:CB40859-001 Date:11/2020

MSD ServoDrive - DeviceHelp 270

# 8.8 Analog channel (ISA00 und ISA01)

# Offset (O)

This parameter (P 174 - MPRO_ANA0_SOffset for ISA00, P 184 - MPRO_ANA1_SOffset for ISA01) compensates for component variations and is used for offset compensation purposes. Depending on the control mode being used (see Section ""Basic settings"" on page 110), the value will be stored in parameter index [0] (torque control), [1] (speed control) or [2] (position control).

# Backlash (B)

This parameter (P 175 - MPRO_ANA0_SThreshold for ISA00, P 185 - MPRO_ANA1_SThreshold for ISA01) can suppress axis motion close to the standstill (stop) position. Depending on the control mode being used (see Section ""Basic settings"" on page 110), the value will be stored in parameter index [0] (torque control), [1] (speed control) or [2] (position control).

Image 8.68: “Analog channel” screen

# Acceleration ramp

Two standard analog inputs (ISA00, ISA01) are available. These inputs can be configured...

- with negative values for analog setpoint settings
- with positive values for digital setpoint processing

(P 109[0] - MPRO_INPUT_FS_ISA00 and P 110[0] - MPRO_INPUT_FS_ISA01).

see also section ""Analog Inputs"" on page 303. By using the ""REV(-2) = Analog setpoint"" setting, an analog input voltage of ±10 V can be processed as a setpoint.

# Deceleration ramp

This parameter serves as a deceleration ramp for torque control (P 176[1] - MPRO_ANA0_TRamp for ISA00, P 186[1] - MPRO_ANA1_TRamp for ISA01) or speed control (P 177[1] - MPRO_ANA0_SRamp for ISA00, P 187[1] - MPRO_ANA1_SRamp for ISA01). Depending on the control mode being used (see Section ""Basic settings"" on page 110), the value will be stored in parameter index [0] (torque control), [1] (speed control) or [2] (position control).

This parameter (P 173 - MPRO_ANA0_Scale for ISA00, P 183 - MPRO_ANA1_Scale for ISA01) is used to define which speed / which torque / which position corresponds to the maximum analog value. Depending on the control mode being used (see Section ""Basic settings"" on page 110), the value will be stored in parameter index [0] (torque control), [1] (speed control) or [2] (position control).

# 8.8.1 Special characteristics of position control mode

A threshold value can also be specified which generates a run-on range around the last reference value. A ramp function calculates a motion profile for the position reference from pre-defined acceleration and speed limits.

The position references on the analog channel are not applied immediately, but dependent on a digital input. Accordingly, one of the ISD00 to ISD06 digital inputs must be set to a value of ""REFANAEN(28) = Enable analog reference value"" (see Section ""Digital inputs"" on page 290). The position setpoint being received will only be applied if the corresponding digital input is active. The acceleration is entered using P 173[0] - MPRO_ANA0_TScale or P 183[0] - MPRO_ANA1_TScale.

# 8.8.2 Wire Break Monitoring

P 399 - CON_ANAWireBrk_Th can be used to configure wire break monitoring for the analog inputs. For details see Section ""Wire Break Monitoring"" on page 306.

|Function|TLIM (-4)|OVR (-3)|REFV (-2)|leer (-1)|OFF (0)|
|---|---|---|---|---|---|
|Digital|(1)-(28)|(1)-(28)|(1)-(28)|(1)-(28)|(1)-(28)|
|Analog channel|Filter|Scale|Offset|Profile|generator|

Control

Image 8.69: Reference processing structure

MOOG ID No.:CB40859-001 Date:11/2020

MSD ServoDrive - DeviceHelp 271

# 8 Motion profile

# 8 Motion profile

MOOG ID No.:CB40859-001 Date:11/2020

|ID|Index Name|Unit|Description|ID|
|---|---|---|---|---|
|395|CON_ANA_Isaf_Scaled| |Analog inputs: Values (filt, norm, comp, scaled)|174|
|395|0 ISA00| |Scaled, compensated, filtered, normalized value|175|
|395|1 ISA01| |Scaled, compensated, filtered, normalized value| |
|396|CON_ANA_Scale_ThUpper| |Analog inputs: Upper scaling limits|175|
|396|0 ISA00|%|Upper scaling (@ 10 V) threshold|175|
|396|1 ISA01|%|Upper scaling (@ 10 V) threshold| |
|397|CON_ANA_Scale_ThZero| |Analog inputs: Zero scaling thresholds|176|
|397|0 ISA00|V|Zero scaling threshold (+/-)|176|
|397|1 ISA01|V|Zero scaling threshold (+/-)| |
|398|CON_ANA_Scale_ThLower| |Analog inputs: Lower scaling limits|177|
|398|0 ISA00|%|Lower scaling (@ zero threshold) threshold|177|
|398|1 ISA01|%|Lower scaling (@ zero threshold) threshold| |
|399|CON_ANA_WireBrk_Th| |Analog inputs: Wire break thresholds|Table 8.26:|
|399|0 ISA00|V|Wire break detection threshold| |
|399|1 ISA01|V|Wire break detection threshold| |
|405|0 CON_ANA_Filt0|ms|Analog input ISA00: Filter time constant (PT 1)|ID|
|408|CON_ANA_Isaf_Norm| |Analog inputs: Values (filt, norm)|183|
|408|0 ISA00| |Filtered, normalized value|183|
|408|1 ISA01| |Filtered, normalized value|183|

Table 8.25: “Analog channel” parameters

|ID|Index Name|Unit|Description|ID|
|---|---|---|---|---|
|173|MPRO_ANA0_Scale| |ANA0: scale factors|184|
|173|0 MPRO_ANA0_TScale|Nm|ANA0: scale factor torque reference|185|
|173|1 MPRO_ANA0_SScale|rev/min|ANA0: scale factor speed reference|185|
|173|2 MPRO_ANA0_PScale|mDegree|ANA0: scale factor position reference| |
|174|MPRO_ANA0_Offset| |ANA0: offsets|185|
|174|0 MPRO_ANA0_TOffset|Nm|ANA0: offsets for torque reference|185|

Table 8.26: “Analog channel ISA00” parameters

|Index Name|Unit|Description|
|---|---|---|
|1 MPRO_ANA0_SOffset|rev/min|ANA0: offsets for speed reference|
|2 MPRO_ANA0_POffset|mDegree|ANA0: offsets for position reference|
|MPRO_ANA0_Threshold| |ANA0: thresholds|
|0 MPRO_ANA0_TThreshold|Nm|ANA0: threshold for torque reference|
|1 MPRO_ANA0_SThreshold|rev/min|ANA0: threshold for speed reference|
|2 MPRO_ANA0_PThreshold|mDegree|ANA0: threshold for position reference|
|MPRO_ANA0_TRamp| |ANA0: Torque mode acceleration [0] and deceleration [1]|
|0 MPRO_ANA0_TRamp|Nm/s| |
|1 MPRO_ANA0_TRamp|Nm/s| |
|MPRO_ANA0_SRamp| |ANA0: Speed mode acceleration [0] and deceleration [1]|
|0 MPRO_ANA0_SRamp|SPEED/s| |
|1 MPRO_ANA0_SRamp|SPEED/s| |

“Analog channel ISA00” parameters (continue)

|Index Name|Unit|Description|
|---|---|---|
|MPRO_ANA1_Scale| |ANA1: scale factors|
|0 MPRO_ANA1_TScale|Nm|ANA0: scale factor torque reference|
|1 MPRO_ANA1_SScale|rev/min|ANA0: scale factor speed reference|
|2 MPRO_ANA1_PScale|mDegree|ANA0: scale factor position reference|
|MPRO_ANA1_Offset| |ANA1: offsets|
|0 MPRO_ANA1_TOffset|Nm|ANA1: offsets for torque reference|
|1 MPRO_ANA1_SOffset|rev/min|ANA1: offsets for speed reference|
|2 MPRO_ANA1_POffset|mDegree|ANA1: offsets for position reference|
|MPRO_ANA1_Threshold| |ANA1: thresholds|
|0 MPRO_ANA1_TThreshold|Nm|ANA1: threshold for torque reference|
|1 MPRO_ANA1_SThreshold|rev/min|ANA1: threshold for speed reference|
|2 MPRO_ANA1_PThreshold|mDegree|ANA1: threshold for position reference|

“Analog channel ISA01” parameters

# 8 Motion profile

|ID|Index Name|Unit|Description|
|---|---|---|---|
|186|MPRO_ANA1_TRamp|Nm/s|ANA1: Torque mode acceleration [0] and deceleration[1]|
|186|MPRO_ANA1_TRamp|Nm/s| |
|187|MPRO_ANA1_SRamp|SPEED/s|ANA1: Speed mode acceleration [0] and deceleration [1]|
|187|MPRO_ANA1_SRamp|SPEED/s| |

# Table 8.27: “Analog channel ISA01” parameters (continue)

Display

- System state
- Initialization on device startup
- Not ready (DC link voltage possibly too low)
- Start inhibit (DC link voltage present, power stage off)
- Starting lockout
- Ready for start
- Control initialization: Auto commutation, flux build-up etc.

# Table 8.28: Central state machine according to CiA 402 device display

MOOG ID No.:CB40859-001 Date:11/2020

MSD ServoDrive - DeviceHelp 273

# 8 Motion profile

MOOG ID No.:CB40859-001 Date:11/2020

MSD ServoDrive - DeviceHelp 274

|Display|System state|power disabled|fault|
|---|---|---|---|
|Control enabled|0|Start|7|
| |fault reaction active|0|14|
|Quick stop active|1|not ready|8|
| |to switch on|1|17|
|Error reaction active|2|switch on|disabled|
| |2|7| |
|Error state (in this state the error is indicated directly on the display.)|3|ready to|switch on|
|Device is reset (display flashes)|power enabled|3|6|
| |10|12| |
|• Number [5.] flashes when “STO” (Safe Torque Off) input is active. Display goes out when STO inactive.| | | |
|• The dot on the display flashes when the power stage is active.| | | |

Table 8.28: Central state machine according to CiA 402 device display (continue)

NOTE

l The system states indicated on the display may differ from the states in the table depending on the drive profile setting.

Image 8.70: State machine diagram based on CANopen communications

⓪ to ① State number

1 to 17 State transition (No. 17: DC link voltage cut off)

Legend for “State machine diagram based on CANopen communications” figure

# 8.10 Touch probe

|ID|Index Name / Setting|
|---|---|
|241|0 MPRO_TP_Position|
|241|1 MPRO_TP_Position|
|241|2 MPRO_TP_Position|
|241|3 MPRO_TP_Position|
|241|4 MPRO_TP_Position|
|1400|0 MPRO_TP_Config|
| |TP_TP (0)|
| |AB (1)|
| |PD_UP (2)|
| |PD_DOWN (3)|
| |PC_PC (4)|
| |PC_TP (5)|
| |TP_PC (6)|
| |ENC_ENC (7)|
| |ENC_TP (8)|
| |TP_ENC (9)|

Using the touch probe inputs, touch probe functions can be performed. In order to be able to do this, P 106[0] - MPRO_INPUT_FS_ISD05 and P 107[0] - MPRO_INPUT_FS_ISD06 must be used to set digital inputs ISD05 and ISD06 to ""PROBE(15) = Touch probe (only ISD05/06)"" (see Section ""Digital inputs"" on page 290). HTL encoders can be evaluated or pulse counters implemented using the MSD PLC.

The touch probe can be triggered with P 240 - MPRO_TP_Ctrl. This enables triggering on a positive or negative edge, or on both edges, of the signal detected on the touch probe inputs. After the measurement, the parameter jumps back to the value ""NONE (0)"" and the latch position is mapped in the corresponding subindex of parameter P 241 - MPRO_TP_Position. A continuous touch probe mode is not possible at present, so the touch probe has to be reactivated after the measurement.

P 1402 - MPRO_TP_Channel can be used to select various positions as actual value sources of the latch position for the touch probe functionality. The following table provides an overview of the available settings. The counters are accessed via the MSD PLC or a bus system.

|ID|Index Name / Setting|Unit|Description|
|---|---|---|---|
|240|MPRO_TP_Ctrl|Touch probe: Control| |
| |0| |NONE (0) = No function|
| |1| |POS (1) = Positive edge|
| |2| |NEG (2) = Negative edge|
| |3| |BOTH (3) = Both edges|
|240|0 MPRO_TP_Ctrl| | |
|240|1 MPRO_TP_Ctrl| | |
|240|2 MPRO_TP_Ctrl| | |
|241|MPRO_TP_Position|Probe: Pos. high/low edge of TP0/1, encoder zero pulse| |

Table 8.29: “Touch probe” parameters

MOOG ID No.:CB40859-001 Date:11/2020

# 8 Motion profile

|Unit|Description|
|---|---|
|mDegree|Touch probe: Configuration|
|mDegree|TP0, TP1 touch probe|
|mDegree|TP0, TP1 as encoder, A/B as quadrature counting|
|mDegree|TP0, TP1 as encoder, pulse (TP0) / direction (TP1), count up on direction high|
|mDegree|TP0, TP1 as encoder, pulse (TP0) / direction (TP1), count down on direction high|
|mDegree|TP0 pulse counter, TP1 pulse counter|
|mDegree|TP0 pulse counter, TP1 touch probe|
|mDegree|TP1 touch probe, TP0 pulse counter|
|mDegree|TP0 encoder counter, TP1 encoder counter|
|mDegree|TP0 encoder counter, TP1 touch probe|
|mDegree|TP0 touch probe, TP1 encoder counter|

Touch probe: Channel

|Unit|Description|
|---|---|
|ACTPOS (0)|Actual position in user units|
|ACTPOSINC (1)|Actual position in increments|
|MASTERPOS (2)|Master position in increments|
|ENCPOS_CH1 (3)|Encoder position Channel 1|
|ENCPOS_CH1_INC (4)|Encoder position Channel 1 in increments|
|ENCPOS_CH2 (5)|Encoder position Channel 2|
|ENCPOS_CH2_INC (6)|Encoder position Channel 2 in increments|

# 8 Motion profile

MOOG ID No.:CB40859-001 Date:11/2020 MSD ServoDrive - DeviceHelp 276

|ID|Index Name / Setting|Unit|Description|
|---|---|---|---|
|7|ENCPOS_CH3 (7)| |Encoder position Channel 3|
|8|ENCPOS_CH3_INC (8)| |Encoder position Channel 3 in increments|
|9|ENCPOS_CH4 (9)| |Encoder position Channel 4|
|10|ENCPOS_CH4_INC (10)| |Encoder position Channel 4 in increments|
|11|ACTPOS2 (11)| |Actual position of redundant encoder in user units|
|12|Sercos (12)| |Referred to Sercos profile parameters S-x-0426, S-x-0427|
|13|UserRefPos(13)| |Reference position in user units|
|14|MasterPosST(14)| |Master position (ECAM, EGEAR) singleturn, always steps|
|15|CommonMasterPos(15)| |Master position (ECAM, EGEAR) singleturn, always steps|
|16|CommonMasterPosST(15)| |Master position (ECAM, EGEAR) singleturn, always steps|
|1402|MPRO_TP_Channel| | |
|1402|MPRO_TP_Channel| | |
|1402|MPRO_TP_Channel| | |
|1404|MPRO_TP_Lines| |Touch probe: Lines @ pulse counter on channel x|
|1404|MPRO_TP_Lines| | |
|1404|MPRO_TP_Lines| | |

Image 8.71: “Synchronized motion” screen

There are various modes available in the “synchronization mode” drop-down menu (P 242[0] - MPRO_ECAM_SyncModMode):

- Off(0) = Synchronized motion off
- ECAM_iPlc(1) = Electronic cam plate via MSD PLC
- EGEAR_iPlc(2) = Electr. gear unit via MSD PLC
- ECAM_PARA(3) = Electronic camming via parameters
- EGEAR_PARA(4) = Electronic gearing via parameters

NOTE: For more information refer to the bus system User Manuals or the description of the MSD PLC.

# 8.11.1 Electronic cam plate

The other parameters are configured in separate screens that can be accessed with the corresponding buttons.

- Master configuration (see Section ""Master configuration"" on page 280)
- Electronic gearing (see Section ""Electronic gearing"" on page 283)
- Electronic camming (see Section ""Electronic cam plate"" on page 277)

P 1318[0] - MPRO_ECAM_ControlWord is the control word for “synchronized motion” (see Section ""Control word for synchronized motion"" on page 279).

P 1326[0] - MPRO_ECAM_StatusWord is the status word for “synchronized motion” (see Section ""Status word for synchronized motion"" on page 279).

# 8.11.1.1 Table selection

|ID|Index Name|Unit|Description|
|---|---|---|---|
|1300|MPRO_ECAM_CTS_| |ECAM: CamTableSelect - Master reference|
|1301|MasterRef| | |
|1305|MPRO_ECAM_CTS_| |ECAM: CamTableSelect - Method for changing the camtable|
|1306|MPRO_ECAM_CTS_| |ECAM: CamTableSelect - Mode for changing the camtable|
|1307|MPRO_ECAM_CTS_|incr|ECAM: CamTableSelect - Distance for changing the camtable|
|242|MPRO_ECAM_| |ECAM / EGEAR: Mode of synchronized motion SyncModMode|
|265|MPRO_ECAM_| |ECAM / EGEAR: Slave speed factor (1 = 100%).|
|266|CamSlave_SpeedFactor| | |
|268|MPRO_ECAM_| |ECAM / EGEAR: Mode of switching off sync. motion|

# 8.11.1.2 Synchronization

|ID|Index Name|Unit|Description|
|---|---|---|---|
|1342|MPRO_ECAM_CI_|incr|ECAM: CamIn - Synchronization position (multiturn part)|
|1343|MPRO_ECAM_CO_|incr|ECAM: CamOut - Decoupling pos. (multiturn part)|
|1303|MPRO_ECAM_CI_|incr|ECAM: CamIn - Master offset|
|1308|MPRO_ECAM_CI_| |ECAM: CamIn - Master reference|
|1309|MPRO_ECAM_CI_| |ECAM: CamIn - Slave reference|
|1310|MPRO_ECAM_CI_| |ECAM: CamIn - Coupling mode|
|1311|MPRO_ECAM_CI_|incr|ECAM: CamIn - Coupling distance|
|1312|MPRO_ECAM_CI_|incr|ECAM: CamIn - Synchronization position|

Table 8.31: “Electronic camming - Table selection” parameters

Table 8.30: “Synchronized motion” parameters

Table 8.32: “Electronic camming - Synchronization” parameters

MOOG ID No.:CB40859-001 Date:11/2020

MSD ServoDrive - DeviceHelp 277

# 8 Motion profile

MOOG ID No.:CB40859-001 Date:11/2020 MSD ServoDrive - DeviceHelp 278

|ID|Index|Name|Unit|Description|
|---|---|---|---|---|
|1313|0|MPRO_ECAM_CO_SyncPosST|(singleturn part)|ECAM: CamOut - Slave reference|
|1314|0|MPRO_ECAM_CO_DecouplingMode|63|ECAM: CamOut - Decoupling mode|
|1315|0|MPRO_ECAM_CO_BreakingPosST|incr|ECAM: CamOut - Decoupling position|
|1316|0|MPRO_ECAM_CO_DecouplingDist|incr|ECAM: CamOut - Decoupling distance|
|1317|0|MPRO_ECAM_CO_StandstillPos|mDegree|ECAM: CamOut - Slave standstill position|

# Table 8.32: “Electronic camming - Synchronization” parameters (continue)

|ID|Index|Name|Unit|Description|
|---|---|---|---|---|
|1346| |MPRO_ECAM_SP_Table| |ECAM: Setpoint table interface|
|1346|0|Index| |Index of setpoint table|
|1346|1|Value| |Value at index of setpoint table|
|1347|0 to 31|MPRO_ECAM_SP_Index| |ECAM: Setpoint segments start index|
|1348|0 to 31|MPRO_ECAM_SP_Length| |ECAM: Setpoint segments length|
|1349|0 to 31|Length| | |
|1350|0|MPRO_ECAM_SP_MaDist| |ECAM: Setpoint segments master distance|
|1351|0|MPRO_ECAM_SP_IpoType| |ECAM: Setpoint segments interpolation type|
|1352|0 to 31|Checksum| |ECAM: Setpoint table checksum|
|1353|0 to 31|GainNum| |ECAM: Setpoint segments gain numerator|
| | |GainDen| |ECAM: Setpoint segments gain denominator|

# Table 8.33: “Electronic camming - Table segments” parameters

|ID|Index|Name|Unit|Description|
|---|---|---|---|---|
|1329|0 to 63|MPRO_ECAM_SegData_IndexNext| |ECAM: Index of the following segment|
|1330|0 to 63|MPRO_ECAM_SegData_IndexPrev| |ECAM: Index of the previous segment|
|1331|0 to 63|MPRO_ECAM_SegData_ProfileMode| |ECAM: Profile mode of the current segment|
|1332|0 to 63|MPRO_ECAM_SegData_DistMaster| |ECAM: Length of the master section of the current segment|
|1333|0 to 63|MPRO_ECAM_SegData_DistSlave| |ECAM: Length of the slave section of the current segment|
|1334|0 to 63|MPRO_ECAM_SegData_Lambda| |ECAM: Lambda value of the current segment|
|1335|0 to 63|MPRO_ECAM_SegData_StatusWord| |ECAM: Status word of the current segment|
|1336|0 to 63|MPRO_ECAM_SegData_ControlWord| |ECAM: Control word of the current segment|

# 8.11.2 Control word for synchronized motion

|Bit|Function|PLC function|Bit number|Description|
|---|---|---|---|---|
|0-7|Start segment (8-bit value)|-|0-7|Actual segment (8-bit value)|
|8-15|Reserved|-| |Actual ECAM / EGEAR state machine state (4 Bit value)|
|16|Absolute (true) / relative (false) master relationship|-| |- 0: ECAM / EGEAR asynchronous
- 1: ECAM / EGEAR synchronous
|
|17|Absolute (true) / relative (false) master (CAM) relationship at cam in|-| |- 2: ECAM / EGEAR synchronizing
- 3: ECAM / EGEAR desynchronizing
|
|18|Absolute (true) / relative (false) slave (CAM) relationship at cam in|-| |- 4: ECAM / EGEAR active and waiting for going asynchronous
|
|19-23|Reserved|-| |- 5: ECAM / EGEAR inactive and waiting for going synchronous
|
|24|Change gear ratio of the electronic gear online|MCB_GearRatioChange| | |
|25|Disable master calculation|MCB_Cam_MasterEnable| | |
|26|Enable master calculation|MCB_Cam_MasterEnable| | |
|27|Select CAM table|MCB_CamTableSelect| | |
|28|Start Ecam|MCB_CamIn| | |
|29|Stop Ecam|MCB_CamOut| | |
|30|Start Egear|MCB_GearIn| | |
|31|Stop Egear|MCB_GearOut| | |

# 8.11.3 Status word for synchronized motion

|Bit|Function|PLC function|Bit number|Description|
|---|---|---|---|---|
|12-26|Reserved|-| | |
|27|ECAM / EGEAR is active|-| | |
|28|Valid segments chosen|-| | |
|29|Master data are valid|-| | |
|30|Master is initialized|-| | |
|31|Master calculation is active|-| | |

Table 8.35: Control word ECAM (P 1318[0] - MPRO_ECAM_ControlWord)

Table 8.36: ECAM status word (P 1326[0] - MPRO_ECAM_StatusWord)

MOOG ID No.:CB40859-001 Date:11/2020 MSD ServoDrive - DeviceHelp 279

# 8 Motion profile

# 8 Motion profile

MOOG ID No.:CB40859-001 Date:11/2020

MSD ServoDrive - DeviceHelp 280

# 8.11.4 Master configuration

the master encoder, you will need to set the resolution relative to a single motor revolution in P 250 - MPRO_ECAM_PARAMaster_Amplitude (see below).

- ENC CH1 (3) = Encoder channel 1 X7 (Sin/Cos)
- ENC CH2 (4) = Encoder channel 2 X6 (Resolver)
- ENC CH3 (5) = Encoder channel 3 X8 (optional)

This function is only available if an external interface X8 (option module) is present.

- TP0 (6) = Pulse counter on probe channel 0 (TP0)
- TP1 (7) = Pulse counter on probe channel 1 (TP1)
- ENC_CH4 (8) = Encoder channel 4 (p. e. fieldbus)
- TWIN_POS (9) = TWIN remote reference position (P-2607)

Image 8.72: “Master configuration” screen

# Channel selection (master encoder)

P 1319[0] - MPRO_ECAM_CamMaster_AxisType is used to define the master encoder.

- NO AXIS (0) = No axis
- VIRTUAL MASTER (1) = Virtual master

If you select this function, you will be able to configure additional settings by clicking on the enabled “Options...” button (see Section ""Virtual Master"" on page 286).

- PARA (2) = Master parameter interface

If you select this function because a higher-level controller is being used as

# Anti-reverse mode

Slave only starts moving along with it again as soon as the master reaches the zero position.

P 1320[0] - MPRO_ECAM_CamMaster_RevLockMode is used to define the reverse lock mode, which can be used either with or without path compensation. The dashed lines in the following diagrams indicate what the engagement distance is:

# Example:

If the master, which has moved two motor revolutions in the direction blocked for the slave, then moves in the unblocked direction again, the slave only moves off when the master has traversed the zero point.

- INACTIVE (0) = Reverse lock inactive
- ACTIVE (2) = Reverse lock enabled - without path optimization
- ACTIVE WAY COMP (1) = Reverse lock active - with way compensation

While the slave accelerates to the speed of the master during engagement, the master and slave do not move synchronously. This function needs to be selected in order to quickly catch up to the master that is running ahead.

# Example:

- Master (black line) rotates in the blocked direction
- The slave (blue line) remains stopped
- Master rotates in the unblocked direction again
- The slave follows the master directly in the unblocked direction

Assume the master has moved two motor revolutions in the direction for which the slave lock is enabled. If the master now moves in the direction for which there is no lock, the slave will immediately start running in that direction.

MOOG ID No.:CB40859-001 Date:11/2020

MSD ServoDrive - DeviceHelp 281

# 8 Motion profile

MOOG ID No.:CB40859-001 Date:11/2020 MSD ServoDrive - DeviceHelp 282

|Filter type|ID|Index Name|Unit|Description|
|---|---|---|---|---|
|When using a real master encoder, encoder signals may be subject to noise.|P 1340|1319|0|MPRO_ECAM_CamMaster_AxisType|
| | |MPRO_ECAM_CamMaster_SpeedFilTyp| |ECAM / EGEAR: Channel selection of internal master input|
| | |1320|0|MPRO_ECAM_CamMaster_RevLockMode|
| | |1321|0|MPRO_ECAM_CamMaster_Amplitude|
| | |1322|0|MPRO_ECAM_CamMaster_GearNum|
| | |1323|0|MPRO_ECAM_CamMaster_GearDen|
|Filter time|1327|0|ms|ECAM / EGEAR: Filter time constant of master|
|If P 1340[0] is used to enable a filter, P 1327[0] - MPRO_ECAM_CamMaster_SpeedTFil can be used to define the corresponding filter time.|1328|0|speed|ECAM / EGEAR: Speed factor of the internal master|
|Speed factor|1340|0| |MPRO_ECAM_CamMaster_SpeedFilTyp|
|The master encoder can be assigned an additional speed factor P 1328[0] - MPRO_ECAM_CamMaster_SpeedFactor.|1341|0|incr|ECAM / EGEAR: Master drive offset|

Table 8.37: “Synchronized motion - Master configuration” parameters (continue)

| | | |ID|Index Name|Unit|Description|
|---|---|---|---|---|---|---|
|247|0|MPRO_ECAM_ParaMaster_ActPos|incr|ECAM / EGEAR: Parameter interface master position| | |
|248|0|MPRO_ECAM_ParaMaster_ActSpeed|rpm|ECAM / EGEAR: Parameter interface master speed| | |
|249|0|MPRO_ECAM_ParaMaster_ActAcc|rpm|ECAM / EGEAR: Parameter interface master acceleration| | |
| |250|0|MPRO_ECAM_ParaMaster_Amplitude| |ECAM / EGEAR: Parameter interface master amplitude| |

Table 8.37: “Synchronized motion - Master configuration” parameters

# 8.11.5 Electronic gearing

# Gear ratio

The gear ratio is specified as a fraction. This ensures that the position references can be translated to the motor shaft with no rounding error.

- ""Slave"" (P 252[0] - MPRO_ECAM_Egear_GearNum) is the numerator
- ""Master"" (P 251[0] - MPRO_ECAM_Egear_GearDen) is the denominator

# Scaling of speed pre-control

Defined with P 265[0] - MPRO_ECAM_CamSlave_SpeedFactor definiert.

# Scaling of torque pre-control

Defined with P 266[0] - MPRO_ECAM_CamSlave_TorqueFactor.

# Engagement

See Section ""Engagement"" on page 284.

# Disengagement

See Section ""Disengagement"" on page 285.

|ID|Index Name|Unit|Description|
|---|---|---|---|
|251|0 MPRO_ECAM_Egear_GearDen| |EGEAR: Gear denominator|
|252|0 MPRO_ECAM_Egear_GearNum| |EGEAR: Numerator of gear ratio|
|1344|0 MPRO_ECAM_Egear_LimRefAcc|rpm/s|EGEAR: Acceleration limit for reference|
|1345|0 MPRO_ECAM_Egear_LimRefJerk|rpm/s²|EGEAR: Jerk limit for reference|

Table 8.38: “Synchronized motion - Electronic gearing” parameters

Image 8.73: ""Electronic gearing"" screen

MOOG ID No.:CB40859-001 Date:11/2020 MSD ServoDrive - DeviceHelp 283

# 8 Motion profile

# 8 Motion profile

MOOG ID No.:CB40859-001 Date:11/2020

MSD ServoDrive - DeviceHelp 284

# 8.11.6 Engagement

used to define the engagement distance (between the dashed lines).

P 253[0] - MPRO_ECAM_Egear_GearInMode is used to define the mode for engagement.

- DIRECT (0) = Direct
- Direct engagement: Angular synchronous; with jerking (no ramps).
- CROSSFADE (3) = Crossfading
- Engagement with crossfading function (5th degree polynomial): Angular synchronous; jerk-limited; speed will overshoot during engagement.
- RAMP (1) = Linear speed ramp
- Engagement with linear acceleration: Not angular synchronous; with jerking.
- FADE (2) = Engagement fade-out
- Engagement with fade-in function (5th degree polynomial): Not angular synchronous; jerk-limited. The position is ignored. ",How is the maximum table index for auto modes defined in the 'MSD ServoDrive - DeviceHelp' document?,A3,Define the upper limit of table indexes in auto modes with P 206[0].,2.046875,2.015625,3.5,1.375,0.416015625
8,msd_servo_drive.txt,76,b87ca5e232c2bdbb6fa16a8a401c6b5d285dc0183e73cc9d134de13dd2fc71d2,"MOOG ID No.:CB40859-001 Date:11/2020

MSD ServoDrive - DeviceHelp 267

# 8 Motion profile

MOOG ID No.:CB40859-001 Date:11/2020 MSD ServoDrive - DeviceHelp 268

# Deceleration

With ...

- P 194 - MPRO_TAB_TDec (for torque control) or
- P 197 - MPRO_TAB_SDec (for speed control) or
- P 200 - MPRO_TAB_PDec (for position control)

and indexes 0–15, the deceleration for each individual motion task can be defined. The input must not be zero.

# Wait time in Auto mode

P 204 - MPRO_TAB_WaitTime is used to define the wait time before the next motion task is carried out.

# Maximum table index in Auto mode

P 206[0] - MPRO_Tab_MaxIdx is used to define the table index up to which driving jobs will be carried out in one of the auto modes.

# Current table index

P 207[0] - MPRO_Tab_ActIdx will show the index for the motion task that is currently active. If parameter P 205 MPRO_TAB_Mode is set to “Para(0)”, a driving set can be entered and approached directly.

# Activation of reference table

The following procedures can be used in order to activate the setpoint table for operation.

|ID|Index Name|Unit|Description|
|---|---|---|---|
|193|MPRO_TAB_TAcc|TAB: Torque mode acceleration|Nm/ms|
|193|0|MPRO_TAB_TAcc|Nm/ms|
|193|1 - 15|MPRO_TAB_TAcc|Nm/ms|
|194|MPRO_TAB_TDec|TAB: Torque mode deceleration| |
|194|0|MPRO_TAB_TDec|Nm/ms|
|194|1 - 15|MPRO_TAB_TDec|Nm/ms|

# Table 8.23: Activation of table references

# Table 8.24: “Setpoint table settings” parameters

# Table 8.24: “Setpoint table settings” parameters (continue)

|ID|Index Name|Unit|Description|ID|Index Name|Unit|Description|
|---|---|---|---|---|---|---|---|
|195|MPRO_TAB_TRef|Nm|TAB: Torque mode reference value|208|MPRO_TAB_OutputNo| |OSD TAB: actual table index and target|
|195|MPRO_TAB_TRef|Nm| |208|MPRO_TAB_OutputNo| | |
|196|MPRO_TAB_SAcc|rev/min/s|TAB: Speed mode acceleration|269|MPRO_TAB_Ctrl| |TAB: control word|
|196|MPRO_TAB_SAcc|rev/min/s| | | | | |
|197|MPRO_TAB_SDec|rev/min/s|TAB: Speed mode deceleration| | | | |
|197|MPRO_TAB_SDec|rev/min/s| | | | | |
|198|MPRO_TAB_SRef|rev/min|TAB: Speed mode reference value| | | | |
|198|MPRO_TAB_SRef|rev/min| | | | | |
|199|MPRO_TAB_PAcc|rev/min/s|TAB: Position control mode acceleration| | | | |
|199|MPRO_TAB_PAcc|rev/min/s| | | | | |
|200|MPRO_TAB_PDec|rev/min/s|TAB: Position control mode Acceleration| | | | |
|200|MPRO_TAB_PDec|rev/min/s| | | | | |
|201|MPRO_TAB_PSpd|rev/min|TAB: Position control mode speed| | | | |
|201|MPRO_TAB_PSpd|rev/min| | | | | |
|202|MPRO_TAB_PPos|mDegree|TAB: Position control mode reference value| | | | |
|202|MPRO_TAB_PPos|mDegree| | | | | |
|203|MPRO_TAB_PMode| |Position control table:Mode| | | | |
|203|MPRO_TAB_PMode| | | | | | |
|204|MPRO_TAB_WaitTime|ms|TAB: Wait time| | | | |
|204|MPRO_TAB_WaitTime|ms| | | | | |
|205|MPRO_TAB_Mode| |TAB mode| | | | |
|206|MPRO_Tab_MaxIdx| |TAB: Max index in AUTO mode| | | | |
|207|MPRO_TAB_ActIdx| |TAB: Actual index| | | | |

MOOG ID No.:CB40859-001 Date:11/2020

MSD ServoDrive - DeviceHelp

# 8 Motion profile

MOOG ID No.:CB40859-001 Date:11/2020

MSD ServoDrive - DeviceHelp 270

# 8.8 Analog channel (ISA00 und ISA01)

# Offset (O)

This parameter (P 174 - MPRO_ANA0_SOffset for ISA00, P 184 - MPRO_ANA1_SOffset for ISA01) compensates for component variations and is used for offset compensation purposes. Depending on the control mode being used (see Section ""Basic settings"" on page 110), the value will be stored in parameter index [0] (torque control), [1] (speed control) or [2] (position control).

# Backlash (B)

This parameter (P 175 - MPRO_ANA0_SThreshold for ISA00, P 185 - MPRO_ANA1_SThreshold for ISA01) can suppress axis motion close to the standstill (stop) position. Depending on the control mode being used (see Section ""Basic settings"" on page 110), the value will be stored in parameter index [0] (torque control), [1] (speed control) or [2] (position control).

Image 8.68: “Analog channel” screen

# Acceleration ramp

Two standard analog inputs (ISA00, ISA01) are available. These inputs can be configured...

- with negative values for analog setpoint settings
- with positive values for digital setpoint processing

(P 109[0] - MPRO_INPUT_FS_ISA00 and P 110[0] - MPRO_INPUT_FS_ISA01).

see also section ""Analog Inputs"" on page 303. By using the ""REV(-2) = Analog setpoint"" setting, an analog input voltage of ±10 V can be processed as a setpoint.

# Deceleration ramp

This parameter serves as a deceleration ramp for torque control (P 176[1] - MPRO_ANA0_TRamp for ISA00, P 186[1] - MPRO_ANA1_TRamp for ISA01) or speed control (P 177[1] - MPRO_ANA0_SRamp for ISA00, P 187[1] - MPRO_ANA1_SRamp for ISA01). Depending on the control mode being used (see Section ""Basic settings"" on page 110), the value will be stored in parameter index [0] (torque control), [1] (speed control) or [2] (position control).

This parameter (P 173 - MPRO_ANA0_Scale for ISA00, P 183 - MPRO_ANA1_Scale for ISA01) is used to define which speed / which torque / which position corresponds to the maximum analog value. Depending on the control mode being used (see Section ""Basic settings"" on page 110), the value will be stored in parameter index [0] (torque control), [1] (speed control) or [2] (position control).

# 8.8.1 Special characteristics of position control mode

A threshold value can also be specified which generates a run-on range around the last reference value. A ramp function calculates a motion profile for the position reference from pre-defined acceleration and speed limits.

The position references on the analog channel are not applied immediately, but dependent on a digital input. Accordingly, one of the ISD00 to ISD06 digital inputs must be set to a value of ""REFANAEN(28) = Enable analog reference value"" (see Section ""Digital inputs"" on page 290). The position setpoint being received will only be applied if the corresponding digital input is active. The acceleration is entered using P 173[0] - MPRO_ANA0_TScale or P 183[0] - MPRO_ANA1_TScale.

# 8.8.2 Wire Break Monitoring

P 399 - CON_ANAWireBrk_Th can be used to configure wire break monitoring for the analog inputs. For details see Section ""Wire Break Monitoring"" on page 306.

|Function|TLIM (-4)|OVR (-3)|REFV (-2)|leer (-1)|OFF (0)|
|---|---|---|---|---|---|
|Digital|(1)-(28)|(1)-(28)|(1)-(28)|(1)-(28)|(1)-(28)|
|Analog channel|Filter|Scale|Offset|Profile|generator|

Control

Image 8.69: Reference processing structure

MOOG ID No.:CB40859-001 Date:11/2020

MSD ServoDrive - DeviceHelp 271

# 8 Motion profile

# 8 Motion profile

MOOG ID No.:CB40859-001 Date:11/2020

|ID|Index Name|Unit|Description|ID|
|---|---|---|---|---|
|395|CON_ANA_Isaf_Scaled| |Analog inputs: Values (filt, norm, comp, scaled)|174|
|395|0 ISA00| |Scaled, compensated, filtered, normalized value|175|
|395|1 ISA01| |Scaled, compensated, filtered, normalized value| |
|396|CON_ANA_Scale_ThUpper| |Analog inputs: Upper scaling limits|175|
|396|0 ISA00|%|Upper scaling (@ 10 V) threshold|175|
|396|1 ISA01|%|Upper scaling (@ 10 V) threshold| |
|397|CON_ANA_Scale_ThZero| |Analog inputs: Zero scaling thresholds|176|
|397|0 ISA00|V|Zero scaling threshold (+/-)|176|
|397|1 ISA01|V|Zero scaling threshold (+/-)| |
|398|CON_ANA_Scale_ThLower| |Analog inputs: Lower scaling limits|177|
|398|0 ISA00|%|Lower scaling (@ zero threshold) threshold|177|
|398|1 ISA01|%|Lower scaling (@ zero threshold) threshold| |
|399|CON_ANA_WireBrk_Th| |Analog inputs: Wire break thresholds|Table 8.26:|
|399|0 ISA00|V|Wire break detection threshold| |
|399|1 ISA01|V|Wire break detection threshold| |
|405|0 CON_ANA_Filt0|ms|Analog input ISA00: Filter time constant (PT 1)|ID|
|408|CON_ANA_Isaf_Norm| |Analog inputs: Values (filt, norm)|183|
|408|0 ISA00| |Filtered, normalized value|183|
|408|1 ISA01| |Filtered, normalized value|183|

Table 8.25: “Analog channel” parameters

|ID|Index Name|Unit|Description|ID|
|---|---|---|---|---|
|173|MPRO_ANA0_Scale| |ANA0: scale factors|184|
|173|0 MPRO_ANA0_TScale|Nm|ANA0: scale factor torque reference|185|
|173|1 MPRO_ANA0_SScale|rev/min|ANA0: scale factor speed reference|185|
|173|2 MPRO_ANA0_PScale|mDegree|ANA0: scale factor position reference| |
|174|MPRO_ANA0_Offset| |ANA0: offsets|185|
|174|0 MPRO_ANA0_TOffset|Nm|ANA0: offsets for torque reference|185|

Table 8.26: “Analog channel ISA00” parameters

|Index Name|Unit|Description|
|---|---|---|
|1 MPRO_ANA0_SOffset|rev/min|ANA0: offsets for speed reference|
|2 MPRO_ANA0_POffset|mDegree|ANA0: offsets for position reference|
|MPRO_ANA0_Threshold| |ANA0: thresholds|
|0 MPRO_ANA0_TThreshold|Nm|ANA0: threshold for torque reference|
|1 MPRO_ANA0_SThreshold|rev/min|ANA0: threshold for speed reference|
|2 MPRO_ANA0_PThreshold|mDegree|ANA0: threshold for position reference|
|MPRO_ANA0_TRamp| |ANA0: Torque mode acceleration [0] and deceleration [1]|
|0 MPRO_ANA0_TRamp|Nm/s| |
|1 MPRO_ANA0_TRamp|Nm/s| |
|MPRO_ANA0_SRamp| |ANA0: Speed mode acceleration [0] and deceleration [1]|
|0 MPRO_ANA0_SRamp|SPEED/s| |
|1 MPRO_ANA0_SRamp|SPEED/s| |

“Analog channel ISA00” parameters (continue)

|Index Name|Unit|Description|
|---|---|---|
|MPRO_ANA1_Scale| |ANA1: scale factors|
|0 MPRO_ANA1_TScale|Nm|ANA0: scale factor torque reference|
|1 MPRO_ANA1_SScale|rev/min|ANA0: scale factor speed reference|
|2 MPRO_ANA1_PScale|mDegree|ANA0: scale factor position reference|
|MPRO_ANA1_Offset| |ANA1: offsets|
|0 MPRO_ANA1_TOffset|Nm|ANA1: offsets for torque reference|
|1 MPRO_ANA1_SOffset|rev/min|ANA1: offsets for speed reference|
|2 MPRO_ANA1_POffset|mDegree|ANA1: offsets for position reference|
|MPRO_ANA1_Threshold| |ANA1: thresholds|
|0 MPRO_ANA1_TThreshold|Nm|ANA1: threshold for torque reference|
|1 MPRO_ANA1_SThreshold|rev/min|ANA1: threshold for speed reference|
|2 MPRO_ANA1_PThreshold|mDegree|ANA1: threshold for position reference|

“Analog channel ISA01” parameters

# 8 Motion profile

|ID|Index Name|Unit|Description|
|---|---|---|---|
|186|MPRO_ANA1_TRamp|Nm/s|ANA1: Torque mode acceleration [0] and deceleration[1]|
|186|MPRO_ANA1_TRamp|Nm/s| |
|187|MPRO_ANA1_SRamp|SPEED/s|ANA1: Speed mode acceleration [0] and deceleration [1]|
|187|MPRO_ANA1_SRamp|SPEED/s| |

# Table 8.27: “Analog channel ISA01” parameters (continue)

Display

- System state
- Initialization on device startup
- Not ready (DC link voltage possibly too low)
- Start inhibit (DC link voltage present, power stage off)
- Starting lockout
- Ready for start
- Control initialization: Auto commutation, flux build-up etc.

# Table 8.28: Central state machine according to CiA 402 device display

MOOG ID No.:CB40859-001 Date:11/2020

MSD ServoDrive - DeviceHelp 273

# 8 Motion profile

MOOG ID No.:CB40859-001 Date:11/2020

MSD ServoDrive - DeviceHelp 274

|Display|System state|power disabled|fault|
|---|---|---|---|
|Control enabled|0|Start|7|
| |fault reaction active|0|14|
|Quick stop active|1|not ready|8|
| |to switch on|1|17|
|Error reaction active|2|switch on|disabled|
| |2|7| |
|Error state (in this state the error is indicated directly on the display.)|3|ready to|switch on|
|Device is reset (display flashes)|power enabled|3|6|
| |10|12| |
|• Number [5.] flashes when “STO” (Safe Torque Off) input is active. Display goes out when STO inactive.| | | |
|• The dot on the display flashes when the power stage is active.| | | |

Table 8.28: Central state machine according to CiA 402 device display (continue)

NOTE

l The system states indicated on the display may differ from the states in the table depending on the drive profile setting.

Image 8.70: State machine diagram based on CANopen communications

⓪ to ① State number

1 to 17 State transition (No. 17: DC link voltage cut off)

Legend for “State machine diagram based on CANopen communications” figure

# 8.10 Touch probe

|ID|Index Name / Setting|
|---|---|
|241|0 MPRO_TP_Position|
|241|1 MPRO_TP_Position|
|241|2 MPRO_TP_Position|
|241|3 MPRO_TP_Position|
|241|4 MPRO_TP_Position|
|1400|0 MPRO_TP_Config|
| |TP_TP (0)|
| |AB (1)|
| |PD_UP (2)|
| |PD_DOWN (3)|
| |PC_PC (4)|
| |PC_TP (5)|
| |TP_PC (6)|
| |ENC_ENC (7)|
| |ENC_TP (8)|
| |TP_ENC (9)|

Using the touch probe inputs, touch probe functions can be performed. In order to be able to do this, P 106[0] - MPRO_INPUT_FS_ISD05 and P 107[0] - MPRO_INPUT_FS_ISD06 must be used to set digital inputs ISD05 and ISD06 to ""PROBE(15) = Touch probe (only ISD05/06)"" (see Section ""Digital inputs"" on page 290). HTL encoders can be evaluated or pulse counters implemented using the MSD PLC.

The touch probe can be triggered with P 240 - MPRO_TP_Ctrl. This enables triggering on a positive or negative edge, or on both edges, of the signal detected on the touch probe inputs. After the measurement, the parameter jumps back to the value ""NONE (0)"" and the latch position is mapped in the corresponding subindex of parameter P 241 - MPRO_TP_Position. A continuous touch probe mode is not possible at present, so the touch probe has to be reactivated after the measurement.

P 1402 - MPRO_TP_Channel can be used to select various positions as actual value sources of the latch position for the touch probe functionality. The following table provides an overview of the available settings. The counters are accessed via the MSD PLC or a bus system.

|ID|Index Name / Setting|Unit|Description|
|---|---|---|---|
|240|MPRO_TP_Ctrl|Touch probe: Control| |
| |0| |NONE (0) = No function|
| |1| |POS (1) = Positive edge|
| |2| |NEG (2) = Negative edge|
| |3| |BOTH (3) = Both edges|
|240|0 MPRO_TP_Ctrl| | |
|240|1 MPRO_TP_Ctrl| | |
|240|2 MPRO_TP_Ctrl| | |
|241|MPRO_TP_Position|Probe: Pos. high/low edge of TP0/1, encoder zero pulse| |

Table 8.29: “Touch probe” parameters

MOOG ID No.:CB40859-001 Date:11/2020

# 8 Motion profile

|Unit|Description|
|---|---|
|mDegree|Touch probe: Configuration|
|mDegree|TP0, TP1 touch probe|
|mDegree|TP0, TP1 as encoder, A/B as quadrature counting|
|mDegree|TP0, TP1 as encoder, pulse (TP0) / direction (TP1), count up on direction high|
|mDegree|TP0, TP1 as encoder, pulse (TP0) / direction (TP1), count down on direction high|
|mDegree|TP0 pulse counter, TP1 pulse counter|
|mDegree|TP0 pulse counter, TP1 touch probe|
|mDegree|TP1 touch probe, TP0 pulse counter|
|mDegree|TP0 encoder counter, TP1 encoder counter|
|mDegree|TP0 encoder counter, TP1 touch probe|
|mDegree|TP0 touch probe, TP1 encoder counter|

Touch probe: Channel

|Unit|Description|
|---|---|
|ACTPOS (0)|Actual position in user units|
|ACTPOSINC (1)|Actual position in increments|
|MASTERPOS (2)|Master position in increments|
|ENCPOS_CH1 (3)|Encoder position Channel 1|
|ENCPOS_CH1_INC (4)|Encoder position Channel 1 in increments|
|ENCPOS_CH2 (5)|Encoder position Channel 2|
|ENCPOS_CH2_INC (6)|Encoder position Channel 2 in increments|

# 8 Motion profile

MOOG ID No.:CB40859-001 Date:11/2020 MSD ServoDrive - DeviceHelp 276

|ID|Index Name / Setting|Unit|Description|
|---|---|---|---|
|7|ENCPOS_CH3 (7)| |Encoder position Channel 3|
|8|ENCPOS_CH3_INC (8)| |Encoder position Channel 3 in increments|
|9|ENCPOS_CH4 (9)| |Encoder position Channel 4|
|10|ENCPOS_CH4_INC (10)| |Encoder position Channel 4 in increments|
|11|ACTPOS2 (11)| |Actual position of redundant encoder in user units|
|12|Sercos (12)| |Referred to Sercos profile parameters S-x-0426, S-x-0427|
|13|UserRefPos(13)| |Reference position in user units|
|14|MasterPosST(14)| |Master position (ECAM, EGEAR) singleturn, always steps|
|15|CommonMasterPos(15)| |Master position (ECAM, EGEAR) singleturn, always steps|
|16|CommonMasterPosST(15)| |Master position (ECAM, EGEAR) singleturn, always steps|
|1402|MPRO_TP_Channel| | |
|1402|MPRO_TP_Channel| | |
|1402|MPRO_TP_Channel| | |
|1404|MPRO_TP_Lines| |Touch probe: Lines @ pulse counter on channel x|
|1404|MPRO_TP_Lines| | |
|1404|MPRO_TP_Lines| | |

Image 8.71: “Synchronized motion” screen

There are various modes available in the “synchronization mode” drop-down menu (P 242[0] - MPRO_ECAM_SyncModMode):

- Off(0) = Synchronized motion off
- ECAM_iPlc(1) = Electronic cam plate via MSD PLC
- EGEAR_iPlc(2) = Electr. gear unit via MSD PLC
- ECAM_PARA(3) = Electronic camming via parameters
- EGEAR_PARA(4) = Electronic gearing via parameters

NOTE: For more information refer to the bus system User Manuals or the description of the MSD PLC.

# 8.11.1 Electronic cam plate

The other parameters are configured in separate screens that can be accessed with the corresponding buttons.

- Master configuration (see Section ""Master configuration"" on page 280)
- Electronic gearing (see Section ""Electronic gearing"" on page 283)
- Electronic camming (see Section ""Electronic cam plate"" on page 277)

P 1318[0] - MPRO_ECAM_ControlWord is the control word for “synchronized motion” (see Section ""Control word for synchronized motion"" on page 279).

P 1326[0] - MPRO_ECAM_StatusWord is the status word for “synchronized motion” (see Section ""Status word for synchronized motion"" on page 279).

# 8.11.1.1 Table selection

|ID|Index Name|Unit|Description|
|---|---|---|---|
|1300|MPRO_ECAM_CTS_| |ECAM: CamTableSelect - Master reference|
|1301|MasterRef| | |
|1305|MPRO_ECAM_CTS_| |ECAM: CamTableSelect - Method for changing the camtable|
|1306|MPRO_ECAM_CTS_| |ECAM: CamTableSelect - Mode for changing the camtable|
|1307|MPRO_ECAM_CTS_|incr|ECAM: CamTableSelect - Distance for changing the camtable|
|242|MPRO_ECAM_| |ECAM / EGEAR: Mode of synchronized motion SyncModMode|
|265|MPRO_ECAM_| |ECAM / EGEAR: Slave speed factor (1 = 100%).|
|266|CamSlave_SpeedFactor| | |
|268|MPRO_ECAM_| |ECAM / EGEAR: Mode of switching off sync. motion|

# 8.11.1.2 Synchronization

|ID|Index Name|Unit|Description|
|---|---|---|---|
|1342|MPRO_ECAM_CI_|incr|ECAM: CamIn - Synchronization position (multiturn part)|
|1343|MPRO_ECAM_CO_|incr|ECAM: CamOut - Decoupling pos. (multiturn part)|
|1303|MPRO_ECAM_CI_|incr|ECAM: CamIn - Master offset|
|1308|MPRO_ECAM_CI_| |ECAM: CamIn - Master reference|
|1309|MPRO_ECAM_CI_| |ECAM: CamIn - Slave reference|
|1310|MPRO_ECAM_CI_| |ECAM: CamIn - Coupling mode|
|1311|MPRO_ECAM_CI_|incr|ECAM: CamIn - Coupling distance|
|1312|MPRO_ECAM_CI_|incr|ECAM: CamIn - Synchronization position|

Table 8.31: “Electronic camming - Table selection” parameters

Table 8.30: “Synchronized motion” parameters

Table 8.32: “Electronic camming - Synchronization” parameters

MOOG ID No.:CB40859-001 Date:11/2020

MSD ServoDrive - DeviceHelp 277

# 8 Motion profile

MOOG ID No.:CB40859-001 Date:11/2020 MSD ServoDrive - DeviceHelp 278

|ID|Index|Name|Unit|Description|
|---|---|---|---|---|
|1313|0|MPRO_ECAM_CO_SyncPosST|(singleturn part)|ECAM: CamOut - Slave reference|
|1314|0|MPRO_ECAM_CO_DecouplingMode|63|ECAM: CamOut - Decoupling mode|
|1315|0|MPRO_ECAM_CO_BreakingPosST|incr|ECAM: CamOut - Decoupling position|
|1316|0|MPRO_ECAM_CO_DecouplingDist|incr|ECAM: CamOut - Decoupling distance|
|1317|0|MPRO_ECAM_CO_StandstillPos|mDegree|ECAM: CamOut - Slave standstill position|

# Table 8.32: “Electronic camming - Synchronization” parameters (continue)

|ID|Index|Name|Unit|Description|
|---|---|---|---|---|
|1346| |MPRO_ECAM_SP_Table| |ECAM: Setpoint table interface|
|1346|0|Index| |Index of setpoint table|
|1346|1|Value| |Value at index of setpoint table|
|1347|0 to 31|MPRO_ECAM_SP_Index| |ECAM: Setpoint segments start index|
|1348|0 to 31|MPRO_ECAM_SP_Length| |ECAM: Setpoint segments length|
|1349|0 to 31|Length| | |
|1350|0|MPRO_ECAM_SP_MaDist| |ECAM: Setpoint segments master distance|
|1351|0|MPRO_ECAM_SP_IpoType| |ECAM: Setpoint segments interpolation type|
|1352|0 to 31|Checksum| |ECAM: Setpoint table checksum|
|1353|0 to 31|GainNum| |ECAM: Setpoint segments gain numerator|
| | |GainDen| |ECAM: Setpoint segments gain denominator|

# Table 8.33: “Electronic camming - Table segments” parameters

|ID|Index|Name|Unit|Description|
|---|---|---|---|---|
|1329|0 to 63|MPRO_ECAM_SegData_IndexNext| |ECAM: Index of the following segment|
|1330|0 to 63|MPRO_ECAM_SegData_IndexPrev| |ECAM: Index of the previous segment|
|1331|0 to 63|MPRO_ECAM_SegData_ProfileMode| |ECAM: Profile mode of the current segment|
|1332|0 to 63|MPRO_ECAM_SegData_DistMaster| |ECAM: Length of the master section of the current segment|
|1333|0 to 63|MPRO_ECAM_SegData_DistSlave| |ECAM: Length of the slave section of the current segment|
|1334|0 to 63|MPRO_ECAM_SegData_Lambda| |ECAM: Lambda value of the current segment|
|1335|0 to 63|MPRO_ECAM_SegData_StatusWord| |ECAM: Status word of the current segment|
|1336|0 to 63|MPRO_ECAM_SegData_ControlWord| |ECAM: Control word of the current segment|

# 8.11.2 Control word for synchronized motion

|Bit|Function|PLC function|Bit number|Description|
|---|---|---|---|---|
|0-7|Start segment (8-bit value)|-|0-7|Actual segment (8-bit value)|
|8-15|Reserved|-| |Actual ECAM / EGEAR state machine state (4 Bit value)|
|16|Absolute (true) / relative (false) master relationship|-| |- 0: ECAM / EGEAR asynchronous
- 1: ECAM / EGEAR synchronous
|
|17|Absolute (true) / relative (false) master (CAM) relationship at cam in|-| |- 2: ECAM / EGEAR synchronizing
- 3: ECAM / EGEAR desynchronizing
|
|18|Absolute (true) / relative (false) slave (CAM) relationship at cam in|-| |- 4: ECAM / EGEAR active and waiting for going asynchronous
|
|19-23|Reserved|-| |- 5: ECAM / EGEAR inactive and waiting for going synchronous
|
|24|Change gear ratio of the electronic gear online|MCB_GearRatioChange| | |
|25|Disable master calculation|MCB_Cam_MasterEnable| | |
|26|Enable master calculation|MCB_Cam_MasterEnable| | |
|27|Select CAM table|MCB_CamTableSelect| | |
|28|Start Ecam|MCB_CamIn| | |
|29|Stop Ecam|MCB_CamOut| | |
|30|Start Egear|MCB_GearIn| | |
|31|Stop Egear|MCB_GearOut| | |

# 8.11.3 Status word for synchronized motion

|Bit|Function|PLC function|Bit number|Description|
|---|---|---|---|---|
|12-26|Reserved|-| | |
|27|ECAM / EGEAR is active|-| | |
|28|Valid segments chosen|-| | |
|29|Master data are valid|-| | |
|30|Master is initialized|-| | |
|31|Master calculation is active|-| | |

Table 8.35: Control word ECAM (P 1318[0] - MPRO_ECAM_ControlWord)

Table 8.36: ECAM status word (P 1326[0] - MPRO_ECAM_StatusWord)

MOOG ID No.:CB40859-001 Date:11/2020 MSD ServoDrive - DeviceHelp 279

# 8 Motion profile

# 8 Motion profile

MOOG ID No.:CB40859-001 Date:11/2020

MSD ServoDrive - DeviceHelp 280

# 8.11.4 Master configuration

the master encoder, you will need to set the resolution relative to a single motor revolution in P 250 - MPRO_ECAM_PARAMaster_Amplitude (see below).

- ENC CH1 (3) = Encoder channel 1 X7 (Sin/Cos)
- ENC CH2 (4) = Encoder channel 2 X6 (Resolver)
- ENC CH3 (5) = Encoder channel 3 X8 (optional)

This function is only available if an external interface X8 (option module) is present.

- TP0 (6) = Pulse counter on probe channel 0 (TP0)
- TP1 (7) = Pulse counter on probe channel 1 (TP1)
- ENC_CH4 (8) = Encoder channel 4 (p. e. fieldbus)
- TWIN_POS (9) = TWIN remote reference position (P-2607)

Image 8.72: “Master configuration” screen

# Channel selection (master encoder)

P 1319[0] - MPRO_ECAM_CamMaster_AxisType is used to define the master encoder.

- NO AXIS (0) = No axis
- VIRTUAL MASTER (1) = Virtual master

If you select this function, you will be able to configure additional settings by clicking on the enabled “Options...” button (see Section ""Virtual Master"" on page 286).

- PARA (2) = Master parameter interface

If you select this function because a higher-level controller is being used as

# Anti-reverse mode

Slave only starts moving along with it again as soon as the master reaches the zero position.

P 1320[0] - MPRO_ECAM_CamMaster_RevLockMode is used to define the reverse lock mode, which can be used either with or without path compensation. The dashed lines in the following diagrams indicate what the engagement distance is:

# Example:

If the master, which has moved two motor revolutions in the direction blocked for the slave, then moves in the unblocked direction again, the slave only moves off when the master has traversed the zero point.

- INACTIVE (0) = Reverse lock inactive
- ACTIVE (2) = Reverse lock enabled - without path optimization
- ACTIVE WAY COMP (1) = Reverse lock active - with way compensation

While the slave accelerates to the speed of the master during engagement, the master and slave do not move synchronously. This function needs to be selected in order to quickly catch up to the master that is running ahead.

# Example:

- Master (black line) rotates in the blocked direction
- The slave (blue line) remains stopped
- Master rotates in the unblocked direction again
- The slave follows the master directly in the unblocked direction

Assume the master has moved two motor revolutions in the direction for which the slave lock is enabled. If the master now moves in the direction for which there is no lock, the slave will immediately start running in that direction.

MOOG ID No.:CB40859-001 Date:11/2020

MSD ServoDrive - DeviceHelp 281

# 8 Motion profile

MOOG ID No.:CB40859-001 Date:11/2020 MSD ServoDrive - DeviceHelp 282

|Filter type|ID|Index Name|Unit|Description|
|---|---|---|---|---|
|When using a real master encoder, encoder signals may be subject to noise.|P 1340|1319|0|MPRO_ECAM_CamMaster_AxisType|
| | |MPRO_ECAM_CamMaster_SpeedFilTyp| |ECAM / EGEAR: Channel selection of internal master input|
| | |1320|0|MPRO_ECAM_CamMaster_RevLockMode|
| | |1321|0|MPRO_ECAM_CamMaster_Amplitude|
| | |1322|0|MPRO_ECAM_CamMaster_GearNum|
| | |1323|0|MPRO_ECAM_CamMaster_GearDen|
|Filter time|1327|0|ms|ECAM / EGEAR: Filter time constant of master|
|If P 1340[0] is used to enable a filter, P 1327[0] - MPRO_ECAM_CamMaster_SpeedTFil can be used to define the corresponding filter time.|1328|0|speed|ECAM / EGEAR: Speed factor of the internal master|
|Speed factor|1340|0| |MPRO_ECAM_CamMaster_SpeedFilTyp|
|The master encoder can be assigned an additional speed factor P 1328[0] - MPRO_ECAM_CamMaster_SpeedFactor.|1341|0|incr|ECAM / EGEAR: Master drive offset|

Table 8.37: “Synchronized motion - Master configuration” parameters (continue)

| | | |ID|Index Name|Unit|Description|
|---|---|---|---|---|---|---|
|247|0|MPRO_ECAM_ParaMaster_ActPos|incr|ECAM / EGEAR: Parameter interface master position| | |
|248|0|MPRO_ECAM_ParaMaster_ActSpeed|rpm|ECAM / EGEAR: Parameter interface master speed| | |
|249|0|MPRO_ECAM_ParaMaster_ActAcc|rpm|ECAM / EGEAR: Parameter interface master acceleration| | |
| |250|0|MPRO_ECAM_ParaMaster_Amplitude| |ECAM / EGEAR: Parameter interface master amplitude| |

Table 8.37: “Synchronized motion - Master configuration” parameters

# 8.11.5 Electronic gearing

# Gear ratio

The gear ratio is specified as a fraction. This ensures that the position references can be translated to the motor shaft with no rounding error.

- ""Slave"" (P 252[0] - MPRO_ECAM_Egear_GearNum) is the numerator
- ""Master"" (P 251[0] - MPRO_ECAM_Egear_GearDen) is the denominator

# Scaling of speed pre-control

Defined with P 265[0] - MPRO_ECAM_CamSlave_SpeedFactor definiert.

# Scaling of torque pre-control

Defined with P 266[0] - MPRO_ECAM_CamSlave_TorqueFactor.

# Engagement

See Section ""Engagement"" on page 284.

# Disengagement

See Section ""Disengagement"" on page 285.

|ID|Index Name|Unit|Description|
|---|---|---|---|
|251|0 MPRO_ECAM_Egear_GearDen| |EGEAR: Gear denominator|
|252|0 MPRO_ECAM_Egear_GearNum| |EGEAR: Numerator of gear ratio|
|1344|0 MPRO_ECAM_Egear_LimRefAcc|rpm/s|EGEAR: Acceleration limit for reference|
|1345|0 MPRO_ECAM_Egear_LimRefJerk|rpm/s²|EGEAR: Jerk limit for reference|

Table 8.38: “Synchronized motion - Electronic gearing” parameters

Image 8.73: ""Electronic gearing"" screen

MOOG ID No.:CB40859-001 Date:11/2020 MSD ServoDrive - DeviceHelp 283

# 8 Motion profile

# 8 Motion profile

MOOG ID No.:CB40859-001 Date:11/2020

MSD ServoDrive - DeviceHelp 284

# 8.11.6 Engagement

used to define the engagement distance (between the dashed lines).

P 253[0] - MPRO_ECAM_Egear_GearInMode is used to define the mode for engagement.

- DIRECT (0) = Direct
- Direct engagement: Angular synchronous; with jerking (no ramps).
- CROSSFADE (3) = Crossfading
- Engagement with crossfading function (5th degree polynomial): Angular synchronous; jerk-limited; speed will overshoot during engagement.
- RAMP (1) = Linear speed ramp
- Engagement with linear acceleration: Not angular synchronous; with jerking.
- FADE (2) = Engagement fade-out
- Engagement with fade-in function (5th degree polynomial): Not angular synchronous; jerk-limited. The position is ignored. ",How is the maximum table index for auto modes defined in the 'MSD ServoDrive - DeviceHelp' document?,A4,P 206[0] specifies the highest index for driving jobs in auto modes.,1.890625,1.8828125,3.34375,1.3671875,0.5390625
9,msd_servo_drive.txt,76,b87ca5e232c2bdbb6fa16a8a401c6b5d285dc0183e73cc9d134de13dd2fc71d2,"MOOG ID No.:CB40859-001 Date:11/2020

MSD ServoDrive - DeviceHelp 267

# 8 Motion profile

MOOG ID No.:CB40859-001 Date:11/2020 MSD ServoDrive - DeviceHelp 268

# Deceleration

With ...

- P 194 - MPRO_TAB_TDec (for torque control) or
- P 197 - MPRO_TAB_SDec (for speed control) or
- P 200 - MPRO_TAB_PDec (for position control)

and indexes 0–15, the deceleration for each individual motion task can be defined. The input must not be zero.

# Wait time in Auto mode

P 204 - MPRO_TAB_WaitTime is used to define the wait time before the next motion task is carried out.

# Maximum table index in Auto mode

P 206[0] - MPRO_Tab_MaxIdx is used to define the table index up to which driving jobs will be carried out in one of the auto modes.

# Current table index

P 207[0] - MPRO_Tab_ActIdx will show the index for the motion task that is currently active. If parameter P 205 MPRO_TAB_Mode is set to “Para(0)”, a driving set can be entered and approached directly.

# Activation of reference table

The following procedures can be used in order to activate the setpoint table for operation.

|ID|Index Name|Unit|Description|
|---|---|---|---|
|193|MPRO_TAB_TAcc|TAB: Torque mode acceleration|Nm/ms|
|193|0|MPRO_TAB_TAcc|Nm/ms|
|193|1 - 15|MPRO_TAB_TAcc|Nm/ms|
|194|MPRO_TAB_TDec|TAB: Torque mode deceleration| |
|194|0|MPRO_TAB_TDec|Nm/ms|
|194|1 - 15|MPRO_TAB_TDec|Nm/ms|

# Table 8.23: Activation of table references

# Table 8.24: “Setpoint table settings” parameters

# Table 8.24: “Setpoint table settings” parameters (continue)

|ID|Index Name|Unit|Description|ID|Index Name|Unit|Description|
|---|---|---|---|---|---|---|---|
|195|MPRO_TAB_TRef|Nm|TAB: Torque mode reference value|208|MPRO_TAB_OutputNo| |OSD TAB: actual table index and target|
|195|MPRO_TAB_TRef|Nm| |208|MPRO_TAB_OutputNo| | |
|196|MPRO_TAB_SAcc|rev/min/s|TAB: Speed mode acceleration|269|MPRO_TAB_Ctrl| |TAB: control word|
|196|MPRO_TAB_SAcc|rev/min/s| | | | | |
|197|MPRO_TAB_SDec|rev/min/s|TAB: Speed mode deceleration| | | | |
|197|MPRO_TAB_SDec|rev/min/s| | | | | |
|198|MPRO_TAB_SRef|rev/min|TAB: Speed mode reference value| | | | |
|198|MPRO_TAB_SRef|rev/min| | | | | |
|199|MPRO_TAB_PAcc|rev/min/s|TAB: Position control mode acceleration| | | | |
|199|MPRO_TAB_PAcc|rev/min/s| | | | | |
|200|MPRO_TAB_PDec|rev/min/s|TAB: Position control mode Acceleration| | | | |
|200|MPRO_TAB_PDec|rev/min/s| | | | | |
|201|MPRO_TAB_PSpd|rev/min|TAB: Position control mode speed| | | | |
|201|MPRO_TAB_PSpd|rev/min| | | | | |
|202|MPRO_TAB_PPos|mDegree|TAB: Position control mode reference value| | | | |
|202|MPRO_TAB_PPos|mDegree| | | | | |
|203|MPRO_TAB_PMode| |Position control table:Mode| | | | |
|203|MPRO_TAB_PMode| | | | | | |
|204|MPRO_TAB_WaitTime|ms|TAB: Wait time| | | | |
|204|MPRO_TAB_WaitTime|ms| | | | | |
|205|MPRO_TAB_Mode| |TAB mode| | | | |
|206|MPRO_Tab_MaxIdx| |TAB: Max index in AUTO mode| | | | |
|207|MPRO_TAB_ActIdx| |TAB: Actual index| | | | |

MOOG ID No.:CB40859-001 Date:11/2020

MSD ServoDrive - DeviceHelp

# 8 Motion profile

MOOG ID No.:CB40859-001 Date:11/2020

MSD ServoDrive - DeviceHelp 270

# 8.8 Analog channel (ISA00 und ISA01)

# Offset (O)

This parameter (P 174 - MPRO_ANA0_SOffset for ISA00, P 184 - MPRO_ANA1_SOffset for ISA01) compensates for component variations and is used for offset compensation purposes. Depending on the control mode being used (see Section ""Basic settings"" on page 110), the value will be stored in parameter index [0] (torque control), [1] (speed control) or [2] (position control).

# Backlash (B)

This parameter (P 175 - MPRO_ANA0_SThreshold for ISA00, P 185 - MPRO_ANA1_SThreshold for ISA01) can suppress axis motion close to the standstill (stop) position. Depending on the control mode being used (see Section ""Basic settings"" on page 110), the value will be stored in parameter index [0] (torque control), [1] (speed control) or [2] (position control).

Image 8.68: “Analog channel” screen

# Acceleration ramp

Two standard analog inputs (ISA00, ISA01) are available. These inputs can be configured...

- with negative values for analog setpoint settings
- with positive values for digital setpoint processing

(P 109[0] - MPRO_INPUT_FS_ISA00 and P 110[0] - MPRO_INPUT_FS_ISA01).

see also section ""Analog Inputs"" on page 303. By using the ""REV(-2) = Analog setpoint"" setting, an analog input voltage of ±10 V can be processed as a setpoint.

# Deceleration ramp

This parameter serves as a deceleration ramp for torque control (P 176[1] - MPRO_ANA0_TRamp for ISA00, P 186[1] - MPRO_ANA1_TRamp for ISA01) or speed control (P 177[1] - MPRO_ANA0_SRamp for ISA00, P 187[1] - MPRO_ANA1_SRamp for ISA01). Depending on the control mode being used (see Section ""Basic settings"" on page 110), the value will be stored in parameter index [0] (torque control), [1] (speed control) or [2] (position control).

This parameter (P 173 - MPRO_ANA0_Scale for ISA00, P 183 - MPRO_ANA1_Scale for ISA01) is used to define which speed / which torque / which position corresponds to the maximum analog value. Depending on the control mode being used (see Section ""Basic settings"" on page 110), the value will be stored in parameter index [0] (torque control), [1] (speed control) or [2] (position control).

# 8.8.1 Special characteristics of position control mode

A threshold value can also be specified which generates a run-on range around the last reference value. A ramp function calculates a motion profile for the position reference from pre-defined acceleration and speed limits.

The position references on the analog channel are not applied immediately, but dependent on a digital input. Accordingly, one of the ISD00 to ISD06 digital inputs must be set to a value of ""REFANAEN(28) = Enable analog reference value"" (see Section ""Digital inputs"" on page 290). The position setpoint being received will only be applied if the corresponding digital input is active. The acceleration is entered using P 173[0] - MPRO_ANA0_TScale or P 183[0] - MPRO_ANA1_TScale.

# 8.8.2 Wire Break Monitoring

P 399 - CON_ANAWireBrk_Th can be used to configure wire break monitoring for the analog inputs. For details see Section ""Wire Break Monitoring"" on page 306.

|Function|TLIM (-4)|OVR (-3)|REFV (-2)|leer (-1)|OFF (0)|
|---|---|---|---|---|---|
|Digital|(1)-(28)|(1)-(28)|(1)-(28)|(1)-(28)|(1)-(28)|
|Analog channel|Filter|Scale|Offset|Profile|generator|

Control

Image 8.69: Reference processing structure

MOOG ID No.:CB40859-001 Date:11/2020

MSD ServoDrive - DeviceHelp 271

# 8 Motion profile

# 8 Motion profile

MOOG ID No.:CB40859-001 Date:11/2020

|ID|Index Name|Unit|Description|ID|
|---|---|---|---|---|
|395|CON_ANA_Isaf_Scaled| |Analog inputs: Values (filt, norm, comp, scaled)|174|
|395|0 ISA00| |Scaled, compensated, filtered, normalized value|175|
|395|1 ISA01| |Scaled, compensated, filtered, normalized value| |
|396|CON_ANA_Scale_ThUpper| |Analog inputs: Upper scaling limits|175|
|396|0 ISA00|%|Upper scaling (@ 10 V) threshold|175|
|396|1 ISA01|%|Upper scaling (@ 10 V) threshold| |
|397|CON_ANA_Scale_ThZero| |Analog inputs: Zero scaling thresholds|176|
|397|0 ISA00|V|Zero scaling threshold (+/-)|176|
|397|1 ISA01|V|Zero scaling threshold (+/-)| |
|398|CON_ANA_Scale_ThLower| |Analog inputs: Lower scaling limits|177|
|398|0 ISA00|%|Lower scaling (@ zero threshold) threshold|177|
|398|1 ISA01|%|Lower scaling (@ zero threshold) threshold| |
|399|CON_ANA_WireBrk_Th| |Analog inputs: Wire break thresholds|Table 8.26:|
|399|0 ISA00|V|Wire break detection threshold| |
|399|1 ISA01|V|Wire break detection threshold| |
|405|0 CON_ANA_Filt0|ms|Analog input ISA00: Filter time constant (PT 1)|ID|
|408|CON_ANA_Isaf_Norm| |Analog inputs: Values (filt, norm)|183|
|408|0 ISA00| |Filtered, normalized value|183|
|408|1 ISA01| |Filtered, normalized value|183|

Table 8.25: “Analog channel” parameters

|ID|Index Name|Unit|Description|ID|
|---|---|---|---|---|
|173|MPRO_ANA0_Scale| |ANA0: scale factors|184|
|173|0 MPRO_ANA0_TScale|Nm|ANA0: scale factor torque reference|185|
|173|1 MPRO_ANA0_SScale|rev/min|ANA0: scale factor speed reference|185|
|173|2 MPRO_ANA0_PScale|mDegree|ANA0: scale factor position reference| |
|174|MPRO_ANA0_Offset| |ANA0: offsets|185|
|174|0 MPRO_ANA0_TOffset|Nm|ANA0: offsets for torque reference|185|

Table 8.26: “Analog channel ISA00” parameters

|Index Name|Unit|Description|
|---|---|---|
|1 MPRO_ANA0_SOffset|rev/min|ANA0: offsets for speed reference|
|2 MPRO_ANA0_POffset|mDegree|ANA0: offsets for position reference|
|MPRO_ANA0_Threshold| |ANA0: thresholds|
|0 MPRO_ANA0_TThreshold|Nm|ANA0: threshold for torque reference|
|1 MPRO_ANA0_SThreshold|rev/min|ANA0: threshold for speed reference|
|2 MPRO_ANA0_PThreshold|mDegree|ANA0: threshold for position reference|
|MPRO_ANA0_TRamp| |ANA0: Torque mode acceleration [0] and deceleration [1]|
|0 MPRO_ANA0_TRamp|Nm/s| |
|1 MPRO_ANA0_TRamp|Nm/s| |
|MPRO_ANA0_SRamp| |ANA0: Speed mode acceleration [0] and deceleration [1]|
|0 MPRO_ANA0_SRamp|SPEED/s| |
|1 MPRO_ANA0_SRamp|SPEED/s| |

“Analog channel ISA00” parameters (continue)

|Index Name|Unit|Description|
|---|---|---|
|MPRO_ANA1_Scale| |ANA1: scale factors|
|0 MPRO_ANA1_TScale|Nm|ANA0: scale factor torque reference|
|1 MPRO_ANA1_SScale|rev/min|ANA0: scale factor speed reference|
|2 MPRO_ANA1_PScale|mDegree|ANA0: scale factor position reference|
|MPRO_ANA1_Offset| |ANA1: offsets|
|0 MPRO_ANA1_TOffset|Nm|ANA1: offsets for torque reference|
|1 MPRO_ANA1_SOffset|rev/min|ANA1: offsets for speed reference|
|2 MPRO_ANA1_POffset|mDegree|ANA1: offsets for position reference|
|MPRO_ANA1_Threshold| |ANA1: thresholds|
|0 MPRO_ANA1_TThreshold|Nm|ANA1: threshold for torque reference|
|1 MPRO_ANA1_SThreshold|rev/min|ANA1: threshold for speed reference|
|2 MPRO_ANA1_PThreshold|mDegree|ANA1: threshold for position reference|

“Analog channel ISA01” parameters

# 8 Motion profile

|ID|Index Name|Unit|Description|
|---|---|---|---|
|186|MPRO_ANA1_TRamp|Nm/s|ANA1: Torque mode acceleration [0] and deceleration[1]|
|186|MPRO_ANA1_TRamp|Nm/s| |
|187|MPRO_ANA1_SRamp|SPEED/s|ANA1: Speed mode acceleration [0] and deceleration [1]|
|187|MPRO_ANA1_SRamp|SPEED/s| |

# Table 8.27: “Analog channel ISA01” parameters (continue)

Display

- System state
- Initialization on device startup
- Not ready (DC link voltage possibly too low)
- Start inhibit (DC link voltage present, power stage off)
- Starting lockout
- Ready for start
- Control initialization: Auto commutation, flux build-up etc.

# Table 8.28: Central state machine according to CiA 402 device display

MOOG ID No.:CB40859-001 Date:11/2020

MSD ServoDrive - DeviceHelp 273

# 8 Motion profile

MOOG ID No.:CB40859-001 Date:11/2020

MSD ServoDrive - DeviceHelp 274

|Display|System state|power disabled|fault|
|---|---|---|---|
|Control enabled|0|Start|7|
| |fault reaction active|0|14|
|Quick stop active|1|not ready|8|
| |to switch on|1|17|
|Error reaction active|2|switch on|disabled|
| |2|7| |
|Error state (in this state the error is indicated directly on the display.)|3|ready to|switch on|
|Device is reset (display flashes)|power enabled|3|6|
| |10|12| |
|• Number [5.] flashes when “STO” (Safe Torque Off) input is active. Display goes out when STO inactive.| | | |
|• The dot on the display flashes when the power stage is active.| | | |

Table 8.28: Central state machine according to CiA 402 device display (continue)

NOTE

l The system states indicated on the display may differ from the states in the table depending on the drive profile setting.

Image 8.70: State machine diagram based on CANopen communications

⓪ to ① State number

1 to 17 State transition (No. 17: DC link voltage cut off)

Legend for “State machine diagram based on CANopen communications” figure

# 8.10 Touch probe

|ID|Index Name / Setting|
|---|---|
|241|0 MPRO_TP_Position|
|241|1 MPRO_TP_Position|
|241|2 MPRO_TP_Position|
|241|3 MPRO_TP_Position|
|241|4 MPRO_TP_Position|
|1400|0 MPRO_TP_Config|
| |TP_TP (0)|
| |AB (1)|
| |PD_UP (2)|
| |PD_DOWN (3)|
| |PC_PC (4)|
| |PC_TP (5)|
| |TP_PC (6)|
| |ENC_ENC (7)|
| |ENC_TP (8)|
| |TP_ENC (9)|

Using the touch probe inputs, touch probe functions can be performed. In order to be able to do this, P 106[0] - MPRO_INPUT_FS_ISD05 and P 107[0] - MPRO_INPUT_FS_ISD06 must be used to set digital inputs ISD05 and ISD06 to ""PROBE(15) = Touch probe (only ISD05/06)"" (see Section ""Digital inputs"" on page 290). HTL encoders can be evaluated or pulse counters implemented using the MSD PLC.

The touch probe can be triggered with P 240 - MPRO_TP_Ctrl. This enables triggering on a positive or negative edge, or on both edges, of the signal detected on the touch probe inputs. After the measurement, the parameter jumps back to the value ""NONE (0)"" and the latch position is mapped in the corresponding subindex of parameter P 241 - MPRO_TP_Position. A continuous touch probe mode is not possible at present, so the touch probe has to be reactivated after the measurement.

P 1402 - MPRO_TP_Channel can be used to select various positions as actual value sources of the latch position for the touch probe functionality. The following table provides an overview of the available settings. The counters are accessed via the MSD PLC or a bus system.

|ID|Index Name / Setting|Unit|Description|
|---|---|---|---|
|240|MPRO_TP_Ctrl|Touch probe: Control| |
| |0| |NONE (0) = No function|
| |1| |POS (1) = Positive edge|
| |2| |NEG (2) = Negative edge|
| |3| |BOTH (3) = Both edges|
|240|0 MPRO_TP_Ctrl| | |
|240|1 MPRO_TP_Ctrl| | |
|240|2 MPRO_TP_Ctrl| | |
|241|MPRO_TP_Position|Probe: Pos. high/low edge of TP0/1, encoder zero pulse| |

Table 8.29: “Touch probe” parameters

MOOG ID No.:CB40859-001 Date:11/2020

# 8 Motion profile

|Unit|Description|
|---|---|
|mDegree|Touch probe: Configuration|
|mDegree|TP0, TP1 touch probe|
|mDegree|TP0, TP1 as encoder, A/B as quadrature counting|
|mDegree|TP0, TP1 as encoder, pulse (TP0) / direction (TP1), count up on direction high|
|mDegree|TP0, TP1 as encoder, pulse (TP0) / direction (TP1), count down on direction high|
|mDegree|TP0 pulse counter, TP1 pulse counter|
|mDegree|TP0 pulse counter, TP1 touch probe|
|mDegree|TP1 touch probe, TP0 pulse counter|
|mDegree|TP0 encoder counter, TP1 encoder counter|
|mDegree|TP0 encoder counter, TP1 touch probe|
|mDegree|TP0 touch probe, TP1 encoder counter|

Touch probe: Channel

|Unit|Description|
|---|---|
|ACTPOS (0)|Actual position in user units|
|ACTPOSINC (1)|Actual position in increments|
|MASTERPOS (2)|Master position in increments|
|ENCPOS_CH1 (3)|Encoder position Channel 1|
|ENCPOS_CH1_INC (4)|Encoder position Channel 1 in increments|
|ENCPOS_CH2 (5)|Encoder position Channel 2|
|ENCPOS_CH2_INC (6)|Encoder position Channel 2 in increments|

# 8 Motion profile

MOOG ID No.:CB40859-001 Date:11/2020 MSD ServoDrive - DeviceHelp 276

|ID|Index Name / Setting|Unit|Description|
|---|---|---|---|
|7|ENCPOS_CH3 (7)| |Encoder position Channel 3|
|8|ENCPOS_CH3_INC (8)| |Encoder position Channel 3 in increments|
|9|ENCPOS_CH4 (9)| |Encoder position Channel 4|
|10|ENCPOS_CH4_INC (10)| |Encoder position Channel 4 in increments|
|11|ACTPOS2 (11)| |Actual position of redundant encoder in user units|
|12|Sercos (12)| |Referred to Sercos profile parameters S-x-0426, S-x-0427|
|13|UserRefPos(13)| |Reference position in user units|
|14|MasterPosST(14)| |Master position (ECAM, EGEAR) singleturn, always steps|
|15|CommonMasterPos(15)| |Master position (ECAM, EGEAR) singleturn, always steps|
|16|CommonMasterPosST(15)| |Master position (ECAM, EGEAR) singleturn, always steps|
|1402|MPRO_TP_Channel| | |
|1402|MPRO_TP_Channel| | |
|1402|MPRO_TP_Channel| | |
|1404|MPRO_TP_Lines| |Touch probe: Lines @ pulse counter on channel x|
|1404|MPRO_TP_Lines| | |
|1404|MPRO_TP_Lines| | |

Image 8.71: “Synchronized motion” screen

There are various modes available in the “synchronization mode” drop-down menu (P 242[0] - MPRO_ECAM_SyncModMode):

- Off(0) = Synchronized motion off
- ECAM_iPlc(1) = Electronic cam plate via MSD PLC
- EGEAR_iPlc(2) = Electr. gear unit via MSD PLC
- ECAM_PARA(3) = Electronic camming via parameters
- EGEAR_PARA(4) = Electronic gearing via parameters

NOTE: For more information refer to the bus system User Manuals or the description of the MSD PLC.

# 8.11.1 Electronic cam plate

The other parameters are configured in separate screens that can be accessed with the corresponding buttons.

- Master configuration (see Section ""Master configuration"" on page 280)
- Electronic gearing (see Section ""Electronic gearing"" on page 283)
- Electronic camming (see Section ""Electronic cam plate"" on page 277)

P 1318[0] - MPRO_ECAM_ControlWord is the control word for “synchronized motion” (see Section ""Control word for synchronized motion"" on page 279).

P 1326[0] - MPRO_ECAM_StatusWord is the status word for “synchronized motion” (see Section ""Status word for synchronized motion"" on page 279).

# 8.11.1.1 Table selection

|ID|Index Name|Unit|Description|
|---|---|---|---|
|1300|MPRO_ECAM_CTS_| |ECAM: CamTableSelect - Master reference|
|1301|MasterRef| | |
|1305|MPRO_ECAM_CTS_| |ECAM: CamTableSelect - Method for changing the camtable|
|1306|MPRO_ECAM_CTS_| |ECAM: CamTableSelect - Mode for changing the camtable|
|1307|MPRO_ECAM_CTS_|incr|ECAM: CamTableSelect - Distance for changing the camtable|
|242|MPRO_ECAM_| |ECAM / EGEAR: Mode of synchronized motion SyncModMode|
|265|MPRO_ECAM_| |ECAM / EGEAR: Slave speed factor (1 = 100%).|
|266|CamSlave_SpeedFactor| | |
|268|MPRO_ECAM_| |ECAM / EGEAR: Mode of switching off sync. motion|

# 8.11.1.2 Synchronization

|ID|Index Name|Unit|Description|
|---|---|---|---|
|1342|MPRO_ECAM_CI_|incr|ECAM: CamIn - Synchronization position (multiturn part)|
|1343|MPRO_ECAM_CO_|incr|ECAM: CamOut - Decoupling pos. (multiturn part)|
|1303|MPRO_ECAM_CI_|incr|ECAM: CamIn - Master offset|
|1308|MPRO_ECAM_CI_| |ECAM: CamIn - Master reference|
|1309|MPRO_ECAM_CI_| |ECAM: CamIn - Slave reference|
|1310|MPRO_ECAM_CI_| |ECAM: CamIn - Coupling mode|
|1311|MPRO_ECAM_CI_|incr|ECAM: CamIn - Coupling distance|
|1312|MPRO_ECAM_CI_|incr|ECAM: CamIn - Synchronization position|

Table 8.31: “Electronic camming - Table selection” parameters

Table 8.30: “Synchronized motion” parameters

Table 8.32: “Electronic camming - Synchronization” parameters

MOOG ID No.:CB40859-001 Date:11/2020

MSD ServoDrive - DeviceHelp 277

# 8 Motion profile

MOOG ID No.:CB40859-001 Date:11/2020 MSD ServoDrive - DeviceHelp 278

|ID|Index|Name|Unit|Description|
|---|---|---|---|---|
|1313|0|MPRO_ECAM_CO_SyncPosST|(singleturn part)|ECAM: CamOut - Slave reference|
|1314|0|MPRO_ECAM_CO_DecouplingMode|63|ECAM: CamOut - Decoupling mode|
|1315|0|MPRO_ECAM_CO_BreakingPosST|incr|ECAM: CamOut - Decoupling position|
|1316|0|MPRO_ECAM_CO_DecouplingDist|incr|ECAM: CamOut - Decoupling distance|
|1317|0|MPRO_ECAM_CO_StandstillPos|mDegree|ECAM: CamOut - Slave standstill position|

# Table 8.32: “Electronic camming - Synchronization” parameters (continue)

|ID|Index|Name|Unit|Description|
|---|---|---|---|---|
|1346| |MPRO_ECAM_SP_Table| |ECAM: Setpoint table interface|
|1346|0|Index| |Index of setpoint table|
|1346|1|Value| |Value at index of setpoint table|
|1347|0 to 31|MPRO_ECAM_SP_Index| |ECAM: Setpoint segments start index|
|1348|0 to 31|MPRO_ECAM_SP_Length| |ECAM: Setpoint segments length|
|1349|0 to 31|Length| | |
|1350|0|MPRO_ECAM_SP_MaDist| |ECAM: Setpoint segments master distance|
|1351|0|MPRO_ECAM_SP_IpoType| |ECAM: Setpoint segments interpolation type|
|1352|0 to 31|Checksum| |ECAM: Setpoint table checksum|
|1353|0 to 31|GainNum| |ECAM: Setpoint segments gain numerator|
| | |GainDen| |ECAM: Setpoint segments gain denominator|

# Table 8.33: “Electronic camming - Table segments” parameters

|ID|Index|Name|Unit|Description|
|---|---|---|---|---|
|1329|0 to 63|MPRO_ECAM_SegData_IndexNext| |ECAM: Index of the following segment|
|1330|0 to 63|MPRO_ECAM_SegData_IndexPrev| |ECAM: Index of the previous segment|
|1331|0 to 63|MPRO_ECAM_SegData_ProfileMode| |ECAM: Profile mode of the current segment|
|1332|0 to 63|MPRO_ECAM_SegData_DistMaster| |ECAM: Length of the master section of the current segment|
|1333|0 to 63|MPRO_ECAM_SegData_DistSlave| |ECAM: Length of the slave section of the current segment|
|1334|0 to 63|MPRO_ECAM_SegData_Lambda| |ECAM: Lambda value of the current segment|
|1335|0 to 63|MPRO_ECAM_SegData_StatusWord| |ECAM: Status word of the current segment|
|1336|0 to 63|MPRO_ECAM_SegData_ControlWord| |ECAM: Control word of the current segment|

# 8.11.2 Control word for synchronized motion

|Bit|Function|PLC function|Bit number|Description|
|---|---|---|---|---|
|0-7|Start segment (8-bit value)|-|0-7|Actual segment (8-bit value)|
|8-15|Reserved|-| |Actual ECAM / EGEAR state machine state (4 Bit value)|
|16|Absolute (true) / relative (false) master relationship|-| |- 0: ECAM / EGEAR asynchronous
- 1: ECAM / EGEAR synchronous
|
|17|Absolute (true) / relative (false) master (CAM) relationship at cam in|-| |- 2: ECAM / EGEAR synchronizing
- 3: ECAM / EGEAR desynchronizing
|
|18|Absolute (true) / relative (false) slave (CAM) relationship at cam in|-| |- 4: ECAM / EGEAR active and waiting for going asynchronous
|
|19-23|Reserved|-| |- 5: ECAM / EGEAR inactive and waiting for going synchronous
|
|24|Change gear ratio of the electronic gear online|MCB_GearRatioChange| | |
|25|Disable master calculation|MCB_Cam_MasterEnable| | |
|26|Enable master calculation|MCB_Cam_MasterEnable| | |
|27|Select CAM table|MCB_CamTableSelect| | |
|28|Start Ecam|MCB_CamIn| | |
|29|Stop Ecam|MCB_CamOut| | |
|30|Start Egear|MCB_GearIn| | |
|31|Stop Egear|MCB_GearOut| | |

# 8.11.3 Status word for synchronized motion

|Bit|Function|PLC function|Bit number|Description|
|---|---|---|---|---|
|12-26|Reserved|-| | |
|27|ECAM / EGEAR is active|-| | |
|28|Valid segments chosen|-| | |
|29|Master data are valid|-| | |
|30|Master is initialized|-| | |
|31|Master calculation is active|-| | |

Table 8.35: Control word ECAM (P 1318[0] - MPRO_ECAM_ControlWord)

Table 8.36: ECAM status word (P 1326[0] - MPRO_ECAM_StatusWord)

MOOG ID No.:CB40859-001 Date:11/2020 MSD ServoDrive - DeviceHelp 279

# 8 Motion profile

# 8 Motion profile

MOOG ID No.:CB40859-001 Date:11/2020

MSD ServoDrive - DeviceHelp 280

# 8.11.4 Master configuration

the master encoder, you will need to set the resolution relative to a single motor revolution in P 250 - MPRO_ECAM_PARAMaster_Amplitude (see below).

- ENC CH1 (3) = Encoder channel 1 X7 (Sin/Cos)
- ENC CH2 (4) = Encoder channel 2 X6 (Resolver)
- ENC CH3 (5) = Encoder channel 3 X8 (optional)

This function is only available if an external interface X8 (option module) is present.

- TP0 (6) = Pulse counter on probe channel 0 (TP0)
- TP1 (7) = Pulse counter on probe channel 1 (TP1)
- ENC_CH4 (8) = Encoder channel 4 (p. e. fieldbus)
- TWIN_POS (9) = TWIN remote reference position (P-2607)

Image 8.72: “Master configuration” screen

# Channel selection (master encoder)

P 1319[0] - MPRO_ECAM_CamMaster_AxisType is used to define the master encoder.

- NO AXIS (0) = No axis
- VIRTUAL MASTER (1) = Virtual master

If you select this function, you will be able to configure additional settings by clicking on the enabled “Options...” button (see Section ""Virtual Master"" on page 286).

- PARA (2) = Master parameter interface

If you select this function because a higher-level controller is being used as

# Anti-reverse mode

Slave only starts moving along with it again as soon as the master reaches the zero position.

P 1320[0] - MPRO_ECAM_CamMaster_RevLockMode is used to define the reverse lock mode, which can be used either with or without path compensation. The dashed lines in the following diagrams indicate what the engagement distance is:

# Example:

If the master, which has moved two motor revolutions in the direction blocked for the slave, then moves in the unblocked direction again, the slave only moves off when the master has traversed the zero point.

- INACTIVE (0) = Reverse lock inactive
- ACTIVE (2) = Reverse lock enabled - without path optimization
- ACTIVE WAY COMP (1) = Reverse lock active - with way compensation

While the slave accelerates to the speed of the master during engagement, the master and slave do not move synchronously. This function needs to be selected in order to quickly catch up to the master that is running ahead.

# Example:

- Master (black line) rotates in the blocked direction
- The slave (blue line) remains stopped
- Master rotates in the unblocked direction again
- The slave follows the master directly in the unblocked direction

Assume the master has moved two motor revolutions in the direction for which the slave lock is enabled. If the master now moves in the direction for which there is no lock, the slave will immediately start running in that direction.

MOOG ID No.:CB40859-001 Date:11/2020

MSD ServoDrive - DeviceHelp 281

# 8 Motion profile

MOOG ID No.:CB40859-001 Date:11/2020 MSD ServoDrive - DeviceHelp 282

|Filter type|ID|Index Name|Unit|Description|
|---|---|---|---|---|
|When using a real master encoder, encoder signals may be subject to noise.|P 1340|1319|0|MPRO_ECAM_CamMaster_AxisType|
| | |MPRO_ECAM_CamMaster_SpeedFilTyp| |ECAM / EGEAR: Channel selection of internal master input|
| | |1320|0|MPRO_ECAM_CamMaster_RevLockMode|
| | |1321|0|MPRO_ECAM_CamMaster_Amplitude|
| | |1322|0|MPRO_ECAM_CamMaster_GearNum|
| | |1323|0|MPRO_ECAM_CamMaster_GearDen|
|Filter time|1327|0|ms|ECAM / EGEAR: Filter time constant of master|
|If P 1340[0] is used to enable a filter, P 1327[0] - MPRO_ECAM_CamMaster_SpeedTFil can be used to define the corresponding filter time.|1328|0|speed|ECAM / EGEAR: Speed factor of the internal master|
|Speed factor|1340|0| |MPRO_ECAM_CamMaster_SpeedFilTyp|
|The master encoder can be assigned an additional speed factor P 1328[0] - MPRO_ECAM_CamMaster_SpeedFactor.|1341|0|incr|ECAM / EGEAR: Master drive offset|

Table 8.37: “Synchronized motion - Master configuration” parameters (continue)

| | | |ID|Index Name|Unit|Description|
|---|---|---|---|---|---|---|
|247|0|MPRO_ECAM_ParaMaster_ActPos|incr|ECAM / EGEAR: Parameter interface master position| | |
|248|0|MPRO_ECAM_ParaMaster_ActSpeed|rpm|ECAM / EGEAR: Parameter interface master speed| | |
|249|0|MPRO_ECAM_ParaMaster_ActAcc|rpm|ECAM / EGEAR: Parameter interface master acceleration| | |
| |250|0|MPRO_ECAM_ParaMaster_Amplitude| |ECAM / EGEAR: Parameter interface master amplitude| |

Table 8.37: “Synchronized motion - Master configuration” parameters

# 8.11.5 Electronic gearing

# Gear ratio

The gear ratio is specified as a fraction. This ensures that the position references can be translated to the motor shaft with no rounding error.

- ""Slave"" (P 252[0] - MPRO_ECAM_Egear_GearNum) is the numerator
- ""Master"" (P 251[0] - MPRO_ECAM_Egear_GearDen) is the denominator

# Scaling of speed pre-control

Defined with P 265[0] - MPRO_ECAM_CamSlave_SpeedFactor definiert.

# Scaling of torque pre-control

Defined with P 266[0] - MPRO_ECAM_CamSlave_TorqueFactor.

# Engagement

See Section ""Engagement"" on page 284.

# Disengagement

See Section ""Disengagement"" on page 285.

|ID|Index Name|Unit|Description|
|---|---|---|---|
|251|0 MPRO_ECAM_Egear_GearDen| |EGEAR: Gear denominator|
|252|0 MPRO_ECAM_Egear_GearNum| |EGEAR: Numerator of gear ratio|
|1344|0 MPRO_ECAM_Egear_LimRefAcc|rpm/s|EGEAR: Acceleration limit for reference|
|1345|0 MPRO_ECAM_Egear_LimRefJerk|rpm/s²|EGEAR: Jerk limit for reference|

Table 8.38: “Synchronized motion - Electronic gearing” parameters

Image 8.73: ""Electronic gearing"" screen

MOOG ID No.:CB40859-001 Date:11/2020 MSD ServoDrive - DeviceHelp 283

# 8 Motion profile

# 8 Motion profile

MOOG ID No.:CB40859-001 Date:11/2020

MSD ServoDrive - DeviceHelp 284

# 8.11.6 Engagement

used to define the engagement distance (between the dashed lines).

P 253[0] - MPRO_ECAM_Egear_GearInMode is used to define the mode for engagement.

- DIRECT (0) = Direct
- Direct engagement: Angular synchronous; with jerking (no ramps).
- CROSSFADE (3) = Crossfading
- Engagement with crossfading function (5th degree polynomial): Angular synchronous; jerk-limited; speed will overshoot during engagement.
- RAMP (1) = Linear speed ramp
- Engagement with linear acceleration: Not angular synchronous; with jerking.
- FADE (2) = Engagement fade-out
- Engagement with fade-in function (5th degree polynomial): Not angular synchronous; jerk-limited. The position is ignored. ",How is the maximum table index for auto modes defined in the 'MSD ServoDrive - DeviceHelp' document?,A5,"In the document, P 206[0] sets the max table index for auto mode operations.",1.6171875,1.5703125,3.46875,1.34375,0.494140625
10,msd_servo_drive.txt,76,b87ca5e232c2bdbb6fa16a8a401c6b5d285dc0183e73cc9d134de13dd2fc71d2,"MOOG ID No.:CB40859-001 Date:11/2020

MSD ServoDrive - DeviceHelp 267

# 8 Motion profile

MOOG ID No.:CB40859-001 Date:11/2020 MSD ServoDrive - DeviceHelp 268

# Deceleration

With ...

- P 194 - MPRO_TAB_TDec (for torque control) or
- P 197 - MPRO_TAB_SDec (for speed control) or
- P 200 - MPRO_TAB_PDec (for position control)

and indexes 0–15, the deceleration for each individual motion task can be defined. The input must not be zero.

# Wait time in Auto mode

P 204 - MPRO_TAB_WaitTime is used to define the wait time before the next motion task is carried out.

# Maximum table index in Auto mode

P 206[0] - MPRO_Tab_MaxIdx is used to define the table index up to which driving jobs will be carried out in one of the auto modes.

# Current table index

P 207[0] - MPRO_Tab_ActIdx will show the index for the motion task that is currently active. If parameter P 205 MPRO_TAB_Mode is set to “Para(0)”, a driving set can be entered and approached directly.

# Activation of reference table

The following procedures can be used in order to activate the setpoint table for operation.

|ID|Index Name|Unit|Description|
|---|---|---|---|
|193|MPRO_TAB_TAcc|TAB: Torque mode acceleration|Nm/ms|
|193|0|MPRO_TAB_TAcc|Nm/ms|
|193|1 - 15|MPRO_TAB_TAcc|Nm/ms|
|194|MPRO_TAB_TDec|TAB: Torque mode deceleration| |
|194|0|MPRO_TAB_TDec|Nm/ms|
|194|1 - 15|MPRO_TAB_TDec|Nm/ms|

# Table 8.23: Activation of table references

# Table 8.24: “Setpoint table settings” parameters

# Table 8.24: “Setpoint table settings” parameters (continue)

|ID|Index Name|Unit|Description|ID|Index Name|Unit|Description|
|---|---|---|---|---|---|---|---|
|195|MPRO_TAB_TRef|Nm|TAB: Torque mode reference value|208|MPRO_TAB_OutputNo| |OSD TAB: actual table index and target|
|195|MPRO_TAB_TRef|Nm| |208|MPRO_TAB_OutputNo| | |
|196|MPRO_TAB_SAcc|rev/min/s|TAB: Speed mode acceleration|269|MPRO_TAB_Ctrl| |TAB: control word|
|196|MPRO_TAB_SAcc|rev/min/s| | | | | |
|197|MPRO_TAB_SDec|rev/min/s|TAB: Speed mode deceleration| | | | |
|197|MPRO_TAB_SDec|rev/min/s| | | | | |
|198|MPRO_TAB_SRef|rev/min|TAB: Speed mode reference value| | | | |
|198|MPRO_TAB_SRef|rev/min| | | | | |
|199|MPRO_TAB_PAcc|rev/min/s|TAB: Position control mode acceleration| | | | |
|199|MPRO_TAB_PAcc|rev/min/s| | | | | |
|200|MPRO_TAB_PDec|rev/min/s|TAB: Position control mode Acceleration| | | | |
|200|MPRO_TAB_PDec|rev/min/s| | | | | |
|201|MPRO_TAB_PSpd|rev/min|TAB: Position control mode speed| | | | |
|201|MPRO_TAB_PSpd|rev/min| | | | | |
|202|MPRO_TAB_PPos|mDegree|TAB: Position control mode reference value| | | | |
|202|MPRO_TAB_PPos|mDegree| | | | | |
|203|MPRO_TAB_PMode| |Position control table:Mode| | | | |
|203|MPRO_TAB_PMode| | | | | | |
|204|MPRO_TAB_WaitTime|ms|TAB: Wait time| | | | |
|204|MPRO_TAB_WaitTime|ms| | | | | |
|205|MPRO_TAB_Mode| |TAB mode| | | | |
|206|MPRO_Tab_MaxIdx| |TAB: Max index in AUTO mode| | | | |
|207|MPRO_TAB_ActIdx| |TAB: Actual index| | | | |

MOOG ID No.:CB40859-001 Date:11/2020

MSD ServoDrive - DeviceHelp

# 8 Motion profile

MOOG ID No.:CB40859-001 Date:11/2020

MSD ServoDrive - DeviceHelp 270

# 8.8 Analog channel (ISA00 und ISA01)

# Offset (O)

This parameter (P 174 - MPRO_ANA0_SOffset for ISA00, P 184 - MPRO_ANA1_SOffset for ISA01) compensates for component variations and is used for offset compensation purposes. Depending on the control mode being used (see Section ""Basic settings"" on page 110), the value will be stored in parameter index [0] (torque control), [1] (speed control) or [2] (position control).

# Backlash (B)

This parameter (P 175 - MPRO_ANA0_SThreshold for ISA00, P 185 - MPRO_ANA1_SThreshold for ISA01) can suppress axis motion close to the standstill (stop) position. Depending on the control mode being used (see Section ""Basic settings"" on page 110), the value will be stored in parameter index [0] (torque control), [1] (speed control) or [2] (position control).

Image 8.68: “Analog channel” screen

# Acceleration ramp

Two standard analog inputs (ISA00, ISA01) are available. These inputs can be configured...

- with negative values for analog setpoint settings
- with positive values for digital setpoint processing

(P 109[0] - MPRO_INPUT_FS_ISA00 and P 110[0] - MPRO_INPUT_FS_ISA01).

see also section ""Analog Inputs"" on page 303. By using the ""REV(-2) = Analog setpoint"" setting, an analog input voltage of ±10 V can be processed as a setpoint.

# Deceleration ramp

This parameter serves as a deceleration ramp for torque control (P 176[1] - MPRO_ANA0_TRamp for ISA00, P 186[1] - MPRO_ANA1_TRamp for ISA01) or speed control (P 177[1] - MPRO_ANA0_SRamp for ISA00, P 187[1] - MPRO_ANA1_SRamp for ISA01). Depending on the control mode being used (see Section ""Basic settings"" on page 110), the value will be stored in parameter index [0] (torque control), [1] (speed control) or [2] (position control).

This parameter (P 173 - MPRO_ANA0_Scale for ISA00, P 183 - MPRO_ANA1_Scale for ISA01) is used to define which speed / which torque / which position corresponds to the maximum analog value. Depending on the control mode being used (see Section ""Basic settings"" on page 110), the value will be stored in parameter index [0] (torque control), [1] (speed control) or [2] (position control).

# 8.8.1 Special characteristics of position control mode

A threshold value can also be specified which generates a run-on range around the last reference value. A ramp function calculates a motion profile for the position reference from pre-defined acceleration and speed limits.

The position references on the analog channel are not applied immediately, but dependent on a digital input. Accordingly, one of the ISD00 to ISD06 digital inputs must be set to a value of ""REFANAEN(28) = Enable analog reference value"" (see Section ""Digital inputs"" on page 290). The position setpoint being received will only be applied if the corresponding digital input is active. The acceleration is entered using P 173[0] - MPRO_ANA0_TScale or P 183[0] - MPRO_ANA1_TScale.

# 8.8.2 Wire Break Monitoring

P 399 - CON_ANAWireBrk_Th can be used to configure wire break monitoring for the analog inputs. For details see Section ""Wire Break Monitoring"" on page 306.

|Function|TLIM (-4)|OVR (-3)|REFV (-2)|leer (-1)|OFF (0)|
|---|---|---|---|---|---|
|Digital|(1)-(28)|(1)-(28)|(1)-(28)|(1)-(28)|(1)-(28)|
|Analog channel|Filter|Scale|Offset|Profile|generator|

Control

Image 8.69: Reference processing structure

MOOG ID No.:CB40859-001 Date:11/2020

MSD ServoDrive - DeviceHelp 271

# 8 Motion profile

# 8 Motion profile

MOOG ID No.:CB40859-001 Date:11/2020

|ID|Index Name|Unit|Description|ID|
|---|---|---|---|---|
|395|CON_ANA_Isaf_Scaled| |Analog inputs: Values (filt, norm, comp, scaled)|174|
|395|0 ISA00| |Scaled, compensated, filtered, normalized value|175|
|395|1 ISA01| |Scaled, compensated, filtered, normalized value| |
|396|CON_ANA_Scale_ThUpper| |Analog inputs: Upper scaling limits|175|
|396|0 ISA00|%|Upper scaling (@ 10 V) threshold|175|
|396|1 ISA01|%|Upper scaling (@ 10 V) threshold| |
|397|CON_ANA_Scale_ThZero| |Analog inputs: Zero scaling thresholds|176|
|397|0 ISA00|V|Zero scaling threshold (+/-)|176|
|397|1 ISA01|V|Zero scaling threshold (+/-)| |
|398|CON_ANA_Scale_ThLower| |Analog inputs: Lower scaling limits|177|
|398|0 ISA00|%|Lower scaling (@ zero threshold) threshold|177|
|398|1 ISA01|%|Lower scaling (@ zero threshold) threshold| |
|399|CON_ANA_WireBrk_Th| |Analog inputs: Wire break thresholds|Table 8.26:|
|399|0 ISA00|V|Wire break detection threshold| |
|399|1 ISA01|V|Wire break detection threshold| |
|405|0 CON_ANA_Filt0|ms|Analog input ISA00: Filter time constant (PT 1)|ID|
|408|CON_ANA_Isaf_Norm| |Analog inputs: Values (filt, norm)|183|
|408|0 ISA00| |Filtered, normalized value|183|
|408|1 ISA01| |Filtered, normalized value|183|

Table 8.25: “Analog channel” parameters

|ID|Index Name|Unit|Description|ID|
|---|---|---|---|---|
|173|MPRO_ANA0_Scale| |ANA0: scale factors|184|
|173|0 MPRO_ANA0_TScale|Nm|ANA0: scale factor torque reference|185|
|173|1 MPRO_ANA0_SScale|rev/min|ANA0: scale factor speed reference|185|
|173|2 MPRO_ANA0_PScale|mDegree|ANA0: scale factor position reference| |
|174|MPRO_ANA0_Offset| |ANA0: offsets|185|
|174|0 MPRO_ANA0_TOffset|Nm|ANA0: offsets for torque reference|185|

Table 8.26: “Analog channel ISA00” parameters

|Index Name|Unit|Description|
|---|---|---|
|1 MPRO_ANA0_SOffset|rev/min|ANA0: offsets for speed reference|
|2 MPRO_ANA0_POffset|mDegree|ANA0: offsets for position reference|
|MPRO_ANA0_Threshold| |ANA0: thresholds|
|0 MPRO_ANA0_TThreshold|Nm|ANA0: threshold for torque reference|
|1 MPRO_ANA0_SThreshold|rev/min|ANA0: threshold for speed reference|
|2 MPRO_ANA0_PThreshold|mDegree|ANA0: threshold for position reference|
|MPRO_ANA0_TRamp| |ANA0: Torque mode acceleration [0] and deceleration [1]|
|0 MPRO_ANA0_TRamp|Nm/s| |
|1 MPRO_ANA0_TRamp|Nm/s| |
|MPRO_ANA0_SRamp| |ANA0: Speed mode acceleration [0] and deceleration [1]|
|0 MPRO_ANA0_SRamp|SPEED/s| |
|1 MPRO_ANA0_SRamp|SPEED/s| |

“Analog channel ISA00” parameters (continue)

|Index Name|Unit|Description|
|---|---|---|
|MPRO_ANA1_Scale| |ANA1: scale factors|
|0 MPRO_ANA1_TScale|Nm|ANA0: scale factor torque reference|
|1 MPRO_ANA1_SScale|rev/min|ANA0: scale factor speed reference|
|2 MPRO_ANA1_PScale|mDegree|ANA0: scale factor position reference|
|MPRO_ANA1_Offset| |ANA1: offsets|
|0 MPRO_ANA1_TOffset|Nm|ANA1: offsets for torque reference|
|1 MPRO_ANA1_SOffset|rev/min|ANA1: offsets for speed reference|
|2 MPRO_ANA1_POffset|mDegree|ANA1: offsets for position reference|
|MPRO_ANA1_Threshold| |ANA1: thresholds|
|0 MPRO_ANA1_TThreshold|Nm|ANA1: threshold for torque reference|
|1 MPRO_ANA1_SThreshold|rev/min|ANA1: threshold for speed reference|
|2 MPRO_ANA1_PThreshold|mDegree|ANA1: threshold for position reference|

“Analog channel ISA01” parameters

# 8 Motion profile

|ID|Index Name|Unit|Description|
|---|---|---|---|
|186|MPRO_ANA1_TRamp|Nm/s|ANA1: Torque mode acceleration [0] and deceleration[1]|
|186|MPRO_ANA1_TRamp|Nm/s| |
|187|MPRO_ANA1_SRamp|SPEED/s|ANA1: Speed mode acceleration [0] and deceleration [1]|
|187|MPRO_ANA1_SRamp|SPEED/s| |

# Table 8.27: “Analog channel ISA01” parameters (continue)

Display

- System state
- Initialization on device startup
- Not ready (DC link voltage possibly too low)
- Start inhibit (DC link voltage present, power stage off)
- Starting lockout
- Ready for start
- Control initialization: Auto commutation, flux build-up etc.

# Table 8.28: Central state machine according to CiA 402 device display

MOOG ID No.:CB40859-001 Date:11/2020

MSD ServoDrive - DeviceHelp 273

# 8 Motion profile

MOOG ID No.:CB40859-001 Date:11/2020

MSD ServoDrive - DeviceHelp 274

|Display|System state|power disabled|fault|
|---|---|---|---|
|Control enabled|0|Start|7|
| |fault reaction active|0|14|
|Quick stop active|1|not ready|8|
| |to switch on|1|17|
|Error reaction active|2|switch on|disabled|
| |2|7| |
|Error state (in this state the error is indicated directly on the display.)|3|ready to|switch on|
|Device is reset (display flashes)|power enabled|3|6|
| |10|12| |
|• Number [5.] flashes when “STO” (Safe Torque Off) input is active. Display goes out when STO inactive.| | | |
|• The dot on the display flashes when the power stage is active.| | | |

Table 8.28: Central state machine according to CiA 402 device display (continue)

NOTE

l The system states indicated on the display may differ from the states in the table depending on the drive profile setting.

Image 8.70: State machine diagram based on CANopen communications

⓪ to ① State number

1 to 17 State transition (No. 17: DC link voltage cut off)

Legend for “State machine diagram based on CANopen communications” figure

# 8.10 Touch probe

|ID|Index Name / Setting|
|---|---|
|241|0 MPRO_TP_Position|
|241|1 MPRO_TP_Position|
|241|2 MPRO_TP_Position|
|241|3 MPRO_TP_Position|
|241|4 MPRO_TP_Position|
|1400|0 MPRO_TP_Config|
| |TP_TP (0)|
| |AB (1)|
| |PD_UP (2)|
| |PD_DOWN (3)|
| |PC_PC (4)|
| |PC_TP (5)|
| |TP_PC (6)|
| |ENC_ENC (7)|
| |ENC_TP (8)|
| |TP_ENC (9)|

Using the touch probe inputs, touch probe functions can be performed. In order to be able to do this, P 106[0] - MPRO_INPUT_FS_ISD05 and P 107[0] - MPRO_INPUT_FS_ISD06 must be used to set digital inputs ISD05 and ISD06 to ""PROBE(15) = Touch probe (only ISD05/06)"" (see Section ""Digital inputs"" on page 290). HTL encoders can be evaluated or pulse counters implemented using the MSD PLC.

The touch probe can be triggered with P 240 - MPRO_TP_Ctrl. This enables triggering on a positive or negative edge, or on both edges, of the signal detected on the touch probe inputs. After the measurement, the parameter jumps back to the value ""NONE (0)"" and the latch position is mapped in the corresponding subindex of parameter P 241 - MPRO_TP_Position. A continuous touch probe mode is not possible at present, so the touch probe has to be reactivated after the measurement.

P 1402 - MPRO_TP_Channel can be used to select various positions as actual value sources of the latch position for the touch probe functionality. The following table provides an overview of the available settings. The counters are accessed via the MSD PLC or a bus system.

|ID|Index Name / Setting|Unit|Description|
|---|---|---|---|
|240|MPRO_TP_Ctrl|Touch probe: Control| |
| |0| |NONE (0) = No function|
| |1| |POS (1) = Positive edge|
| |2| |NEG (2) = Negative edge|
| |3| |BOTH (3) = Both edges|
|240|0 MPRO_TP_Ctrl| | |
|240|1 MPRO_TP_Ctrl| | |
|240|2 MPRO_TP_Ctrl| | |
|241|MPRO_TP_Position|Probe: Pos. high/low edge of TP0/1, encoder zero pulse| |

Table 8.29: “Touch probe” parameters

MOOG ID No.:CB40859-001 Date:11/2020

# 8 Motion profile

|Unit|Description|
|---|---|
|mDegree|Touch probe: Configuration|
|mDegree|TP0, TP1 touch probe|
|mDegree|TP0, TP1 as encoder, A/B as quadrature counting|
|mDegree|TP0, TP1 as encoder, pulse (TP0) / direction (TP1), count up on direction high|
|mDegree|TP0, TP1 as encoder, pulse (TP0) / direction (TP1), count down on direction high|
|mDegree|TP0 pulse counter, TP1 pulse counter|
|mDegree|TP0 pulse counter, TP1 touch probe|
|mDegree|TP1 touch probe, TP0 pulse counter|
|mDegree|TP0 encoder counter, TP1 encoder counter|
|mDegree|TP0 encoder counter, TP1 touch probe|
|mDegree|TP0 touch probe, TP1 encoder counter|

Touch probe: Channel

|Unit|Description|
|---|---|
|ACTPOS (0)|Actual position in user units|
|ACTPOSINC (1)|Actual position in increments|
|MASTERPOS (2)|Master position in increments|
|ENCPOS_CH1 (3)|Encoder position Channel 1|
|ENCPOS_CH1_INC (4)|Encoder position Channel 1 in increments|
|ENCPOS_CH2 (5)|Encoder position Channel 2|
|ENCPOS_CH2_INC (6)|Encoder position Channel 2 in increments|

# 8 Motion profile

MOOG ID No.:CB40859-001 Date:11/2020 MSD ServoDrive - DeviceHelp 276

|ID|Index Name / Setting|Unit|Description|
|---|---|---|---|
|7|ENCPOS_CH3 (7)| |Encoder position Channel 3|
|8|ENCPOS_CH3_INC (8)| |Encoder position Channel 3 in increments|
|9|ENCPOS_CH4 (9)| |Encoder position Channel 4|
|10|ENCPOS_CH4_INC (10)| |Encoder position Channel 4 in increments|
|11|ACTPOS2 (11)| |Actual position of redundant encoder in user units|
|12|Sercos (12)| |Referred to Sercos profile parameters S-x-0426, S-x-0427|
|13|UserRefPos(13)| |Reference position in user units|
|14|MasterPosST(14)| |Master position (ECAM, EGEAR) singleturn, always steps|
|15|CommonMasterPos(15)| |Master position (ECAM, EGEAR) singleturn, always steps|
|16|CommonMasterPosST(15)| |Master position (ECAM, EGEAR) singleturn, always steps|
|1402|MPRO_TP_Channel| | |
|1402|MPRO_TP_Channel| | |
|1402|MPRO_TP_Channel| | |
|1404|MPRO_TP_Lines| |Touch probe: Lines @ pulse counter on channel x|
|1404|MPRO_TP_Lines| | |
|1404|MPRO_TP_Lines| | |

Image 8.71: “Synchronized motion” screen

There are various modes available in the “synchronization mode” drop-down menu (P 242[0] - MPRO_ECAM_SyncModMode):

- Off(0) = Synchronized motion off
- ECAM_iPlc(1) = Electronic cam plate via MSD PLC
- EGEAR_iPlc(2) = Electr. gear unit via MSD PLC
- ECAM_PARA(3) = Electronic camming via parameters
- EGEAR_PARA(4) = Electronic gearing via parameters

NOTE: For more information refer to the bus system User Manuals or the description of the MSD PLC.

# 8.11.1 Electronic cam plate

The other parameters are configured in separate screens that can be accessed with the corresponding buttons.

- Master configuration (see Section ""Master configuration"" on page 280)
- Electronic gearing (see Section ""Electronic gearing"" on page 283)
- Electronic camming (see Section ""Electronic cam plate"" on page 277)

P 1318[0] - MPRO_ECAM_ControlWord is the control word for “synchronized motion” (see Section ""Control word for synchronized motion"" on page 279).

P 1326[0] - MPRO_ECAM_StatusWord is the status word for “synchronized motion” (see Section ""Status word for synchronized motion"" on page 279).

# 8.11.1.1 Table selection

|ID|Index Name|Unit|Description|
|---|---|---|---|
|1300|MPRO_ECAM_CTS_| |ECAM: CamTableSelect - Master reference|
|1301|MasterRef| | |
|1305|MPRO_ECAM_CTS_| |ECAM: CamTableSelect - Method for changing the camtable|
|1306|MPRO_ECAM_CTS_| |ECAM: CamTableSelect - Mode for changing the camtable|
|1307|MPRO_ECAM_CTS_|incr|ECAM: CamTableSelect - Distance for changing the camtable|
|242|MPRO_ECAM_| |ECAM / EGEAR: Mode of synchronized motion SyncModMode|
|265|MPRO_ECAM_| |ECAM / EGEAR: Slave speed factor (1 = 100%).|
|266|CamSlave_SpeedFactor| | |
|268|MPRO_ECAM_| |ECAM / EGEAR: Mode of switching off sync. motion|

# 8.11.1.2 Synchronization

|ID|Index Name|Unit|Description|
|---|---|---|---|
|1342|MPRO_ECAM_CI_|incr|ECAM: CamIn - Synchronization position (multiturn part)|
|1343|MPRO_ECAM_CO_|incr|ECAM: CamOut - Decoupling pos. (multiturn part)|
|1303|MPRO_ECAM_CI_|incr|ECAM: CamIn - Master offset|
|1308|MPRO_ECAM_CI_| |ECAM: CamIn - Master reference|
|1309|MPRO_ECAM_CI_| |ECAM: CamIn - Slave reference|
|1310|MPRO_ECAM_CI_| |ECAM: CamIn - Coupling mode|
|1311|MPRO_ECAM_CI_|incr|ECAM: CamIn - Coupling distance|
|1312|MPRO_ECAM_CI_|incr|ECAM: CamIn - Synchronization position|

Table 8.31: “Electronic camming - Table selection” parameters

Table 8.30: “Synchronized motion” parameters

Table 8.32: “Electronic camming - Synchronization” parameters

MOOG ID No.:CB40859-001 Date:11/2020

MSD ServoDrive - DeviceHelp 277

# 8 Motion profile

MOOG ID No.:CB40859-001 Date:11/2020 MSD ServoDrive - DeviceHelp 278

|ID|Index|Name|Unit|Description|
|---|---|---|---|---|
|1313|0|MPRO_ECAM_CO_SyncPosST|(singleturn part)|ECAM: CamOut - Slave reference|
|1314|0|MPRO_ECAM_CO_DecouplingMode|63|ECAM: CamOut - Decoupling mode|
|1315|0|MPRO_ECAM_CO_BreakingPosST|incr|ECAM: CamOut - Decoupling position|
|1316|0|MPRO_ECAM_CO_DecouplingDist|incr|ECAM: CamOut - Decoupling distance|
|1317|0|MPRO_ECAM_CO_StandstillPos|mDegree|ECAM: CamOut - Slave standstill position|

# Table 8.32: “Electronic camming - Synchronization” parameters (continue)

|ID|Index|Name|Unit|Description|
|---|---|---|---|---|
|1346| |MPRO_ECAM_SP_Table| |ECAM: Setpoint table interface|
|1346|0|Index| |Index of setpoint table|
|1346|1|Value| |Value at index of setpoint table|
|1347|0 to 31|MPRO_ECAM_SP_Index| |ECAM: Setpoint segments start index|
|1348|0 to 31|MPRO_ECAM_SP_Length| |ECAM: Setpoint segments length|
|1349|0 to 31|Length| | |
|1350|0|MPRO_ECAM_SP_MaDist| |ECAM: Setpoint segments master distance|
|1351|0|MPRO_ECAM_SP_IpoType| |ECAM: Setpoint segments interpolation type|
|1352|0 to 31|Checksum| |ECAM: Setpoint table checksum|
|1353|0 to 31|GainNum| |ECAM: Setpoint segments gain numerator|
| | |GainDen| |ECAM: Setpoint segments gain denominator|

# Table 8.33: “Electronic camming - Table segments” parameters

|ID|Index|Name|Unit|Description|
|---|---|---|---|---|
|1329|0 to 63|MPRO_ECAM_SegData_IndexNext| |ECAM: Index of the following segment|
|1330|0 to 63|MPRO_ECAM_SegData_IndexPrev| |ECAM: Index of the previous segment|
|1331|0 to 63|MPRO_ECAM_SegData_ProfileMode| |ECAM: Profile mode of the current segment|
|1332|0 to 63|MPRO_ECAM_SegData_DistMaster| |ECAM: Length of the master section of the current segment|
|1333|0 to 63|MPRO_ECAM_SegData_DistSlave| |ECAM: Length of the slave section of the current segment|
|1334|0 to 63|MPRO_ECAM_SegData_Lambda| |ECAM: Lambda value of the current segment|
|1335|0 to 63|MPRO_ECAM_SegData_StatusWord| |ECAM: Status word of the current segment|
|1336|0 to 63|MPRO_ECAM_SegData_ControlWord| |ECAM: Control word of the current segment|

# 8.11.2 Control word for synchronized motion

|Bit|Function|PLC function|Bit number|Description|
|---|---|---|---|---|
|0-7|Start segment (8-bit value)|-|0-7|Actual segment (8-bit value)|
|8-15|Reserved|-| |Actual ECAM / EGEAR state machine state (4 Bit value)|
|16|Absolute (true) / relative (false) master relationship|-| |- 0: ECAM / EGEAR asynchronous
- 1: ECAM / EGEAR synchronous
|
|17|Absolute (true) / relative (false) master (CAM) relationship at cam in|-| |- 2: ECAM / EGEAR synchronizing
- 3: ECAM / EGEAR desynchronizing
|
|18|Absolute (true) / relative (false) slave (CAM) relationship at cam in|-| |- 4: ECAM / EGEAR active and waiting for going asynchronous
|
|19-23|Reserved|-| |- 5: ECAM / EGEAR inactive and waiting for going synchronous
|
|24|Change gear ratio of the electronic gear online|MCB_GearRatioChange| | |
|25|Disable master calculation|MCB_Cam_MasterEnable| | |
|26|Enable master calculation|MCB_Cam_MasterEnable| | |
|27|Select CAM table|MCB_CamTableSelect| | |
|28|Start Ecam|MCB_CamIn| | |
|29|Stop Ecam|MCB_CamOut| | |
|30|Start Egear|MCB_GearIn| | |
|31|Stop Egear|MCB_GearOut| | |

# 8.11.3 Status word for synchronized motion

|Bit|Function|PLC function|Bit number|Description|
|---|---|---|---|---|
|12-26|Reserved|-| | |
|27|ECAM / EGEAR is active|-| | |
|28|Valid segments chosen|-| | |
|29|Master data are valid|-| | |
|30|Master is initialized|-| | |
|31|Master calculation is active|-| | |

Table 8.35: Control word ECAM (P 1318[0] - MPRO_ECAM_ControlWord)

Table 8.36: ECAM status word (P 1326[0] - MPRO_ECAM_StatusWord)

MOOG ID No.:CB40859-001 Date:11/2020 MSD ServoDrive - DeviceHelp 279

# 8 Motion profile

# 8 Motion profile

MOOG ID No.:CB40859-001 Date:11/2020

MSD ServoDrive - DeviceHelp 280

# 8.11.4 Master configuration

the master encoder, you will need to set the resolution relative to a single motor revolution in P 250 - MPRO_ECAM_PARAMaster_Amplitude (see below).

- ENC CH1 (3) = Encoder channel 1 X7 (Sin/Cos)
- ENC CH2 (4) = Encoder channel 2 X6 (Resolver)
- ENC CH3 (5) = Encoder channel 3 X8 (optional)

This function is only available if an external interface X8 (option module) is present.

- TP0 (6) = Pulse counter on probe channel 0 (TP0)
- TP1 (7) = Pulse counter on probe channel 1 (TP1)
- ENC_CH4 (8) = Encoder channel 4 (p. e. fieldbus)
- TWIN_POS (9) = TWIN remote reference position (P-2607)

Image 8.72: “Master configuration” screen

# Channel selection (master encoder)

P 1319[0] - MPRO_ECAM_CamMaster_AxisType is used to define the master encoder.

- NO AXIS (0) = No axis
- VIRTUAL MASTER (1) = Virtual master

If you select this function, you will be able to configure additional settings by clicking on the enabled “Options...” button (see Section ""Virtual Master"" on page 286).

- PARA (2) = Master parameter interface

If you select this function because a higher-level controller is being used as

# Anti-reverse mode

Slave only starts moving along with it again as soon as the master reaches the zero position.

P 1320[0] - MPRO_ECAM_CamMaster_RevLockMode is used to define the reverse lock mode, which can be used either with or without path compensation. The dashed lines in the following diagrams indicate what the engagement distance is:

# Example:

If the master, which has moved two motor revolutions in the direction blocked for the slave, then moves in the unblocked direction again, the slave only moves off when the master has traversed the zero point.

- INACTIVE (0) = Reverse lock inactive
- ACTIVE (2) = Reverse lock enabled - without path optimization
- ACTIVE WAY COMP (1) = Reverse lock active - with way compensation

While the slave accelerates to the speed of the master during engagement, the master and slave do not move synchronously. This function needs to be selected in order to quickly catch up to the master that is running ahead.

# Example:

- Master (black line) rotates in the blocked direction
- The slave (blue line) remains stopped
- Master rotates in the unblocked direction again
- The slave follows the master directly in the unblocked direction

Assume the master has moved two motor revolutions in the direction for which the slave lock is enabled. If the master now moves in the direction for which there is no lock, the slave will immediately start running in that direction.

MOOG ID No.:CB40859-001 Date:11/2020

MSD ServoDrive - DeviceHelp 281

# 8 Motion profile

MOOG ID No.:CB40859-001 Date:11/2020 MSD ServoDrive - DeviceHelp 282

|Filter type|ID|Index Name|Unit|Description|
|---|---|---|---|---|
|When using a real master encoder, encoder signals may be subject to noise.|P 1340|1319|0|MPRO_ECAM_CamMaster_AxisType|
| | |MPRO_ECAM_CamMaster_SpeedFilTyp| |ECAM / EGEAR: Channel selection of internal master input|
| | |1320|0|MPRO_ECAM_CamMaster_RevLockMode|
| | |1321|0|MPRO_ECAM_CamMaster_Amplitude|
| | |1322|0|MPRO_ECAM_CamMaster_GearNum|
| | |1323|0|MPRO_ECAM_CamMaster_GearDen|
|Filter time|1327|0|ms|ECAM / EGEAR: Filter time constant of master|
|If P 1340[0] is used to enable a filter, P 1327[0] - MPRO_ECAM_CamMaster_SpeedTFil can be used to define the corresponding filter time.|1328|0|speed|ECAM / EGEAR: Speed factor of the internal master|
|Speed factor|1340|0| |MPRO_ECAM_CamMaster_SpeedFilTyp|
|The master encoder can be assigned an additional speed factor P 1328[0] - MPRO_ECAM_CamMaster_SpeedFactor.|1341|0|incr|ECAM / EGEAR: Master drive offset|

Table 8.37: “Synchronized motion - Master configuration” parameters (continue)

| | | |ID|Index Name|Unit|Description|
|---|---|---|---|---|---|---|
|247|0|MPRO_ECAM_ParaMaster_ActPos|incr|ECAM / EGEAR: Parameter interface master position| | |
|248|0|MPRO_ECAM_ParaMaster_ActSpeed|rpm|ECAM / EGEAR: Parameter interface master speed| | |
|249|0|MPRO_ECAM_ParaMaster_ActAcc|rpm|ECAM / EGEAR: Parameter interface master acceleration| | |
| |250|0|MPRO_ECAM_ParaMaster_Amplitude| |ECAM / EGEAR: Parameter interface master amplitude| |

Table 8.37: “Synchronized motion - Master configuration” parameters

# 8.11.5 Electronic gearing

# Gear ratio

The gear ratio is specified as a fraction. This ensures that the position references can be translated to the motor shaft with no rounding error.

- ""Slave"" (P 252[0] - MPRO_ECAM_Egear_GearNum) is the numerator
- ""Master"" (P 251[0] - MPRO_ECAM_Egear_GearDen) is the denominator

# Scaling of speed pre-control

Defined with P 265[0] - MPRO_ECAM_CamSlave_SpeedFactor definiert.

# Scaling of torque pre-control

Defined with P 266[0] - MPRO_ECAM_CamSlave_TorqueFactor.

# Engagement

See Section ""Engagement"" on page 284.

# Disengagement

See Section ""Disengagement"" on page 285.

|ID|Index Name|Unit|Description|
|---|---|---|---|
|251|0 MPRO_ECAM_Egear_GearDen| |EGEAR: Gear denominator|
|252|0 MPRO_ECAM_Egear_GearNum| |EGEAR: Numerator of gear ratio|
|1344|0 MPRO_ECAM_Egear_LimRefAcc|rpm/s|EGEAR: Acceleration limit for reference|
|1345|0 MPRO_ECAM_Egear_LimRefJerk|rpm/s²|EGEAR: Jerk limit for reference|

Table 8.38: “Synchronized motion - Electronic gearing” parameters

Image 8.73: ""Electronic gearing"" screen

MOOG ID No.:CB40859-001 Date:11/2020 MSD ServoDrive - DeviceHelp 283

# 8 Motion profile

# 8 Motion profile

MOOG ID No.:CB40859-001 Date:11/2020

MSD ServoDrive - DeviceHelp 284

# 8.11.6 Engagement

used to define the engagement distance (between the dashed lines).

P 253[0] - MPRO_ECAM_Egear_GearInMode is used to define the mode for engagement.

- DIRECT (0) = Direct
- Direct engagement: Angular synchronous; with jerking (no ramps).
- CROSSFADE (3) = Crossfading
- Engagement with crossfading function (5th degree polynomial): Angular synchronous; jerk-limited; speed will overshoot during engagement.
- RAMP (1) = Linear speed ramp
- Engagement with linear acceleration: Not angular synchronous; with jerking.
- FADE (2) = Engagement fade-out
- Engagement with fade-in function (5th degree polynomial): Not angular synchronous; jerk-limited. The position is ignored. ",How is the wait time before the next motion task defined in the 'MSD ServoDrive - DeviceHelp' document?,A1,P 204 - MPRO_TAB_WaitTime is used to define the wait time.,1.6640625,1.65625,3.453125,1.2109375,0.265625
11,msd_servo_drive.txt,76,b87ca5e232c2bdbb6fa16a8a401c6b5d285dc0183e73cc9d134de13dd2fc71d2,"MOOG ID No.:CB40859-001 Date:11/2020

MSD ServoDrive - DeviceHelp 267

# 8 Motion profile

MOOG ID No.:CB40859-001 Date:11/2020 MSD ServoDrive - DeviceHelp 268

# Deceleration

With ...

- P 194 - MPRO_TAB_TDec (for torque control) or
- P 197 - MPRO_TAB_SDec (for speed control) or
- P 200 - MPRO_TAB_PDec (for position control)

and indexes 0–15, the deceleration for each individual motion task can be defined. The input must not be zero.

# Wait time in Auto mode

P 204 - MPRO_TAB_WaitTime is used to define the wait time before the next motion task is carried out.

# Maximum table index in Auto mode

P 206[0] - MPRO_Tab_MaxIdx is used to define the table index up to which driving jobs will be carried out in one of the auto modes.

# Current table index

P 207[0] - MPRO_Tab_ActIdx will show the index for the motion task that is currently active. If parameter P 205 MPRO_TAB_Mode is set to “Para(0)”, a driving set can be entered and approached directly.

# Activation of reference table

The following procedures can be used in order to activate the setpoint table for operation.

|ID|Index Name|Unit|Description|
|---|---|---|---|
|193|MPRO_TAB_TAcc|TAB: Torque mode acceleration|Nm/ms|
|193|0|MPRO_TAB_TAcc|Nm/ms|
|193|1 - 15|MPRO_TAB_TAcc|Nm/ms|
|194|MPRO_TAB_TDec|TAB: Torque mode deceleration| |
|194|0|MPRO_TAB_TDec|Nm/ms|
|194|1 - 15|MPRO_TAB_TDec|Nm/ms|

# Table 8.23: Activation of table references

# Table 8.24: “Setpoint table settings” parameters

# Table 8.24: “Setpoint table settings” parameters (continue)

|ID|Index Name|Unit|Description|ID|Index Name|Unit|Description|
|---|---|---|---|---|---|---|---|
|195|MPRO_TAB_TRef|Nm|TAB: Torque mode reference value|208|MPRO_TAB_OutputNo| |OSD TAB: actual table index and target|
|195|MPRO_TAB_TRef|Nm| |208|MPRO_TAB_OutputNo| | |
|196|MPRO_TAB_SAcc|rev/min/s|TAB: Speed mode acceleration|269|MPRO_TAB_Ctrl| |TAB: control word|
|196|MPRO_TAB_SAcc|rev/min/s| | | | | |
|197|MPRO_TAB_SDec|rev/min/s|TAB: Speed mode deceleration| | | | |
|197|MPRO_TAB_SDec|rev/min/s| | | | | |
|198|MPRO_TAB_SRef|rev/min|TAB: Speed mode reference value| | | | |
|198|MPRO_TAB_SRef|rev/min| | | | | |
|199|MPRO_TAB_PAcc|rev/min/s|TAB: Position control mode acceleration| | | | |
|199|MPRO_TAB_PAcc|rev/min/s| | | | | |
|200|MPRO_TAB_PDec|rev/min/s|TAB: Position control mode Acceleration| | | | |
|200|MPRO_TAB_PDec|rev/min/s| | | | | |
|201|MPRO_TAB_PSpd|rev/min|TAB: Position control mode speed| | | | |
|201|MPRO_TAB_PSpd|rev/min| | | | | |
|202|MPRO_TAB_PPos|mDegree|TAB: Position control mode reference value| | | | |
|202|MPRO_TAB_PPos|mDegree| | | | | |
|203|MPRO_TAB_PMode| |Position control table:Mode| | | | |
|203|MPRO_TAB_PMode| | | | | | |
|204|MPRO_TAB_WaitTime|ms|TAB: Wait time| | | | |
|204|MPRO_TAB_WaitTime|ms| | | | | |
|205|MPRO_TAB_Mode| |TAB mode| | | | |
|206|MPRO_Tab_MaxIdx| |TAB: Max index in AUTO mode| | | | |
|207|MPRO_TAB_ActIdx| |TAB: Actual index| | | | |

MOOG ID No.:CB40859-001 Date:11/2020

MSD ServoDrive - DeviceHelp

# 8 Motion profile

MOOG ID No.:CB40859-001 Date:11/2020

MSD ServoDrive - DeviceHelp 270

# 8.8 Analog channel (ISA00 und ISA01)

# Offset (O)

This parameter (P 174 - MPRO_ANA0_SOffset for ISA00, P 184 - MPRO_ANA1_SOffset for ISA01) compensates for component variations and is used for offset compensation purposes. Depending on the control mode being used (see Section ""Basic settings"" on page 110), the value will be stored in parameter index [0] (torque control), [1] (speed control) or [2] (position control).

# Backlash (B)

This parameter (P 175 - MPRO_ANA0_SThreshold for ISA00, P 185 - MPRO_ANA1_SThreshold for ISA01) can suppress axis motion close to the standstill (stop) position. Depending on the control mode being used (see Section ""Basic settings"" on page 110), the value will be stored in parameter index [0] (torque control), [1] (speed control) or [2] (position control).

Image 8.68: “Analog channel” screen

# Acceleration ramp

Two standard analog inputs (ISA00, ISA01) are available. These inputs can be configured...

- with negative values for analog setpoint settings
- with positive values for digital setpoint processing

(P 109[0] - MPRO_INPUT_FS_ISA00 and P 110[0] - MPRO_INPUT_FS_ISA01).

see also section ""Analog Inputs"" on page 303. By using the ""REV(-2) = Analog setpoint"" setting, an analog input voltage of ±10 V can be processed as a setpoint.

# Deceleration ramp

This parameter serves as a deceleration ramp for torque control (P 176[1] - MPRO_ANA0_TRamp for ISA00, P 186[1] - MPRO_ANA1_TRamp for ISA01) or speed control (P 177[1] - MPRO_ANA0_SRamp for ISA00, P 187[1] - MPRO_ANA1_SRamp for ISA01). Depending on the control mode being used (see Section ""Basic settings"" on page 110), the value will be stored in parameter index [0] (torque control), [1] (speed control) or [2] (position control).

This parameter (P 173 - MPRO_ANA0_Scale for ISA00, P 183 - MPRO_ANA1_Scale for ISA01) is used to define which speed / which torque / which position corresponds to the maximum analog value. Depending on the control mode being used (see Section ""Basic settings"" on page 110), the value will be stored in parameter index [0] (torque control), [1] (speed control) or [2] (position control).

# 8.8.1 Special characteristics of position control mode

A threshold value can also be specified which generates a run-on range around the last reference value. A ramp function calculates a motion profile for the position reference from pre-defined acceleration and speed limits.

The position references on the analog channel are not applied immediately, but dependent on a digital input. Accordingly, one of the ISD00 to ISD06 digital inputs must be set to a value of ""REFANAEN(28) = Enable analog reference value"" (see Section ""Digital inputs"" on page 290). The position setpoint being received will only be applied if the corresponding digital input is active. The acceleration is entered using P 173[0] - MPRO_ANA0_TScale or P 183[0] - MPRO_ANA1_TScale.

# 8.8.2 Wire Break Monitoring

P 399 - CON_ANAWireBrk_Th can be used to configure wire break monitoring for the analog inputs. For details see Section ""Wire Break Monitoring"" on page 306.

|Function|TLIM (-4)|OVR (-3)|REFV (-2)|leer (-1)|OFF (0)|
|---|---|---|---|---|---|
|Digital|(1)-(28)|(1)-(28)|(1)-(28)|(1)-(28)|(1)-(28)|
|Analog channel|Filter|Scale|Offset|Profile|generator|

Control

Image 8.69: Reference processing structure

MOOG ID No.:CB40859-001 Date:11/2020

MSD ServoDrive - DeviceHelp 271

# 8 Motion profile

# 8 Motion profile

MOOG ID No.:CB40859-001 Date:11/2020

|ID|Index Name|Unit|Description|ID|
|---|---|---|---|---|
|395|CON_ANA_Isaf_Scaled| |Analog inputs: Values (filt, norm, comp, scaled)|174|
|395|0 ISA00| |Scaled, compensated, filtered, normalized value|175|
|395|1 ISA01| |Scaled, compensated, filtered, normalized value| |
|396|CON_ANA_Scale_ThUpper| |Analog inputs: Upper scaling limits|175|
|396|0 ISA00|%|Upper scaling (@ 10 V) threshold|175|
|396|1 ISA01|%|Upper scaling (@ 10 V) threshold| |
|397|CON_ANA_Scale_ThZero| |Analog inputs: Zero scaling thresholds|176|
|397|0 ISA00|V|Zero scaling threshold (+/-)|176|
|397|1 ISA01|V|Zero scaling threshold (+/-)| |
|398|CON_ANA_Scale_ThLower| |Analog inputs: Lower scaling limits|177|
|398|0 ISA00|%|Lower scaling (@ zero threshold) threshold|177|
|398|1 ISA01|%|Lower scaling (@ zero threshold) threshold| |
|399|CON_ANA_WireBrk_Th| |Analog inputs: Wire break thresholds|Table 8.26:|
|399|0 ISA00|V|Wire break detection threshold| |
|399|1 ISA01|V|Wire break detection threshold| |
|405|0 CON_ANA_Filt0|ms|Analog input ISA00: Filter time constant (PT 1)|ID|
|408|CON_ANA_Isaf_Norm| |Analog inputs: Values (filt, norm)|183|
|408|0 ISA00| |Filtered, normalized value|183|
|408|1 ISA01| |Filtered, normalized value|183|

Table 8.25: “Analog channel” parameters

|ID|Index Name|Unit|Description|ID|
|---|---|---|---|---|
|173|MPRO_ANA0_Scale| |ANA0: scale factors|184|
|173|0 MPRO_ANA0_TScale|Nm|ANA0: scale factor torque reference|185|
|173|1 MPRO_ANA0_SScale|rev/min|ANA0: scale factor speed reference|185|
|173|2 MPRO_ANA0_PScale|mDegree|ANA0: scale factor position reference| |
|174|MPRO_ANA0_Offset| |ANA0: offsets|185|
|174|0 MPRO_ANA0_TOffset|Nm|ANA0: offsets for torque reference|185|

Table 8.26: “Analog channel ISA00” parameters

|Index Name|Unit|Description|
|---|---|---|
|1 MPRO_ANA0_SOffset|rev/min|ANA0: offsets for speed reference|
|2 MPRO_ANA0_POffset|mDegree|ANA0: offsets for position reference|
|MPRO_ANA0_Threshold| |ANA0: thresholds|
|0 MPRO_ANA0_TThreshold|Nm|ANA0: threshold for torque reference|
|1 MPRO_ANA0_SThreshold|rev/min|ANA0: threshold for speed reference|
|2 MPRO_ANA0_PThreshold|mDegree|ANA0: threshold for position reference|
|MPRO_ANA0_TRamp| |ANA0: Torque mode acceleration [0] and deceleration [1]|
|0 MPRO_ANA0_TRamp|Nm/s| |
|1 MPRO_ANA0_TRamp|Nm/s| |
|MPRO_ANA0_SRamp| |ANA0: Speed mode acceleration [0] and deceleration [1]|
|0 MPRO_ANA0_SRamp|SPEED/s| |
|1 MPRO_ANA0_SRamp|SPEED/s| |

“Analog channel ISA00” parameters (continue)

|Index Name|Unit|Description|
|---|---|---|
|MPRO_ANA1_Scale| |ANA1: scale factors|
|0 MPRO_ANA1_TScale|Nm|ANA0: scale factor torque reference|
|1 MPRO_ANA1_SScale|rev/min|ANA0: scale factor speed reference|
|2 MPRO_ANA1_PScale|mDegree|ANA0: scale factor position reference|
|MPRO_ANA1_Offset| |ANA1: offsets|
|0 MPRO_ANA1_TOffset|Nm|ANA1: offsets for torque reference|
|1 MPRO_ANA1_SOffset|rev/min|ANA1: offsets for speed reference|
|2 MPRO_ANA1_POffset|mDegree|ANA1: offsets for position reference|
|MPRO_ANA1_Threshold| |ANA1: thresholds|
|0 MPRO_ANA1_TThreshold|Nm|ANA1: threshold for torque reference|
|1 MPRO_ANA1_SThreshold|rev/min|ANA1: threshold for speed reference|
|2 MPRO_ANA1_PThreshold|mDegree|ANA1: threshold for position reference|

“Analog channel ISA01” parameters

# 8 Motion profile

|ID|Index Name|Unit|Description|
|---|---|---|---|
|186|MPRO_ANA1_TRamp|Nm/s|ANA1: Torque mode acceleration [0] and deceleration[1]|
|186|MPRO_ANA1_TRamp|Nm/s| |
|187|MPRO_ANA1_SRamp|SPEED/s|ANA1: Speed mode acceleration [0] and deceleration [1]|
|187|MPRO_ANA1_SRamp|SPEED/s| |

# Table 8.27: “Analog channel ISA01” parameters (continue)

Display

- System state
- Initialization on device startup
- Not ready (DC link voltage possibly too low)
- Start inhibit (DC link voltage present, power stage off)
- Starting lockout
- Ready for start
- Control initialization: Auto commutation, flux build-up etc.

# Table 8.28: Central state machine according to CiA 402 device display

MOOG ID No.:CB40859-001 Date:11/2020

MSD ServoDrive - DeviceHelp 273

# 8 Motion profile

MOOG ID No.:CB40859-001 Date:11/2020

MSD ServoDrive - DeviceHelp 274

|Display|System state|power disabled|fault|
|---|---|---|---|
|Control enabled|0|Start|7|
| |fault reaction active|0|14|
|Quick stop active|1|not ready|8|
| |to switch on|1|17|
|Error reaction active|2|switch on|disabled|
| |2|7| |
|Error state (in this state the error is indicated directly on the display.)|3|ready to|switch on|
|Device is reset (display flashes)|power enabled|3|6|
| |10|12| |
|• Number [5.] flashes when “STO” (Safe Torque Off) input is active. Display goes out when STO inactive.| | | |
|• The dot on the display flashes when the power stage is active.| | | |

Table 8.28: Central state machine according to CiA 402 device display (continue)

NOTE

l The system states indicated on the display may differ from the states in the table depending on the drive profile setting.

Image 8.70: State machine diagram based on CANopen communications

⓪ to ① State number

1 to 17 State transition (No. 17: DC link voltage cut off)

Legend for “State machine diagram based on CANopen communications” figure

# 8.10 Touch probe

|ID|Index Name / Setting|
|---|---|
|241|0 MPRO_TP_Position|
|241|1 MPRO_TP_Position|
|241|2 MPRO_TP_Position|
|241|3 MPRO_TP_Position|
|241|4 MPRO_TP_Position|
|1400|0 MPRO_TP_Config|
| |TP_TP (0)|
| |AB (1)|
| |PD_UP (2)|
| |PD_DOWN (3)|
| |PC_PC (4)|
| |PC_TP (5)|
| |TP_PC (6)|
| |ENC_ENC (7)|
| |ENC_TP (8)|
| |TP_ENC (9)|

Using the touch probe inputs, touch probe functions can be performed. In order to be able to do this, P 106[0] - MPRO_INPUT_FS_ISD05 and P 107[0] - MPRO_INPUT_FS_ISD06 must be used to set digital inputs ISD05 and ISD06 to ""PROBE(15) = Touch probe (only ISD05/06)"" (see Section ""Digital inputs"" on page 290). HTL encoders can be evaluated or pulse counters implemented using the MSD PLC.

The touch probe can be triggered with P 240 - MPRO_TP_Ctrl. This enables triggering on a positive or negative edge, or on both edges, of the signal detected on the touch probe inputs. After the measurement, the parameter jumps back to the value ""NONE (0)"" and the latch position is mapped in the corresponding subindex of parameter P 241 - MPRO_TP_Position. A continuous touch probe mode is not possible at present, so the touch probe has to be reactivated after the measurement.

P 1402 - MPRO_TP_Channel can be used to select various positions as actual value sources of the latch position for the touch probe functionality. The following table provides an overview of the available settings. The counters are accessed via the MSD PLC or a bus system.

|ID|Index Name / Setting|Unit|Description|
|---|---|---|---|
|240|MPRO_TP_Ctrl|Touch probe: Control| |
| |0| |NONE (0) = No function|
| |1| |POS (1) = Positive edge|
| |2| |NEG (2) = Negative edge|
| |3| |BOTH (3) = Both edges|
|240|0 MPRO_TP_Ctrl| | |
|240|1 MPRO_TP_Ctrl| | |
|240|2 MPRO_TP_Ctrl| | |
|241|MPRO_TP_Position|Probe: Pos. high/low edge of TP0/1, encoder zero pulse| |

Table 8.29: “Touch probe” parameters

MOOG ID No.:CB40859-001 Date:11/2020

# 8 Motion profile

|Unit|Description|
|---|---|
|mDegree|Touch probe: Configuration|
|mDegree|TP0, TP1 touch probe|
|mDegree|TP0, TP1 as encoder, A/B as quadrature counting|
|mDegree|TP0, TP1 as encoder, pulse (TP0) / direction (TP1), count up on direction high|
|mDegree|TP0, TP1 as encoder, pulse (TP0) / direction (TP1), count down on direction high|
|mDegree|TP0 pulse counter, TP1 pulse counter|
|mDegree|TP0 pulse counter, TP1 touch probe|
|mDegree|TP1 touch probe, TP0 pulse counter|
|mDegree|TP0 encoder counter, TP1 encoder counter|
|mDegree|TP0 encoder counter, TP1 touch probe|
|mDegree|TP0 touch probe, TP1 encoder counter|

Touch probe: Channel

|Unit|Description|
|---|---|
|ACTPOS (0)|Actual position in user units|
|ACTPOSINC (1)|Actual position in increments|
|MASTERPOS (2)|Master position in increments|
|ENCPOS_CH1 (3)|Encoder position Channel 1|
|ENCPOS_CH1_INC (4)|Encoder position Channel 1 in increments|
|ENCPOS_CH2 (5)|Encoder position Channel 2|
|ENCPOS_CH2_INC (6)|Encoder position Channel 2 in increments|

# 8 Motion profile

MOOG ID No.:CB40859-001 Date:11/2020 MSD ServoDrive - DeviceHelp 276

|ID|Index Name / Setting|Unit|Description|
|---|---|---|---|
|7|ENCPOS_CH3 (7)| |Encoder position Channel 3|
|8|ENCPOS_CH3_INC (8)| |Encoder position Channel 3 in increments|
|9|ENCPOS_CH4 (9)| |Encoder position Channel 4|
|10|ENCPOS_CH4_INC (10)| |Encoder position Channel 4 in increments|
|11|ACTPOS2 (11)| |Actual position of redundant encoder in user units|
|12|Sercos (12)| |Referred to Sercos profile parameters S-x-0426, S-x-0427|
|13|UserRefPos(13)| |Reference position in user units|
|14|MasterPosST(14)| |Master position (ECAM, EGEAR) singleturn, always steps|
|15|CommonMasterPos(15)| |Master position (ECAM, EGEAR) singleturn, always steps|
|16|CommonMasterPosST(15)| |Master position (ECAM, EGEAR) singleturn, always steps|
|1402|MPRO_TP_Channel| | |
|1402|MPRO_TP_Channel| | |
|1402|MPRO_TP_Channel| | |
|1404|MPRO_TP_Lines| |Touch probe: Lines @ pulse counter on channel x|
|1404|MPRO_TP_Lines| | |
|1404|MPRO_TP_Lines| | |

Image 8.71: “Synchronized motion” screen

There are various modes available in the “synchronization mode” drop-down menu (P 242[0] - MPRO_ECAM_SyncModMode):

- Off(0) = Synchronized motion off
- ECAM_iPlc(1) = Electronic cam plate via MSD PLC
- EGEAR_iPlc(2) = Electr. gear unit via MSD PLC
- ECAM_PARA(3) = Electronic camming via parameters
- EGEAR_PARA(4) = Electronic gearing via parameters

NOTE: For more information refer to the bus system User Manuals or the description of the MSD PLC.

# 8.11.1 Electronic cam plate

The other parameters are configured in separate screens that can be accessed with the corresponding buttons.

- Master configuration (see Section ""Master configuration"" on page 280)
- Electronic gearing (see Section ""Electronic gearing"" on page 283)
- Electronic camming (see Section ""Electronic cam plate"" on page 277)

P 1318[0] - MPRO_ECAM_ControlWord is the control word for “synchronized motion” (see Section ""Control word for synchronized motion"" on page 279).

P 1326[0] - MPRO_ECAM_StatusWord is the status word for “synchronized motion” (see Section ""Status word for synchronized motion"" on page 279).

# 8.11.1.1 Table selection

|ID|Index Name|Unit|Description|
|---|---|---|---|
|1300|MPRO_ECAM_CTS_| |ECAM: CamTableSelect - Master reference|
|1301|MasterRef| | |
|1305|MPRO_ECAM_CTS_| |ECAM: CamTableSelect - Method for changing the camtable|
|1306|MPRO_ECAM_CTS_| |ECAM: CamTableSelect - Mode for changing the camtable|
|1307|MPRO_ECAM_CTS_|incr|ECAM: CamTableSelect - Distance for changing the camtable|
|242|MPRO_ECAM_| |ECAM / EGEAR: Mode of synchronized motion SyncModMode|
|265|MPRO_ECAM_| |ECAM / EGEAR: Slave speed factor (1 = 100%).|
|266|CamSlave_SpeedFactor| | |
|268|MPRO_ECAM_| |ECAM / EGEAR: Mode of switching off sync. motion|

# 8.11.1.2 Synchronization

|ID|Index Name|Unit|Description|
|---|---|---|---|
|1342|MPRO_ECAM_CI_|incr|ECAM: CamIn - Synchronization position (multiturn part)|
|1343|MPRO_ECAM_CO_|incr|ECAM: CamOut - Decoupling pos. (multiturn part)|
|1303|MPRO_ECAM_CI_|incr|ECAM: CamIn - Master offset|
|1308|MPRO_ECAM_CI_| |ECAM: CamIn - Master reference|
|1309|MPRO_ECAM_CI_| |ECAM: CamIn - Slave reference|
|1310|MPRO_ECAM_CI_| |ECAM: CamIn - Coupling mode|
|1311|MPRO_ECAM_CI_|incr|ECAM: CamIn - Coupling distance|
|1312|MPRO_ECAM_CI_|incr|ECAM: CamIn - Synchronization position|

Table 8.31: “Electronic camming - Table selection” parameters

Table 8.30: “Synchronized motion” parameters

Table 8.32: “Electronic camming - Synchronization” parameters

MOOG ID No.:CB40859-001 Date:11/2020

MSD ServoDrive - DeviceHelp 277

# 8 Motion profile

MOOG ID No.:CB40859-001 Date:11/2020 MSD ServoDrive - DeviceHelp 278

|ID|Index|Name|Unit|Description|
|---|---|---|---|---|
|1313|0|MPRO_ECAM_CO_SyncPosST|(singleturn part)|ECAM: CamOut - Slave reference|
|1314|0|MPRO_ECAM_CO_DecouplingMode|63|ECAM: CamOut - Decoupling mode|
|1315|0|MPRO_ECAM_CO_BreakingPosST|incr|ECAM: CamOut - Decoupling position|
|1316|0|MPRO_ECAM_CO_DecouplingDist|incr|ECAM: CamOut - Decoupling distance|
|1317|0|MPRO_ECAM_CO_StandstillPos|mDegree|ECAM: CamOut - Slave standstill position|

# Table 8.32: “Electronic camming - Synchronization” parameters (continue)

|ID|Index|Name|Unit|Description|
|---|---|---|---|---|
|1346| |MPRO_ECAM_SP_Table| |ECAM: Setpoint table interface|
|1346|0|Index| |Index of setpoint table|
|1346|1|Value| |Value at index of setpoint table|
|1347|0 to 31|MPRO_ECAM_SP_Index| |ECAM: Setpoint segments start index|
|1348|0 to 31|MPRO_ECAM_SP_Length| |ECAM: Setpoint segments length|
|1349|0 to 31|Length| | |
|1350|0|MPRO_ECAM_SP_MaDist| |ECAM: Setpoint segments master distance|
|1351|0|MPRO_ECAM_SP_IpoType| |ECAM: Setpoint segments interpolation type|
|1352|0 to 31|Checksum| |ECAM: Setpoint table checksum|
|1353|0 to 31|GainNum| |ECAM: Setpoint segments gain numerator|
| | |GainDen| |ECAM: Setpoint segments gain denominator|

# Table 8.33: “Electronic camming - Table segments” parameters

|ID|Index|Name|Unit|Description|
|---|---|---|---|---|
|1329|0 to 63|MPRO_ECAM_SegData_IndexNext| |ECAM: Index of the following segment|
|1330|0 to 63|MPRO_ECAM_SegData_IndexPrev| |ECAM: Index of the previous segment|
|1331|0 to 63|MPRO_ECAM_SegData_ProfileMode| |ECAM: Profile mode of the current segment|
|1332|0 to 63|MPRO_ECAM_SegData_DistMaster| |ECAM: Length of the master section of the current segment|
|1333|0 to 63|MPRO_ECAM_SegData_DistSlave| |ECAM: Length of the slave section of the current segment|
|1334|0 to 63|MPRO_ECAM_SegData_Lambda| |ECAM: Lambda value of the current segment|
|1335|0 to 63|MPRO_ECAM_SegData_StatusWord| |ECAM: Status word of the current segment|
|1336|0 to 63|MPRO_ECAM_SegData_ControlWord| |ECAM: Control word of the current segment|

# 8.11.2 Control word for synchronized motion

|Bit|Function|PLC function|Bit number|Description|
|---|---|---|---|---|
|0-7|Start segment (8-bit value)|-|0-7|Actual segment (8-bit value)|
|8-15|Reserved|-| |Actual ECAM / EGEAR state machine state (4 Bit value)|
|16|Absolute (true) / relative (false) master relationship|-| |- 0: ECAM / EGEAR asynchronous
- 1: ECAM / EGEAR synchronous
|
|17|Absolute (true) / relative (false) master (CAM) relationship at cam in|-| |- 2: ECAM / EGEAR synchronizing
- 3: ECAM / EGEAR desynchronizing
|
|18|Absolute (true) / relative (false) slave (CAM) relationship at cam in|-| |- 4: ECAM / EGEAR active and waiting for going asynchronous
|
|19-23|Reserved|-| |- 5: ECAM / EGEAR inactive and waiting for going synchronous
|
|24|Change gear ratio of the electronic gear online|MCB_GearRatioChange| | |
|25|Disable master calculation|MCB_Cam_MasterEnable| | |
|26|Enable master calculation|MCB_Cam_MasterEnable| | |
|27|Select CAM table|MCB_CamTableSelect| | |
|28|Start Ecam|MCB_CamIn| | |
|29|Stop Ecam|MCB_CamOut| | |
|30|Start Egear|MCB_GearIn| | |
|31|Stop Egear|MCB_GearOut| | |

# 8.11.3 Status word for synchronized motion

|Bit|Function|PLC function|Bit number|Description|
|---|---|---|---|---|
|12-26|Reserved|-| | |
|27|ECAM / EGEAR is active|-| | |
|28|Valid segments chosen|-| | |
|29|Master data are valid|-| | |
|30|Master is initialized|-| | |
|31|Master calculation is active|-| | |

Table 8.35: Control word ECAM (P 1318[0] - MPRO_ECAM_ControlWord)

Table 8.36: ECAM status word (P 1326[0] - MPRO_ECAM_StatusWord)

MOOG ID No.:CB40859-001 Date:11/2020 MSD ServoDrive - DeviceHelp 279

# 8 Motion profile

# 8 Motion profile

MOOG ID No.:CB40859-001 Date:11/2020

MSD ServoDrive - DeviceHelp 280

# 8.11.4 Master configuration

the master encoder, you will need to set the resolution relative to a single motor revolution in P 250 - MPRO_ECAM_PARAMaster_Amplitude (see below).

- ENC CH1 (3) = Encoder channel 1 X7 (Sin/Cos)
- ENC CH2 (4) = Encoder channel 2 X6 (Resolver)
- ENC CH3 (5) = Encoder channel 3 X8 (optional)

This function is only available if an external interface X8 (option module) is present.

- TP0 (6) = Pulse counter on probe channel 0 (TP0)
- TP1 (7) = Pulse counter on probe channel 1 (TP1)
- ENC_CH4 (8) = Encoder channel 4 (p. e. fieldbus)
- TWIN_POS (9) = TWIN remote reference position (P-2607)

Image 8.72: “Master configuration” screen

# Channel selection (master encoder)

P 1319[0] - MPRO_ECAM_CamMaster_AxisType is used to define the master encoder.

- NO AXIS (0) = No axis
- VIRTUAL MASTER (1) = Virtual master

If you select this function, you will be able to configure additional settings by clicking on the enabled “Options...” button (see Section ""Virtual Master"" on page 286).

- PARA (2) = Master parameter interface

If you select this function because a higher-level controller is being used as

# Anti-reverse mode

Slave only starts moving along with it again as soon as the master reaches the zero position.

P 1320[0] - MPRO_ECAM_CamMaster_RevLockMode is used to define the reverse lock mode, which can be used either with or without path compensation. The dashed lines in the following diagrams indicate what the engagement distance is:

# Example:

If the master, which has moved two motor revolutions in the direction blocked for the slave, then moves in the unblocked direction again, the slave only moves off when the master has traversed the zero point.

- INACTIVE (0) = Reverse lock inactive
- ACTIVE (2) = Reverse lock enabled - without path optimization
- ACTIVE WAY COMP (1) = Reverse lock active - with way compensation

While the slave accelerates to the speed of the master during engagement, the master and slave do not move synchronously. This function needs to be selected in order to quickly catch up to the master that is running ahead.

# Example:

- Master (black line) rotates in the blocked direction
- The slave (blue line) remains stopped
- Master rotates in the unblocked direction again
- The slave follows the master directly in the unblocked direction

Assume the master has moved two motor revolutions in the direction for which the slave lock is enabled. If the master now moves in the direction for which there is no lock, the slave will immediately start running in that direction.

MOOG ID No.:CB40859-001 Date:11/2020

MSD ServoDrive - DeviceHelp 281

# 8 Motion profile

MOOG ID No.:CB40859-001 Date:11/2020 MSD ServoDrive - DeviceHelp 282

|Filter type|ID|Index Name|Unit|Description|
|---|---|---|---|---|
|When using a real master encoder, encoder signals may be subject to noise.|P 1340|1319|0|MPRO_ECAM_CamMaster_AxisType|
| | |MPRO_ECAM_CamMaster_SpeedFilTyp| |ECAM / EGEAR: Channel selection of internal master input|
| | |1320|0|MPRO_ECAM_CamMaster_RevLockMode|
| | |1321|0|MPRO_ECAM_CamMaster_Amplitude|
| | |1322|0|MPRO_ECAM_CamMaster_GearNum|
| | |1323|0|MPRO_ECAM_CamMaster_GearDen|
|Filter time|1327|0|ms|ECAM / EGEAR: Filter time constant of master|
|If P 1340[0] is used to enable a filter, P 1327[0] - MPRO_ECAM_CamMaster_SpeedTFil can be used to define the corresponding filter time.|1328|0|speed|ECAM / EGEAR: Speed factor of the internal master|
|Speed factor|1340|0| |MPRO_ECAM_CamMaster_SpeedFilTyp|
|The master encoder can be assigned an additional speed factor P 1328[0] - MPRO_ECAM_CamMaster_SpeedFactor.|1341|0|incr|ECAM / EGEAR: Master drive offset|

Table 8.37: “Synchronized motion - Master configuration” parameters (continue)

| | | |ID|Index Name|Unit|Description|
|---|---|---|---|---|---|---|
|247|0|MPRO_ECAM_ParaMaster_ActPos|incr|ECAM / EGEAR: Parameter interface master position| | |
|248|0|MPRO_ECAM_ParaMaster_ActSpeed|rpm|ECAM / EGEAR: Parameter interface master speed| | |
|249|0|MPRO_ECAM_ParaMaster_ActAcc|rpm|ECAM / EGEAR: Parameter interface master acceleration| | |
| |250|0|MPRO_ECAM_ParaMaster_Amplitude| |ECAM / EGEAR: Parameter interface master amplitude| |

Table 8.37: “Synchronized motion - Master configuration” parameters

# 8.11.5 Electronic gearing

# Gear ratio

The gear ratio is specified as a fraction. This ensures that the position references can be translated to the motor shaft with no rounding error.

- ""Slave"" (P 252[0] - MPRO_ECAM_Egear_GearNum) is the numerator
- ""Master"" (P 251[0] - MPRO_ECAM_Egear_GearDen) is the denominator

# Scaling of speed pre-control

Defined with P 265[0] - MPRO_ECAM_CamSlave_SpeedFactor definiert.

# Scaling of torque pre-control

Defined with P 266[0] - MPRO_ECAM_CamSlave_TorqueFactor.

# Engagement

See Section ""Engagement"" on page 284.

# Disengagement

See Section ""Disengagement"" on page 285.

|ID|Index Name|Unit|Description|
|---|---|---|---|
|251|0 MPRO_ECAM_Egear_GearDen| |EGEAR: Gear denominator|
|252|0 MPRO_ECAM_Egear_GearNum| |EGEAR: Numerator of gear ratio|
|1344|0 MPRO_ECAM_Egear_LimRefAcc|rpm/s|EGEAR: Acceleration limit for reference|
|1345|0 MPRO_ECAM_Egear_LimRefJerk|rpm/s²|EGEAR: Jerk limit for reference|

Table 8.38: “Synchronized motion - Electronic gearing” parameters

Image 8.73: ""Electronic gearing"" screen

MOOG ID No.:CB40859-001 Date:11/2020 MSD ServoDrive - DeviceHelp 283

# 8 Motion profile

# 8 Motion profile

MOOG ID No.:CB40859-001 Date:11/2020

MSD ServoDrive - DeviceHelp 284

# 8.11.6 Engagement

used to define the engagement distance (between the dashed lines).

P 253[0] - MPRO_ECAM_Egear_GearInMode is used to define the mode for engagement.

- DIRECT (0) = Direct
- Direct engagement: Angular synchronous; with jerking (no ramps).
- CROSSFADE (3) = Crossfading
- Engagement with crossfading function (5th degree polynomial): Angular synchronous; jerk-limited; speed will overshoot during engagement.
- RAMP (1) = Linear speed ramp
- Engagement with linear acceleration: Not angular synchronous; with jerking.
- FADE (2) = Engagement fade-out
- Engagement with fade-in function (5th degree polynomial): Not angular synchronous; jerk-limited. The position is ignored. ",How is the wait time before the next motion task defined in the 'MSD ServoDrive - DeviceHelp' document?,A2,The wait time is set using parameter P 204.,1.8984375,1.9609375,3.765625,1.0859375,0.158203125
12,msd_servo_drive.txt,76,b87ca5e232c2bdbb6fa16a8a401c6b5d285dc0183e73cc9d134de13dd2fc71d2,"MOOG ID No.:CB40859-001 Date:11/2020

MSD ServoDrive - DeviceHelp 267

# 8 Motion profile

MOOG ID No.:CB40859-001 Date:11/2020 MSD ServoDrive - DeviceHelp 268

# Deceleration

With ...

- P 194 - MPRO_TAB_TDec (for torque control) or
- P 197 - MPRO_TAB_SDec (for speed control) or
- P 200 - MPRO_TAB_PDec (for position control)

and indexes 0–15, the deceleration for each individual motion task can be defined. The input must not be zero.

# Wait time in Auto mode

P 204 - MPRO_TAB_WaitTime is used to define the wait time before the next motion task is carried out.

# Maximum table index in Auto mode

P 206[0] - MPRO_Tab_MaxIdx is used to define the table index up to which driving jobs will be carried out in one of the auto modes.

# Current table index

P 207[0] - MPRO_Tab_ActIdx will show the index for the motion task that is currently active. If parameter P 205 MPRO_TAB_Mode is set to “Para(0)”, a driving set can be entered and approached directly.

# Activation of reference table

The following procedures can be used in order to activate the setpoint table for operation.

|ID|Index Name|Unit|Description|
|---|---|---|---|
|193|MPRO_TAB_TAcc|TAB: Torque mode acceleration|Nm/ms|
|193|0|MPRO_TAB_TAcc|Nm/ms|
|193|1 - 15|MPRO_TAB_TAcc|Nm/ms|
|194|MPRO_TAB_TDec|TAB: Torque mode deceleration| |
|194|0|MPRO_TAB_TDec|Nm/ms|
|194|1 - 15|MPRO_TAB_TDec|Nm/ms|

# Table 8.23: Activation of table references

# Table 8.24: “Setpoint table settings” parameters

# Table 8.24: “Setpoint table settings” parameters (continue)

|ID|Index Name|Unit|Description|ID|Index Name|Unit|Description|
|---|---|---|---|---|---|---|---|
|195|MPRO_TAB_TRef|Nm|TAB: Torque mode reference value|208|MPRO_TAB_OutputNo| |OSD TAB: actual table index and target|
|195|MPRO_TAB_TRef|Nm| |208|MPRO_TAB_OutputNo| | |
|196|MPRO_TAB_SAcc|rev/min/s|TAB: Speed mode acceleration|269|MPRO_TAB_Ctrl| |TAB: control word|
|196|MPRO_TAB_SAcc|rev/min/s| | | | | |
|197|MPRO_TAB_SDec|rev/min/s|TAB: Speed mode deceleration| | | | |
|197|MPRO_TAB_SDec|rev/min/s| | | | | |
|198|MPRO_TAB_SRef|rev/min|TAB: Speed mode reference value| | | | |
|198|MPRO_TAB_SRef|rev/min| | | | | |
|199|MPRO_TAB_PAcc|rev/min/s|TAB: Position control mode acceleration| | | | |
|199|MPRO_TAB_PAcc|rev/min/s| | | | | |
|200|MPRO_TAB_PDec|rev/min/s|TAB: Position control mode Acceleration| | | | |
|200|MPRO_TAB_PDec|rev/min/s| | | | | |
|201|MPRO_TAB_PSpd|rev/min|TAB: Position control mode speed| | | | |
|201|MPRO_TAB_PSpd|rev/min| | | | | |
|202|MPRO_TAB_PPos|mDegree|TAB: Position control mode reference value| | | | |
|202|MPRO_TAB_PPos|mDegree| | | | | |
|203|MPRO_TAB_PMode| |Position control table:Mode| | | | |
|203|MPRO_TAB_PMode| | | | | | |
|204|MPRO_TAB_WaitTime|ms|TAB: Wait time| | | | |
|204|MPRO_TAB_WaitTime|ms| | | | | |
|205|MPRO_TAB_Mode| |TAB mode| | | | |
|206|MPRO_Tab_MaxIdx| |TAB: Max index in AUTO mode| | | | |
|207|MPRO_TAB_ActIdx| |TAB: Actual index| | | | |

MOOG ID No.:CB40859-001 Date:11/2020

MSD ServoDrive - DeviceHelp

# 8 Motion profile

MOOG ID No.:CB40859-001 Date:11/2020

MSD ServoDrive - DeviceHelp 270

# 8.8 Analog channel (ISA00 und ISA01)

# Offset (O)

This parameter (P 174 - MPRO_ANA0_SOffset for ISA00, P 184 - MPRO_ANA1_SOffset for ISA01) compensates for component variations and is used for offset compensation purposes. Depending on the control mode being used (see Section ""Basic settings"" on page 110), the value will be stored in parameter index [0] (torque control), [1] (speed control) or [2] (position control).

# Backlash (B)

This parameter (P 175 - MPRO_ANA0_SThreshold for ISA00, P 185 - MPRO_ANA1_SThreshold for ISA01) can suppress axis motion close to the standstill (stop) position. Depending on the control mode being used (see Section ""Basic settings"" on page 110), the value will be stored in parameter index [0] (torque control), [1] (speed control) or [2] (position control).

Image 8.68: “Analog channel” screen

# Acceleration ramp

Two standard analog inputs (ISA00, ISA01) are available. These inputs can be configured...

- with negative values for analog setpoint settings
- with positive values for digital setpoint processing

(P 109[0] - MPRO_INPUT_FS_ISA00 and P 110[0] - MPRO_INPUT_FS_ISA01).

see also section ""Analog Inputs"" on page 303. By using the ""REV(-2) = Analog setpoint"" setting, an analog input voltage of ±10 V can be processed as a setpoint.

# Deceleration ramp

This parameter serves as a deceleration ramp for torque control (P 176[1] - MPRO_ANA0_TRamp for ISA00, P 186[1] - MPRO_ANA1_TRamp for ISA01) or speed control (P 177[1] - MPRO_ANA0_SRamp for ISA00, P 187[1] - MPRO_ANA1_SRamp for ISA01). Depending on the control mode being used (see Section ""Basic settings"" on page 110), the value will be stored in parameter index [0] (torque control), [1] (speed control) or [2] (position control).

This parameter (P 173 - MPRO_ANA0_Scale for ISA00, P 183 - MPRO_ANA1_Scale for ISA01) is used to define which speed / which torque / which position corresponds to the maximum analog value. Depending on the control mode being used (see Section ""Basic settings"" on page 110), the value will be stored in parameter index [0] (torque control), [1] (speed control) or [2] (position control).

# 8.8.1 Special characteristics of position control mode

A threshold value can also be specified which generates a run-on range around the last reference value. A ramp function calculates a motion profile for the position reference from pre-defined acceleration and speed limits.

The position references on the analog channel are not applied immediately, but dependent on a digital input. Accordingly, one of the ISD00 to ISD06 digital inputs must be set to a value of ""REFANAEN(28) = Enable analog reference value"" (see Section ""Digital inputs"" on page 290). The position setpoint being received will only be applied if the corresponding digital input is active. The acceleration is entered using P 173[0] - MPRO_ANA0_TScale or P 183[0] - MPRO_ANA1_TScale.

# 8.8.2 Wire Break Monitoring

P 399 - CON_ANAWireBrk_Th can be used to configure wire break monitoring for the analog inputs. For details see Section ""Wire Break Monitoring"" on page 306.

|Function|TLIM (-4)|OVR (-3)|REFV (-2)|leer (-1)|OFF (0)|
|---|---|---|---|---|---|
|Digital|(1)-(28)|(1)-(28)|(1)-(28)|(1)-(28)|(1)-(28)|
|Analog channel|Filter|Scale|Offset|Profile|generator|

Control

Image 8.69: Reference processing structure

MOOG ID No.:CB40859-001 Date:11/2020

MSD ServoDrive - DeviceHelp 271

# 8 Motion profile

# 8 Motion profile

MOOG ID No.:CB40859-001 Date:11/2020

|ID|Index Name|Unit|Description|ID|
|---|---|---|---|---|
|395|CON_ANA_Isaf_Scaled| |Analog inputs: Values (filt, norm, comp, scaled)|174|
|395|0 ISA00| |Scaled, compensated, filtered, normalized value|175|
|395|1 ISA01| |Scaled, compensated, filtered, normalized value| |
|396|CON_ANA_Scale_ThUpper| |Analog inputs: Upper scaling limits|175|
|396|0 ISA00|%|Upper scaling (@ 10 V) threshold|175|
|396|1 ISA01|%|Upper scaling (@ 10 V) threshold| |
|397|CON_ANA_Scale_ThZero| |Analog inputs: Zero scaling thresholds|176|
|397|0 ISA00|V|Zero scaling threshold (+/-)|176|
|397|1 ISA01|V|Zero scaling threshold (+/-)| |
|398|CON_ANA_Scale_ThLower| |Analog inputs: Lower scaling limits|177|
|398|0 ISA00|%|Lower scaling (@ zero threshold) threshold|177|
|398|1 ISA01|%|Lower scaling (@ zero threshold) threshold| |
|399|CON_ANA_WireBrk_Th| |Analog inputs: Wire break thresholds|Table 8.26:|
|399|0 ISA00|V|Wire break detection threshold| |
|399|1 ISA01|V|Wire break detection threshold| |
|405|0 CON_ANA_Filt0|ms|Analog input ISA00: Filter time constant (PT 1)|ID|
|408|CON_ANA_Isaf_Norm| |Analog inputs: Values (filt, norm)|183|
|408|0 ISA00| |Filtered, normalized value|183|
|408|1 ISA01| |Filtered, normalized value|183|

Table 8.25: “Analog channel” parameters

|ID|Index Name|Unit|Description|ID|
|---|---|---|---|---|
|173|MPRO_ANA0_Scale| |ANA0: scale factors|184|
|173|0 MPRO_ANA0_TScale|Nm|ANA0: scale factor torque reference|185|
|173|1 MPRO_ANA0_SScale|rev/min|ANA0: scale factor speed reference|185|
|173|2 MPRO_ANA0_PScale|mDegree|ANA0: scale factor position reference| |
|174|MPRO_ANA0_Offset| |ANA0: offsets|185|
|174|0 MPRO_ANA0_TOffset|Nm|ANA0: offsets for torque reference|185|

Table 8.26: “Analog channel ISA00” parameters

|Index Name|Unit|Description|
|---|---|---|
|1 MPRO_ANA0_SOffset|rev/min|ANA0: offsets for speed reference|
|2 MPRO_ANA0_POffset|mDegree|ANA0: offsets for position reference|
|MPRO_ANA0_Threshold| |ANA0: thresholds|
|0 MPRO_ANA0_TThreshold|Nm|ANA0: threshold for torque reference|
|1 MPRO_ANA0_SThreshold|rev/min|ANA0: threshold for speed reference|
|2 MPRO_ANA0_PThreshold|mDegree|ANA0: threshold for position reference|
|MPRO_ANA0_TRamp| |ANA0: Torque mode acceleration [0] and deceleration [1]|
|0 MPRO_ANA0_TRamp|Nm/s| |
|1 MPRO_ANA0_TRamp|Nm/s| |
|MPRO_ANA0_SRamp| |ANA0: Speed mode acceleration [0] and deceleration [1]|
|0 MPRO_ANA0_SRamp|SPEED/s| |
|1 MPRO_ANA0_SRamp|SPEED/s| |

“Analog channel ISA00” parameters (continue)

|Index Name|Unit|Description|
|---|---|---|
|MPRO_ANA1_Scale| |ANA1: scale factors|
|0 MPRO_ANA1_TScale|Nm|ANA0: scale factor torque reference|
|1 MPRO_ANA1_SScale|rev/min|ANA0: scale factor speed reference|
|2 MPRO_ANA1_PScale|mDegree|ANA0: scale factor position reference|
|MPRO_ANA1_Offset| |ANA1: offsets|
|0 MPRO_ANA1_TOffset|Nm|ANA1: offsets for torque reference|
|1 MPRO_ANA1_SOffset|rev/min|ANA1: offsets for speed reference|
|2 MPRO_ANA1_POffset|mDegree|ANA1: offsets for position reference|
|MPRO_ANA1_Threshold| |ANA1: thresholds|
|0 MPRO_ANA1_TThreshold|Nm|ANA1: threshold for torque reference|
|1 MPRO_ANA1_SThreshold|rev/min|ANA1: threshold for speed reference|
|2 MPRO_ANA1_PThreshold|mDegree|ANA1: threshold for position reference|

“Analog channel ISA01” parameters

# 8 Motion profile

|ID|Index Name|Unit|Description|
|---|---|---|---|
|186|MPRO_ANA1_TRamp|Nm/s|ANA1: Torque mode acceleration [0] and deceleration[1]|
|186|MPRO_ANA1_TRamp|Nm/s| |
|187|MPRO_ANA1_SRamp|SPEED/s|ANA1: Speed mode acceleration [0] and deceleration [1]|
|187|MPRO_ANA1_SRamp|SPEED/s| |

# Table 8.27: “Analog channel ISA01” parameters (continue)

Display

- System state
- Initialization on device startup
- Not ready (DC link voltage possibly too low)
- Start inhibit (DC link voltage present, power stage off)
- Starting lockout
- Ready for start
- Control initialization: Auto commutation, flux build-up etc.

# Table 8.28: Central state machine according to CiA 402 device display

MOOG ID No.:CB40859-001 Date:11/2020

MSD ServoDrive - DeviceHelp 273

# 8 Motion profile

MOOG ID No.:CB40859-001 Date:11/2020

MSD ServoDrive - DeviceHelp 274

|Display|System state|power disabled|fault|
|---|---|---|---|
|Control enabled|0|Start|7|
| |fault reaction active|0|14|
|Quick stop active|1|not ready|8|
| |to switch on|1|17|
|Error reaction active|2|switch on|disabled|
| |2|7| |
|Error state (in this state the error is indicated directly on the display.)|3|ready to|switch on|
|Device is reset (display flashes)|power enabled|3|6|
| |10|12| |
|• Number [5.] flashes when “STO” (Safe Torque Off) input is active. Display goes out when STO inactive.| | | |
|• The dot on the display flashes when the power stage is active.| | | |

Table 8.28: Central state machine according to CiA 402 device display (continue)

NOTE

l The system states indicated on the display may differ from the states in the table depending on the drive profile setting.

Image 8.70: State machine diagram based on CANopen communications

⓪ to ① State number

1 to 17 State transition (No. 17: DC link voltage cut off)

Legend for “State machine diagram based on CANopen communications” figure

# 8.10 Touch probe

|ID|Index Name / Setting|
|---|---|
|241|0 MPRO_TP_Position|
|241|1 MPRO_TP_Position|
|241|2 MPRO_TP_Position|
|241|3 MPRO_TP_Position|
|241|4 MPRO_TP_Position|
|1400|0 MPRO_TP_Config|
| |TP_TP (0)|
| |AB (1)|
| |PD_UP (2)|
| |PD_DOWN (3)|
| |PC_PC (4)|
| |PC_TP (5)|
| |TP_PC (6)|
| |ENC_ENC (7)|
| |ENC_TP (8)|
| |TP_ENC (9)|

Using the touch probe inputs, touch probe functions can be performed. In order to be able to do this, P 106[0] - MPRO_INPUT_FS_ISD05 and P 107[0] - MPRO_INPUT_FS_ISD06 must be used to set digital inputs ISD05 and ISD06 to ""PROBE(15) = Touch probe (only ISD05/06)"" (see Section ""Digital inputs"" on page 290). HTL encoders can be evaluated or pulse counters implemented using the MSD PLC.

The touch probe can be triggered with P 240 - MPRO_TP_Ctrl. This enables triggering on a positive or negative edge, or on both edges, of the signal detected on the touch probe inputs. After the measurement, the parameter jumps back to the value ""NONE (0)"" and the latch position is mapped in the corresponding subindex of parameter P 241 - MPRO_TP_Position. A continuous touch probe mode is not possible at present, so the touch probe has to be reactivated after the measurement.

P 1402 - MPRO_TP_Channel can be used to select various positions as actual value sources of the latch position for the touch probe functionality. The following table provides an overview of the available settings. The counters are accessed via the MSD PLC or a bus system.

|ID|Index Name / Setting|Unit|Description|
|---|---|---|---|
|240|MPRO_TP_Ctrl|Touch probe: Control| |
| |0| |NONE (0) = No function|
| |1| |POS (1) = Positive edge|
| |2| |NEG (2) = Negative edge|
| |3| |BOTH (3) = Both edges|
|240|0 MPRO_TP_Ctrl| | |
|240|1 MPRO_TP_Ctrl| | |
|240|2 MPRO_TP_Ctrl| | |
|241|MPRO_TP_Position|Probe: Pos. high/low edge of TP0/1, encoder zero pulse| |

Table 8.29: “Touch probe” parameters

MOOG ID No.:CB40859-001 Date:11/2020

# 8 Motion profile

|Unit|Description|
|---|---|
|mDegree|Touch probe: Configuration|
|mDegree|TP0, TP1 touch probe|
|mDegree|TP0, TP1 as encoder, A/B as quadrature counting|
|mDegree|TP0, TP1 as encoder, pulse (TP0) / direction (TP1), count up on direction high|
|mDegree|TP0, TP1 as encoder, pulse (TP0) / direction (TP1), count down on direction high|
|mDegree|TP0 pulse counter, TP1 pulse counter|
|mDegree|TP0 pulse counter, TP1 touch probe|
|mDegree|TP1 touch probe, TP0 pulse counter|
|mDegree|TP0 encoder counter, TP1 encoder counter|
|mDegree|TP0 encoder counter, TP1 touch probe|
|mDegree|TP0 touch probe, TP1 encoder counter|

Touch probe: Channel

|Unit|Description|
|---|---|
|ACTPOS (0)|Actual position in user units|
|ACTPOSINC (1)|Actual position in increments|
|MASTERPOS (2)|Master position in increments|
|ENCPOS_CH1 (3)|Encoder position Channel 1|
|ENCPOS_CH1_INC (4)|Encoder position Channel 1 in increments|
|ENCPOS_CH2 (5)|Encoder position Channel 2|
|ENCPOS_CH2_INC (6)|Encoder position Channel 2 in increments|

# 8 Motion profile

MOOG ID No.:CB40859-001 Date:11/2020 MSD ServoDrive - DeviceHelp 276

|ID|Index Name / Setting|Unit|Description|
|---|---|---|---|
|7|ENCPOS_CH3 (7)| |Encoder position Channel 3|
|8|ENCPOS_CH3_INC (8)| |Encoder position Channel 3 in increments|
|9|ENCPOS_CH4 (9)| |Encoder position Channel 4|
|10|ENCPOS_CH4_INC (10)| |Encoder position Channel 4 in increments|
|11|ACTPOS2 (11)| |Actual position of redundant encoder in user units|
|12|Sercos (12)| |Referred to Sercos profile parameters S-x-0426, S-x-0427|
|13|UserRefPos(13)| |Reference position in user units|
|14|MasterPosST(14)| |Master position (ECAM, EGEAR) singleturn, always steps|
|15|CommonMasterPos(15)| |Master position (ECAM, EGEAR) singleturn, always steps|
|16|CommonMasterPosST(15)| |Master position (ECAM, EGEAR) singleturn, always steps|
|1402|MPRO_TP_Channel| | |
|1402|MPRO_TP_Channel| | |
|1402|MPRO_TP_Channel| | |
|1404|MPRO_TP_Lines| |Touch probe: Lines @ pulse counter on channel x|
|1404|MPRO_TP_Lines| | |
|1404|MPRO_TP_Lines| | |

Image 8.71: “Synchronized motion” screen

There are various modes available in the “synchronization mode” drop-down menu (P 242[0] - MPRO_ECAM_SyncModMode):

- Off(0) = Synchronized motion off
- ECAM_iPlc(1) = Electronic cam plate via MSD PLC
- EGEAR_iPlc(2) = Electr. gear unit via MSD PLC
- ECAM_PARA(3) = Electronic camming via parameters
- EGEAR_PARA(4) = Electronic gearing via parameters

NOTE: For more information refer to the bus system User Manuals or the description of the MSD PLC.

# 8.11.1 Electronic cam plate

The other parameters are configured in separate screens that can be accessed with the corresponding buttons.

- Master configuration (see Section ""Master configuration"" on page 280)
- Electronic gearing (see Section ""Electronic gearing"" on page 283)
- Electronic camming (see Section ""Electronic cam plate"" on page 277)

P 1318[0] - MPRO_ECAM_ControlWord is the control word for “synchronized motion” (see Section ""Control word for synchronized motion"" on page 279).

P 1326[0] - MPRO_ECAM_StatusWord is the status word for “synchronized motion” (see Section ""Status word for synchronized motion"" on page 279).

# 8.11.1.1 Table selection

|ID|Index Name|Unit|Description|
|---|---|---|---|
|1300|MPRO_ECAM_CTS_| |ECAM: CamTableSelect - Master reference|
|1301|MasterRef| | |
|1305|MPRO_ECAM_CTS_| |ECAM: CamTableSelect - Method for changing the camtable|
|1306|MPRO_ECAM_CTS_| |ECAM: CamTableSelect - Mode for changing the camtable|
|1307|MPRO_ECAM_CTS_|incr|ECAM: CamTableSelect - Distance for changing the camtable|
|242|MPRO_ECAM_| |ECAM / EGEAR: Mode of synchronized motion SyncModMode|
|265|MPRO_ECAM_| |ECAM / EGEAR: Slave speed factor (1 = 100%).|
|266|CamSlave_SpeedFactor| | |
|268|MPRO_ECAM_| |ECAM / EGEAR: Mode of switching off sync. motion|

# 8.11.1.2 Synchronization

|ID|Index Name|Unit|Description|
|---|---|---|---|
|1342|MPRO_ECAM_CI_|incr|ECAM: CamIn - Synchronization position (multiturn part)|
|1343|MPRO_ECAM_CO_|incr|ECAM: CamOut - Decoupling pos. (multiturn part)|
|1303|MPRO_ECAM_CI_|incr|ECAM: CamIn - Master offset|
|1308|MPRO_ECAM_CI_| |ECAM: CamIn - Master reference|
|1309|MPRO_ECAM_CI_| |ECAM: CamIn - Slave reference|
|1310|MPRO_ECAM_CI_| |ECAM: CamIn - Coupling mode|
|1311|MPRO_ECAM_CI_|incr|ECAM: CamIn - Coupling distance|
|1312|MPRO_ECAM_CI_|incr|ECAM: CamIn - Synchronization position|

Table 8.31: “Electronic camming - Table selection” parameters

Table 8.30: “Synchronized motion” parameters

Table 8.32: “Electronic camming - Synchronization” parameters

MOOG ID No.:CB40859-001 Date:11/2020

MSD ServoDrive - DeviceHelp 277

# 8 Motion profile

MOOG ID No.:CB40859-001 Date:11/2020 MSD ServoDrive - DeviceHelp 278

|ID|Index|Name|Unit|Description|
|---|---|---|---|---|
|1313|0|MPRO_ECAM_CO_SyncPosST|(singleturn part)|ECAM: CamOut - Slave reference|
|1314|0|MPRO_ECAM_CO_DecouplingMode|63|ECAM: CamOut - Decoupling mode|
|1315|0|MPRO_ECAM_CO_BreakingPosST|incr|ECAM: CamOut - Decoupling position|
|1316|0|MPRO_ECAM_CO_DecouplingDist|incr|ECAM: CamOut - Decoupling distance|
|1317|0|MPRO_ECAM_CO_StandstillPos|mDegree|ECAM: CamOut - Slave standstill position|

# Table 8.32: “Electronic camming - Synchronization” parameters (continue)

|ID|Index|Name|Unit|Description|
|---|---|---|---|---|
|1346| |MPRO_ECAM_SP_Table| |ECAM: Setpoint table interface|
|1346|0|Index| |Index of setpoint table|
|1346|1|Value| |Value at index of setpoint table|
|1347|0 to 31|MPRO_ECAM_SP_Index| |ECAM: Setpoint segments start index|
|1348|0 to 31|MPRO_ECAM_SP_Length| |ECAM: Setpoint segments length|
|1349|0 to 31|Length| | |
|1350|0|MPRO_ECAM_SP_MaDist| |ECAM: Setpoint segments master distance|
|1351|0|MPRO_ECAM_SP_IpoType| |ECAM: Setpoint segments interpolation type|
|1352|0 to 31|Checksum| |ECAM: Setpoint table checksum|
|1353|0 to 31|GainNum| |ECAM: Setpoint segments gain numerator|
| | |GainDen| |ECAM: Setpoint segments gain denominator|

# Table 8.33: “Electronic camming - Table segments” parameters

|ID|Index|Name|Unit|Description|
|---|---|---|---|---|
|1329|0 to 63|MPRO_ECAM_SegData_IndexNext| |ECAM: Index of the following segment|
|1330|0 to 63|MPRO_ECAM_SegData_IndexPrev| |ECAM: Index of the previous segment|
|1331|0 to 63|MPRO_ECAM_SegData_ProfileMode| |ECAM: Profile mode of the current segment|
|1332|0 to 63|MPRO_ECAM_SegData_DistMaster| |ECAM: Length of the master section of the current segment|
|1333|0 to 63|MPRO_ECAM_SegData_DistSlave| |ECAM: Length of the slave section of the current segment|
|1334|0 to 63|MPRO_ECAM_SegData_Lambda| |ECAM: Lambda value of the current segment|
|1335|0 to 63|MPRO_ECAM_SegData_StatusWord| |ECAM: Status word of the current segment|
|1336|0 to 63|MPRO_ECAM_SegData_ControlWord| |ECAM: Control word of the current segment|

# 8.11.2 Control word for synchronized motion

|Bit|Function|PLC function|Bit number|Description|
|---|---|---|---|---|
|0-7|Start segment (8-bit value)|-|0-7|Actual segment (8-bit value)|
|8-15|Reserved|-| |Actual ECAM / EGEAR state machine state (4 Bit value)|
|16|Absolute (true) / relative (false) master relationship|-| |- 0: ECAM / EGEAR asynchronous
- 1: ECAM / EGEAR synchronous
|
|17|Absolute (true) / relative (false) master (CAM) relationship at cam in|-| |- 2: ECAM / EGEAR synchronizing
- 3: ECAM / EGEAR desynchronizing
|
|18|Absolute (true) / relative (false) slave (CAM) relationship at cam in|-| |- 4: ECAM / EGEAR active and waiting for going asynchronous
|
|19-23|Reserved|-| |- 5: ECAM / EGEAR inactive and waiting for going synchronous
|
|24|Change gear ratio of the electronic gear online|MCB_GearRatioChange| | |
|25|Disable master calculation|MCB_Cam_MasterEnable| | |
|26|Enable master calculation|MCB_Cam_MasterEnable| | |
|27|Select CAM table|MCB_CamTableSelect| | |
|28|Start Ecam|MCB_CamIn| | |
|29|Stop Ecam|MCB_CamOut| | |
|30|Start Egear|MCB_GearIn| | |
|31|Stop Egear|MCB_GearOut| | |

# 8.11.3 Status word for synchronized motion

|Bit|Function|PLC function|Bit number|Description|
|---|---|---|---|---|
|12-26|Reserved|-| | |
|27|ECAM / EGEAR is active|-| | |
|28|Valid segments chosen|-| | |
|29|Master data are valid|-| | |
|30|Master is initialized|-| | |
|31|Master calculation is active|-| | |

Table 8.35: Control word ECAM (P 1318[0] - MPRO_ECAM_ControlWord)

Table 8.36: ECAM status word (P 1326[0] - MPRO_ECAM_StatusWord)

MOOG ID No.:CB40859-001 Date:11/2020 MSD ServoDrive - DeviceHelp 279

# 8 Motion profile

# 8 Motion profile

MOOG ID No.:CB40859-001 Date:11/2020

MSD ServoDrive - DeviceHelp 280

# 8.11.4 Master configuration

the master encoder, you will need to set the resolution relative to a single motor revolution in P 250 - MPRO_ECAM_PARAMaster_Amplitude (see below).

- ENC CH1 (3) = Encoder channel 1 X7 (Sin/Cos)
- ENC CH2 (4) = Encoder channel 2 X6 (Resolver)
- ENC CH3 (5) = Encoder channel 3 X8 (optional)

This function is only available if an external interface X8 (option module) is present.

- TP0 (6) = Pulse counter on probe channel 0 (TP0)
- TP1 (7) = Pulse counter on probe channel 1 (TP1)
- ENC_CH4 (8) = Encoder channel 4 (p. e. fieldbus)
- TWIN_POS (9) = TWIN remote reference position (P-2607)

Image 8.72: “Master configuration” screen

# Channel selection (master encoder)

P 1319[0] - MPRO_ECAM_CamMaster_AxisType is used to define the master encoder.

- NO AXIS (0) = No axis
- VIRTUAL MASTER (1) = Virtual master

If you select this function, you will be able to configure additional settings by clicking on the enabled “Options...” button (see Section ""Virtual Master"" on page 286).

- PARA (2) = Master parameter interface

If you select this function because a higher-level controller is being used as

# Anti-reverse mode

Slave only starts moving along with it again as soon as the master reaches the zero position.

P 1320[0] - MPRO_ECAM_CamMaster_RevLockMode is used to define the reverse lock mode, which can be used either with or without path compensation. The dashed lines in the following diagrams indicate what the engagement distance is:

# Example:

If the master, which has moved two motor revolutions in the direction blocked for the slave, then moves in the unblocked direction again, the slave only moves off when the master has traversed the zero point.

- INACTIVE (0) = Reverse lock inactive
- ACTIVE (2) = Reverse lock enabled - without path optimization
- ACTIVE WAY COMP (1) = Reverse lock active - with way compensation

While the slave accelerates to the speed of the master during engagement, the master and slave do not move synchronously. This function needs to be selected in order to quickly catch up to the master that is running ahead.

# Example:

- Master (black line) rotates in the blocked direction
- The slave (blue line) remains stopped
- Master rotates in the unblocked direction again
- The slave follows the master directly in the unblocked direction

Assume the master has moved two motor revolutions in the direction for which the slave lock is enabled. If the master now moves in the direction for which there is no lock, the slave will immediately start running in that direction.

MOOG ID No.:CB40859-001 Date:11/2020

MSD ServoDrive - DeviceHelp 281

# 8 Motion profile

MOOG ID No.:CB40859-001 Date:11/2020 MSD ServoDrive - DeviceHelp 282

|Filter type|ID|Index Name|Unit|Description|
|---|---|---|---|---|
|When using a real master encoder, encoder signals may be subject to noise.|P 1340|1319|0|MPRO_ECAM_CamMaster_AxisType|
| | |MPRO_ECAM_CamMaster_SpeedFilTyp| |ECAM / EGEAR: Channel selection of internal master input|
| | |1320|0|MPRO_ECAM_CamMaster_RevLockMode|
| | |1321|0|MPRO_ECAM_CamMaster_Amplitude|
| | |1322|0|MPRO_ECAM_CamMaster_GearNum|
| | |1323|0|MPRO_ECAM_CamMaster_GearDen|
|Filter time|1327|0|ms|ECAM / EGEAR: Filter time constant of master|
|If P 1340[0] is used to enable a filter, P 1327[0] - MPRO_ECAM_CamMaster_SpeedTFil can be used to define the corresponding filter time.|1328|0|speed|ECAM / EGEAR: Speed factor of the internal master|
|Speed factor|1340|0| |MPRO_ECAM_CamMaster_SpeedFilTyp|
|The master encoder can be assigned an additional speed factor P 1328[0] - MPRO_ECAM_CamMaster_SpeedFactor.|1341|0|incr|ECAM / EGEAR: Master drive offset|

Table 8.37: “Synchronized motion - Master configuration” parameters (continue)

| | | |ID|Index Name|Unit|Description|
|---|---|---|---|---|---|---|
|247|0|MPRO_ECAM_ParaMaster_ActPos|incr|ECAM / EGEAR: Parameter interface master position| | |
|248|0|MPRO_ECAM_ParaMaster_ActSpeed|rpm|ECAM / EGEAR: Parameter interface master speed| | |
|249|0|MPRO_ECAM_ParaMaster_ActAcc|rpm|ECAM / EGEAR: Parameter interface master acceleration| | |
| |250|0|MPRO_ECAM_ParaMaster_Amplitude| |ECAM / EGEAR: Parameter interface master amplitude| |

Table 8.37: “Synchronized motion - Master configuration” parameters

# 8.11.5 Electronic gearing

# Gear ratio

The gear ratio is specified as a fraction. This ensures that the position references can be translated to the motor shaft with no rounding error.

- ""Slave"" (P 252[0] - MPRO_ECAM_Egear_GearNum) is the numerator
- ""Master"" (P 251[0] - MPRO_ECAM_Egear_GearDen) is the denominator

# Scaling of speed pre-control

Defined with P 265[0] - MPRO_ECAM_CamSlave_SpeedFactor definiert.

# Scaling of torque pre-control

Defined with P 266[0] - MPRO_ECAM_CamSlave_TorqueFactor.

# Engagement

See Section ""Engagement"" on page 284.

# Disengagement

See Section ""Disengagement"" on page 285.

|ID|Index Name|Unit|Description|
|---|---|---|---|
|251|0 MPRO_ECAM_Egear_GearDen| |EGEAR: Gear denominator|
|252|0 MPRO_ECAM_Egear_GearNum| |EGEAR: Numerator of gear ratio|
|1344|0 MPRO_ECAM_Egear_LimRefAcc|rpm/s|EGEAR: Acceleration limit for reference|
|1345|0 MPRO_ECAM_Egear_LimRefJerk|rpm/s²|EGEAR: Jerk limit for reference|

Table 8.38: “Synchronized motion - Electronic gearing” parameters

Image 8.73: ""Electronic gearing"" screen

MOOG ID No.:CB40859-001 Date:11/2020 MSD ServoDrive - DeviceHelp 283

# 8 Motion profile

# 8 Motion profile

MOOG ID No.:CB40859-001 Date:11/2020

MSD ServoDrive - DeviceHelp 284

# 8.11.6 Engagement

used to define the engagement distance (between the dashed lines).

P 253[0] - MPRO_ECAM_Egear_GearInMode is used to define the mode for engagement.

- DIRECT (0) = Direct
- Direct engagement: Angular synchronous; with jerking (no ramps).
- CROSSFADE (3) = Crossfading
- Engagement with crossfading function (5th degree polynomial): Angular synchronous; jerk-limited; speed will overshoot during engagement.
- RAMP (1) = Linear speed ramp
- Engagement with linear acceleration: Not angular synchronous; with jerking.
- FADE (2) = Engagement fade-out
- Engagement with fade-in function (5th degree polynomial): Not angular synchronous; jerk-limited. The position is ignored. ",How is the wait time before the next motion task defined in the 'MSD ServoDrive - DeviceHelp' document?,A3,Define the wait time with P 204 before proceeding to the next motion task.,2.359375,2.484375,3.546875,1.3671875,0.333984375
13,msd_servo_drive.txt,76,b87ca5e232c2bdbb6fa16a8a401c6b5d285dc0183e73cc9d134de13dd2fc71d2,"MOOG ID No.:CB40859-001 Date:11/2020

MSD ServoDrive - DeviceHelp 267

# 8 Motion profile

MOOG ID No.:CB40859-001 Date:11/2020 MSD ServoDrive - DeviceHelp 268

# Deceleration

With ...

- P 194 - MPRO_TAB_TDec (for torque control) or
- P 197 - MPRO_TAB_SDec (for speed control) or
- P 200 - MPRO_TAB_PDec (for position control)

and indexes 0–15, the deceleration for each individual motion task can be defined. The input must not be zero.

# Wait time in Auto mode

P 204 - MPRO_TAB_WaitTime is used to define the wait time before the next motion task is carried out.

# Maximum table index in Auto mode

P 206[0] - MPRO_Tab_MaxIdx is used to define the table index up to which driving jobs will be carried out in one of the auto modes.

# Current table index

P 207[0] - MPRO_Tab_ActIdx will show the index for the motion task that is currently active. If parameter P 205 MPRO_TAB_Mode is set to “Para(0)”, a driving set can be entered and approached directly.

# Activation of reference table

The following procedures can be used in order to activate the setpoint table for operation.

|ID|Index Name|Unit|Description|
|---|---|---|---|
|193|MPRO_TAB_TAcc|TAB: Torque mode acceleration|Nm/ms|
|193|0|MPRO_TAB_TAcc|Nm/ms|
|193|1 - 15|MPRO_TAB_TAcc|Nm/ms|
|194|MPRO_TAB_TDec|TAB: Torque mode deceleration| |
|194|0|MPRO_TAB_TDec|Nm/ms|
|194|1 - 15|MPRO_TAB_TDec|Nm/ms|

# Table 8.23: Activation of table references

# Table 8.24: “Setpoint table settings” parameters

# Table 8.24: “Setpoint table settings” parameters (continue)

|ID|Index Name|Unit|Description|ID|Index Name|Unit|Description|
|---|---|---|---|---|---|---|---|
|195|MPRO_TAB_TRef|Nm|TAB: Torque mode reference value|208|MPRO_TAB_OutputNo| |OSD TAB: actual table index and target|
|195|MPRO_TAB_TRef|Nm| |208|MPRO_TAB_OutputNo| | |
|196|MPRO_TAB_SAcc|rev/min/s|TAB: Speed mode acceleration|269|MPRO_TAB_Ctrl| |TAB: control word|
|196|MPRO_TAB_SAcc|rev/min/s| | | | | |
|197|MPRO_TAB_SDec|rev/min/s|TAB: Speed mode deceleration| | | | |
|197|MPRO_TAB_SDec|rev/min/s| | | | | |
|198|MPRO_TAB_SRef|rev/min|TAB: Speed mode reference value| | | | |
|198|MPRO_TAB_SRef|rev/min| | | | | |
|199|MPRO_TAB_PAcc|rev/min/s|TAB: Position control mode acceleration| | | | |
|199|MPRO_TAB_PAcc|rev/min/s| | | | | |
|200|MPRO_TAB_PDec|rev/min/s|TAB: Position control mode Acceleration| | | | |
|200|MPRO_TAB_PDec|rev/min/s| | | | | |
|201|MPRO_TAB_PSpd|rev/min|TAB: Position control mode speed| | | | |
|201|MPRO_TAB_PSpd|rev/min| | | | | |
|202|MPRO_TAB_PPos|mDegree|TAB: Position control mode reference value| | | | |
|202|MPRO_TAB_PPos|mDegree| | | | | |
|203|MPRO_TAB_PMode| |Position control table:Mode| | | | |
|203|MPRO_TAB_PMode| | | | | | |
|204|MPRO_TAB_WaitTime|ms|TAB: Wait time| | | | |
|204|MPRO_TAB_WaitTime|ms| | | | | |
|205|MPRO_TAB_Mode| |TAB mode| | | | |
|206|MPRO_Tab_MaxIdx| |TAB: Max index in AUTO mode| | | | |
|207|MPRO_TAB_ActIdx| |TAB: Actual index| | | | |

MOOG ID No.:CB40859-001 Date:11/2020

MSD ServoDrive - DeviceHelp

# 8 Motion profile

MOOG ID No.:CB40859-001 Date:11/2020

MSD ServoDrive - DeviceHelp 270

# 8.8 Analog channel (ISA00 und ISA01)

# Offset (O)

This parameter (P 174 - MPRO_ANA0_SOffset for ISA00, P 184 - MPRO_ANA1_SOffset for ISA01) compensates for component variations and is used for offset compensation purposes. Depending on the control mode being used (see Section ""Basic settings"" on page 110), the value will be stored in parameter index [0] (torque control), [1] (speed control) or [2] (position control).

# Backlash (B)

This parameter (P 175 - MPRO_ANA0_SThreshold for ISA00, P 185 - MPRO_ANA1_SThreshold for ISA01) can suppress axis motion close to the standstill (stop) position. Depending on the control mode being used (see Section ""Basic settings"" on page 110), the value will be stored in parameter index [0] (torque control), [1] (speed control) or [2] (position control).

Image 8.68: “Analog channel” screen

# Acceleration ramp

Two standard analog inputs (ISA00, ISA01) are available. These inputs can be configured...

- with negative values for analog setpoint settings
- with positive values for digital setpoint processing

(P 109[0] - MPRO_INPUT_FS_ISA00 and P 110[0] - MPRO_INPUT_FS_ISA01).

see also section ""Analog Inputs"" on page 303. By using the ""REV(-2) = Analog setpoint"" setting, an analog input voltage of ±10 V can be processed as a setpoint.

# Deceleration ramp

This parameter serves as a deceleration ramp for torque control (P 176[1] - MPRO_ANA0_TRamp for ISA00, P 186[1] - MPRO_ANA1_TRamp for ISA01) or speed control (P 177[1] - MPRO_ANA0_SRamp for ISA00, P 187[1] - MPRO_ANA1_SRamp for ISA01). Depending on the control mode being used (see Section ""Basic settings"" on page 110), the value will be stored in parameter index [0] (torque control), [1] (speed control) or [2] (position control).

This parameter (P 173 - MPRO_ANA0_Scale for ISA00, P 183 - MPRO_ANA1_Scale for ISA01) is used to define which speed / which torque / which position corresponds to the maximum analog value. Depending on the control mode being used (see Section ""Basic settings"" on page 110), the value will be stored in parameter index [0] (torque control), [1] (speed control) or [2] (position control).

# 8.8.1 Special characteristics of position control mode

A threshold value can also be specified which generates a run-on range around the last reference value. A ramp function calculates a motion profile for the position reference from pre-defined acceleration and speed limits.

The position references on the analog channel are not applied immediately, but dependent on a digital input. Accordingly, one of the ISD00 to ISD06 digital inputs must be set to a value of ""REFANAEN(28) = Enable analog reference value"" (see Section ""Digital inputs"" on page 290). The position setpoint being received will only be applied if the corresponding digital input is active. The acceleration is entered using P 173[0] - MPRO_ANA0_TScale or P 183[0] - MPRO_ANA1_TScale.

# 8.8.2 Wire Break Monitoring

P 399 - CON_ANAWireBrk_Th can be used to configure wire break monitoring for the analog inputs. For details see Section ""Wire Break Monitoring"" on page 306.

|Function|TLIM (-4)|OVR (-3)|REFV (-2)|leer (-1)|OFF (0)|
|---|---|---|---|---|---|
|Digital|(1)-(28)|(1)-(28)|(1)-(28)|(1)-(28)|(1)-(28)|
|Analog channel|Filter|Scale|Offset|Profile|generator|

Control

Image 8.69: Reference processing structure

MOOG ID No.:CB40859-001 Date:11/2020

MSD ServoDrive - DeviceHelp 271

# 8 Motion profile

# 8 Motion profile

MOOG ID No.:CB40859-001 Date:11/2020

|ID|Index Name|Unit|Description|ID|
|---|---|---|---|---|
|395|CON_ANA_Isaf_Scaled| |Analog inputs: Values (filt, norm, comp, scaled)|174|
|395|0 ISA00| |Scaled, compensated, filtered, normalized value|175|
|395|1 ISA01| |Scaled, compensated, filtered, normalized value| |
|396|CON_ANA_Scale_ThUpper| |Analog inputs: Upper scaling limits|175|
|396|0 ISA00|%|Upper scaling (@ 10 V) threshold|175|
|396|1 ISA01|%|Upper scaling (@ 10 V) threshold| |
|397|CON_ANA_Scale_ThZero| |Analog inputs: Zero scaling thresholds|176|
|397|0 ISA00|V|Zero scaling threshold (+/-)|176|
|397|1 ISA01|V|Zero scaling threshold (+/-)| |
|398|CON_ANA_Scale_ThLower| |Analog inputs: Lower scaling limits|177|
|398|0 ISA00|%|Lower scaling (@ zero threshold) threshold|177|
|398|1 ISA01|%|Lower scaling (@ zero threshold) threshold| |
|399|CON_ANA_WireBrk_Th| |Analog inputs: Wire break thresholds|Table 8.26:|
|399|0 ISA00|V|Wire break detection threshold| |
|399|1 ISA01|V|Wire break detection threshold| |
|405|0 CON_ANA_Filt0|ms|Analog input ISA00: Filter time constant (PT 1)|ID|
|408|CON_ANA_Isaf_Norm| |Analog inputs: Values (filt, norm)|183|
|408|0 ISA00| |Filtered, normalized value|183|
|408|1 ISA01| |Filtered, normalized value|183|

Table 8.25: “Analog channel” parameters

|ID|Index Name|Unit|Description|ID|
|---|---|---|---|---|
|173|MPRO_ANA0_Scale| |ANA0: scale factors|184|
|173|0 MPRO_ANA0_TScale|Nm|ANA0: scale factor torque reference|185|
|173|1 MPRO_ANA0_SScale|rev/min|ANA0: scale factor speed reference|185|
|173|2 MPRO_ANA0_PScale|mDegree|ANA0: scale factor position reference| |
|174|MPRO_ANA0_Offset| |ANA0: offsets|185|
|174|0 MPRO_ANA0_TOffset|Nm|ANA0: offsets for torque reference|185|

Table 8.26: “Analog channel ISA00” parameters

|Index Name|Unit|Description|
|---|---|---|
|1 MPRO_ANA0_SOffset|rev/min|ANA0: offsets for speed reference|
|2 MPRO_ANA0_POffset|mDegree|ANA0: offsets for position reference|
|MPRO_ANA0_Threshold| |ANA0: thresholds|
|0 MPRO_ANA0_TThreshold|Nm|ANA0: threshold for torque reference|
|1 MPRO_ANA0_SThreshold|rev/min|ANA0: threshold for speed reference|
|2 MPRO_ANA0_PThreshold|mDegree|ANA0: threshold for position reference|
|MPRO_ANA0_TRamp| |ANA0: Torque mode acceleration [0] and deceleration [1]|
|0 MPRO_ANA0_TRamp|Nm/s| |
|1 MPRO_ANA0_TRamp|Nm/s| |
|MPRO_ANA0_SRamp| |ANA0: Speed mode acceleration [0] and deceleration [1]|
|0 MPRO_ANA0_SRamp|SPEED/s| |
|1 MPRO_ANA0_SRamp|SPEED/s| |

“Analog channel ISA00” parameters (continue)

|Index Name|Unit|Description|
|---|---|---|
|MPRO_ANA1_Scale| |ANA1: scale factors|
|0 MPRO_ANA1_TScale|Nm|ANA0: scale factor torque reference|
|1 MPRO_ANA1_SScale|rev/min|ANA0: scale factor speed reference|
|2 MPRO_ANA1_PScale|mDegree|ANA0: scale factor position reference|
|MPRO_ANA1_Offset| |ANA1: offsets|
|0 MPRO_ANA1_TOffset|Nm|ANA1: offsets for torque reference|
|1 MPRO_ANA1_SOffset|rev/min|ANA1: offsets for speed reference|
|2 MPRO_ANA1_POffset|mDegree|ANA1: offsets for position reference|
|MPRO_ANA1_Threshold| |ANA1: thresholds|
|0 MPRO_ANA1_TThreshold|Nm|ANA1: threshold for torque reference|
|1 MPRO_ANA1_SThreshold|rev/min|ANA1: threshold for speed reference|
|2 MPRO_ANA1_PThreshold|mDegree|ANA1: threshold for position reference|

“Analog channel ISA01” parameters

# 8 Motion profile

|ID|Index Name|Unit|Description|
|---|---|---|---|
|186|MPRO_ANA1_TRamp|Nm/s|ANA1: Torque mode acceleration [0] and deceleration[1]|
|186|MPRO_ANA1_TRamp|Nm/s| |
|187|MPRO_ANA1_SRamp|SPEED/s|ANA1: Speed mode acceleration [0] and deceleration [1]|
|187|MPRO_ANA1_SRamp|SPEED/s| |

# Table 8.27: “Analog channel ISA01” parameters (continue)

Display

- System state
- Initialization on device startup
- Not ready (DC link voltage possibly too low)
- Start inhibit (DC link voltage present, power stage off)
- Starting lockout
- Ready for start
- Control initialization: Auto commutation, flux build-up etc.

# Table 8.28: Central state machine according to CiA 402 device display

MOOG ID No.:CB40859-001 Date:11/2020

MSD ServoDrive - DeviceHelp 273

# 8 Motion profile

MOOG ID No.:CB40859-001 Date:11/2020

MSD ServoDrive - DeviceHelp 274

|Display|System state|power disabled|fault|
|---|---|---|---|
|Control enabled|0|Start|7|
| |fault reaction active|0|14|
|Quick stop active|1|not ready|8|
| |to switch on|1|17|
|Error reaction active|2|switch on|disabled|
| |2|7| |
|Error state (in this state the error is indicated directly on the display.)|3|ready to|switch on|
|Device is reset (display flashes)|power enabled|3|6|
| |10|12| |
|• Number [5.] flashes when “STO” (Safe Torque Off) input is active. Display goes out when STO inactive.| | | |
|• The dot on the display flashes when the power stage is active.| | | |

Table 8.28: Central state machine according to CiA 402 device display (continue)

NOTE

l The system states indicated on the display may differ from the states in the table depending on the drive profile setting.

Image 8.70: State machine diagram based on CANopen communications

⓪ to ① State number

1 to 17 State transition (No. 17: DC link voltage cut off)

Legend for “State machine diagram based on CANopen communications” figure

# 8.10 Touch probe

|ID|Index Name / Setting|
|---|---|
|241|0 MPRO_TP_Position|
|241|1 MPRO_TP_Position|
|241|2 MPRO_TP_Position|
|241|3 MPRO_TP_Position|
|241|4 MPRO_TP_Position|
|1400|0 MPRO_TP_Config|
| |TP_TP (0)|
| |AB (1)|
| |PD_UP (2)|
| |PD_DOWN (3)|
| |PC_PC (4)|
| |PC_TP (5)|
| |TP_PC (6)|
| |ENC_ENC (7)|
| |ENC_TP (8)|
| |TP_ENC (9)|

Using the touch probe inputs, touch probe functions can be performed. In order to be able to do this, P 106[0] - MPRO_INPUT_FS_ISD05 and P 107[0] - MPRO_INPUT_FS_ISD06 must be used to set digital inputs ISD05 and ISD06 to ""PROBE(15) = Touch probe (only ISD05/06)"" (see Section ""Digital inputs"" on page 290). HTL encoders can be evaluated or pulse counters implemented using the MSD PLC.

The touch probe can be triggered with P 240 - MPRO_TP_Ctrl. This enables triggering on a positive or negative edge, or on both edges, of the signal detected on the touch probe inputs. After the measurement, the parameter jumps back to the value ""NONE (0)"" and the latch position is mapped in the corresponding subindex of parameter P 241 - MPRO_TP_Position. A continuous touch probe mode is not possible at present, so the touch probe has to be reactivated after the measurement.

P 1402 - MPRO_TP_Channel can be used to select various positions as actual value sources of the latch position for the touch probe functionality. The following table provides an overview of the available settings. The counters are accessed via the MSD PLC or a bus system.

|ID|Index Name / Setting|Unit|Description|
|---|---|---|---|
|240|MPRO_TP_Ctrl|Touch probe: Control| |
| |0| |NONE (0) = No function|
| |1| |POS (1) = Positive edge|
| |2| |NEG (2) = Negative edge|
| |3| |BOTH (3) = Both edges|
|240|0 MPRO_TP_Ctrl| | |
|240|1 MPRO_TP_Ctrl| | |
|240|2 MPRO_TP_Ctrl| | |
|241|MPRO_TP_Position|Probe: Pos. high/low edge of TP0/1, encoder zero pulse| |

Table 8.29: “Touch probe” parameters

MOOG ID No.:CB40859-001 Date:11/2020

# 8 Motion profile

|Unit|Description|
|---|---|
|mDegree|Touch probe: Configuration|
|mDegree|TP0, TP1 touch probe|
|mDegree|TP0, TP1 as encoder, A/B as quadrature counting|
|mDegree|TP0, TP1 as encoder, pulse (TP0) / direction (TP1), count up on direction high|
|mDegree|TP0, TP1 as encoder, pulse (TP0) / direction (TP1), count down on direction high|
|mDegree|TP0 pulse counter, TP1 pulse counter|
|mDegree|TP0 pulse counter, TP1 touch probe|
|mDegree|TP1 touch probe, TP0 pulse counter|
|mDegree|TP0 encoder counter, TP1 encoder counter|
|mDegree|TP0 encoder counter, TP1 touch probe|
|mDegree|TP0 touch probe, TP1 encoder counter|

Touch probe: Channel

|Unit|Description|
|---|---|
|ACTPOS (0)|Actual position in user units|
|ACTPOSINC (1)|Actual position in increments|
|MASTERPOS (2)|Master position in increments|
|ENCPOS_CH1 (3)|Encoder position Channel 1|
|ENCPOS_CH1_INC (4)|Encoder position Channel 1 in increments|
|ENCPOS_CH2 (5)|Encoder position Channel 2|
|ENCPOS_CH2_INC (6)|Encoder position Channel 2 in increments|

# 8 Motion profile

MOOG ID No.:CB40859-001 Date:11/2020 MSD ServoDrive - DeviceHelp 276

|ID|Index Name / Setting|Unit|Description|
|---|---|---|---|
|7|ENCPOS_CH3 (7)| |Encoder position Channel 3|
|8|ENCPOS_CH3_INC (8)| |Encoder position Channel 3 in increments|
|9|ENCPOS_CH4 (9)| |Encoder position Channel 4|
|10|ENCPOS_CH4_INC (10)| |Encoder position Channel 4 in increments|
|11|ACTPOS2 (11)| |Actual position of redundant encoder in user units|
|12|Sercos (12)| |Referred to Sercos profile parameters S-x-0426, S-x-0427|
|13|UserRefPos(13)| |Reference position in user units|
|14|MasterPosST(14)| |Master position (ECAM, EGEAR) singleturn, always steps|
|15|CommonMasterPos(15)| |Master position (ECAM, EGEAR) singleturn, always steps|
|16|CommonMasterPosST(15)| |Master position (ECAM, EGEAR) singleturn, always steps|
|1402|MPRO_TP_Channel| | |
|1402|MPRO_TP_Channel| | |
|1402|MPRO_TP_Channel| | |
|1404|MPRO_TP_Lines| |Touch probe: Lines @ pulse counter on channel x|
|1404|MPRO_TP_Lines| | |
|1404|MPRO_TP_Lines| | |

Image 8.71: “Synchronized motion” screen

There are various modes available in the “synchronization mode” drop-down menu (P 242[0] - MPRO_ECAM_SyncModMode):

- Off(0) = Synchronized motion off
- ECAM_iPlc(1) = Electronic cam plate via MSD PLC
- EGEAR_iPlc(2) = Electr. gear unit via MSD PLC
- ECAM_PARA(3) = Electronic camming via parameters
- EGEAR_PARA(4) = Electronic gearing via parameters

NOTE: For more information refer to the bus system User Manuals or the description of the MSD PLC.

# 8.11.1 Electronic cam plate

The other parameters are configured in separate screens that can be accessed with the corresponding buttons.

- Master configuration (see Section ""Master configuration"" on page 280)
- Electronic gearing (see Section ""Electronic gearing"" on page 283)
- Electronic camming (see Section ""Electronic cam plate"" on page 277)

P 1318[0] - MPRO_ECAM_ControlWord is the control word for “synchronized motion” (see Section ""Control word for synchronized motion"" on page 279).

P 1326[0] - MPRO_ECAM_StatusWord is the status word for “synchronized motion” (see Section ""Status word for synchronized motion"" on page 279).

# 8.11.1.1 Table selection

|ID|Index Name|Unit|Description|
|---|---|---|---|
|1300|MPRO_ECAM_CTS_| |ECAM: CamTableSelect - Master reference|
|1301|MasterRef| | |
|1305|MPRO_ECAM_CTS_| |ECAM: CamTableSelect - Method for changing the camtable|
|1306|MPRO_ECAM_CTS_| |ECAM: CamTableSelect - Mode for changing the camtable|
|1307|MPRO_ECAM_CTS_|incr|ECAM: CamTableSelect - Distance for changing the camtable|
|242|MPRO_ECAM_| |ECAM / EGEAR: Mode of synchronized motion SyncModMode|
|265|MPRO_ECAM_| |ECAM / EGEAR: Slave speed factor (1 = 100%).|
|266|CamSlave_SpeedFactor| | |
|268|MPRO_ECAM_| |ECAM / EGEAR: Mode of switching off sync. motion|

# 8.11.1.2 Synchronization

|ID|Index Name|Unit|Description|
|---|---|---|---|
|1342|MPRO_ECAM_CI_|incr|ECAM: CamIn - Synchronization position (multiturn part)|
|1343|MPRO_ECAM_CO_|incr|ECAM: CamOut - Decoupling pos. (multiturn part)|
|1303|MPRO_ECAM_CI_|incr|ECAM: CamIn - Master offset|
|1308|MPRO_ECAM_CI_| |ECAM: CamIn - Master reference|
|1309|MPRO_ECAM_CI_| |ECAM: CamIn - Slave reference|
|1310|MPRO_ECAM_CI_| |ECAM: CamIn - Coupling mode|
|1311|MPRO_ECAM_CI_|incr|ECAM: CamIn - Coupling distance|
|1312|MPRO_ECAM_CI_|incr|ECAM: CamIn - Synchronization position|

Table 8.31: “Electronic camming - Table selection” parameters

Table 8.30: “Synchronized motion” parameters

Table 8.32: “Electronic camming - Synchronization” parameters

MOOG ID No.:CB40859-001 Date:11/2020

MSD ServoDrive - DeviceHelp 277

# 8 Motion profile

MOOG ID No.:CB40859-001 Date:11/2020 MSD ServoDrive - DeviceHelp 278

|ID|Index|Name|Unit|Description|
|---|---|---|---|---|
|1313|0|MPRO_ECAM_CO_SyncPosST|(singleturn part)|ECAM: CamOut - Slave reference|
|1314|0|MPRO_ECAM_CO_DecouplingMode|63|ECAM: CamOut - Decoupling mode|
|1315|0|MPRO_ECAM_CO_BreakingPosST|incr|ECAM: CamOut - Decoupling position|
|1316|0|MPRO_ECAM_CO_DecouplingDist|incr|ECAM: CamOut - Decoupling distance|
|1317|0|MPRO_ECAM_CO_StandstillPos|mDegree|ECAM: CamOut - Slave standstill position|

# Table 8.32: “Electronic camming - Synchronization” parameters (continue)

|ID|Index|Name|Unit|Description|
|---|---|---|---|---|
|1346| |MPRO_ECAM_SP_Table| |ECAM: Setpoint table interface|
|1346|0|Index| |Index of setpoint table|
|1346|1|Value| |Value at index of setpoint table|
|1347|0 to 31|MPRO_ECAM_SP_Index| |ECAM: Setpoint segments start index|
|1348|0 to 31|MPRO_ECAM_SP_Length| |ECAM: Setpoint segments length|
|1349|0 to 31|Length| | |
|1350|0|MPRO_ECAM_SP_MaDist| |ECAM: Setpoint segments master distance|
|1351|0|MPRO_ECAM_SP_IpoType| |ECAM: Setpoint segments interpolation type|
|1352|0 to 31|Checksum| |ECAM: Setpoint table checksum|
|1353|0 to 31|GainNum| |ECAM: Setpoint segments gain numerator|
| | |GainDen| |ECAM: Setpoint segments gain denominator|

# Table 8.33: “Electronic camming - Table segments” parameters

|ID|Index|Name|Unit|Description|
|---|---|---|---|---|
|1329|0 to 63|MPRO_ECAM_SegData_IndexNext| |ECAM: Index of the following segment|
|1330|0 to 63|MPRO_ECAM_SegData_IndexPrev| |ECAM: Index of the previous segment|
|1331|0 to 63|MPRO_ECAM_SegData_ProfileMode| |ECAM: Profile mode of the current segment|
|1332|0 to 63|MPRO_ECAM_SegData_DistMaster| |ECAM: Length of the master section of the current segment|
|1333|0 to 63|MPRO_ECAM_SegData_DistSlave| |ECAM: Length of the slave section of the current segment|
|1334|0 to 63|MPRO_ECAM_SegData_Lambda| |ECAM: Lambda value of the current segment|
|1335|0 to 63|MPRO_ECAM_SegData_StatusWord| |ECAM: Status word of the current segment|
|1336|0 to 63|MPRO_ECAM_SegData_ControlWord| |ECAM: Control word of the current segment|

# 8.11.2 Control word for synchronized motion

|Bit|Function|PLC function|Bit number|Description|
|---|---|---|---|---|
|0-7|Start segment (8-bit value)|-|0-7|Actual segment (8-bit value)|
|8-15|Reserved|-| |Actual ECAM / EGEAR state machine state (4 Bit value)|
|16|Absolute (true) / relative (false) master relationship|-| |- 0: ECAM / EGEAR asynchronous
- 1: ECAM / EGEAR synchronous
|
|17|Absolute (true) / relative (false) master (CAM) relationship at cam in|-| |- 2: ECAM / EGEAR synchronizing
- 3: ECAM / EGEAR desynchronizing
|
|18|Absolute (true) / relative (false) slave (CAM) relationship at cam in|-| |- 4: ECAM / EGEAR active and waiting for going asynchronous
|
|19-23|Reserved|-| |- 5: ECAM / EGEAR inactive and waiting for going synchronous
|
|24|Change gear ratio of the electronic gear online|MCB_GearRatioChange| | |
|25|Disable master calculation|MCB_Cam_MasterEnable| | |
|26|Enable master calculation|MCB_Cam_MasterEnable| | |
|27|Select CAM table|MCB_CamTableSelect| | |
|28|Start Ecam|MCB_CamIn| | |
|29|Stop Ecam|MCB_CamOut| | |
|30|Start Egear|MCB_GearIn| | |
|31|Stop Egear|MCB_GearOut| | |

# 8.11.3 Status word for synchronized motion

|Bit|Function|PLC function|Bit number|Description|
|---|---|---|---|---|
|12-26|Reserved|-| | |
|27|ECAM / EGEAR is active|-| | |
|28|Valid segments chosen|-| | |
|29|Master data are valid|-| | |
|30|Master is initialized|-| | |
|31|Master calculation is active|-| | |

Table 8.35: Control word ECAM (P 1318[0] - MPRO_ECAM_ControlWord)

Table 8.36: ECAM status word (P 1326[0] - MPRO_ECAM_StatusWord)

MOOG ID No.:CB40859-001 Date:11/2020 MSD ServoDrive - DeviceHelp 279

# 8 Motion profile

# 8 Motion profile

MOOG ID No.:CB40859-001 Date:11/2020

MSD ServoDrive - DeviceHelp 280

# 8.11.4 Master configuration

the master encoder, you will need to set the resolution relative to a single motor revolution in P 250 - MPRO_ECAM_PARAMaster_Amplitude (see below).

- ENC CH1 (3) = Encoder channel 1 X7 (Sin/Cos)
- ENC CH2 (4) = Encoder channel 2 X6 (Resolver)
- ENC CH3 (5) = Encoder channel 3 X8 (optional)

This function is only available if an external interface X8 (option module) is present.

- TP0 (6) = Pulse counter on probe channel 0 (TP0)
- TP1 (7) = Pulse counter on probe channel 1 (TP1)
- ENC_CH4 (8) = Encoder channel 4 (p. e. fieldbus)
- TWIN_POS (9) = TWIN remote reference position (P-2607)

Image 8.72: “Master configuration” screen

# Channel selection (master encoder)

P 1319[0] - MPRO_ECAM_CamMaster_AxisType is used to define the master encoder.

- NO AXIS (0) = No axis
- VIRTUAL MASTER (1) = Virtual master

If you select this function, you will be able to configure additional settings by clicking on the enabled “Options...” button (see Section ""Virtual Master"" on page 286).

- PARA (2) = Master parameter interface

If you select this function because a higher-level controller is being used as

# Anti-reverse mode

Slave only starts moving along with it again as soon as the master reaches the zero position.

P 1320[0] - MPRO_ECAM_CamMaster_RevLockMode is used to define the reverse lock mode, which can be used either with or without path compensation. The dashed lines in the following diagrams indicate what the engagement distance is:

# Example:

If the master, which has moved two motor revolutions in the direction blocked for the slave, then moves in the unblocked direction again, the slave only moves off when the master has traversed the zero point.

- INACTIVE (0) = Reverse lock inactive
- ACTIVE (2) = Reverse lock enabled - without path optimization
- ACTIVE WAY COMP (1) = Reverse lock active - with way compensation

While the slave accelerates to the speed of the master during engagement, the master and slave do not move synchronously. This function needs to be selected in order to quickly catch up to the master that is running ahead.

# Example:

- Master (black line) rotates in the blocked direction
- The slave (blue line) remains stopped
- Master rotates in the unblocked direction again
- The slave follows the master directly in the unblocked direction

Assume the master has moved two motor revolutions in the direction for which the slave lock is enabled. If the master now moves in the direction for which there is no lock, the slave will immediately start running in that direction.

MOOG ID No.:CB40859-001 Date:11/2020

MSD ServoDrive - DeviceHelp 281

# 8 Motion profile

MOOG ID No.:CB40859-001 Date:11/2020 MSD ServoDrive - DeviceHelp 282

|Filter type|ID|Index Name|Unit|Description|
|---|---|---|---|---|
|When using a real master encoder, encoder signals may be subject to noise.|P 1340|1319|0|MPRO_ECAM_CamMaster_AxisType|
| | |MPRO_ECAM_CamMaster_SpeedFilTyp| |ECAM / EGEAR: Channel selection of internal master input|
| | |1320|0|MPRO_ECAM_CamMaster_RevLockMode|
| | |1321|0|MPRO_ECAM_CamMaster_Amplitude|
| | |1322|0|MPRO_ECAM_CamMaster_GearNum|
| | |1323|0|MPRO_ECAM_CamMaster_GearDen|
|Filter time|1327|0|ms|ECAM / EGEAR: Filter time constant of master|
|If P 1340[0] is used to enable a filter, P 1327[0] - MPRO_ECAM_CamMaster_SpeedTFil can be used to define the corresponding filter time.|1328|0|speed|ECAM / EGEAR: Speed factor of the internal master|
|Speed factor|1340|0| |MPRO_ECAM_CamMaster_SpeedFilTyp|
|The master encoder can be assigned an additional speed factor P 1328[0] - MPRO_ECAM_CamMaster_SpeedFactor.|1341|0|incr|ECAM / EGEAR: Master drive offset|

Table 8.37: “Synchronized motion - Master configuration” parameters (continue)

| | | |ID|Index Name|Unit|Description|
|---|---|---|---|---|---|---|
|247|0|MPRO_ECAM_ParaMaster_ActPos|incr|ECAM / EGEAR: Parameter interface master position| | |
|248|0|MPRO_ECAM_ParaMaster_ActSpeed|rpm|ECAM / EGEAR: Parameter interface master speed| | |
|249|0|MPRO_ECAM_ParaMaster_ActAcc|rpm|ECAM / EGEAR: Parameter interface master acceleration| | |
| |250|0|MPRO_ECAM_ParaMaster_Amplitude| |ECAM / EGEAR: Parameter interface master amplitude| |

Table 8.37: “Synchronized motion - Master configuration” parameters

# 8.11.5 Electronic gearing

# Gear ratio

The gear ratio is specified as a fraction. This ensures that the position references can be translated to the motor shaft with no rounding error.

- ""Slave"" (P 252[0] - MPRO_ECAM_Egear_GearNum) is the numerator
- ""Master"" (P 251[0] - MPRO_ECAM_Egear_GearDen) is the denominator

# Scaling of speed pre-control

Defined with P 265[0] - MPRO_ECAM_CamSlave_SpeedFactor definiert.

# Scaling of torque pre-control

Defined with P 266[0] - MPRO_ECAM_CamSlave_TorqueFactor.

# Engagement

See Section ""Engagement"" on page 284.

# Disengagement

See Section ""Disengagement"" on page 285.

|ID|Index Name|Unit|Description|
|---|---|---|---|
|251|0 MPRO_ECAM_Egear_GearDen| |EGEAR: Gear denominator|
|252|0 MPRO_ECAM_Egear_GearNum| |EGEAR: Numerator of gear ratio|
|1344|0 MPRO_ECAM_Egear_LimRefAcc|rpm/s|EGEAR: Acceleration limit for reference|
|1345|0 MPRO_ECAM_Egear_LimRefJerk|rpm/s²|EGEAR: Jerk limit for reference|

Table 8.38: “Synchronized motion - Electronic gearing” parameters

Image 8.73: ""Electronic gearing"" screen

MOOG ID No.:CB40859-001 Date:11/2020 MSD ServoDrive - DeviceHelp 283

# 8 Motion profile

# 8 Motion profile

MOOG ID No.:CB40859-001 Date:11/2020

MSD ServoDrive - DeviceHelp 284

# 8.11.6 Engagement

used to define the engagement distance (between the dashed lines).

P 253[0] - MPRO_ECAM_Egear_GearInMode is used to define the mode for engagement.

- DIRECT (0) = Direct
- Direct engagement: Angular synchronous; with jerking (no ramps).
- CROSSFADE (3) = Crossfading
- Engagement with crossfading function (5th degree polynomial): Angular synchronous; jerk-limited; speed will overshoot during engagement.
- RAMP (1) = Linear speed ramp
- Engagement with linear acceleration: Not angular synchronous; with jerking.
- FADE (2) = Engagement fade-out
- Engagement with fade-in function (5th degree polynomial): Not angular synchronous; jerk-limited. The position is ignored. ",How is the wait time before the next motion task defined in the 'MSD ServoDrive - DeviceHelp' document?,A4,P 204 parameter specifies the wait time between motion tasks.,1.9609375,1.7890625,3.4375,1.265625,0.3359375
14,msd_servo_drive.txt,76,b87ca5e232c2bdbb6fa16a8a401c6b5d285dc0183e73cc9d134de13dd2fc71d2,"MOOG ID No.:CB40859-001 Date:11/2020

MSD ServoDrive - DeviceHelp 267

# 8 Motion profile

MOOG ID No.:CB40859-001 Date:11/2020 MSD ServoDrive - DeviceHelp 268

# Deceleration

With ...

- P 194 - MPRO_TAB_TDec (for torque control) or
- P 197 - MPRO_TAB_SDec (for speed control) or
- P 200 - MPRO_TAB_PDec (for position control)

and indexes 0–15, the deceleration for each individual motion task can be defined. The input must not be zero.

# Wait time in Auto mode

P 204 - MPRO_TAB_WaitTime is used to define the wait time before the next motion task is carried out.

# Maximum table index in Auto mode

P 206[0] - MPRO_Tab_MaxIdx is used to define the table index up to which driving jobs will be carried out in one of the auto modes.

# Current table index

P 207[0] - MPRO_Tab_ActIdx will show the index for the motion task that is currently active. If parameter P 205 MPRO_TAB_Mode is set to “Para(0)”, a driving set can be entered and approached directly.

# Activation of reference table

The following procedures can be used in order to activate the setpoint table for operation.

|ID|Index Name|Unit|Description|
|---|---|---|---|
|193|MPRO_TAB_TAcc|TAB: Torque mode acceleration|Nm/ms|
|193|0|MPRO_TAB_TAcc|Nm/ms|
|193|1 - 15|MPRO_TAB_TAcc|Nm/ms|
|194|MPRO_TAB_TDec|TAB: Torque mode deceleration| |
|194|0|MPRO_TAB_TDec|Nm/ms|
|194|1 - 15|MPRO_TAB_TDec|Nm/ms|

# Table 8.23: Activation of table references

# Table 8.24: “Setpoint table settings” parameters

# Table 8.24: “Setpoint table settings” parameters (continue)

|ID|Index Name|Unit|Description|ID|Index Name|Unit|Description|
|---|---|---|---|---|---|---|---|
|195|MPRO_TAB_TRef|Nm|TAB: Torque mode reference value|208|MPRO_TAB_OutputNo| |OSD TAB: actual table index and target|
|195|MPRO_TAB_TRef|Nm| |208|MPRO_TAB_OutputNo| | |
|196|MPRO_TAB_SAcc|rev/min/s|TAB: Speed mode acceleration|269|MPRO_TAB_Ctrl| |TAB: control word|
|196|MPRO_TAB_SAcc|rev/min/s| | | | | |
|197|MPRO_TAB_SDec|rev/min/s|TAB: Speed mode deceleration| | | | |
|197|MPRO_TAB_SDec|rev/min/s| | | | | |
|198|MPRO_TAB_SRef|rev/min|TAB: Speed mode reference value| | | | |
|198|MPRO_TAB_SRef|rev/min| | | | | |
|199|MPRO_TAB_PAcc|rev/min/s|TAB: Position control mode acceleration| | | | |
|199|MPRO_TAB_PAcc|rev/min/s| | | | | |
|200|MPRO_TAB_PDec|rev/min/s|TAB: Position control mode Acceleration| | | | |
|200|MPRO_TAB_PDec|rev/min/s| | | | | |
|201|MPRO_TAB_PSpd|rev/min|TAB: Position control mode speed| | | | |
|201|MPRO_TAB_PSpd|rev/min| | | | | |
|202|MPRO_TAB_PPos|mDegree|TAB: Position control mode reference value| | | | |
|202|MPRO_TAB_PPos|mDegree| | | | | |
|203|MPRO_TAB_PMode| |Position control table:Mode| | | | |
|203|MPRO_TAB_PMode| | | | | | |
|204|MPRO_TAB_WaitTime|ms|TAB: Wait time| | | | |
|204|MPRO_TAB_WaitTime|ms| | | | | |
|205|MPRO_TAB_Mode| |TAB mode| | | | |
|206|MPRO_Tab_MaxIdx| |TAB: Max index in AUTO mode| | | | |
|207|MPRO_TAB_ActIdx| |TAB: Actual index| | | | |

MOOG ID No.:CB40859-001 Date:11/2020

MSD ServoDrive - DeviceHelp

# 8 Motion profile

MOOG ID No.:CB40859-001 Date:11/2020

MSD ServoDrive - DeviceHelp 270

# 8.8 Analog channel (ISA00 und ISA01)

# Offset (O)

This parameter (P 174 - MPRO_ANA0_SOffset for ISA00, P 184 - MPRO_ANA1_SOffset for ISA01) compensates for component variations and is used for offset compensation purposes. Depending on the control mode being used (see Section ""Basic settings"" on page 110), the value will be stored in parameter index [0] (torque control), [1] (speed control) or [2] (position control).

# Backlash (B)

This parameter (P 175 - MPRO_ANA0_SThreshold for ISA00, P 185 - MPRO_ANA1_SThreshold for ISA01) can suppress axis motion close to the standstill (stop) position. Depending on the control mode being used (see Section ""Basic settings"" on page 110), the value will be stored in parameter index [0] (torque control), [1] (speed control) or [2] (position control).

Image 8.68: “Analog channel” screen

# Acceleration ramp

Two standard analog inputs (ISA00, ISA01) are available. These inputs can be configured...

- with negative values for analog setpoint settings
- with positive values for digital setpoint processing

(P 109[0] - MPRO_INPUT_FS_ISA00 and P 110[0] - MPRO_INPUT_FS_ISA01).

see also section ""Analog Inputs"" on page 303. By using the ""REV(-2) = Analog setpoint"" setting, an analog input voltage of ±10 V can be processed as a setpoint.

# Deceleration ramp

This parameter serves as a deceleration ramp for torque control (P 176[1] - MPRO_ANA0_TRamp for ISA00, P 186[1] - MPRO_ANA1_TRamp for ISA01) or speed control (P 177[1] - MPRO_ANA0_SRamp for ISA00, P 187[1] - MPRO_ANA1_SRamp for ISA01). Depending on the control mode being used (see Section ""Basic settings"" on page 110), the value will be stored in parameter index [0] (torque control), [1] (speed control) or [2] (position control).

This parameter (P 173 - MPRO_ANA0_Scale for ISA00, P 183 - MPRO_ANA1_Scale for ISA01) is used to define which speed / which torque / which position corresponds to the maximum analog value. Depending on the control mode being used (see Section ""Basic settings"" on page 110), the value will be stored in parameter index [0] (torque control), [1] (speed control) or [2] (position control).

# 8.8.1 Special characteristics of position control mode

A threshold value can also be specified which generates a run-on range around the last reference value. A ramp function calculates a motion profile for the position reference from pre-defined acceleration and speed limits.

The position references on the analog channel are not applied immediately, but dependent on a digital input. Accordingly, one of the ISD00 to ISD06 digital inputs must be set to a value of ""REFANAEN(28) = Enable analog reference value"" (see Section ""Digital inputs"" on page 290). The position setpoint being received will only be applied if the corresponding digital input is active. The acceleration is entered using P 173[0] - MPRO_ANA0_TScale or P 183[0] - MPRO_ANA1_TScale.

# 8.8.2 Wire Break Monitoring

P 399 - CON_ANAWireBrk_Th can be used to configure wire break monitoring for the analog inputs. For details see Section ""Wire Break Monitoring"" on page 306.

|Function|TLIM (-4)|OVR (-3)|REFV (-2)|leer (-1)|OFF (0)|
|---|---|---|---|---|---|
|Digital|(1)-(28)|(1)-(28)|(1)-(28)|(1)-(28)|(1)-(28)|
|Analog channel|Filter|Scale|Offset|Profile|generator|

Control

Image 8.69: Reference processing structure

MOOG ID No.:CB40859-001 Date:11/2020

MSD ServoDrive - DeviceHelp 271

# 8 Motion profile

# 8 Motion profile

MOOG ID No.:CB40859-001 Date:11/2020

|ID|Index Name|Unit|Description|ID|
|---|---|---|---|---|
|395|CON_ANA_Isaf_Scaled| |Analog inputs: Values (filt, norm, comp, scaled)|174|
|395|0 ISA00| |Scaled, compensated, filtered, normalized value|175|
|395|1 ISA01| |Scaled, compensated, filtered, normalized value| |
|396|CON_ANA_Scale_ThUpper| |Analog inputs: Upper scaling limits|175|
|396|0 ISA00|%|Upper scaling (@ 10 V) threshold|175|
|396|1 ISA01|%|Upper scaling (@ 10 V) threshold| |
|397|CON_ANA_Scale_ThZero| |Analog inputs: Zero scaling thresholds|176|
|397|0 ISA00|V|Zero scaling threshold (+/-)|176|
|397|1 ISA01|V|Zero scaling threshold (+/-)| |
|398|CON_ANA_Scale_ThLower| |Analog inputs: Lower scaling limits|177|
|398|0 ISA00|%|Lower scaling (@ zero threshold) threshold|177|
|398|1 ISA01|%|Lower scaling (@ zero threshold) threshold| |
|399|CON_ANA_WireBrk_Th| |Analog inputs: Wire break thresholds|Table 8.26:|
|399|0 ISA00|V|Wire break detection threshold| |
|399|1 ISA01|V|Wire break detection threshold| |
|405|0 CON_ANA_Filt0|ms|Analog input ISA00: Filter time constant (PT 1)|ID|
|408|CON_ANA_Isaf_Norm| |Analog inputs: Values (filt, norm)|183|
|408|0 ISA00| |Filtered, normalized value|183|
|408|1 ISA01| |Filtered, normalized value|183|

Table 8.25: “Analog channel” parameters

|ID|Index Name|Unit|Description|ID|
|---|---|---|---|---|
|173|MPRO_ANA0_Scale| |ANA0: scale factors|184|
|173|0 MPRO_ANA0_TScale|Nm|ANA0: scale factor torque reference|185|
|173|1 MPRO_ANA0_SScale|rev/min|ANA0: scale factor speed reference|185|
|173|2 MPRO_ANA0_PScale|mDegree|ANA0: scale factor position reference| |
|174|MPRO_ANA0_Offset| |ANA0: offsets|185|
|174|0 MPRO_ANA0_TOffset|Nm|ANA0: offsets for torque reference|185|

Table 8.26: “Analog channel ISA00” parameters

|Index Name|Unit|Description|
|---|---|---|
|1 MPRO_ANA0_SOffset|rev/min|ANA0: offsets for speed reference|
|2 MPRO_ANA0_POffset|mDegree|ANA0: offsets for position reference|
|MPRO_ANA0_Threshold| |ANA0: thresholds|
|0 MPRO_ANA0_TThreshold|Nm|ANA0: threshold for torque reference|
|1 MPRO_ANA0_SThreshold|rev/min|ANA0: threshold for speed reference|
|2 MPRO_ANA0_PThreshold|mDegree|ANA0: threshold for position reference|
|MPRO_ANA0_TRamp| |ANA0: Torque mode acceleration [0] and deceleration [1]|
|0 MPRO_ANA0_TRamp|Nm/s| |
|1 MPRO_ANA0_TRamp|Nm/s| |
|MPRO_ANA0_SRamp| |ANA0: Speed mode acceleration [0] and deceleration [1]|
|0 MPRO_ANA0_SRamp|SPEED/s| |
|1 MPRO_ANA0_SRamp|SPEED/s| |

“Analog channel ISA00” parameters (continue)

|Index Name|Unit|Description|
|---|---|---|
|MPRO_ANA1_Scale| |ANA1: scale factors|
|0 MPRO_ANA1_TScale|Nm|ANA0: scale factor torque reference|
|1 MPRO_ANA1_SScale|rev/min|ANA0: scale factor speed reference|
|2 MPRO_ANA1_PScale|mDegree|ANA0: scale factor position reference|
|MPRO_ANA1_Offset| |ANA1: offsets|
|0 MPRO_ANA1_TOffset|Nm|ANA1: offsets for torque reference|
|1 MPRO_ANA1_SOffset|rev/min|ANA1: offsets for speed reference|
|2 MPRO_ANA1_POffset|mDegree|ANA1: offsets for position reference|
|MPRO_ANA1_Threshold| |ANA1: thresholds|
|0 MPRO_ANA1_TThreshold|Nm|ANA1: threshold for torque reference|
|1 MPRO_ANA1_SThreshold|rev/min|ANA1: threshold for speed reference|
|2 MPRO_ANA1_PThreshold|mDegree|ANA1: threshold for position reference|

“Analog channel ISA01” parameters

# 8 Motion profile

|ID|Index Name|Unit|Description|
|---|---|---|---|
|186|MPRO_ANA1_TRamp|Nm/s|ANA1: Torque mode acceleration [0] and deceleration[1]|
|186|MPRO_ANA1_TRamp|Nm/s| |
|187|MPRO_ANA1_SRamp|SPEED/s|ANA1: Speed mode acceleration [0] and deceleration [1]|
|187|MPRO_ANA1_SRamp|SPEED/s| |

# Table 8.27: “Analog channel ISA01” parameters (continue)

Display

- System state
- Initialization on device startup
- Not ready (DC link voltage possibly too low)
- Start inhibit (DC link voltage present, power stage off)
- Starting lockout
- Ready for start
- Control initialization: Auto commutation, flux build-up etc.

# Table 8.28: Central state machine according to CiA 402 device display

MOOG ID No.:CB40859-001 Date:11/2020

MSD ServoDrive - DeviceHelp 273

# 8 Motion profile

MOOG ID No.:CB40859-001 Date:11/2020

MSD ServoDrive - DeviceHelp 274

|Display|System state|power disabled|fault|
|---|---|---|---|
|Control enabled|0|Start|7|
| |fault reaction active|0|14|
|Quick stop active|1|not ready|8|
| |to switch on|1|17|
|Error reaction active|2|switch on|disabled|
| |2|7| |
|Error state (in this state the error is indicated directly on the display.)|3|ready to|switch on|
|Device is reset (display flashes)|power enabled|3|6|
| |10|12| |
|• Number [5.] flashes when “STO” (Safe Torque Off) input is active. Display goes out when STO inactive.| | | |
|• The dot on the display flashes when the power stage is active.| | | |

Table 8.28: Central state machine according to CiA 402 device display (continue)

NOTE

l The system states indicated on the display may differ from the states in the table depending on the drive profile setting.

Image 8.70: State machine diagram based on CANopen communications

⓪ to ① State number

1 to 17 State transition (No. 17: DC link voltage cut off)

Legend for “State machine diagram based on CANopen communications” figure

# 8.10 Touch probe

|ID|Index Name / Setting|
|---|---|
|241|0 MPRO_TP_Position|
|241|1 MPRO_TP_Position|
|241|2 MPRO_TP_Position|
|241|3 MPRO_TP_Position|
|241|4 MPRO_TP_Position|
|1400|0 MPRO_TP_Config|
| |TP_TP (0)|
| |AB (1)|
| |PD_UP (2)|
| |PD_DOWN (3)|
| |PC_PC (4)|
| |PC_TP (5)|
| |TP_PC (6)|
| |ENC_ENC (7)|
| |ENC_TP (8)|
| |TP_ENC (9)|

Using the touch probe inputs, touch probe functions can be performed. In order to be able to do this, P 106[0] - MPRO_INPUT_FS_ISD05 and P 107[0] - MPRO_INPUT_FS_ISD06 must be used to set digital inputs ISD05 and ISD06 to ""PROBE(15) = Touch probe (only ISD05/06)"" (see Section ""Digital inputs"" on page 290). HTL encoders can be evaluated or pulse counters implemented using the MSD PLC.

The touch probe can be triggered with P 240 - MPRO_TP_Ctrl. This enables triggering on a positive or negative edge, or on both edges, of the signal detected on the touch probe inputs. After the measurement, the parameter jumps back to the value ""NONE (0)"" and the latch position is mapped in the corresponding subindex of parameter P 241 - MPRO_TP_Position. A continuous touch probe mode is not possible at present, so the touch probe has to be reactivated after the measurement.

P 1402 - MPRO_TP_Channel can be used to select various positions as actual value sources of the latch position for the touch probe functionality. The following table provides an overview of the available settings. The counters are accessed via the MSD PLC or a bus system.

|ID|Index Name / Setting|Unit|Description|
|---|---|---|---|
|240|MPRO_TP_Ctrl|Touch probe: Control| |
| |0| |NONE (0) = No function|
| |1| |POS (1) = Positive edge|
| |2| |NEG (2) = Negative edge|
| |3| |BOTH (3) = Both edges|
|240|0 MPRO_TP_Ctrl| | |
|240|1 MPRO_TP_Ctrl| | |
|240|2 MPRO_TP_Ctrl| | |
|241|MPRO_TP_Position|Probe: Pos. high/low edge of TP0/1, encoder zero pulse| |

Table 8.29: “Touch probe” parameters

MOOG ID No.:CB40859-001 Date:11/2020

# 8 Motion profile

|Unit|Description|
|---|---|
|mDegree|Touch probe: Configuration|
|mDegree|TP0, TP1 touch probe|
|mDegree|TP0, TP1 as encoder, A/B as quadrature counting|
|mDegree|TP0, TP1 as encoder, pulse (TP0) / direction (TP1), count up on direction high|
|mDegree|TP0, TP1 as encoder, pulse (TP0) / direction (TP1), count down on direction high|
|mDegree|TP0 pulse counter, TP1 pulse counter|
|mDegree|TP0 pulse counter, TP1 touch probe|
|mDegree|TP1 touch probe, TP0 pulse counter|
|mDegree|TP0 encoder counter, TP1 encoder counter|
|mDegree|TP0 encoder counter, TP1 touch probe|
|mDegree|TP0 touch probe, TP1 encoder counter|

Touch probe: Channel

|Unit|Description|
|---|---|
|ACTPOS (0)|Actual position in user units|
|ACTPOSINC (1)|Actual position in increments|
|MASTERPOS (2)|Master position in increments|
|ENCPOS_CH1 (3)|Encoder position Channel 1|
|ENCPOS_CH1_INC (4)|Encoder position Channel 1 in increments|
|ENCPOS_CH2 (5)|Encoder position Channel 2|
|ENCPOS_CH2_INC (6)|Encoder position Channel 2 in increments|

# 8 Motion profile

MOOG ID No.:CB40859-001 Date:11/2020 MSD ServoDrive - DeviceHelp 276

|ID|Index Name / Setting|Unit|Description|
|---|---|---|---|
|7|ENCPOS_CH3 (7)| |Encoder position Channel 3|
|8|ENCPOS_CH3_INC (8)| |Encoder position Channel 3 in increments|
|9|ENCPOS_CH4 (9)| |Encoder position Channel 4|
|10|ENCPOS_CH4_INC (10)| |Encoder position Channel 4 in increments|
|11|ACTPOS2 (11)| |Actual position of redundant encoder in user units|
|12|Sercos (12)| |Referred to Sercos profile parameters S-x-0426, S-x-0427|
|13|UserRefPos(13)| |Reference position in user units|
|14|MasterPosST(14)| |Master position (ECAM, EGEAR) singleturn, always steps|
|15|CommonMasterPos(15)| |Master position (ECAM, EGEAR) singleturn, always steps|
|16|CommonMasterPosST(15)| |Master position (ECAM, EGEAR) singleturn, always steps|
|1402|MPRO_TP_Channel| | |
|1402|MPRO_TP_Channel| | |
|1402|MPRO_TP_Channel| | |
|1404|MPRO_TP_Lines| |Touch probe: Lines @ pulse counter on channel x|
|1404|MPRO_TP_Lines| | |
|1404|MPRO_TP_Lines| | |

Image 8.71: “Synchronized motion” screen

There are various modes available in the “synchronization mode” drop-down menu (P 242[0] - MPRO_ECAM_SyncModMode):

- Off(0) = Synchronized motion off
- ECAM_iPlc(1) = Electronic cam plate via MSD PLC
- EGEAR_iPlc(2) = Electr. gear unit via MSD PLC
- ECAM_PARA(3) = Electronic camming via parameters
- EGEAR_PARA(4) = Electronic gearing via parameters

NOTE: For more information refer to the bus system User Manuals or the description of the MSD PLC.

# 8.11.1 Electronic cam plate

The other parameters are configured in separate screens that can be accessed with the corresponding buttons.

- Master configuration (see Section ""Master configuration"" on page 280)
- Electronic gearing (see Section ""Electronic gearing"" on page 283)
- Electronic camming (see Section ""Electronic cam plate"" on page 277)

P 1318[0] - MPRO_ECAM_ControlWord is the control word for “synchronized motion” (see Section ""Control word for synchronized motion"" on page 279).

P 1326[0] - MPRO_ECAM_StatusWord is the status word for “synchronized motion” (see Section ""Status word for synchronized motion"" on page 279).

# 8.11.1.1 Table selection

|ID|Index Name|Unit|Description|
|---|---|---|---|
|1300|MPRO_ECAM_CTS_| |ECAM: CamTableSelect - Master reference|
|1301|MasterRef| | |
|1305|MPRO_ECAM_CTS_| |ECAM: CamTableSelect - Method for changing the camtable|
|1306|MPRO_ECAM_CTS_| |ECAM: CamTableSelect - Mode for changing the camtable|
|1307|MPRO_ECAM_CTS_|incr|ECAM: CamTableSelect - Distance for changing the camtable|
|242|MPRO_ECAM_| |ECAM / EGEAR: Mode of synchronized motion SyncModMode|
|265|MPRO_ECAM_| |ECAM / EGEAR: Slave speed factor (1 = 100%).|
|266|CamSlave_SpeedFactor| | |
|268|MPRO_ECAM_| |ECAM / EGEAR: Mode of switching off sync. motion|

# 8.11.1.2 Synchronization

|ID|Index Name|Unit|Description|
|---|---|---|---|
|1342|MPRO_ECAM_CI_|incr|ECAM: CamIn - Synchronization position (multiturn part)|
|1343|MPRO_ECAM_CO_|incr|ECAM: CamOut - Decoupling pos. (multiturn part)|
|1303|MPRO_ECAM_CI_|incr|ECAM: CamIn - Master offset|
|1308|MPRO_ECAM_CI_| |ECAM: CamIn - Master reference|
|1309|MPRO_ECAM_CI_| |ECAM: CamIn - Slave reference|
|1310|MPRO_ECAM_CI_| |ECAM: CamIn - Coupling mode|
|1311|MPRO_ECAM_CI_|incr|ECAM: CamIn - Coupling distance|
|1312|MPRO_ECAM_CI_|incr|ECAM: CamIn - Synchronization position|

Table 8.31: “Electronic camming - Table selection” parameters

Table 8.30: “Synchronized motion” parameters

Table 8.32: “Electronic camming - Synchronization” parameters

MOOG ID No.:CB40859-001 Date:11/2020

MSD ServoDrive - DeviceHelp 277

# 8 Motion profile

MOOG ID No.:CB40859-001 Date:11/2020 MSD ServoDrive - DeviceHelp 278

|ID|Index|Name|Unit|Description|
|---|---|---|---|---|
|1313|0|MPRO_ECAM_CO_SyncPosST|(singleturn part)|ECAM: CamOut - Slave reference|
|1314|0|MPRO_ECAM_CO_DecouplingMode|63|ECAM: CamOut - Decoupling mode|
|1315|0|MPRO_ECAM_CO_BreakingPosST|incr|ECAM: CamOut - Decoupling position|
|1316|0|MPRO_ECAM_CO_DecouplingDist|incr|ECAM: CamOut - Decoupling distance|
|1317|0|MPRO_ECAM_CO_StandstillPos|mDegree|ECAM: CamOut - Slave standstill position|

# Table 8.32: “Electronic camming - Synchronization” parameters (continue)

|ID|Index|Name|Unit|Description|
|---|---|---|---|---|
|1346| |MPRO_ECAM_SP_Table| |ECAM: Setpoint table interface|
|1346|0|Index| |Index of setpoint table|
|1346|1|Value| |Value at index of setpoint table|
|1347|0 to 31|MPRO_ECAM_SP_Index| |ECAM: Setpoint segments start index|
|1348|0 to 31|MPRO_ECAM_SP_Length| |ECAM: Setpoint segments length|
|1349|0 to 31|Length| | |
|1350|0|MPRO_ECAM_SP_MaDist| |ECAM: Setpoint segments master distance|
|1351|0|MPRO_ECAM_SP_IpoType| |ECAM: Setpoint segments interpolation type|
|1352|0 to 31|Checksum| |ECAM: Setpoint table checksum|
|1353|0 to 31|GainNum| |ECAM: Setpoint segments gain numerator|
| | |GainDen| |ECAM: Setpoint segments gain denominator|

# Table 8.33: “Electronic camming - Table segments” parameters

|ID|Index|Name|Unit|Description|
|---|---|---|---|---|
|1329|0 to 63|MPRO_ECAM_SegData_IndexNext| |ECAM: Index of the following segment|
|1330|0 to 63|MPRO_ECAM_SegData_IndexPrev| |ECAM: Index of the previous segment|
|1331|0 to 63|MPRO_ECAM_SegData_ProfileMode| |ECAM: Profile mode of the current segment|
|1332|0 to 63|MPRO_ECAM_SegData_DistMaster| |ECAM: Length of the master section of the current segment|
|1333|0 to 63|MPRO_ECAM_SegData_DistSlave| |ECAM: Length of the slave section of the current segment|
|1334|0 to 63|MPRO_ECAM_SegData_Lambda| |ECAM: Lambda value of the current segment|
|1335|0 to 63|MPRO_ECAM_SegData_StatusWord| |ECAM: Status word of the current segment|
|1336|0 to 63|MPRO_ECAM_SegData_ControlWord| |ECAM: Control word of the current segment|

# 8.11.2 Control word for synchronized motion

|Bit|Function|PLC function|Bit number|Description|
|---|---|---|---|---|
|0-7|Start segment (8-bit value)|-|0-7|Actual segment (8-bit value)|
|8-15|Reserved|-| |Actual ECAM / EGEAR state machine state (4 Bit value)|
|16|Absolute (true) / relative (false) master relationship|-| |- 0: ECAM / EGEAR asynchronous
- 1: ECAM / EGEAR synchronous
|
|17|Absolute (true) / relative (false) master (CAM) relationship at cam in|-| |- 2: ECAM / EGEAR synchronizing
- 3: ECAM / EGEAR desynchronizing
|
|18|Absolute (true) / relative (false) slave (CAM) relationship at cam in|-| |- 4: ECAM / EGEAR active and waiting for going asynchronous
|
|19-23|Reserved|-| |- 5: ECAM / EGEAR inactive and waiting for going synchronous
|
|24|Change gear ratio of the electronic gear online|MCB_GearRatioChange| | |
|25|Disable master calculation|MCB_Cam_MasterEnable| | |
|26|Enable master calculation|MCB_Cam_MasterEnable| | |
|27|Select CAM table|MCB_CamTableSelect| | |
|28|Start Ecam|MCB_CamIn| | |
|29|Stop Ecam|MCB_CamOut| | |
|30|Start Egear|MCB_GearIn| | |
|31|Stop Egear|MCB_GearOut| | |

# 8.11.3 Status word for synchronized motion

|Bit|Function|PLC function|Bit number|Description|
|---|---|---|---|---|
|12-26|Reserved|-| | |
|27|ECAM / EGEAR is active|-| | |
|28|Valid segments chosen|-| | |
|29|Master data are valid|-| | |
|30|Master is initialized|-| | |
|31|Master calculation is active|-| | |

Table 8.35: Control word ECAM (P 1318[0] - MPRO_ECAM_ControlWord)

Table 8.36: ECAM status word (P 1326[0] - MPRO_ECAM_StatusWord)

MOOG ID No.:CB40859-001 Date:11/2020 MSD ServoDrive - DeviceHelp 279

# 8 Motion profile

# 8 Motion profile

MOOG ID No.:CB40859-001 Date:11/2020

MSD ServoDrive - DeviceHelp 280

# 8.11.4 Master configuration

the master encoder, you will need to set the resolution relative to a single motor revolution in P 250 - MPRO_ECAM_PARAMaster_Amplitude (see below).

- ENC CH1 (3) = Encoder channel 1 X7 (Sin/Cos)
- ENC CH2 (4) = Encoder channel 2 X6 (Resolver)
- ENC CH3 (5) = Encoder channel 3 X8 (optional)

This function is only available if an external interface X8 (option module) is present.

- TP0 (6) = Pulse counter on probe channel 0 (TP0)
- TP1 (7) = Pulse counter on probe channel 1 (TP1)
- ENC_CH4 (8) = Encoder channel 4 (p. e. fieldbus)
- TWIN_POS (9) = TWIN remote reference position (P-2607)

Image 8.72: “Master configuration” screen

# Channel selection (master encoder)

P 1319[0] - MPRO_ECAM_CamMaster_AxisType is used to define the master encoder.

- NO AXIS (0) = No axis
- VIRTUAL MASTER (1) = Virtual master

If you select this function, you will be able to configure additional settings by clicking on the enabled “Options...” button (see Section ""Virtual Master"" on page 286).

- PARA (2) = Master parameter interface

If you select this function because a higher-level controller is being used as

# Anti-reverse mode

Slave only starts moving along with it again as soon as the master reaches the zero position.

P 1320[0] - MPRO_ECAM_CamMaster_RevLockMode is used to define the reverse lock mode, which can be used either with or without path compensation. The dashed lines in the following diagrams indicate what the engagement distance is:

# Example:

If the master, which has moved two motor revolutions in the direction blocked for the slave, then moves in the unblocked direction again, the slave only moves off when the master has traversed the zero point.

- INACTIVE (0) = Reverse lock inactive
- ACTIVE (2) = Reverse lock enabled - without path optimization
- ACTIVE WAY COMP (1) = Reverse lock active - with way compensation

While the slave accelerates to the speed of the master during engagement, the master and slave do not move synchronously. This function needs to be selected in order to quickly catch up to the master that is running ahead.

# Example:

- Master (black line) rotates in the blocked direction
- The slave (blue line) remains stopped
- Master rotates in the unblocked direction again
- The slave follows the master directly in the unblocked direction

Assume the master has moved two motor revolutions in the direction for which the slave lock is enabled. If the master now moves in the direction for which there is no lock, the slave will immediately start running in that direction.

MOOG ID No.:CB40859-001 Date:11/2020

MSD ServoDrive - DeviceHelp 281

# 8 Motion profile

MOOG ID No.:CB40859-001 Date:11/2020 MSD ServoDrive - DeviceHelp 282

|Filter type|ID|Index Name|Unit|Description|
|---|---|---|---|---|
|When using a real master encoder, encoder signals may be subject to noise.|P 1340|1319|0|MPRO_ECAM_CamMaster_AxisType|
| | |MPRO_ECAM_CamMaster_SpeedFilTyp| |ECAM / EGEAR: Channel selection of internal master input|
| | |1320|0|MPRO_ECAM_CamMaster_RevLockMode|
| | |1321|0|MPRO_ECAM_CamMaster_Amplitude|
| | |1322|0|MPRO_ECAM_CamMaster_GearNum|
| | |1323|0|MPRO_ECAM_CamMaster_GearDen|
|Filter time|1327|0|ms|ECAM / EGEAR: Filter time constant of master|
|If P 1340[0] is used to enable a filter, P 1327[0] - MPRO_ECAM_CamMaster_SpeedTFil can be used to define the corresponding filter time.|1328|0|speed|ECAM / EGEAR: Speed factor of the internal master|
|Speed factor|1340|0| |MPRO_ECAM_CamMaster_SpeedFilTyp|
|The master encoder can be assigned an additional speed factor P 1328[0] - MPRO_ECAM_CamMaster_SpeedFactor.|1341|0|incr|ECAM / EGEAR: Master drive offset|

Table 8.37: “Synchronized motion - Master configuration” parameters (continue)

| | | |ID|Index Name|Unit|Description|
|---|---|---|---|---|---|---|
|247|0|MPRO_ECAM_ParaMaster_ActPos|incr|ECAM / EGEAR: Parameter interface master position| | |
|248|0|MPRO_ECAM_ParaMaster_ActSpeed|rpm|ECAM / EGEAR: Parameter interface master speed| | |
|249|0|MPRO_ECAM_ParaMaster_ActAcc|rpm|ECAM / EGEAR: Parameter interface master acceleration| | |
| |250|0|MPRO_ECAM_ParaMaster_Amplitude| |ECAM / EGEAR: Parameter interface master amplitude| |

Table 8.37: “Synchronized motion - Master configuration” parameters

# 8.11.5 Electronic gearing

# Gear ratio

The gear ratio is specified as a fraction. This ensures that the position references can be translated to the motor shaft with no rounding error.

- ""Slave"" (P 252[0] - MPRO_ECAM_Egear_GearNum) is the numerator
- ""Master"" (P 251[0] - MPRO_ECAM_Egear_GearDen) is the denominator

# Scaling of speed pre-control

Defined with P 265[0] - MPRO_ECAM_CamSlave_SpeedFactor definiert.

# Scaling of torque pre-control

Defined with P 266[0] - MPRO_ECAM_CamSlave_TorqueFactor.

# Engagement

See Section ""Engagement"" on page 284.

# Disengagement

See Section ""Disengagement"" on page 285.

|ID|Index Name|Unit|Description|
|---|---|---|---|
|251|0 MPRO_ECAM_Egear_GearDen| |EGEAR: Gear denominator|
|252|0 MPRO_ECAM_Egear_GearNum| |EGEAR: Numerator of gear ratio|
|1344|0 MPRO_ECAM_Egear_LimRefAcc|rpm/s|EGEAR: Acceleration limit for reference|
|1345|0 MPRO_ECAM_Egear_LimRefJerk|rpm/s²|EGEAR: Jerk limit for reference|

Table 8.38: “Synchronized motion - Electronic gearing” parameters

Image 8.73: ""Electronic gearing"" screen

MOOG ID No.:CB40859-001 Date:11/2020 MSD ServoDrive - DeviceHelp 283

# 8 Motion profile

# 8 Motion profile

MOOG ID No.:CB40859-001 Date:11/2020

MSD ServoDrive - DeviceHelp 284

# 8.11.6 Engagement

used to define the engagement distance (between the dashed lines).

P 253[0] - MPRO_ECAM_Egear_GearInMode is used to define the mode for engagement.

- DIRECT (0) = Direct
- Direct engagement: Angular synchronous; with jerking (no ramps).
- CROSSFADE (3) = Crossfading
- Engagement with crossfading function (5th degree polynomial): Angular synchronous; jerk-limited; speed will overshoot during engagement.
- RAMP (1) = Linear speed ramp
- Engagement with linear acceleration: Not angular synchronous; with jerking.
- FADE (2) = Engagement fade-out
- Engagement with fade-in function (5th degree polynomial): Not angular synchronous; jerk-limited. The position is ignored. ",How is the wait time before the next motion task defined in the 'MSD ServoDrive - DeviceHelp' document?,A5,"In the document, P 204 controls the wait time before the next motion task starts.",2.0625,1.9140625,3.5625,1.28125,0.451171875
15,msd_servo_drive.txt,76,b87ca5e232c2bdbb6fa16a8a401c6b5d285dc0183e73cc9d134de13dd2fc71d2,"MOOG ID No.:CB40859-001 Date:11/2020

MSD ServoDrive - DeviceHelp 267

# 8 Motion profile

MOOG ID No.:CB40859-001 Date:11/2020 MSD ServoDrive - DeviceHelp 268

# Deceleration

With ...

- P 194 - MPRO_TAB_TDec (for torque control) or
- P 197 - MPRO_TAB_SDec (for speed control) or
- P 200 - MPRO_TAB_PDec (for position control)

and indexes 0–15, the deceleration for each individual motion task can be defined. The input must not be zero.

# Wait time in Auto mode

P 204 - MPRO_TAB_WaitTime is used to define the wait time before the next motion task is carried out.

# Maximum table index in Auto mode

P 206[0] - MPRO_Tab_MaxIdx is used to define the table index up to which driving jobs will be carried out in one of the auto modes.

# Current table index

P 207[0] - MPRO_Tab_ActIdx will show the index for the motion task that is currently active. If parameter P 205 MPRO_TAB_Mode is set to “Para(0)”, a driving set can be entered and approached directly.

# Activation of reference table

The following procedures can be used in order to activate the setpoint table for operation.

|ID|Index Name|Unit|Description|
|---|---|---|---|
|193|MPRO_TAB_TAcc|TAB: Torque mode acceleration|Nm/ms|
|193|0|MPRO_TAB_TAcc|Nm/ms|
|193|1 - 15|MPRO_TAB_TAcc|Nm/ms|
|194|MPRO_TAB_TDec|TAB: Torque mode deceleration| |
|194|0|MPRO_TAB_TDec|Nm/ms|
|194|1 - 15|MPRO_TAB_TDec|Nm/ms|

# Table 8.23: Activation of table references

# Table 8.24: “Setpoint table settings” parameters

# Table 8.24: “Setpoint table settings” parameters (continue)

|ID|Index Name|Unit|Description|ID|Index Name|Unit|Description|
|---|---|---|---|---|---|---|---|
|195|MPRO_TAB_TRef|Nm|TAB: Torque mode reference value|208|MPRO_TAB_OutputNo| |OSD TAB: actual table index and target|
|195|MPRO_TAB_TRef|Nm| |208|MPRO_TAB_OutputNo| | |
|196|MPRO_TAB_SAcc|rev/min/s|TAB: Speed mode acceleration|269|MPRO_TAB_Ctrl| |TAB: control word|
|196|MPRO_TAB_SAcc|rev/min/s| | | | | |
|197|MPRO_TAB_SDec|rev/min/s|TAB: Speed mode deceleration| | | | |
|197|MPRO_TAB_SDec|rev/min/s| | | | | |
|198|MPRO_TAB_SRef|rev/min|TAB: Speed mode reference value| | | | |
|198|MPRO_TAB_SRef|rev/min| | | | | |
|199|MPRO_TAB_PAcc|rev/min/s|TAB: Position control mode acceleration| | | | |
|199|MPRO_TAB_PAcc|rev/min/s| | | | | |
|200|MPRO_TAB_PDec|rev/min/s|TAB: Position control mode Acceleration| | | | |
|200|MPRO_TAB_PDec|rev/min/s| | | | | |
|201|MPRO_TAB_PSpd|rev/min|TAB: Position control mode speed| | | | |
|201|MPRO_TAB_PSpd|rev/min| | | | | |
|202|MPRO_TAB_PPos|mDegree|TAB: Position control mode reference value| | | | |
|202|MPRO_TAB_PPos|mDegree| | | | | |
|203|MPRO_TAB_PMode| |Position control table:Mode| | | | |
|203|MPRO_TAB_PMode| | | | | | |
|204|MPRO_TAB_WaitTime|ms|TAB: Wait time| | | | |
|204|MPRO_TAB_WaitTime|ms| | | | | |
|205|MPRO_TAB_Mode| |TAB mode| | | | |
|206|MPRO_Tab_MaxIdx| |TAB: Max index in AUTO mode| | | | |
|207|MPRO_TAB_ActIdx| |TAB: Actual index| | | | |

MOOG ID No.:CB40859-001 Date:11/2020

MSD ServoDrive - DeviceHelp

# 8 Motion profile

MOOG ID No.:CB40859-001 Date:11/2020

MSD ServoDrive - DeviceHelp 270

# 8.8 Analog channel (ISA00 und ISA01)

# Offset (O)

This parameter (P 174 - MPRO_ANA0_SOffset for ISA00, P 184 - MPRO_ANA1_SOffset for ISA01) compensates for component variations and is used for offset compensation purposes. Depending on the control mode being used (see Section ""Basic settings"" on page 110), the value will be stored in parameter index [0] (torque control), [1] (speed control) or [2] (position control).

# Backlash (B)

This parameter (P 175 - MPRO_ANA0_SThreshold for ISA00, P 185 - MPRO_ANA1_SThreshold for ISA01) can suppress axis motion close to the standstill (stop) position. Depending on the control mode being used (see Section ""Basic settings"" on page 110), the value will be stored in parameter index [0] (torque control), [1] (speed control) or [2] (position control).

Image 8.68: “Analog channel” screen

# Acceleration ramp

Two standard analog inputs (ISA00, ISA01) are available. These inputs can be configured...

- with negative values for analog setpoint settings
- with positive values for digital setpoint processing

(P 109[0] - MPRO_INPUT_FS_ISA00 and P 110[0] - MPRO_INPUT_FS_ISA01).

see also section ""Analog Inputs"" on page 303. By using the ""REV(-2) = Analog setpoint"" setting, an analog input voltage of ±10 V can be processed as a setpoint.

# Deceleration ramp

This parameter serves as a deceleration ramp for torque control (P 176[1] - MPRO_ANA0_TRamp for ISA00, P 186[1] - MPRO_ANA1_TRamp for ISA01) or speed control (P 177[1] - MPRO_ANA0_SRamp for ISA00, P 187[1] - MPRO_ANA1_SRamp for ISA01). Depending on the control mode being used (see Section ""Basic settings"" on page 110), the value will be stored in parameter index [0] (torque control), [1] (speed control) or [2] (position control).

This parameter (P 173 - MPRO_ANA0_Scale for ISA00, P 183 - MPRO_ANA1_Scale for ISA01) is used to define which speed / which torque / which position corresponds to the maximum analog value. Depending on the control mode being used (see Section ""Basic settings"" on page 110), the value will be stored in parameter index [0] (torque control), [1] (speed control) or [2] (position control).

# 8.8.1 Special characteristics of position control mode

A threshold value can also be specified which generates a run-on range around the last reference value. A ramp function calculates a motion profile for the position reference from pre-defined acceleration and speed limits.

The position references on the analog channel are not applied immediately, but dependent on a digital input. Accordingly, one of the ISD00 to ISD06 digital inputs must be set to a value of ""REFANAEN(28) = Enable analog reference value"" (see Section ""Digital inputs"" on page 290). The position setpoint being received will only be applied if the corresponding digital input is active. The acceleration is entered using P 173[0] - MPRO_ANA0_TScale or P 183[0] - MPRO_ANA1_TScale.

# 8.8.2 Wire Break Monitoring

P 399 - CON_ANAWireBrk_Th can be used to configure wire break monitoring for the analog inputs. For details see Section ""Wire Break Monitoring"" on page 306.

|Function|TLIM (-4)|OVR (-3)|REFV (-2)|leer (-1)|OFF (0)|
|---|---|---|---|---|---|
|Digital|(1)-(28)|(1)-(28)|(1)-(28)|(1)-(28)|(1)-(28)|
|Analog channel|Filter|Scale|Offset|Profile|generator|

Control

Image 8.69: Reference processing structure

MOOG ID No.:CB40859-001 Date:11/2020

MSD ServoDrive - DeviceHelp 271

# 8 Motion profile

# 8 Motion profile

MOOG ID No.:CB40859-001 Date:11/2020

|ID|Index Name|Unit|Description|ID|
|---|---|---|---|---|
|395|CON_ANA_Isaf_Scaled| |Analog inputs: Values (filt, norm, comp, scaled)|174|
|395|0 ISA00| |Scaled, compensated, filtered, normalized value|175|
|395|1 ISA01| |Scaled, compensated, filtered, normalized value| |
|396|CON_ANA_Scale_ThUpper| |Analog inputs: Upper scaling limits|175|
|396|0 ISA00|%|Upper scaling (@ 10 V) threshold|175|
|396|1 ISA01|%|Upper scaling (@ 10 V) threshold| |
|397|CON_ANA_Scale_ThZero| |Analog inputs: Zero scaling thresholds|176|
|397|0 ISA00|V|Zero scaling threshold (+/-)|176|
|397|1 ISA01|V|Zero scaling threshold (+/-)| |
|398|CON_ANA_Scale_ThLower| |Analog inputs: Lower scaling limits|177|
|398|0 ISA00|%|Lower scaling (@ zero threshold) threshold|177|
|398|1 ISA01|%|Lower scaling (@ zero threshold) threshold| |
|399|CON_ANA_WireBrk_Th| |Analog inputs: Wire break thresholds|Table 8.26:|
|399|0 ISA00|V|Wire break detection threshold| |
|399|1 ISA01|V|Wire break detection threshold| |
|405|0 CON_ANA_Filt0|ms|Analog input ISA00: Filter time constant (PT 1)|ID|
|408|CON_ANA_Isaf_Norm| |Analog inputs: Values (filt, norm)|183|
|408|0 ISA00| |Filtered, normalized value|183|
|408|1 ISA01| |Filtered, normalized value|183|

Table 8.25: “Analog channel” parameters

|ID|Index Name|Unit|Description|ID|
|---|---|---|---|---|
|173|MPRO_ANA0_Scale| |ANA0: scale factors|184|
|173|0 MPRO_ANA0_TScale|Nm|ANA0: scale factor torque reference|185|
|173|1 MPRO_ANA0_SScale|rev/min|ANA0: scale factor speed reference|185|
|173|2 MPRO_ANA0_PScale|mDegree|ANA0: scale factor position reference| |
|174|MPRO_ANA0_Offset| |ANA0: offsets|185|
|174|0 MPRO_ANA0_TOffset|Nm|ANA0: offsets for torque reference|185|

Table 8.26: “Analog channel ISA00” parameters

|Index Name|Unit|Description|
|---|---|---|
|1 MPRO_ANA0_SOffset|rev/min|ANA0: offsets for speed reference|
|2 MPRO_ANA0_POffset|mDegree|ANA0: offsets for position reference|
|MPRO_ANA0_Threshold| |ANA0: thresholds|
|0 MPRO_ANA0_TThreshold|Nm|ANA0: threshold for torque reference|
|1 MPRO_ANA0_SThreshold|rev/min|ANA0: threshold for speed reference|
|2 MPRO_ANA0_PThreshold|mDegree|ANA0: threshold for position reference|
|MPRO_ANA0_TRamp| |ANA0: Torque mode acceleration [0] and deceleration [1]|
|0 MPRO_ANA0_TRamp|Nm/s| |
|1 MPRO_ANA0_TRamp|Nm/s| |
|MPRO_ANA0_SRamp| |ANA0: Speed mode acceleration [0] and deceleration [1]|
|0 MPRO_ANA0_SRamp|SPEED/s| |
|1 MPRO_ANA0_SRamp|SPEED/s| |

“Analog channel ISA00” parameters (continue)

|Index Name|Unit|Description|
|---|---|---|
|MPRO_ANA1_Scale| |ANA1: scale factors|
|0 MPRO_ANA1_TScale|Nm|ANA0: scale factor torque reference|
|1 MPRO_ANA1_SScale|rev/min|ANA0: scale factor speed reference|
|2 MPRO_ANA1_PScale|mDegree|ANA0: scale factor position reference|
|MPRO_ANA1_Offset| |ANA1: offsets|
|0 MPRO_ANA1_TOffset|Nm|ANA1: offsets for torque reference|
|1 MPRO_ANA1_SOffset|rev/min|ANA1: offsets for speed reference|
|2 MPRO_ANA1_POffset|mDegree|ANA1: offsets for position reference|
|MPRO_ANA1_Threshold| |ANA1: thresholds|
|0 MPRO_ANA1_TThreshold|Nm|ANA1: threshold for torque reference|
|1 MPRO_ANA1_SThreshold|rev/min|ANA1: threshold for speed reference|
|2 MPRO_ANA1_PThreshold|mDegree|ANA1: threshold for position reference|

“Analog channel ISA01” parameters

# 8 Motion profile

|ID|Index Name|Unit|Description|
|---|---|---|---|
|186|MPRO_ANA1_TRamp|Nm/s|ANA1: Torque mode acceleration [0] and deceleration[1]|
|186|MPRO_ANA1_TRamp|Nm/s| |
|187|MPRO_ANA1_SRamp|SPEED/s|ANA1: Speed mode acceleration [0] and deceleration [1]|
|187|MPRO_ANA1_SRamp|SPEED/s| |

# Table 8.27: “Analog channel ISA01” parameters (continue)

Display

- System state
- Initialization on device startup
- Not ready (DC link voltage possibly too low)
- Start inhibit (DC link voltage present, power stage off)
- Starting lockout
- Ready for start
- Control initialization: Auto commutation, flux build-up etc.

# Table 8.28: Central state machine according to CiA 402 device display

MOOG ID No.:CB40859-001 Date:11/2020

MSD ServoDrive - DeviceHelp 273

# 8 Motion profile

MOOG ID No.:CB40859-001 Date:11/2020

MSD ServoDrive - DeviceHelp 274

|Display|System state|power disabled|fault|
|---|---|---|---|
|Control enabled|0|Start|7|
| |fault reaction active|0|14|
|Quick stop active|1|not ready|8|
| |to switch on|1|17|
|Error reaction active|2|switch on|disabled|
| |2|7| |
|Error state (in this state the error is indicated directly on the display.)|3|ready to|switch on|
|Device is reset (display flashes)|power enabled|3|6|
| |10|12| |
|• Number [5.] flashes when “STO” (Safe Torque Off) input is active. Display goes out when STO inactive.| | | |
|• The dot on the display flashes when the power stage is active.| | | |

Table 8.28: Central state machine according to CiA 402 device display (continue)

NOTE

l The system states indicated on the display may differ from the states in the table depending on the drive profile setting.

Image 8.70: State machine diagram based on CANopen communications

⓪ to ① State number

1 to 17 State transition (No. 17: DC link voltage cut off)

Legend for “State machine diagram based on CANopen communications” figure

# 8.10 Touch probe

|ID|Index Name / Setting|
|---|---|
|241|0 MPRO_TP_Position|
|241|1 MPRO_TP_Position|
|241|2 MPRO_TP_Position|
|241|3 MPRO_TP_Position|
|241|4 MPRO_TP_Position|
|1400|0 MPRO_TP_Config|
| |TP_TP (0)|
| |AB (1)|
| |PD_UP (2)|
| |PD_DOWN (3)|
| |PC_PC (4)|
| |PC_TP (5)|
| |TP_PC (6)|
| |ENC_ENC (7)|
| |ENC_TP (8)|
| |TP_ENC (9)|

Using the touch probe inputs, touch probe functions can be performed. In order to be able to do this, P 106[0] - MPRO_INPUT_FS_ISD05 and P 107[0] - MPRO_INPUT_FS_ISD06 must be used to set digital inputs ISD05 and ISD06 to ""PROBE(15) = Touch probe (only ISD05/06)"" (see Section ""Digital inputs"" on page 290). HTL encoders can be evaluated or pulse counters implemented using the MSD PLC.

The touch probe can be triggered with P 240 - MPRO_TP_Ctrl. This enables triggering on a positive or negative edge, or on both edges, of the signal detected on the touch probe inputs. After the measurement, the parameter jumps back to the value ""NONE (0)"" and the latch position is mapped in the corresponding subindex of parameter P 241 - MPRO_TP_Position. A continuous touch probe mode is not possible at present, so the touch probe has to be reactivated after the measurement.

P 1402 - MPRO_TP_Channel can be used to select various positions as actual value sources of the latch position for the touch probe functionality. The following table provides an overview of the available settings. The counters are accessed via the MSD PLC or a bus system.

|ID|Index Name / Setting|Unit|Description|
|---|---|---|---|
|240|MPRO_TP_Ctrl|Touch probe: Control| |
| |0| |NONE (0) = No function|
| |1| |POS (1) = Positive edge|
| |2| |NEG (2) = Negative edge|
| |3| |BOTH (3) = Both edges|
|240|0 MPRO_TP_Ctrl| | |
|240|1 MPRO_TP_Ctrl| | |
|240|2 MPRO_TP_Ctrl| | |
|241|MPRO_TP_Position|Probe: Pos. high/low edge of TP0/1, encoder zero pulse| |

Table 8.29: “Touch probe” parameters

MOOG ID No.:CB40859-001 Date:11/2020

# 8 Motion profile

|Unit|Description|
|---|---|
|mDegree|Touch probe: Configuration|
|mDegree|TP0, TP1 touch probe|
|mDegree|TP0, TP1 as encoder, A/B as quadrature counting|
|mDegree|TP0, TP1 as encoder, pulse (TP0) / direction (TP1), count up on direction high|
|mDegree|TP0, TP1 as encoder, pulse (TP0) / direction (TP1), count down on direction high|
|mDegree|TP0 pulse counter, TP1 pulse counter|
|mDegree|TP0 pulse counter, TP1 touch probe|
|mDegree|TP1 touch probe, TP0 pulse counter|
|mDegree|TP0 encoder counter, TP1 encoder counter|
|mDegree|TP0 encoder counter, TP1 touch probe|
|mDegree|TP0 touch probe, TP1 encoder counter|

Touch probe: Channel

|Unit|Description|
|---|---|
|ACTPOS (0)|Actual position in user units|
|ACTPOSINC (1)|Actual position in increments|
|MASTERPOS (2)|Master position in increments|
|ENCPOS_CH1 (3)|Encoder position Channel 1|
|ENCPOS_CH1_INC (4)|Encoder position Channel 1 in increments|
|ENCPOS_CH2 (5)|Encoder position Channel 2|
|ENCPOS_CH2_INC (6)|Encoder position Channel 2 in increments|

# 8 Motion profile

MOOG ID No.:CB40859-001 Date:11/2020 MSD ServoDrive - DeviceHelp 276

|ID|Index Name / Setting|Unit|Description|
|---|---|---|---|
|7|ENCPOS_CH3 (7)| |Encoder position Channel 3|
|8|ENCPOS_CH3_INC (8)| |Encoder position Channel 3 in increments|
|9|ENCPOS_CH4 (9)| |Encoder position Channel 4|
|10|ENCPOS_CH4_INC (10)| |Encoder position Channel 4 in increments|
|11|ACTPOS2 (11)| |Actual position of redundant encoder in user units|
|12|Sercos (12)| |Referred to Sercos profile parameters S-x-0426, S-x-0427|
|13|UserRefPos(13)| |Reference position in user units|
|14|MasterPosST(14)| |Master position (ECAM, EGEAR) singleturn, always steps|
|15|CommonMasterPos(15)| |Master position (ECAM, EGEAR) singleturn, always steps|
|16|CommonMasterPosST(15)| |Master position (ECAM, EGEAR) singleturn, always steps|
|1402|MPRO_TP_Channel| | |
|1402|MPRO_TP_Channel| | |
|1402|MPRO_TP_Channel| | |
|1404|MPRO_TP_Lines| |Touch probe: Lines @ pulse counter on channel x|
|1404|MPRO_TP_Lines| | |
|1404|MPRO_TP_Lines| | |

Image 8.71: “Synchronized motion” screen

There are various modes available in the “synchronization mode” drop-down menu (P 242[0] - MPRO_ECAM_SyncModMode):

- Off(0) = Synchronized motion off
- ECAM_iPlc(1) = Electronic cam plate via MSD PLC
- EGEAR_iPlc(2) = Electr. gear unit via MSD PLC
- ECAM_PARA(3) = Electronic camming via parameters
- EGEAR_PARA(4) = Electronic gearing via parameters

NOTE: For more information refer to the bus system User Manuals or the description of the MSD PLC.

# 8.11.1 Electronic cam plate

The other parameters are configured in separate screens that can be accessed with the corresponding buttons.

- Master configuration (see Section ""Master configuration"" on page 280)
- Electronic gearing (see Section ""Electronic gearing"" on page 283)
- Electronic camming (see Section ""Electronic cam plate"" on page 277)

P 1318[0] - MPRO_ECAM_ControlWord is the control word for “synchronized motion” (see Section ""Control word for synchronized motion"" on page 279).

P 1326[0] - MPRO_ECAM_StatusWord is the status word for “synchronized motion” (see Section ""Status word for synchronized motion"" on page 279).

# 8.11.1.1 Table selection

|ID|Index Name|Unit|Description|
|---|---|---|---|
|1300|MPRO_ECAM_CTS_| |ECAM: CamTableSelect - Master reference|
|1301|MasterRef| | |
|1305|MPRO_ECAM_CTS_| |ECAM: CamTableSelect - Method for changing the camtable|
|1306|MPRO_ECAM_CTS_| |ECAM: CamTableSelect - Mode for changing the camtable|
|1307|MPRO_ECAM_CTS_|incr|ECAM: CamTableSelect - Distance for changing the camtable|
|242|MPRO_ECAM_| |ECAM / EGEAR: Mode of synchronized motion SyncModMode|
|265|MPRO_ECAM_| |ECAM / EGEAR: Slave speed factor (1 = 100%).|
|266|CamSlave_SpeedFactor| | |
|268|MPRO_ECAM_| |ECAM / EGEAR: Mode of switching off sync. motion|

# 8.11.1.2 Synchronization

|ID|Index Name|Unit|Description|
|---|---|---|---|
|1342|MPRO_ECAM_CI_|incr|ECAM: CamIn - Synchronization position (multiturn part)|
|1343|MPRO_ECAM_CO_|incr|ECAM: CamOut - Decoupling pos. (multiturn part)|
|1303|MPRO_ECAM_CI_|incr|ECAM: CamIn - Master offset|
|1308|MPRO_ECAM_CI_| |ECAM: CamIn - Master reference|
|1309|MPRO_ECAM_CI_| |ECAM: CamIn - Slave reference|
|1310|MPRO_ECAM_CI_| |ECAM: CamIn - Coupling mode|
|1311|MPRO_ECAM_CI_|incr|ECAM: CamIn - Coupling distance|
|1312|MPRO_ECAM_CI_|incr|ECAM: CamIn - Synchronization position|

Table 8.31: “Electronic camming - Table selection” parameters

Table 8.30: “Synchronized motion” parameters

Table 8.32: “Electronic camming - Synchronization” parameters

MOOG ID No.:CB40859-001 Date:11/2020

MSD ServoDrive - DeviceHelp 277

# 8 Motion profile

MOOG ID No.:CB40859-001 Date:11/2020 MSD ServoDrive - DeviceHelp 278

|ID|Index|Name|Unit|Description|
|---|---|---|---|---|
|1313|0|MPRO_ECAM_CO_SyncPosST|(singleturn part)|ECAM: CamOut - Slave reference|
|1314|0|MPRO_ECAM_CO_DecouplingMode|63|ECAM: CamOut - Decoupling mode|
|1315|0|MPRO_ECAM_CO_BreakingPosST|incr|ECAM: CamOut - Decoupling position|
|1316|0|MPRO_ECAM_CO_DecouplingDist|incr|ECAM: CamOut - Decoupling distance|
|1317|0|MPRO_ECAM_CO_StandstillPos|mDegree|ECAM: CamOut - Slave standstill position|

# Table 8.32: “Electronic camming - Synchronization” parameters (continue)

|ID|Index|Name|Unit|Description|
|---|---|---|---|---|
|1346| |MPRO_ECAM_SP_Table| |ECAM: Setpoint table interface|
|1346|0|Index| |Index of setpoint table|
|1346|1|Value| |Value at index of setpoint table|
|1347|0 to 31|MPRO_ECAM_SP_Index| |ECAM: Setpoint segments start index|
|1348|0 to 31|MPRO_ECAM_SP_Length| |ECAM: Setpoint segments length|
|1349|0 to 31|Length| | |
|1350|0|MPRO_ECAM_SP_MaDist| |ECAM: Setpoint segments master distance|
|1351|0|MPRO_ECAM_SP_IpoType| |ECAM: Setpoint segments interpolation type|
|1352|0 to 31|Checksum| |ECAM: Setpoint table checksum|
|1353|0 to 31|GainNum| |ECAM: Setpoint segments gain numerator|
| | |GainDen| |ECAM: Setpoint segments gain denominator|

# Table 8.33: “Electronic camming - Table segments” parameters

|ID|Index|Name|Unit|Description|
|---|---|---|---|---|
|1329|0 to 63|MPRO_ECAM_SegData_IndexNext| |ECAM: Index of the following segment|
|1330|0 to 63|MPRO_ECAM_SegData_IndexPrev| |ECAM: Index of the previous segment|
|1331|0 to 63|MPRO_ECAM_SegData_ProfileMode| |ECAM: Profile mode of the current segment|
|1332|0 to 63|MPRO_ECAM_SegData_DistMaster| |ECAM: Length of the master section of the current segment|
|1333|0 to 63|MPRO_ECAM_SegData_DistSlave| |ECAM: Length of the slave section of the current segment|
|1334|0 to 63|MPRO_ECAM_SegData_Lambda| |ECAM: Lambda value of the current segment|
|1335|0 to 63|MPRO_ECAM_SegData_StatusWord| |ECAM: Status word of the current segment|
|1336|0 to 63|MPRO_ECAM_SegData_ControlWord| |ECAM: Control word of the current segment|

# 8.11.2 Control word for synchronized motion

|Bit|Function|PLC function|Bit number|Description|
|---|---|---|---|---|
|0-7|Start segment (8-bit value)|-|0-7|Actual segment (8-bit value)|
|8-15|Reserved|-| |Actual ECAM / EGEAR state machine state (4 Bit value)|
|16|Absolute (true) / relative (false) master relationship|-| |- 0: ECAM / EGEAR asynchronous
- 1: ECAM / EGEAR synchronous
|
|17|Absolute (true) / relative (false) master (CAM) relationship at cam in|-| |- 2: ECAM / EGEAR synchronizing
- 3: ECAM / EGEAR desynchronizing
|
|18|Absolute (true) / relative (false) slave (CAM) relationship at cam in|-| |- 4: ECAM / EGEAR active and waiting for going asynchronous
|
|19-23|Reserved|-| |- 5: ECAM / EGEAR inactive and waiting for going synchronous
|
|24|Change gear ratio of the electronic gear online|MCB_GearRatioChange| | |
|25|Disable master calculation|MCB_Cam_MasterEnable| | |
|26|Enable master calculation|MCB_Cam_MasterEnable| | |
|27|Select CAM table|MCB_CamTableSelect| | |
|28|Start Ecam|MCB_CamIn| | |
|29|Stop Ecam|MCB_CamOut| | |
|30|Start Egear|MCB_GearIn| | |
|31|Stop Egear|MCB_GearOut| | |

# 8.11.3 Status word for synchronized motion

|Bit|Function|PLC function|Bit number|Description|
|---|---|---|---|---|
|12-26|Reserved|-| | |
|27|ECAM / EGEAR is active|-| | |
|28|Valid segments chosen|-| | |
|29|Master data are valid|-| | |
|30|Master is initialized|-| | |
|31|Master calculation is active|-| | |

Table 8.35: Control word ECAM (P 1318[0] - MPRO_ECAM_ControlWord)

Table 8.36: ECAM status word (P 1326[0] - MPRO_ECAM_StatusWord)

MOOG ID No.:CB40859-001 Date:11/2020 MSD ServoDrive - DeviceHelp 279

# 8 Motion profile

# 8 Motion profile

MOOG ID No.:CB40859-001 Date:11/2020

MSD ServoDrive - DeviceHelp 280

# 8.11.4 Master configuration

the master encoder, you will need to set the resolution relative to a single motor revolution in P 250 - MPRO_ECAM_PARAMaster_Amplitude (see below).

- ENC CH1 (3) = Encoder channel 1 X7 (Sin/Cos)
- ENC CH2 (4) = Encoder channel 2 X6 (Resolver)
- ENC CH3 (5) = Encoder channel 3 X8 (optional)

This function is only available if an external interface X8 (option module) is present.

- TP0 (6) = Pulse counter on probe channel 0 (TP0)
- TP1 (7) = Pulse counter on probe channel 1 (TP1)
- ENC_CH4 (8) = Encoder channel 4 (p. e. fieldbus)
- TWIN_POS (9) = TWIN remote reference position (P-2607)

Image 8.72: “Master configuration” screen

# Channel selection (master encoder)

P 1319[0] - MPRO_ECAM_CamMaster_AxisType is used to define the master encoder.

- NO AXIS (0) = No axis
- VIRTUAL MASTER (1) = Virtual master

If you select this function, you will be able to configure additional settings by clicking on the enabled “Options...” button (see Section ""Virtual Master"" on page 286).

- PARA (2) = Master parameter interface

If you select this function because a higher-level controller is being used as

# Anti-reverse mode

Slave only starts moving along with it again as soon as the master reaches the zero position.

P 1320[0] - MPRO_ECAM_CamMaster_RevLockMode is used to define the reverse lock mode, which can be used either with or without path compensation. The dashed lines in the following diagrams indicate what the engagement distance is:

# Example:

If the master, which has moved two motor revolutions in the direction blocked for the slave, then moves in the unblocked direction again, the slave only moves off when the master has traversed the zero point.

- INACTIVE (0) = Reverse lock inactive
- ACTIVE (2) = Reverse lock enabled - without path optimization
- ACTIVE WAY COMP (1) = Reverse lock active - with way compensation

While the slave accelerates to the speed of the master during engagement, the master and slave do not move synchronously. This function needs to be selected in order to quickly catch up to the master that is running ahead.

# Example:

- Master (black line) rotates in the blocked direction
- The slave (blue line) remains stopped
- Master rotates in the unblocked direction again
- The slave follows the master directly in the unblocked direction

Assume the master has moved two motor revolutions in the direction for which the slave lock is enabled. If the master now moves in the direction for which there is no lock, the slave will immediately start running in that direction.

MOOG ID No.:CB40859-001 Date:11/2020

MSD ServoDrive - DeviceHelp 281

# 8 Motion profile

MOOG ID No.:CB40859-001 Date:11/2020 MSD ServoDrive - DeviceHelp 282

|Filter type|ID|Index Name|Unit|Description|
|---|---|---|---|---|
|When using a real master encoder, encoder signals may be subject to noise.|P 1340|1319|0|MPRO_ECAM_CamMaster_AxisType|
| | |MPRO_ECAM_CamMaster_SpeedFilTyp| |ECAM / EGEAR: Channel selection of internal master input|
| | |1320|0|MPRO_ECAM_CamMaster_RevLockMode|
| | |1321|0|MPRO_ECAM_CamMaster_Amplitude|
| | |1322|0|MPRO_ECAM_CamMaster_GearNum|
| | |1323|0|MPRO_ECAM_CamMaster_GearDen|
|Filter time|1327|0|ms|ECAM / EGEAR: Filter time constant of master|
|If P 1340[0] is used to enable a filter, P 1327[0] - MPRO_ECAM_CamMaster_SpeedTFil can be used to define the corresponding filter time.|1328|0|speed|ECAM / EGEAR: Speed factor of the internal master|
|Speed factor|1340|0| |MPRO_ECAM_CamMaster_SpeedFilTyp|
|The master encoder can be assigned an additional speed factor P 1328[0] - MPRO_ECAM_CamMaster_SpeedFactor.|1341|0|incr|ECAM / EGEAR: Master drive offset|

Table 8.37: “Synchronized motion - Master configuration” parameters (continue)

| | | |ID|Index Name|Unit|Description|
|---|---|---|---|---|---|---|
|247|0|MPRO_ECAM_ParaMaster_ActPos|incr|ECAM / EGEAR: Parameter interface master position| | |
|248|0|MPRO_ECAM_ParaMaster_ActSpeed|rpm|ECAM / EGEAR: Parameter interface master speed| | |
|249|0|MPRO_ECAM_ParaMaster_ActAcc|rpm|ECAM / EGEAR: Parameter interface master acceleration| | |
| |250|0|MPRO_ECAM_ParaMaster_Amplitude| |ECAM / EGEAR: Parameter interface master amplitude| |

Table 8.37: “Synchronized motion - Master configuration” parameters

# 8.11.5 Electronic gearing

# Gear ratio

The gear ratio is specified as a fraction. This ensures that the position references can be translated to the motor shaft with no rounding error.

- ""Slave"" (P 252[0] - MPRO_ECAM_Egear_GearNum) is the numerator
- ""Master"" (P 251[0] - MPRO_ECAM_Egear_GearDen) is the denominator

# Scaling of speed pre-control

Defined with P 265[0] - MPRO_ECAM_CamSlave_SpeedFactor definiert.

# Scaling of torque pre-control

Defined with P 266[0] - MPRO_ECAM_CamSlave_TorqueFactor.

# Engagement

See Section ""Engagement"" on page 284.

# Disengagement

See Section ""Disengagement"" on page 285.

|ID|Index Name|Unit|Description|
|---|---|---|---|
|251|0 MPRO_ECAM_Egear_GearDen| |EGEAR: Gear denominator|
|252|0 MPRO_ECAM_Egear_GearNum| |EGEAR: Numerator of gear ratio|
|1344|0 MPRO_ECAM_Egear_LimRefAcc|rpm/s|EGEAR: Acceleration limit for reference|
|1345|0 MPRO_ECAM_Egear_LimRefJerk|rpm/s²|EGEAR: Jerk limit for reference|

Table 8.38: “Synchronized motion - Electronic gearing” parameters

Image 8.73: ""Electronic gearing"" screen

MOOG ID No.:CB40859-001 Date:11/2020 MSD ServoDrive - DeviceHelp 283

# 8 Motion profile

# 8 Motion profile

MOOG ID No.:CB40859-001 Date:11/2020

MSD ServoDrive - DeviceHelp 284

# 8.11.6 Engagement

used to define the engagement distance (between the dashed lines).

P 253[0] - MPRO_ECAM_Egear_GearInMode is used to define the mode for engagement.

- DIRECT (0) = Direct
- Direct engagement: Angular synchronous; with jerking (no ramps).
- CROSSFADE (3) = Crossfading
- Engagement with crossfading function (5th degree polynomial): Angular synchronous; jerk-limited; speed will overshoot during engagement.
- RAMP (1) = Linear speed ramp
- Engagement with linear acceleration: Not angular synchronous; with jerking.
- FADE (2) = Engagement fade-out
- Engagement with fade-in function (5th degree polynomial): Not angular synchronous; jerk-limited. The position is ignored. ",How is wire break monitoring configured for the analog inputs in the 'MSD ServoDrive - DeviceHelp' document?,A1,P 399 - CON_ANAWireBrk_Th configures wire break monitoring.,0.9296875,0.7578125,2.90625,1.203125,0.2890625
16,msd_servo_drive.txt,76,b87ca5e232c2bdbb6fa16a8a401c6b5d285dc0183e73cc9d134de13dd2fc71d2,"MOOG ID No.:CB40859-001 Date:11/2020

MSD ServoDrive - DeviceHelp 267

# 8 Motion profile

MOOG ID No.:CB40859-001 Date:11/2020 MSD ServoDrive - DeviceHelp 268

# Deceleration

With ...

- P 194 - MPRO_TAB_TDec (for torque control) or
- P 197 - MPRO_TAB_SDec (for speed control) or
- P 200 - MPRO_TAB_PDec (for position control)

and indexes 0–15, the deceleration for each individual motion task can be defined. The input must not be zero.

# Wait time in Auto mode

P 204 - MPRO_TAB_WaitTime is used to define the wait time before the next motion task is carried out.

# Maximum table index in Auto mode

P 206[0] - MPRO_Tab_MaxIdx is used to define the table index up to which driving jobs will be carried out in one of the auto modes.

# Current table index

P 207[0] - MPRO_Tab_ActIdx will show the index for the motion task that is currently active. If parameter P 205 MPRO_TAB_Mode is set to “Para(0)”, a driving set can be entered and approached directly.

# Activation of reference table

The following procedures can be used in order to activate the setpoint table for operation.

|ID|Index Name|Unit|Description|
|---|---|---|---|
|193|MPRO_TAB_TAcc|TAB: Torque mode acceleration|Nm/ms|
|193|0|MPRO_TAB_TAcc|Nm/ms|
|193|1 - 15|MPRO_TAB_TAcc|Nm/ms|
|194|MPRO_TAB_TDec|TAB: Torque mode deceleration| |
|194|0|MPRO_TAB_TDec|Nm/ms|
|194|1 - 15|MPRO_TAB_TDec|Nm/ms|

# Table 8.23: Activation of table references

# Table 8.24: “Setpoint table settings” parameters

# Table 8.24: “Setpoint table settings” parameters (continue)

|ID|Index Name|Unit|Description|ID|Index Name|Unit|Description|
|---|---|---|---|---|---|---|---|
|195|MPRO_TAB_TRef|Nm|TAB: Torque mode reference value|208|MPRO_TAB_OutputNo| |OSD TAB: actual table index and target|
|195|MPRO_TAB_TRef|Nm| |208|MPRO_TAB_OutputNo| | |
|196|MPRO_TAB_SAcc|rev/min/s|TAB: Speed mode acceleration|269|MPRO_TAB_Ctrl| |TAB: control word|
|196|MPRO_TAB_SAcc|rev/min/s| | | | | |
|197|MPRO_TAB_SDec|rev/min/s|TAB: Speed mode deceleration| | | | |
|197|MPRO_TAB_SDec|rev/min/s| | | | | |
|198|MPRO_TAB_SRef|rev/min|TAB: Speed mode reference value| | | | |
|198|MPRO_TAB_SRef|rev/min| | | | | |
|199|MPRO_TAB_PAcc|rev/min/s|TAB: Position control mode acceleration| | | | |
|199|MPRO_TAB_PAcc|rev/min/s| | | | | |
|200|MPRO_TAB_PDec|rev/min/s|TAB: Position control mode Acceleration| | | | |
|200|MPRO_TAB_PDec|rev/min/s| | | | | |
|201|MPRO_TAB_PSpd|rev/min|TAB: Position control mode speed| | | | |
|201|MPRO_TAB_PSpd|rev/min| | | | | |
|202|MPRO_TAB_PPos|mDegree|TAB: Position control mode reference value| | | | |
|202|MPRO_TAB_PPos|mDegree| | | | | |
|203|MPRO_TAB_PMode| |Position control table:Mode| | | | |
|203|MPRO_TAB_PMode| | | | | | |
|204|MPRO_TAB_WaitTime|ms|TAB: Wait time| | | | |
|204|MPRO_TAB_WaitTime|ms| | | | | |
|205|MPRO_TAB_Mode| |TAB mode| | | | |
|206|MPRO_Tab_MaxIdx| |TAB: Max index in AUTO mode| | | | |
|207|MPRO_TAB_ActIdx| |TAB: Actual index| | | | |

MOOG ID No.:CB40859-001 Date:11/2020

MSD ServoDrive - DeviceHelp

# 8 Motion profile

MOOG ID No.:CB40859-001 Date:11/2020

MSD ServoDrive - DeviceHelp 270

# 8.8 Analog channel (ISA00 und ISA01)

# Offset (O)

This parameter (P 174 - MPRO_ANA0_SOffset for ISA00, P 184 - MPRO_ANA1_SOffset for ISA01) compensates for component variations and is used for offset compensation purposes. Depending on the control mode being used (see Section ""Basic settings"" on page 110), the value will be stored in parameter index [0] (torque control), [1] (speed control) or [2] (position control).

# Backlash (B)

This parameter (P 175 - MPRO_ANA0_SThreshold for ISA00, P 185 - MPRO_ANA1_SThreshold for ISA01) can suppress axis motion close to the standstill (stop) position. Depending on the control mode being used (see Section ""Basic settings"" on page 110), the value will be stored in parameter index [0] (torque control), [1] (speed control) or [2] (position control).

Image 8.68: “Analog channel” screen

# Acceleration ramp

Two standard analog inputs (ISA00, ISA01) are available. These inputs can be configured...

- with negative values for analog setpoint settings
- with positive values for digital setpoint processing

(P 109[0] - MPRO_INPUT_FS_ISA00 and P 110[0] - MPRO_INPUT_FS_ISA01).

see also section ""Analog Inputs"" on page 303. By using the ""REV(-2) = Analog setpoint"" setting, an analog input voltage of ±10 V can be processed as a setpoint.

# Deceleration ramp

This parameter serves as a deceleration ramp for torque control (P 176[1] - MPRO_ANA0_TRamp for ISA00, P 186[1] - MPRO_ANA1_TRamp for ISA01) or speed control (P 177[1] - MPRO_ANA0_SRamp for ISA00, P 187[1] - MPRO_ANA1_SRamp for ISA01). Depending on the control mode being used (see Section ""Basic settings"" on page 110), the value will be stored in parameter index [0] (torque control), [1] (speed control) or [2] (position control).

This parameter (P 173 - MPRO_ANA0_Scale for ISA00, P 183 - MPRO_ANA1_Scale for ISA01) is used to define which speed / which torque / which position corresponds to the maximum analog value. Depending on the control mode being used (see Section ""Basic settings"" on page 110), the value will be stored in parameter index [0] (torque control), [1] (speed control) or [2] (position control).

# 8.8.1 Special characteristics of position control mode

A threshold value can also be specified which generates a run-on range around the last reference value. A ramp function calculates a motion profile for the position reference from pre-defined acceleration and speed limits.

The position references on the analog channel are not applied immediately, but dependent on a digital input. Accordingly, one of the ISD00 to ISD06 digital inputs must be set to a value of ""REFANAEN(28) = Enable analog reference value"" (see Section ""Digital inputs"" on page 290). The position setpoint being received will only be applied if the corresponding digital input is active. The acceleration is entered using P 173[0] - MPRO_ANA0_TScale or P 183[0] - MPRO_ANA1_TScale.

# 8.8.2 Wire Break Monitoring

P 399 - CON_ANAWireBrk_Th can be used to configure wire break monitoring for the analog inputs. For details see Section ""Wire Break Monitoring"" on page 306.

|Function|TLIM (-4)|OVR (-3)|REFV (-2)|leer (-1)|OFF (0)|
|---|---|---|---|---|---|
|Digital|(1)-(28)|(1)-(28)|(1)-(28)|(1)-(28)|(1)-(28)|
|Analog channel|Filter|Scale|Offset|Profile|generator|

Control

Image 8.69: Reference processing structure

MOOG ID No.:CB40859-001 Date:11/2020

MSD ServoDrive - DeviceHelp 271

# 8 Motion profile

# 8 Motion profile

MOOG ID No.:CB40859-001 Date:11/2020

|ID|Index Name|Unit|Description|ID|
|---|---|---|---|---|
|395|CON_ANA_Isaf_Scaled| |Analog inputs: Values (filt, norm, comp, scaled)|174|
|395|0 ISA00| |Scaled, compensated, filtered, normalized value|175|
|395|1 ISA01| |Scaled, compensated, filtered, normalized value| |
|396|CON_ANA_Scale_ThUpper| |Analog inputs: Upper scaling limits|175|
|396|0 ISA00|%|Upper scaling (@ 10 V) threshold|175|
|396|1 ISA01|%|Upper scaling (@ 10 V) threshold| |
|397|CON_ANA_Scale_ThZero| |Analog inputs: Zero scaling thresholds|176|
|397|0 ISA00|V|Zero scaling threshold (+/-)|176|
|397|1 ISA01|V|Zero scaling threshold (+/-)| |
|398|CON_ANA_Scale_ThLower| |Analog inputs: Lower scaling limits|177|
|398|0 ISA00|%|Lower scaling (@ zero threshold) threshold|177|
|398|1 ISA01|%|Lower scaling (@ zero threshold) threshold| |
|399|CON_ANA_WireBrk_Th| |Analog inputs: Wire break thresholds|Table 8.26:|
|399|0 ISA00|V|Wire break detection threshold| |
|399|1 ISA01|V|Wire break detection threshold| |
|405|0 CON_ANA_Filt0|ms|Analog input ISA00: Filter time constant (PT 1)|ID|
|408|CON_ANA_Isaf_Norm| |Analog inputs: Values (filt, norm)|183|
|408|0 ISA00| |Filtered, normalized value|183|
|408|1 ISA01| |Filtered, normalized value|183|

Table 8.25: “Analog channel” parameters

|ID|Index Name|Unit|Description|ID|
|---|---|---|---|---|
|173|MPRO_ANA0_Scale| |ANA0: scale factors|184|
|173|0 MPRO_ANA0_TScale|Nm|ANA0: scale factor torque reference|185|
|173|1 MPRO_ANA0_SScale|rev/min|ANA0: scale factor speed reference|185|
|173|2 MPRO_ANA0_PScale|mDegree|ANA0: scale factor position reference| |
|174|MPRO_ANA0_Offset| |ANA0: offsets|185|
|174|0 MPRO_ANA0_TOffset|Nm|ANA0: offsets for torque reference|185|

Table 8.26: “Analog channel ISA00” parameters

|Index Name|Unit|Description|
|---|---|---|
|1 MPRO_ANA0_SOffset|rev/min|ANA0: offsets for speed reference|
|2 MPRO_ANA0_POffset|mDegree|ANA0: offsets for position reference|
|MPRO_ANA0_Threshold| |ANA0: thresholds|
|0 MPRO_ANA0_TThreshold|Nm|ANA0: threshold for torque reference|
|1 MPRO_ANA0_SThreshold|rev/min|ANA0: threshold for speed reference|
|2 MPRO_ANA0_PThreshold|mDegree|ANA0: threshold for position reference|
|MPRO_ANA0_TRamp| |ANA0: Torque mode acceleration [0] and deceleration [1]|
|0 MPRO_ANA0_TRamp|Nm/s| |
|1 MPRO_ANA0_TRamp|Nm/s| |
|MPRO_ANA0_SRamp| |ANA0: Speed mode acceleration [0] and deceleration [1]|
|0 MPRO_ANA0_SRamp|SPEED/s| |
|1 MPRO_ANA0_SRamp|SPEED/s| |

“Analog channel ISA00” parameters (continue)

|Index Name|Unit|Description|
|---|---|---|
|MPRO_ANA1_Scale| |ANA1: scale factors|
|0 MPRO_ANA1_TScale|Nm|ANA0: scale factor torque reference|
|1 MPRO_ANA1_SScale|rev/min|ANA0: scale factor speed reference|
|2 MPRO_ANA1_PScale|mDegree|ANA0: scale factor position reference|
|MPRO_ANA1_Offset| |ANA1: offsets|
|0 MPRO_ANA1_TOffset|Nm|ANA1: offsets for torque reference|
|1 MPRO_ANA1_SOffset|rev/min|ANA1: offsets for speed reference|
|2 MPRO_ANA1_POffset|mDegree|ANA1: offsets for position reference|
|MPRO_ANA1_Threshold| |ANA1: thresholds|
|0 MPRO_ANA1_TThreshold|Nm|ANA1: threshold for torque reference|
|1 MPRO_ANA1_SThreshold|rev/min|ANA1: threshold for speed reference|
|2 MPRO_ANA1_PThreshold|mDegree|ANA1: threshold for position reference|

“Analog channel ISA01” parameters

# 8 Motion profile

|ID|Index Name|Unit|Description|
|---|---|---|---|
|186|MPRO_ANA1_TRamp|Nm/s|ANA1: Torque mode acceleration [0] and deceleration[1]|
|186|MPRO_ANA1_TRamp|Nm/s| |
|187|MPRO_ANA1_SRamp|SPEED/s|ANA1: Speed mode acceleration [0] and deceleration [1]|
|187|MPRO_ANA1_SRamp|SPEED/s| |

# Table 8.27: “Analog channel ISA01” parameters (continue)

Display

- System state
- Initialization on device startup
- Not ready (DC link voltage possibly too low)
- Start inhibit (DC link voltage present, power stage off)
- Starting lockout
- Ready for start
- Control initialization: Auto commutation, flux build-up etc.

# Table 8.28: Central state machine according to CiA 402 device display

MOOG ID No.:CB40859-001 Date:11/2020

MSD ServoDrive - DeviceHelp 273

# 8 Motion profile

MOOG ID No.:CB40859-001 Date:11/2020

MSD ServoDrive - DeviceHelp 274

|Display|System state|power disabled|fault|
|---|---|---|---|
|Control enabled|0|Start|7|
| |fault reaction active|0|14|
|Quick stop active|1|not ready|8|
| |to switch on|1|17|
|Error reaction active|2|switch on|disabled|
| |2|7| |
|Error state (in this state the error is indicated directly on the display.)|3|ready to|switch on|
|Device is reset (display flashes)|power enabled|3|6|
| |10|12| |
|• Number [5.] flashes when “STO” (Safe Torque Off) input is active. Display goes out when STO inactive.| | | |
|• The dot on the display flashes when the power stage is active.| | | |

Table 8.28: Central state machine according to CiA 402 device display (continue)

NOTE

l The system states indicated on the display may differ from the states in the table depending on the drive profile setting.

Image 8.70: State machine diagram based on CANopen communications

⓪ to ① State number

1 to 17 State transition (No. 17: DC link voltage cut off)

Legend for “State machine diagram based on CANopen communications” figure

# 8.10 Touch probe

|ID|Index Name / Setting|
|---|---|
|241|0 MPRO_TP_Position|
|241|1 MPRO_TP_Position|
|241|2 MPRO_TP_Position|
|241|3 MPRO_TP_Position|
|241|4 MPRO_TP_Position|
|1400|0 MPRO_TP_Config|
| |TP_TP (0)|
| |AB (1)|
| |PD_UP (2)|
| |PD_DOWN (3)|
| |PC_PC (4)|
| |PC_TP (5)|
| |TP_PC (6)|
| |ENC_ENC (7)|
| |ENC_TP (8)|
| |TP_ENC (9)|

Using the touch probe inputs, touch probe functions can be performed. In order to be able to do this, P 106[0] - MPRO_INPUT_FS_ISD05 and P 107[0] - MPRO_INPUT_FS_ISD06 must be used to set digital inputs ISD05 and ISD06 to ""PROBE(15) = Touch probe (only ISD05/06)"" (see Section ""Digital inputs"" on page 290). HTL encoders can be evaluated or pulse counters implemented using the MSD PLC.

The touch probe can be triggered with P 240 - MPRO_TP_Ctrl. This enables triggering on a positive or negative edge, or on both edges, of the signal detected on the touch probe inputs. After the measurement, the parameter jumps back to the value ""NONE (0)"" and the latch position is mapped in the corresponding subindex of parameter P 241 - MPRO_TP_Position. A continuous touch probe mode is not possible at present, so the touch probe has to be reactivated after the measurement.

P 1402 - MPRO_TP_Channel can be used to select various positions as actual value sources of the latch position for the touch probe functionality. The following table provides an overview of the available settings. The counters are accessed via the MSD PLC or a bus system.

|ID|Index Name / Setting|Unit|Description|
|---|---|---|---|
|240|MPRO_TP_Ctrl|Touch probe: Control| |
| |0| |NONE (0) = No function|
| |1| |POS (1) = Positive edge|
| |2| |NEG (2) = Negative edge|
| |3| |BOTH (3) = Both edges|
|240|0 MPRO_TP_Ctrl| | |
|240|1 MPRO_TP_Ctrl| | |
|240|2 MPRO_TP_Ctrl| | |
|241|MPRO_TP_Position|Probe: Pos. high/low edge of TP0/1, encoder zero pulse| |

Table 8.29: “Touch probe” parameters

MOOG ID No.:CB40859-001 Date:11/2020

# 8 Motion profile

|Unit|Description|
|---|---|
|mDegree|Touch probe: Configuration|
|mDegree|TP0, TP1 touch probe|
|mDegree|TP0, TP1 as encoder, A/B as quadrature counting|
|mDegree|TP0, TP1 as encoder, pulse (TP0) / direction (TP1), count up on direction high|
|mDegree|TP0, TP1 as encoder, pulse (TP0) / direction (TP1), count down on direction high|
|mDegree|TP0 pulse counter, TP1 pulse counter|
|mDegree|TP0 pulse counter, TP1 touch probe|
|mDegree|TP1 touch probe, TP0 pulse counter|
|mDegree|TP0 encoder counter, TP1 encoder counter|
|mDegree|TP0 encoder counter, TP1 touch probe|
|mDegree|TP0 touch probe, TP1 encoder counter|

Touch probe: Channel

|Unit|Description|
|---|---|
|ACTPOS (0)|Actual position in user units|
|ACTPOSINC (1)|Actual position in increments|
|MASTERPOS (2)|Master position in increments|
|ENCPOS_CH1 (3)|Encoder position Channel 1|
|ENCPOS_CH1_INC (4)|Encoder position Channel 1 in increments|
|ENCPOS_CH2 (5)|Encoder position Channel 2|
|ENCPOS_CH2_INC (6)|Encoder position Channel 2 in increments|

# 8 Motion profile

MOOG ID No.:CB40859-001 Date:11/2020 MSD ServoDrive - DeviceHelp 276

|ID|Index Name / Setting|Unit|Description|
|---|---|---|---|
|7|ENCPOS_CH3 (7)| |Encoder position Channel 3|
|8|ENCPOS_CH3_INC (8)| |Encoder position Channel 3 in increments|
|9|ENCPOS_CH4 (9)| |Encoder position Channel 4|
|10|ENCPOS_CH4_INC (10)| |Encoder position Channel 4 in increments|
|11|ACTPOS2 (11)| |Actual position of redundant encoder in user units|
|12|Sercos (12)| |Referred to Sercos profile parameters S-x-0426, S-x-0427|
|13|UserRefPos(13)| |Reference position in user units|
|14|MasterPosST(14)| |Master position (ECAM, EGEAR) singleturn, always steps|
|15|CommonMasterPos(15)| |Master position (ECAM, EGEAR) singleturn, always steps|
|16|CommonMasterPosST(15)| |Master position (ECAM, EGEAR) singleturn, always steps|
|1402|MPRO_TP_Channel| | |
|1402|MPRO_TP_Channel| | |
|1402|MPRO_TP_Channel| | |
|1404|MPRO_TP_Lines| |Touch probe: Lines @ pulse counter on channel x|
|1404|MPRO_TP_Lines| | |
|1404|MPRO_TP_Lines| | |

Image 8.71: “Synchronized motion” screen

There are various modes available in the “synchronization mode” drop-down menu (P 242[0] - MPRO_ECAM_SyncModMode):

- Off(0) = Synchronized motion off
- ECAM_iPlc(1) = Electronic cam plate via MSD PLC
- EGEAR_iPlc(2) = Electr. gear unit via MSD PLC
- ECAM_PARA(3) = Electronic camming via parameters
- EGEAR_PARA(4) = Electronic gearing via parameters

NOTE: For more information refer to the bus system User Manuals or the description of the MSD PLC.

# 8.11.1 Electronic cam plate

The other parameters are configured in separate screens that can be accessed with the corresponding buttons.

- Master configuration (see Section ""Master configuration"" on page 280)
- Electronic gearing (see Section ""Electronic gearing"" on page 283)
- Electronic camming (see Section ""Electronic cam plate"" on page 277)

P 1318[0] - MPRO_ECAM_ControlWord is the control word for “synchronized motion” (see Section ""Control word for synchronized motion"" on page 279).

P 1326[0] - MPRO_ECAM_StatusWord is the status word for “synchronized motion” (see Section ""Status word for synchronized motion"" on page 279).

# 8.11.1.1 Table selection

|ID|Index Name|Unit|Description|
|---|---|---|---|
|1300|MPRO_ECAM_CTS_| |ECAM: CamTableSelect - Master reference|
|1301|MasterRef| | |
|1305|MPRO_ECAM_CTS_| |ECAM: CamTableSelect - Method for changing the camtable|
|1306|MPRO_ECAM_CTS_| |ECAM: CamTableSelect - Mode for changing the camtable|
|1307|MPRO_ECAM_CTS_|incr|ECAM: CamTableSelect - Distance for changing the camtable|
|242|MPRO_ECAM_| |ECAM / EGEAR: Mode of synchronized motion SyncModMode|
|265|MPRO_ECAM_| |ECAM / EGEAR: Slave speed factor (1 = 100%).|
|266|CamSlave_SpeedFactor| | |
|268|MPRO_ECAM_| |ECAM / EGEAR: Mode of switching off sync. motion|

# 8.11.1.2 Synchronization

|ID|Index Name|Unit|Description|
|---|---|---|---|
|1342|MPRO_ECAM_CI_|incr|ECAM: CamIn - Synchronization position (multiturn part)|
|1343|MPRO_ECAM_CO_|incr|ECAM: CamOut - Decoupling pos. (multiturn part)|
|1303|MPRO_ECAM_CI_|incr|ECAM: CamIn - Master offset|
|1308|MPRO_ECAM_CI_| |ECAM: CamIn - Master reference|
|1309|MPRO_ECAM_CI_| |ECAM: CamIn - Slave reference|
|1310|MPRO_ECAM_CI_| |ECAM: CamIn - Coupling mode|
|1311|MPRO_ECAM_CI_|incr|ECAM: CamIn - Coupling distance|
|1312|MPRO_ECAM_CI_|incr|ECAM: CamIn - Synchronization position|

Table 8.31: “Electronic camming - Table selection” parameters

Table 8.30: “Synchronized motion” parameters

Table 8.32: “Electronic camming - Synchronization” parameters

MOOG ID No.:CB40859-001 Date:11/2020

MSD ServoDrive - DeviceHelp 277

# 8 Motion profile

MOOG ID No.:CB40859-001 Date:11/2020 MSD ServoDrive - DeviceHelp 278

|ID|Index|Name|Unit|Description|
|---|---|---|---|---|
|1313|0|MPRO_ECAM_CO_SyncPosST|(singleturn part)|ECAM: CamOut - Slave reference|
|1314|0|MPRO_ECAM_CO_DecouplingMode|63|ECAM: CamOut - Decoupling mode|
|1315|0|MPRO_ECAM_CO_BreakingPosST|incr|ECAM: CamOut - Decoupling position|
|1316|0|MPRO_ECAM_CO_DecouplingDist|incr|ECAM: CamOut - Decoupling distance|
|1317|0|MPRO_ECAM_CO_StandstillPos|mDegree|ECAM: CamOut - Slave standstill position|

# Table 8.32: “Electronic camming - Synchronization” parameters (continue)

|ID|Index|Name|Unit|Description|
|---|---|---|---|---|
|1346| |MPRO_ECAM_SP_Table| |ECAM: Setpoint table interface|
|1346|0|Index| |Index of setpoint table|
|1346|1|Value| |Value at index of setpoint table|
|1347|0 to 31|MPRO_ECAM_SP_Index| |ECAM: Setpoint segments start index|
|1348|0 to 31|MPRO_ECAM_SP_Length| |ECAM: Setpoint segments length|
|1349|0 to 31|Length| | |
|1350|0|MPRO_ECAM_SP_MaDist| |ECAM: Setpoint segments master distance|
|1351|0|MPRO_ECAM_SP_IpoType| |ECAM: Setpoint segments interpolation type|
|1352|0 to 31|Checksum| |ECAM: Setpoint table checksum|
|1353|0 to 31|GainNum| |ECAM: Setpoint segments gain numerator|
| | |GainDen| |ECAM: Setpoint segments gain denominator|

# Table 8.33: “Electronic camming - Table segments” parameters

|ID|Index|Name|Unit|Description|
|---|---|---|---|---|
|1329|0 to 63|MPRO_ECAM_SegData_IndexNext| |ECAM: Index of the following segment|
|1330|0 to 63|MPRO_ECAM_SegData_IndexPrev| |ECAM: Index of the previous segment|
|1331|0 to 63|MPRO_ECAM_SegData_ProfileMode| |ECAM: Profile mode of the current segment|
|1332|0 to 63|MPRO_ECAM_SegData_DistMaster| |ECAM: Length of the master section of the current segment|
|1333|0 to 63|MPRO_ECAM_SegData_DistSlave| |ECAM: Length of the slave section of the current segment|
|1334|0 to 63|MPRO_ECAM_SegData_Lambda| |ECAM: Lambda value of the current segment|
|1335|0 to 63|MPRO_ECAM_SegData_StatusWord| |ECAM: Status word of the current segment|
|1336|0 to 63|MPRO_ECAM_SegData_ControlWord| |ECAM: Control word of the current segment|

# 8.11.2 Control word for synchronized motion

|Bit|Function|PLC function|Bit number|Description|
|---|---|---|---|---|
|0-7|Start segment (8-bit value)|-|0-7|Actual segment (8-bit value)|
|8-15|Reserved|-| |Actual ECAM / EGEAR state machine state (4 Bit value)|
|16|Absolute (true) / relative (false) master relationship|-| |- 0: ECAM / EGEAR asynchronous
- 1: ECAM / EGEAR synchronous
|
|17|Absolute (true) / relative (false) master (CAM) relationship at cam in|-| |- 2: ECAM / EGEAR synchronizing
- 3: ECAM / EGEAR desynchronizing
|
|18|Absolute (true) / relative (false) slave (CAM) relationship at cam in|-| |- 4: ECAM / EGEAR active and waiting for going asynchronous
|
|19-23|Reserved|-| |- 5: ECAM / EGEAR inactive and waiting for going synchronous
|
|24|Change gear ratio of the electronic gear online|MCB_GearRatioChange| | |
|25|Disable master calculation|MCB_Cam_MasterEnable| | |
|26|Enable master calculation|MCB_Cam_MasterEnable| | |
|27|Select CAM table|MCB_CamTableSelect| | |
|28|Start Ecam|MCB_CamIn| | |
|29|Stop Ecam|MCB_CamOut| | |
|30|Start Egear|MCB_GearIn| | |
|31|Stop Egear|MCB_GearOut| | |

# 8.11.3 Status word for synchronized motion

|Bit|Function|PLC function|Bit number|Description|
|---|---|---|---|---|
|12-26|Reserved|-| | |
|27|ECAM / EGEAR is active|-| | |
|28|Valid segments chosen|-| | |
|29|Master data are valid|-| | |
|30|Master is initialized|-| | |
|31|Master calculation is active|-| | |

Table 8.35: Control word ECAM (P 1318[0] - MPRO_ECAM_ControlWord)

Table 8.36: ECAM status word (P 1326[0] - MPRO_ECAM_StatusWord)

MOOG ID No.:CB40859-001 Date:11/2020 MSD ServoDrive - DeviceHelp 279

# 8 Motion profile

# 8 Motion profile

MOOG ID No.:CB40859-001 Date:11/2020

MSD ServoDrive - DeviceHelp 280

# 8.11.4 Master configuration

the master encoder, you will need to set the resolution relative to a single motor revolution in P 250 - MPRO_ECAM_PARAMaster_Amplitude (see below).

- ENC CH1 (3) = Encoder channel 1 X7 (Sin/Cos)
- ENC CH2 (4) = Encoder channel 2 X6 (Resolver)
- ENC CH3 (5) = Encoder channel 3 X8 (optional)

This function is only available if an external interface X8 (option module) is present.

- TP0 (6) = Pulse counter on probe channel 0 (TP0)
- TP1 (7) = Pulse counter on probe channel 1 (TP1)
- ENC_CH4 (8) = Encoder channel 4 (p. e. fieldbus)
- TWIN_POS (9) = TWIN remote reference position (P-2607)

Image 8.72: “Master configuration” screen

# Channel selection (master encoder)

P 1319[0] - MPRO_ECAM_CamMaster_AxisType is used to define the master encoder.

- NO AXIS (0) = No axis
- VIRTUAL MASTER (1) = Virtual master

If you select this function, you will be able to configure additional settings by clicking on the enabled “Options...” button (see Section ""Virtual Master"" on page 286).

- PARA (2) = Master parameter interface

If you select this function because a higher-level controller is being used as

# Anti-reverse mode

Slave only starts moving along with it again as soon as the master reaches the zero position.

P 1320[0] - MPRO_ECAM_CamMaster_RevLockMode is used to define the reverse lock mode, which can be used either with or without path compensation. The dashed lines in the following diagrams indicate what the engagement distance is:

# Example:

If the master, which has moved two motor revolutions in the direction blocked for the slave, then moves in the unblocked direction again, the slave only moves off when the master has traversed the zero point.

- INACTIVE (0) = Reverse lock inactive
- ACTIVE (2) = Reverse lock enabled - without path optimization
- ACTIVE WAY COMP (1) = Reverse lock active - with way compensation

While the slave accelerates to the speed of the master during engagement, the master and slave do not move synchronously. This function needs to be selected in order to quickly catch up to the master that is running ahead.

# Example:

- Master (black line) rotates in the blocked direction
- The slave (blue line) remains stopped
- Master rotates in the unblocked direction again
- The slave follows the master directly in the unblocked direction

Assume the master has moved two motor revolutions in the direction for which the slave lock is enabled. If the master now moves in the direction for which there is no lock, the slave will immediately start running in that direction.

MOOG ID No.:CB40859-001 Date:11/2020

MSD ServoDrive - DeviceHelp 281

# 8 Motion profile

MOOG ID No.:CB40859-001 Date:11/2020 MSD ServoDrive - DeviceHelp 282

|Filter type|ID|Index Name|Unit|Description|
|---|---|---|---|---|
|When using a real master encoder, encoder signals may be subject to noise.|P 1340|1319|0|MPRO_ECAM_CamMaster_AxisType|
| | |MPRO_ECAM_CamMaster_SpeedFilTyp| |ECAM / EGEAR: Channel selection of internal master input|
| | |1320|0|MPRO_ECAM_CamMaster_RevLockMode|
| | |1321|0|MPRO_ECAM_CamMaster_Amplitude|
| | |1322|0|MPRO_ECAM_CamMaster_GearNum|
| | |1323|0|MPRO_ECAM_CamMaster_GearDen|
|Filter time|1327|0|ms|ECAM / EGEAR: Filter time constant of master|
|If P 1340[0] is used to enable a filter, P 1327[0] - MPRO_ECAM_CamMaster_SpeedTFil can be used to define the corresponding filter time.|1328|0|speed|ECAM / EGEAR: Speed factor of the internal master|
|Speed factor|1340|0| |MPRO_ECAM_CamMaster_SpeedFilTyp|
|The master encoder can be assigned an additional speed factor P 1328[0] - MPRO_ECAM_CamMaster_SpeedFactor.|1341|0|incr|ECAM / EGEAR: Master drive offset|

Table 8.37: “Synchronized motion - Master configuration” parameters (continue)

| | | |ID|Index Name|Unit|Description|
|---|---|---|---|---|---|---|
|247|0|MPRO_ECAM_ParaMaster_ActPos|incr|ECAM / EGEAR: Parameter interface master position| | |
|248|0|MPRO_ECAM_ParaMaster_ActSpeed|rpm|ECAM / EGEAR: Parameter interface master speed| | |
|249|0|MPRO_ECAM_ParaMaster_ActAcc|rpm|ECAM / EGEAR: Parameter interface master acceleration| | |
| |250|0|MPRO_ECAM_ParaMaster_Amplitude| |ECAM / EGEAR: Parameter interface master amplitude| |

Table 8.37: “Synchronized motion - Master configuration” parameters

# 8.11.5 Electronic gearing

# Gear ratio

The gear ratio is specified as a fraction. This ensures that the position references can be translated to the motor shaft with no rounding error.

- ""Slave"" (P 252[0] - MPRO_ECAM_Egear_GearNum) is the numerator
- ""Master"" (P 251[0] - MPRO_ECAM_Egear_GearDen) is the denominator

# Scaling of speed pre-control

Defined with P 265[0] - MPRO_ECAM_CamSlave_SpeedFactor definiert.

# Scaling of torque pre-control

Defined with P 266[0] - MPRO_ECAM_CamSlave_TorqueFactor.

# Engagement

See Section ""Engagement"" on page 284.

# Disengagement

See Section ""Disengagement"" on page 285.

|ID|Index Name|Unit|Description|
|---|---|---|---|
|251|0 MPRO_ECAM_Egear_GearDen| |EGEAR: Gear denominator|
|252|0 MPRO_ECAM_Egear_GearNum| |EGEAR: Numerator of gear ratio|
|1344|0 MPRO_ECAM_Egear_LimRefAcc|rpm/s|EGEAR: Acceleration limit for reference|
|1345|0 MPRO_ECAM_Egear_LimRefJerk|rpm/s²|EGEAR: Jerk limit for reference|

Table 8.38: “Synchronized motion - Electronic gearing” parameters

Image 8.73: ""Electronic gearing"" screen

MOOG ID No.:CB40859-001 Date:11/2020 MSD ServoDrive - DeviceHelp 283

# 8 Motion profile

# 8 Motion profile

MOOG ID No.:CB40859-001 Date:11/2020

MSD ServoDrive - DeviceHelp 284

# 8.11.6 Engagement

used to define the engagement distance (between the dashed lines).

P 253[0] - MPRO_ECAM_Egear_GearInMode is used to define the mode for engagement.

- DIRECT (0) = Direct
- Direct engagement: Angular synchronous; with jerking (no ramps).
- CROSSFADE (3) = Crossfading
- Engagement with crossfading function (5th degree polynomial): Angular synchronous; jerk-limited; speed will overshoot during engagement.
- RAMP (1) = Linear speed ramp
- Engagement with linear acceleration: Not angular synchronous; with jerking.
- FADE (2) = Engagement fade-out
- Engagement with fade-in function (5th degree polynomial): Not angular synchronous; jerk-limited. The position is ignored. ",How is wire break monitoring configured for the analog inputs in the 'MSD ServoDrive - DeviceHelp' document?,A2,Wire break monitoring is set up using parameter P 399.,1.375,1.4375,3.46875,1.1640625,0.11669921875
17,msd_servo_drive.txt,76,b87ca5e232c2bdbb6fa16a8a401c6b5d285dc0183e73cc9d134de13dd2fc71d2,"MOOG ID No.:CB40859-001 Date:11/2020

MSD ServoDrive - DeviceHelp 267

# 8 Motion profile

MOOG ID No.:CB40859-001 Date:11/2020 MSD ServoDrive - DeviceHelp 268

# Deceleration

With ...

- P 194 - MPRO_TAB_TDec (for torque control) or
- P 197 - MPRO_TAB_SDec (for speed control) or
- P 200 - MPRO_TAB_PDec (for position control)

and indexes 0–15, the deceleration for each individual motion task can be defined. The input must not be zero.

# Wait time in Auto mode

P 204 - MPRO_TAB_WaitTime is used to define the wait time before the next motion task is carried out.

# Maximum table index in Auto mode

P 206[0] - MPRO_Tab_MaxIdx is used to define the table index up to which driving jobs will be carried out in one of the auto modes.

# Current table index

P 207[0] - MPRO_Tab_ActIdx will show the index for the motion task that is currently active. If parameter P 205 MPRO_TAB_Mode is set to “Para(0)”, a driving set can be entered and approached directly.

# Activation of reference table

The following procedures can be used in order to activate the setpoint table for operation.

|ID|Index Name|Unit|Description|
|---|---|---|---|
|193|MPRO_TAB_TAcc|TAB: Torque mode acceleration|Nm/ms|
|193|0|MPRO_TAB_TAcc|Nm/ms|
|193|1 - 15|MPRO_TAB_TAcc|Nm/ms|
|194|MPRO_TAB_TDec|TAB: Torque mode deceleration| |
|194|0|MPRO_TAB_TDec|Nm/ms|
|194|1 - 15|MPRO_TAB_TDec|Nm/ms|

# Table 8.23: Activation of table references

# Table 8.24: “Setpoint table settings” parameters

# Table 8.24: “Setpoint table settings” parameters (continue)

|ID|Index Name|Unit|Description|ID|Index Name|Unit|Description|
|---|---|---|---|---|---|---|---|
|195|MPRO_TAB_TRef|Nm|TAB: Torque mode reference value|208|MPRO_TAB_OutputNo| |OSD TAB: actual table index and target|
|195|MPRO_TAB_TRef|Nm| |208|MPRO_TAB_OutputNo| | |
|196|MPRO_TAB_SAcc|rev/min/s|TAB: Speed mode acceleration|269|MPRO_TAB_Ctrl| |TAB: control word|
|196|MPRO_TAB_SAcc|rev/min/s| | | | | |
|197|MPRO_TAB_SDec|rev/min/s|TAB: Speed mode deceleration| | | | |
|197|MPRO_TAB_SDec|rev/min/s| | | | | |
|198|MPRO_TAB_SRef|rev/min|TAB: Speed mode reference value| | | | |
|198|MPRO_TAB_SRef|rev/min| | | | | |
|199|MPRO_TAB_PAcc|rev/min/s|TAB: Position control mode acceleration| | | | |
|199|MPRO_TAB_PAcc|rev/min/s| | | | | |
|200|MPRO_TAB_PDec|rev/min/s|TAB: Position control mode Acceleration| | | | |
|200|MPRO_TAB_PDec|rev/min/s| | | | | |
|201|MPRO_TAB_PSpd|rev/min|TAB: Position control mode speed| | | | |
|201|MPRO_TAB_PSpd|rev/min| | | | | |
|202|MPRO_TAB_PPos|mDegree|TAB: Position control mode reference value| | | | |
|202|MPRO_TAB_PPos|mDegree| | | | | |
|203|MPRO_TAB_PMode| |Position control table:Mode| | | | |
|203|MPRO_TAB_PMode| | | | | | |
|204|MPRO_TAB_WaitTime|ms|TAB: Wait time| | | | |
|204|MPRO_TAB_WaitTime|ms| | | | | |
|205|MPRO_TAB_Mode| |TAB mode| | | | |
|206|MPRO_Tab_MaxIdx| |TAB: Max index in AUTO mode| | | | |
|207|MPRO_TAB_ActIdx| |TAB: Actual index| | | | |

MOOG ID No.:CB40859-001 Date:11/2020

MSD ServoDrive - DeviceHelp

# 8 Motion profile

MOOG ID No.:CB40859-001 Date:11/2020

MSD ServoDrive - DeviceHelp 270

# 8.8 Analog channel (ISA00 und ISA01)

# Offset (O)

This parameter (P 174 - MPRO_ANA0_SOffset for ISA00, P 184 - MPRO_ANA1_SOffset for ISA01) compensates for component variations and is used for offset compensation purposes. Depending on the control mode being used (see Section ""Basic settings"" on page 110), the value will be stored in parameter index [0] (torque control), [1] (speed control) or [2] (position control).

# Backlash (B)

This parameter (P 175 - MPRO_ANA0_SThreshold for ISA00, P 185 - MPRO_ANA1_SThreshold for ISA01) can suppress axis motion close to the standstill (stop) position. Depending on the control mode being used (see Section ""Basic settings"" on page 110), the value will be stored in parameter index [0] (torque control), [1] (speed control) or [2] (position control).

Image 8.68: “Analog channel” screen

# Acceleration ramp

Two standard analog inputs (ISA00, ISA01) are available. These inputs can be configured...

- with negative values for analog setpoint settings
- with positive values for digital setpoint processing

(P 109[0] - MPRO_INPUT_FS_ISA00 and P 110[0] - MPRO_INPUT_FS_ISA01).

see also section ""Analog Inputs"" on page 303. By using the ""REV(-2) = Analog setpoint"" setting, an analog input voltage of ±10 V can be processed as a setpoint.

# Deceleration ramp

This parameter serves as a deceleration ramp for torque control (P 176[1] - MPRO_ANA0_TRamp for ISA00, P 186[1] - MPRO_ANA1_TRamp for ISA01) or speed control (P 177[1] - MPRO_ANA0_SRamp for ISA00, P 187[1] - MPRO_ANA1_SRamp for ISA01). Depending on the control mode being used (see Section ""Basic settings"" on page 110), the value will be stored in parameter index [0] (torque control), [1] (speed control) or [2] (position control).

This parameter (P 173 - MPRO_ANA0_Scale for ISA00, P 183 - MPRO_ANA1_Scale for ISA01) is used to define which speed / which torque / which position corresponds to the maximum analog value. Depending on the control mode being used (see Section ""Basic settings"" on page 110), the value will be stored in parameter index [0] (torque control), [1] (speed control) or [2] (position control).

# 8.8.1 Special characteristics of position control mode

A threshold value can also be specified which generates a run-on range around the last reference value. A ramp function calculates a motion profile for the position reference from pre-defined acceleration and speed limits.

The position references on the analog channel are not applied immediately, but dependent on a digital input. Accordingly, one of the ISD00 to ISD06 digital inputs must be set to a value of ""REFANAEN(28) = Enable analog reference value"" (see Section ""Digital inputs"" on page 290). The position setpoint being received will only be applied if the corresponding digital input is active. The acceleration is entered using P 173[0] - MPRO_ANA0_TScale or P 183[0] - MPRO_ANA1_TScale.

# 8.8.2 Wire Break Monitoring

P 399 - CON_ANAWireBrk_Th can be used to configure wire break monitoring for the analog inputs. For details see Section ""Wire Break Monitoring"" on page 306.

|Function|TLIM (-4)|OVR (-3)|REFV (-2)|leer (-1)|OFF (0)|
|---|---|---|---|---|---|
|Digital|(1)-(28)|(1)-(28)|(1)-(28)|(1)-(28)|(1)-(28)|
|Analog channel|Filter|Scale|Offset|Profile|generator|

Control

Image 8.69: Reference processing structure

MOOG ID No.:CB40859-001 Date:11/2020

MSD ServoDrive - DeviceHelp 271

# 8 Motion profile

# 8 Motion profile

MOOG ID No.:CB40859-001 Date:11/2020

|ID|Index Name|Unit|Description|ID|
|---|---|---|---|---|
|395|CON_ANA_Isaf_Scaled| |Analog inputs: Values (filt, norm, comp, scaled)|174|
|395|0 ISA00| |Scaled, compensated, filtered, normalized value|175|
|395|1 ISA01| |Scaled, compensated, filtered, normalized value| |
|396|CON_ANA_Scale_ThUpper| |Analog inputs: Upper scaling limits|175|
|396|0 ISA00|%|Upper scaling (@ 10 V) threshold|175|
|396|1 ISA01|%|Upper scaling (@ 10 V) threshold| |
|397|CON_ANA_Scale_ThZero| |Analog inputs: Zero scaling thresholds|176|
|397|0 ISA00|V|Zero scaling threshold (+/-)|176|
|397|1 ISA01|V|Zero scaling threshold (+/-)| |
|398|CON_ANA_Scale_ThLower| |Analog inputs: Lower scaling limits|177|
|398|0 ISA00|%|Lower scaling (@ zero threshold) threshold|177|
|398|1 ISA01|%|Lower scaling (@ zero threshold) threshold| |
|399|CON_ANA_WireBrk_Th| |Analog inputs: Wire break thresholds|Table 8.26:|
|399|0 ISA00|V|Wire break detection threshold| |
|399|1 ISA01|V|Wire break detection threshold| |
|405|0 CON_ANA_Filt0|ms|Analog input ISA00: Filter time constant (PT 1)|ID|
|408|CON_ANA_Isaf_Norm| |Analog inputs: Values (filt, norm)|183|
|408|0 ISA00| |Filtered, normalized value|183|
|408|1 ISA01| |Filtered, normalized value|183|

Table 8.25: “Analog channel” parameters

|ID|Index Name|Unit|Description|ID|
|---|---|---|---|---|
|173|MPRO_ANA0_Scale| |ANA0: scale factors|184|
|173|0 MPRO_ANA0_TScale|Nm|ANA0: scale factor torque reference|185|
|173|1 MPRO_ANA0_SScale|rev/min|ANA0: scale factor speed reference|185|
|173|2 MPRO_ANA0_PScale|mDegree|ANA0: scale factor position reference| |
|174|MPRO_ANA0_Offset| |ANA0: offsets|185|
|174|0 MPRO_ANA0_TOffset|Nm|ANA0: offsets for torque reference|185|

Table 8.26: “Analog channel ISA00” parameters

|Index Name|Unit|Description|
|---|---|---|
|1 MPRO_ANA0_SOffset|rev/min|ANA0: offsets for speed reference|
|2 MPRO_ANA0_POffset|mDegree|ANA0: offsets for position reference|
|MPRO_ANA0_Threshold| |ANA0: thresholds|
|0 MPRO_ANA0_TThreshold|Nm|ANA0: threshold for torque reference|
|1 MPRO_ANA0_SThreshold|rev/min|ANA0: threshold for speed reference|
|2 MPRO_ANA0_PThreshold|mDegree|ANA0: threshold for position reference|
|MPRO_ANA0_TRamp| |ANA0: Torque mode acceleration [0] and deceleration [1]|
|0 MPRO_ANA0_TRamp|Nm/s| |
|1 MPRO_ANA0_TRamp|Nm/s| |
|MPRO_ANA0_SRamp| |ANA0: Speed mode acceleration [0] and deceleration [1]|
|0 MPRO_ANA0_SRamp|SPEED/s| |
|1 MPRO_ANA0_SRamp|SPEED/s| |

“Analog channel ISA00” parameters (continue)

|Index Name|Unit|Description|
|---|---|---|
|MPRO_ANA1_Scale| |ANA1: scale factors|
|0 MPRO_ANA1_TScale|Nm|ANA0: scale factor torque reference|
|1 MPRO_ANA1_SScale|rev/min|ANA0: scale factor speed reference|
|2 MPRO_ANA1_PScale|mDegree|ANA0: scale factor position reference|
|MPRO_ANA1_Offset| |ANA1: offsets|
|0 MPRO_ANA1_TOffset|Nm|ANA1: offsets for torque reference|
|1 MPRO_ANA1_SOffset|rev/min|ANA1: offsets for speed reference|
|2 MPRO_ANA1_POffset|mDegree|ANA1: offsets for position reference|
|MPRO_ANA1_Threshold| |ANA1: thresholds|
|0 MPRO_ANA1_TThreshold|Nm|ANA1: threshold for torque reference|
|1 MPRO_ANA1_SThreshold|rev/min|ANA1: threshold for speed reference|
|2 MPRO_ANA1_PThreshold|mDegree|ANA1: threshold for position reference|

“Analog channel ISA01” parameters

# 8 Motion profile

|ID|Index Name|Unit|Description|
|---|---|---|---|
|186|MPRO_ANA1_TRamp|Nm/s|ANA1: Torque mode acceleration [0] and deceleration[1]|
|186|MPRO_ANA1_TRamp|Nm/s| |
|187|MPRO_ANA1_SRamp|SPEED/s|ANA1: Speed mode acceleration [0] and deceleration [1]|
|187|MPRO_ANA1_SRamp|SPEED/s| |

# Table 8.27: “Analog channel ISA01” parameters (continue)

Display

- System state
- Initialization on device startup
- Not ready (DC link voltage possibly too low)
- Start inhibit (DC link voltage present, power stage off)
- Starting lockout
- Ready for start
- Control initialization: Auto commutation, flux build-up etc.

# Table 8.28: Central state machine according to CiA 402 device display

MOOG ID No.:CB40859-001 Date:11/2020

MSD ServoDrive - DeviceHelp 273

# 8 Motion profile

MOOG ID No.:CB40859-001 Date:11/2020

MSD ServoDrive - DeviceHelp 274

|Display|System state|power disabled|fault|
|---|---|---|---|
|Control enabled|0|Start|7|
| |fault reaction active|0|14|
|Quick stop active|1|not ready|8|
| |to switch on|1|17|
|Error reaction active|2|switch on|disabled|
| |2|7| |
|Error state (in this state the error is indicated directly on the display.)|3|ready to|switch on|
|Device is reset (display flashes)|power enabled|3|6|
| |10|12| |
|• Number [5.] flashes when “STO” (Safe Torque Off) input is active. Display goes out when STO inactive.| | | |
|• The dot on the display flashes when the power stage is active.| | | |

Table 8.28: Central state machine according to CiA 402 device display (continue)

NOTE

l The system states indicated on the display may differ from the states in the table depending on the drive profile setting.

Image 8.70: State machine diagram based on CANopen communications

⓪ to ① State number

1 to 17 State transition (No. 17: DC link voltage cut off)

Legend for “State machine diagram based on CANopen communications” figure

# 8.10 Touch probe

|ID|Index Name / Setting|
|---|---|
|241|0 MPRO_TP_Position|
|241|1 MPRO_TP_Position|
|241|2 MPRO_TP_Position|
|241|3 MPRO_TP_Position|
|241|4 MPRO_TP_Position|
|1400|0 MPRO_TP_Config|
| |TP_TP (0)|
| |AB (1)|
| |PD_UP (2)|
| |PD_DOWN (3)|
| |PC_PC (4)|
| |PC_TP (5)|
| |TP_PC (6)|
| |ENC_ENC (7)|
| |ENC_TP (8)|
| |TP_ENC (9)|

Using the touch probe inputs, touch probe functions can be performed. In order to be able to do this, P 106[0] - MPRO_INPUT_FS_ISD05 and P 107[0] - MPRO_INPUT_FS_ISD06 must be used to set digital inputs ISD05 and ISD06 to ""PROBE(15) = Touch probe (only ISD05/06)"" (see Section ""Digital inputs"" on page 290). HTL encoders can be evaluated or pulse counters implemented using the MSD PLC.

The touch probe can be triggered with P 240 - MPRO_TP_Ctrl. This enables triggering on a positive or negative edge, or on both edges, of the signal detected on the touch probe inputs. After the measurement, the parameter jumps back to the value ""NONE (0)"" and the latch position is mapped in the corresponding subindex of parameter P 241 - MPRO_TP_Position. A continuous touch probe mode is not possible at present, so the touch probe has to be reactivated after the measurement.

P 1402 - MPRO_TP_Channel can be used to select various positions as actual value sources of the latch position for the touch probe functionality. The following table provides an overview of the available settings. The counters are accessed via the MSD PLC or a bus system.

|ID|Index Name / Setting|Unit|Description|
|---|---|---|---|
|240|MPRO_TP_Ctrl|Touch probe: Control| |
| |0| |NONE (0) = No function|
| |1| |POS (1) = Positive edge|
| |2| |NEG (2) = Negative edge|
| |3| |BOTH (3) = Both edges|
|240|0 MPRO_TP_Ctrl| | |
|240|1 MPRO_TP_Ctrl| | |
|240|2 MPRO_TP_Ctrl| | |
|241|MPRO_TP_Position|Probe: Pos. high/low edge of TP0/1, encoder zero pulse| |

Table 8.29: “Touch probe” parameters

MOOG ID No.:CB40859-001 Date:11/2020

# 8 Motion profile

|Unit|Description|
|---|---|
|mDegree|Touch probe: Configuration|
|mDegree|TP0, TP1 touch probe|
|mDegree|TP0, TP1 as encoder, A/B as quadrature counting|
|mDegree|TP0, TP1 as encoder, pulse (TP0) / direction (TP1), count up on direction high|
|mDegree|TP0, TP1 as encoder, pulse (TP0) / direction (TP1), count down on direction high|
|mDegree|TP0 pulse counter, TP1 pulse counter|
|mDegree|TP0 pulse counter, TP1 touch probe|
|mDegree|TP1 touch probe, TP0 pulse counter|
|mDegree|TP0 encoder counter, TP1 encoder counter|
|mDegree|TP0 encoder counter, TP1 touch probe|
|mDegree|TP0 touch probe, TP1 encoder counter|

Touch probe: Channel

|Unit|Description|
|---|---|
|ACTPOS (0)|Actual position in user units|
|ACTPOSINC (1)|Actual position in increments|
|MASTERPOS (2)|Master position in increments|
|ENCPOS_CH1 (3)|Encoder position Channel 1|
|ENCPOS_CH1_INC (4)|Encoder position Channel 1 in increments|
|ENCPOS_CH2 (5)|Encoder position Channel 2|
|ENCPOS_CH2_INC (6)|Encoder position Channel 2 in increments|

# 8 Motion profile

MOOG ID No.:CB40859-001 Date:11/2020 MSD ServoDrive - DeviceHelp 276

|ID|Index Name / Setting|Unit|Description|
|---|---|---|---|
|7|ENCPOS_CH3 (7)| |Encoder position Channel 3|
|8|ENCPOS_CH3_INC (8)| |Encoder position Channel 3 in increments|
|9|ENCPOS_CH4 (9)| |Encoder position Channel 4|
|10|ENCPOS_CH4_INC (10)| |Encoder position Channel 4 in increments|
|11|ACTPOS2 (11)| |Actual position of redundant encoder in user units|
|12|Sercos (12)| |Referred to Sercos profile parameters S-x-0426, S-x-0427|
|13|UserRefPos(13)| |Reference position in user units|
|14|MasterPosST(14)| |Master position (ECAM, EGEAR) singleturn, always steps|
|15|CommonMasterPos(15)| |Master position (ECAM, EGEAR) singleturn, always steps|
|16|CommonMasterPosST(15)| |Master position (ECAM, EGEAR) singleturn, always steps|
|1402|MPRO_TP_Channel| | |
|1402|MPRO_TP_Channel| | |
|1402|MPRO_TP_Channel| | |
|1404|MPRO_TP_Lines| |Touch probe: Lines @ pulse counter on channel x|
|1404|MPRO_TP_Lines| | |
|1404|MPRO_TP_Lines| | |

Image 8.71: “Synchronized motion” screen

There are various modes available in the “synchronization mode” drop-down menu (P 242[0] - MPRO_ECAM_SyncModMode):

- Off(0) = Synchronized motion off
- ECAM_iPlc(1) = Electronic cam plate via MSD PLC
- EGEAR_iPlc(2) = Electr. gear unit via MSD PLC
- ECAM_PARA(3) = Electronic camming via parameters
- EGEAR_PARA(4) = Electronic gearing via parameters

NOTE: For more information refer to the bus system User Manuals or the description of the MSD PLC.

# 8.11.1 Electronic cam plate

The other parameters are configured in separate screens that can be accessed with the corresponding buttons.

- Master configuration (see Section ""Master configuration"" on page 280)
- Electronic gearing (see Section ""Electronic gearing"" on page 283)
- Electronic camming (see Section ""Electronic cam plate"" on page 277)

P 1318[0] - MPRO_ECAM_ControlWord is the control word for “synchronized motion” (see Section ""Control word for synchronized motion"" on page 279).

P 1326[0] - MPRO_ECAM_StatusWord is the status word for “synchronized motion” (see Section ""Status word for synchronized motion"" on page 279).

# 8.11.1.1 Table selection

|ID|Index Name|Unit|Description|
|---|---|---|---|
|1300|MPRO_ECAM_CTS_| |ECAM: CamTableSelect - Master reference|
|1301|MasterRef| | |
|1305|MPRO_ECAM_CTS_| |ECAM: CamTableSelect - Method for changing the camtable|
|1306|MPRO_ECAM_CTS_| |ECAM: CamTableSelect - Mode for changing the camtable|
|1307|MPRO_ECAM_CTS_|incr|ECAM: CamTableSelect - Distance for changing the camtable|
|242|MPRO_ECAM_| |ECAM / EGEAR: Mode of synchronized motion SyncModMode|
|265|MPRO_ECAM_| |ECAM / EGEAR: Slave speed factor (1 = 100%).|
|266|CamSlave_SpeedFactor| | |
|268|MPRO_ECAM_| |ECAM / EGEAR: Mode of switching off sync. motion|

# 8.11.1.2 Synchronization

|ID|Index Name|Unit|Description|
|---|---|---|---|
|1342|MPRO_ECAM_CI_|incr|ECAM: CamIn - Synchronization position (multiturn part)|
|1343|MPRO_ECAM_CO_|incr|ECAM: CamOut - Decoupling pos. (multiturn part)|
|1303|MPRO_ECAM_CI_|incr|ECAM: CamIn - Master offset|
|1308|MPRO_ECAM_CI_| |ECAM: CamIn - Master reference|
|1309|MPRO_ECAM_CI_| |ECAM: CamIn - Slave reference|
|1310|MPRO_ECAM_CI_| |ECAM: CamIn - Coupling mode|
|1311|MPRO_ECAM_CI_|incr|ECAM: CamIn - Coupling distance|
|1312|MPRO_ECAM_CI_|incr|ECAM: CamIn - Synchronization position|

Table 8.31: “Electronic camming - Table selection” parameters

Table 8.30: “Synchronized motion” parameters

Table 8.32: “Electronic camming - Synchronization” parameters

MOOG ID No.:CB40859-001 Date:11/2020

MSD ServoDrive - DeviceHelp 277

# 8 Motion profile

MOOG ID No.:CB40859-001 Date:11/2020 MSD ServoDrive - DeviceHelp 278

|ID|Index|Name|Unit|Description|
|---|---|---|---|---|
|1313|0|MPRO_ECAM_CO_SyncPosST|(singleturn part)|ECAM: CamOut - Slave reference|
|1314|0|MPRO_ECAM_CO_DecouplingMode|63|ECAM: CamOut - Decoupling mode|
|1315|0|MPRO_ECAM_CO_BreakingPosST|incr|ECAM: CamOut - Decoupling position|
|1316|0|MPRO_ECAM_CO_DecouplingDist|incr|ECAM: CamOut - Decoupling distance|
|1317|0|MPRO_ECAM_CO_StandstillPos|mDegree|ECAM: CamOut - Slave standstill position|

# Table 8.32: “Electronic camming - Synchronization” parameters (continue)

|ID|Index|Name|Unit|Description|
|---|---|---|---|---|
|1346| |MPRO_ECAM_SP_Table| |ECAM: Setpoint table interface|
|1346|0|Index| |Index of setpoint table|
|1346|1|Value| |Value at index of setpoint table|
|1347|0 to 31|MPRO_ECAM_SP_Index| |ECAM: Setpoint segments start index|
|1348|0 to 31|MPRO_ECAM_SP_Length| |ECAM: Setpoint segments length|
|1349|0 to 31|Length| | |
|1350|0|MPRO_ECAM_SP_MaDist| |ECAM: Setpoint segments master distance|
|1351|0|MPRO_ECAM_SP_IpoType| |ECAM: Setpoint segments interpolation type|
|1352|0 to 31|Checksum| |ECAM: Setpoint table checksum|
|1353|0 to 31|GainNum| |ECAM: Setpoint segments gain numerator|
| | |GainDen| |ECAM: Setpoint segments gain denominator|

# Table 8.33: “Electronic camming - Table segments” parameters

|ID|Index|Name|Unit|Description|
|---|---|---|---|---|
|1329|0 to 63|MPRO_ECAM_SegData_IndexNext| |ECAM: Index of the following segment|
|1330|0 to 63|MPRO_ECAM_SegData_IndexPrev| |ECAM: Index of the previous segment|
|1331|0 to 63|MPRO_ECAM_SegData_ProfileMode| |ECAM: Profile mode of the current segment|
|1332|0 to 63|MPRO_ECAM_SegData_DistMaster| |ECAM: Length of the master section of the current segment|
|1333|0 to 63|MPRO_ECAM_SegData_DistSlave| |ECAM: Length of the slave section of the current segment|
|1334|0 to 63|MPRO_ECAM_SegData_Lambda| |ECAM: Lambda value of the current segment|
|1335|0 to 63|MPRO_ECAM_SegData_StatusWord| |ECAM: Status word of the current segment|
|1336|0 to 63|MPRO_ECAM_SegData_ControlWord| |ECAM: Control word of the current segment|

# 8.11.2 Control word for synchronized motion

|Bit|Function|PLC function|Bit number|Description|
|---|---|---|---|---|
|0-7|Start segment (8-bit value)|-|0-7|Actual segment (8-bit value)|
|8-15|Reserved|-| |Actual ECAM / EGEAR state machine state (4 Bit value)|
|16|Absolute (true) / relative (false) master relationship|-| |- 0: ECAM / EGEAR asynchronous
- 1: ECAM / EGEAR synchronous
|
|17|Absolute (true) / relative (false) master (CAM) relationship at cam in|-| |- 2: ECAM / EGEAR synchronizing
- 3: ECAM / EGEAR desynchronizing
|
|18|Absolute (true) / relative (false) slave (CAM) relationship at cam in|-| |- 4: ECAM / EGEAR active and waiting for going asynchronous
|
|19-23|Reserved|-| |- 5: ECAM / EGEAR inactive and waiting for going synchronous
|
|24|Change gear ratio of the electronic gear online|MCB_GearRatioChange| | |
|25|Disable master calculation|MCB_Cam_MasterEnable| | |
|26|Enable master calculation|MCB_Cam_MasterEnable| | |
|27|Select CAM table|MCB_CamTableSelect| | |
|28|Start Ecam|MCB_CamIn| | |
|29|Stop Ecam|MCB_CamOut| | |
|30|Start Egear|MCB_GearIn| | |
|31|Stop Egear|MCB_GearOut| | |

# 8.11.3 Status word for synchronized motion

|Bit|Function|PLC function|Bit number|Description|
|---|---|---|---|---|
|12-26|Reserved|-| | |
|27|ECAM / EGEAR is active|-| | |
|28|Valid segments chosen|-| | |
|29|Master data are valid|-| | |
|30|Master is initialized|-| | |
|31|Master calculation is active|-| | |

Table 8.35: Control word ECAM (P 1318[0] - MPRO_ECAM_ControlWord)

Table 8.36: ECAM status word (P 1326[0] - MPRO_ECAM_StatusWord)

MOOG ID No.:CB40859-001 Date:11/2020 MSD ServoDrive - DeviceHelp 279

# 8 Motion profile

# 8 Motion profile

MOOG ID No.:CB40859-001 Date:11/2020

MSD ServoDrive - DeviceHelp 280

# 8.11.4 Master configuration

the master encoder, you will need to set the resolution relative to a single motor revolution in P 250 - MPRO_ECAM_PARAMaster_Amplitude (see below).

- ENC CH1 (3) = Encoder channel 1 X7 (Sin/Cos)
- ENC CH2 (4) = Encoder channel 2 X6 (Resolver)
- ENC CH3 (5) = Encoder channel 3 X8 (optional)

This function is only available if an external interface X8 (option module) is present.

- TP0 (6) = Pulse counter on probe channel 0 (TP0)
- TP1 (7) = Pulse counter on probe channel 1 (TP1)
- ENC_CH4 (8) = Encoder channel 4 (p. e. fieldbus)
- TWIN_POS (9) = TWIN remote reference position (P-2607)

Image 8.72: “Master configuration” screen

# Channel selection (master encoder)

P 1319[0] - MPRO_ECAM_CamMaster_AxisType is used to define the master encoder.

- NO AXIS (0) = No axis
- VIRTUAL MASTER (1) = Virtual master

If you select this function, you will be able to configure additional settings by clicking on the enabled “Options...” button (see Section ""Virtual Master"" on page 286).

- PARA (2) = Master parameter interface

If you select this function because a higher-level controller is being used as

# Anti-reverse mode

Slave only starts moving along with it again as soon as the master reaches the zero position.

P 1320[0] - MPRO_ECAM_CamMaster_RevLockMode is used to define the reverse lock mode, which can be used either with or without path compensation. The dashed lines in the following diagrams indicate what the engagement distance is:

# Example:

If the master, which has moved two motor revolutions in the direction blocked for the slave, then moves in the unblocked direction again, the slave only moves off when the master has traversed the zero point.

- INACTIVE (0) = Reverse lock inactive
- ACTIVE (2) = Reverse lock enabled - without path optimization
- ACTIVE WAY COMP (1) = Reverse lock active - with way compensation

While the slave accelerates to the speed of the master during engagement, the master and slave do not move synchronously. This function needs to be selected in order to quickly catch up to the master that is running ahead.

# Example:

- Master (black line) rotates in the blocked direction
- The slave (blue line) remains stopped
- Master rotates in the unblocked direction again
- The slave follows the master directly in the unblocked direction

Assume the master has moved two motor revolutions in the direction for which the slave lock is enabled. If the master now moves in the direction for which there is no lock, the slave will immediately start running in that direction.

MOOG ID No.:CB40859-001 Date:11/2020

MSD ServoDrive - DeviceHelp 281

# 8 Motion profile

MOOG ID No.:CB40859-001 Date:11/2020 MSD ServoDrive - DeviceHelp 282

|Filter type|ID|Index Name|Unit|Description|
|---|---|---|---|---|
|When using a real master encoder, encoder signals may be subject to noise.|P 1340|1319|0|MPRO_ECAM_CamMaster_AxisType|
| | |MPRO_ECAM_CamMaster_SpeedFilTyp| |ECAM / EGEAR: Channel selection of internal master input|
| | |1320|0|MPRO_ECAM_CamMaster_RevLockMode|
| | |1321|0|MPRO_ECAM_CamMaster_Amplitude|
| | |1322|0|MPRO_ECAM_CamMaster_GearNum|
| | |1323|0|MPRO_ECAM_CamMaster_GearDen|
|Filter time|1327|0|ms|ECAM / EGEAR: Filter time constant of master|
|If P 1340[0] is used to enable a filter, P 1327[0] - MPRO_ECAM_CamMaster_SpeedTFil can be used to define the corresponding filter time.|1328|0|speed|ECAM / EGEAR: Speed factor of the internal master|
|Speed factor|1340|0| |MPRO_ECAM_CamMaster_SpeedFilTyp|
|The master encoder can be assigned an additional speed factor P 1328[0] - MPRO_ECAM_CamMaster_SpeedFactor.|1341|0|incr|ECAM / EGEAR: Master drive offset|

Table 8.37: “Synchronized motion - Master configuration” parameters (continue)

| | | |ID|Index Name|Unit|Description|
|---|---|---|---|---|---|---|
|247|0|MPRO_ECAM_ParaMaster_ActPos|incr|ECAM / EGEAR: Parameter interface master position| | |
|248|0|MPRO_ECAM_ParaMaster_ActSpeed|rpm|ECAM / EGEAR: Parameter interface master speed| | |
|249|0|MPRO_ECAM_ParaMaster_ActAcc|rpm|ECAM / EGEAR: Parameter interface master acceleration| | |
| |250|0|MPRO_ECAM_ParaMaster_Amplitude| |ECAM / EGEAR: Parameter interface master amplitude| |

Table 8.37: “Synchronized motion - Master configuration” parameters

# 8.11.5 Electronic gearing

# Gear ratio

The gear ratio is specified as a fraction. This ensures that the position references can be translated to the motor shaft with no rounding error.

- ""Slave"" (P 252[0] - MPRO_ECAM_Egear_GearNum) is the numerator
- ""Master"" (P 251[0] - MPRO_ECAM_Egear_GearDen) is the denominator

# Scaling of speed pre-control

Defined with P 265[0] - MPRO_ECAM_CamSlave_SpeedFactor definiert.

# Scaling of torque pre-control

Defined with P 266[0] - MPRO_ECAM_CamSlave_TorqueFactor.

# Engagement

See Section ""Engagement"" on page 284.

# Disengagement

See Section ""Disengagement"" on page 285.

|ID|Index Name|Unit|Description|
|---|---|---|---|
|251|0 MPRO_ECAM_Egear_GearDen| |EGEAR: Gear denominator|
|252|0 MPRO_ECAM_Egear_GearNum| |EGEAR: Numerator of gear ratio|
|1344|0 MPRO_ECAM_Egear_LimRefAcc|rpm/s|EGEAR: Acceleration limit for reference|
|1345|0 MPRO_ECAM_Egear_LimRefJerk|rpm/s²|EGEAR: Jerk limit for reference|

Table 8.38: “Synchronized motion - Electronic gearing” parameters

Image 8.73: ""Electronic gearing"" screen

MOOG ID No.:CB40859-001 Date:11/2020 MSD ServoDrive - DeviceHelp 283

# 8 Motion profile

# 8 Motion profile

MOOG ID No.:CB40859-001 Date:11/2020

MSD ServoDrive - DeviceHelp 284

# 8.11.6 Engagement

used to define the engagement distance (between the dashed lines).

P 253[0] - MPRO_ECAM_Egear_GearInMode is used to define the mode for engagement.

- DIRECT (0) = Direct
- Direct engagement: Angular synchronous; with jerking (no ramps).
- CROSSFADE (3) = Crossfading
- Engagement with crossfading function (5th degree polynomial): Angular synchronous; jerk-limited; speed will overshoot during engagement.
- RAMP (1) = Linear speed ramp
- Engagement with linear acceleration: Not angular synchronous; with jerking.
- FADE (2) = Engagement fade-out
- Engagement with fade-in function (5th degree polynomial): Not angular synchronous; jerk-limited. The position is ignored. ",How is wire break monitoring configured for the analog inputs in the 'MSD ServoDrive - DeviceHelp' document?,A3,Configure P 399 to monitor and detect wire breaks in analog inputs.,1.5546875,1.5859375,3.328125,1.2734375,0.396484375
18,msd_servo_drive.txt,76,b87ca5e232c2bdbb6fa16a8a401c6b5d285dc0183e73cc9d134de13dd2fc71d2,"MOOG ID No.:CB40859-001 Date:11/2020

MSD ServoDrive - DeviceHelp 267

# 8 Motion profile

MOOG ID No.:CB40859-001 Date:11/2020 MSD ServoDrive - DeviceHelp 268

# Deceleration

With ...

- P 194 - MPRO_TAB_TDec (for torque control) or
- P 197 - MPRO_TAB_SDec (for speed control) or
- P 200 - MPRO_TAB_PDec (for position control)

and indexes 0–15, the deceleration for each individual motion task can be defined. The input must not be zero.

# Wait time in Auto mode

P 204 - MPRO_TAB_WaitTime is used to define the wait time before the next motion task is carried out.

# Maximum table index in Auto mode

P 206[0] - MPRO_Tab_MaxIdx is used to define the table index up to which driving jobs will be carried out in one of the auto modes.

# Current table index

P 207[0] - MPRO_Tab_ActIdx will show the index for the motion task that is currently active. If parameter P 205 MPRO_TAB_Mode is set to “Para(0)”, a driving set can be entered and approached directly.

# Activation of reference table

The following procedures can be used in order to activate the setpoint table for operation.

|ID|Index Name|Unit|Description|
|---|---|---|---|
|193|MPRO_TAB_TAcc|TAB: Torque mode acceleration|Nm/ms|
|193|0|MPRO_TAB_TAcc|Nm/ms|
|193|1 - 15|MPRO_TAB_TAcc|Nm/ms|
|194|MPRO_TAB_TDec|TAB: Torque mode deceleration| |
|194|0|MPRO_TAB_TDec|Nm/ms|
|194|1 - 15|MPRO_TAB_TDec|Nm/ms|

# Table 8.23: Activation of table references

# Table 8.24: “Setpoint table settings” parameters

# Table 8.24: “Setpoint table settings” parameters (continue)

|ID|Index Name|Unit|Description|ID|Index Name|Unit|Description|
|---|---|---|---|---|---|---|---|
|195|MPRO_TAB_TRef|Nm|TAB: Torque mode reference value|208|MPRO_TAB_OutputNo| |OSD TAB: actual table index and target|
|195|MPRO_TAB_TRef|Nm| |208|MPRO_TAB_OutputNo| | |
|196|MPRO_TAB_SAcc|rev/min/s|TAB: Speed mode acceleration|269|MPRO_TAB_Ctrl| |TAB: control word|
|196|MPRO_TAB_SAcc|rev/min/s| | | | | |
|197|MPRO_TAB_SDec|rev/min/s|TAB: Speed mode deceleration| | | | |
|197|MPRO_TAB_SDec|rev/min/s| | | | | |
|198|MPRO_TAB_SRef|rev/min|TAB: Speed mode reference value| | | | |
|198|MPRO_TAB_SRef|rev/min| | | | | |
|199|MPRO_TAB_PAcc|rev/min/s|TAB: Position control mode acceleration| | | | |
|199|MPRO_TAB_PAcc|rev/min/s| | | | | |
|200|MPRO_TAB_PDec|rev/min/s|TAB: Position control mode Acceleration| | | | |
|200|MPRO_TAB_PDec|rev/min/s| | | | | |
|201|MPRO_TAB_PSpd|rev/min|TAB: Position control mode speed| | | | |
|201|MPRO_TAB_PSpd|rev/min| | | | | |
|202|MPRO_TAB_PPos|mDegree|TAB: Position control mode reference value| | | | |
|202|MPRO_TAB_PPos|mDegree| | | | | |
|203|MPRO_TAB_PMode| |Position control table:Mode| | | | |
|203|MPRO_TAB_PMode| | | | | | |
|204|MPRO_TAB_WaitTime|ms|TAB: Wait time| | | | |
|204|MPRO_TAB_WaitTime|ms| | | | | |
|205|MPRO_TAB_Mode| |TAB mode| | | | |
|206|MPRO_Tab_MaxIdx| |TAB: Max index in AUTO mode| | | | |
|207|MPRO_TAB_ActIdx| |TAB: Actual index| | | | |

MOOG ID No.:CB40859-001 Date:11/2020

MSD ServoDrive - DeviceHelp

# 8 Motion profile

MOOG ID No.:CB40859-001 Date:11/2020

MSD ServoDrive - DeviceHelp 270

# 8.8 Analog channel (ISA00 und ISA01)

# Offset (O)

This parameter (P 174 - MPRO_ANA0_SOffset for ISA00, P 184 - MPRO_ANA1_SOffset for ISA01) compensates for component variations and is used for offset compensation purposes. Depending on the control mode being used (see Section ""Basic settings"" on page 110), the value will be stored in parameter index [0] (torque control), [1] (speed control) or [2] (position control).

# Backlash (B)

This parameter (P 175 - MPRO_ANA0_SThreshold for ISA00, P 185 - MPRO_ANA1_SThreshold for ISA01) can suppress axis motion close to the standstill (stop) position. Depending on the control mode being used (see Section ""Basic settings"" on page 110), the value will be stored in parameter index [0] (torque control), [1] (speed control) or [2] (position control).

Image 8.68: “Analog channel” screen

# Acceleration ramp

Two standard analog inputs (ISA00, ISA01) are available. These inputs can be configured...

- with negative values for analog setpoint settings
- with positive values for digital setpoint processing

(P 109[0] - MPRO_INPUT_FS_ISA00 and P 110[0] - MPRO_INPUT_FS_ISA01).

see also section ""Analog Inputs"" on page 303. By using the ""REV(-2) = Analog setpoint"" setting, an analog input voltage of ±10 V can be processed as a setpoint.

# Deceleration ramp

This parameter serves as a deceleration ramp for torque control (P 176[1] - MPRO_ANA0_TRamp for ISA00, P 186[1] - MPRO_ANA1_TRamp for ISA01) or speed control (P 177[1] - MPRO_ANA0_SRamp for ISA00, P 187[1] - MPRO_ANA1_SRamp for ISA01). Depending on the control mode being used (see Section ""Basic settings"" on page 110), the value will be stored in parameter index [0] (torque control), [1] (speed control) or [2] (position control).

This parameter (P 173 - MPRO_ANA0_Scale for ISA00, P 183 - MPRO_ANA1_Scale for ISA01) is used to define which speed / which torque / which position corresponds to the maximum analog value. Depending on the control mode being used (see Section ""Basic settings"" on page 110), the value will be stored in parameter index [0] (torque control), [1] (speed control) or [2] (position control).

# 8.8.1 Special characteristics of position control mode

A threshold value can also be specified which generates a run-on range around the last reference value. A ramp function calculates a motion profile for the position reference from pre-defined acceleration and speed limits.

The position references on the analog channel are not applied immediately, but dependent on a digital input. Accordingly, one of the ISD00 to ISD06 digital inputs must be set to a value of ""REFANAEN(28) = Enable analog reference value"" (see Section ""Digital inputs"" on page 290). The position setpoint being received will only be applied if the corresponding digital input is active. The acceleration is entered using P 173[0] - MPRO_ANA0_TScale or P 183[0] - MPRO_ANA1_TScale.

# 8.8.2 Wire Break Monitoring

P 399 - CON_ANAWireBrk_Th can be used to configure wire break monitoring for the analog inputs. For details see Section ""Wire Break Monitoring"" on page 306.

|Function|TLIM (-4)|OVR (-3)|REFV (-2)|leer (-1)|OFF (0)|
|---|---|---|---|---|---|
|Digital|(1)-(28)|(1)-(28)|(1)-(28)|(1)-(28)|(1)-(28)|
|Analog channel|Filter|Scale|Offset|Profile|generator|

Control

Image 8.69: Reference processing structure

MOOG ID No.:CB40859-001 Date:11/2020

MSD ServoDrive - DeviceHelp 271

# 8 Motion profile

# 8 Motion profile

MOOG ID No.:CB40859-001 Date:11/2020

|ID|Index Name|Unit|Description|ID|
|---|---|---|---|---|
|395|CON_ANA_Isaf_Scaled| |Analog inputs: Values (filt, norm, comp, scaled)|174|
|395|0 ISA00| |Scaled, compensated, filtered, normalized value|175|
|395|1 ISA01| |Scaled, compensated, filtered, normalized value| |
|396|CON_ANA_Scale_ThUpper| |Analog inputs: Upper scaling limits|175|
|396|0 ISA00|%|Upper scaling (@ 10 V) threshold|175|
|396|1 ISA01|%|Upper scaling (@ 10 V) threshold| |
|397|CON_ANA_Scale_ThZero| |Analog inputs: Zero scaling thresholds|176|
|397|0 ISA00|V|Zero scaling threshold (+/-)|176|
|397|1 ISA01|V|Zero scaling threshold (+/-)| |
|398|CON_ANA_Scale_ThLower| |Analog inputs: Lower scaling limits|177|
|398|0 ISA00|%|Lower scaling (@ zero threshold) threshold|177|
|398|1 ISA01|%|Lower scaling (@ zero threshold) threshold| |
|399|CON_ANA_WireBrk_Th| |Analog inputs: Wire break thresholds|Table 8.26:|
|399|0 ISA00|V|Wire break detection threshold| |
|399|1 ISA01|V|Wire break detection threshold| |
|405|0 CON_ANA_Filt0|ms|Analog input ISA00: Filter time constant (PT 1)|ID|
|408|CON_ANA_Isaf_Norm| |Analog inputs: Values (filt, norm)|183|
|408|0 ISA00| |Filtered, normalized value|183|
|408|1 ISA01| |Filtered, normalized value|183|

Table 8.25: “Analog channel” parameters

|ID|Index Name|Unit|Description|ID|
|---|---|---|---|---|
|173|MPRO_ANA0_Scale| |ANA0: scale factors|184|
|173|0 MPRO_ANA0_TScale|Nm|ANA0: scale factor torque reference|185|
|173|1 MPRO_ANA0_SScale|rev/min|ANA0: scale factor speed reference|185|
|173|2 MPRO_ANA0_PScale|mDegree|ANA0: scale factor position reference| |
|174|MPRO_ANA0_Offset| |ANA0: offsets|185|
|174|0 MPRO_ANA0_TOffset|Nm|ANA0: offsets for torque reference|185|

Table 8.26: “Analog channel ISA00” parameters

|Index Name|Unit|Description|
|---|---|---|
|1 MPRO_ANA0_SOffset|rev/min|ANA0: offsets for speed reference|
|2 MPRO_ANA0_POffset|mDegree|ANA0: offsets for position reference|
|MPRO_ANA0_Threshold| |ANA0: thresholds|
|0 MPRO_ANA0_TThreshold|Nm|ANA0: threshold for torque reference|
|1 MPRO_ANA0_SThreshold|rev/min|ANA0: threshold for speed reference|
|2 MPRO_ANA0_PThreshold|mDegree|ANA0: threshold for position reference|
|MPRO_ANA0_TRamp| |ANA0: Torque mode acceleration [0] and deceleration [1]|
|0 MPRO_ANA0_TRamp|Nm/s| |
|1 MPRO_ANA0_TRamp|Nm/s| |
|MPRO_ANA0_SRamp| |ANA0: Speed mode acceleration [0] and deceleration [1]|
|0 MPRO_ANA0_SRamp|SPEED/s| |
|1 MPRO_ANA0_SRamp|SPEED/s| |

“Analog channel ISA00” parameters (continue)

|Index Name|Unit|Description|
|---|---|---|
|MPRO_ANA1_Scale| |ANA1: scale factors|
|0 MPRO_ANA1_TScale|Nm|ANA0: scale factor torque reference|
|1 MPRO_ANA1_SScale|rev/min|ANA0: scale factor speed reference|
|2 MPRO_ANA1_PScale|mDegree|ANA0: scale factor position reference|
|MPRO_ANA1_Offset| |ANA1: offsets|
|0 MPRO_ANA1_TOffset|Nm|ANA1: offsets for torque reference|
|1 MPRO_ANA1_SOffset|rev/min|ANA1: offsets for speed reference|
|2 MPRO_ANA1_POffset|mDegree|ANA1: offsets for position reference|
|MPRO_ANA1_Threshold| |ANA1: thresholds|
|0 MPRO_ANA1_TThreshold|Nm|ANA1: threshold for torque reference|
|1 MPRO_ANA1_SThreshold|rev/min|ANA1: threshold for speed reference|
|2 MPRO_ANA1_PThreshold|mDegree|ANA1: threshold for position reference|

“Analog channel ISA01” parameters

# 8 Motion profile

|ID|Index Name|Unit|Description|
|---|---|---|---|
|186|MPRO_ANA1_TRamp|Nm/s|ANA1: Torque mode acceleration [0] and deceleration[1]|
|186|MPRO_ANA1_TRamp|Nm/s| |
|187|MPRO_ANA1_SRamp|SPEED/s|ANA1: Speed mode acceleration [0] and deceleration [1]|
|187|MPRO_ANA1_SRamp|SPEED/s| |

# Table 8.27: “Analog channel ISA01” parameters (continue)

Display

- System state
- Initialization on device startup
- Not ready (DC link voltage possibly too low)
- Start inhibit (DC link voltage present, power stage off)
- Starting lockout
- Ready for start
- Control initialization: Auto commutation, flux build-up etc.

# Table 8.28: Central state machine according to CiA 402 device display

MOOG ID No.:CB40859-001 Date:11/2020

MSD ServoDrive - DeviceHelp 273

# 8 Motion profile

MOOG ID No.:CB40859-001 Date:11/2020

MSD ServoDrive - DeviceHelp 274

|Display|System state|power disabled|fault|
|---|---|---|---|
|Control enabled|0|Start|7|
| |fault reaction active|0|14|
|Quick stop active|1|not ready|8|
| |to switch on|1|17|
|Error reaction active|2|switch on|disabled|
| |2|7| |
|Error state (in this state the error is indicated directly on the display.)|3|ready to|switch on|
|Device is reset (display flashes)|power enabled|3|6|
| |10|12| |
|• Number [5.] flashes when “STO” (Safe Torque Off) input is active. Display goes out when STO inactive.| | | |
|• The dot on the display flashes when the power stage is active.| | | |

Table 8.28: Central state machine according to CiA 402 device display (continue)

NOTE

l The system states indicated on the display may differ from the states in the table depending on the drive profile setting.

Image 8.70: State machine diagram based on CANopen communications

⓪ to ① State number

1 to 17 State transition (No. 17: DC link voltage cut off)

Legend for “State machine diagram based on CANopen communications” figure

# 8.10 Touch probe

|ID|Index Name / Setting|
|---|---|
|241|0 MPRO_TP_Position|
|241|1 MPRO_TP_Position|
|241|2 MPRO_TP_Position|
|241|3 MPRO_TP_Position|
|241|4 MPRO_TP_Position|
|1400|0 MPRO_TP_Config|
| |TP_TP (0)|
| |AB (1)|
| |PD_UP (2)|
| |PD_DOWN (3)|
| |PC_PC (4)|
| |PC_TP (5)|
| |TP_PC (6)|
| |ENC_ENC (7)|
| |ENC_TP (8)|
| |TP_ENC (9)|

Using the touch probe inputs, touch probe functions can be performed. In order to be able to do this, P 106[0] - MPRO_INPUT_FS_ISD05 and P 107[0] - MPRO_INPUT_FS_ISD06 must be used to set digital inputs ISD05 and ISD06 to ""PROBE(15) = Touch probe (only ISD05/06)"" (see Section ""Digital inputs"" on page 290). HTL encoders can be evaluated or pulse counters implemented using the MSD PLC.

The touch probe can be triggered with P 240 - MPRO_TP_Ctrl. This enables triggering on a positive or negative edge, or on both edges, of the signal detected on the touch probe inputs. After the measurement, the parameter jumps back to the value ""NONE (0)"" and the latch position is mapped in the corresponding subindex of parameter P 241 - MPRO_TP_Position. A continuous touch probe mode is not possible at present, so the touch probe has to be reactivated after the measurement.

P 1402 - MPRO_TP_Channel can be used to select various positions as actual value sources of the latch position for the touch probe functionality. The following table provides an overview of the available settings. The counters are accessed via the MSD PLC or a bus system.

|ID|Index Name / Setting|Unit|Description|
|---|---|---|---|
|240|MPRO_TP_Ctrl|Touch probe: Control| |
| |0| |NONE (0) = No function|
| |1| |POS (1) = Positive edge|
| |2| |NEG (2) = Negative edge|
| |3| |BOTH (3) = Both edges|
|240|0 MPRO_TP_Ctrl| | |
|240|1 MPRO_TP_Ctrl| | |
|240|2 MPRO_TP_Ctrl| | |
|241|MPRO_TP_Position|Probe: Pos. high/low edge of TP0/1, encoder zero pulse| |

Table 8.29: “Touch probe” parameters

MOOG ID No.:CB40859-001 Date:11/2020

# 8 Motion profile

|Unit|Description|
|---|---|
|mDegree|Touch probe: Configuration|
|mDegree|TP0, TP1 touch probe|
|mDegree|TP0, TP1 as encoder, A/B as quadrature counting|
|mDegree|TP0, TP1 as encoder, pulse (TP0) / direction (TP1), count up on direction high|
|mDegree|TP0, TP1 as encoder, pulse (TP0) / direction (TP1), count down on direction high|
|mDegree|TP0 pulse counter, TP1 pulse counter|
|mDegree|TP0 pulse counter, TP1 touch probe|
|mDegree|TP1 touch probe, TP0 pulse counter|
|mDegree|TP0 encoder counter, TP1 encoder counter|
|mDegree|TP0 encoder counter, TP1 touch probe|
|mDegree|TP0 touch probe, TP1 encoder counter|

Touch probe: Channel

|Unit|Description|
|---|---|
|ACTPOS (0)|Actual position in user units|
|ACTPOSINC (1)|Actual position in increments|
|MASTERPOS (2)|Master position in increments|
|ENCPOS_CH1 (3)|Encoder position Channel 1|
|ENCPOS_CH1_INC (4)|Encoder position Channel 1 in increments|
|ENCPOS_CH2 (5)|Encoder position Channel 2|
|ENCPOS_CH2_INC (6)|Encoder position Channel 2 in increments|

# 8 Motion profile

MOOG ID No.:CB40859-001 Date:11/2020 MSD ServoDrive - DeviceHelp 276

|ID|Index Name / Setting|Unit|Description|
|---|---|---|---|
|7|ENCPOS_CH3 (7)| |Encoder position Channel 3|
|8|ENCPOS_CH3_INC (8)| |Encoder position Channel 3 in increments|
|9|ENCPOS_CH4 (9)| |Encoder position Channel 4|
|10|ENCPOS_CH4_INC (10)| |Encoder position Channel 4 in increments|
|11|ACTPOS2 (11)| |Actual position of redundant encoder in user units|
|12|Sercos (12)| |Referred to Sercos profile parameters S-x-0426, S-x-0427|
|13|UserRefPos(13)| |Reference position in user units|
|14|MasterPosST(14)| |Master position (ECAM, EGEAR) singleturn, always steps|
|15|CommonMasterPos(15)| |Master position (ECAM, EGEAR) singleturn, always steps|
|16|CommonMasterPosST(15)| |Master position (ECAM, EGEAR) singleturn, always steps|
|1402|MPRO_TP_Channel| | |
|1402|MPRO_TP_Channel| | |
|1402|MPRO_TP_Channel| | |
|1404|MPRO_TP_Lines| |Touch probe: Lines @ pulse counter on channel x|
|1404|MPRO_TP_Lines| | |
|1404|MPRO_TP_Lines| | |

Image 8.71: “Synchronized motion” screen

There are various modes available in the “synchronization mode” drop-down menu (P 242[0] - MPRO_ECAM_SyncModMode):

- Off(0) = Synchronized motion off
- ECAM_iPlc(1) = Electronic cam plate via MSD PLC
- EGEAR_iPlc(2) = Electr. gear unit via MSD PLC
- ECAM_PARA(3) = Electronic camming via parameters
- EGEAR_PARA(4) = Electronic gearing via parameters

NOTE: For more information refer to the bus system User Manuals or the description of the MSD PLC.

# 8.11.1 Electronic cam plate

The other parameters are configured in separate screens that can be accessed with the corresponding buttons.

- Master configuration (see Section ""Master configuration"" on page 280)
- Electronic gearing (see Section ""Electronic gearing"" on page 283)
- Electronic camming (see Section ""Electronic cam plate"" on page 277)

P 1318[0] - MPRO_ECAM_ControlWord is the control word for “synchronized motion” (see Section ""Control word for synchronized motion"" on page 279).

P 1326[0] - MPRO_ECAM_StatusWord is the status word for “synchronized motion” (see Section ""Status word for synchronized motion"" on page 279).

# 8.11.1.1 Table selection

|ID|Index Name|Unit|Description|
|---|---|---|---|
|1300|MPRO_ECAM_CTS_| |ECAM: CamTableSelect - Master reference|
|1301|MasterRef| | |
|1305|MPRO_ECAM_CTS_| |ECAM: CamTableSelect - Method for changing the camtable|
|1306|MPRO_ECAM_CTS_| |ECAM: CamTableSelect - Mode for changing the camtable|
|1307|MPRO_ECAM_CTS_|incr|ECAM: CamTableSelect - Distance for changing the camtable|
|242|MPRO_ECAM_| |ECAM / EGEAR: Mode of synchronized motion SyncModMode|
|265|MPRO_ECAM_| |ECAM / EGEAR: Slave speed factor (1 = 100%).|
|266|CamSlave_SpeedFactor| | |
|268|MPRO_ECAM_| |ECAM / EGEAR: Mode of switching off sync. motion|

# 8.11.1.2 Synchronization

|ID|Index Name|Unit|Description|
|---|---|---|---|
|1342|MPRO_ECAM_CI_|incr|ECAM: CamIn - Synchronization position (multiturn part)|
|1343|MPRO_ECAM_CO_|incr|ECAM: CamOut - Decoupling pos. (multiturn part)|
|1303|MPRO_ECAM_CI_|incr|ECAM: CamIn - Master offset|
|1308|MPRO_ECAM_CI_| |ECAM: CamIn - Master reference|
|1309|MPRO_ECAM_CI_| |ECAM: CamIn - Slave reference|
|1310|MPRO_ECAM_CI_| |ECAM: CamIn - Coupling mode|
|1311|MPRO_ECAM_CI_|incr|ECAM: CamIn - Coupling distance|
|1312|MPRO_ECAM_CI_|incr|ECAM: CamIn - Synchronization position|

Table 8.31: “Electronic camming - Table selection” parameters

Table 8.30: “Synchronized motion” parameters

Table 8.32: “Electronic camming - Synchronization” parameters

MOOG ID No.:CB40859-001 Date:11/2020

MSD ServoDrive - DeviceHelp 277

# 8 Motion profile

MOOG ID No.:CB40859-001 Date:11/2020 MSD ServoDrive - DeviceHelp 278

|ID|Index|Name|Unit|Description|
|---|---|---|---|---|
|1313|0|MPRO_ECAM_CO_SyncPosST|(singleturn part)|ECAM: CamOut - Slave reference|
|1314|0|MPRO_ECAM_CO_DecouplingMode|63|ECAM: CamOut - Decoupling mode|
|1315|0|MPRO_ECAM_CO_BreakingPosST|incr|ECAM: CamOut - Decoupling position|
|1316|0|MPRO_ECAM_CO_DecouplingDist|incr|ECAM: CamOut - Decoupling distance|
|1317|0|MPRO_ECAM_CO_StandstillPos|mDegree|ECAM: CamOut - Slave standstill position|

# Table 8.32: “Electronic camming - Synchronization” parameters (continue)

|ID|Index|Name|Unit|Description|
|---|---|---|---|---|
|1346| |MPRO_ECAM_SP_Table| |ECAM: Setpoint table interface|
|1346|0|Index| |Index of setpoint table|
|1346|1|Value| |Value at index of setpoint table|
|1347|0 to 31|MPRO_ECAM_SP_Index| |ECAM: Setpoint segments start index|
|1348|0 to 31|MPRO_ECAM_SP_Length| |ECAM: Setpoint segments length|
|1349|0 to 31|Length| | |
|1350|0|MPRO_ECAM_SP_MaDist| |ECAM: Setpoint segments master distance|
|1351|0|MPRO_ECAM_SP_IpoType| |ECAM: Setpoint segments interpolation type|
|1352|0 to 31|Checksum| |ECAM: Setpoint table checksum|
|1353|0 to 31|GainNum| |ECAM: Setpoint segments gain numerator|
| | |GainDen| |ECAM: Setpoint segments gain denominator|

# Table 8.33: “Electronic camming - Table segments” parameters

|ID|Index|Name|Unit|Description|
|---|---|---|---|---|
|1329|0 to 63|MPRO_ECAM_SegData_IndexNext| |ECAM: Index of the following segment|
|1330|0 to 63|MPRO_ECAM_SegData_IndexPrev| |ECAM: Index of the previous segment|
|1331|0 to 63|MPRO_ECAM_SegData_ProfileMode| |ECAM: Profile mode of the current segment|
|1332|0 to 63|MPRO_ECAM_SegData_DistMaster| |ECAM: Length of the master section of the current segment|
|1333|0 to 63|MPRO_ECAM_SegData_DistSlave| |ECAM: Length of the slave section of the current segment|
|1334|0 to 63|MPRO_ECAM_SegData_Lambda| |ECAM: Lambda value of the current segment|
|1335|0 to 63|MPRO_ECAM_SegData_StatusWord| |ECAM: Status word of the current segment|
|1336|0 to 63|MPRO_ECAM_SegData_ControlWord| |ECAM: Control word of the current segment|

# 8.11.2 Control word for synchronized motion

|Bit|Function|PLC function|Bit number|Description|
|---|---|---|---|---|
|0-7|Start segment (8-bit value)|-|0-7|Actual segment (8-bit value)|
|8-15|Reserved|-| |Actual ECAM / EGEAR state machine state (4 Bit value)|
|16|Absolute (true) / relative (false) master relationship|-| |- 0: ECAM / EGEAR asynchronous
- 1: ECAM / EGEAR synchronous
|
|17|Absolute (true) / relative (false) master (CAM) relationship at cam in|-| |- 2: ECAM / EGEAR synchronizing
- 3: ECAM / EGEAR desynchronizing
|
|18|Absolute (true) / relative (false) slave (CAM) relationship at cam in|-| |- 4: ECAM / EGEAR active and waiting for going asynchronous
|
|19-23|Reserved|-| |- 5: ECAM / EGEAR inactive and waiting for going synchronous
|
|24|Change gear ratio of the electronic gear online|MCB_GearRatioChange| | |
|25|Disable master calculation|MCB_Cam_MasterEnable| | |
|26|Enable master calculation|MCB_Cam_MasterEnable| | |
|27|Select CAM table|MCB_CamTableSelect| | |
|28|Start Ecam|MCB_CamIn| | |
|29|Stop Ecam|MCB_CamOut| | |
|30|Start Egear|MCB_GearIn| | |
|31|Stop Egear|MCB_GearOut| | |

# 8.11.3 Status word for synchronized motion

|Bit|Function|PLC function|Bit number|Description|
|---|---|---|---|---|
|12-26|Reserved|-| | |
|27|ECAM / EGEAR is active|-| | |
|28|Valid segments chosen|-| | |
|29|Master data are valid|-| | |
|30|Master is initialized|-| | |
|31|Master calculation is active|-| | |

Table 8.35: Control word ECAM (P 1318[0] - MPRO_ECAM_ControlWord)

Table 8.36: ECAM status word (P 1326[0] - MPRO_ECAM_StatusWord)

MOOG ID No.:CB40859-001 Date:11/2020 MSD ServoDrive - DeviceHelp 279

# 8 Motion profile

# 8 Motion profile

MOOG ID No.:CB40859-001 Date:11/2020

MSD ServoDrive - DeviceHelp 280

# 8.11.4 Master configuration

the master encoder, you will need to set the resolution relative to a single motor revolution in P 250 - MPRO_ECAM_PARAMaster_Amplitude (see below).

- ENC CH1 (3) = Encoder channel 1 X7 (Sin/Cos)
- ENC CH2 (4) = Encoder channel 2 X6 (Resolver)
- ENC CH3 (5) = Encoder channel 3 X8 (optional)

This function is only available if an external interface X8 (option module) is present.

- TP0 (6) = Pulse counter on probe channel 0 (TP0)
- TP1 (7) = Pulse counter on probe channel 1 (TP1)
- ENC_CH4 (8) = Encoder channel 4 (p. e. fieldbus)
- TWIN_POS (9) = TWIN remote reference position (P-2607)

Image 8.72: “Master configuration” screen

# Channel selection (master encoder)

P 1319[0] - MPRO_ECAM_CamMaster_AxisType is used to define the master encoder.

- NO AXIS (0) = No axis
- VIRTUAL MASTER (1) = Virtual master

If you select this function, you will be able to configure additional settings by clicking on the enabled “Options...” button (see Section ""Virtual Master"" on page 286).

- PARA (2) = Master parameter interface

If you select this function because a higher-level controller is being used as

# Anti-reverse mode

Slave only starts moving along with it again as soon as the master reaches the zero position.

P 1320[0] - MPRO_ECAM_CamMaster_RevLockMode is used to define the reverse lock mode, which can be used either with or without path compensation. The dashed lines in the following diagrams indicate what the engagement distance is:

# Example:

If the master, which has moved two motor revolutions in the direction blocked for the slave, then moves in the unblocked direction again, the slave only moves off when the master has traversed the zero point.

- INACTIVE (0) = Reverse lock inactive
- ACTIVE (2) = Reverse lock enabled - without path optimization
- ACTIVE WAY COMP (1) = Reverse lock active - with way compensation

While the slave accelerates to the speed of the master during engagement, the master and slave do not move synchronously. This function needs to be selected in order to quickly catch up to the master that is running ahead.

# Example:

- Master (black line) rotates in the blocked direction
- The slave (blue line) remains stopped
- Master rotates in the unblocked direction again
- The slave follows the master directly in the unblocked direction

Assume the master has moved two motor revolutions in the direction for which the slave lock is enabled. If the master now moves in the direction for which there is no lock, the slave will immediately start running in that direction.

MOOG ID No.:CB40859-001 Date:11/2020

MSD ServoDrive - DeviceHelp 281

# 8 Motion profile

MOOG ID No.:CB40859-001 Date:11/2020 MSD ServoDrive - DeviceHelp 282

|Filter type|ID|Index Name|Unit|Description|
|---|---|---|---|---|
|When using a real master encoder, encoder signals may be subject to noise.|P 1340|1319|0|MPRO_ECAM_CamMaster_AxisType|
| | |MPRO_ECAM_CamMaster_SpeedFilTyp| |ECAM / EGEAR: Channel selection of internal master input|
| | |1320|0|MPRO_ECAM_CamMaster_RevLockMode|
| | |1321|0|MPRO_ECAM_CamMaster_Amplitude|
| | |1322|0|MPRO_ECAM_CamMaster_GearNum|
| | |1323|0|MPRO_ECAM_CamMaster_GearDen|
|Filter time|1327|0|ms|ECAM / EGEAR: Filter time constant of master|
|If P 1340[0] is used to enable a filter, P 1327[0] - MPRO_ECAM_CamMaster_SpeedTFil can be used to define the corresponding filter time.|1328|0|speed|ECAM / EGEAR: Speed factor of the internal master|
|Speed factor|1340|0| |MPRO_ECAM_CamMaster_SpeedFilTyp|
|The master encoder can be assigned an additional speed factor P 1328[0] - MPRO_ECAM_CamMaster_SpeedFactor.|1341|0|incr|ECAM / EGEAR: Master drive offset|

Table 8.37: “Synchronized motion - Master configuration” parameters (continue)

| | | |ID|Index Name|Unit|Description|
|---|---|---|---|---|---|---|
|247|0|MPRO_ECAM_ParaMaster_ActPos|incr|ECAM / EGEAR: Parameter interface master position| | |
|248|0|MPRO_ECAM_ParaMaster_ActSpeed|rpm|ECAM / EGEAR: Parameter interface master speed| | |
|249|0|MPRO_ECAM_ParaMaster_ActAcc|rpm|ECAM / EGEAR: Parameter interface master acceleration| | |
| |250|0|MPRO_ECAM_ParaMaster_Amplitude| |ECAM / EGEAR: Parameter interface master amplitude| |

Table 8.37: “Synchronized motion - Master configuration” parameters

# 8.11.5 Electronic gearing

# Gear ratio

The gear ratio is specified as a fraction. This ensures that the position references can be translated to the motor shaft with no rounding error.

- ""Slave"" (P 252[0] - MPRO_ECAM_Egear_GearNum) is the numerator
- ""Master"" (P 251[0] - MPRO_ECAM_Egear_GearDen) is the denominator

# Scaling of speed pre-control

Defined with P 265[0] - MPRO_ECAM_CamSlave_SpeedFactor definiert.

# Scaling of torque pre-control

Defined with P 266[0] - MPRO_ECAM_CamSlave_TorqueFactor.

# Engagement

See Section ""Engagement"" on page 284.

# Disengagement

See Section ""Disengagement"" on page 285.

|ID|Index Name|Unit|Description|
|---|---|---|---|
|251|0 MPRO_ECAM_Egear_GearDen| |EGEAR: Gear denominator|
|252|0 MPRO_ECAM_Egear_GearNum| |EGEAR: Numerator of gear ratio|
|1344|0 MPRO_ECAM_Egear_LimRefAcc|rpm/s|EGEAR: Acceleration limit for reference|
|1345|0 MPRO_ECAM_Egear_LimRefJerk|rpm/s²|EGEAR: Jerk limit for reference|

Table 8.38: “Synchronized motion - Electronic gearing” parameters

Image 8.73: ""Electronic gearing"" screen

MOOG ID No.:CB40859-001 Date:11/2020 MSD ServoDrive - DeviceHelp 283

# 8 Motion profile

# 8 Motion profile

MOOG ID No.:CB40859-001 Date:11/2020

MSD ServoDrive - DeviceHelp 284

# 8.11.6 Engagement

used to define the engagement distance (between the dashed lines).

P 253[0] - MPRO_ECAM_Egear_GearInMode is used to define the mode for engagement.

- DIRECT (0) = Direct
- Direct engagement: Angular synchronous; with jerking (no ramps).
- CROSSFADE (3) = Crossfading
- Engagement with crossfading function (5th degree polynomial): Angular synchronous; jerk-limited; speed will overshoot during engagement.
- RAMP (1) = Linear speed ramp
- Engagement with linear acceleration: Not angular synchronous; with jerking.
- FADE (2) = Engagement fade-out
- Engagement with fade-in function (5th degree polynomial): Not angular synchronous; jerk-limited. The position is ignored. ",How is wire break monitoring configured for the analog inputs in the 'MSD ServoDrive - DeviceHelp' document?,A4,P 399 parameter enables detection of wire breaks for analog channels.,1.2265625,1.1328125,3.109375,1.2265625,0.306640625
19,msd_servo_drive.txt,76,b87ca5e232c2bdbb6fa16a8a401c6b5d285dc0183e73cc9d134de13dd2fc71d2,"MOOG ID No.:CB40859-001 Date:11/2020

MSD ServoDrive - DeviceHelp 267

# 8 Motion profile

MOOG ID No.:CB40859-001 Date:11/2020 MSD ServoDrive - DeviceHelp 268

# Deceleration

With ...

- P 194 - MPRO_TAB_TDec (for torque control) or
- P 197 - MPRO_TAB_SDec (for speed control) or
- P 200 - MPRO_TAB_PDec (for position control)

and indexes 0–15, the deceleration for each individual motion task can be defined. The input must not be zero.

# Wait time in Auto mode

P 204 - MPRO_TAB_WaitTime is used to define the wait time before the next motion task is carried out.

# Maximum table index in Auto mode

P 206[0] - MPRO_Tab_MaxIdx is used to define the table index up to which driving jobs will be carried out in one of the auto modes.

# Current table index

P 207[0] - MPRO_Tab_ActIdx will show the index for the motion task that is currently active. If parameter P 205 MPRO_TAB_Mode is set to “Para(0)”, a driving set can be entered and approached directly.

# Activation of reference table

The following procedures can be used in order to activate the setpoint table for operation.

|ID|Index Name|Unit|Description|
|---|---|---|---|
|193|MPRO_TAB_TAcc|TAB: Torque mode acceleration|Nm/ms|
|193|0|MPRO_TAB_TAcc|Nm/ms|
|193|1 - 15|MPRO_TAB_TAcc|Nm/ms|
|194|MPRO_TAB_TDec|TAB: Torque mode deceleration| |
|194|0|MPRO_TAB_TDec|Nm/ms|
|194|1 - 15|MPRO_TAB_TDec|Nm/ms|

# Table 8.23: Activation of table references

# Table 8.24: “Setpoint table settings” parameters

# Table 8.24: “Setpoint table settings” parameters (continue)

|ID|Index Name|Unit|Description|ID|Index Name|Unit|Description|
|---|---|---|---|---|---|---|---|
|195|MPRO_TAB_TRef|Nm|TAB: Torque mode reference value|208|MPRO_TAB_OutputNo| |OSD TAB: actual table index and target|
|195|MPRO_TAB_TRef|Nm| |208|MPRO_TAB_OutputNo| | |
|196|MPRO_TAB_SAcc|rev/min/s|TAB: Speed mode acceleration|269|MPRO_TAB_Ctrl| |TAB: control word|
|196|MPRO_TAB_SAcc|rev/min/s| | | | | |
|197|MPRO_TAB_SDec|rev/min/s|TAB: Speed mode deceleration| | | | |
|197|MPRO_TAB_SDec|rev/min/s| | | | | |
|198|MPRO_TAB_SRef|rev/min|TAB: Speed mode reference value| | | | |
|198|MPRO_TAB_SRef|rev/min| | | | | |
|199|MPRO_TAB_PAcc|rev/min/s|TAB: Position control mode acceleration| | | | |
|199|MPRO_TAB_PAcc|rev/min/s| | | | | |
|200|MPRO_TAB_PDec|rev/min/s|TAB: Position control mode Acceleration| | | | |
|200|MPRO_TAB_PDec|rev/min/s| | | | | |
|201|MPRO_TAB_PSpd|rev/min|TAB: Position control mode speed| | | | |
|201|MPRO_TAB_PSpd|rev/min| | | | | |
|202|MPRO_TAB_PPos|mDegree|TAB: Position control mode reference value| | | | |
|202|MPRO_TAB_PPos|mDegree| | | | | |
|203|MPRO_TAB_PMode| |Position control table:Mode| | | | |
|203|MPRO_TAB_PMode| | | | | | |
|204|MPRO_TAB_WaitTime|ms|TAB: Wait time| | | | |
|204|MPRO_TAB_WaitTime|ms| | | | | |
|205|MPRO_TAB_Mode| |TAB mode| | | | |
|206|MPRO_Tab_MaxIdx| |TAB: Max index in AUTO mode| | | | |
|207|MPRO_TAB_ActIdx| |TAB: Actual index| | | | |

MOOG ID No.:CB40859-001 Date:11/2020

MSD ServoDrive - DeviceHelp

# 8 Motion profile

MOOG ID No.:CB40859-001 Date:11/2020

MSD ServoDrive - DeviceHelp 270

# 8.8 Analog channel (ISA00 und ISA01)

# Offset (O)

This parameter (P 174 - MPRO_ANA0_SOffset for ISA00, P 184 - MPRO_ANA1_SOffset for ISA01) compensates for component variations and is used for offset compensation purposes. Depending on the control mode being used (see Section ""Basic settings"" on page 110), the value will be stored in parameter index [0] (torque control), [1] (speed control) or [2] (position control).

# Backlash (B)

This parameter (P 175 - MPRO_ANA0_SThreshold for ISA00, P 185 - MPRO_ANA1_SThreshold for ISA01) can suppress axis motion close to the standstill (stop) position. Depending on the control mode being used (see Section ""Basic settings"" on page 110), the value will be stored in parameter index [0] (torque control), [1] (speed control) or [2] (position control).

Image 8.68: “Analog channel” screen

# Acceleration ramp

Two standard analog inputs (ISA00, ISA01) are available. These inputs can be configured...

- with negative values for analog setpoint settings
- with positive values for digital setpoint processing

(P 109[0] - MPRO_INPUT_FS_ISA00 and P 110[0] - MPRO_INPUT_FS_ISA01).

see also section ""Analog Inputs"" on page 303. By using the ""REV(-2) = Analog setpoint"" setting, an analog input voltage of ±10 V can be processed as a setpoint.

# Deceleration ramp

This parameter serves as a deceleration ramp for torque control (P 176[1] - MPRO_ANA0_TRamp for ISA00, P 186[1] - MPRO_ANA1_TRamp for ISA01) or speed control (P 177[1] - MPRO_ANA0_SRamp for ISA00, P 187[1] - MPRO_ANA1_SRamp for ISA01). Depending on the control mode being used (see Section ""Basic settings"" on page 110), the value will be stored in parameter index [0] (torque control), [1] (speed control) or [2] (position control).

This parameter (P 173 - MPRO_ANA0_Scale for ISA00, P 183 - MPRO_ANA1_Scale for ISA01) is used to define which speed / which torque / which position corresponds to the maximum analog value. Depending on the control mode being used (see Section ""Basic settings"" on page 110), the value will be stored in parameter index [0] (torque control), [1] (speed control) or [2] (position control).

# 8.8.1 Special characteristics of position control mode

A threshold value can also be specified which generates a run-on range around the last reference value. A ramp function calculates a motion profile for the position reference from pre-defined acceleration and speed limits.

The position references on the analog channel are not applied immediately, but dependent on a digital input. Accordingly, one of the ISD00 to ISD06 digital inputs must be set to a value of ""REFANAEN(28) = Enable analog reference value"" (see Section ""Digital inputs"" on page 290). The position setpoint being received will only be applied if the corresponding digital input is active. The acceleration is entered using P 173[0] - MPRO_ANA0_TScale or P 183[0] - MPRO_ANA1_TScale.

# 8.8.2 Wire Break Monitoring

P 399 - CON_ANAWireBrk_Th can be used to configure wire break monitoring for the analog inputs. For details see Section ""Wire Break Monitoring"" on page 306.

|Function|TLIM (-4)|OVR (-3)|REFV (-2)|leer (-1)|OFF (0)|
|---|---|---|---|---|---|
|Digital|(1)-(28)|(1)-(28)|(1)-(28)|(1)-(28)|(1)-(28)|
|Analog channel|Filter|Scale|Offset|Profile|generator|

Control

Image 8.69: Reference processing structure

MOOG ID No.:CB40859-001 Date:11/2020

MSD ServoDrive - DeviceHelp 271

# 8 Motion profile

# 8 Motion profile

MOOG ID No.:CB40859-001 Date:11/2020

|ID|Index Name|Unit|Description|ID|
|---|---|---|---|---|
|395|CON_ANA_Isaf_Scaled| |Analog inputs: Values (filt, norm, comp, scaled)|174|
|395|0 ISA00| |Scaled, compensated, filtered, normalized value|175|
|395|1 ISA01| |Scaled, compensated, filtered, normalized value| |
|396|CON_ANA_Scale_ThUpper| |Analog inputs: Upper scaling limits|175|
|396|0 ISA00|%|Upper scaling (@ 10 V) threshold|175|
|396|1 ISA01|%|Upper scaling (@ 10 V) threshold| |
|397|CON_ANA_Scale_ThZero| |Analog inputs: Zero scaling thresholds|176|
|397|0 ISA00|V|Zero scaling threshold (+/-)|176|
|397|1 ISA01|V|Zero scaling threshold (+/-)| |
|398|CON_ANA_Scale_ThLower| |Analog inputs: Lower scaling limits|177|
|398|0 ISA00|%|Lower scaling (@ zero threshold) threshold|177|
|398|1 ISA01|%|Lower scaling (@ zero threshold) threshold| |
|399|CON_ANA_WireBrk_Th| |Analog inputs: Wire break thresholds|Table 8.26:|
|399|0 ISA00|V|Wire break detection threshold| |
|399|1 ISA01|V|Wire break detection threshold| |
|405|0 CON_ANA_Filt0|ms|Analog input ISA00: Filter time constant (PT 1)|ID|
|408|CON_ANA_Isaf_Norm| |Analog inputs: Values (filt, norm)|183|
|408|0 ISA00| |Filtered, normalized value|183|
|408|1 ISA01| |Filtered, normalized value|183|

Table 8.25: “Analog channel” parameters

|ID|Index Name|Unit|Description|ID|
|---|---|---|---|---|
|173|MPRO_ANA0_Scale| |ANA0: scale factors|184|
|173|0 MPRO_ANA0_TScale|Nm|ANA0: scale factor torque reference|185|
|173|1 MPRO_ANA0_SScale|rev/min|ANA0: scale factor speed reference|185|
|173|2 MPRO_ANA0_PScale|mDegree|ANA0: scale factor position reference| |
|174|MPRO_ANA0_Offset| |ANA0: offsets|185|
|174|0 MPRO_ANA0_TOffset|Nm|ANA0: offsets for torque reference|185|

Table 8.26: “Analog channel ISA00” parameters

|Index Name|Unit|Description|
|---|---|---|
|1 MPRO_ANA0_SOffset|rev/min|ANA0: offsets for speed reference|
|2 MPRO_ANA0_POffset|mDegree|ANA0: offsets for position reference|
|MPRO_ANA0_Threshold| |ANA0: thresholds|
|0 MPRO_ANA0_TThreshold|Nm|ANA0: threshold for torque reference|
|1 MPRO_ANA0_SThreshold|rev/min|ANA0: threshold for speed reference|
|2 MPRO_ANA0_PThreshold|mDegree|ANA0: threshold for position reference|
|MPRO_ANA0_TRamp| |ANA0: Torque mode acceleration [0] and deceleration [1]|
|0 MPRO_ANA0_TRamp|Nm/s| |
|1 MPRO_ANA0_TRamp|Nm/s| |
|MPRO_ANA0_SRamp| |ANA0: Speed mode acceleration [0] and deceleration [1]|
|0 MPRO_ANA0_SRamp|SPEED/s| |
|1 MPRO_ANA0_SRamp|SPEED/s| |

“Analog channel ISA00” parameters (continue)

|Index Name|Unit|Description|
|---|---|---|
|MPRO_ANA1_Scale| |ANA1: scale factors|
|0 MPRO_ANA1_TScale|Nm|ANA0: scale factor torque reference|
|1 MPRO_ANA1_SScale|rev/min|ANA0: scale factor speed reference|
|2 MPRO_ANA1_PScale|mDegree|ANA0: scale factor position reference|
|MPRO_ANA1_Offset| |ANA1: offsets|
|0 MPRO_ANA1_TOffset|Nm|ANA1: offsets for torque reference|
|1 MPRO_ANA1_SOffset|rev/min|ANA1: offsets for speed reference|
|2 MPRO_ANA1_POffset|mDegree|ANA1: offsets for position reference|
|MPRO_ANA1_Threshold| |ANA1: thresholds|
|0 MPRO_ANA1_TThreshold|Nm|ANA1: threshold for torque reference|
|1 MPRO_ANA1_SThreshold|rev/min|ANA1: threshold for speed reference|
|2 MPRO_ANA1_PThreshold|mDegree|ANA1: threshold for position reference|

“Analog channel ISA01” parameters

# 8 Motion profile

|ID|Index Name|Unit|Description|
|---|---|---|---|
|186|MPRO_ANA1_TRamp|Nm/s|ANA1: Torque mode acceleration [0] and deceleration[1]|
|186|MPRO_ANA1_TRamp|Nm/s| |
|187|MPRO_ANA1_SRamp|SPEED/s|ANA1: Speed mode acceleration [0] and deceleration [1]|
|187|MPRO_ANA1_SRamp|SPEED/s| |

# Table 8.27: “Analog channel ISA01” parameters (continue)

Display

- System state
- Initialization on device startup
- Not ready (DC link voltage possibly too low)
- Start inhibit (DC link voltage present, power stage off)
- Starting lockout
- Ready for start
- Control initialization: Auto commutation, flux build-up etc.

# Table 8.28: Central state machine according to CiA 402 device display

MOOG ID No.:CB40859-001 Date:11/2020

MSD ServoDrive - DeviceHelp 273

# 8 Motion profile

MOOG ID No.:CB40859-001 Date:11/2020

MSD ServoDrive - DeviceHelp 274

|Display|System state|power disabled|fault|
|---|---|---|---|
|Control enabled|0|Start|7|
| |fault reaction active|0|14|
|Quick stop active|1|not ready|8|
| |to switch on|1|17|
|Error reaction active|2|switch on|disabled|
| |2|7| |
|Error state (in this state the error is indicated directly on the display.)|3|ready to|switch on|
|Device is reset (display flashes)|power enabled|3|6|
| |10|12| |
|• Number [5.] flashes when “STO” (Safe Torque Off) input is active. Display goes out when STO inactive.| | | |
|• The dot on the display flashes when the power stage is active.| | | |

Table 8.28: Central state machine according to CiA 402 device display (continue)

NOTE

l The system states indicated on the display may differ from the states in the table depending on the drive profile setting.

Image 8.70: State machine diagram based on CANopen communications

⓪ to ① State number

1 to 17 State transition (No. 17: DC link voltage cut off)

Legend for “State machine diagram based on CANopen communications” figure

# 8.10 Touch probe

|ID|Index Name / Setting|
|---|---|
|241|0 MPRO_TP_Position|
|241|1 MPRO_TP_Position|
|241|2 MPRO_TP_Position|
|241|3 MPRO_TP_Position|
|241|4 MPRO_TP_Position|
|1400|0 MPRO_TP_Config|
| |TP_TP (0)|
| |AB (1)|
| |PD_UP (2)|
| |PD_DOWN (3)|
| |PC_PC (4)|
| |PC_TP (5)|
| |TP_PC (6)|
| |ENC_ENC (7)|
| |ENC_TP (8)|
| |TP_ENC (9)|

Using the touch probe inputs, touch probe functions can be performed. In order to be able to do this, P 106[0] - MPRO_INPUT_FS_ISD05 and P 107[0] - MPRO_INPUT_FS_ISD06 must be used to set digital inputs ISD05 and ISD06 to ""PROBE(15) = Touch probe (only ISD05/06)"" (see Section ""Digital inputs"" on page 290). HTL encoders can be evaluated or pulse counters implemented using the MSD PLC.

The touch probe can be triggered with P 240 - MPRO_TP_Ctrl. This enables triggering on a positive or negative edge, or on both edges, of the signal detected on the touch probe inputs. After the measurement, the parameter jumps back to the value ""NONE (0)"" and the latch position is mapped in the corresponding subindex of parameter P 241 - MPRO_TP_Position. A continuous touch probe mode is not possible at present, so the touch probe has to be reactivated after the measurement.

P 1402 - MPRO_TP_Channel can be used to select various positions as actual value sources of the latch position for the touch probe functionality. The following table provides an overview of the available settings. The counters are accessed via the MSD PLC or a bus system.

|ID|Index Name / Setting|Unit|Description|
|---|---|---|---|
|240|MPRO_TP_Ctrl|Touch probe: Control| |
| |0| |NONE (0) = No function|
| |1| |POS (1) = Positive edge|
| |2| |NEG (2) = Negative edge|
| |3| |BOTH (3) = Both edges|
|240|0 MPRO_TP_Ctrl| | |
|240|1 MPRO_TP_Ctrl| | |
|240|2 MPRO_TP_Ctrl| | |
|241|MPRO_TP_Position|Probe: Pos. high/low edge of TP0/1, encoder zero pulse| |

Table 8.29: “Touch probe” parameters

MOOG ID No.:CB40859-001 Date:11/2020

# 8 Motion profile

|Unit|Description|
|---|---|
|mDegree|Touch probe: Configuration|
|mDegree|TP0, TP1 touch probe|
|mDegree|TP0, TP1 as encoder, A/B as quadrature counting|
|mDegree|TP0, TP1 as encoder, pulse (TP0) / direction (TP1), count up on direction high|
|mDegree|TP0, TP1 as encoder, pulse (TP0) / direction (TP1), count down on direction high|
|mDegree|TP0 pulse counter, TP1 pulse counter|
|mDegree|TP0 pulse counter, TP1 touch probe|
|mDegree|TP1 touch probe, TP0 pulse counter|
|mDegree|TP0 encoder counter, TP1 encoder counter|
|mDegree|TP0 encoder counter, TP1 touch probe|
|mDegree|TP0 touch probe, TP1 encoder counter|

Touch probe: Channel

|Unit|Description|
|---|---|
|ACTPOS (0)|Actual position in user units|
|ACTPOSINC (1)|Actual position in increments|
|MASTERPOS (2)|Master position in increments|
|ENCPOS_CH1 (3)|Encoder position Channel 1|
|ENCPOS_CH1_INC (4)|Encoder position Channel 1 in increments|
|ENCPOS_CH2 (5)|Encoder position Channel 2|
|ENCPOS_CH2_INC (6)|Encoder position Channel 2 in increments|

# 8 Motion profile

MOOG ID No.:CB40859-001 Date:11/2020 MSD ServoDrive - DeviceHelp 276

|ID|Index Name / Setting|Unit|Description|
|---|---|---|---|
|7|ENCPOS_CH3 (7)| |Encoder position Channel 3|
|8|ENCPOS_CH3_INC (8)| |Encoder position Channel 3 in increments|
|9|ENCPOS_CH4 (9)| |Encoder position Channel 4|
|10|ENCPOS_CH4_INC (10)| |Encoder position Channel 4 in increments|
|11|ACTPOS2 (11)| |Actual position of redundant encoder in user units|
|12|Sercos (12)| |Referred to Sercos profile parameters S-x-0426, S-x-0427|
|13|UserRefPos(13)| |Reference position in user units|
|14|MasterPosST(14)| |Master position (ECAM, EGEAR) singleturn, always steps|
|15|CommonMasterPos(15)| |Master position (ECAM, EGEAR) singleturn, always steps|
|16|CommonMasterPosST(15)| |Master position (ECAM, EGEAR) singleturn, always steps|
|1402|MPRO_TP_Channel| | |
|1402|MPRO_TP_Channel| | |
|1402|MPRO_TP_Channel| | |
|1404|MPRO_TP_Lines| |Touch probe: Lines @ pulse counter on channel x|
|1404|MPRO_TP_Lines| | |
|1404|MPRO_TP_Lines| | |

Image 8.71: “Synchronized motion” screen

There are various modes available in the “synchronization mode” drop-down menu (P 242[0] - MPRO_ECAM_SyncModMode):

- Off(0) = Synchronized motion off
- ECAM_iPlc(1) = Electronic cam plate via MSD PLC
- EGEAR_iPlc(2) = Electr. gear unit via MSD PLC
- ECAM_PARA(3) = Electronic camming via parameters
- EGEAR_PARA(4) = Electronic gearing via parameters

NOTE: For more information refer to the bus system User Manuals or the description of the MSD PLC.

# 8.11.1 Electronic cam plate

The other parameters are configured in separate screens that can be accessed with the corresponding buttons.

- Master configuration (see Section ""Master configuration"" on page 280)
- Electronic gearing (see Section ""Electronic gearing"" on page 283)
- Electronic camming (see Section ""Electronic cam plate"" on page 277)

P 1318[0] - MPRO_ECAM_ControlWord is the control word for “synchronized motion” (see Section ""Control word for synchronized motion"" on page 279).

P 1326[0] - MPRO_ECAM_StatusWord is the status word for “synchronized motion” (see Section ""Status word for synchronized motion"" on page 279).

# 8.11.1.1 Table selection

|ID|Index Name|Unit|Description|
|---|---|---|---|
|1300|MPRO_ECAM_CTS_| |ECAM: CamTableSelect - Master reference|
|1301|MasterRef| | |
|1305|MPRO_ECAM_CTS_| |ECAM: CamTableSelect - Method for changing the camtable|
|1306|MPRO_ECAM_CTS_| |ECAM: CamTableSelect - Mode for changing the camtable|
|1307|MPRO_ECAM_CTS_|incr|ECAM: CamTableSelect - Distance for changing the camtable|
|242|MPRO_ECAM_| |ECAM / EGEAR: Mode of synchronized motion SyncModMode|
|265|MPRO_ECAM_| |ECAM / EGEAR: Slave speed factor (1 = 100%).|
|266|CamSlave_SpeedFactor| | |
|268|MPRO_ECAM_| |ECAM / EGEAR: Mode of switching off sync. motion|

# 8.11.1.2 Synchronization

|ID|Index Name|Unit|Description|
|---|---|---|---|
|1342|MPRO_ECAM_CI_|incr|ECAM: CamIn - Synchronization position (multiturn part)|
|1343|MPRO_ECAM_CO_|incr|ECAM: CamOut - Decoupling pos. (multiturn part)|
|1303|MPRO_ECAM_CI_|incr|ECAM: CamIn - Master offset|
|1308|MPRO_ECAM_CI_| |ECAM: CamIn - Master reference|
|1309|MPRO_ECAM_CI_| |ECAM: CamIn - Slave reference|
|1310|MPRO_ECAM_CI_| |ECAM: CamIn - Coupling mode|
|1311|MPRO_ECAM_CI_|incr|ECAM: CamIn - Coupling distance|
|1312|MPRO_ECAM_CI_|incr|ECAM: CamIn - Synchronization position|

Table 8.31: “Electronic camming - Table selection” parameters

Table 8.30: “Synchronized motion” parameters

Table 8.32: “Electronic camming - Synchronization” parameters

MOOG ID No.:CB40859-001 Date:11/2020

MSD ServoDrive - DeviceHelp 277

# 8 Motion profile

MOOG ID No.:CB40859-001 Date:11/2020 MSD ServoDrive - DeviceHelp 278

|ID|Index|Name|Unit|Description|
|---|---|---|---|---|
|1313|0|MPRO_ECAM_CO_SyncPosST|(singleturn part)|ECAM: CamOut - Slave reference|
|1314|0|MPRO_ECAM_CO_DecouplingMode|63|ECAM: CamOut - Decoupling mode|
|1315|0|MPRO_ECAM_CO_BreakingPosST|incr|ECAM: CamOut - Decoupling position|
|1316|0|MPRO_ECAM_CO_DecouplingDist|incr|ECAM: CamOut - Decoupling distance|
|1317|0|MPRO_ECAM_CO_StandstillPos|mDegree|ECAM: CamOut - Slave standstill position|

# Table 8.32: “Electronic camming - Synchronization” parameters (continue)

|ID|Index|Name|Unit|Description|
|---|---|---|---|---|
|1346| |MPRO_ECAM_SP_Table| |ECAM: Setpoint table interface|
|1346|0|Index| |Index of setpoint table|
|1346|1|Value| |Value at index of setpoint table|
|1347|0 to 31|MPRO_ECAM_SP_Index| |ECAM: Setpoint segments start index|
|1348|0 to 31|MPRO_ECAM_SP_Length| |ECAM: Setpoint segments length|
|1349|0 to 31|Length| | |
|1350|0|MPRO_ECAM_SP_MaDist| |ECAM: Setpoint segments master distance|
|1351|0|MPRO_ECAM_SP_IpoType| |ECAM: Setpoint segments interpolation type|
|1352|0 to 31|Checksum| |ECAM: Setpoint table checksum|
|1353|0 to 31|GainNum| |ECAM: Setpoint segments gain numerator|
| | |GainDen| |ECAM: Setpoint segments gain denominator|

# Table 8.33: “Electronic camming - Table segments” parameters

|ID|Index|Name|Unit|Description|
|---|---|---|---|---|
|1329|0 to 63|MPRO_ECAM_SegData_IndexNext| |ECAM: Index of the following segment|
|1330|0 to 63|MPRO_ECAM_SegData_IndexPrev| |ECAM: Index of the previous segment|
|1331|0 to 63|MPRO_ECAM_SegData_ProfileMode| |ECAM: Profile mode of the current segment|
|1332|0 to 63|MPRO_ECAM_SegData_DistMaster| |ECAM: Length of the master section of the current segment|
|1333|0 to 63|MPRO_ECAM_SegData_DistSlave| |ECAM: Length of the slave section of the current segment|
|1334|0 to 63|MPRO_ECAM_SegData_Lambda| |ECAM: Lambda value of the current segment|
|1335|0 to 63|MPRO_ECAM_SegData_StatusWord| |ECAM: Status word of the current segment|
|1336|0 to 63|MPRO_ECAM_SegData_ControlWord| |ECAM: Control word of the current segment|

# 8.11.2 Control word for synchronized motion

|Bit|Function|PLC function|Bit number|Description|
|---|---|---|---|---|
|0-7|Start segment (8-bit value)|-|0-7|Actual segment (8-bit value)|
|8-15|Reserved|-| |Actual ECAM / EGEAR state machine state (4 Bit value)|
|16|Absolute (true) / relative (false) master relationship|-| |- 0: ECAM / EGEAR asynchronous
- 1: ECAM / EGEAR synchronous
|
|17|Absolute (true) / relative (false) master (CAM) relationship at cam in|-| |- 2: ECAM / EGEAR synchronizing
- 3: ECAM / EGEAR desynchronizing
|
|18|Absolute (true) / relative (false) slave (CAM) relationship at cam in|-| |- 4: ECAM / EGEAR active and waiting for going asynchronous
|
|19-23|Reserved|-| |- 5: ECAM / EGEAR inactive and waiting for going synchronous
|
|24|Change gear ratio of the electronic gear online|MCB_GearRatioChange| | |
|25|Disable master calculation|MCB_Cam_MasterEnable| | |
|26|Enable master calculation|MCB_Cam_MasterEnable| | |
|27|Select CAM table|MCB_CamTableSelect| | |
|28|Start Ecam|MCB_CamIn| | |
|29|Stop Ecam|MCB_CamOut| | |
|30|Start Egear|MCB_GearIn| | |
|31|Stop Egear|MCB_GearOut| | |

# 8.11.3 Status word for synchronized motion

|Bit|Function|PLC function|Bit number|Description|
|---|---|---|---|---|
|12-26|Reserved|-| | |
|27|ECAM / EGEAR is active|-| | |
|28|Valid segments chosen|-| | |
|29|Master data are valid|-| | |
|30|Master is initialized|-| | |
|31|Master calculation is active|-| | |

Table 8.35: Control word ECAM (P 1318[0] - MPRO_ECAM_ControlWord)

Table 8.36: ECAM status word (P 1326[0] - MPRO_ECAM_StatusWord)

MOOG ID No.:CB40859-001 Date:11/2020 MSD ServoDrive - DeviceHelp 279

# 8 Motion profile

# 8 Motion profile

MOOG ID No.:CB40859-001 Date:11/2020

MSD ServoDrive - DeviceHelp 280

# 8.11.4 Master configuration

the master encoder, you will need to set the resolution relative to a single motor revolution in P 250 - MPRO_ECAM_PARAMaster_Amplitude (see below).

- ENC CH1 (3) = Encoder channel 1 X7 (Sin/Cos)
- ENC CH2 (4) = Encoder channel 2 X6 (Resolver)
- ENC CH3 (5) = Encoder channel 3 X8 (optional)

This function is only available if an external interface X8 (option module) is present.

- TP0 (6) = Pulse counter on probe channel 0 (TP0)
- TP1 (7) = Pulse counter on probe channel 1 (TP1)
- ENC_CH4 (8) = Encoder channel 4 (p. e. fieldbus)
- TWIN_POS (9) = TWIN remote reference position (P-2607)

Image 8.72: “Master configuration” screen

# Channel selection (master encoder)

P 1319[0] - MPRO_ECAM_CamMaster_AxisType is used to define the master encoder.

- NO AXIS (0) = No axis
- VIRTUAL MASTER (1) = Virtual master

If you select this function, you will be able to configure additional settings by clicking on the enabled “Options...” button (see Section ""Virtual Master"" on page 286).

- PARA (2) = Master parameter interface

If you select this function because a higher-level controller is being used as

# Anti-reverse mode

Slave only starts moving along with it again as soon as the master reaches the zero position.

P 1320[0] - MPRO_ECAM_CamMaster_RevLockMode is used to define the reverse lock mode, which can be used either with or without path compensation. The dashed lines in the following diagrams indicate what the engagement distance is:

# Example:

If the master, which has moved two motor revolutions in the direction blocked for the slave, then moves in the unblocked direction again, the slave only moves off when the master has traversed the zero point.

- INACTIVE (0) = Reverse lock inactive
- ACTIVE (2) = Reverse lock enabled - without path optimization
- ACTIVE WAY COMP (1) = Reverse lock active - with way compensation

While the slave accelerates to the speed of the master during engagement, the master and slave do not move synchronously. This function needs to be selected in order to quickly catch up to the master that is running ahead.

# Example:

- Master (black line) rotates in the blocked direction
- The slave (blue line) remains stopped
- Master rotates in the unblocked direction again
- The slave follows the master directly in the unblocked direction

Assume the master has moved two motor revolutions in the direction for which the slave lock is enabled. If the master now moves in the direction for which there is no lock, the slave will immediately start running in that direction.

MOOG ID No.:CB40859-001 Date:11/2020

MSD ServoDrive - DeviceHelp 281

# 8 Motion profile

MOOG ID No.:CB40859-001 Date:11/2020 MSD ServoDrive - DeviceHelp 282

|Filter type|ID|Index Name|Unit|Description|
|---|---|---|---|---|
|When using a real master encoder, encoder signals may be subject to noise.|P 1340|1319|0|MPRO_ECAM_CamMaster_AxisType|
| | |MPRO_ECAM_CamMaster_SpeedFilTyp| |ECAM / EGEAR: Channel selection of internal master input|
| | |1320|0|MPRO_ECAM_CamMaster_RevLockMode|
| | |1321|0|MPRO_ECAM_CamMaster_Amplitude|
| | |1322|0|MPRO_ECAM_CamMaster_GearNum|
| | |1323|0|MPRO_ECAM_CamMaster_GearDen|
|Filter time|1327|0|ms|ECAM / EGEAR: Filter time constant of master|
|If P 1340[0] is used to enable a filter, P 1327[0] - MPRO_ECAM_CamMaster_SpeedTFil can be used to define the corresponding filter time.|1328|0|speed|ECAM / EGEAR: Speed factor of the internal master|
|Speed factor|1340|0| |MPRO_ECAM_CamMaster_SpeedFilTyp|
|The master encoder can be assigned an additional speed factor P 1328[0] - MPRO_ECAM_CamMaster_SpeedFactor.|1341|0|incr|ECAM / EGEAR: Master drive offset|

Table 8.37: “Synchronized motion - Master configuration” parameters (continue)

| | | |ID|Index Name|Unit|Description|
|---|---|---|---|---|---|---|
|247|0|MPRO_ECAM_ParaMaster_ActPos|incr|ECAM / EGEAR: Parameter interface master position| | |
|248|0|MPRO_ECAM_ParaMaster_ActSpeed|rpm|ECAM / EGEAR: Parameter interface master speed| | |
|249|0|MPRO_ECAM_ParaMaster_ActAcc|rpm|ECAM / EGEAR: Parameter interface master acceleration| | |
| |250|0|MPRO_ECAM_ParaMaster_Amplitude| |ECAM / EGEAR: Parameter interface master amplitude| |

Table 8.37: “Synchronized motion - Master configuration” parameters

# 8.11.5 Electronic gearing

# Gear ratio

The gear ratio is specified as a fraction. This ensures that the position references can be translated to the motor shaft with no rounding error.

- ""Slave"" (P 252[0] - MPRO_ECAM_Egear_GearNum) is the numerator
- ""Master"" (P 251[0] - MPRO_ECAM_Egear_GearDen) is the denominator

# Scaling of speed pre-control

Defined with P 265[0] - MPRO_ECAM_CamSlave_SpeedFactor definiert.

# Scaling of torque pre-control

Defined with P 266[0] - MPRO_ECAM_CamSlave_TorqueFactor.

# Engagement

See Section ""Engagement"" on page 284.

# Disengagement

See Section ""Disengagement"" on page 285.

|ID|Index Name|Unit|Description|
|---|---|---|---|
|251|0 MPRO_ECAM_Egear_GearDen| |EGEAR: Gear denominator|
|252|0 MPRO_ECAM_Egear_GearNum| |EGEAR: Numerator of gear ratio|
|1344|0 MPRO_ECAM_Egear_LimRefAcc|rpm/s|EGEAR: Acceleration limit for reference|
|1345|0 MPRO_ECAM_Egear_LimRefJerk|rpm/s²|EGEAR: Jerk limit for reference|

Table 8.38: “Synchronized motion - Electronic gearing” parameters

Image 8.73: ""Electronic gearing"" screen

MOOG ID No.:CB40859-001 Date:11/2020 MSD ServoDrive - DeviceHelp 283

# 8 Motion profile

# 8 Motion profile

MOOG ID No.:CB40859-001 Date:11/2020

MSD ServoDrive - DeviceHelp 284

# 8.11.6 Engagement

used to define the engagement distance (between the dashed lines).

P 253[0] - MPRO_ECAM_Egear_GearInMode is used to define the mode for engagement.

- DIRECT (0) = Direct
- Direct engagement: Angular synchronous; with jerking (no ramps).
- CROSSFADE (3) = Crossfading
- Engagement with crossfading function (5th degree polynomial): Angular synchronous; jerk-limited; speed will overshoot during engagement.
- RAMP (1) = Linear speed ramp
- Engagement with linear acceleration: Not angular synchronous; with jerking.
- FADE (2) = Engagement fade-out
- Engagement with fade-in function (5th degree polynomial): Not angular synchronous; jerk-limited. The position is ignored. ",How is wire break monitoring configured for the analog inputs in the 'MSD ServoDrive - DeviceHelp' document?,A5,The document specifies P 399 for setting up wire break monitoring in analog inputs.,1.2421875,1.1484375,3.25,1.1875,0.353515625
20,msd_servo_drive.txt,76,b87ca5e232c2bdbb6fa16a8a401c6b5d285dc0183e73cc9d134de13dd2fc71d2,"MOOG ID No.:CB40859-001 Date:11/2020

MSD ServoDrive - DeviceHelp 267

# 8 Motion profile

MOOG ID No.:CB40859-001 Date:11/2020 MSD ServoDrive - DeviceHelp 268

# Deceleration

With ...

- P 194 - MPRO_TAB_TDec (for torque control) or
- P 197 - MPRO_TAB_SDec (for speed control) or
- P 200 - MPRO_TAB_PDec (for position control)

and indexes 0–15, the deceleration for each individual motion task can be defined. The input must not be zero.

# Wait time in Auto mode

P 204 - MPRO_TAB_WaitTime is used to define the wait time before the next motion task is carried out.

# Maximum table index in Auto mode

P 206[0] - MPRO_Tab_MaxIdx is used to define the table index up to which driving jobs will be carried out in one of the auto modes.

# Current table index

P 207[0] - MPRO_Tab_ActIdx will show the index for the motion task that is currently active. If parameter P 205 MPRO_TAB_Mode is set to “Para(0)”, a driving set can be entered and approached directly.

# Activation of reference table

The following procedures can be used in order to activate the setpoint table for operation.

|ID|Index Name|Unit|Description|
|---|---|---|---|
|193|MPRO_TAB_TAcc|TAB: Torque mode acceleration|Nm/ms|
|193|0|MPRO_TAB_TAcc|Nm/ms|
|193|1 - 15|MPRO_TAB_TAcc|Nm/ms|
|194|MPRO_TAB_TDec|TAB: Torque mode deceleration| |
|194|0|MPRO_TAB_TDec|Nm/ms|
|194|1 - 15|MPRO_TAB_TDec|Nm/ms|

# Table 8.23: Activation of table references

# Table 8.24: “Setpoint table settings” parameters

# Table 8.24: “Setpoint table settings” parameters (continue)

|ID|Index Name|Unit|Description|ID|Index Name|Unit|Description|
|---|---|---|---|---|---|---|---|
|195|MPRO_TAB_TRef|Nm|TAB: Torque mode reference value|208|MPRO_TAB_OutputNo| |OSD TAB: actual table index and target|
|195|MPRO_TAB_TRef|Nm| |208|MPRO_TAB_OutputNo| | |
|196|MPRO_TAB_SAcc|rev/min/s|TAB: Speed mode acceleration|269|MPRO_TAB_Ctrl| |TAB: control word|
|196|MPRO_TAB_SAcc|rev/min/s| | | | | |
|197|MPRO_TAB_SDec|rev/min/s|TAB: Speed mode deceleration| | | | |
|197|MPRO_TAB_SDec|rev/min/s| | | | | |
|198|MPRO_TAB_SRef|rev/min|TAB: Speed mode reference value| | | | |
|198|MPRO_TAB_SRef|rev/min| | | | | |
|199|MPRO_TAB_PAcc|rev/min/s|TAB: Position control mode acceleration| | | | |
|199|MPRO_TAB_PAcc|rev/min/s| | | | | |
|200|MPRO_TAB_PDec|rev/min/s|TAB: Position control mode Acceleration| | | | |
|200|MPRO_TAB_PDec|rev/min/s| | | | | |
|201|MPRO_TAB_PSpd|rev/min|TAB: Position control mode speed| | | | |
|201|MPRO_TAB_PSpd|rev/min| | | | | |
|202|MPRO_TAB_PPos|mDegree|TAB: Position control mode reference value| | | | |
|202|MPRO_TAB_PPos|mDegree| | | | | |
|203|MPRO_TAB_PMode| |Position control table:Mode| | | | |
|203|MPRO_TAB_PMode| | | | | | |
|204|MPRO_TAB_WaitTime|ms|TAB: Wait time| | | | |
|204|MPRO_TAB_WaitTime|ms| | | | | |
|205|MPRO_TAB_Mode| |TAB mode| | | | |
|206|MPRO_Tab_MaxIdx| |TAB: Max index in AUTO mode| | | | |
|207|MPRO_TAB_ActIdx| |TAB: Actual index| | | | |

MOOG ID No.:CB40859-001 Date:11/2020

MSD ServoDrive - DeviceHelp

# 8 Motion profile

MOOG ID No.:CB40859-001 Date:11/2020

MSD ServoDrive - DeviceHelp 270

# 8.8 Analog channel (ISA00 und ISA01)

# Offset (O)

This parameter (P 174 - MPRO_ANA0_SOffset for ISA00, P 184 - MPRO_ANA1_SOffset for ISA01) compensates for component variations and is used for offset compensation purposes. Depending on the control mode being used (see Section ""Basic settings"" on page 110), the value will be stored in parameter index [0] (torque control), [1] (speed control) or [2] (position control).

# Backlash (B)

This parameter (P 175 - MPRO_ANA0_SThreshold for ISA00, P 185 - MPRO_ANA1_SThreshold for ISA01) can suppress axis motion close to the standstill (stop) position. Depending on the control mode being used (see Section ""Basic settings"" on page 110), the value will be stored in parameter index [0] (torque control), [1] (speed control) or [2] (position control).

Image 8.68: “Analog channel” screen

# Acceleration ramp

Two standard analog inputs (ISA00, ISA01) are available. These inputs can be configured...

- with negative values for analog setpoint settings
- with positive values for digital setpoint processing

(P 109[0] - MPRO_INPUT_FS_ISA00 and P 110[0] - MPRO_INPUT_FS_ISA01).

see also section ""Analog Inputs"" on page 303. By using the ""REV(-2) = Analog setpoint"" setting, an analog input voltage of ±10 V can be processed as a setpoint.

# Deceleration ramp

This parameter serves as a deceleration ramp for torque control (P 176[1] - MPRO_ANA0_TRamp for ISA00, P 186[1] - MPRO_ANA1_TRamp for ISA01) or speed control (P 177[1] - MPRO_ANA0_SRamp for ISA00, P 187[1] - MPRO_ANA1_SRamp for ISA01). Depending on the control mode being used (see Section ""Basic settings"" on page 110), the value will be stored in parameter index [0] (torque control), [1] (speed control) or [2] (position control).

This parameter (P 173 - MPRO_ANA0_Scale for ISA00, P 183 - MPRO_ANA1_Scale for ISA01) is used to define which speed / which torque / which position corresponds to the maximum analog value. Depending on the control mode being used (see Section ""Basic settings"" on page 110), the value will be stored in parameter index [0] (torque control), [1] (speed control) or [2] (position control).

# 8.8.1 Special characteristics of position control mode

A threshold value can also be specified which generates a run-on range around the last reference value. A ramp function calculates a motion profile for the position reference from pre-defined acceleration and speed limits.

The position references on the analog channel are not applied immediately, but dependent on a digital input. Accordingly, one of the ISD00 to ISD06 digital inputs must be set to a value of ""REFANAEN(28) = Enable analog reference value"" (see Section ""Digital inputs"" on page 290). The position setpoint being received will only be applied if the corresponding digital input is active. The acceleration is entered using P 173[0] - MPRO_ANA0_TScale or P 183[0] - MPRO_ANA1_TScale.

# 8.8.2 Wire Break Monitoring

P 399 - CON_ANAWireBrk_Th can be used to configure wire break monitoring for the analog inputs. For details see Section ""Wire Break Monitoring"" on page 306.

|Function|TLIM (-4)|OVR (-3)|REFV (-2)|leer (-1)|OFF (0)|
|---|---|---|---|---|---|
|Digital|(1)-(28)|(1)-(28)|(1)-(28)|(1)-(28)|(1)-(28)|
|Analog channel|Filter|Scale|Offset|Profile|generator|

Control

Image 8.69: Reference processing structure

MOOG ID No.:CB40859-001 Date:11/2020

MSD ServoDrive - DeviceHelp 271

# 8 Motion profile

# 8 Motion profile

MOOG ID No.:CB40859-001 Date:11/2020

|ID|Index Name|Unit|Description|ID|
|---|---|---|---|---|
|395|CON_ANA_Isaf_Scaled| |Analog inputs: Values (filt, norm, comp, scaled)|174|
|395|0 ISA00| |Scaled, compensated, filtered, normalized value|175|
|395|1 ISA01| |Scaled, compensated, filtered, normalized value| |
|396|CON_ANA_Scale_ThUpper| |Analog inputs: Upper scaling limits|175|
|396|0 ISA00|%|Upper scaling (@ 10 V) threshold|175|
|396|1 ISA01|%|Upper scaling (@ 10 V) threshold| |
|397|CON_ANA_Scale_ThZero| |Analog inputs: Zero scaling thresholds|176|
|397|0 ISA00|V|Zero scaling threshold (+/-)|176|
|397|1 ISA01|V|Zero scaling threshold (+/-)| |
|398|CON_ANA_Scale_ThLower| |Analog inputs: Lower scaling limits|177|
|398|0 ISA00|%|Lower scaling (@ zero threshold) threshold|177|
|398|1 ISA01|%|Lower scaling (@ zero threshold) threshold| |
|399|CON_ANA_WireBrk_Th| |Analog inputs: Wire break thresholds|Table 8.26:|
|399|0 ISA00|V|Wire break detection threshold| |
|399|1 ISA01|V|Wire break detection threshold| |
|405|0 CON_ANA_Filt0|ms|Analog input ISA00: Filter time constant (PT 1)|ID|
|408|CON_ANA_Isaf_Norm| |Analog inputs: Values (filt, norm)|183|
|408|0 ISA00| |Filtered, normalized value|183|
|408|1 ISA01| |Filtered, normalized value|183|

Table 8.25: “Analog channel” parameters

|ID|Index Name|Unit|Description|ID|
|---|---|---|---|---|
|173|MPRO_ANA0_Scale| |ANA0: scale factors|184|
|173|0 MPRO_ANA0_TScale|Nm|ANA0: scale factor torque reference|185|
|173|1 MPRO_ANA0_SScale|rev/min|ANA0: scale factor speed reference|185|
|173|2 MPRO_ANA0_PScale|mDegree|ANA0: scale factor position reference| |
|174|MPRO_ANA0_Offset| |ANA0: offsets|185|
|174|0 MPRO_ANA0_TOffset|Nm|ANA0: offsets for torque reference|185|

Table 8.26: “Analog channel ISA00” parameters

|Index Name|Unit|Description|
|---|---|---|
|1 MPRO_ANA0_SOffset|rev/min|ANA0: offsets for speed reference|
|2 MPRO_ANA0_POffset|mDegree|ANA0: offsets for position reference|
|MPRO_ANA0_Threshold| |ANA0: thresholds|
|0 MPRO_ANA0_TThreshold|Nm|ANA0: threshold for torque reference|
|1 MPRO_ANA0_SThreshold|rev/min|ANA0: threshold for speed reference|
|2 MPRO_ANA0_PThreshold|mDegree|ANA0: threshold for position reference|
|MPRO_ANA0_TRamp| |ANA0: Torque mode acceleration [0] and deceleration [1]|
|0 MPRO_ANA0_TRamp|Nm/s| |
|1 MPRO_ANA0_TRamp|Nm/s| |
|MPRO_ANA0_SRamp| |ANA0: Speed mode acceleration [0] and deceleration [1]|
|0 MPRO_ANA0_SRamp|SPEED/s| |
|1 MPRO_ANA0_SRamp|SPEED/s| |

“Analog channel ISA00” parameters (continue)

|Index Name|Unit|Description|
|---|---|---|
|MPRO_ANA1_Scale| |ANA1: scale factors|
|0 MPRO_ANA1_TScale|Nm|ANA0: scale factor torque reference|
|1 MPRO_ANA1_SScale|rev/min|ANA0: scale factor speed reference|
|2 MPRO_ANA1_PScale|mDegree|ANA0: scale factor position reference|
|MPRO_ANA1_Offset| |ANA1: offsets|
|0 MPRO_ANA1_TOffset|Nm|ANA1: offsets for torque reference|
|1 MPRO_ANA1_SOffset|rev/min|ANA1: offsets for speed reference|
|2 MPRO_ANA1_POffset|mDegree|ANA1: offsets for position reference|
|MPRO_ANA1_Threshold| |ANA1: thresholds|
|0 MPRO_ANA1_TThreshold|Nm|ANA1: threshold for torque reference|
|1 MPRO_ANA1_SThreshold|rev/min|ANA1: threshold for speed reference|
|2 MPRO_ANA1_PThreshold|mDegree|ANA1: threshold for position reference|

“Analog channel ISA01” parameters

# 8 Motion profile

|ID|Index Name|Unit|Description|
|---|---|---|---|
|186|MPRO_ANA1_TRamp|Nm/s|ANA1: Torque mode acceleration [0] and deceleration[1]|
|186|MPRO_ANA1_TRamp|Nm/s| |
|187|MPRO_ANA1_SRamp|SPEED/s|ANA1: Speed mode acceleration [0] and deceleration [1]|
|187|MPRO_ANA1_SRamp|SPEED/s| |

# Table 8.27: “Analog channel ISA01” parameters (continue)

Display

- System state
- Initialization on device startup
- Not ready (DC link voltage possibly too low)
- Start inhibit (DC link voltage present, power stage off)
- Starting lockout
- Ready for start
- Control initialization: Auto commutation, flux build-up etc.

# Table 8.28: Central state machine according to CiA 402 device display

MOOG ID No.:CB40859-001 Date:11/2020

MSD ServoDrive - DeviceHelp 273

# 8 Motion profile

MOOG ID No.:CB40859-001 Date:11/2020

MSD ServoDrive - DeviceHelp 274

|Display|System state|power disabled|fault|
|---|---|---|---|
|Control enabled|0|Start|7|
| |fault reaction active|0|14|
|Quick stop active|1|not ready|8|
| |to switch on|1|17|
|Error reaction active|2|switch on|disabled|
| |2|7| |
|Error state (in this state the error is indicated directly on the display.)|3|ready to|switch on|
|Device is reset (display flashes)|power enabled|3|6|
| |10|12| |
|• Number [5.] flashes when “STO” (Safe Torque Off) input is active. Display goes out when STO inactive.| | | |
|• The dot on the display flashes when the power stage is active.| | | |

Table 8.28: Central state machine according to CiA 402 device display (continue)

NOTE

l The system states indicated on the display may differ from the states in the table depending on the drive profile setting.

Image 8.70: State machine diagram based on CANopen communications

⓪ to ① State number

1 to 17 State transition (No. 17: DC link voltage cut off)

Legend for “State machine diagram based on CANopen communications” figure

# 8.10 Touch probe

|ID|Index Name / Setting|
|---|---|
|241|0 MPRO_TP_Position|
|241|1 MPRO_TP_Position|
|241|2 MPRO_TP_Position|
|241|3 MPRO_TP_Position|
|241|4 MPRO_TP_Position|
|1400|0 MPRO_TP_Config|
| |TP_TP (0)|
| |AB (1)|
| |PD_UP (2)|
| |PD_DOWN (3)|
| |PC_PC (4)|
| |PC_TP (5)|
| |TP_PC (6)|
| |ENC_ENC (7)|
| |ENC_TP (8)|
| |TP_ENC (9)|

Using the touch probe inputs, touch probe functions can be performed. In order to be able to do this, P 106[0] - MPRO_INPUT_FS_ISD05 and P 107[0] - MPRO_INPUT_FS_ISD06 must be used to set digital inputs ISD05 and ISD06 to ""PROBE(15) = Touch probe (only ISD05/06)"" (see Section ""Digital inputs"" on page 290). HTL encoders can be evaluated or pulse counters implemented using the MSD PLC.

The touch probe can be triggered with P 240 - MPRO_TP_Ctrl. This enables triggering on a positive or negative edge, or on both edges, of the signal detected on the touch probe inputs. After the measurement, the parameter jumps back to the value ""NONE (0)"" and the latch position is mapped in the corresponding subindex of parameter P 241 - MPRO_TP_Position. A continuous touch probe mode is not possible at present, so the touch probe has to be reactivated after the measurement.

P 1402 - MPRO_TP_Channel can be used to select various positions as actual value sources of the latch position for the touch probe functionality. The following table provides an overview of the available settings. The counters are accessed via the MSD PLC or a bus system.

|ID|Index Name / Setting|Unit|Description|
|---|---|---|---|
|240|MPRO_TP_Ctrl|Touch probe: Control| |
| |0| |NONE (0) = No function|
| |1| |POS (1) = Positive edge|
| |2| |NEG (2) = Negative edge|
| |3| |BOTH (3) = Both edges|
|240|0 MPRO_TP_Ctrl| | |
|240|1 MPRO_TP_Ctrl| | |
|240|2 MPRO_TP_Ctrl| | |
|241|MPRO_TP_Position|Probe: Pos. high/low edge of TP0/1, encoder zero pulse| |

Table 8.29: “Touch probe” parameters

MOOG ID No.:CB40859-001 Date:11/2020

# 8 Motion profile

|Unit|Description|
|---|---|
|mDegree|Touch probe: Configuration|
|mDegree|TP0, TP1 touch probe|
|mDegree|TP0, TP1 as encoder, A/B as quadrature counting|
|mDegree|TP0, TP1 as encoder, pulse (TP0) / direction (TP1), count up on direction high|
|mDegree|TP0, TP1 as encoder, pulse (TP0) / direction (TP1), count down on direction high|
|mDegree|TP0 pulse counter, TP1 pulse counter|
|mDegree|TP0 pulse counter, TP1 touch probe|
|mDegree|TP1 touch probe, TP0 pulse counter|
|mDegree|TP0 encoder counter, TP1 encoder counter|
|mDegree|TP0 encoder counter, TP1 touch probe|
|mDegree|TP0 touch probe, TP1 encoder counter|

Touch probe: Channel

|Unit|Description|
|---|---|
|ACTPOS (0)|Actual position in user units|
|ACTPOSINC (1)|Actual position in increments|
|MASTERPOS (2)|Master position in increments|
|ENCPOS_CH1 (3)|Encoder position Channel 1|
|ENCPOS_CH1_INC (4)|Encoder position Channel 1 in increments|
|ENCPOS_CH2 (5)|Encoder position Channel 2|
|ENCPOS_CH2_INC (6)|Encoder position Channel 2 in increments|

# 8 Motion profile

MOOG ID No.:CB40859-001 Date:11/2020 MSD ServoDrive - DeviceHelp 276

|ID|Index Name / Setting|Unit|Description|
|---|---|---|---|
|7|ENCPOS_CH3 (7)| |Encoder position Channel 3|
|8|ENCPOS_CH3_INC (8)| |Encoder position Channel 3 in increments|
|9|ENCPOS_CH4 (9)| |Encoder position Channel 4|
|10|ENCPOS_CH4_INC (10)| |Encoder position Channel 4 in increments|
|11|ACTPOS2 (11)| |Actual position of redundant encoder in user units|
|12|Sercos (12)| |Referred to Sercos profile parameters S-x-0426, S-x-0427|
|13|UserRefPos(13)| |Reference position in user units|
|14|MasterPosST(14)| |Master position (ECAM, EGEAR) singleturn, always steps|
|15|CommonMasterPos(15)| |Master position (ECAM, EGEAR) singleturn, always steps|
|16|CommonMasterPosST(15)| |Master position (ECAM, EGEAR) singleturn, always steps|
|1402|MPRO_TP_Channel| | |
|1402|MPRO_TP_Channel| | |
|1402|MPRO_TP_Channel| | |
|1404|MPRO_TP_Lines| |Touch probe: Lines @ pulse counter on channel x|
|1404|MPRO_TP_Lines| | |
|1404|MPRO_TP_Lines| | |

Image 8.71: “Synchronized motion” screen

There are various modes available in the “synchronization mode” drop-down menu (P 242[0] - MPRO_ECAM_SyncModMode):

- Off(0) = Synchronized motion off
- ECAM_iPlc(1) = Electronic cam plate via MSD PLC
- EGEAR_iPlc(2) = Electr. gear unit via MSD PLC
- ECAM_PARA(3) = Electronic camming via parameters
- EGEAR_PARA(4) = Electronic gearing via parameters

NOTE: For more information refer to the bus system User Manuals or the description of the MSD PLC.

# 8.11.1 Electronic cam plate

The other parameters are configured in separate screens that can be accessed with the corresponding buttons.

- Master configuration (see Section ""Master configuration"" on page 280)
- Electronic gearing (see Section ""Electronic gearing"" on page 283)
- Electronic camming (see Section ""Electronic cam plate"" on page 277)

P 1318[0] - MPRO_ECAM_ControlWord is the control word for “synchronized motion” (see Section ""Control word for synchronized motion"" on page 279).

P 1326[0] - MPRO_ECAM_StatusWord is the status word for “synchronized motion” (see Section ""Status word for synchronized motion"" on page 279).

# 8.11.1.1 Table selection

|ID|Index Name|Unit|Description|
|---|---|---|---|
|1300|MPRO_ECAM_CTS_| |ECAM: CamTableSelect - Master reference|
|1301|MasterRef| | |
|1305|MPRO_ECAM_CTS_| |ECAM: CamTableSelect - Method for changing the camtable|
|1306|MPRO_ECAM_CTS_| |ECAM: CamTableSelect - Mode for changing the camtable|
|1307|MPRO_ECAM_CTS_|incr|ECAM: CamTableSelect - Distance for changing the camtable|
|242|MPRO_ECAM_| |ECAM / EGEAR: Mode of synchronized motion SyncModMode|
|265|MPRO_ECAM_| |ECAM / EGEAR: Slave speed factor (1 = 100%).|
|266|CamSlave_SpeedFactor| | |
|268|MPRO_ECAM_| |ECAM / EGEAR: Mode of switching off sync. motion|

# 8.11.1.2 Synchronization

|ID|Index Name|Unit|Description|
|---|---|---|---|
|1342|MPRO_ECAM_CI_|incr|ECAM: CamIn - Synchronization position (multiturn part)|
|1343|MPRO_ECAM_CO_|incr|ECAM: CamOut - Decoupling pos. (multiturn part)|
|1303|MPRO_ECAM_CI_|incr|ECAM: CamIn - Master offset|
|1308|MPRO_ECAM_CI_| |ECAM: CamIn - Master reference|
|1309|MPRO_ECAM_CI_| |ECAM: CamIn - Slave reference|
|1310|MPRO_ECAM_CI_| |ECAM: CamIn - Coupling mode|
|1311|MPRO_ECAM_CI_|incr|ECAM: CamIn - Coupling distance|
|1312|MPRO_ECAM_CI_|incr|ECAM: CamIn - Synchronization position|

Table 8.31: “Electronic camming - Table selection” parameters

Table 8.30: “Synchronized motion” parameters

Table 8.32: “Electronic camming - Synchronization” parameters

MOOG ID No.:CB40859-001 Date:11/2020

MSD ServoDrive - DeviceHelp 277

# 8 Motion profile

MOOG ID No.:CB40859-001 Date:11/2020 MSD ServoDrive - DeviceHelp 278

|ID|Index|Name|Unit|Description|
|---|---|---|---|---|
|1313|0|MPRO_ECAM_CO_SyncPosST|(singleturn part)|ECAM: CamOut - Slave reference|
|1314|0|MPRO_ECAM_CO_DecouplingMode|63|ECAM: CamOut - Decoupling mode|
|1315|0|MPRO_ECAM_CO_BreakingPosST|incr|ECAM: CamOut - Decoupling position|
|1316|0|MPRO_ECAM_CO_DecouplingDist|incr|ECAM: CamOut - Decoupling distance|
|1317|0|MPRO_ECAM_CO_StandstillPos|mDegree|ECAM: CamOut - Slave standstill position|

# Table 8.32: “Electronic camming - Synchronization” parameters (continue)

|ID|Index|Name|Unit|Description|
|---|---|---|---|---|
|1346| |MPRO_ECAM_SP_Table| |ECAM: Setpoint table interface|
|1346|0|Index| |Index of setpoint table|
|1346|1|Value| |Value at index of setpoint table|
|1347|0 to 31|MPRO_ECAM_SP_Index| |ECAM: Setpoint segments start index|
|1348|0 to 31|MPRO_ECAM_SP_Length| |ECAM: Setpoint segments length|
|1349|0 to 31|Length| | |
|1350|0|MPRO_ECAM_SP_MaDist| |ECAM: Setpoint segments master distance|
|1351|0|MPRO_ECAM_SP_IpoType| |ECAM: Setpoint segments interpolation type|
|1352|0 to 31|Checksum| |ECAM: Setpoint table checksum|
|1353|0 to 31|GainNum| |ECAM: Setpoint segments gain numerator|
| | |GainDen| |ECAM: Setpoint segments gain denominator|

# Table 8.33: “Electronic camming - Table segments” parameters

|ID|Index|Name|Unit|Description|
|---|---|---|---|---|
|1329|0 to 63|MPRO_ECAM_SegData_IndexNext| |ECAM: Index of the following segment|
|1330|0 to 63|MPRO_ECAM_SegData_IndexPrev| |ECAM: Index of the previous segment|
|1331|0 to 63|MPRO_ECAM_SegData_ProfileMode| |ECAM: Profile mode of the current segment|
|1332|0 to 63|MPRO_ECAM_SegData_DistMaster| |ECAM: Length of the master section of the current segment|
|1333|0 to 63|MPRO_ECAM_SegData_DistSlave| |ECAM: Length of the slave section of the current segment|
|1334|0 to 63|MPRO_ECAM_SegData_Lambda| |ECAM: Lambda value of the current segment|
|1335|0 to 63|MPRO_ECAM_SegData_StatusWord| |ECAM: Status word of the current segment|
|1336|0 to 63|MPRO_ECAM_SegData_ControlWord| |ECAM: Control word of the current segment|

# 8.11.2 Control word for synchronized motion

|Bit|Function|PLC function|Bit number|Description|
|---|---|---|---|---|
|0-7|Start segment (8-bit value)|-|0-7|Actual segment (8-bit value)|
|8-15|Reserved|-| |Actual ECAM / EGEAR state machine state (4 Bit value)|
|16|Absolute (true) / relative (false) master relationship|-| |- 0: ECAM / EGEAR asynchronous
- 1: ECAM / EGEAR synchronous
|
|17|Absolute (true) / relative (false) master (CAM) relationship at cam in|-| |- 2: ECAM / EGEAR synchronizing
- 3: ECAM / EGEAR desynchronizing
|
|18|Absolute (true) / relative (false) slave (CAM) relationship at cam in|-| |- 4: ECAM / EGEAR active and waiting for going asynchronous
|
|19-23|Reserved|-| |- 5: ECAM / EGEAR inactive and waiting for going synchronous
|
|24|Change gear ratio of the electronic gear online|MCB_GearRatioChange| | |
|25|Disable master calculation|MCB_Cam_MasterEnable| | |
|26|Enable master calculation|MCB_Cam_MasterEnable| | |
|27|Select CAM table|MCB_CamTableSelect| | |
|28|Start Ecam|MCB_CamIn| | |
|29|Stop Ecam|MCB_CamOut| | |
|30|Start Egear|MCB_GearIn| | |
|31|Stop Egear|MCB_GearOut| | |

# 8.11.3 Status word for synchronized motion

|Bit|Function|PLC function|Bit number|Description|
|---|---|---|---|---|
|12-26|Reserved|-| | |
|27|ECAM / EGEAR is active|-| | |
|28|Valid segments chosen|-| | |
|29|Master data are valid|-| | |
|30|Master is initialized|-| | |
|31|Master calculation is active|-| | |

Table 8.35: Control word ECAM (P 1318[0] - MPRO_ECAM_ControlWord)

Table 8.36: ECAM status word (P 1326[0] - MPRO_ECAM_StatusWord)

MOOG ID No.:CB40859-001 Date:11/2020 MSD ServoDrive - DeviceHelp 279

# 8 Motion profile

# 8 Motion profile

MOOG ID No.:CB40859-001 Date:11/2020

MSD ServoDrive - DeviceHelp 280

# 8.11.4 Master configuration

the master encoder, you will need to set the resolution relative to a single motor revolution in P 250 - MPRO_ECAM_PARAMaster_Amplitude (see below).

- ENC CH1 (3) = Encoder channel 1 X7 (Sin/Cos)
- ENC CH2 (4) = Encoder channel 2 X6 (Resolver)
- ENC CH3 (5) = Encoder channel 3 X8 (optional)

This function is only available if an external interface X8 (option module) is present.

- TP0 (6) = Pulse counter on probe channel 0 (TP0)
- TP1 (7) = Pulse counter on probe channel 1 (TP1)
- ENC_CH4 (8) = Encoder channel 4 (p. e. fieldbus)
- TWIN_POS (9) = TWIN remote reference position (P-2607)

Image 8.72: “Master configuration” screen

# Channel selection (master encoder)

P 1319[0] - MPRO_ECAM_CamMaster_AxisType is used to define the master encoder.

- NO AXIS (0) = No axis
- VIRTUAL MASTER (1) = Virtual master

If you select this function, you will be able to configure additional settings by clicking on the enabled “Options...” button (see Section ""Virtual Master"" on page 286).

- PARA (2) = Master parameter interface

If you select this function because a higher-level controller is being used as

# Anti-reverse mode

Slave only starts moving along with it again as soon as the master reaches the zero position.

P 1320[0] - MPRO_ECAM_CamMaster_RevLockMode is used to define the reverse lock mode, which can be used either with or without path compensation. The dashed lines in the following diagrams indicate what the engagement distance is:

# Example:

If the master, which has moved two motor revolutions in the direction blocked for the slave, then moves in the unblocked direction again, the slave only moves off when the master has traversed the zero point.

- INACTIVE (0) = Reverse lock inactive
- ACTIVE (2) = Reverse lock enabled - without path optimization
- ACTIVE WAY COMP (1) = Reverse lock active - with way compensation

While the slave accelerates to the speed of the master during engagement, the master and slave do not move synchronously. This function needs to be selected in order to quickly catch up to the master that is running ahead.

# Example:

- Master (black line) rotates in the blocked direction
- The slave (blue line) remains stopped
- Master rotates in the unblocked direction again
- The slave follows the master directly in the unblocked direction

Assume the master has moved two motor revolutions in the direction for which the slave lock is enabled. If the master now moves in the direction for which there is no lock, the slave will immediately start running in that direction.

MOOG ID No.:CB40859-001 Date:11/2020

MSD ServoDrive - DeviceHelp 281

# 8 Motion profile

MOOG ID No.:CB40859-001 Date:11/2020 MSD ServoDrive - DeviceHelp 282

|Filter type|ID|Index Name|Unit|Description|
|---|---|---|---|---|
|When using a real master encoder, encoder signals may be subject to noise.|P 1340|1319|0|MPRO_ECAM_CamMaster_AxisType|
| | |MPRO_ECAM_CamMaster_SpeedFilTyp| |ECAM / EGEAR: Channel selection of internal master input|
| | |1320|0|MPRO_ECAM_CamMaster_RevLockMode|
| | |1321|0|MPRO_ECAM_CamMaster_Amplitude|
| | |1322|0|MPRO_ECAM_CamMaster_GearNum|
| | |1323|0|MPRO_ECAM_CamMaster_GearDen|
|Filter time|1327|0|ms|ECAM / EGEAR: Filter time constant of master|
|If P 1340[0] is used to enable a filter, P 1327[0] - MPRO_ECAM_CamMaster_SpeedTFil can be used to define the corresponding filter time.|1328|0|speed|ECAM / EGEAR: Speed factor of the internal master|
|Speed factor|1340|0| |MPRO_ECAM_CamMaster_SpeedFilTyp|
|The master encoder can be assigned an additional speed factor P 1328[0] - MPRO_ECAM_CamMaster_SpeedFactor.|1341|0|incr|ECAM / EGEAR: Master drive offset|

Table 8.37: “Synchronized motion - Master configuration” parameters (continue)

| | | |ID|Index Name|Unit|Description|
|---|---|---|---|---|---|---|
|247|0|MPRO_ECAM_ParaMaster_ActPos|incr|ECAM / EGEAR: Parameter interface master position| | |
|248|0|MPRO_ECAM_ParaMaster_ActSpeed|rpm|ECAM / EGEAR: Parameter interface master speed| | |
|249|0|MPRO_ECAM_ParaMaster_ActAcc|rpm|ECAM / EGEAR: Parameter interface master acceleration| | |
| |250|0|MPRO_ECAM_ParaMaster_Amplitude| |ECAM / EGEAR: Parameter interface master amplitude| |

Table 8.37: “Synchronized motion - Master configuration” parameters

# 8.11.5 Electronic gearing

# Gear ratio

The gear ratio is specified as a fraction. This ensures that the position references can be translated to the motor shaft with no rounding error.

- ""Slave"" (P 252[0] - MPRO_ECAM_Egear_GearNum) is the numerator
- ""Master"" (P 251[0] - MPRO_ECAM_Egear_GearDen) is the denominator

# Scaling of speed pre-control

Defined with P 265[0] - MPRO_ECAM_CamSlave_SpeedFactor definiert.

# Scaling of torque pre-control

Defined with P 266[0] - MPRO_ECAM_CamSlave_TorqueFactor.

# Engagement

See Section ""Engagement"" on page 284.

# Disengagement

See Section ""Disengagement"" on page 285.

|ID|Index Name|Unit|Description|
|---|---|---|---|
|251|0 MPRO_ECAM_Egear_GearDen| |EGEAR: Gear denominator|
|252|0 MPRO_ECAM_Egear_GearNum| |EGEAR: Numerator of gear ratio|
|1344|0 MPRO_ECAM_Egear_LimRefAcc|rpm/s|EGEAR: Acceleration limit for reference|
|1345|0 MPRO_ECAM_Egear_LimRefJerk|rpm/s²|EGEAR: Jerk limit for reference|

Table 8.38: “Synchronized motion - Electronic gearing” parameters

Image 8.73: ""Electronic gearing"" screen

MOOG ID No.:CB40859-001 Date:11/2020 MSD ServoDrive - DeviceHelp 283

# 8 Motion profile

# 8 Motion profile

MOOG ID No.:CB40859-001 Date:11/2020

MSD ServoDrive - DeviceHelp 284

# 8.11.6 Engagement

used to define the engagement distance (between the dashed lines).

P 253[0] - MPRO_ECAM_Egear_GearInMode is used to define the mode for engagement.

- DIRECT (0) = Direct
- Direct engagement: Angular synchronous; with jerking (no ramps).
- CROSSFADE (3) = Crossfading
- Engagement with crossfading function (5th degree polynomial): Angular synchronous; jerk-limited; speed will overshoot during engagement.
- RAMP (1) = Linear speed ramp
- Engagement with linear acceleration: Not angular synchronous; with jerking.
- FADE (2) = Engagement fade-out
- Engagement with fade-in function (5th degree polynomial): Not angular synchronous; jerk-limited. The position is ignored. ",What are the available modes in the 'synchronization mode' drop-down menu in the 'MSD ServoDrive - DeviceHelp' document?,A1,"Off(0), ECAM_iPlc(1), EGEAR_iPlc(2), ECAM_PARA(3), and EGEAR_PARA(4).",2.609375,2.703125,3.609375,1.3359375,0.65625
21,msd_servo_drive.txt,76,b87ca5e232c2bdbb6fa16a8a401c6b5d285dc0183e73cc9d134de13dd2fc71d2,"MOOG ID No.:CB40859-001 Date:11/2020

MSD ServoDrive - DeviceHelp 267

# 8 Motion profile

MOOG ID No.:CB40859-001 Date:11/2020 MSD ServoDrive - DeviceHelp 268

# Deceleration

With ...

- P 194 - MPRO_TAB_TDec (for torque control) or
- P 197 - MPRO_TAB_SDec (for speed control) or
- P 200 - MPRO_TAB_PDec (for position control)

and indexes 0–15, the deceleration for each individual motion task can be defined. The input must not be zero.

# Wait time in Auto mode

P 204 - MPRO_TAB_WaitTime is used to define the wait time before the next motion task is carried out.

# Maximum table index in Auto mode

P 206[0] - MPRO_Tab_MaxIdx is used to define the table index up to which driving jobs will be carried out in one of the auto modes.

# Current table index

P 207[0] - MPRO_Tab_ActIdx will show the index for the motion task that is currently active. If parameter P 205 MPRO_TAB_Mode is set to “Para(0)”, a driving set can be entered and approached directly.

# Activation of reference table

The following procedures can be used in order to activate the setpoint table for operation.

|ID|Index Name|Unit|Description|
|---|---|---|---|
|193|MPRO_TAB_TAcc|TAB: Torque mode acceleration|Nm/ms|
|193|0|MPRO_TAB_TAcc|Nm/ms|
|193|1 - 15|MPRO_TAB_TAcc|Nm/ms|
|194|MPRO_TAB_TDec|TAB: Torque mode deceleration| |
|194|0|MPRO_TAB_TDec|Nm/ms|
|194|1 - 15|MPRO_TAB_TDec|Nm/ms|

# Table 8.23: Activation of table references

# Table 8.24: “Setpoint table settings” parameters

# Table 8.24: “Setpoint table settings” parameters (continue)

|ID|Index Name|Unit|Description|ID|Index Name|Unit|Description|
|---|---|---|---|---|---|---|---|
|195|MPRO_TAB_TRef|Nm|TAB: Torque mode reference value|208|MPRO_TAB_OutputNo| |OSD TAB: actual table index and target|
|195|MPRO_TAB_TRef|Nm| |208|MPRO_TAB_OutputNo| | |
|196|MPRO_TAB_SAcc|rev/min/s|TAB: Speed mode acceleration|269|MPRO_TAB_Ctrl| |TAB: control word|
|196|MPRO_TAB_SAcc|rev/min/s| | | | | |
|197|MPRO_TAB_SDec|rev/min/s|TAB: Speed mode deceleration| | | | |
|197|MPRO_TAB_SDec|rev/min/s| | | | | |
|198|MPRO_TAB_SRef|rev/min|TAB: Speed mode reference value| | | | |
|198|MPRO_TAB_SRef|rev/min| | | | | |
|199|MPRO_TAB_PAcc|rev/min/s|TAB: Position control mode acceleration| | | | |
|199|MPRO_TAB_PAcc|rev/min/s| | | | | |
|200|MPRO_TAB_PDec|rev/min/s|TAB: Position control mode Acceleration| | | | |
|200|MPRO_TAB_PDec|rev/min/s| | | | | |
|201|MPRO_TAB_PSpd|rev/min|TAB: Position control mode speed| | | | |
|201|MPRO_TAB_PSpd|rev/min| | | | | |
|202|MPRO_TAB_PPos|mDegree|TAB: Position control mode reference value| | | | |
|202|MPRO_TAB_PPos|mDegree| | | | | |
|203|MPRO_TAB_PMode| |Position control table:Mode| | | | |
|203|MPRO_TAB_PMode| | | | | | |
|204|MPRO_TAB_WaitTime|ms|TAB: Wait time| | | | |
|204|MPRO_TAB_WaitTime|ms| | | | | |
|205|MPRO_TAB_Mode| |TAB mode| | | | |
|206|MPRO_Tab_MaxIdx| |TAB: Max index in AUTO mode| | | | |
|207|MPRO_TAB_ActIdx| |TAB: Actual index| | | | |

MOOG ID No.:CB40859-001 Date:11/2020

MSD ServoDrive - DeviceHelp

# 8 Motion profile

MOOG ID No.:CB40859-001 Date:11/2020

MSD ServoDrive - DeviceHelp 270

# 8.8 Analog channel (ISA00 und ISA01)

# Offset (O)

This parameter (P 174 - MPRO_ANA0_SOffset for ISA00, P 184 - MPRO_ANA1_SOffset for ISA01) compensates for component variations and is used for offset compensation purposes. Depending on the control mode being used (see Section ""Basic settings"" on page 110), the value will be stored in parameter index [0] (torque control), [1] (speed control) or [2] (position control).

# Backlash (B)

This parameter (P 175 - MPRO_ANA0_SThreshold for ISA00, P 185 - MPRO_ANA1_SThreshold for ISA01) can suppress axis motion close to the standstill (stop) position. Depending on the control mode being used (see Section ""Basic settings"" on page 110), the value will be stored in parameter index [0] (torque control), [1] (speed control) or [2] (position control).

Image 8.68: “Analog channel” screen

# Acceleration ramp

Two standard analog inputs (ISA00, ISA01) are available. These inputs can be configured...

- with negative values for analog setpoint settings
- with positive values for digital setpoint processing

(P 109[0] - MPRO_INPUT_FS_ISA00 and P 110[0] - MPRO_INPUT_FS_ISA01).

see also section ""Analog Inputs"" on page 303. By using the ""REV(-2) = Analog setpoint"" setting, an analog input voltage of ±10 V can be processed as a setpoint.

# Deceleration ramp

This parameter serves as a deceleration ramp for torque control (P 176[1] - MPRO_ANA0_TRamp for ISA00, P 186[1] - MPRO_ANA1_TRamp for ISA01) or speed control (P 177[1] - MPRO_ANA0_SRamp for ISA00, P 187[1] - MPRO_ANA1_SRamp for ISA01). Depending on the control mode being used (see Section ""Basic settings"" on page 110), the value will be stored in parameter index [0] (torque control), [1] (speed control) or [2] (position control).

This parameter (P 173 - MPRO_ANA0_Scale for ISA00, P 183 - MPRO_ANA1_Scale for ISA01) is used to define which speed / which torque / which position corresponds to the maximum analog value. Depending on the control mode being used (see Section ""Basic settings"" on page 110), the value will be stored in parameter index [0] (torque control), [1] (speed control) or [2] (position control).

# 8.8.1 Special characteristics of position control mode

A threshold value can also be specified which generates a run-on range around the last reference value. A ramp function calculates a motion profile for the position reference from pre-defined acceleration and speed limits.

The position references on the analog channel are not applied immediately, but dependent on a digital input. Accordingly, one of the ISD00 to ISD06 digital inputs must be set to a value of ""REFANAEN(28) = Enable analog reference value"" (see Section ""Digital inputs"" on page 290). The position setpoint being received will only be applied if the corresponding digital input is active. The acceleration is entered using P 173[0] - MPRO_ANA0_TScale or P 183[0] - MPRO_ANA1_TScale.

# 8.8.2 Wire Break Monitoring

P 399 - CON_ANAWireBrk_Th can be used to configure wire break monitoring for the analog inputs. For details see Section ""Wire Break Monitoring"" on page 306.

|Function|TLIM (-4)|OVR (-3)|REFV (-2)|leer (-1)|OFF (0)|
|---|---|---|---|---|---|
|Digital|(1)-(28)|(1)-(28)|(1)-(28)|(1)-(28)|(1)-(28)|
|Analog channel|Filter|Scale|Offset|Profile|generator|

Control

Image 8.69: Reference processing structure

MOOG ID No.:CB40859-001 Date:11/2020

MSD ServoDrive - DeviceHelp 271

# 8 Motion profile

# 8 Motion profile

MOOG ID No.:CB40859-001 Date:11/2020

|ID|Index Name|Unit|Description|ID|
|---|---|---|---|---|
|395|CON_ANA_Isaf_Scaled| |Analog inputs: Values (filt, norm, comp, scaled)|174|
|395|0 ISA00| |Scaled, compensated, filtered, normalized value|175|
|395|1 ISA01| |Scaled, compensated, filtered, normalized value| |
|396|CON_ANA_Scale_ThUpper| |Analog inputs: Upper scaling limits|175|
|396|0 ISA00|%|Upper scaling (@ 10 V) threshold|175|
|396|1 ISA01|%|Upper scaling (@ 10 V) threshold| |
|397|CON_ANA_Scale_ThZero| |Analog inputs: Zero scaling thresholds|176|
|397|0 ISA00|V|Zero scaling threshold (+/-)|176|
|397|1 ISA01|V|Zero scaling threshold (+/-)| |
|398|CON_ANA_Scale_ThLower| |Analog inputs: Lower scaling limits|177|
|398|0 ISA00|%|Lower scaling (@ zero threshold) threshold|177|
|398|1 ISA01|%|Lower scaling (@ zero threshold) threshold| |
|399|CON_ANA_WireBrk_Th| |Analog inputs: Wire break thresholds|Table 8.26:|
|399|0 ISA00|V|Wire break detection threshold| |
|399|1 ISA01|V|Wire break detection threshold| |
|405|0 CON_ANA_Filt0|ms|Analog input ISA00: Filter time constant (PT 1)|ID|
|408|CON_ANA_Isaf_Norm| |Analog inputs: Values (filt, norm)|183|
|408|0 ISA00| |Filtered, normalized value|183|
|408|1 ISA01| |Filtered, normalized value|183|

Table 8.25: “Analog channel” parameters

|ID|Index Name|Unit|Description|ID|
|---|---|---|---|---|
|173|MPRO_ANA0_Scale| |ANA0: scale factors|184|
|173|0 MPRO_ANA0_TScale|Nm|ANA0: scale factor torque reference|185|
|173|1 MPRO_ANA0_SScale|rev/min|ANA0: scale factor speed reference|185|
|173|2 MPRO_ANA0_PScale|mDegree|ANA0: scale factor position reference| |
|174|MPRO_ANA0_Offset| |ANA0: offsets|185|
|174|0 MPRO_ANA0_TOffset|Nm|ANA0: offsets for torque reference|185|

Table 8.26: “Analog channel ISA00” parameters

|Index Name|Unit|Description|
|---|---|---|
|1 MPRO_ANA0_SOffset|rev/min|ANA0: offsets for speed reference|
|2 MPRO_ANA0_POffset|mDegree|ANA0: offsets for position reference|
|MPRO_ANA0_Threshold| |ANA0: thresholds|
|0 MPRO_ANA0_TThreshold|Nm|ANA0: threshold for torque reference|
|1 MPRO_ANA0_SThreshold|rev/min|ANA0: threshold for speed reference|
|2 MPRO_ANA0_PThreshold|mDegree|ANA0: threshold for position reference|
|MPRO_ANA0_TRamp| |ANA0: Torque mode acceleration [0] and deceleration [1]|
|0 MPRO_ANA0_TRamp|Nm/s| |
|1 MPRO_ANA0_TRamp|Nm/s| |
|MPRO_ANA0_SRamp| |ANA0: Speed mode acceleration [0] and deceleration [1]|
|0 MPRO_ANA0_SRamp|SPEED/s| |
|1 MPRO_ANA0_SRamp|SPEED/s| |

“Analog channel ISA00” parameters (continue)

|Index Name|Unit|Description|
|---|---|---|
|MPRO_ANA1_Scale| |ANA1: scale factors|
|0 MPRO_ANA1_TScale|Nm|ANA0: scale factor torque reference|
|1 MPRO_ANA1_SScale|rev/min|ANA0: scale factor speed reference|
|2 MPRO_ANA1_PScale|mDegree|ANA0: scale factor position reference|
|MPRO_ANA1_Offset| |ANA1: offsets|
|0 MPRO_ANA1_TOffset|Nm|ANA1: offsets for torque reference|
|1 MPRO_ANA1_SOffset|rev/min|ANA1: offsets for speed reference|
|2 MPRO_ANA1_POffset|mDegree|ANA1: offsets for position reference|
|MPRO_ANA1_Threshold| |ANA1: thresholds|
|0 MPRO_ANA1_TThreshold|Nm|ANA1: threshold for torque reference|
|1 MPRO_ANA1_SThreshold|rev/min|ANA1: threshold for speed reference|
|2 MPRO_ANA1_PThreshold|mDegree|ANA1: threshold for position reference|

“Analog channel ISA01” parameters

# 8 Motion profile

|ID|Index Name|Unit|Description|
|---|---|---|---|
|186|MPRO_ANA1_TRamp|Nm/s|ANA1: Torque mode acceleration [0] and deceleration[1]|
|186|MPRO_ANA1_TRamp|Nm/s| |
|187|MPRO_ANA1_SRamp|SPEED/s|ANA1: Speed mode acceleration [0] and deceleration [1]|
|187|MPRO_ANA1_SRamp|SPEED/s| |

# Table 8.27: “Analog channel ISA01” parameters (continue)

Display

- System state
- Initialization on device startup
- Not ready (DC link voltage possibly too low)
- Start inhibit (DC link voltage present, power stage off)
- Starting lockout
- Ready for start
- Control initialization: Auto commutation, flux build-up etc.

# Table 8.28: Central state machine according to CiA 402 device display

MOOG ID No.:CB40859-001 Date:11/2020

MSD ServoDrive - DeviceHelp 273

# 8 Motion profile

MOOG ID No.:CB40859-001 Date:11/2020

MSD ServoDrive - DeviceHelp 274

|Display|System state|power disabled|fault|
|---|---|---|---|
|Control enabled|0|Start|7|
| |fault reaction active|0|14|
|Quick stop active|1|not ready|8|
| |to switch on|1|17|
|Error reaction active|2|switch on|disabled|
| |2|7| |
|Error state (in this state the error is indicated directly on the display.)|3|ready to|switch on|
|Device is reset (display flashes)|power enabled|3|6|
| |10|12| |
|• Number [5.] flashes when “STO” (Safe Torque Off) input is active. Display goes out when STO inactive.| | | |
|• The dot on the display flashes when the power stage is active.| | | |

Table 8.28: Central state machine according to CiA 402 device display (continue)

NOTE

l The system states indicated on the display may differ from the states in the table depending on the drive profile setting.

Image 8.70: State machine diagram based on CANopen communications

⓪ to ① State number

1 to 17 State transition (No. 17: DC link voltage cut off)

Legend for “State machine diagram based on CANopen communications” figure

# 8.10 Touch probe

|ID|Index Name / Setting|
|---|---|
|241|0 MPRO_TP_Position|
|241|1 MPRO_TP_Position|
|241|2 MPRO_TP_Position|
|241|3 MPRO_TP_Position|
|241|4 MPRO_TP_Position|
|1400|0 MPRO_TP_Config|
| |TP_TP (0)|
| |AB (1)|
| |PD_UP (2)|
| |PD_DOWN (3)|
| |PC_PC (4)|
| |PC_TP (5)|
| |TP_PC (6)|
| |ENC_ENC (7)|
| |ENC_TP (8)|
| |TP_ENC (9)|

Using the touch probe inputs, touch probe functions can be performed. In order to be able to do this, P 106[0] - MPRO_INPUT_FS_ISD05 and P 107[0] - MPRO_INPUT_FS_ISD06 must be used to set digital inputs ISD05 and ISD06 to ""PROBE(15) = Touch probe (only ISD05/06)"" (see Section ""Digital inputs"" on page 290). HTL encoders can be evaluated or pulse counters implemented using the MSD PLC.

The touch probe can be triggered with P 240 - MPRO_TP_Ctrl. This enables triggering on a positive or negative edge, or on both edges, of the signal detected on the touch probe inputs. After the measurement, the parameter jumps back to the value ""NONE (0)"" and the latch position is mapped in the corresponding subindex of parameter P 241 - MPRO_TP_Position. A continuous touch probe mode is not possible at present, so the touch probe has to be reactivated after the measurement.

P 1402 - MPRO_TP_Channel can be used to select various positions as actual value sources of the latch position for the touch probe functionality. The following table provides an overview of the available settings. The counters are accessed via the MSD PLC or a bus system.

|ID|Index Name / Setting|Unit|Description|
|---|---|---|---|
|240|MPRO_TP_Ctrl|Touch probe: Control| |
| |0| |NONE (0) = No function|
| |1| |POS (1) = Positive edge|
| |2| |NEG (2) = Negative edge|
| |3| |BOTH (3) = Both edges|
|240|0 MPRO_TP_Ctrl| | |
|240|1 MPRO_TP_Ctrl| | |
|240|2 MPRO_TP_Ctrl| | |
|241|MPRO_TP_Position|Probe: Pos. high/low edge of TP0/1, encoder zero pulse| |

Table 8.29: “Touch probe” parameters

MOOG ID No.:CB40859-001 Date:11/2020

# 8 Motion profile

|Unit|Description|
|---|---|
|mDegree|Touch probe: Configuration|
|mDegree|TP0, TP1 touch probe|
|mDegree|TP0, TP1 as encoder, A/B as quadrature counting|
|mDegree|TP0, TP1 as encoder, pulse (TP0) / direction (TP1), count up on direction high|
|mDegree|TP0, TP1 as encoder, pulse (TP0) / direction (TP1), count down on direction high|
|mDegree|TP0 pulse counter, TP1 pulse counter|
|mDegree|TP0 pulse counter, TP1 touch probe|
|mDegree|TP1 touch probe, TP0 pulse counter|
|mDegree|TP0 encoder counter, TP1 encoder counter|
|mDegree|TP0 encoder counter, TP1 touch probe|
|mDegree|TP0 touch probe, TP1 encoder counter|

Touch probe: Channel

|Unit|Description|
|---|---|
|ACTPOS (0)|Actual position in user units|
|ACTPOSINC (1)|Actual position in increments|
|MASTERPOS (2)|Master position in increments|
|ENCPOS_CH1 (3)|Encoder position Channel 1|
|ENCPOS_CH1_INC (4)|Encoder position Channel 1 in increments|
|ENCPOS_CH2 (5)|Encoder position Channel 2|
|ENCPOS_CH2_INC (6)|Encoder position Channel 2 in increments|

# 8 Motion profile

MOOG ID No.:CB40859-001 Date:11/2020 MSD ServoDrive - DeviceHelp 276

|ID|Index Name / Setting|Unit|Description|
|---|---|---|---|
|7|ENCPOS_CH3 (7)| |Encoder position Channel 3|
|8|ENCPOS_CH3_INC (8)| |Encoder position Channel 3 in increments|
|9|ENCPOS_CH4 (9)| |Encoder position Channel 4|
|10|ENCPOS_CH4_INC (10)| |Encoder position Channel 4 in increments|
|11|ACTPOS2 (11)| |Actual position of redundant encoder in user units|
|12|Sercos (12)| |Referred to Sercos profile parameters S-x-0426, S-x-0427|
|13|UserRefPos(13)| |Reference position in user units|
|14|MasterPosST(14)| |Master position (ECAM, EGEAR) singleturn, always steps|
|15|CommonMasterPos(15)| |Master position (ECAM, EGEAR) singleturn, always steps|
|16|CommonMasterPosST(15)| |Master position (ECAM, EGEAR) singleturn, always steps|
|1402|MPRO_TP_Channel| | |
|1402|MPRO_TP_Channel| | |
|1402|MPRO_TP_Channel| | |
|1404|MPRO_TP_Lines| |Touch probe: Lines @ pulse counter on channel x|
|1404|MPRO_TP_Lines| | |
|1404|MPRO_TP_Lines| | |

Image 8.71: “Synchronized motion” screen

There are various modes available in the “synchronization mode” drop-down menu (P 242[0] - MPRO_ECAM_SyncModMode):

- Off(0) = Synchronized motion off
- ECAM_iPlc(1) = Electronic cam plate via MSD PLC
- EGEAR_iPlc(2) = Electr. gear unit via MSD PLC
- ECAM_PARA(3) = Electronic camming via parameters
- EGEAR_PARA(4) = Electronic gearing via parameters

NOTE: For more information refer to the bus system User Manuals or the description of the MSD PLC.

# 8.11.1 Electronic cam plate

The other parameters are configured in separate screens that can be accessed with the corresponding buttons.

- Master configuration (see Section ""Master configuration"" on page 280)
- Electronic gearing (see Section ""Electronic gearing"" on page 283)
- Electronic camming (see Section ""Electronic cam plate"" on page 277)

P 1318[0] - MPRO_ECAM_ControlWord is the control word for “synchronized motion” (see Section ""Control word for synchronized motion"" on page 279).

P 1326[0] - MPRO_ECAM_StatusWord is the status word for “synchronized motion” (see Section ""Status word for synchronized motion"" on page 279).

# 8.11.1.1 Table selection

|ID|Index Name|Unit|Description|
|---|---|---|---|
|1300|MPRO_ECAM_CTS_| |ECAM: CamTableSelect - Master reference|
|1301|MasterRef| | |
|1305|MPRO_ECAM_CTS_| |ECAM: CamTableSelect - Method for changing the camtable|
|1306|MPRO_ECAM_CTS_| |ECAM: CamTableSelect - Mode for changing the camtable|
|1307|MPRO_ECAM_CTS_|incr|ECAM: CamTableSelect - Distance for changing the camtable|
|242|MPRO_ECAM_| |ECAM / EGEAR: Mode of synchronized motion SyncModMode|
|265|MPRO_ECAM_| |ECAM / EGEAR: Slave speed factor (1 = 100%).|
|266|CamSlave_SpeedFactor| | |
|268|MPRO_ECAM_| |ECAM / EGEAR: Mode of switching off sync. motion|

# 8.11.1.2 Synchronization

|ID|Index Name|Unit|Description|
|---|---|---|---|
|1342|MPRO_ECAM_CI_|incr|ECAM: CamIn - Synchronization position (multiturn part)|
|1343|MPRO_ECAM_CO_|incr|ECAM: CamOut - Decoupling pos. (multiturn part)|
|1303|MPRO_ECAM_CI_|incr|ECAM: CamIn - Master offset|
|1308|MPRO_ECAM_CI_| |ECAM: CamIn - Master reference|
|1309|MPRO_ECAM_CI_| |ECAM: CamIn - Slave reference|
|1310|MPRO_ECAM_CI_| |ECAM: CamIn - Coupling mode|
|1311|MPRO_ECAM_CI_|incr|ECAM: CamIn - Coupling distance|
|1312|MPRO_ECAM_CI_|incr|ECAM: CamIn - Synchronization position|

Table 8.31: “Electronic camming - Table selection” parameters

Table 8.30: “Synchronized motion” parameters

Table 8.32: “Electronic camming - Synchronization” parameters

MOOG ID No.:CB40859-001 Date:11/2020

MSD ServoDrive - DeviceHelp 277

# 8 Motion profile

MOOG ID No.:CB40859-001 Date:11/2020 MSD ServoDrive - DeviceHelp 278

|ID|Index|Name|Unit|Description|
|---|---|---|---|---|
|1313|0|MPRO_ECAM_CO_SyncPosST|(singleturn part)|ECAM: CamOut - Slave reference|
|1314|0|MPRO_ECAM_CO_DecouplingMode|63|ECAM: CamOut - Decoupling mode|
|1315|0|MPRO_ECAM_CO_BreakingPosST|incr|ECAM: CamOut - Decoupling position|
|1316|0|MPRO_ECAM_CO_DecouplingDist|incr|ECAM: CamOut - Decoupling distance|
|1317|0|MPRO_ECAM_CO_StandstillPos|mDegree|ECAM: CamOut - Slave standstill position|

# Table 8.32: “Electronic camming - Synchronization” parameters (continue)

|ID|Index|Name|Unit|Description|
|---|---|---|---|---|
|1346| |MPRO_ECAM_SP_Table| |ECAM: Setpoint table interface|
|1346|0|Index| |Index of setpoint table|
|1346|1|Value| |Value at index of setpoint table|
|1347|0 to 31|MPRO_ECAM_SP_Index| |ECAM: Setpoint segments start index|
|1348|0 to 31|MPRO_ECAM_SP_Length| |ECAM: Setpoint segments length|
|1349|0 to 31|Length| | |
|1350|0|MPRO_ECAM_SP_MaDist| |ECAM: Setpoint segments master distance|
|1351|0|MPRO_ECAM_SP_IpoType| |ECAM: Setpoint segments interpolation type|
|1352|0 to 31|Checksum| |ECAM: Setpoint table checksum|
|1353|0 to 31|GainNum| |ECAM: Setpoint segments gain numerator|
| | |GainDen| |ECAM: Setpoint segments gain denominator|

# Table 8.33: “Electronic camming - Table segments” parameters

|ID|Index|Name|Unit|Description|
|---|---|---|---|---|
|1329|0 to 63|MPRO_ECAM_SegData_IndexNext| |ECAM: Index of the following segment|
|1330|0 to 63|MPRO_ECAM_SegData_IndexPrev| |ECAM: Index of the previous segment|
|1331|0 to 63|MPRO_ECAM_SegData_ProfileMode| |ECAM: Profile mode of the current segment|
|1332|0 to 63|MPRO_ECAM_SegData_DistMaster| |ECAM: Length of the master section of the current segment|
|1333|0 to 63|MPRO_ECAM_SegData_DistSlave| |ECAM: Length of the slave section of the current segment|
|1334|0 to 63|MPRO_ECAM_SegData_Lambda| |ECAM: Lambda value of the current segment|
|1335|0 to 63|MPRO_ECAM_SegData_StatusWord| |ECAM: Status word of the current segment|
|1336|0 to 63|MPRO_ECAM_SegData_ControlWord| |ECAM: Control word of the current segment|

# 8.11.2 Control word for synchronized motion

|Bit|Function|PLC function|Bit number|Description|
|---|---|---|---|---|
|0-7|Start segment (8-bit value)|-|0-7|Actual segment (8-bit value)|
|8-15|Reserved|-| |Actual ECAM / EGEAR state machine state (4 Bit value)|
|16|Absolute (true) / relative (false) master relationship|-| |- 0: ECAM / EGEAR asynchronous
- 1: ECAM / EGEAR synchronous
|
|17|Absolute (true) / relative (false) master (CAM) relationship at cam in|-| |- 2: ECAM / EGEAR synchronizing
- 3: ECAM / EGEAR desynchronizing
|
|18|Absolute (true) / relative (false) slave (CAM) relationship at cam in|-| |- 4: ECAM / EGEAR active and waiting for going asynchronous
|
|19-23|Reserved|-| |- 5: ECAM / EGEAR inactive and waiting for going synchronous
|
|24|Change gear ratio of the electronic gear online|MCB_GearRatioChange| | |
|25|Disable master calculation|MCB_Cam_MasterEnable| | |
|26|Enable master calculation|MCB_Cam_MasterEnable| | |
|27|Select CAM table|MCB_CamTableSelect| | |
|28|Start Ecam|MCB_CamIn| | |
|29|Stop Ecam|MCB_CamOut| | |
|30|Start Egear|MCB_GearIn| | |
|31|Stop Egear|MCB_GearOut| | |

# 8.11.3 Status word for synchronized motion

|Bit|Function|PLC function|Bit number|Description|
|---|---|---|---|---|
|12-26|Reserved|-| | |
|27|ECAM / EGEAR is active|-| | |
|28|Valid segments chosen|-| | |
|29|Master data are valid|-| | |
|30|Master is initialized|-| | |
|31|Master calculation is active|-| | |

Table 8.35: Control word ECAM (P 1318[0] - MPRO_ECAM_ControlWord)

Table 8.36: ECAM status word (P 1326[0] - MPRO_ECAM_StatusWord)

MOOG ID No.:CB40859-001 Date:11/2020 MSD ServoDrive - DeviceHelp 279

# 8 Motion profile

# 8 Motion profile

MOOG ID No.:CB40859-001 Date:11/2020

MSD ServoDrive - DeviceHelp 280

# 8.11.4 Master configuration

the master encoder, you will need to set the resolution relative to a single motor revolution in P 250 - MPRO_ECAM_PARAMaster_Amplitude (see below).

- ENC CH1 (3) = Encoder channel 1 X7 (Sin/Cos)
- ENC CH2 (4) = Encoder channel 2 X6 (Resolver)
- ENC CH3 (5) = Encoder channel 3 X8 (optional)

This function is only available if an external interface X8 (option module) is present.

- TP0 (6) = Pulse counter on probe channel 0 (TP0)
- TP1 (7) = Pulse counter on probe channel 1 (TP1)
- ENC_CH4 (8) = Encoder channel 4 (p. e. fieldbus)
- TWIN_POS (9) = TWIN remote reference position (P-2607)

Image 8.72: “Master configuration” screen

# Channel selection (master encoder)

P 1319[0] - MPRO_ECAM_CamMaster_AxisType is used to define the master encoder.

- NO AXIS (0) = No axis
- VIRTUAL MASTER (1) = Virtual master

If you select this function, you will be able to configure additional settings by clicking on the enabled “Options...” button (see Section ""Virtual Master"" on page 286).

- PARA (2) = Master parameter interface

If you select this function because a higher-level controller is being used as

# Anti-reverse mode

Slave only starts moving along with it again as soon as the master reaches the zero position.

P 1320[0] - MPRO_ECAM_CamMaster_RevLockMode is used to define the reverse lock mode, which can be used either with or without path compensation. The dashed lines in the following diagrams indicate what the engagement distance is:

# Example:

If the master, which has moved two motor revolutions in the direction blocked for the slave, then moves in the unblocked direction again, the slave only moves off when the master has traversed the zero point.

- INACTIVE (0) = Reverse lock inactive
- ACTIVE (2) = Reverse lock enabled - without path optimization
- ACTIVE WAY COMP (1) = Reverse lock active - with way compensation

While the slave accelerates to the speed of the master during engagement, the master and slave do not move synchronously. This function needs to be selected in order to quickly catch up to the master that is running ahead.

# Example:

- Master (black line) rotates in the blocked direction
- The slave (blue line) remains stopped
- Master rotates in the unblocked direction again
- The slave follows the master directly in the unblocked direction

Assume the master has moved two motor revolutions in the direction for which the slave lock is enabled. If the master now moves in the direction for which there is no lock, the slave will immediately start running in that direction.

MOOG ID No.:CB40859-001 Date:11/2020

MSD ServoDrive - DeviceHelp 281

# 8 Motion profile

MOOG ID No.:CB40859-001 Date:11/2020 MSD ServoDrive - DeviceHelp 282

|Filter type|ID|Index Name|Unit|Description|
|---|---|---|---|---|
|When using a real master encoder, encoder signals may be subject to noise.|P 1340|1319|0|MPRO_ECAM_CamMaster_AxisType|
| | |MPRO_ECAM_CamMaster_SpeedFilTyp| |ECAM / EGEAR: Channel selection of internal master input|
| | |1320|0|MPRO_ECAM_CamMaster_RevLockMode|
| | |1321|0|MPRO_ECAM_CamMaster_Amplitude|
| | |1322|0|MPRO_ECAM_CamMaster_GearNum|
| | |1323|0|MPRO_ECAM_CamMaster_GearDen|
|Filter time|1327|0|ms|ECAM / EGEAR: Filter time constant of master|
|If P 1340[0] is used to enable a filter, P 1327[0] - MPRO_ECAM_CamMaster_SpeedTFil can be used to define the corresponding filter time.|1328|0|speed|ECAM / EGEAR: Speed factor of the internal master|
|Speed factor|1340|0| |MPRO_ECAM_CamMaster_SpeedFilTyp|
|The master encoder can be assigned an additional speed factor P 1328[0] - MPRO_ECAM_CamMaster_SpeedFactor.|1341|0|incr|ECAM / EGEAR: Master drive offset|

Table 8.37: “Synchronized motion - Master configuration” parameters (continue)

| | | |ID|Index Name|Unit|Description|
|---|---|---|---|---|---|---|
|247|0|MPRO_ECAM_ParaMaster_ActPos|incr|ECAM / EGEAR: Parameter interface master position| | |
|248|0|MPRO_ECAM_ParaMaster_ActSpeed|rpm|ECAM / EGEAR: Parameter interface master speed| | |
|249|0|MPRO_ECAM_ParaMaster_ActAcc|rpm|ECAM / EGEAR: Parameter interface master acceleration| | |
| |250|0|MPRO_ECAM_ParaMaster_Amplitude| |ECAM / EGEAR: Parameter interface master amplitude| |

Table 8.37: “Synchronized motion - Master configuration” parameters

# 8.11.5 Electronic gearing

# Gear ratio

The gear ratio is specified as a fraction. This ensures that the position references can be translated to the motor shaft with no rounding error.

- ""Slave"" (P 252[0] - MPRO_ECAM_Egear_GearNum) is the numerator
- ""Master"" (P 251[0] - MPRO_ECAM_Egear_GearDen) is the denominator

# Scaling of speed pre-control

Defined with P 265[0] - MPRO_ECAM_CamSlave_SpeedFactor definiert.

# Scaling of torque pre-control

Defined with P 266[0] - MPRO_ECAM_CamSlave_TorqueFactor.

# Engagement

See Section ""Engagement"" on page 284.

# Disengagement

See Section ""Disengagement"" on page 285.

|ID|Index Name|Unit|Description|
|---|---|---|---|
|251|0 MPRO_ECAM_Egear_GearDen| |EGEAR: Gear denominator|
|252|0 MPRO_ECAM_Egear_GearNum| |EGEAR: Numerator of gear ratio|
|1344|0 MPRO_ECAM_Egear_LimRefAcc|rpm/s|EGEAR: Acceleration limit for reference|
|1345|0 MPRO_ECAM_Egear_LimRefJerk|rpm/s²|EGEAR: Jerk limit for reference|

Table 8.38: “Synchronized motion - Electronic gearing” parameters

Image 8.73: ""Electronic gearing"" screen

MOOG ID No.:CB40859-001 Date:11/2020 MSD ServoDrive - DeviceHelp 283

# 8 Motion profile

# 8 Motion profile

MOOG ID No.:CB40859-001 Date:11/2020

MSD ServoDrive - DeviceHelp 284

# 8.11.6 Engagement

used to define the engagement distance (between the dashed lines).

P 253[0] - MPRO_ECAM_Egear_GearInMode is used to define the mode for engagement.

- DIRECT (0) = Direct
- Direct engagement: Angular synchronous; with jerking (no ramps).
- CROSSFADE (3) = Crossfading
- Engagement with crossfading function (5th degree polynomial): Angular synchronous; jerk-limited; speed will overshoot during engagement.
- RAMP (1) = Linear speed ramp
- Engagement with linear acceleration: Not angular synchronous; with jerking.
- FADE (2) = Engagement fade-out
- Engagement with fade-in function (5th degree polynomial): Not angular synchronous; jerk-limited. The position is ignored. ",What are the available modes in the 'synchronization mode' drop-down menu in the 'MSD ServoDrive - DeviceHelp' document?,A2,"Modes include Off, ECAM via MSD PLC, EGEAR via MSD PLC, ECAM via parameters, and EGEAR via parameters.",2.5,2.640625,3.671875,1.3359375,0.65234375
22,msd_servo_drive.txt,76,b87ca5e232c2bdbb6fa16a8a401c6b5d285dc0183e73cc9d134de13dd2fc71d2,"MOOG ID No.:CB40859-001 Date:11/2020

MSD ServoDrive - DeviceHelp 267

# 8 Motion profile

MOOG ID No.:CB40859-001 Date:11/2020 MSD ServoDrive - DeviceHelp 268

# Deceleration

With ...

- P 194 - MPRO_TAB_TDec (for torque control) or
- P 197 - MPRO_TAB_SDec (for speed control) or
- P 200 - MPRO_TAB_PDec (for position control)

and indexes 0–15, the deceleration for each individual motion task can be defined. The input must not be zero.

# Wait time in Auto mode

P 204 - MPRO_TAB_WaitTime is used to define the wait time before the next motion task is carried out.

# Maximum table index in Auto mode

P 206[0] - MPRO_Tab_MaxIdx is used to define the table index up to which driving jobs will be carried out in one of the auto modes.

# Current table index

P 207[0] - MPRO_Tab_ActIdx will show the index for the motion task that is currently active. If parameter P 205 MPRO_TAB_Mode is set to “Para(0)”, a driving set can be entered and approached directly.

# Activation of reference table

The following procedures can be used in order to activate the setpoint table for operation.

|ID|Index Name|Unit|Description|
|---|---|---|---|
|193|MPRO_TAB_TAcc|TAB: Torque mode acceleration|Nm/ms|
|193|0|MPRO_TAB_TAcc|Nm/ms|
|193|1 - 15|MPRO_TAB_TAcc|Nm/ms|
|194|MPRO_TAB_TDec|TAB: Torque mode deceleration| |
|194|0|MPRO_TAB_TDec|Nm/ms|
|194|1 - 15|MPRO_TAB_TDec|Nm/ms|

# Table 8.23: Activation of table references

# Table 8.24: “Setpoint table settings” parameters

# Table 8.24: “Setpoint table settings” parameters (continue)

|ID|Index Name|Unit|Description|ID|Index Name|Unit|Description|
|---|---|---|---|---|---|---|---|
|195|MPRO_TAB_TRef|Nm|TAB: Torque mode reference value|208|MPRO_TAB_OutputNo| |OSD TAB: actual table index and target|
|195|MPRO_TAB_TRef|Nm| |208|MPRO_TAB_OutputNo| | |
|196|MPRO_TAB_SAcc|rev/min/s|TAB: Speed mode acceleration|269|MPRO_TAB_Ctrl| |TAB: control word|
|196|MPRO_TAB_SAcc|rev/min/s| | | | | |
|197|MPRO_TAB_SDec|rev/min/s|TAB: Speed mode deceleration| | | | |
|197|MPRO_TAB_SDec|rev/min/s| | | | | |
|198|MPRO_TAB_SRef|rev/min|TAB: Speed mode reference value| | | | |
|198|MPRO_TAB_SRef|rev/min| | | | | |
|199|MPRO_TAB_PAcc|rev/min/s|TAB: Position control mode acceleration| | | | |
|199|MPRO_TAB_PAcc|rev/min/s| | | | | |
|200|MPRO_TAB_PDec|rev/min/s|TAB: Position control mode Acceleration| | | | |
|200|MPRO_TAB_PDec|rev/min/s| | | | | |
|201|MPRO_TAB_PSpd|rev/min|TAB: Position control mode speed| | | | |
|201|MPRO_TAB_PSpd|rev/min| | | | | |
|202|MPRO_TAB_PPos|mDegree|TAB: Position control mode reference value| | | | |
|202|MPRO_TAB_PPos|mDegree| | | | | |
|203|MPRO_TAB_PMode| |Position control table:Mode| | | | |
|203|MPRO_TAB_PMode| | | | | | |
|204|MPRO_TAB_WaitTime|ms|TAB: Wait time| | | | |
|204|MPRO_TAB_WaitTime|ms| | | | | |
|205|MPRO_TAB_Mode| |TAB mode| | | | |
|206|MPRO_Tab_MaxIdx| |TAB: Max index in AUTO mode| | | | |
|207|MPRO_TAB_ActIdx| |TAB: Actual index| | | | |

MOOG ID No.:CB40859-001 Date:11/2020

MSD ServoDrive - DeviceHelp

# 8 Motion profile

MOOG ID No.:CB40859-001 Date:11/2020

MSD ServoDrive - DeviceHelp 270

# 8.8 Analog channel (ISA00 und ISA01)

# Offset (O)

This parameter (P 174 - MPRO_ANA0_SOffset for ISA00, P 184 - MPRO_ANA1_SOffset for ISA01) compensates for component variations and is used for offset compensation purposes. Depending on the control mode being used (see Section ""Basic settings"" on page 110), the value will be stored in parameter index [0] (torque control), [1] (speed control) or [2] (position control).

# Backlash (B)

This parameter (P 175 - MPRO_ANA0_SThreshold for ISA00, P 185 - MPRO_ANA1_SThreshold for ISA01) can suppress axis motion close to the standstill (stop) position. Depending on the control mode being used (see Section ""Basic settings"" on page 110), the value will be stored in parameter index [0] (torque control), [1] (speed control) or [2] (position control).

Image 8.68: “Analog channel” screen

# Acceleration ramp

Two standard analog inputs (ISA00, ISA01) are available. These inputs can be configured...

- with negative values for analog setpoint settings
- with positive values for digital setpoint processing

(P 109[0] - MPRO_INPUT_FS_ISA00 and P 110[0] - MPRO_INPUT_FS_ISA01).

see also section ""Analog Inputs"" on page 303. By using the ""REV(-2) = Analog setpoint"" setting, an analog input voltage of ±10 V can be processed as a setpoint.

# Deceleration ramp

This parameter serves as a deceleration ramp for torque control (P 176[1] - MPRO_ANA0_TRamp for ISA00, P 186[1] - MPRO_ANA1_TRamp for ISA01) or speed control (P 177[1] - MPRO_ANA0_SRamp for ISA00, P 187[1] - MPRO_ANA1_SRamp for ISA01). Depending on the control mode being used (see Section ""Basic settings"" on page 110), the value will be stored in parameter index [0] (torque control), [1] (speed control) or [2] (position control).

This parameter (P 173 - MPRO_ANA0_Scale for ISA00, P 183 - MPRO_ANA1_Scale for ISA01) is used to define which speed / which torque / which position corresponds to the maximum analog value. Depending on the control mode being used (see Section ""Basic settings"" on page 110), the value will be stored in parameter index [0] (torque control), [1] (speed control) or [2] (position control).

# 8.8.1 Special characteristics of position control mode

A threshold value can also be specified which generates a run-on range around the last reference value. A ramp function calculates a motion profile for the position reference from pre-defined acceleration and speed limits.

The position references on the analog channel are not applied immediately, but dependent on a digital input. Accordingly, one of the ISD00 to ISD06 digital inputs must be set to a value of ""REFANAEN(28) = Enable analog reference value"" (see Section ""Digital inputs"" on page 290). The position setpoint being received will only be applied if the corresponding digital input is active. The acceleration is entered using P 173[0] - MPRO_ANA0_TScale or P 183[0] - MPRO_ANA1_TScale.

# 8.8.2 Wire Break Monitoring

P 399 - CON_ANAWireBrk_Th can be used to configure wire break monitoring for the analog inputs. For details see Section ""Wire Break Monitoring"" on page 306.

|Function|TLIM (-4)|OVR (-3)|REFV (-2)|leer (-1)|OFF (0)|
|---|---|---|---|---|---|
|Digital|(1)-(28)|(1)-(28)|(1)-(28)|(1)-(28)|(1)-(28)|
|Analog channel|Filter|Scale|Offset|Profile|generator|

Control

Image 8.69: Reference processing structure

MOOG ID No.:CB40859-001 Date:11/2020

MSD ServoDrive - DeviceHelp 271

# 8 Motion profile

# 8 Motion profile

MOOG ID No.:CB40859-001 Date:11/2020

|ID|Index Name|Unit|Description|ID|
|---|---|---|---|---|
|395|CON_ANA_Isaf_Scaled| |Analog inputs: Values (filt, norm, comp, scaled)|174|
|395|0 ISA00| |Scaled, compensated, filtered, normalized value|175|
|395|1 ISA01| |Scaled, compensated, filtered, normalized value| |
|396|CON_ANA_Scale_ThUpper| |Analog inputs: Upper scaling limits|175|
|396|0 ISA00|%|Upper scaling (@ 10 V) threshold|175|
|396|1 ISA01|%|Upper scaling (@ 10 V) threshold| |
|397|CON_ANA_Scale_ThZero| |Analog inputs: Zero scaling thresholds|176|
|397|0 ISA00|V|Zero scaling threshold (+/-)|176|
|397|1 ISA01|V|Zero scaling threshold (+/-)| |
|398|CON_ANA_Scale_ThLower| |Analog inputs: Lower scaling limits|177|
|398|0 ISA00|%|Lower scaling (@ zero threshold) threshold|177|
|398|1 ISA01|%|Lower scaling (@ zero threshold) threshold| |
|399|CON_ANA_WireBrk_Th| |Analog inputs: Wire break thresholds|Table 8.26:|
|399|0 ISA00|V|Wire break detection threshold| |
|399|1 ISA01|V|Wire break detection threshold| |
|405|0 CON_ANA_Filt0|ms|Analog input ISA00: Filter time constant (PT 1)|ID|
|408|CON_ANA_Isaf_Norm| |Analog inputs: Values (filt, norm)|183|
|408|0 ISA00| |Filtered, normalized value|183|
|408|1 ISA01| |Filtered, normalized value|183|

Table 8.25: “Analog channel” parameters

|ID|Index Name|Unit|Description|ID|
|---|---|---|---|---|
|173|MPRO_ANA0_Scale| |ANA0: scale factors|184|
|173|0 MPRO_ANA0_TScale|Nm|ANA0: scale factor torque reference|185|
|173|1 MPRO_ANA0_SScale|rev/min|ANA0: scale factor speed reference|185|
|173|2 MPRO_ANA0_PScale|mDegree|ANA0: scale factor position reference| |
|174|MPRO_ANA0_Offset| |ANA0: offsets|185|
|174|0 MPRO_ANA0_TOffset|Nm|ANA0: offsets for torque reference|185|

Table 8.26: “Analog channel ISA00” parameters

|Index Name|Unit|Description|
|---|---|---|
|1 MPRO_ANA0_SOffset|rev/min|ANA0: offsets for speed reference|
|2 MPRO_ANA0_POffset|mDegree|ANA0: offsets for position reference|
|MPRO_ANA0_Threshold| |ANA0: thresholds|
|0 MPRO_ANA0_TThreshold|Nm|ANA0: threshold for torque reference|
|1 MPRO_ANA0_SThreshold|rev/min|ANA0: threshold for speed reference|
|2 MPRO_ANA0_PThreshold|mDegree|ANA0: threshold for position reference|
|MPRO_ANA0_TRamp| |ANA0: Torque mode acceleration [0] and deceleration [1]|
|0 MPRO_ANA0_TRamp|Nm/s| |
|1 MPRO_ANA0_TRamp|Nm/s| |
|MPRO_ANA0_SRamp| |ANA0: Speed mode acceleration [0] and deceleration [1]|
|0 MPRO_ANA0_SRamp|SPEED/s| |
|1 MPRO_ANA0_SRamp|SPEED/s| |

“Analog channel ISA00” parameters (continue)

|Index Name|Unit|Description|
|---|---|---|
|MPRO_ANA1_Scale| |ANA1: scale factors|
|0 MPRO_ANA1_TScale|Nm|ANA0: scale factor torque reference|
|1 MPRO_ANA1_SScale|rev/min|ANA0: scale factor speed reference|
|2 MPRO_ANA1_PScale|mDegree|ANA0: scale factor position reference|
|MPRO_ANA1_Offset| |ANA1: offsets|
|0 MPRO_ANA1_TOffset|Nm|ANA1: offsets for torque reference|
|1 MPRO_ANA1_SOffset|rev/min|ANA1: offsets for speed reference|
|2 MPRO_ANA1_POffset|mDegree|ANA1: offsets for position reference|
|MPRO_ANA1_Threshold| |ANA1: thresholds|
|0 MPRO_ANA1_TThreshold|Nm|ANA1: threshold for torque reference|
|1 MPRO_ANA1_SThreshold|rev/min|ANA1: threshold for speed reference|
|2 MPRO_ANA1_PThreshold|mDegree|ANA1: threshold for position reference|

“Analog channel ISA01” parameters

# 8 Motion profile

|ID|Index Name|Unit|Description|
|---|---|---|---|
|186|MPRO_ANA1_TRamp|Nm/s|ANA1: Torque mode acceleration [0] and deceleration[1]|
|186|MPRO_ANA1_TRamp|Nm/s| |
|187|MPRO_ANA1_SRamp|SPEED/s|ANA1: Speed mode acceleration [0] and deceleration [1]|
|187|MPRO_ANA1_SRamp|SPEED/s| |

# Table 8.27: “Analog channel ISA01” parameters (continue)

Display

- System state
- Initialization on device startup
- Not ready (DC link voltage possibly too low)
- Start inhibit (DC link voltage present, power stage off)
- Starting lockout
- Ready for start
- Control initialization: Auto commutation, flux build-up etc.

# Table 8.28: Central state machine according to CiA 402 device display

MOOG ID No.:CB40859-001 Date:11/2020

MSD ServoDrive - DeviceHelp 273

# 8 Motion profile

MOOG ID No.:CB40859-001 Date:11/2020

MSD ServoDrive - DeviceHelp 274

|Display|System state|power disabled|fault|
|---|---|---|---|
|Control enabled|0|Start|7|
| |fault reaction active|0|14|
|Quick stop active|1|not ready|8|
| |to switch on|1|17|
|Error reaction active|2|switch on|disabled|
| |2|7| |
|Error state (in this state the error is indicated directly on the display.)|3|ready to|switch on|
|Device is reset (display flashes)|power enabled|3|6|
| |10|12| |
|• Number [5.] flashes when “STO” (Safe Torque Off) input is active. Display goes out when STO inactive.| | | |
|• The dot on the display flashes when the power stage is active.| | | |

Table 8.28: Central state machine according to CiA 402 device display (continue)

NOTE

l The system states indicated on the display may differ from the states in the table depending on the drive profile setting.

Image 8.70: State machine diagram based on CANopen communications

⓪ to ① State number

1 to 17 State transition (No. 17: DC link voltage cut off)

Legend for “State machine diagram based on CANopen communications” figure

# 8.10 Touch probe

|ID|Index Name / Setting|
|---|---|
|241|0 MPRO_TP_Position|
|241|1 MPRO_TP_Position|
|241|2 MPRO_TP_Position|
|241|3 MPRO_TP_Position|
|241|4 MPRO_TP_Position|
|1400|0 MPRO_TP_Config|
| |TP_TP (0)|
| |AB (1)|
| |PD_UP (2)|
| |PD_DOWN (3)|
| |PC_PC (4)|
| |PC_TP (5)|
| |TP_PC (6)|
| |ENC_ENC (7)|
| |ENC_TP (8)|
| |TP_ENC (9)|

Using the touch probe inputs, touch probe functions can be performed. In order to be able to do this, P 106[0] - MPRO_INPUT_FS_ISD05 and P 107[0] - MPRO_INPUT_FS_ISD06 must be used to set digital inputs ISD05 and ISD06 to ""PROBE(15) = Touch probe (only ISD05/06)"" (see Section ""Digital inputs"" on page 290). HTL encoders can be evaluated or pulse counters implemented using the MSD PLC.

The touch probe can be triggered with P 240 - MPRO_TP_Ctrl. This enables triggering on a positive or negative edge, or on both edges, of the signal detected on the touch probe inputs. After the measurement, the parameter jumps back to the value ""NONE (0)"" and the latch position is mapped in the corresponding subindex of parameter P 241 - MPRO_TP_Position. A continuous touch probe mode is not possible at present, so the touch probe has to be reactivated after the measurement.

P 1402 - MPRO_TP_Channel can be used to select various positions as actual value sources of the latch position for the touch probe functionality. The following table provides an overview of the available settings. The counters are accessed via the MSD PLC or a bus system.

|ID|Index Name / Setting|Unit|Description|
|---|---|---|---|
|240|MPRO_TP_Ctrl|Touch probe: Control| |
| |0| |NONE (0) = No function|
| |1| |POS (1) = Positive edge|
| |2| |NEG (2) = Negative edge|
| |3| |BOTH (3) = Both edges|
|240|0 MPRO_TP_Ctrl| | |
|240|1 MPRO_TP_Ctrl| | |
|240|2 MPRO_TP_Ctrl| | |
|241|MPRO_TP_Position|Probe: Pos. high/low edge of TP0/1, encoder zero pulse| |

Table 8.29: “Touch probe” parameters

MOOG ID No.:CB40859-001 Date:11/2020

# 8 Motion profile

|Unit|Description|
|---|---|
|mDegree|Touch probe: Configuration|
|mDegree|TP0, TP1 touch probe|
|mDegree|TP0, TP1 as encoder, A/B as quadrature counting|
|mDegree|TP0, TP1 as encoder, pulse (TP0) / direction (TP1), count up on direction high|
|mDegree|TP0, TP1 as encoder, pulse (TP0) / direction (TP1), count down on direction high|
|mDegree|TP0 pulse counter, TP1 pulse counter|
|mDegree|TP0 pulse counter, TP1 touch probe|
|mDegree|TP1 touch probe, TP0 pulse counter|
|mDegree|TP0 encoder counter, TP1 encoder counter|
|mDegree|TP0 encoder counter, TP1 touch probe|
|mDegree|TP0 touch probe, TP1 encoder counter|

Touch probe: Channel

|Unit|Description|
|---|---|
|ACTPOS (0)|Actual position in user units|
|ACTPOSINC (1)|Actual position in increments|
|MASTERPOS (2)|Master position in increments|
|ENCPOS_CH1 (3)|Encoder position Channel 1|
|ENCPOS_CH1_INC (4)|Encoder position Channel 1 in increments|
|ENCPOS_CH2 (5)|Encoder position Channel 2|
|ENCPOS_CH2_INC (6)|Encoder position Channel 2 in increments|

# 8 Motion profile

MOOG ID No.:CB40859-001 Date:11/2020 MSD ServoDrive - DeviceHelp 276

|ID|Index Name / Setting|Unit|Description|
|---|---|---|---|
|7|ENCPOS_CH3 (7)| |Encoder position Channel 3|
|8|ENCPOS_CH3_INC (8)| |Encoder position Channel 3 in increments|
|9|ENCPOS_CH4 (9)| |Encoder position Channel 4|
|10|ENCPOS_CH4_INC (10)| |Encoder position Channel 4 in increments|
|11|ACTPOS2 (11)| |Actual position of redundant encoder in user units|
|12|Sercos (12)| |Referred to Sercos profile parameters S-x-0426, S-x-0427|
|13|UserRefPos(13)| |Reference position in user units|
|14|MasterPosST(14)| |Master position (ECAM, EGEAR) singleturn, always steps|
|15|CommonMasterPos(15)| |Master position (ECAM, EGEAR) singleturn, always steps|
|16|CommonMasterPosST(15)| |Master position (ECAM, EGEAR) singleturn, always steps|
|1402|MPRO_TP_Channel| | |
|1402|MPRO_TP_Channel| | |
|1402|MPRO_TP_Channel| | |
|1404|MPRO_TP_Lines| |Touch probe: Lines @ pulse counter on channel x|
|1404|MPRO_TP_Lines| | |
|1404|MPRO_TP_Lines| | |

Image 8.71: “Synchronized motion” screen

There are various modes available in the “synchronization mode” drop-down menu (P 242[0] - MPRO_ECAM_SyncModMode):

- Off(0) = Synchronized motion off
- ECAM_iPlc(1) = Electronic cam plate via MSD PLC
- EGEAR_iPlc(2) = Electr. gear unit via MSD PLC
- ECAM_PARA(3) = Electronic camming via parameters
- EGEAR_PARA(4) = Electronic gearing via parameters

NOTE: For more information refer to the bus system User Manuals or the description of the MSD PLC.

# 8.11.1 Electronic cam plate

The other parameters are configured in separate screens that can be accessed with the corresponding buttons.

- Master configuration (see Section ""Master configuration"" on page 280)
- Electronic gearing (see Section ""Electronic gearing"" on page 283)
- Electronic camming (see Section ""Electronic cam plate"" on page 277)

P 1318[0] - MPRO_ECAM_ControlWord is the control word for “synchronized motion” (see Section ""Control word for synchronized motion"" on page 279).

P 1326[0] - MPRO_ECAM_StatusWord is the status word for “synchronized motion” (see Section ""Status word for synchronized motion"" on page 279).

# 8.11.1.1 Table selection

|ID|Index Name|Unit|Description|
|---|---|---|---|
|1300|MPRO_ECAM_CTS_| |ECAM: CamTableSelect - Master reference|
|1301|MasterRef| | |
|1305|MPRO_ECAM_CTS_| |ECAM: CamTableSelect - Method for changing the camtable|
|1306|MPRO_ECAM_CTS_| |ECAM: CamTableSelect - Mode for changing the camtable|
|1307|MPRO_ECAM_CTS_|incr|ECAM: CamTableSelect - Distance for changing the camtable|
|242|MPRO_ECAM_| |ECAM / EGEAR: Mode of synchronized motion SyncModMode|
|265|MPRO_ECAM_| |ECAM / EGEAR: Slave speed factor (1 = 100%).|
|266|CamSlave_SpeedFactor| | |
|268|MPRO_ECAM_| |ECAM / EGEAR: Mode of switching off sync. motion|

# 8.11.1.2 Synchronization

|ID|Index Name|Unit|Description|
|---|---|---|---|
|1342|MPRO_ECAM_CI_|incr|ECAM: CamIn - Synchronization position (multiturn part)|
|1343|MPRO_ECAM_CO_|incr|ECAM: CamOut - Decoupling pos. (multiturn part)|
|1303|MPRO_ECAM_CI_|incr|ECAM: CamIn - Master offset|
|1308|MPRO_ECAM_CI_| |ECAM: CamIn - Master reference|
|1309|MPRO_ECAM_CI_| |ECAM: CamIn - Slave reference|
|1310|MPRO_ECAM_CI_| |ECAM: CamIn - Coupling mode|
|1311|MPRO_ECAM_CI_|incr|ECAM: CamIn - Coupling distance|
|1312|MPRO_ECAM_CI_|incr|ECAM: CamIn - Synchronization position|

Table 8.31: “Electronic camming - Table selection” parameters

Table 8.30: “Synchronized motion” parameters

Table 8.32: “Electronic camming - Synchronization” parameters

MOOG ID No.:CB40859-001 Date:11/2020

MSD ServoDrive - DeviceHelp 277

# 8 Motion profile

MOOG ID No.:CB40859-001 Date:11/2020 MSD ServoDrive - DeviceHelp 278

|ID|Index|Name|Unit|Description|
|---|---|---|---|---|
|1313|0|MPRO_ECAM_CO_SyncPosST|(singleturn part)|ECAM: CamOut - Slave reference|
|1314|0|MPRO_ECAM_CO_DecouplingMode|63|ECAM: CamOut - Decoupling mode|
|1315|0|MPRO_ECAM_CO_BreakingPosST|incr|ECAM: CamOut - Decoupling position|
|1316|0|MPRO_ECAM_CO_DecouplingDist|incr|ECAM: CamOut - Decoupling distance|
|1317|0|MPRO_ECAM_CO_StandstillPos|mDegree|ECAM: CamOut - Slave standstill position|

# Table 8.32: “Electronic camming - Synchronization” parameters (continue)

|ID|Index|Name|Unit|Description|
|---|---|---|---|---|
|1346| |MPRO_ECAM_SP_Table| |ECAM: Setpoint table interface|
|1346|0|Index| |Index of setpoint table|
|1346|1|Value| |Value at index of setpoint table|
|1347|0 to 31|MPRO_ECAM_SP_Index| |ECAM: Setpoint segments start index|
|1348|0 to 31|MPRO_ECAM_SP_Length| |ECAM: Setpoint segments length|
|1349|0 to 31|Length| | |
|1350|0|MPRO_ECAM_SP_MaDist| |ECAM: Setpoint segments master distance|
|1351|0|MPRO_ECAM_SP_IpoType| |ECAM: Setpoint segments interpolation type|
|1352|0 to 31|Checksum| |ECAM: Setpoint table checksum|
|1353|0 to 31|GainNum| |ECAM: Setpoint segments gain numerator|
| | |GainDen| |ECAM: Setpoint segments gain denominator|

# Table 8.33: “Electronic camming - Table segments” parameters

|ID|Index|Name|Unit|Description|
|---|---|---|---|---|
|1329|0 to 63|MPRO_ECAM_SegData_IndexNext| |ECAM: Index of the following segment|
|1330|0 to 63|MPRO_ECAM_SegData_IndexPrev| |ECAM: Index of the previous segment|
|1331|0 to 63|MPRO_ECAM_SegData_ProfileMode| |ECAM: Profile mode of the current segment|
|1332|0 to 63|MPRO_ECAM_SegData_DistMaster| |ECAM: Length of the master section of the current segment|
|1333|0 to 63|MPRO_ECAM_SegData_DistSlave| |ECAM: Length of the slave section of the current segment|
|1334|0 to 63|MPRO_ECAM_SegData_Lambda| |ECAM: Lambda value of the current segment|
|1335|0 to 63|MPRO_ECAM_SegData_StatusWord| |ECAM: Status word of the current segment|
|1336|0 to 63|MPRO_ECAM_SegData_ControlWord| |ECAM: Control word of the current segment|

# 8.11.2 Control word for synchronized motion

|Bit|Function|PLC function|Bit number|Description|
|---|---|---|---|---|
|0-7|Start segment (8-bit value)|-|0-7|Actual segment (8-bit value)|
|8-15|Reserved|-| |Actual ECAM / EGEAR state machine state (4 Bit value)|
|16|Absolute (true) / relative (false) master relationship|-| |- 0: ECAM / EGEAR asynchronous
- 1: ECAM / EGEAR synchronous
|
|17|Absolute (true) / relative (false) master (CAM) relationship at cam in|-| |- 2: ECAM / EGEAR synchronizing
- 3: ECAM / EGEAR desynchronizing
|
|18|Absolute (true) / relative (false) slave (CAM) relationship at cam in|-| |- 4: ECAM / EGEAR active and waiting for going asynchronous
|
|19-23|Reserved|-| |- 5: ECAM / EGEAR inactive and waiting for going synchronous
|
|24|Change gear ratio of the electronic gear online|MCB_GearRatioChange| | |
|25|Disable master calculation|MCB_Cam_MasterEnable| | |
|26|Enable master calculation|MCB_Cam_MasterEnable| | |
|27|Select CAM table|MCB_CamTableSelect| | |
|28|Start Ecam|MCB_CamIn| | |
|29|Stop Ecam|MCB_CamOut| | |
|30|Start Egear|MCB_GearIn| | |
|31|Stop Egear|MCB_GearOut| | |

# 8.11.3 Status word for synchronized motion

|Bit|Function|PLC function|Bit number|Description|
|---|---|---|---|---|
|12-26|Reserved|-| | |
|27|ECAM / EGEAR is active|-| | |
|28|Valid segments chosen|-| | |
|29|Master data are valid|-| | |
|30|Master is initialized|-| | |
|31|Master calculation is active|-| | |

Table 8.35: Control word ECAM (P 1318[0] - MPRO_ECAM_ControlWord)

Table 8.36: ECAM status word (P 1326[0] - MPRO_ECAM_StatusWord)

MOOG ID No.:CB40859-001 Date:11/2020 MSD ServoDrive - DeviceHelp 279

# 8 Motion profile

# 8 Motion profile

MOOG ID No.:CB40859-001 Date:11/2020

MSD ServoDrive - DeviceHelp 280

# 8.11.4 Master configuration

the master encoder, you will need to set the resolution relative to a single motor revolution in P 250 - MPRO_ECAM_PARAMaster_Amplitude (see below).

- ENC CH1 (3) = Encoder channel 1 X7 (Sin/Cos)
- ENC CH2 (4) = Encoder channel 2 X6 (Resolver)
- ENC CH3 (5) = Encoder channel 3 X8 (optional)

This function is only available if an external interface X8 (option module) is present.

- TP0 (6) = Pulse counter on probe channel 0 (TP0)
- TP1 (7) = Pulse counter on probe channel 1 (TP1)
- ENC_CH4 (8) = Encoder channel 4 (p. e. fieldbus)
- TWIN_POS (9) = TWIN remote reference position (P-2607)

Image 8.72: “Master configuration” screen

# Channel selection (master encoder)

P 1319[0] - MPRO_ECAM_CamMaster_AxisType is used to define the master encoder.

- NO AXIS (0) = No axis
- VIRTUAL MASTER (1) = Virtual master

If you select this function, you will be able to configure additional settings by clicking on the enabled “Options...” button (see Section ""Virtual Master"" on page 286).

- PARA (2) = Master parameter interface

If you select this function because a higher-level controller is being used as

# Anti-reverse mode

Slave only starts moving along with it again as soon as the master reaches the zero position.

P 1320[0] - MPRO_ECAM_CamMaster_RevLockMode is used to define the reverse lock mode, which can be used either with or without path compensation. The dashed lines in the following diagrams indicate what the engagement distance is:

# Example:

If the master, which has moved two motor revolutions in the direction blocked for the slave, then moves in the unblocked direction again, the slave only moves off when the master has traversed the zero point.

- INACTIVE (0) = Reverse lock inactive
- ACTIVE (2) = Reverse lock enabled - without path optimization
- ACTIVE WAY COMP (1) = Reverse lock active - with way compensation

While the slave accelerates to the speed of the master during engagement, the master and slave do not move synchronously. This function needs to be selected in order to quickly catch up to the master that is running ahead.

# Example:

- Master (black line) rotates in the blocked direction
- The slave (blue line) remains stopped
- Master rotates in the unblocked direction again
- The slave follows the master directly in the unblocked direction

Assume the master has moved two motor revolutions in the direction for which the slave lock is enabled. If the master now moves in the direction for which there is no lock, the slave will immediately start running in that direction.

MOOG ID No.:CB40859-001 Date:11/2020

MSD ServoDrive - DeviceHelp 281

# 8 Motion profile

MOOG ID No.:CB40859-001 Date:11/2020 MSD ServoDrive - DeviceHelp 282

|Filter type|ID|Index Name|Unit|Description|
|---|---|---|---|---|
|When using a real master encoder, encoder signals may be subject to noise.|P 1340|1319|0|MPRO_ECAM_CamMaster_AxisType|
| | |MPRO_ECAM_CamMaster_SpeedFilTyp| |ECAM / EGEAR: Channel selection of internal master input|
| | |1320|0|MPRO_ECAM_CamMaster_RevLockMode|
| | |1321|0|MPRO_ECAM_CamMaster_Amplitude|
| | |1322|0|MPRO_ECAM_CamMaster_GearNum|
| | |1323|0|MPRO_ECAM_CamMaster_GearDen|
|Filter time|1327|0|ms|ECAM / EGEAR: Filter time constant of master|
|If P 1340[0] is used to enable a filter, P 1327[0] - MPRO_ECAM_CamMaster_SpeedTFil can be used to define the corresponding filter time.|1328|0|speed|ECAM / EGEAR: Speed factor of the internal master|
|Speed factor|1340|0| |MPRO_ECAM_CamMaster_SpeedFilTyp|
|The master encoder can be assigned an additional speed factor P 1328[0] - MPRO_ECAM_CamMaster_SpeedFactor.|1341|0|incr|ECAM / EGEAR: Master drive offset|

Table 8.37: “Synchronized motion - Master configuration” parameters (continue)

| | | |ID|Index Name|Unit|Description|
|---|---|---|---|---|---|---|
|247|0|MPRO_ECAM_ParaMaster_ActPos|incr|ECAM / EGEAR: Parameter interface master position| | |
|248|0|MPRO_ECAM_ParaMaster_ActSpeed|rpm|ECAM / EGEAR: Parameter interface master speed| | |
|249|0|MPRO_ECAM_ParaMaster_ActAcc|rpm|ECAM / EGEAR: Parameter interface master acceleration| | |
| |250|0|MPRO_ECAM_ParaMaster_Amplitude| |ECAM / EGEAR: Parameter interface master amplitude| |

Table 8.37: “Synchronized motion - Master configuration” parameters

# 8.11.5 Electronic gearing

# Gear ratio

The gear ratio is specified as a fraction. This ensures that the position references can be translated to the motor shaft with no rounding error.

- ""Slave"" (P 252[0] - MPRO_ECAM_Egear_GearNum) is the numerator
- ""Master"" (P 251[0] - MPRO_ECAM_Egear_GearDen) is the denominator

# Scaling of speed pre-control

Defined with P 265[0] - MPRO_ECAM_CamSlave_SpeedFactor definiert.

# Scaling of torque pre-control

Defined with P 266[0] - MPRO_ECAM_CamSlave_TorqueFactor.

# Engagement

See Section ""Engagement"" on page 284.

# Disengagement

See Section ""Disengagement"" on page 285.

|ID|Index Name|Unit|Description|
|---|---|---|---|
|251|0 MPRO_ECAM_Egear_GearDen| |EGEAR: Gear denominator|
|252|0 MPRO_ECAM_Egear_GearNum| |EGEAR: Numerator of gear ratio|
|1344|0 MPRO_ECAM_Egear_LimRefAcc|rpm/s|EGEAR: Acceleration limit for reference|
|1345|0 MPRO_ECAM_Egear_LimRefJerk|rpm/s²|EGEAR: Jerk limit for reference|

Table 8.38: “Synchronized motion - Electronic gearing” parameters

Image 8.73: ""Electronic gearing"" screen

MOOG ID No.:CB40859-001 Date:11/2020 MSD ServoDrive - DeviceHelp 283

# 8 Motion profile

# 8 Motion profile

MOOG ID No.:CB40859-001 Date:11/2020

MSD ServoDrive - DeviceHelp 284

# 8.11.6 Engagement

used to define the engagement distance (between the dashed lines).

P 253[0] - MPRO_ECAM_Egear_GearInMode is used to define the mode for engagement.

- DIRECT (0) = Direct
- Direct engagement: Angular synchronous; with jerking (no ramps).
- CROSSFADE (3) = Crossfading
- Engagement with crossfading function (5th degree polynomial): Angular synchronous; jerk-limited; speed will overshoot during engagement.
- RAMP (1) = Linear speed ramp
- Engagement with linear acceleration: Not angular synchronous; with jerking.
- FADE (2) = Engagement fade-out
- Engagement with fade-in function (5th degree polynomial): Not angular synchronous; jerk-limited. The position is ignored. ",What are the available modes in the 'synchronization mode' drop-down menu in the 'MSD ServoDrive - DeviceHelp' document?,A3,"The menu offers Off, electronic cam plate via PLC, electronic gear unit via PLC, and both via parameters.",2.375,2.4375,3.625,1.265625,0.66015625
23,msd_servo_drive.txt,76,b87ca5e232c2bdbb6fa16a8a401c6b5d285dc0183e73cc9d134de13dd2fc71d2,"MOOG ID No.:CB40859-001 Date:11/2020

MSD ServoDrive - DeviceHelp 267

# 8 Motion profile

MOOG ID No.:CB40859-001 Date:11/2020 MSD ServoDrive - DeviceHelp 268

# Deceleration

With ...

- P 194 - MPRO_TAB_TDec (for torque control) or
- P 197 - MPRO_TAB_SDec (for speed control) or
- P 200 - MPRO_TAB_PDec (for position control)

and indexes 0–15, the deceleration for each individual motion task can be defined. The input must not be zero.

# Wait time in Auto mode

P 204 - MPRO_TAB_WaitTime is used to define the wait time before the next motion task is carried out.

# Maximum table index in Auto mode

P 206[0] - MPRO_Tab_MaxIdx is used to define the table index up to which driving jobs will be carried out in one of the auto modes.

# Current table index

P 207[0] - MPRO_Tab_ActIdx will show the index for the motion task that is currently active. If parameter P 205 MPRO_TAB_Mode is set to “Para(0)”, a driving set can be entered and approached directly.

# Activation of reference table

The following procedures can be used in order to activate the setpoint table for operation.

|ID|Index Name|Unit|Description|
|---|---|---|---|
|193|MPRO_TAB_TAcc|TAB: Torque mode acceleration|Nm/ms|
|193|0|MPRO_TAB_TAcc|Nm/ms|
|193|1 - 15|MPRO_TAB_TAcc|Nm/ms|
|194|MPRO_TAB_TDec|TAB: Torque mode deceleration| |
|194|0|MPRO_TAB_TDec|Nm/ms|
|194|1 - 15|MPRO_TAB_TDec|Nm/ms|

# Table 8.23: Activation of table references

# Table 8.24: “Setpoint table settings” parameters

# Table 8.24: “Setpoint table settings” parameters (continue)

|ID|Index Name|Unit|Description|ID|Index Name|Unit|Description|
|---|---|---|---|---|---|---|---|
|195|MPRO_TAB_TRef|Nm|TAB: Torque mode reference value|208|MPRO_TAB_OutputNo| |OSD TAB: actual table index and target|
|195|MPRO_TAB_TRef|Nm| |208|MPRO_TAB_OutputNo| | |
|196|MPRO_TAB_SAcc|rev/min/s|TAB: Speed mode acceleration|269|MPRO_TAB_Ctrl| |TAB: control word|
|196|MPRO_TAB_SAcc|rev/min/s| | | | | |
|197|MPRO_TAB_SDec|rev/min/s|TAB: Speed mode deceleration| | | | |
|197|MPRO_TAB_SDec|rev/min/s| | | | | |
|198|MPRO_TAB_SRef|rev/min|TAB: Speed mode reference value| | | | |
|198|MPRO_TAB_SRef|rev/min| | | | | |
|199|MPRO_TAB_PAcc|rev/min/s|TAB: Position control mode acceleration| | | | |
|199|MPRO_TAB_PAcc|rev/min/s| | | | | |
|200|MPRO_TAB_PDec|rev/min/s|TAB: Position control mode Acceleration| | | | |
|200|MPRO_TAB_PDec|rev/min/s| | | | | |
|201|MPRO_TAB_PSpd|rev/min|TAB: Position control mode speed| | | | |
|201|MPRO_TAB_PSpd|rev/min| | | | | |
|202|MPRO_TAB_PPos|mDegree|TAB: Position control mode reference value| | | | |
|202|MPRO_TAB_PPos|mDegree| | | | | |
|203|MPRO_TAB_PMode| |Position control table:Mode| | | | |
|203|MPRO_TAB_PMode| | | | | | |
|204|MPRO_TAB_WaitTime|ms|TAB: Wait time| | | | |
|204|MPRO_TAB_WaitTime|ms| | | | | |
|205|MPRO_TAB_Mode| |TAB mode| | | | |
|206|MPRO_Tab_MaxIdx| |TAB: Max index in AUTO mode| | | | |
|207|MPRO_TAB_ActIdx| |TAB: Actual index| | | | |

MOOG ID No.:CB40859-001 Date:11/2020

MSD ServoDrive - DeviceHelp

# 8 Motion profile

MOOG ID No.:CB40859-001 Date:11/2020

MSD ServoDrive - DeviceHelp 270

# 8.8 Analog channel (ISA00 und ISA01)

# Offset (O)

This parameter (P 174 - MPRO_ANA0_SOffset for ISA00, P 184 - MPRO_ANA1_SOffset for ISA01) compensates for component variations and is used for offset compensation purposes. Depending on the control mode being used (see Section ""Basic settings"" on page 110), the value will be stored in parameter index [0] (torque control), [1] (speed control) or [2] (position control).

# Backlash (B)

This parameter (P 175 - MPRO_ANA0_SThreshold for ISA00, P 185 - MPRO_ANA1_SThreshold for ISA01) can suppress axis motion close to the standstill (stop) position. Depending on the control mode being used (see Section ""Basic settings"" on page 110), the value will be stored in parameter index [0] (torque control), [1] (speed control) or [2] (position control).

Image 8.68: “Analog channel” screen

# Acceleration ramp

Two standard analog inputs (ISA00, ISA01) are available. These inputs can be configured...

- with negative values for analog setpoint settings
- with positive values for digital setpoint processing

(P 109[0] - MPRO_INPUT_FS_ISA00 and P 110[0] - MPRO_INPUT_FS_ISA01).

see also section ""Analog Inputs"" on page 303. By using the ""REV(-2) = Analog setpoint"" setting, an analog input voltage of ±10 V can be processed as a setpoint.

# Deceleration ramp

This parameter serves as a deceleration ramp for torque control (P 176[1] - MPRO_ANA0_TRamp for ISA00, P 186[1] - MPRO_ANA1_TRamp for ISA01) or speed control (P 177[1] - MPRO_ANA0_SRamp for ISA00, P 187[1] - MPRO_ANA1_SRamp for ISA01). Depending on the control mode being used (see Section ""Basic settings"" on page 110), the value will be stored in parameter index [0] (torque control), [1] (speed control) or [2] (position control).

This parameter (P 173 - MPRO_ANA0_Scale for ISA00, P 183 - MPRO_ANA1_Scale for ISA01) is used to define which speed / which torque / which position corresponds to the maximum analog value. Depending on the control mode being used (see Section ""Basic settings"" on page 110), the value will be stored in parameter index [0] (torque control), [1] (speed control) or [2] (position control).

# 8.8.1 Special characteristics of position control mode

A threshold value can also be specified which generates a run-on range around the last reference value. A ramp function calculates a motion profile for the position reference from pre-defined acceleration and speed limits.

The position references on the analog channel are not applied immediately, but dependent on a digital input. Accordingly, one of the ISD00 to ISD06 digital inputs must be set to a value of ""REFANAEN(28) = Enable analog reference value"" (see Section ""Digital inputs"" on page 290). The position setpoint being received will only be applied if the corresponding digital input is active. The acceleration is entered using P 173[0] - MPRO_ANA0_TScale or P 183[0] - MPRO_ANA1_TScale.

# 8.8.2 Wire Break Monitoring

P 399 - CON_ANAWireBrk_Th can be used to configure wire break monitoring for the analog inputs. For details see Section ""Wire Break Monitoring"" on page 306.

|Function|TLIM (-4)|OVR (-3)|REFV (-2)|leer (-1)|OFF (0)|
|---|---|---|---|---|---|
|Digital|(1)-(28)|(1)-(28)|(1)-(28)|(1)-(28)|(1)-(28)|
|Analog channel|Filter|Scale|Offset|Profile|generator|

Control

Image 8.69: Reference processing structure

MOOG ID No.:CB40859-001 Date:11/2020

MSD ServoDrive - DeviceHelp 271

# 8 Motion profile

# 8 Motion profile

MOOG ID No.:CB40859-001 Date:11/2020

|ID|Index Name|Unit|Description|ID|
|---|---|---|---|---|
|395|CON_ANA_Isaf_Scaled| |Analog inputs: Values (filt, norm, comp, scaled)|174|
|395|0 ISA00| |Scaled, compensated, filtered, normalized value|175|
|395|1 ISA01| |Scaled, compensated, filtered, normalized value| |
|396|CON_ANA_Scale_ThUpper| |Analog inputs: Upper scaling limits|175|
|396|0 ISA00|%|Upper scaling (@ 10 V) threshold|175|
|396|1 ISA01|%|Upper scaling (@ 10 V) threshold| |
|397|CON_ANA_Scale_ThZero| |Analog inputs: Zero scaling thresholds|176|
|397|0 ISA00|V|Zero scaling threshold (+/-)|176|
|397|1 ISA01|V|Zero scaling threshold (+/-)| |
|398|CON_ANA_Scale_ThLower| |Analog inputs: Lower scaling limits|177|
|398|0 ISA00|%|Lower scaling (@ zero threshold) threshold|177|
|398|1 ISA01|%|Lower scaling (@ zero threshold) threshold| |
|399|CON_ANA_WireBrk_Th| |Analog inputs: Wire break thresholds|Table 8.26:|
|399|0 ISA00|V|Wire break detection threshold| |
|399|1 ISA01|V|Wire break detection threshold| |
|405|0 CON_ANA_Filt0|ms|Analog input ISA00: Filter time constant (PT 1)|ID|
|408|CON_ANA_Isaf_Norm| |Analog inputs: Values (filt, norm)|183|
|408|0 ISA00| |Filtered, normalized value|183|
|408|1 ISA01| |Filtered, normalized value|183|

Table 8.25: “Analog channel” parameters

|ID|Index Name|Unit|Description|ID|
|---|---|---|---|---|
|173|MPRO_ANA0_Scale| |ANA0: scale factors|184|
|173|0 MPRO_ANA0_TScale|Nm|ANA0: scale factor torque reference|185|
|173|1 MPRO_ANA0_SScale|rev/min|ANA0: scale factor speed reference|185|
|173|2 MPRO_ANA0_PScale|mDegree|ANA0: scale factor position reference| |
|174|MPRO_ANA0_Offset| |ANA0: offsets|185|
|174|0 MPRO_ANA0_TOffset|Nm|ANA0: offsets for torque reference|185|

Table 8.26: “Analog channel ISA00” parameters

|Index Name|Unit|Description|
|---|---|---|
|1 MPRO_ANA0_SOffset|rev/min|ANA0: offsets for speed reference|
|2 MPRO_ANA0_POffset|mDegree|ANA0: offsets for position reference|
|MPRO_ANA0_Threshold| |ANA0: thresholds|
|0 MPRO_ANA0_TThreshold|Nm|ANA0: threshold for torque reference|
|1 MPRO_ANA0_SThreshold|rev/min|ANA0: threshold for speed reference|
|2 MPRO_ANA0_PThreshold|mDegree|ANA0: threshold for position reference|
|MPRO_ANA0_TRamp| |ANA0: Torque mode acceleration [0] and deceleration [1]|
|0 MPRO_ANA0_TRamp|Nm/s| |
|1 MPRO_ANA0_TRamp|Nm/s| |
|MPRO_ANA0_SRamp| |ANA0: Speed mode acceleration [0] and deceleration [1]|
|0 MPRO_ANA0_SRamp|SPEED/s| |
|1 MPRO_ANA0_SRamp|SPEED/s| |

“Analog channel ISA00” parameters (continue)

|Index Name|Unit|Description|
|---|---|---|
|MPRO_ANA1_Scale| |ANA1: scale factors|
|0 MPRO_ANA1_TScale|Nm|ANA0: scale factor torque reference|
|1 MPRO_ANA1_SScale|rev/min|ANA0: scale factor speed reference|
|2 MPRO_ANA1_PScale|mDegree|ANA0: scale factor position reference|
|MPRO_ANA1_Offset| |ANA1: offsets|
|0 MPRO_ANA1_TOffset|Nm|ANA1: offsets for torque reference|
|1 MPRO_ANA1_SOffset|rev/min|ANA1: offsets for speed reference|
|2 MPRO_ANA1_POffset|mDegree|ANA1: offsets for position reference|
|MPRO_ANA1_Threshold| |ANA1: thresholds|
|0 MPRO_ANA1_TThreshold|Nm|ANA1: threshold for torque reference|
|1 MPRO_ANA1_SThreshold|rev/min|ANA1: threshold for speed reference|
|2 MPRO_ANA1_PThreshold|mDegree|ANA1: threshold for position reference|

“Analog channel ISA01” parameters

# 8 Motion profile

|ID|Index Name|Unit|Description|
|---|---|---|---|
|186|MPRO_ANA1_TRamp|Nm/s|ANA1: Torque mode acceleration [0] and deceleration[1]|
|186|MPRO_ANA1_TRamp|Nm/s| |
|187|MPRO_ANA1_SRamp|SPEED/s|ANA1: Speed mode acceleration [0] and deceleration [1]|
|187|MPRO_ANA1_SRamp|SPEED/s| |

# Table 8.27: “Analog channel ISA01” parameters (continue)

Display

- System state
- Initialization on device startup
- Not ready (DC link voltage possibly too low)
- Start inhibit (DC link voltage present, power stage off)
- Starting lockout
- Ready for start
- Control initialization: Auto commutation, flux build-up etc.

# Table 8.28: Central state machine according to CiA 402 device display

MOOG ID No.:CB40859-001 Date:11/2020

MSD ServoDrive - DeviceHelp 273

# 8 Motion profile

MOOG ID No.:CB40859-001 Date:11/2020

MSD ServoDrive - DeviceHelp 274

|Display|System state|power disabled|fault|
|---|---|---|---|
|Control enabled|0|Start|7|
| |fault reaction active|0|14|
|Quick stop active|1|not ready|8|
| |to switch on|1|17|
|Error reaction active|2|switch on|disabled|
| |2|7| |
|Error state (in this state the error is indicated directly on the display.)|3|ready to|switch on|
|Device is reset (display flashes)|power enabled|3|6|
| |10|12| |
|• Number [5.] flashes when “STO” (Safe Torque Off) input is active. Display goes out when STO inactive.| | | |
|• The dot on the display flashes when the power stage is active.| | | |

Table 8.28: Central state machine according to CiA 402 device display (continue)

NOTE

l The system states indicated on the display may differ from the states in the table depending on the drive profile setting.

Image 8.70: State machine diagram based on CANopen communications

⓪ to ① State number

1 to 17 State transition (No. 17: DC link voltage cut off)

Legend for “State machine diagram based on CANopen communications” figure

# 8.10 Touch probe

|ID|Index Name / Setting|
|---|---|
|241|0 MPRO_TP_Position|
|241|1 MPRO_TP_Position|
|241|2 MPRO_TP_Position|
|241|3 MPRO_TP_Position|
|241|4 MPRO_TP_Position|
|1400|0 MPRO_TP_Config|
| |TP_TP (0)|
| |AB (1)|
| |PD_UP (2)|
| |PD_DOWN (3)|
| |PC_PC (4)|
| |PC_TP (5)|
| |TP_PC (6)|
| |ENC_ENC (7)|
| |ENC_TP (8)|
| |TP_ENC (9)|

Using the touch probe inputs, touch probe functions can be performed. In order to be able to do this, P 106[0] - MPRO_INPUT_FS_ISD05 and P 107[0] - MPRO_INPUT_FS_ISD06 must be used to set digital inputs ISD05 and ISD06 to ""PROBE(15) = Touch probe (only ISD05/06)"" (see Section ""Digital inputs"" on page 290). HTL encoders can be evaluated or pulse counters implemented using the MSD PLC.

The touch probe can be triggered with P 240 - MPRO_TP_Ctrl. This enables triggering on a positive or negative edge, or on both edges, of the signal detected on the touch probe inputs. After the measurement, the parameter jumps back to the value ""NONE (0)"" and the latch position is mapped in the corresponding subindex of parameter P 241 - MPRO_TP_Position. A continuous touch probe mode is not possible at present, so the touch probe has to be reactivated after the measurement.

P 1402 - MPRO_TP_Channel can be used to select various positions as actual value sources of the latch position for the touch probe functionality. The following table provides an overview of the available settings. The counters are accessed via the MSD PLC or a bus system.

|ID|Index Name / Setting|Unit|Description|
|---|---|---|---|
|240|MPRO_TP_Ctrl|Touch probe: Control| |
| |0| |NONE (0) = No function|
| |1| |POS (1) = Positive edge|
| |2| |NEG (2) = Negative edge|
| |3| |BOTH (3) = Both edges|
|240|0 MPRO_TP_Ctrl| | |
|240|1 MPRO_TP_Ctrl| | |
|240|2 MPRO_TP_Ctrl| | |
|241|MPRO_TP_Position|Probe: Pos. high/low edge of TP0/1, encoder zero pulse| |

Table 8.29: “Touch probe” parameters

MOOG ID No.:CB40859-001 Date:11/2020

# 8 Motion profile

|Unit|Description|
|---|---|
|mDegree|Touch probe: Configuration|
|mDegree|TP0, TP1 touch probe|
|mDegree|TP0, TP1 as encoder, A/B as quadrature counting|
|mDegree|TP0, TP1 as encoder, pulse (TP0) / direction (TP1), count up on direction high|
|mDegree|TP0, TP1 as encoder, pulse (TP0) / direction (TP1), count down on direction high|
|mDegree|TP0 pulse counter, TP1 pulse counter|
|mDegree|TP0 pulse counter, TP1 touch probe|
|mDegree|TP1 touch probe, TP0 pulse counter|
|mDegree|TP0 encoder counter, TP1 encoder counter|
|mDegree|TP0 encoder counter, TP1 touch probe|
|mDegree|TP0 touch probe, TP1 encoder counter|

Touch probe: Channel

|Unit|Description|
|---|---|
|ACTPOS (0)|Actual position in user units|
|ACTPOSINC (1)|Actual position in increments|
|MASTERPOS (2)|Master position in increments|
|ENCPOS_CH1 (3)|Encoder position Channel 1|
|ENCPOS_CH1_INC (4)|Encoder position Channel 1 in increments|
|ENCPOS_CH2 (5)|Encoder position Channel 2|
|ENCPOS_CH2_INC (6)|Encoder position Channel 2 in increments|

# 8 Motion profile

MOOG ID No.:CB40859-001 Date:11/2020 MSD ServoDrive - DeviceHelp 276

|ID|Index Name / Setting|Unit|Description|
|---|---|---|---|
|7|ENCPOS_CH3 (7)| |Encoder position Channel 3|
|8|ENCPOS_CH3_INC (8)| |Encoder position Channel 3 in increments|
|9|ENCPOS_CH4 (9)| |Encoder position Channel 4|
|10|ENCPOS_CH4_INC (10)| |Encoder position Channel 4 in increments|
|11|ACTPOS2 (11)| |Actual position of redundant encoder in user units|
|12|Sercos (12)| |Referred to Sercos profile parameters S-x-0426, S-x-0427|
|13|UserRefPos(13)| |Reference position in user units|
|14|MasterPosST(14)| |Master position (ECAM, EGEAR) singleturn, always steps|
|15|CommonMasterPos(15)| |Master position (ECAM, EGEAR) singleturn, always steps|
|16|CommonMasterPosST(15)| |Master position (ECAM, EGEAR) singleturn, always steps|
|1402|MPRO_TP_Channel| | |
|1402|MPRO_TP_Channel| | |
|1402|MPRO_TP_Channel| | |
|1404|MPRO_TP_Lines| |Touch probe: Lines @ pulse counter on channel x|
|1404|MPRO_TP_Lines| | |
|1404|MPRO_TP_Lines| | |

Image 8.71: “Synchronized motion” screen

There are various modes available in the “synchronization mode” drop-down menu (P 242[0] - MPRO_ECAM_SyncModMode):

- Off(0) = Synchronized motion off
- ECAM_iPlc(1) = Electronic cam plate via MSD PLC
- EGEAR_iPlc(2) = Electr. gear unit via MSD PLC
- ECAM_PARA(3) = Electronic camming via parameters
- EGEAR_PARA(4) = Electronic gearing via parameters

NOTE: For more information refer to the bus system User Manuals or the description of the MSD PLC.

# 8.11.1 Electronic cam plate

The other parameters are configured in separate screens that can be accessed with the corresponding buttons.

- Master configuration (see Section ""Master configuration"" on page 280)
- Electronic gearing (see Section ""Electronic gearing"" on page 283)
- Electronic camming (see Section ""Electronic cam plate"" on page 277)

P 1318[0] - MPRO_ECAM_ControlWord is the control word for “synchronized motion” (see Section ""Control word for synchronized motion"" on page 279).

P 1326[0] - MPRO_ECAM_StatusWord is the status word for “synchronized motion” (see Section ""Status word for synchronized motion"" on page 279).

# 8.11.1.1 Table selection

|ID|Index Name|Unit|Description|
|---|---|---|---|
|1300|MPRO_ECAM_CTS_| |ECAM: CamTableSelect - Master reference|
|1301|MasterRef| | |
|1305|MPRO_ECAM_CTS_| |ECAM: CamTableSelect - Method for changing the camtable|
|1306|MPRO_ECAM_CTS_| |ECAM: CamTableSelect - Mode for changing the camtable|
|1307|MPRO_ECAM_CTS_|incr|ECAM: CamTableSelect - Distance for changing the camtable|
|242|MPRO_ECAM_| |ECAM / EGEAR: Mode of synchronized motion SyncModMode|
|265|MPRO_ECAM_| |ECAM / EGEAR: Slave speed factor (1 = 100%).|
|266|CamSlave_SpeedFactor| | |
|268|MPRO_ECAM_| |ECAM / EGEAR: Mode of switching off sync. motion|

# 8.11.1.2 Synchronization

|ID|Index Name|Unit|Description|
|---|---|---|---|
|1342|MPRO_ECAM_CI_|incr|ECAM: CamIn - Synchronization position (multiturn part)|
|1343|MPRO_ECAM_CO_|incr|ECAM: CamOut - Decoupling pos. (multiturn part)|
|1303|MPRO_ECAM_CI_|incr|ECAM: CamIn - Master offset|
|1308|MPRO_ECAM_CI_| |ECAM: CamIn - Master reference|
|1309|MPRO_ECAM_CI_| |ECAM: CamIn - Slave reference|
|1310|MPRO_ECAM_CI_| |ECAM: CamIn - Coupling mode|
|1311|MPRO_ECAM_CI_|incr|ECAM: CamIn - Coupling distance|
|1312|MPRO_ECAM_CI_|incr|ECAM: CamIn - Synchronization position|

Table 8.31: “Electronic camming - Table selection” parameters

Table 8.30: “Synchronized motion” parameters

Table 8.32: “Electronic camming - Synchronization” parameters

MOOG ID No.:CB40859-001 Date:11/2020

MSD ServoDrive - DeviceHelp 277

# 8 Motion profile

MOOG ID No.:CB40859-001 Date:11/2020 MSD ServoDrive - DeviceHelp 278

|ID|Index|Name|Unit|Description|
|---|---|---|---|---|
|1313|0|MPRO_ECAM_CO_SyncPosST|(singleturn part)|ECAM: CamOut - Slave reference|
|1314|0|MPRO_ECAM_CO_DecouplingMode|63|ECAM: CamOut - Decoupling mode|
|1315|0|MPRO_ECAM_CO_BreakingPosST|incr|ECAM: CamOut - Decoupling position|
|1316|0|MPRO_ECAM_CO_DecouplingDist|incr|ECAM: CamOut - Decoupling distance|
|1317|0|MPRO_ECAM_CO_StandstillPos|mDegree|ECAM: CamOut - Slave standstill position|

# Table 8.32: “Electronic camming - Synchronization” parameters (continue)

|ID|Index|Name|Unit|Description|
|---|---|---|---|---|
|1346| |MPRO_ECAM_SP_Table| |ECAM: Setpoint table interface|
|1346|0|Index| |Index of setpoint table|
|1346|1|Value| |Value at index of setpoint table|
|1347|0 to 31|MPRO_ECAM_SP_Index| |ECAM: Setpoint segments start index|
|1348|0 to 31|MPRO_ECAM_SP_Length| |ECAM: Setpoint segments length|
|1349|0 to 31|Length| | |
|1350|0|MPRO_ECAM_SP_MaDist| |ECAM: Setpoint segments master distance|
|1351|0|MPRO_ECAM_SP_IpoType| |ECAM: Setpoint segments interpolation type|
|1352|0 to 31|Checksum| |ECAM: Setpoint table checksum|
|1353|0 to 31|GainNum| |ECAM: Setpoint segments gain numerator|
| | |GainDen| |ECAM: Setpoint segments gain denominator|

# Table 8.33: “Electronic camming - Table segments” parameters

|ID|Index|Name|Unit|Description|
|---|---|---|---|---|
|1329|0 to 63|MPRO_ECAM_SegData_IndexNext| |ECAM: Index of the following segment|
|1330|0 to 63|MPRO_ECAM_SegData_IndexPrev| |ECAM: Index of the previous segment|
|1331|0 to 63|MPRO_ECAM_SegData_ProfileMode| |ECAM: Profile mode of the current segment|
|1332|0 to 63|MPRO_ECAM_SegData_DistMaster| |ECAM: Length of the master section of the current segment|
|1333|0 to 63|MPRO_ECAM_SegData_DistSlave| |ECAM: Length of the slave section of the current segment|
|1334|0 to 63|MPRO_ECAM_SegData_Lambda| |ECAM: Lambda value of the current segment|
|1335|0 to 63|MPRO_ECAM_SegData_StatusWord| |ECAM: Status word of the current segment|
|1336|0 to 63|MPRO_ECAM_SegData_ControlWord| |ECAM: Control word of the current segment|

# 8.11.2 Control word for synchronized motion

|Bit|Function|PLC function|Bit number|Description|
|---|---|---|---|---|
|0-7|Start segment (8-bit value)|-|0-7|Actual segment (8-bit value)|
|8-15|Reserved|-| |Actual ECAM / EGEAR state machine state (4 Bit value)|
|16|Absolute (true) / relative (false) master relationship|-| |- 0: ECAM / EGEAR asynchronous
- 1: ECAM / EGEAR synchronous
|
|17|Absolute (true) / relative (false) master (CAM) relationship at cam in|-| |- 2: ECAM / EGEAR synchronizing
- 3: ECAM / EGEAR desynchronizing
|
|18|Absolute (true) / relative (false) slave (CAM) relationship at cam in|-| |- 4: ECAM / EGEAR active and waiting for going asynchronous
|
|19-23|Reserved|-| |- 5: ECAM / EGEAR inactive and waiting for going synchronous
|
|24|Change gear ratio of the electronic gear online|MCB_GearRatioChange| | |
|25|Disable master calculation|MCB_Cam_MasterEnable| | |
|26|Enable master calculation|MCB_Cam_MasterEnable| | |
|27|Select CAM table|MCB_CamTableSelect| | |
|28|Start Ecam|MCB_CamIn| | |
|29|Stop Ecam|MCB_CamOut| | |
|30|Start Egear|MCB_GearIn| | |
|31|Stop Egear|MCB_GearOut| | |

# 8.11.3 Status word for synchronized motion

|Bit|Function|PLC function|Bit number|Description|
|---|---|---|---|---|
|12-26|Reserved|-| | |
|27|ECAM / EGEAR is active|-| | |
|28|Valid segments chosen|-| | |
|29|Master data are valid|-| | |
|30|Master is initialized|-| | |
|31|Master calculation is active|-| | |

Table 8.35: Control word ECAM (P 1318[0] - MPRO_ECAM_ControlWord)

Table 8.36: ECAM status word (P 1326[0] - MPRO_ECAM_StatusWord)

MOOG ID No.:CB40859-001 Date:11/2020 MSD ServoDrive - DeviceHelp 279

# 8 Motion profile

# 8 Motion profile

MOOG ID No.:CB40859-001 Date:11/2020

MSD ServoDrive - DeviceHelp 280

# 8.11.4 Master configuration

the master encoder, you will need to set the resolution relative to a single motor revolution in P 250 - MPRO_ECAM_PARAMaster_Amplitude (see below).

- ENC CH1 (3) = Encoder channel 1 X7 (Sin/Cos)
- ENC CH2 (4) = Encoder channel 2 X6 (Resolver)
- ENC CH3 (5) = Encoder channel 3 X8 (optional)

This function is only available if an external interface X8 (option module) is present.

- TP0 (6) = Pulse counter on probe channel 0 (TP0)
- TP1 (7) = Pulse counter on probe channel 1 (TP1)
- ENC_CH4 (8) = Encoder channel 4 (p. e. fieldbus)
- TWIN_POS (9) = TWIN remote reference position (P-2607)

Image 8.72: “Master configuration” screen

# Channel selection (master encoder)

P 1319[0] - MPRO_ECAM_CamMaster_AxisType is used to define the master encoder.

- NO AXIS (0) = No axis
- VIRTUAL MASTER (1) = Virtual master

If you select this function, you will be able to configure additional settings by clicking on the enabled “Options...” button (see Section ""Virtual Master"" on page 286).

- PARA (2) = Master parameter interface

If you select this function because a higher-level controller is being used as

# Anti-reverse mode

Slave only starts moving along with it again as soon as the master reaches the zero position.

P 1320[0] - MPRO_ECAM_CamMaster_RevLockMode is used to define the reverse lock mode, which can be used either with or without path compensation. The dashed lines in the following diagrams indicate what the engagement distance is:

# Example:

If the master, which has moved two motor revolutions in the direction blocked for the slave, then moves in the unblocked direction again, the slave only moves off when the master has traversed the zero point.

- INACTIVE (0) = Reverse lock inactive
- ACTIVE (2) = Reverse lock enabled - without path optimization
- ACTIVE WAY COMP (1) = Reverse lock active - with way compensation

While the slave accelerates to the speed of the master during engagement, the master and slave do not move synchronously. This function needs to be selected in order to quickly catch up to the master that is running ahead.

# Example:

- Master (black line) rotates in the blocked direction
- The slave (blue line) remains stopped
- Master rotates in the unblocked direction again
- The slave follows the master directly in the unblocked direction

Assume the master has moved two motor revolutions in the direction for which the slave lock is enabled. If the master now moves in the direction for which there is no lock, the slave will immediately start running in that direction.

MOOG ID No.:CB40859-001 Date:11/2020

MSD ServoDrive - DeviceHelp 281

# 8 Motion profile

MOOG ID No.:CB40859-001 Date:11/2020 MSD ServoDrive - DeviceHelp 282

|Filter type|ID|Index Name|Unit|Description|
|---|---|---|---|---|
|When using a real master encoder, encoder signals may be subject to noise.|P 1340|1319|0|MPRO_ECAM_CamMaster_AxisType|
| | |MPRO_ECAM_CamMaster_SpeedFilTyp| |ECAM / EGEAR: Channel selection of internal master input|
| | |1320|0|MPRO_ECAM_CamMaster_RevLockMode|
| | |1321|0|MPRO_ECAM_CamMaster_Amplitude|
| | |1322|0|MPRO_ECAM_CamMaster_GearNum|
| | |1323|0|MPRO_ECAM_CamMaster_GearDen|
|Filter time|1327|0|ms|ECAM / EGEAR: Filter time constant of master|
|If P 1340[0] is used to enable a filter, P 1327[0] - MPRO_ECAM_CamMaster_SpeedTFil can be used to define the corresponding filter time.|1328|0|speed|ECAM / EGEAR: Speed factor of the internal master|
|Speed factor|1340|0| |MPRO_ECAM_CamMaster_SpeedFilTyp|
|The master encoder can be assigned an additional speed factor P 1328[0] - MPRO_ECAM_CamMaster_SpeedFactor.|1341|0|incr|ECAM / EGEAR: Master drive offset|

Table 8.37: “Synchronized motion - Master configuration” parameters (continue)

| | | |ID|Index Name|Unit|Description|
|---|---|---|---|---|---|---|
|247|0|MPRO_ECAM_ParaMaster_ActPos|incr|ECAM / EGEAR: Parameter interface master position| | |
|248|0|MPRO_ECAM_ParaMaster_ActSpeed|rpm|ECAM / EGEAR: Parameter interface master speed| | |
|249|0|MPRO_ECAM_ParaMaster_ActAcc|rpm|ECAM / EGEAR: Parameter interface master acceleration| | |
| |250|0|MPRO_ECAM_ParaMaster_Amplitude| |ECAM / EGEAR: Parameter interface master amplitude| |

Table 8.37: “Synchronized motion - Master configuration” parameters

# 8.11.5 Electronic gearing

# Gear ratio

The gear ratio is specified as a fraction. This ensures that the position references can be translated to the motor shaft with no rounding error.

- ""Slave"" (P 252[0] - MPRO_ECAM_Egear_GearNum) is the numerator
- ""Master"" (P 251[0] - MPRO_ECAM_Egear_GearDen) is the denominator

# Scaling of speed pre-control

Defined with P 265[0] - MPRO_ECAM_CamSlave_SpeedFactor definiert.

# Scaling of torque pre-control

Defined with P 266[0] - MPRO_ECAM_CamSlave_TorqueFactor.

# Engagement

See Section ""Engagement"" on page 284.

# Disengagement

See Section ""Disengagement"" on page 285.

|ID|Index Name|Unit|Description|
|---|---|---|---|
|251|0 MPRO_ECAM_Egear_GearDen| |EGEAR: Gear denominator|
|252|0 MPRO_ECAM_Egear_GearNum| |EGEAR: Numerator of gear ratio|
|1344|0 MPRO_ECAM_Egear_LimRefAcc|rpm/s|EGEAR: Acceleration limit for reference|
|1345|0 MPRO_ECAM_Egear_LimRefJerk|rpm/s²|EGEAR: Jerk limit for reference|

Table 8.38: “Synchronized motion - Electronic gearing” parameters

Image 8.73: ""Electronic gearing"" screen

MOOG ID No.:CB40859-001 Date:11/2020 MSD ServoDrive - DeviceHelp 283

# 8 Motion profile

# 8 Motion profile

MOOG ID No.:CB40859-001 Date:11/2020

MSD ServoDrive - DeviceHelp 284

# 8.11.6 Engagement

used to define the engagement distance (between the dashed lines).

P 253[0] - MPRO_ECAM_Egear_GearInMode is used to define the mode for engagement.

- DIRECT (0) = Direct
- Direct engagement: Angular synchronous; with jerking (no ramps).
- CROSSFADE (3) = Crossfading
- Engagement with crossfading function (5th degree polynomial): Angular synchronous; jerk-limited; speed will overshoot during engagement.
- RAMP (1) = Linear speed ramp
- Engagement with linear acceleration: Not angular synchronous; with jerking.
- FADE (2) = Engagement fade-out
- Engagement with fade-in function (5th degree polynomial): Not angular synchronous; jerk-limited. The position is ignored. ",What are the available modes in the 'synchronization mode' drop-down menu in the 'MSD ServoDrive - DeviceHelp' document?,A4,"Options are Off, electronic camming/gearing via PLC or parameters.",1.4765625,1.328125,3.171875,1.203125,0.37890625
24,msd_servo_drive.txt,76,b87ca5e232c2bdbb6fa16a8a401c6b5d285dc0183e73cc9d134de13dd2fc71d2,"MOOG ID No.:CB40859-001 Date:11/2020

MSD ServoDrive - DeviceHelp 267

# 8 Motion profile

MOOG ID No.:CB40859-001 Date:11/2020 MSD ServoDrive - DeviceHelp 268

# Deceleration

With ...

- P 194 - MPRO_TAB_TDec (for torque control) or
- P 197 - MPRO_TAB_SDec (for speed control) or
- P 200 - MPRO_TAB_PDec (for position control)

and indexes 0–15, the deceleration for each individual motion task can be defined. The input must not be zero.

# Wait time in Auto mode

P 204 - MPRO_TAB_WaitTime is used to define the wait time before the next motion task is carried out.

# Maximum table index in Auto mode

P 206[0] - MPRO_Tab_MaxIdx is used to define the table index up to which driving jobs will be carried out in one of the auto modes.

# Current table index

P 207[0] - MPRO_Tab_ActIdx will show the index for the motion task that is currently active. If parameter P 205 MPRO_TAB_Mode is set to “Para(0)”, a driving set can be entered and approached directly.

# Activation of reference table

The following procedures can be used in order to activate the setpoint table for operation.

|ID|Index Name|Unit|Description|
|---|---|---|---|
|193|MPRO_TAB_TAcc|TAB: Torque mode acceleration|Nm/ms|
|193|0|MPRO_TAB_TAcc|Nm/ms|
|193|1 - 15|MPRO_TAB_TAcc|Nm/ms|
|194|MPRO_TAB_TDec|TAB: Torque mode deceleration| |
|194|0|MPRO_TAB_TDec|Nm/ms|
|194|1 - 15|MPRO_TAB_TDec|Nm/ms|

# Table 8.23: Activation of table references

# Table 8.24: “Setpoint table settings” parameters

# Table 8.24: “Setpoint table settings” parameters (continue)

|ID|Index Name|Unit|Description|ID|Index Name|Unit|Description|
|---|---|---|---|---|---|---|---|
|195|MPRO_TAB_TRef|Nm|TAB: Torque mode reference value|208|MPRO_TAB_OutputNo| |OSD TAB: actual table index and target|
|195|MPRO_TAB_TRef|Nm| |208|MPRO_TAB_OutputNo| | |
|196|MPRO_TAB_SAcc|rev/min/s|TAB: Speed mode acceleration|269|MPRO_TAB_Ctrl| |TAB: control word|
|196|MPRO_TAB_SAcc|rev/min/s| | | | | |
|197|MPRO_TAB_SDec|rev/min/s|TAB: Speed mode deceleration| | | | |
|197|MPRO_TAB_SDec|rev/min/s| | | | | |
|198|MPRO_TAB_SRef|rev/min|TAB: Speed mode reference value| | | | |
|198|MPRO_TAB_SRef|rev/min| | | | | |
|199|MPRO_TAB_PAcc|rev/min/s|TAB: Position control mode acceleration| | | | |
|199|MPRO_TAB_PAcc|rev/min/s| | | | | |
|200|MPRO_TAB_PDec|rev/min/s|TAB: Position control mode Acceleration| | | | |
|200|MPRO_TAB_PDec|rev/min/s| | | | | |
|201|MPRO_TAB_PSpd|rev/min|TAB: Position control mode speed| | | | |
|201|MPRO_TAB_PSpd|rev/min| | | | | |
|202|MPRO_TAB_PPos|mDegree|TAB: Position control mode reference value| | | | |
|202|MPRO_TAB_PPos|mDegree| | | | | |
|203|MPRO_TAB_PMode| |Position control table:Mode| | | | |
|203|MPRO_TAB_PMode| | | | | | |
|204|MPRO_TAB_WaitTime|ms|TAB: Wait time| | | | |
|204|MPRO_TAB_WaitTime|ms| | | | | |
|205|MPRO_TAB_Mode| |TAB mode| | | | |
|206|MPRO_Tab_MaxIdx| |TAB: Max index in AUTO mode| | | | |
|207|MPRO_TAB_ActIdx| |TAB: Actual index| | | | |

MOOG ID No.:CB40859-001 Date:11/2020

MSD ServoDrive - DeviceHelp

# 8 Motion profile

MOOG ID No.:CB40859-001 Date:11/2020

MSD ServoDrive - DeviceHelp 270

# 8.8 Analog channel (ISA00 und ISA01)

# Offset (O)

This parameter (P 174 - MPRO_ANA0_SOffset for ISA00, P 184 - MPRO_ANA1_SOffset for ISA01) compensates for component variations and is used for offset compensation purposes. Depending on the control mode being used (see Section ""Basic settings"" on page 110), the value will be stored in parameter index [0] (torque control), [1] (speed control) or [2] (position control).

# Backlash (B)

This parameter (P 175 - MPRO_ANA0_SThreshold for ISA00, P 185 - MPRO_ANA1_SThreshold for ISA01) can suppress axis motion close to the standstill (stop) position. Depending on the control mode being used (see Section ""Basic settings"" on page 110), the value will be stored in parameter index [0] (torque control), [1] (speed control) or [2] (position control).

Image 8.68: “Analog channel” screen

# Acceleration ramp

Two standard analog inputs (ISA00, ISA01) are available. These inputs can be configured...

- with negative values for analog setpoint settings
- with positive values for digital setpoint processing

(P 109[0] - MPRO_INPUT_FS_ISA00 and P 110[0] - MPRO_INPUT_FS_ISA01).

see also section ""Analog Inputs"" on page 303. By using the ""REV(-2) = Analog setpoint"" setting, an analog input voltage of ±10 V can be processed as a setpoint.

# Deceleration ramp

This parameter serves as a deceleration ramp for torque control (P 176[1] - MPRO_ANA0_TRamp for ISA00, P 186[1] - MPRO_ANA1_TRamp for ISA01) or speed control (P 177[1] - MPRO_ANA0_SRamp for ISA00, P 187[1] - MPRO_ANA1_SRamp for ISA01). Depending on the control mode being used (see Section ""Basic settings"" on page 110), the value will be stored in parameter index [0] (torque control), [1] (speed control) or [2] (position control).

This parameter (P 173 - MPRO_ANA0_Scale for ISA00, P 183 - MPRO_ANA1_Scale for ISA01) is used to define which speed / which torque / which position corresponds to the maximum analog value. Depending on the control mode being used (see Section ""Basic settings"" on page 110), the value will be stored in parameter index [0] (torque control), [1] (speed control) or [2] (position control).

# 8.8.1 Special characteristics of position control mode

A threshold value can also be specified which generates a run-on range around the last reference value. A ramp function calculates a motion profile for the position reference from pre-defined acceleration and speed limits.

The position references on the analog channel are not applied immediately, but dependent on a digital input. Accordingly, one of the ISD00 to ISD06 digital inputs must be set to a value of ""REFANAEN(28) = Enable analog reference value"" (see Section ""Digital inputs"" on page 290). The position setpoint being received will only be applied if the corresponding digital input is active. The acceleration is entered using P 173[0] - MPRO_ANA0_TScale or P 183[0] - MPRO_ANA1_TScale.

# 8.8.2 Wire Break Monitoring

P 399 - CON_ANAWireBrk_Th can be used to configure wire break monitoring for the analog inputs. For details see Section ""Wire Break Monitoring"" on page 306.

|Function|TLIM (-4)|OVR (-3)|REFV (-2)|leer (-1)|OFF (0)|
|---|---|---|---|---|---|
|Digital|(1)-(28)|(1)-(28)|(1)-(28)|(1)-(28)|(1)-(28)|
|Analog channel|Filter|Scale|Offset|Profile|generator|

Control

Image 8.69: Reference processing structure

MOOG ID No.:CB40859-001 Date:11/2020

MSD ServoDrive - DeviceHelp 271

# 8 Motion profile

# 8 Motion profile

MOOG ID No.:CB40859-001 Date:11/2020

|ID|Index Name|Unit|Description|ID|
|---|---|---|---|---|
|395|CON_ANA_Isaf_Scaled| |Analog inputs: Values (filt, norm, comp, scaled)|174|
|395|0 ISA00| |Scaled, compensated, filtered, normalized value|175|
|395|1 ISA01| |Scaled, compensated, filtered, normalized value| |
|396|CON_ANA_Scale_ThUpper| |Analog inputs: Upper scaling limits|175|
|396|0 ISA00|%|Upper scaling (@ 10 V) threshold|175|
|396|1 ISA01|%|Upper scaling (@ 10 V) threshold| |
|397|CON_ANA_Scale_ThZero| |Analog inputs: Zero scaling thresholds|176|
|397|0 ISA00|V|Zero scaling threshold (+/-)|176|
|397|1 ISA01|V|Zero scaling threshold (+/-)| |
|398|CON_ANA_Scale_ThLower| |Analog inputs: Lower scaling limits|177|
|398|0 ISA00|%|Lower scaling (@ zero threshold) threshold|177|
|398|1 ISA01|%|Lower scaling (@ zero threshold) threshold| |
|399|CON_ANA_WireBrk_Th| |Analog inputs: Wire break thresholds|Table 8.26:|
|399|0 ISA00|V|Wire break detection threshold| |
|399|1 ISA01|V|Wire break detection threshold| |
|405|0 CON_ANA_Filt0|ms|Analog input ISA00: Filter time constant (PT 1)|ID|
|408|CON_ANA_Isaf_Norm| |Analog inputs: Values (filt, norm)|183|
|408|0 ISA00| |Filtered, normalized value|183|
|408|1 ISA01| |Filtered, normalized value|183|

Table 8.25: “Analog channel” parameters

|ID|Index Name|Unit|Description|ID|
|---|---|---|---|---|
|173|MPRO_ANA0_Scale| |ANA0: scale factors|184|
|173|0 MPRO_ANA0_TScale|Nm|ANA0: scale factor torque reference|185|
|173|1 MPRO_ANA0_SScale|rev/min|ANA0: scale factor speed reference|185|
|173|2 MPRO_ANA0_PScale|mDegree|ANA0: scale factor position reference| |
|174|MPRO_ANA0_Offset| |ANA0: offsets|185|
|174|0 MPRO_ANA0_TOffset|Nm|ANA0: offsets for torque reference|185|

Table 8.26: “Analog channel ISA00” parameters

|Index Name|Unit|Description|
|---|---|---|
|1 MPRO_ANA0_SOffset|rev/min|ANA0: offsets for speed reference|
|2 MPRO_ANA0_POffset|mDegree|ANA0: offsets for position reference|
|MPRO_ANA0_Threshold| |ANA0: thresholds|
|0 MPRO_ANA0_TThreshold|Nm|ANA0: threshold for torque reference|
|1 MPRO_ANA0_SThreshold|rev/min|ANA0: threshold for speed reference|
|2 MPRO_ANA0_PThreshold|mDegree|ANA0: threshold for position reference|
|MPRO_ANA0_TRamp| |ANA0: Torque mode acceleration [0] and deceleration [1]|
|0 MPRO_ANA0_TRamp|Nm/s| |
|1 MPRO_ANA0_TRamp|Nm/s| |
|MPRO_ANA0_SRamp| |ANA0: Speed mode acceleration [0] and deceleration [1]|
|0 MPRO_ANA0_SRamp|SPEED/s| |
|1 MPRO_ANA0_SRamp|SPEED/s| |

“Analog channel ISA00” parameters (continue)

|Index Name|Unit|Description|
|---|---|---|
|MPRO_ANA1_Scale| |ANA1: scale factors|
|0 MPRO_ANA1_TScale|Nm|ANA0: scale factor torque reference|
|1 MPRO_ANA1_SScale|rev/min|ANA0: scale factor speed reference|
|2 MPRO_ANA1_PScale|mDegree|ANA0: scale factor position reference|
|MPRO_ANA1_Offset| |ANA1: offsets|
|0 MPRO_ANA1_TOffset|Nm|ANA1: offsets for torque reference|
|1 MPRO_ANA1_SOffset|rev/min|ANA1: offsets for speed reference|
|2 MPRO_ANA1_POffset|mDegree|ANA1: offsets for position reference|
|MPRO_ANA1_Threshold| |ANA1: thresholds|
|0 MPRO_ANA1_TThreshold|Nm|ANA1: threshold for torque reference|
|1 MPRO_ANA1_SThreshold|rev/min|ANA1: threshold for speed reference|
|2 MPRO_ANA1_PThreshold|mDegree|ANA1: threshold for position reference|

“Analog channel ISA01” parameters

# 8 Motion profile

|ID|Index Name|Unit|Description|
|---|---|---|---|
|186|MPRO_ANA1_TRamp|Nm/s|ANA1: Torque mode acceleration [0] and deceleration[1]|
|186|MPRO_ANA1_TRamp|Nm/s| |
|187|MPRO_ANA1_SRamp|SPEED/s|ANA1: Speed mode acceleration [0] and deceleration [1]|
|187|MPRO_ANA1_SRamp|SPEED/s| |

# Table 8.27: “Analog channel ISA01” parameters (continue)

Display

- System state
- Initialization on device startup
- Not ready (DC link voltage possibly too low)
- Start inhibit (DC link voltage present, power stage off)
- Starting lockout
- Ready for start
- Control initialization: Auto commutation, flux build-up etc.

# Table 8.28: Central state machine according to CiA 402 device display

MOOG ID No.:CB40859-001 Date:11/2020

MSD ServoDrive - DeviceHelp 273

# 8 Motion profile

MOOG ID No.:CB40859-001 Date:11/2020

MSD ServoDrive - DeviceHelp 274

|Display|System state|power disabled|fault|
|---|---|---|---|
|Control enabled|0|Start|7|
| |fault reaction active|0|14|
|Quick stop active|1|not ready|8|
| |to switch on|1|17|
|Error reaction active|2|switch on|disabled|
| |2|7| |
|Error state (in this state the error is indicated directly on the display.)|3|ready to|switch on|
|Device is reset (display flashes)|power enabled|3|6|
| |10|12| |
|• Number [5.] flashes when “STO” (Safe Torque Off) input is active. Display goes out when STO inactive.| | | |
|• The dot on the display flashes when the power stage is active.| | | |

Table 8.28: Central state machine according to CiA 402 device display (continue)

NOTE

l The system states indicated on the display may differ from the states in the table depending on the drive profile setting.

Image 8.70: State machine diagram based on CANopen communications

⓪ to ① State number

1 to 17 State transition (No. 17: DC link voltage cut off)

Legend for “State machine diagram based on CANopen communications” figure

# 8.10 Touch probe

|ID|Index Name / Setting|
|---|---|
|241|0 MPRO_TP_Position|
|241|1 MPRO_TP_Position|
|241|2 MPRO_TP_Position|
|241|3 MPRO_TP_Position|
|241|4 MPRO_TP_Position|
|1400|0 MPRO_TP_Config|
| |TP_TP (0)|
| |AB (1)|
| |PD_UP (2)|
| |PD_DOWN (3)|
| |PC_PC (4)|
| |PC_TP (5)|
| |TP_PC (6)|
| |ENC_ENC (7)|
| |ENC_TP (8)|
| |TP_ENC (9)|

Using the touch probe inputs, touch probe functions can be performed. In order to be able to do this, P 106[0] - MPRO_INPUT_FS_ISD05 and P 107[0] - MPRO_INPUT_FS_ISD06 must be used to set digital inputs ISD05 and ISD06 to ""PROBE(15) = Touch probe (only ISD05/06)"" (see Section ""Digital inputs"" on page 290). HTL encoders can be evaluated or pulse counters implemented using the MSD PLC.

The touch probe can be triggered with P 240 - MPRO_TP_Ctrl. This enables triggering on a positive or negative edge, or on both edges, of the signal detected on the touch probe inputs. After the measurement, the parameter jumps back to the value ""NONE (0)"" and the latch position is mapped in the corresponding subindex of parameter P 241 - MPRO_TP_Position. A continuous touch probe mode is not possible at present, so the touch probe has to be reactivated after the measurement.

P 1402 - MPRO_TP_Channel can be used to select various positions as actual value sources of the latch position for the touch probe functionality. The following table provides an overview of the available settings. The counters are accessed via the MSD PLC or a bus system.

|ID|Index Name / Setting|Unit|Description|
|---|---|---|---|
|240|MPRO_TP_Ctrl|Touch probe: Control| |
| |0| |NONE (0) = No function|
| |1| |POS (1) = Positive edge|
| |2| |NEG (2) = Negative edge|
| |3| |BOTH (3) = Both edges|
|240|0 MPRO_TP_Ctrl| | |
|240|1 MPRO_TP_Ctrl| | |
|240|2 MPRO_TP_Ctrl| | |
|241|MPRO_TP_Position|Probe: Pos. high/low edge of TP0/1, encoder zero pulse| |

Table 8.29: “Touch probe” parameters

MOOG ID No.:CB40859-001 Date:11/2020

# 8 Motion profile

|Unit|Description|
|---|---|
|mDegree|Touch probe: Configuration|
|mDegree|TP0, TP1 touch probe|
|mDegree|TP0, TP1 as encoder, A/B as quadrature counting|
|mDegree|TP0, TP1 as encoder, pulse (TP0) / direction (TP1), count up on direction high|
|mDegree|TP0, TP1 as encoder, pulse (TP0) / direction (TP1), count down on direction high|
|mDegree|TP0 pulse counter, TP1 pulse counter|
|mDegree|TP0 pulse counter, TP1 touch probe|
|mDegree|TP1 touch probe, TP0 pulse counter|
|mDegree|TP0 encoder counter, TP1 encoder counter|
|mDegree|TP0 encoder counter, TP1 touch probe|
|mDegree|TP0 touch probe, TP1 encoder counter|

Touch probe: Channel

|Unit|Description|
|---|---|
|ACTPOS (0)|Actual position in user units|
|ACTPOSINC (1)|Actual position in increments|
|MASTERPOS (2)|Master position in increments|
|ENCPOS_CH1 (3)|Encoder position Channel 1|
|ENCPOS_CH1_INC (4)|Encoder position Channel 1 in increments|
|ENCPOS_CH2 (5)|Encoder position Channel 2|
|ENCPOS_CH2_INC (6)|Encoder position Channel 2 in increments|

# 8 Motion profile

MOOG ID No.:CB40859-001 Date:11/2020 MSD ServoDrive - DeviceHelp 276

|ID|Index Name / Setting|Unit|Description|
|---|---|---|---|
|7|ENCPOS_CH3 (7)| |Encoder position Channel 3|
|8|ENCPOS_CH3_INC (8)| |Encoder position Channel 3 in increments|
|9|ENCPOS_CH4 (9)| |Encoder position Channel 4|
|10|ENCPOS_CH4_INC (10)| |Encoder position Channel 4 in increments|
|11|ACTPOS2 (11)| |Actual position of redundant encoder in user units|
|12|Sercos (12)| |Referred to Sercos profile parameters S-x-0426, S-x-0427|
|13|UserRefPos(13)| |Reference position in user units|
|14|MasterPosST(14)| |Master position (ECAM, EGEAR) singleturn, always steps|
|15|CommonMasterPos(15)| |Master position (ECAM, EGEAR) singleturn, always steps|
|16|CommonMasterPosST(15)| |Master position (ECAM, EGEAR) singleturn, always steps|
|1402|MPRO_TP_Channel| | |
|1402|MPRO_TP_Channel| | |
|1402|MPRO_TP_Channel| | |
|1404|MPRO_TP_Lines| |Touch probe: Lines @ pulse counter on channel x|
|1404|MPRO_TP_Lines| | |
|1404|MPRO_TP_Lines| | |

Image 8.71: “Synchronized motion” screen

There are various modes available in the “synchronization mode” drop-down menu (P 242[0] - MPRO_ECAM_SyncModMode):

- Off(0) = Synchronized motion off
- ECAM_iPlc(1) = Electronic cam plate via MSD PLC
- EGEAR_iPlc(2) = Electr. gear unit via MSD PLC
- ECAM_PARA(3) = Electronic camming via parameters
- EGEAR_PARA(4) = Electronic gearing via parameters

NOTE: For more information refer to the bus system User Manuals or the description of the MSD PLC.

# 8.11.1 Electronic cam plate

The other parameters are configured in separate screens that can be accessed with the corresponding buttons.

- Master configuration (see Section ""Master configuration"" on page 280)
- Electronic gearing (see Section ""Electronic gearing"" on page 283)
- Electronic camming (see Section ""Electronic cam plate"" on page 277)

P 1318[0] - MPRO_ECAM_ControlWord is the control word for “synchronized motion” (see Section ""Control word for synchronized motion"" on page 279).

P 1326[0] - MPRO_ECAM_StatusWord is the status word for “synchronized motion” (see Section ""Status word for synchronized motion"" on page 279).

# 8.11.1.1 Table selection

|ID|Index Name|Unit|Description|
|---|---|---|---|
|1300|MPRO_ECAM_CTS_| |ECAM: CamTableSelect - Master reference|
|1301|MasterRef| | |
|1305|MPRO_ECAM_CTS_| |ECAM: CamTableSelect - Method for changing the camtable|
|1306|MPRO_ECAM_CTS_| |ECAM: CamTableSelect - Mode for changing the camtable|
|1307|MPRO_ECAM_CTS_|incr|ECAM: CamTableSelect - Distance for changing the camtable|
|242|MPRO_ECAM_| |ECAM / EGEAR: Mode of synchronized motion SyncModMode|
|265|MPRO_ECAM_| |ECAM / EGEAR: Slave speed factor (1 = 100%).|
|266|CamSlave_SpeedFactor| | |
|268|MPRO_ECAM_| |ECAM / EGEAR: Mode of switching off sync. motion|

# 8.11.1.2 Synchronization

|ID|Index Name|Unit|Description|
|---|---|---|---|
|1342|MPRO_ECAM_CI_|incr|ECAM: CamIn - Synchronization position (multiturn part)|
|1343|MPRO_ECAM_CO_|incr|ECAM: CamOut - Decoupling pos. (multiturn part)|
|1303|MPRO_ECAM_CI_|incr|ECAM: CamIn - Master offset|
|1308|MPRO_ECAM_CI_| |ECAM: CamIn - Master reference|
|1309|MPRO_ECAM_CI_| |ECAM: CamIn - Slave reference|
|1310|MPRO_ECAM_CI_| |ECAM: CamIn - Coupling mode|
|1311|MPRO_ECAM_CI_|incr|ECAM: CamIn - Coupling distance|
|1312|MPRO_ECAM_CI_|incr|ECAM: CamIn - Synchronization position|

Table 8.31: “Electronic camming - Table selection” parameters

Table 8.30: “Synchronized motion” parameters

Table 8.32: “Electronic camming - Synchronization” parameters

MOOG ID No.:CB40859-001 Date:11/2020

MSD ServoDrive - DeviceHelp 277

# 8 Motion profile

MOOG ID No.:CB40859-001 Date:11/2020 MSD ServoDrive - DeviceHelp 278

|ID|Index|Name|Unit|Description|
|---|---|---|---|---|
|1313|0|MPRO_ECAM_CO_SyncPosST|(singleturn part)|ECAM: CamOut - Slave reference|
|1314|0|MPRO_ECAM_CO_DecouplingMode|63|ECAM: CamOut - Decoupling mode|
|1315|0|MPRO_ECAM_CO_BreakingPosST|incr|ECAM: CamOut - Decoupling position|
|1316|0|MPRO_ECAM_CO_DecouplingDist|incr|ECAM: CamOut - Decoupling distance|
|1317|0|MPRO_ECAM_CO_StandstillPos|mDegree|ECAM: CamOut - Slave standstill position|

# Table 8.32: “Electronic camming - Synchronization” parameters (continue)

|ID|Index|Name|Unit|Description|
|---|---|---|---|---|
|1346| |MPRO_ECAM_SP_Table| |ECAM: Setpoint table interface|
|1346|0|Index| |Index of setpoint table|
|1346|1|Value| |Value at index of setpoint table|
|1347|0 to 31|MPRO_ECAM_SP_Index| |ECAM: Setpoint segments start index|
|1348|0 to 31|MPRO_ECAM_SP_Length| |ECAM: Setpoint segments length|
|1349|0 to 31|Length| | |
|1350|0|MPRO_ECAM_SP_MaDist| |ECAM: Setpoint segments master distance|
|1351|0|MPRO_ECAM_SP_IpoType| |ECAM: Setpoint segments interpolation type|
|1352|0 to 31|Checksum| |ECAM: Setpoint table checksum|
|1353|0 to 31|GainNum| |ECAM: Setpoint segments gain numerator|
| | |GainDen| |ECAM: Setpoint segments gain denominator|

# Table 8.33: “Electronic camming - Table segments” parameters

|ID|Index|Name|Unit|Description|
|---|---|---|---|---|
|1329|0 to 63|MPRO_ECAM_SegData_IndexNext| |ECAM: Index of the following segment|
|1330|0 to 63|MPRO_ECAM_SegData_IndexPrev| |ECAM: Index of the previous segment|
|1331|0 to 63|MPRO_ECAM_SegData_ProfileMode| |ECAM: Profile mode of the current segment|
|1332|0 to 63|MPRO_ECAM_SegData_DistMaster| |ECAM: Length of the master section of the current segment|
|1333|0 to 63|MPRO_ECAM_SegData_DistSlave| |ECAM: Length of the slave section of the current segment|
|1334|0 to 63|MPRO_ECAM_SegData_Lambda| |ECAM: Lambda value of the current segment|
|1335|0 to 63|MPRO_ECAM_SegData_StatusWord| |ECAM: Status word of the current segment|
|1336|0 to 63|MPRO_ECAM_SegData_ControlWord| |ECAM: Control word of the current segment|

# 8.11.2 Control word for synchronized motion

|Bit|Function|PLC function|Bit number|Description|
|---|---|---|---|---|
|0-7|Start segment (8-bit value)|-|0-7|Actual segment (8-bit value)|
|8-15|Reserved|-| |Actual ECAM / EGEAR state machine state (4 Bit value)|
|16|Absolute (true) / relative (false) master relationship|-| |- 0: ECAM / EGEAR asynchronous
- 1: ECAM / EGEAR synchronous
|
|17|Absolute (true) / relative (false) master (CAM) relationship at cam in|-| |- 2: ECAM / EGEAR synchronizing
- 3: ECAM / EGEAR desynchronizing
|
|18|Absolute (true) / relative (false) slave (CAM) relationship at cam in|-| |- 4: ECAM / EGEAR active and waiting for going asynchronous
|
|19-23|Reserved|-| |- 5: ECAM / EGEAR inactive and waiting for going synchronous
|
|24|Change gear ratio of the electronic gear online|MCB_GearRatioChange| | |
|25|Disable master calculation|MCB_Cam_MasterEnable| | |
|26|Enable master calculation|MCB_Cam_MasterEnable| | |
|27|Select CAM table|MCB_CamTableSelect| | |
|28|Start Ecam|MCB_CamIn| | |
|29|Stop Ecam|MCB_CamOut| | |
|30|Start Egear|MCB_GearIn| | |
|31|Stop Egear|MCB_GearOut| | |

# 8.11.3 Status word for synchronized motion

|Bit|Function|PLC function|Bit number|Description|
|---|---|---|---|---|
|12-26|Reserved|-| | |
|27|ECAM / EGEAR is active|-| | |
|28|Valid segments chosen|-| | |
|29|Master data are valid|-| | |
|30|Master is initialized|-| | |
|31|Master calculation is active|-| | |

Table 8.35: Control word ECAM (P 1318[0] - MPRO_ECAM_ControlWord)

Table 8.36: ECAM status word (P 1326[0] - MPRO_ECAM_StatusWord)

MOOG ID No.:CB40859-001 Date:11/2020 MSD ServoDrive - DeviceHelp 279

# 8 Motion profile

# 8 Motion profile

MOOG ID No.:CB40859-001 Date:11/2020

MSD ServoDrive - DeviceHelp 280

# 8.11.4 Master configuration

the master encoder, you will need to set the resolution relative to a single motor revolution in P 250 - MPRO_ECAM_PARAMaster_Amplitude (see below).

- ENC CH1 (3) = Encoder channel 1 X7 (Sin/Cos)
- ENC CH2 (4) = Encoder channel 2 X6 (Resolver)
- ENC CH3 (5) = Encoder channel 3 X8 (optional)

This function is only available if an external interface X8 (option module) is present.

- TP0 (6) = Pulse counter on probe channel 0 (TP0)
- TP1 (7) = Pulse counter on probe channel 1 (TP1)
- ENC_CH4 (8) = Encoder channel 4 (p. e. fieldbus)
- TWIN_POS (9) = TWIN remote reference position (P-2607)

Image 8.72: “Master configuration” screen

# Channel selection (master encoder)

P 1319[0] - MPRO_ECAM_CamMaster_AxisType is used to define the master encoder.

- NO AXIS (0) = No axis
- VIRTUAL MASTER (1) = Virtual master

If you select this function, you will be able to configure additional settings by clicking on the enabled “Options...” button (see Section ""Virtual Master"" on page 286).

- PARA (2) = Master parameter interface

If you select this function because a higher-level controller is being used as

# Anti-reverse mode

Slave only starts moving along with it again as soon as the master reaches the zero position.

P 1320[0] - MPRO_ECAM_CamMaster_RevLockMode is used to define the reverse lock mode, which can be used either with or without path compensation. The dashed lines in the following diagrams indicate what the engagement distance is:

# Example:

If the master, which has moved two motor revolutions in the direction blocked for the slave, then moves in the unblocked direction again, the slave only moves off when the master has traversed the zero point.

- INACTIVE (0) = Reverse lock inactive
- ACTIVE (2) = Reverse lock enabled - without path optimization
- ACTIVE WAY COMP (1) = Reverse lock active - with way compensation

While the slave accelerates to the speed of the master during engagement, the master and slave do not move synchronously. This function needs to be selected in order to quickly catch up to the master that is running ahead.

# Example:

- Master (black line) rotates in the blocked direction
- The slave (blue line) remains stopped
- Master rotates in the unblocked direction again
- The slave follows the master directly in the unblocked direction

Assume the master has moved two motor revolutions in the direction for which the slave lock is enabled. If the master now moves in the direction for which there is no lock, the slave will immediately start running in that direction.

MOOG ID No.:CB40859-001 Date:11/2020

MSD ServoDrive - DeviceHelp 281

# 8 Motion profile

MOOG ID No.:CB40859-001 Date:11/2020 MSD ServoDrive - DeviceHelp 282

|Filter type|ID|Index Name|Unit|Description|
|---|---|---|---|---|
|When using a real master encoder, encoder signals may be subject to noise.|P 1340|1319|0|MPRO_ECAM_CamMaster_AxisType|
| | |MPRO_ECAM_CamMaster_SpeedFilTyp| |ECAM / EGEAR: Channel selection of internal master input|
| | |1320|0|MPRO_ECAM_CamMaster_RevLockMode|
| | |1321|0|MPRO_ECAM_CamMaster_Amplitude|
| | |1322|0|MPRO_ECAM_CamMaster_GearNum|
| | |1323|0|MPRO_ECAM_CamMaster_GearDen|
|Filter time|1327|0|ms|ECAM / EGEAR: Filter time constant of master|
|If P 1340[0] is used to enable a filter, P 1327[0] - MPRO_ECAM_CamMaster_SpeedTFil can be used to define the corresponding filter time.|1328|0|speed|ECAM / EGEAR: Speed factor of the internal master|
|Speed factor|1340|0| |MPRO_ECAM_CamMaster_SpeedFilTyp|
|The master encoder can be assigned an additional speed factor P 1328[0] - MPRO_ECAM_CamMaster_SpeedFactor.|1341|0|incr|ECAM / EGEAR: Master drive offset|

Table 8.37: “Synchronized motion - Master configuration” parameters (continue)

| | | |ID|Index Name|Unit|Description|
|---|---|---|---|---|---|---|
|247|0|MPRO_ECAM_ParaMaster_ActPos|incr|ECAM / EGEAR: Parameter interface master position| | |
|248|0|MPRO_ECAM_ParaMaster_ActSpeed|rpm|ECAM / EGEAR: Parameter interface master speed| | |
|249|0|MPRO_ECAM_ParaMaster_ActAcc|rpm|ECAM / EGEAR: Parameter interface master acceleration| | |
| |250|0|MPRO_ECAM_ParaMaster_Amplitude| |ECAM / EGEAR: Parameter interface master amplitude| |

Table 8.37: “Synchronized motion - Master configuration” parameters

# 8.11.5 Electronic gearing

# Gear ratio

The gear ratio is specified as a fraction. This ensures that the position references can be translated to the motor shaft with no rounding error.

- ""Slave"" (P 252[0] - MPRO_ECAM_Egear_GearNum) is the numerator
- ""Master"" (P 251[0] - MPRO_ECAM_Egear_GearDen) is the denominator

# Scaling of speed pre-control

Defined with P 265[0] - MPRO_ECAM_CamSlave_SpeedFactor definiert.

# Scaling of torque pre-control

Defined with P 266[0] - MPRO_ECAM_CamSlave_TorqueFactor.

# Engagement

See Section ""Engagement"" on page 284.

# Disengagement

See Section ""Disengagement"" on page 285.

|ID|Index Name|Unit|Description|
|---|---|---|---|
|251|0 MPRO_ECAM_Egear_GearDen| |EGEAR: Gear denominator|
|252|0 MPRO_ECAM_Egear_GearNum| |EGEAR: Numerator of gear ratio|
|1344|0 MPRO_ECAM_Egear_LimRefAcc|rpm/s|EGEAR: Acceleration limit for reference|
|1345|0 MPRO_ECAM_Egear_LimRefJerk|rpm/s²|EGEAR: Jerk limit for reference|

Table 8.38: “Synchronized motion - Electronic gearing” parameters

Image 8.73: ""Electronic gearing"" screen

MOOG ID No.:CB40859-001 Date:11/2020 MSD ServoDrive - DeviceHelp 283

# 8 Motion profile

# 8 Motion profile

MOOG ID No.:CB40859-001 Date:11/2020

MSD ServoDrive - DeviceHelp 284

# 8.11.6 Engagement

used to define the engagement distance (between the dashed lines).

P 253[0] - MPRO_ECAM_Egear_GearInMode is used to define the mode for engagement.

- DIRECT (0) = Direct
- Direct engagement: Angular synchronous; with jerking (no ramps).
- CROSSFADE (3) = Crossfading
- Engagement with crossfading function (5th degree polynomial): Angular synchronous; jerk-limited; speed will overshoot during engagement.
- RAMP (1) = Linear speed ramp
- Engagement with linear acceleration: Not angular synchronous; with jerking.
- FADE (2) = Engagement fade-out
- Engagement with fade-in function (5th degree polynomial): Not angular synchronous; jerk-limited. The position is ignored. ",What are the available modes in the 'synchronization mode' drop-down menu in the 'MSD ServoDrive - DeviceHelp' document?,A5,Synchronization modes range from Off to electronic camming and gearing via PLC or parameters.,1.6171875,1.75,3.296875,1.359375,0.5
25,msd_servo_drive.txt,76,b87ca5e232c2bdbb6fa16a8a401c6b5d285dc0183e73cc9d134de13dd2fc71d2,"MOOG ID No.:CB40859-001 Date:11/2020

MSD ServoDrive - DeviceHelp 267

# 8 Motion profile

MOOG ID No.:CB40859-001 Date:11/2020 MSD ServoDrive - DeviceHelp 268

# Deceleration

With ...

- P 194 - MPRO_TAB_TDec (for torque control) or
- P 197 - MPRO_TAB_SDec (for speed control) or
- P 200 - MPRO_TAB_PDec (for position control)

and indexes 0–15, the deceleration for each individual motion task can be defined. The input must not be zero.

# Wait time in Auto mode

P 204 - MPRO_TAB_WaitTime is used to define the wait time before the next motion task is carried out.

# Maximum table index in Auto mode

P 206[0] - MPRO_Tab_MaxIdx is used to define the table index up to which driving jobs will be carried out in one of the auto modes.

# Current table index

P 207[0] - MPRO_Tab_ActIdx will show the index for the motion task that is currently active. If parameter P 205 MPRO_TAB_Mode is set to “Para(0)”, a driving set can be entered and approached directly.

# Activation of reference table

The following procedures can be used in order to activate the setpoint table for operation.

|ID|Index Name|Unit|Description|
|---|---|---|---|
|193|MPRO_TAB_TAcc|TAB: Torque mode acceleration|Nm/ms|
|193|0|MPRO_TAB_TAcc|Nm/ms|
|193|1 - 15|MPRO_TAB_TAcc|Nm/ms|
|194|MPRO_TAB_TDec|TAB: Torque mode deceleration| |
|194|0|MPRO_TAB_TDec|Nm/ms|
|194|1 - 15|MPRO_TAB_TDec|Nm/ms|

# Table 8.23: Activation of table references

# Table 8.24: “Setpoint table settings” parameters

# Table 8.24: “Setpoint table settings” parameters (continue)

|ID|Index Name|Unit|Description|ID|Index Name|Unit|Description|
|---|---|---|---|---|---|---|---|
|195|MPRO_TAB_TRef|Nm|TAB: Torque mode reference value|208|MPRO_TAB_OutputNo| |OSD TAB: actual table index and target|
|195|MPRO_TAB_TRef|Nm| |208|MPRO_TAB_OutputNo| | |
|196|MPRO_TAB_SAcc|rev/min/s|TAB: Speed mode acceleration|269|MPRO_TAB_Ctrl| |TAB: control word|
|196|MPRO_TAB_SAcc|rev/min/s| | | | | |
|197|MPRO_TAB_SDec|rev/min/s|TAB: Speed mode deceleration| | | | |
|197|MPRO_TAB_SDec|rev/min/s| | | | | |
|198|MPRO_TAB_SRef|rev/min|TAB: Speed mode reference value| | | | |
|198|MPRO_TAB_SRef|rev/min| | | | | |
|199|MPRO_TAB_PAcc|rev/min/s|TAB: Position control mode acceleration| | | | |
|199|MPRO_TAB_PAcc|rev/min/s| | | | | |
|200|MPRO_TAB_PDec|rev/min/s|TAB: Position control mode Acceleration| | | | |
|200|MPRO_TAB_PDec|rev/min/s| | | | | |
|201|MPRO_TAB_PSpd|rev/min|TAB: Position control mode speed| | | | |
|201|MPRO_TAB_PSpd|rev/min| | | | | |
|202|MPRO_TAB_PPos|mDegree|TAB: Position control mode reference value| | | | |
|202|MPRO_TAB_PPos|mDegree| | | | | |
|203|MPRO_TAB_PMode| |Position control table:Mode| | | | |
|203|MPRO_TAB_PMode| | | | | | |
|204|MPRO_TAB_WaitTime|ms|TAB: Wait time| | | | |
|204|MPRO_TAB_WaitTime|ms| | | | | |
|205|MPRO_TAB_Mode| |TAB mode| | | | |
|206|MPRO_Tab_MaxIdx| |TAB: Max index in AUTO mode| | | | |
|207|MPRO_TAB_ActIdx| |TAB: Actual index| | | | |

MOOG ID No.:CB40859-001 Date:11/2020

MSD ServoDrive - DeviceHelp

# 8 Motion profile

MOOG ID No.:CB40859-001 Date:11/2020

MSD ServoDrive - DeviceHelp 270

# 8.8 Analog channel (ISA00 und ISA01)

# Offset (O)

This parameter (P 174 - MPRO_ANA0_SOffset for ISA00, P 184 - MPRO_ANA1_SOffset for ISA01) compensates for component variations and is used for offset compensation purposes. Depending on the control mode being used (see Section ""Basic settings"" on page 110), the value will be stored in parameter index [0] (torque control), [1] (speed control) or [2] (position control).

# Backlash (B)

This parameter (P 175 - MPRO_ANA0_SThreshold for ISA00, P 185 - MPRO_ANA1_SThreshold for ISA01) can suppress axis motion close to the standstill (stop) position. Depending on the control mode being used (see Section ""Basic settings"" on page 110), the value will be stored in parameter index [0] (torque control), [1] (speed control) or [2] (position control).

Image 8.68: “Analog channel” screen

# Acceleration ramp

Two standard analog inputs (ISA00, ISA01) are available. These inputs can be configured...

- with negative values for analog setpoint settings
- with positive values for digital setpoint processing

(P 109[0] - MPRO_INPUT_FS_ISA00 and P 110[0] - MPRO_INPUT_FS_ISA01).

see also section ""Analog Inputs"" on page 303. By using the ""REV(-2) = Analog setpoint"" setting, an analog input voltage of ±10 V can be processed as a setpoint.

# Deceleration ramp

This parameter serves as a deceleration ramp for torque control (P 176[1] - MPRO_ANA0_TRamp for ISA00, P 186[1] - MPRO_ANA1_TRamp for ISA01) or speed control (P 177[1] - MPRO_ANA0_SRamp for ISA00, P 187[1] - MPRO_ANA1_SRamp for ISA01). Depending on the control mode being used (see Section ""Basic settings"" on page 110), the value will be stored in parameter index [0] (torque control), [1] (speed control) or [2] (position control).

This parameter (P 173 - MPRO_ANA0_Scale for ISA00, P 183 - MPRO_ANA1_Scale for ISA01) is used to define which speed / which torque / which position corresponds to the maximum analog value. Depending on the control mode being used (see Section ""Basic settings"" on page 110), the value will be stored in parameter index [0] (torque control), [1] (speed control) or [2] (position control).

# 8.8.1 Special characteristics of position control mode

A threshold value can also be specified which generates a run-on range around the last reference value. A ramp function calculates a motion profile for the position reference from pre-defined acceleration and speed limits.

The position references on the analog channel are not applied immediately, but dependent on a digital input. Accordingly, one of the ISD00 to ISD06 digital inputs must be set to a value of ""REFANAEN(28) = Enable analog reference value"" (see Section ""Digital inputs"" on page 290). The position setpoint being received will only be applied if the corresponding digital input is active. The acceleration is entered using P 173[0] - MPRO_ANA0_TScale or P 183[0] - MPRO_ANA1_TScale.

# 8.8.2 Wire Break Monitoring

P 399 - CON_ANAWireBrk_Th can be used to configure wire break monitoring for the analog inputs. For details see Section ""Wire Break Monitoring"" on page 306.

|Function|TLIM (-4)|OVR (-3)|REFV (-2)|leer (-1)|OFF (0)|
|---|---|---|---|---|---|
|Digital|(1)-(28)|(1)-(28)|(1)-(28)|(1)-(28)|(1)-(28)|
|Analog channel|Filter|Scale|Offset|Profile|generator|

Control

Image 8.69: Reference processing structure

MOOG ID No.:CB40859-001 Date:11/2020

MSD ServoDrive - DeviceHelp 271

# 8 Motion profile

# 8 Motion profile

MOOG ID No.:CB40859-001 Date:11/2020

|ID|Index Name|Unit|Description|ID|
|---|---|---|---|---|
|395|CON_ANA_Isaf_Scaled| |Analog inputs: Values (filt, norm, comp, scaled)|174|
|395|0 ISA00| |Scaled, compensated, filtered, normalized value|175|
|395|1 ISA01| |Scaled, compensated, filtered, normalized value| |
|396|CON_ANA_Scale_ThUpper| |Analog inputs: Upper scaling limits|175|
|396|0 ISA00|%|Upper scaling (@ 10 V) threshold|175|
|396|1 ISA01|%|Upper scaling (@ 10 V) threshold| |
|397|CON_ANA_Scale_ThZero| |Analog inputs: Zero scaling thresholds|176|
|397|0 ISA00|V|Zero scaling threshold (+/-)|176|
|397|1 ISA01|V|Zero scaling threshold (+/-)| |
|398|CON_ANA_Scale_ThLower| |Analog inputs: Lower scaling limits|177|
|398|0 ISA00|%|Lower scaling (@ zero threshold) threshold|177|
|398|1 ISA01|%|Lower scaling (@ zero threshold) threshold| |
|399|CON_ANA_WireBrk_Th| |Analog inputs: Wire break thresholds|Table 8.26:|
|399|0 ISA00|V|Wire break detection threshold| |
|399|1 ISA01|V|Wire break detection threshold| |
|405|0 CON_ANA_Filt0|ms|Analog input ISA00: Filter time constant (PT 1)|ID|
|408|CON_ANA_Isaf_Norm| |Analog inputs: Values (filt, norm)|183|
|408|0 ISA00| |Filtered, normalized value|183|
|408|1 ISA01| |Filtered, normalized value|183|

Table 8.25: “Analog channel” parameters

|ID|Index Name|Unit|Description|ID|
|---|---|---|---|---|
|173|MPRO_ANA0_Scale| |ANA0: scale factors|184|
|173|0 MPRO_ANA0_TScale|Nm|ANA0: scale factor torque reference|185|
|173|1 MPRO_ANA0_SScale|rev/min|ANA0: scale factor speed reference|185|
|173|2 MPRO_ANA0_PScale|mDegree|ANA0: scale factor position reference| |
|174|MPRO_ANA0_Offset| |ANA0: offsets|185|
|174|0 MPRO_ANA0_TOffset|Nm|ANA0: offsets for torque reference|185|

Table 8.26: “Analog channel ISA00” parameters

|Index Name|Unit|Description|
|---|---|---|
|1 MPRO_ANA0_SOffset|rev/min|ANA0: offsets for speed reference|
|2 MPRO_ANA0_POffset|mDegree|ANA0: offsets for position reference|
|MPRO_ANA0_Threshold| |ANA0: thresholds|
|0 MPRO_ANA0_TThreshold|Nm|ANA0: threshold for torque reference|
|1 MPRO_ANA0_SThreshold|rev/min|ANA0: threshold for speed reference|
|2 MPRO_ANA0_PThreshold|mDegree|ANA0: threshold for position reference|
|MPRO_ANA0_TRamp| |ANA0: Torque mode acceleration [0] and deceleration [1]|
|0 MPRO_ANA0_TRamp|Nm/s| |
|1 MPRO_ANA0_TRamp|Nm/s| |
|MPRO_ANA0_SRamp| |ANA0: Speed mode acceleration [0] and deceleration [1]|
|0 MPRO_ANA0_SRamp|SPEED/s| |
|1 MPRO_ANA0_SRamp|SPEED/s| |

“Analog channel ISA00” parameters (continue)

|Index Name|Unit|Description|
|---|---|---|
|MPRO_ANA1_Scale| |ANA1: scale factors|
|0 MPRO_ANA1_TScale|Nm|ANA0: scale factor torque reference|
|1 MPRO_ANA1_SScale|rev/min|ANA0: scale factor speed reference|
|2 MPRO_ANA1_PScale|mDegree|ANA0: scale factor position reference|
|MPRO_ANA1_Offset| |ANA1: offsets|
|0 MPRO_ANA1_TOffset|Nm|ANA1: offsets for torque reference|
|1 MPRO_ANA1_SOffset|rev/min|ANA1: offsets for speed reference|
|2 MPRO_ANA1_POffset|mDegree|ANA1: offsets for position reference|
|MPRO_ANA1_Threshold| |ANA1: thresholds|
|0 MPRO_ANA1_TThreshold|Nm|ANA1: threshold for torque reference|
|1 MPRO_ANA1_SThreshold|rev/min|ANA1: threshold for speed reference|
|2 MPRO_ANA1_PThreshold|mDegree|ANA1: threshold for position reference|

“Analog channel ISA01” parameters

# 8 Motion profile

|ID|Index Name|Unit|Description|
|---|---|---|---|
|186|MPRO_ANA1_TRamp|Nm/s|ANA1: Torque mode acceleration [0] and deceleration[1]|
|186|MPRO_ANA1_TRamp|Nm/s| |
|187|MPRO_ANA1_SRamp|SPEED/s|ANA1: Speed mode acceleration [0] and deceleration [1]|
|187|MPRO_ANA1_SRamp|SPEED/s| |

# Table 8.27: “Analog channel ISA01” parameters (continue)

Display

- System state
- Initialization on device startup
- Not ready (DC link voltage possibly too low)
- Start inhibit (DC link voltage present, power stage off)
- Starting lockout
- Ready for start
- Control initialization: Auto commutation, flux build-up etc.

# Table 8.28: Central state machine according to CiA 402 device display

MOOG ID No.:CB40859-001 Date:11/2020

MSD ServoDrive - DeviceHelp 273

# 8 Motion profile

MOOG ID No.:CB40859-001 Date:11/2020

MSD ServoDrive - DeviceHelp 274

|Display|System state|power disabled|fault|
|---|---|---|---|
|Control enabled|0|Start|7|
| |fault reaction active|0|14|
|Quick stop active|1|not ready|8|
| |to switch on|1|17|
|Error reaction active|2|switch on|disabled|
| |2|7| |
|Error state (in this state the error is indicated directly on the display.)|3|ready to|switch on|
|Device is reset (display flashes)|power enabled|3|6|
| |10|12| |
|• Number [5.] flashes when “STO” (Safe Torque Off) input is active. Display goes out when STO inactive.| | | |
|• The dot on the display flashes when the power stage is active.| | | |

Table 8.28: Central state machine according to CiA 402 device display (continue)

NOTE

l The system states indicated on the display may differ from the states in the table depending on the drive profile setting.

Image 8.70: State machine diagram based on CANopen communications

⓪ to ① State number

1 to 17 State transition (No. 17: DC link voltage cut off)

Legend for “State machine diagram based on CANopen communications” figure

# 8.10 Touch probe

|ID|Index Name / Setting|
|---|---|
|241|0 MPRO_TP_Position|
|241|1 MPRO_TP_Position|
|241|2 MPRO_TP_Position|
|241|3 MPRO_TP_Position|
|241|4 MPRO_TP_Position|
|1400|0 MPRO_TP_Config|
| |TP_TP (0)|
| |AB (1)|
| |PD_UP (2)|
| |PD_DOWN (3)|
| |PC_PC (4)|
| |PC_TP (5)|
| |TP_PC (6)|
| |ENC_ENC (7)|
| |ENC_TP (8)|
| |TP_ENC (9)|

Using the touch probe inputs, touch probe functions can be performed. In order to be able to do this, P 106[0] - MPRO_INPUT_FS_ISD05 and P 107[0] - MPRO_INPUT_FS_ISD06 must be used to set digital inputs ISD05 and ISD06 to ""PROBE(15) = Touch probe (only ISD05/06)"" (see Section ""Digital inputs"" on page 290). HTL encoders can be evaluated or pulse counters implemented using the MSD PLC.

The touch probe can be triggered with P 240 - MPRO_TP_Ctrl. This enables triggering on a positive or negative edge, or on both edges, of the signal detected on the touch probe inputs. After the measurement, the parameter jumps back to the value ""NONE (0)"" and the latch position is mapped in the corresponding subindex of parameter P 241 - MPRO_TP_Position. A continuous touch probe mode is not possible at present, so the touch probe has to be reactivated after the measurement.

P 1402 - MPRO_TP_Channel can be used to select various positions as actual value sources of the latch position for the touch probe functionality. The following table provides an overview of the available settings. The counters are accessed via the MSD PLC or a bus system.

|ID|Index Name / Setting|Unit|Description|
|---|---|---|---|
|240|MPRO_TP_Ctrl|Touch probe: Control| |
| |0| |NONE (0) = No function|
| |1| |POS (1) = Positive edge|
| |2| |NEG (2) = Negative edge|
| |3| |BOTH (3) = Both edges|
|240|0 MPRO_TP_Ctrl| | |
|240|1 MPRO_TP_Ctrl| | |
|240|2 MPRO_TP_Ctrl| | |
|241|MPRO_TP_Position|Probe: Pos. high/low edge of TP0/1, encoder zero pulse| |

Table 8.29: “Touch probe” parameters

MOOG ID No.:CB40859-001 Date:11/2020

# 8 Motion profile

|Unit|Description|
|---|---|
|mDegree|Touch probe: Configuration|
|mDegree|TP0, TP1 touch probe|
|mDegree|TP0, TP1 as encoder, A/B as quadrature counting|
|mDegree|TP0, TP1 as encoder, pulse (TP0) / direction (TP1), count up on direction high|
|mDegree|TP0, TP1 as encoder, pulse (TP0) / direction (TP1), count down on direction high|
|mDegree|TP0 pulse counter, TP1 pulse counter|
|mDegree|TP0 pulse counter, TP1 touch probe|
|mDegree|TP1 touch probe, TP0 pulse counter|
|mDegree|TP0 encoder counter, TP1 encoder counter|
|mDegree|TP0 encoder counter, TP1 touch probe|
|mDegree|TP0 touch probe, TP1 encoder counter|

Touch probe: Channel

|Unit|Description|
|---|---|
|ACTPOS (0)|Actual position in user units|
|ACTPOSINC (1)|Actual position in increments|
|MASTERPOS (2)|Master position in increments|
|ENCPOS_CH1 (3)|Encoder position Channel 1|
|ENCPOS_CH1_INC (4)|Encoder position Channel 1 in increments|
|ENCPOS_CH2 (5)|Encoder position Channel 2|
|ENCPOS_CH2_INC (6)|Encoder position Channel 2 in increments|

# 8 Motion profile

MOOG ID No.:CB40859-001 Date:11/2020 MSD ServoDrive - DeviceHelp 276

|ID|Index Name / Setting|Unit|Description|
|---|---|---|---|
|7|ENCPOS_CH3 (7)| |Encoder position Channel 3|
|8|ENCPOS_CH3_INC (8)| |Encoder position Channel 3 in increments|
|9|ENCPOS_CH4 (9)| |Encoder position Channel 4|
|10|ENCPOS_CH4_INC (10)| |Encoder position Channel 4 in increments|
|11|ACTPOS2 (11)| |Actual position of redundant encoder in user units|
|12|Sercos (12)| |Referred to Sercos profile parameters S-x-0426, S-x-0427|
|13|UserRefPos(13)| |Reference position in user units|
|14|MasterPosST(14)| |Master position (ECAM, EGEAR) singleturn, always steps|
|15|CommonMasterPos(15)| |Master position (ECAM, EGEAR) singleturn, always steps|
|16|CommonMasterPosST(15)| |Master position (ECAM, EGEAR) singleturn, always steps|
|1402|MPRO_TP_Channel| | |
|1402|MPRO_TP_Channel| | |
|1402|MPRO_TP_Channel| | |
|1404|MPRO_TP_Lines| |Touch probe: Lines @ pulse counter on channel x|
|1404|MPRO_TP_Lines| | |
|1404|MPRO_TP_Lines| | |

Image 8.71: “Synchronized motion” screen

There are various modes available in the “synchronization mode” drop-down menu (P 242[0] - MPRO_ECAM_SyncModMode):

- Off(0) = Synchronized motion off
- ECAM_iPlc(1) = Electronic cam plate via MSD PLC
- EGEAR_iPlc(2) = Electr. gear unit via MSD PLC
- ECAM_PARA(3) = Electronic camming via parameters
- EGEAR_PARA(4) = Electronic gearing via parameters

NOTE: For more information refer to the bus system User Manuals or the description of the MSD PLC.

# 8.11.1 Electronic cam plate

The other parameters are configured in separate screens that can be accessed with the corresponding buttons.

- Master configuration (see Section ""Master configuration"" on page 280)
- Electronic gearing (see Section ""Electronic gearing"" on page 283)
- Electronic camming (see Section ""Electronic cam plate"" on page 277)

P 1318[0] - MPRO_ECAM_ControlWord is the control word for “synchronized motion” (see Section ""Control word for synchronized motion"" on page 279).

P 1326[0] - MPRO_ECAM_StatusWord is the status word for “synchronized motion” (see Section ""Status word for synchronized motion"" on page 279).

# 8.11.1.1 Table selection

|ID|Index Name|Unit|Description|
|---|---|---|---|
|1300|MPRO_ECAM_CTS_| |ECAM: CamTableSelect - Master reference|
|1301|MasterRef| | |
|1305|MPRO_ECAM_CTS_| |ECAM: CamTableSelect - Method for changing the camtable|
|1306|MPRO_ECAM_CTS_| |ECAM: CamTableSelect - Mode for changing the camtable|
|1307|MPRO_ECAM_CTS_|incr|ECAM: CamTableSelect - Distance for changing the camtable|
|242|MPRO_ECAM_| |ECAM / EGEAR: Mode of synchronized motion SyncModMode|
|265|MPRO_ECAM_| |ECAM / EGEAR: Slave speed factor (1 = 100%).|
|266|CamSlave_SpeedFactor| | |
|268|MPRO_ECAM_| |ECAM / EGEAR: Mode of switching off sync. motion|

# 8.11.1.2 Synchronization

|ID|Index Name|Unit|Description|
|---|---|---|---|
|1342|MPRO_ECAM_CI_|incr|ECAM: CamIn - Synchronization position (multiturn part)|
|1343|MPRO_ECAM_CO_|incr|ECAM: CamOut - Decoupling pos. (multiturn part)|
|1303|MPRO_ECAM_CI_|incr|ECAM: CamIn - Master offset|
|1308|MPRO_ECAM_CI_| |ECAM: CamIn - Master reference|
|1309|MPRO_ECAM_CI_| |ECAM: CamIn - Slave reference|
|1310|MPRO_ECAM_CI_| |ECAM: CamIn - Coupling mode|
|1311|MPRO_ECAM_CI_|incr|ECAM: CamIn - Coupling distance|
|1312|MPRO_ECAM_CI_|incr|ECAM: CamIn - Synchronization position|

Table 8.31: “Electronic camming - Table selection” parameters

Table 8.30: “Synchronized motion” parameters

Table 8.32: “Electronic camming - Synchronization” parameters

MOOG ID No.:CB40859-001 Date:11/2020

MSD ServoDrive - DeviceHelp 277

# 8 Motion profile

MOOG ID No.:CB40859-001 Date:11/2020 MSD ServoDrive - DeviceHelp 278

|ID|Index|Name|Unit|Description|
|---|---|---|---|---|
|1313|0|MPRO_ECAM_CO_SyncPosST|(singleturn part)|ECAM: CamOut - Slave reference|
|1314|0|MPRO_ECAM_CO_DecouplingMode|63|ECAM: CamOut - Decoupling mode|
|1315|0|MPRO_ECAM_CO_BreakingPosST|incr|ECAM: CamOut - Decoupling position|
|1316|0|MPRO_ECAM_CO_DecouplingDist|incr|ECAM: CamOut - Decoupling distance|
|1317|0|MPRO_ECAM_CO_StandstillPos|mDegree|ECAM: CamOut - Slave standstill position|

# Table 8.32: “Electronic camming - Synchronization” parameters (continue)

|ID|Index|Name|Unit|Description|
|---|---|---|---|---|
|1346| |MPRO_ECAM_SP_Table| |ECAM: Setpoint table interface|
|1346|0|Index| |Index of setpoint table|
|1346|1|Value| |Value at index of setpoint table|
|1347|0 to 31|MPRO_ECAM_SP_Index| |ECAM: Setpoint segments start index|
|1348|0 to 31|MPRO_ECAM_SP_Length| |ECAM: Setpoint segments length|
|1349|0 to 31|Length| | |
|1350|0|MPRO_ECAM_SP_MaDist| |ECAM: Setpoint segments master distance|
|1351|0|MPRO_ECAM_SP_IpoType| |ECAM: Setpoint segments interpolation type|
|1352|0 to 31|Checksum| |ECAM: Setpoint table checksum|
|1353|0 to 31|GainNum| |ECAM: Setpoint segments gain numerator|
| | |GainDen| |ECAM: Setpoint segments gain denominator|

# Table 8.33: “Electronic camming - Table segments” parameters

|ID|Index|Name|Unit|Description|
|---|---|---|---|---|
|1329|0 to 63|MPRO_ECAM_SegData_IndexNext| |ECAM: Index of the following segment|
|1330|0 to 63|MPRO_ECAM_SegData_IndexPrev| |ECAM: Index of the previous segment|
|1331|0 to 63|MPRO_ECAM_SegData_ProfileMode| |ECAM: Profile mode of the current segment|
|1332|0 to 63|MPRO_ECAM_SegData_DistMaster| |ECAM: Length of the master section of the current segment|
|1333|0 to 63|MPRO_ECAM_SegData_DistSlave| |ECAM: Length of the slave section of the current segment|
|1334|0 to 63|MPRO_ECAM_SegData_Lambda| |ECAM: Lambda value of the current segment|
|1335|0 to 63|MPRO_ECAM_SegData_StatusWord| |ECAM: Status word of the current segment|
|1336|0 to 63|MPRO_ECAM_SegData_ControlWord| |ECAM: Control word of the current segment|

# 8.11.2 Control word for synchronized motion

|Bit|Function|PLC function|Bit number|Description|
|---|---|---|---|---|
|0-7|Start segment (8-bit value)|-|0-7|Actual segment (8-bit value)|
|8-15|Reserved|-| |Actual ECAM / EGEAR state machine state (4 Bit value)|
|16|Absolute (true) / relative (false) master relationship|-| |- 0: ECAM / EGEAR asynchronous
- 1: ECAM / EGEAR synchronous
|
|17|Absolute (true) / relative (false) master (CAM) relationship at cam in|-| |- 2: ECAM / EGEAR synchronizing
- 3: ECAM / EGEAR desynchronizing
|
|18|Absolute (true) / relative (false) slave (CAM) relationship at cam in|-| |- 4: ECAM / EGEAR active and waiting for going asynchronous
|
|19-23|Reserved|-| |- 5: ECAM / EGEAR inactive and waiting for going synchronous
|
|24|Change gear ratio of the electronic gear online|MCB_GearRatioChange| | |
|25|Disable master calculation|MCB_Cam_MasterEnable| | |
|26|Enable master calculation|MCB_Cam_MasterEnable| | |
|27|Select CAM table|MCB_CamTableSelect| | |
|28|Start Ecam|MCB_CamIn| | |
|29|Stop Ecam|MCB_CamOut| | |
|30|Start Egear|MCB_GearIn| | |
|31|Stop Egear|MCB_GearOut| | |

# 8.11.3 Status word for synchronized motion

|Bit|Function|PLC function|Bit number|Description|
|---|---|---|---|---|
|12-26|Reserved|-| | |
|27|ECAM / EGEAR is active|-| | |
|28|Valid segments chosen|-| | |
|29|Master data are valid|-| | |
|30|Master is initialized|-| | |
|31|Master calculation is active|-| | |

Table 8.35: Control word ECAM (P 1318[0] - MPRO_ECAM_ControlWord)

Table 8.36: ECAM status word (P 1326[0] - MPRO_ECAM_StatusWord)

MOOG ID No.:CB40859-001 Date:11/2020 MSD ServoDrive - DeviceHelp 279

# 8 Motion profile

# 8 Motion profile

MOOG ID No.:CB40859-001 Date:11/2020

MSD ServoDrive - DeviceHelp 280

# 8.11.4 Master configuration

the master encoder, you will need to set the resolution relative to a single motor revolution in P 250 - MPRO_ECAM_PARAMaster_Amplitude (see below).

- ENC CH1 (3) = Encoder channel 1 X7 (Sin/Cos)
- ENC CH2 (4) = Encoder channel 2 X6 (Resolver)
- ENC CH3 (5) = Encoder channel 3 X8 (optional)

This function is only available if an external interface X8 (option module) is present.

- TP0 (6) = Pulse counter on probe channel 0 (TP0)
- TP1 (7) = Pulse counter on probe channel 1 (TP1)
- ENC_CH4 (8) = Encoder channel 4 (p. e. fieldbus)
- TWIN_POS (9) = TWIN remote reference position (P-2607)

Image 8.72: “Master configuration” screen

# Channel selection (master encoder)

P 1319[0] - MPRO_ECAM_CamMaster_AxisType is used to define the master encoder.

- NO AXIS (0) = No axis
- VIRTUAL MASTER (1) = Virtual master

If you select this function, you will be able to configure additional settings by clicking on the enabled “Options...” button (see Section ""Virtual Master"" on page 286).

- PARA (2) = Master parameter interface

If you select this function because a higher-level controller is being used as

# Anti-reverse mode

Slave only starts moving along with it again as soon as the master reaches the zero position.

P 1320[0] - MPRO_ECAM_CamMaster_RevLockMode is used to define the reverse lock mode, which can be used either with or without path compensation. The dashed lines in the following diagrams indicate what the engagement distance is:

# Example:

If the master, which has moved two motor revolutions in the direction blocked for the slave, then moves in the unblocked direction again, the slave only moves off when the master has traversed the zero point.

- INACTIVE (0) = Reverse lock inactive
- ACTIVE (2) = Reverse lock enabled - without path optimization
- ACTIVE WAY COMP (1) = Reverse lock active - with way compensation

While the slave accelerates to the speed of the master during engagement, the master and slave do not move synchronously. This function needs to be selected in order to quickly catch up to the master that is running ahead.

# Example:

- Master (black line) rotates in the blocked direction
- The slave (blue line) remains stopped
- Master rotates in the unblocked direction again
- The slave follows the master directly in the unblocked direction

Assume the master has moved two motor revolutions in the direction for which the slave lock is enabled. If the master now moves in the direction for which there is no lock, the slave will immediately start running in that direction.

MOOG ID No.:CB40859-001 Date:11/2020

MSD ServoDrive - DeviceHelp 281

# 8 Motion profile

MOOG ID No.:CB40859-001 Date:11/2020 MSD ServoDrive - DeviceHelp 282

|Filter type|ID|Index Name|Unit|Description|
|---|---|---|---|---|
|When using a real master encoder, encoder signals may be subject to noise.|P 1340|1319|0|MPRO_ECAM_CamMaster_AxisType|
| | |MPRO_ECAM_CamMaster_SpeedFilTyp| |ECAM / EGEAR: Channel selection of internal master input|
| | |1320|0|MPRO_ECAM_CamMaster_RevLockMode|
| | |1321|0|MPRO_ECAM_CamMaster_Amplitude|
| | |1322|0|MPRO_ECAM_CamMaster_GearNum|
| | |1323|0|MPRO_ECAM_CamMaster_GearDen|
|Filter time|1327|0|ms|ECAM / EGEAR: Filter time constant of master|
|If P 1340[0] is used to enable a filter, P 1327[0] - MPRO_ECAM_CamMaster_SpeedTFil can be used to define the corresponding filter time.|1328|0|speed|ECAM / EGEAR: Speed factor of the internal master|
|Speed factor|1340|0| |MPRO_ECAM_CamMaster_SpeedFilTyp|
|The master encoder can be assigned an additional speed factor P 1328[0] - MPRO_ECAM_CamMaster_SpeedFactor.|1341|0|incr|ECAM / EGEAR: Master drive offset|

Table 8.37: “Synchronized motion - Master configuration” parameters (continue)

| | | |ID|Index Name|Unit|Description|
|---|---|---|---|---|---|---|
|247|0|MPRO_ECAM_ParaMaster_ActPos|incr|ECAM / EGEAR: Parameter interface master position| | |
|248|0|MPRO_ECAM_ParaMaster_ActSpeed|rpm|ECAM / EGEAR: Parameter interface master speed| | |
|249|0|MPRO_ECAM_ParaMaster_ActAcc|rpm|ECAM / EGEAR: Parameter interface master acceleration| | |
| |250|0|MPRO_ECAM_ParaMaster_Amplitude| |ECAM / EGEAR: Parameter interface master amplitude| |

Table 8.37: “Synchronized motion - Master configuration” parameters

# 8.11.5 Electronic gearing

# Gear ratio

The gear ratio is specified as a fraction. This ensures that the position references can be translated to the motor shaft with no rounding error.

- ""Slave"" (P 252[0] - MPRO_ECAM_Egear_GearNum) is the numerator
- ""Master"" (P 251[0] - MPRO_ECAM_Egear_GearDen) is the denominator

# Scaling of speed pre-control

Defined with P 265[0] - MPRO_ECAM_CamSlave_SpeedFactor definiert.

# Scaling of torque pre-control

Defined with P 266[0] - MPRO_ECAM_CamSlave_TorqueFactor.

# Engagement

See Section ""Engagement"" on page 284.

# Disengagement

See Section ""Disengagement"" on page 285.

|ID|Index Name|Unit|Description|
|---|---|---|---|
|251|0 MPRO_ECAM_Egear_GearDen| |EGEAR: Gear denominator|
|252|0 MPRO_ECAM_Egear_GearNum| |EGEAR: Numerator of gear ratio|
|1344|0 MPRO_ECAM_Egear_LimRefAcc|rpm/s|EGEAR: Acceleration limit for reference|
|1345|0 MPRO_ECAM_Egear_LimRefJerk|rpm/s²|EGEAR: Jerk limit for reference|

Table 8.38: “Synchronized motion - Electronic gearing” parameters

Image 8.73: ""Electronic gearing"" screen

MOOG ID No.:CB40859-001 Date:11/2020 MSD ServoDrive - DeviceHelp 283

# 8 Motion profile

# 8 Motion profile

MOOG ID No.:CB40859-001 Date:11/2020

MSD ServoDrive - DeviceHelp 284

# 8.11.6 Engagement

used to define the engagement distance (between the dashed lines).

P 253[0] - MPRO_ECAM_Egear_GearInMode is used to define the mode for engagement.

- DIRECT (0) = Direct
- Direct engagement: Angular synchronous; with jerking (no ramps).
- CROSSFADE (3) = Crossfading
- Engagement with crossfading function (5th degree polynomial): Angular synchronous; jerk-limited; speed will overshoot during engagement.
- RAMP (1) = Linear speed ramp
- Engagement with linear acceleration: Not angular synchronous; with jerking.
- FADE (2) = Engagement fade-out
- Engagement with fade-in function (5th degree polynomial): Not angular synchronous; jerk-limited. The position is ignored. ",What does the backlash parameter do in the analog channels ISA00 and ISA01 in the 'MSD ServoDrive - DeviceHelp' document?,A1,The backlash parameter can suppress axis motion close to the standstill position.,1.6953125,1.78125,3.265625,1.4296875,0.40234375
26,msd_servo_drive.txt,76,b87ca5e232c2bdbb6fa16a8a401c6b5d285dc0183e73cc9d134de13dd2fc71d2,"MOOG ID No.:CB40859-001 Date:11/2020

MSD ServoDrive - DeviceHelp 267

# 8 Motion profile

MOOG ID No.:CB40859-001 Date:11/2020 MSD ServoDrive - DeviceHelp 268

# Deceleration

With ...

- P 194 - MPRO_TAB_TDec (for torque control) or
- P 197 - MPRO_TAB_SDec (for speed control) or
- P 200 - MPRO_TAB_PDec (for position control)

and indexes 0–15, the deceleration for each individual motion task can be defined. The input must not be zero.

# Wait time in Auto mode

P 204 - MPRO_TAB_WaitTime is used to define the wait time before the next motion task is carried out.

# Maximum table index in Auto mode

P 206[0] - MPRO_Tab_MaxIdx is used to define the table index up to which driving jobs will be carried out in one of the auto modes.

# Current table index

P 207[0] - MPRO_Tab_ActIdx will show the index for the motion task that is currently active. If parameter P 205 MPRO_TAB_Mode is set to “Para(0)”, a driving set can be entered and approached directly.

# Activation of reference table

The following procedures can be used in order to activate the setpoint table for operation.

|ID|Index Name|Unit|Description|
|---|---|---|---|
|193|MPRO_TAB_TAcc|TAB: Torque mode acceleration|Nm/ms|
|193|0|MPRO_TAB_TAcc|Nm/ms|
|193|1 - 15|MPRO_TAB_TAcc|Nm/ms|
|194|MPRO_TAB_TDec|TAB: Torque mode deceleration| |
|194|0|MPRO_TAB_TDec|Nm/ms|
|194|1 - 15|MPRO_TAB_TDec|Nm/ms|

# Table 8.23: Activation of table references

# Table 8.24: “Setpoint table settings” parameters

# Table 8.24: “Setpoint table settings” parameters (continue)

|ID|Index Name|Unit|Description|ID|Index Name|Unit|Description|
|---|---|---|---|---|---|---|---|
|195|MPRO_TAB_TRef|Nm|TAB: Torque mode reference value|208|MPRO_TAB_OutputNo| |OSD TAB: actual table index and target|
|195|MPRO_TAB_TRef|Nm| |208|MPRO_TAB_OutputNo| | |
|196|MPRO_TAB_SAcc|rev/min/s|TAB: Speed mode acceleration|269|MPRO_TAB_Ctrl| |TAB: control word|
|196|MPRO_TAB_SAcc|rev/min/s| | | | | |
|197|MPRO_TAB_SDec|rev/min/s|TAB: Speed mode deceleration| | | | |
|197|MPRO_TAB_SDec|rev/min/s| | | | | |
|198|MPRO_TAB_SRef|rev/min|TAB: Speed mode reference value| | | | |
|198|MPRO_TAB_SRef|rev/min| | | | | |
|199|MPRO_TAB_PAcc|rev/min/s|TAB: Position control mode acceleration| | | | |
|199|MPRO_TAB_PAcc|rev/min/s| | | | | |
|200|MPRO_TAB_PDec|rev/min/s|TAB: Position control mode Acceleration| | | | |
|200|MPRO_TAB_PDec|rev/min/s| | | | | |
|201|MPRO_TAB_PSpd|rev/min|TAB: Position control mode speed| | | | |
|201|MPRO_TAB_PSpd|rev/min| | | | | |
|202|MPRO_TAB_PPos|mDegree|TAB: Position control mode reference value| | | | |
|202|MPRO_TAB_PPos|mDegree| | | | | |
|203|MPRO_TAB_PMode| |Position control table:Mode| | | | |
|203|MPRO_TAB_PMode| | | | | | |
|204|MPRO_TAB_WaitTime|ms|TAB: Wait time| | | | |
|204|MPRO_TAB_WaitTime|ms| | | | | |
|205|MPRO_TAB_Mode| |TAB mode| | | | |
|206|MPRO_Tab_MaxIdx| |TAB: Max index in AUTO mode| | | | |
|207|MPRO_TAB_ActIdx| |TAB: Actual index| | | | |

MOOG ID No.:CB40859-001 Date:11/2020

MSD ServoDrive - DeviceHelp

# 8 Motion profile

MOOG ID No.:CB40859-001 Date:11/2020

MSD ServoDrive - DeviceHelp 270

# 8.8 Analog channel (ISA00 und ISA01)

# Offset (O)

This parameter (P 174 - MPRO_ANA0_SOffset for ISA00, P 184 - MPRO_ANA1_SOffset for ISA01) compensates for component variations and is used for offset compensation purposes. Depending on the control mode being used (see Section ""Basic settings"" on page 110), the value will be stored in parameter index [0] (torque control), [1] (speed control) or [2] (position control).

# Backlash (B)

This parameter (P 175 - MPRO_ANA0_SThreshold for ISA00, P 185 - MPRO_ANA1_SThreshold for ISA01) can suppress axis motion close to the standstill (stop) position. Depending on the control mode being used (see Section ""Basic settings"" on page 110), the value will be stored in parameter index [0] (torque control), [1] (speed control) or [2] (position control).

Image 8.68: “Analog channel” screen

# Acceleration ramp

Two standard analog inputs (ISA00, ISA01) are available. These inputs can be configured...

- with negative values for analog setpoint settings
- with positive values for digital setpoint processing

(P 109[0] - MPRO_INPUT_FS_ISA00 and P 110[0] - MPRO_INPUT_FS_ISA01).

see also section ""Analog Inputs"" on page 303. By using the ""REV(-2) = Analog setpoint"" setting, an analog input voltage of ±10 V can be processed as a setpoint.

# Deceleration ramp

This parameter serves as a deceleration ramp for torque control (P 176[1] - MPRO_ANA0_TRamp for ISA00, P 186[1] - MPRO_ANA1_TRamp for ISA01) or speed control (P 177[1] - MPRO_ANA0_SRamp for ISA00, P 187[1] - MPRO_ANA1_SRamp for ISA01). Depending on the control mode being used (see Section ""Basic settings"" on page 110), the value will be stored in parameter index [0] (torque control), [1] (speed control) or [2] (position control).

This parameter (P 173 - MPRO_ANA0_Scale for ISA00, P 183 - MPRO_ANA1_Scale for ISA01) is used to define which speed / which torque / which position corresponds to the maximum analog value. Depending on the control mode being used (see Section ""Basic settings"" on page 110), the value will be stored in parameter index [0] (torque control), [1] (speed control) or [2] (position control).

# 8.8.1 Special characteristics of position control mode

A threshold value can also be specified which generates a run-on range around the last reference value. A ramp function calculates a motion profile for the position reference from pre-defined acceleration and speed limits.

The position references on the analog channel are not applied immediately, but dependent on a digital input. Accordingly, one of the ISD00 to ISD06 digital inputs must be set to a value of ""REFANAEN(28) = Enable analog reference value"" (see Section ""Digital inputs"" on page 290). The position setpoint being received will only be applied if the corresponding digital input is active. The acceleration is entered using P 173[0] - MPRO_ANA0_TScale or P 183[0] - MPRO_ANA1_TScale.

# 8.8.2 Wire Break Monitoring

P 399 - CON_ANAWireBrk_Th can be used to configure wire break monitoring for the analog inputs. For details see Section ""Wire Break Monitoring"" on page 306.

|Function|TLIM (-4)|OVR (-3)|REFV (-2)|leer (-1)|OFF (0)|
|---|---|---|---|---|---|
|Digital|(1)-(28)|(1)-(28)|(1)-(28)|(1)-(28)|(1)-(28)|
|Analog channel|Filter|Scale|Offset|Profile|generator|

Control

Image 8.69: Reference processing structure

MOOG ID No.:CB40859-001 Date:11/2020

MSD ServoDrive - DeviceHelp 271

# 8 Motion profile

# 8 Motion profile

MOOG ID No.:CB40859-001 Date:11/2020

|ID|Index Name|Unit|Description|ID|
|---|---|---|---|---|
|395|CON_ANA_Isaf_Scaled| |Analog inputs: Values (filt, norm, comp, scaled)|174|
|395|0 ISA00| |Scaled, compensated, filtered, normalized value|175|
|395|1 ISA01| |Scaled, compensated, filtered, normalized value| |
|396|CON_ANA_Scale_ThUpper| |Analog inputs: Upper scaling limits|175|
|396|0 ISA00|%|Upper scaling (@ 10 V) threshold|175|
|396|1 ISA01|%|Upper scaling (@ 10 V) threshold| |
|397|CON_ANA_Scale_ThZero| |Analog inputs: Zero scaling thresholds|176|
|397|0 ISA00|V|Zero scaling threshold (+/-)|176|
|397|1 ISA01|V|Zero scaling threshold (+/-)| |
|398|CON_ANA_Scale_ThLower| |Analog inputs: Lower scaling limits|177|
|398|0 ISA00|%|Lower scaling (@ zero threshold) threshold|177|
|398|1 ISA01|%|Lower scaling (@ zero threshold) threshold| |
|399|CON_ANA_WireBrk_Th| |Analog inputs: Wire break thresholds|Table 8.26:|
|399|0 ISA00|V|Wire break detection threshold| |
|399|1 ISA01|V|Wire break detection threshold| |
|405|0 CON_ANA_Filt0|ms|Analog input ISA00: Filter time constant (PT 1)|ID|
|408|CON_ANA_Isaf_Norm| |Analog inputs: Values (filt, norm)|183|
|408|0 ISA00| |Filtered, normalized value|183|
|408|1 ISA01| |Filtered, normalized value|183|

Table 8.25: “Analog channel” parameters

|ID|Index Name|Unit|Description|ID|
|---|---|---|---|---|
|173|MPRO_ANA0_Scale| |ANA0: scale factors|184|
|173|0 MPRO_ANA0_TScale|Nm|ANA0: scale factor torque reference|185|
|173|1 MPRO_ANA0_SScale|rev/min|ANA0: scale factor speed reference|185|
|173|2 MPRO_ANA0_PScale|mDegree|ANA0: scale factor position reference| |
|174|MPRO_ANA0_Offset| |ANA0: offsets|185|
|174|0 MPRO_ANA0_TOffset|Nm|ANA0: offsets for torque reference|185|

Table 8.26: “Analog channel ISA00” parameters

|Index Name|Unit|Description|
|---|---|---|
|1 MPRO_ANA0_SOffset|rev/min|ANA0: offsets for speed reference|
|2 MPRO_ANA0_POffset|mDegree|ANA0: offsets for position reference|
|MPRO_ANA0_Threshold| |ANA0: thresholds|
|0 MPRO_ANA0_TThreshold|Nm|ANA0: threshold for torque reference|
|1 MPRO_ANA0_SThreshold|rev/min|ANA0: threshold for speed reference|
|2 MPRO_ANA0_PThreshold|mDegree|ANA0: threshold for position reference|
|MPRO_ANA0_TRamp| |ANA0: Torque mode acceleration [0] and deceleration [1]|
|0 MPRO_ANA0_TRamp|Nm/s| |
|1 MPRO_ANA0_TRamp|Nm/s| |
|MPRO_ANA0_SRamp| |ANA0: Speed mode acceleration [0] and deceleration [1]|
|0 MPRO_ANA0_SRamp|SPEED/s| |
|1 MPRO_ANA0_SRamp|SPEED/s| |

“Analog channel ISA00” parameters (continue)

|Index Name|Unit|Description|
|---|---|---|
|MPRO_ANA1_Scale| |ANA1: scale factors|
|0 MPRO_ANA1_TScale|Nm|ANA0: scale factor torque reference|
|1 MPRO_ANA1_SScale|rev/min|ANA0: scale factor speed reference|
|2 MPRO_ANA1_PScale|mDegree|ANA0: scale factor position reference|
|MPRO_ANA1_Offset| |ANA1: offsets|
|0 MPRO_ANA1_TOffset|Nm|ANA1: offsets for torque reference|
|1 MPRO_ANA1_SOffset|rev/min|ANA1: offsets for speed reference|
|2 MPRO_ANA1_POffset|mDegree|ANA1: offsets for position reference|
|MPRO_ANA1_Threshold| |ANA1: thresholds|
|0 MPRO_ANA1_TThreshold|Nm|ANA1: threshold for torque reference|
|1 MPRO_ANA1_SThreshold|rev/min|ANA1: threshold for speed reference|
|2 MPRO_ANA1_PThreshold|mDegree|ANA1: threshold for position reference|

“Analog channel ISA01” parameters

# 8 Motion profile

|ID|Index Name|Unit|Description|
|---|---|---|---|
|186|MPRO_ANA1_TRamp|Nm/s|ANA1: Torque mode acceleration [0] and deceleration[1]|
|186|MPRO_ANA1_TRamp|Nm/s| |
|187|MPRO_ANA1_SRamp|SPEED/s|ANA1: Speed mode acceleration [0] and deceleration [1]|
|187|MPRO_ANA1_SRamp|SPEED/s| |

# Table 8.27: “Analog channel ISA01” parameters (continue)

Display

- System state
- Initialization on device startup
- Not ready (DC link voltage possibly too low)
- Start inhibit (DC link voltage present, power stage off)
- Starting lockout
- Ready for start
- Control initialization: Auto commutation, flux build-up etc.

# Table 8.28: Central state machine according to CiA 402 device display

MOOG ID No.:CB40859-001 Date:11/2020

MSD ServoDrive - DeviceHelp 273

# 8 Motion profile

MOOG ID No.:CB40859-001 Date:11/2020

MSD ServoDrive - DeviceHelp 274

|Display|System state|power disabled|fault|
|---|---|---|---|
|Control enabled|0|Start|7|
| |fault reaction active|0|14|
|Quick stop active|1|not ready|8|
| |to switch on|1|17|
|Error reaction active|2|switch on|disabled|
| |2|7| |
|Error state (in this state the error is indicated directly on the display.)|3|ready to|switch on|
|Device is reset (display flashes)|power enabled|3|6|
| |10|12| |
|• Number [5.] flashes when “STO” (Safe Torque Off) input is active. Display goes out when STO inactive.| | | |
|• The dot on the display flashes when the power stage is active.| | | |

Table 8.28: Central state machine according to CiA 402 device display (continue)

NOTE

l The system states indicated on the display may differ from the states in the table depending on the drive profile setting.

Image 8.70: State machine diagram based on CANopen communications

⓪ to ① State number

1 to 17 State transition (No. 17: DC link voltage cut off)

Legend for “State machine diagram based on CANopen communications” figure

# 8.10 Touch probe

|ID|Index Name / Setting|
|---|---|
|241|0 MPRO_TP_Position|
|241|1 MPRO_TP_Position|
|241|2 MPRO_TP_Position|
|241|3 MPRO_TP_Position|
|241|4 MPRO_TP_Position|
|1400|0 MPRO_TP_Config|
| |TP_TP (0)|
| |AB (1)|
| |PD_UP (2)|
| |PD_DOWN (3)|
| |PC_PC (4)|
| |PC_TP (5)|
| |TP_PC (6)|
| |ENC_ENC (7)|
| |ENC_TP (8)|
| |TP_ENC (9)|

Using the touch probe inputs, touch probe functions can be performed. In order to be able to do this, P 106[0] - MPRO_INPUT_FS_ISD05 and P 107[0] - MPRO_INPUT_FS_ISD06 must be used to set digital inputs ISD05 and ISD06 to ""PROBE(15) = Touch probe (only ISD05/06)"" (see Section ""Digital inputs"" on page 290). HTL encoders can be evaluated or pulse counters implemented using the MSD PLC.

The touch probe can be triggered with P 240 - MPRO_TP_Ctrl. This enables triggering on a positive or negative edge, or on both edges, of the signal detected on the touch probe inputs. After the measurement, the parameter jumps back to the value ""NONE (0)"" and the latch position is mapped in the corresponding subindex of parameter P 241 - MPRO_TP_Position. A continuous touch probe mode is not possible at present, so the touch probe has to be reactivated after the measurement.

P 1402 - MPRO_TP_Channel can be used to select various positions as actual value sources of the latch position for the touch probe functionality. The following table provides an overview of the available settings. The counters are accessed via the MSD PLC or a bus system.

|ID|Index Name / Setting|Unit|Description|
|---|---|---|---|
|240|MPRO_TP_Ctrl|Touch probe: Control| |
| |0| |NONE (0) = No function|
| |1| |POS (1) = Positive edge|
| |2| |NEG (2) = Negative edge|
| |3| |BOTH (3) = Both edges|
|240|0 MPRO_TP_Ctrl| | |
|240|1 MPRO_TP_Ctrl| | |
|240|2 MPRO_TP_Ctrl| | |
|241|MPRO_TP_Position|Probe: Pos. high/low edge of TP0/1, encoder zero pulse| |

Table 8.29: “Touch probe” parameters

MOOG ID No.:CB40859-001 Date:11/2020

# 8 Motion profile

|Unit|Description|
|---|---|
|mDegree|Touch probe: Configuration|
|mDegree|TP0, TP1 touch probe|
|mDegree|TP0, TP1 as encoder, A/B as quadrature counting|
|mDegree|TP0, TP1 as encoder, pulse (TP0) / direction (TP1), count up on direction high|
|mDegree|TP0, TP1 as encoder, pulse (TP0) / direction (TP1), count down on direction high|
|mDegree|TP0 pulse counter, TP1 pulse counter|
|mDegree|TP0 pulse counter, TP1 touch probe|
|mDegree|TP1 touch probe, TP0 pulse counter|
|mDegree|TP0 encoder counter, TP1 encoder counter|
|mDegree|TP0 encoder counter, TP1 touch probe|
|mDegree|TP0 touch probe, TP1 encoder counter|

Touch probe: Channel

|Unit|Description|
|---|---|
|ACTPOS (0)|Actual position in user units|
|ACTPOSINC (1)|Actual position in increments|
|MASTERPOS (2)|Master position in increments|
|ENCPOS_CH1 (3)|Encoder position Channel 1|
|ENCPOS_CH1_INC (4)|Encoder position Channel 1 in increments|
|ENCPOS_CH2 (5)|Encoder position Channel 2|
|ENCPOS_CH2_INC (6)|Encoder position Channel 2 in increments|

# 8 Motion profile

MOOG ID No.:CB40859-001 Date:11/2020 MSD ServoDrive - DeviceHelp 276

|ID|Index Name / Setting|Unit|Description|
|---|---|---|---|
|7|ENCPOS_CH3 (7)| |Encoder position Channel 3|
|8|ENCPOS_CH3_INC (8)| |Encoder position Channel 3 in increments|
|9|ENCPOS_CH4 (9)| |Encoder position Channel 4|
|10|ENCPOS_CH4_INC (10)| |Encoder position Channel 4 in increments|
|11|ACTPOS2 (11)| |Actual position of redundant encoder in user units|
|12|Sercos (12)| |Referred to Sercos profile parameters S-x-0426, S-x-0427|
|13|UserRefPos(13)| |Reference position in user units|
|14|MasterPosST(14)| |Master position (ECAM, EGEAR) singleturn, always steps|
|15|CommonMasterPos(15)| |Master position (ECAM, EGEAR) singleturn, always steps|
|16|CommonMasterPosST(15)| |Master position (ECAM, EGEAR) singleturn, always steps|
|1402|MPRO_TP_Channel| | |
|1402|MPRO_TP_Channel| | |
|1402|MPRO_TP_Channel| | |
|1404|MPRO_TP_Lines| |Touch probe: Lines @ pulse counter on channel x|
|1404|MPRO_TP_Lines| | |
|1404|MPRO_TP_Lines| | |

Image 8.71: “Synchronized motion” screen

There are various modes available in the “synchronization mode” drop-down menu (P 242[0] - MPRO_ECAM_SyncModMode):

- Off(0) = Synchronized motion off
- ECAM_iPlc(1) = Electronic cam plate via MSD PLC
- EGEAR_iPlc(2) = Electr. gear unit via MSD PLC
- ECAM_PARA(3) = Electronic camming via parameters
- EGEAR_PARA(4) = Electronic gearing via parameters

NOTE: For more information refer to the bus system User Manuals or the description of the MSD PLC.

# 8.11.1 Electronic cam plate

The other parameters are configured in separate screens that can be accessed with the corresponding buttons.

- Master configuration (see Section ""Master configuration"" on page 280)
- Electronic gearing (see Section ""Electronic gearing"" on page 283)
- Electronic camming (see Section ""Electronic cam plate"" on page 277)

P 1318[0] - MPRO_ECAM_ControlWord is the control word for “synchronized motion” (see Section ""Control word for synchronized motion"" on page 279).

P 1326[0] - MPRO_ECAM_StatusWord is the status word for “synchronized motion” (see Section ""Status word for synchronized motion"" on page 279).

# 8.11.1.1 Table selection

|ID|Index Name|Unit|Description|
|---|---|---|---|
|1300|MPRO_ECAM_CTS_| |ECAM: CamTableSelect - Master reference|
|1301|MasterRef| | |
|1305|MPRO_ECAM_CTS_| |ECAM: CamTableSelect - Method for changing the camtable|
|1306|MPRO_ECAM_CTS_| |ECAM: CamTableSelect - Mode for changing the camtable|
|1307|MPRO_ECAM_CTS_|incr|ECAM: CamTableSelect - Distance for changing the camtable|
|242|MPRO_ECAM_| |ECAM / EGEAR: Mode of synchronized motion SyncModMode|
|265|MPRO_ECAM_| |ECAM / EGEAR: Slave speed factor (1 = 100%).|
|266|CamSlave_SpeedFactor| | |
|268|MPRO_ECAM_| |ECAM / EGEAR: Mode of switching off sync. motion|

# 8.11.1.2 Synchronization

|ID|Index Name|Unit|Description|
|---|---|---|---|
|1342|MPRO_ECAM_CI_|incr|ECAM: CamIn - Synchronization position (multiturn part)|
|1343|MPRO_ECAM_CO_|incr|ECAM: CamOut - Decoupling pos. (multiturn part)|
|1303|MPRO_ECAM_CI_|incr|ECAM: CamIn - Master offset|
|1308|MPRO_ECAM_CI_| |ECAM: CamIn - Master reference|
|1309|MPRO_ECAM_CI_| |ECAM: CamIn - Slave reference|
|1310|MPRO_ECAM_CI_| |ECAM: CamIn - Coupling mode|
|1311|MPRO_ECAM_CI_|incr|ECAM: CamIn - Coupling distance|
|1312|MPRO_ECAM_CI_|incr|ECAM: CamIn - Synchronization position|

Table 8.31: “Electronic camming - Table selection” parameters

Table 8.30: “Synchronized motion” parameters

Table 8.32: “Electronic camming - Synchronization” parameters

MOOG ID No.:CB40859-001 Date:11/2020

MSD ServoDrive - DeviceHelp 277

# 8 Motion profile

MOOG ID No.:CB40859-001 Date:11/2020 MSD ServoDrive - DeviceHelp 278

|ID|Index|Name|Unit|Description|
|---|---|---|---|---|
|1313|0|MPRO_ECAM_CO_SyncPosST|(singleturn part)|ECAM: CamOut - Slave reference|
|1314|0|MPRO_ECAM_CO_DecouplingMode|63|ECAM: CamOut - Decoupling mode|
|1315|0|MPRO_ECAM_CO_BreakingPosST|incr|ECAM: CamOut - Decoupling position|
|1316|0|MPRO_ECAM_CO_DecouplingDist|incr|ECAM: CamOut - Decoupling distance|
|1317|0|MPRO_ECAM_CO_StandstillPos|mDegree|ECAM: CamOut - Slave standstill position|

# Table 8.32: “Electronic camming - Synchronization” parameters (continue)

|ID|Index|Name|Unit|Description|
|---|---|---|---|---|
|1346| |MPRO_ECAM_SP_Table| |ECAM: Setpoint table interface|
|1346|0|Index| |Index of setpoint table|
|1346|1|Value| |Value at index of setpoint table|
|1347|0 to 31|MPRO_ECAM_SP_Index| |ECAM: Setpoint segments start index|
|1348|0 to 31|MPRO_ECAM_SP_Length| |ECAM: Setpoint segments length|
|1349|0 to 31|Length| | |
|1350|0|MPRO_ECAM_SP_MaDist| |ECAM: Setpoint segments master distance|
|1351|0|MPRO_ECAM_SP_IpoType| |ECAM: Setpoint segments interpolation type|
|1352|0 to 31|Checksum| |ECAM: Setpoint table checksum|
|1353|0 to 31|GainNum| |ECAM: Setpoint segments gain numerator|
| | |GainDen| |ECAM: Setpoint segments gain denominator|

# Table 8.33: “Electronic camming - Table segments” parameters

|ID|Index|Name|Unit|Description|
|---|---|---|---|---|
|1329|0 to 63|MPRO_ECAM_SegData_IndexNext| |ECAM: Index of the following segment|
|1330|0 to 63|MPRO_ECAM_SegData_IndexPrev| |ECAM: Index of the previous segment|
|1331|0 to 63|MPRO_ECAM_SegData_ProfileMode| |ECAM: Profile mode of the current segment|
|1332|0 to 63|MPRO_ECAM_SegData_DistMaster| |ECAM: Length of the master section of the current segment|
|1333|0 to 63|MPRO_ECAM_SegData_DistSlave| |ECAM: Length of the slave section of the current segment|
|1334|0 to 63|MPRO_ECAM_SegData_Lambda| |ECAM: Lambda value of the current segment|
|1335|0 to 63|MPRO_ECAM_SegData_StatusWord| |ECAM: Status word of the current segment|
|1336|0 to 63|MPRO_ECAM_SegData_ControlWord| |ECAM: Control word of the current segment|

# 8.11.2 Control word for synchronized motion

|Bit|Function|PLC function|Bit number|Description|
|---|---|---|---|---|
|0-7|Start segment (8-bit value)|-|0-7|Actual segment (8-bit value)|
|8-15|Reserved|-| |Actual ECAM / EGEAR state machine state (4 Bit value)|
|16|Absolute (true) / relative (false) master relationship|-| |- 0: ECAM / EGEAR asynchronous
- 1: ECAM / EGEAR synchronous
|
|17|Absolute (true) / relative (false) master (CAM) relationship at cam in|-| |- 2: ECAM / EGEAR synchronizing
- 3: ECAM / EGEAR desynchronizing
|
|18|Absolute (true) / relative (false) slave (CAM) relationship at cam in|-| |- 4: ECAM / EGEAR active and waiting for going asynchronous
|
|19-23|Reserved|-| |- 5: ECAM / EGEAR inactive and waiting for going synchronous
|
|24|Change gear ratio of the electronic gear online|MCB_GearRatioChange| | |
|25|Disable master calculation|MCB_Cam_MasterEnable| | |
|26|Enable master calculation|MCB_Cam_MasterEnable| | |
|27|Select CAM table|MCB_CamTableSelect| | |
|28|Start Ecam|MCB_CamIn| | |
|29|Stop Ecam|MCB_CamOut| | |
|30|Start Egear|MCB_GearIn| | |
|31|Stop Egear|MCB_GearOut| | |

# 8.11.3 Status word for synchronized motion

|Bit|Function|PLC function|Bit number|Description|
|---|---|---|---|---|
|12-26|Reserved|-| | |
|27|ECAM / EGEAR is active|-| | |
|28|Valid segments chosen|-| | |
|29|Master data are valid|-| | |
|30|Master is initialized|-| | |
|31|Master calculation is active|-| | |

Table 8.35: Control word ECAM (P 1318[0] - MPRO_ECAM_ControlWord)

Table 8.36: ECAM status word (P 1326[0] - MPRO_ECAM_StatusWord)

MOOG ID No.:CB40859-001 Date:11/2020 MSD ServoDrive - DeviceHelp 279

# 8 Motion profile

# 8 Motion profile

MOOG ID No.:CB40859-001 Date:11/2020

MSD ServoDrive - DeviceHelp 280

# 8.11.4 Master configuration

the master encoder, you will need to set the resolution relative to a single motor revolution in P 250 - MPRO_ECAM_PARAMaster_Amplitude (see below).

- ENC CH1 (3) = Encoder channel 1 X7 (Sin/Cos)
- ENC CH2 (4) = Encoder channel 2 X6 (Resolver)
- ENC CH3 (5) = Encoder channel 3 X8 (optional)

This function is only available if an external interface X8 (option module) is present.

- TP0 (6) = Pulse counter on probe channel 0 (TP0)
- TP1 (7) = Pulse counter on probe channel 1 (TP1)
- ENC_CH4 (8) = Encoder channel 4 (p. e. fieldbus)
- TWIN_POS (9) = TWIN remote reference position (P-2607)

Image 8.72: “Master configuration” screen

# Channel selection (master encoder)

P 1319[0] - MPRO_ECAM_CamMaster_AxisType is used to define the master encoder.

- NO AXIS (0) = No axis
- VIRTUAL MASTER (1) = Virtual master

If you select this function, you will be able to configure additional settings by clicking on the enabled “Options...” button (see Section ""Virtual Master"" on page 286).

- PARA (2) = Master parameter interface

If you select this function because a higher-level controller is being used as

# Anti-reverse mode

Slave only starts moving along with it again as soon as the master reaches the zero position.

P 1320[0] - MPRO_ECAM_CamMaster_RevLockMode is used to define the reverse lock mode, which can be used either with or without path compensation. The dashed lines in the following diagrams indicate what the engagement distance is:

# Example:

If the master, which has moved two motor revolutions in the direction blocked for the slave, then moves in the unblocked direction again, the slave only moves off when the master has traversed the zero point.

- INACTIVE (0) = Reverse lock inactive
- ACTIVE (2) = Reverse lock enabled - without path optimization
- ACTIVE WAY COMP (1) = Reverse lock active - with way compensation

While the slave accelerates to the speed of the master during engagement, the master and slave do not move synchronously. This function needs to be selected in order to quickly catch up to the master that is running ahead.

# Example:

- Master (black line) rotates in the blocked direction
- The slave (blue line) remains stopped
- Master rotates in the unblocked direction again
- The slave follows the master directly in the unblocked direction

Assume the master has moved two motor revolutions in the direction for which the slave lock is enabled. If the master now moves in the direction for which there is no lock, the slave will immediately start running in that direction.

MOOG ID No.:CB40859-001 Date:11/2020

MSD ServoDrive - DeviceHelp 281

# 8 Motion profile

MOOG ID No.:CB40859-001 Date:11/2020 MSD ServoDrive - DeviceHelp 282

|Filter type|ID|Index Name|Unit|Description|
|---|---|---|---|---|
|When using a real master encoder, encoder signals may be subject to noise.|P 1340|1319|0|MPRO_ECAM_CamMaster_AxisType|
| | |MPRO_ECAM_CamMaster_SpeedFilTyp| |ECAM / EGEAR: Channel selection of internal master input|
| | |1320|0|MPRO_ECAM_CamMaster_RevLockMode|
| | |1321|0|MPRO_ECAM_CamMaster_Amplitude|
| | |1322|0|MPRO_ECAM_CamMaster_GearNum|
| | |1323|0|MPRO_ECAM_CamMaster_GearDen|
|Filter time|1327|0|ms|ECAM / EGEAR: Filter time constant of master|
|If P 1340[0] is used to enable a filter, P 1327[0] - MPRO_ECAM_CamMaster_SpeedTFil can be used to define the corresponding filter time.|1328|0|speed|ECAM / EGEAR: Speed factor of the internal master|
|Speed factor|1340|0| |MPRO_ECAM_CamMaster_SpeedFilTyp|
|The master encoder can be assigned an additional speed factor P 1328[0] - MPRO_ECAM_CamMaster_SpeedFactor.|1341|0|incr|ECAM / EGEAR: Master drive offset|

Table 8.37: “Synchronized motion - Master configuration” parameters (continue)

| | | |ID|Index Name|Unit|Description|
|---|---|---|---|---|---|---|
|247|0|MPRO_ECAM_ParaMaster_ActPos|incr|ECAM / EGEAR: Parameter interface master position| | |
|248|0|MPRO_ECAM_ParaMaster_ActSpeed|rpm|ECAM / EGEAR: Parameter interface master speed| | |
|249|0|MPRO_ECAM_ParaMaster_ActAcc|rpm|ECAM / EGEAR: Parameter interface master acceleration| | |
| |250|0|MPRO_ECAM_ParaMaster_Amplitude| |ECAM / EGEAR: Parameter interface master amplitude| |

Table 8.37: “Synchronized motion - Master configuration” parameters

# 8.11.5 Electronic gearing

# Gear ratio

The gear ratio is specified as a fraction. This ensures that the position references can be translated to the motor shaft with no rounding error.

- ""Slave"" (P 252[0] - MPRO_ECAM_Egear_GearNum) is the numerator
- ""Master"" (P 251[0] - MPRO_ECAM_Egear_GearDen) is the denominator

# Scaling of speed pre-control

Defined with P 265[0] - MPRO_ECAM_CamSlave_SpeedFactor definiert.

# Scaling of torque pre-control

Defined with P 266[0] - MPRO_ECAM_CamSlave_TorqueFactor.

# Engagement

See Section ""Engagement"" on page 284.

# Disengagement

See Section ""Disengagement"" on page 285.

|ID|Index Name|Unit|Description|
|---|---|---|---|
|251|0 MPRO_ECAM_Egear_GearDen| |EGEAR: Gear denominator|
|252|0 MPRO_ECAM_Egear_GearNum| |EGEAR: Numerator of gear ratio|
|1344|0 MPRO_ECAM_Egear_LimRefAcc|rpm/s|EGEAR: Acceleration limit for reference|
|1345|0 MPRO_ECAM_Egear_LimRefJerk|rpm/s²|EGEAR: Jerk limit for reference|

Table 8.38: “Synchronized motion - Electronic gearing” parameters

Image 8.73: ""Electronic gearing"" screen

MOOG ID No.:CB40859-001 Date:11/2020 MSD ServoDrive - DeviceHelp 283

# 8 Motion profile

# 8 Motion profile

MOOG ID No.:CB40859-001 Date:11/2020

MSD ServoDrive - DeviceHelp 284

# 8.11.6 Engagement

used to define the engagement distance (between the dashed lines).

P 253[0] - MPRO_ECAM_Egear_GearInMode is used to define the mode for engagement.

- DIRECT (0) = Direct
- Direct engagement: Angular synchronous; with jerking (no ramps).
- CROSSFADE (3) = Crossfading
- Engagement with crossfading function (5th degree polynomial): Angular synchronous; jerk-limited; speed will overshoot during engagement.
- RAMP (1) = Linear speed ramp
- Engagement with linear acceleration: Not angular synchronous; with jerking.
- FADE (2) = Engagement fade-out
- Engagement with fade-in function (5th degree polynomial): Not angular synchronous; jerk-limited. The position is ignored. ",What does the backlash parameter do in the analog channels ISA00 and ISA01 in the 'MSD ServoDrive - DeviceHelp' document?,A2,It prevents unwanted axis movement near the stop position.,1.71875,1.734375,3.390625,1.3125,0.302734375
27,msd_servo_drive.txt,76,b87ca5e232c2bdbb6fa16a8a401c6b5d285dc0183e73cc9d134de13dd2fc71d2,"MOOG ID No.:CB40859-001 Date:11/2020

MSD ServoDrive - DeviceHelp 267

# 8 Motion profile

MOOG ID No.:CB40859-001 Date:11/2020 MSD ServoDrive - DeviceHelp 268

# Deceleration

With ...

- P 194 - MPRO_TAB_TDec (for torque control) or
- P 197 - MPRO_TAB_SDec (for speed control) or
- P 200 - MPRO_TAB_PDec (for position control)

and indexes 0–15, the deceleration for each individual motion task can be defined. The input must not be zero.

# Wait time in Auto mode

P 204 - MPRO_TAB_WaitTime is used to define the wait time before the next motion task is carried out.

# Maximum table index in Auto mode

P 206[0] - MPRO_Tab_MaxIdx is used to define the table index up to which driving jobs will be carried out in one of the auto modes.

# Current table index

P 207[0] - MPRO_Tab_ActIdx will show the index for the motion task that is currently active. If parameter P 205 MPRO_TAB_Mode is set to “Para(0)”, a driving set can be entered and approached directly.

# Activation of reference table

The following procedures can be used in order to activate the setpoint table for operation.

|ID|Index Name|Unit|Description|
|---|---|---|---|
|193|MPRO_TAB_TAcc|TAB: Torque mode acceleration|Nm/ms|
|193|0|MPRO_TAB_TAcc|Nm/ms|
|193|1 - 15|MPRO_TAB_TAcc|Nm/ms|
|194|MPRO_TAB_TDec|TAB: Torque mode deceleration| |
|194|0|MPRO_TAB_TDec|Nm/ms|
|194|1 - 15|MPRO_TAB_TDec|Nm/ms|

# Table 8.23: Activation of table references

# Table 8.24: “Setpoint table settings” parameters

# Table 8.24: “Setpoint table settings” parameters (continue)

|ID|Index Name|Unit|Description|ID|Index Name|Unit|Description|
|---|---|---|---|---|---|---|---|
|195|MPRO_TAB_TRef|Nm|TAB: Torque mode reference value|208|MPRO_TAB_OutputNo| |OSD TAB: actual table index and target|
|195|MPRO_TAB_TRef|Nm| |208|MPRO_TAB_OutputNo| | |
|196|MPRO_TAB_SAcc|rev/min/s|TAB: Speed mode acceleration|269|MPRO_TAB_Ctrl| |TAB: control word|
|196|MPRO_TAB_SAcc|rev/min/s| | | | | |
|197|MPRO_TAB_SDec|rev/min/s|TAB: Speed mode deceleration| | | | |
|197|MPRO_TAB_SDec|rev/min/s| | | | | |
|198|MPRO_TAB_SRef|rev/min|TAB: Speed mode reference value| | | | |
|198|MPRO_TAB_SRef|rev/min| | | | | |
|199|MPRO_TAB_PAcc|rev/min/s|TAB: Position control mode acceleration| | | | |
|199|MPRO_TAB_PAcc|rev/min/s| | | | | |
|200|MPRO_TAB_PDec|rev/min/s|TAB: Position control mode Acceleration| | | | |
|200|MPRO_TAB_PDec|rev/min/s| | | | | |
|201|MPRO_TAB_PSpd|rev/min|TAB: Position control mode speed| | | | |
|201|MPRO_TAB_PSpd|rev/min| | | | | |
|202|MPRO_TAB_PPos|mDegree|TAB: Position control mode reference value| | | | |
|202|MPRO_TAB_PPos|mDegree| | | | | |
|203|MPRO_TAB_PMode| |Position control table:Mode| | | | |
|203|MPRO_TAB_PMode| | | | | | |
|204|MPRO_TAB_WaitTime|ms|TAB: Wait time| | | | |
|204|MPRO_TAB_WaitTime|ms| | | | | |
|205|MPRO_TAB_Mode| |TAB mode| | | | |
|206|MPRO_Tab_MaxIdx| |TAB: Max index in AUTO mode| | | | |
|207|MPRO_TAB_ActIdx| |TAB: Actual index| | | | |

MOOG ID No.:CB40859-001 Date:11/2020

MSD ServoDrive - DeviceHelp

# 8 Motion profile

MOOG ID No.:CB40859-001 Date:11/2020

MSD ServoDrive - DeviceHelp 270

# 8.8 Analog channel (ISA00 und ISA01)

# Offset (O)

This parameter (P 174 - MPRO_ANA0_SOffset for ISA00, P 184 - MPRO_ANA1_SOffset for ISA01) compensates for component variations and is used for offset compensation purposes. Depending on the control mode being used (see Section ""Basic settings"" on page 110), the value will be stored in parameter index [0] (torque control), [1] (speed control) or [2] (position control).

# Backlash (B)

This parameter (P 175 - MPRO_ANA0_SThreshold for ISA00, P 185 - MPRO_ANA1_SThreshold for ISA01) can suppress axis motion close to the standstill (stop) position. Depending on the control mode being used (see Section ""Basic settings"" on page 110), the value will be stored in parameter index [0] (torque control), [1] (speed control) or [2] (position control).

Image 8.68: “Analog channel” screen

# Acceleration ramp

Two standard analog inputs (ISA00, ISA01) are available. These inputs can be configured...

- with negative values for analog setpoint settings
- with positive values for digital setpoint processing

(P 109[0] - MPRO_INPUT_FS_ISA00 and P 110[0] - MPRO_INPUT_FS_ISA01).

see also section ""Analog Inputs"" on page 303. By using the ""REV(-2) = Analog setpoint"" setting, an analog input voltage of ±10 V can be processed as a setpoint.

# Deceleration ramp

This parameter serves as a deceleration ramp for torque control (P 176[1] - MPRO_ANA0_TRamp for ISA00, P 186[1] - MPRO_ANA1_TRamp for ISA01) or speed control (P 177[1] - MPRO_ANA0_SRamp for ISA00, P 187[1] - MPRO_ANA1_SRamp for ISA01). Depending on the control mode being used (see Section ""Basic settings"" on page 110), the value will be stored in parameter index [0] (torque control), [1] (speed control) or [2] (position control).

This parameter (P 173 - MPRO_ANA0_Scale for ISA00, P 183 - MPRO_ANA1_Scale for ISA01) is used to define which speed / which torque / which position corresponds to the maximum analog value. Depending on the control mode being used (see Section ""Basic settings"" on page 110), the value will be stored in parameter index [0] (torque control), [1] (speed control) or [2] (position control).

# 8.8.1 Special characteristics of position control mode

A threshold value can also be specified which generates a run-on range around the last reference value. A ramp function calculates a motion profile for the position reference from pre-defined acceleration and speed limits.

The position references on the analog channel are not applied immediately, but dependent on a digital input. Accordingly, one of the ISD00 to ISD06 digital inputs must be set to a value of ""REFANAEN(28) = Enable analog reference value"" (see Section ""Digital inputs"" on page 290). The position setpoint being received will only be applied if the corresponding digital input is active. The acceleration is entered using P 173[0] - MPRO_ANA0_TScale or P 183[0] - MPRO_ANA1_TScale.

# 8.8.2 Wire Break Monitoring

P 399 - CON_ANAWireBrk_Th can be used to configure wire break monitoring for the analog inputs. For details see Section ""Wire Break Monitoring"" on page 306.

|Function|TLIM (-4)|OVR (-3)|REFV (-2)|leer (-1)|OFF (0)|
|---|---|---|---|---|---|
|Digital|(1)-(28)|(1)-(28)|(1)-(28)|(1)-(28)|(1)-(28)|
|Analog channel|Filter|Scale|Offset|Profile|generator|

Control

Image 8.69: Reference processing structure

MOOG ID No.:CB40859-001 Date:11/2020

MSD ServoDrive - DeviceHelp 271

# 8 Motion profile

# 8 Motion profile

MOOG ID No.:CB40859-001 Date:11/2020

|ID|Index Name|Unit|Description|ID|
|---|---|---|---|---|
|395|CON_ANA_Isaf_Scaled| |Analog inputs: Values (filt, norm, comp, scaled)|174|
|395|0 ISA00| |Scaled, compensated, filtered, normalized value|175|
|395|1 ISA01| |Scaled, compensated, filtered, normalized value| |
|396|CON_ANA_Scale_ThUpper| |Analog inputs: Upper scaling limits|175|
|396|0 ISA00|%|Upper scaling (@ 10 V) threshold|175|
|396|1 ISA01|%|Upper scaling (@ 10 V) threshold| |
|397|CON_ANA_Scale_ThZero| |Analog inputs: Zero scaling thresholds|176|
|397|0 ISA00|V|Zero scaling threshold (+/-)|176|
|397|1 ISA01|V|Zero scaling threshold (+/-)| |
|398|CON_ANA_Scale_ThLower| |Analog inputs: Lower scaling limits|177|
|398|0 ISA00|%|Lower scaling (@ zero threshold) threshold|177|
|398|1 ISA01|%|Lower scaling (@ zero threshold) threshold| |
|399|CON_ANA_WireBrk_Th| |Analog inputs: Wire break thresholds|Table 8.26:|
|399|0 ISA00|V|Wire break detection threshold| |
|399|1 ISA01|V|Wire break detection threshold| |
|405|0 CON_ANA_Filt0|ms|Analog input ISA00: Filter time constant (PT 1)|ID|
|408|CON_ANA_Isaf_Norm| |Analog inputs: Values (filt, norm)|183|
|408|0 ISA00| |Filtered, normalized value|183|
|408|1 ISA01| |Filtered, normalized value|183|

Table 8.25: “Analog channel” parameters

|ID|Index Name|Unit|Description|ID|
|---|---|---|---|---|
|173|MPRO_ANA0_Scale| |ANA0: scale factors|184|
|173|0 MPRO_ANA0_TScale|Nm|ANA0: scale factor torque reference|185|
|173|1 MPRO_ANA0_SScale|rev/min|ANA0: scale factor speed reference|185|
|173|2 MPRO_ANA0_PScale|mDegree|ANA0: scale factor position reference| |
|174|MPRO_ANA0_Offset| |ANA0: offsets|185|
|174|0 MPRO_ANA0_TOffset|Nm|ANA0: offsets for torque reference|185|

Table 8.26: “Analog channel ISA00” parameters

|Index Name|Unit|Description|
|---|---|---|
|1 MPRO_ANA0_SOffset|rev/min|ANA0: offsets for speed reference|
|2 MPRO_ANA0_POffset|mDegree|ANA0: offsets for position reference|
|MPRO_ANA0_Threshold| |ANA0: thresholds|
|0 MPRO_ANA0_TThreshold|Nm|ANA0: threshold for torque reference|
|1 MPRO_ANA0_SThreshold|rev/min|ANA0: threshold for speed reference|
|2 MPRO_ANA0_PThreshold|mDegree|ANA0: threshold for position reference|
|MPRO_ANA0_TRamp| |ANA0: Torque mode acceleration [0] and deceleration [1]|
|0 MPRO_ANA0_TRamp|Nm/s| |
|1 MPRO_ANA0_TRamp|Nm/s| |
|MPRO_ANA0_SRamp| |ANA0: Speed mode acceleration [0] and deceleration [1]|
|0 MPRO_ANA0_SRamp|SPEED/s| |
|1 MPRO_ANA0_SRamp|SPEED/s| |

“Analog channel ISA00” parameters (continue)

|Index Name|Unit|Description|
|---|---|---|
|MPRO_ANA1_Scale| |ANA1: scale factors|
|0 MPRO_ANA1_TScale|Nm|ANA0: scale factor torque reference|
|1 MPRO_ANA1_SScale|rev/min|ANA0: scale factor speed reference|
|2 MPRO_ANA1_PScale|mDegree|ANA0: scale factor position reference|
|MPRO_ANA1_Offset| |ANA1: offsets|
|0 MPRO_ANA1_TOffset|Nm|ANA1: offsets for torque reference|
|1 MPRO_ANA1_SOffset|rev/min|ANA1: offsets for speed reference|
|2 MPRO_ANA1_POffset|mDegree|ANA1: offsets for position reference|
|MPRO_ANA1_Threshold| |ANA1: thresholds|
|0 MPRO_ANA1_TThreshold|Nm|ANA1: threshold for torque reference|
|1 MPRO_ANA1_SThreshold|rev/min|ANA1: threshold for speed reference|
|2 MPRO_ANA1_PThreshold|mDegree|ANA1: threshold for position reference|

“Analog channel ISA01” parameters

# 8 Motion profile

|ID|Index Name|Unit|Description|
|---|---|---|---|
|186|MPRO_ANA1_TRamp|Nm/s|ANA1: Torque mode acceleration [0] and deceleration[1]|
|186|MPRO_ANA1_TRamp|Nm/s| |
|187|MPRO_ANA1_SRamp|SPEED/s|ANA1: Speed mode acceleration [0] and deceleration [1]|
|187|MPRO_ANA1_SRamp|SPEED/s| |

# Table 8.27: “Analog channel ISA01” parameters (continue)

Display

- System state
- Initialization on device startup
- Not ready (DC link voltage possibly too low)
- Start inhibit (DC link voltage present, power stage off)
- Starting lockout
- Ready for start
- Control initialization: Auto commutation, flux build-up etc.

# Table 8.28: Central state machine according to CiA 402 device display

MOOG ID No.:CB40859-001 Date:11/2020

MSD ServoDrive - DeviceHelp 273

# 8 Motion profile

MOOG ID No.:CB40859-001 Date:11/2020

MSD ServoDrive - DeviceHelp 274

|Display|System state|power disabled|fault|
|---|---|---|---|
|Control enabled|0|Start|7|
| |fault reaction active|0|14|
|Quick stop active|1|not ready|8|
| |to switch on|1|17|
|Error reaction active|2|switch on|disabled|
| |2|7| |
|Error state (in this state the error is indicated directly on the display.)|3|ready to|switch on|
|Device is reset (display flashes)|power enabled|3|6|
| |10|12| |
|• Number [5.] flashes when “STO” (Safe Torque Off) input is active. Display goes out when STO inactive.| | | |
|• The dot on the display flashes when the power stage is active.| | | |

Table 8.28: Central state machine according to CiA 402 device display (continue)

NOTE

l The system states indicated on the display may differ from the states in the table depending on the drive profile setting.

Image 8.70: State machine diagram based on CANopen communications

⓪ to ① State number

1 to 17 State transition (No. 17: DC link voltage cut off)

Legend for “State machine diagram based on CANopen communications” figure

# 8.10 Touch probe

|ID|Index Name / Setting|
|---|---|
|241|0 MPRO_TP_Position|
|241|1 MPRO_TP_Position|
|241|2 MPRO_TP_Position|
|241|3 MPRO_TP_Position|
|241|4 MPRO_TP_Position|
|1400|0 MPRO_TP_Config|
| |TP_TP (0)|
| |AB (1)|
| |PD_UP (2)|
| |PD_DOWN (3)|
| |PC_PC (4)|
| |PC_TP (5)|
| |TP_PC (6)|
| |ENC_ENC (7)|
| |ENC_TP (8)|
| |TP_ENC (9)|

Using the touch probe inputs, touch probe functions can be performed. In order to be able to do this, P 106[0] - MPRO_INPUT_FS_ISD05 and P 107[0] - MPRO_INPUT_FS_ISD06 must be used to set digital inputs ISD05 and ISD06 to ""PROBE(15) = Touch probe (only ISD05/06)"" (see Section ""Digital inputs"" on page 290). HTL encoders can be evaluated or pulse counters implemented using the MSD PLC.

The touch probe can be triggered with P 240 - MPRO_TP_Ctrl. This enables triggering on a positive or negative edge, or on both edges, of the signal detected on the touch probe inputs. After the measurement, the parameter jumps back to the value ""NONE (0)"" and the latch position is mapped in the corresponding subindex of parameter P 241 - MPRO_TP_Position. A continuous touch probe mode is not possible at present, so the touch probe has to be reactivated after the measurement.

P 1402 - MPRO_TP_Channel can be used to select various positions as actual value sources of the latch position for the touch probe functionality. The following table provides an overview of the available settings. The counters are accessed via the MSD PLC or a bus system.

|ID|Index Name / Setting|Unit|Description|
|---|---|---|---|
|240|MPRO_TP_Ctrl|Touch probe: Control| |
| |0| |NONE (0) = No function|
| |1| |POS (1) = Positive edge|
| |2| |NEG (2) = Negative edge|
| |3| |BOTH (3) = Both edges|
|240|0 MPRO_TP_Ctrl| | |
|240|1 MPRO_TP_Ctrl| | |
|240|2 MPRO_TP_Ctrl| | |
|241|MPRO_TP_Position|Probe: Pos. high/low edge of TP0/1, encoder zero pulse| |

Table 8.29: “Touch probe” parameters

MOOG ID No.:CB40859-001 Date:11/2020

# 8 Motion profile

|Unit|Description|
|---|---|
|mDegree|Touch probe: Configuration|
|mDegree|TP0, TP1 touch probe|
|mDegree|TP0, TP1 as encoder, A/B as quadrature counting|
|mDegree|TP0, TP1 as encoder, pulse (TP0) / direction (TP1), count up on direction high|
|mDegree|TP0, TP1 as encoder, pulse (TP0) / direction (TP1), count down on direction high|
|mDegree|TP0 pulse counter, TP1 pulse counter|
|mDegree|TP0 pulse counter, TP1 touch probe|
|mDegree|TP1 touch probe, TP0 pulse counter|
|mDegree|TP0 encoder counter, TP1 encoder counter|
|mDegree|TP0 encoder counter, TP1 touch probe|
|mDegree|TP0 touch probe, TP1 encoder counter|

Touch probe: Channel

|Unit|Description|
|---|---|
|ACTPOS (0)|Actual position in user units|
|ACTPOSINC (1)|Actual position in increments|
|MASTERPOS (2)|Master position in increments|
|ENCPOS_CH1 (3)|Encoder position Channel 1|
|ENCPOS_CH1_INC (4)|Encoder position Channel 1 in increments|
|ENCPOS_CH2 (5)|Encoder position Channel 2|
|ENCPOS_CH2_INC (6)|Encoder position Channel 2 in increments|

# 8 Motion profile

MOOG ID No.:CB40859-001 Date:11/2020 MSD ServoDrive - DeviceHelp 276

|ID|Index Name / Setting|Unit|Description|
|---|---|---|---|
|7|ENCPOS_CH3 (7)| |Encoder position Channel 3|
|8|ENCPOS_CH3_INC (8)| |Encoder position Channel 3 in increments|
|9|ENCPOS_CH4 (9)| |Encoder position Channel 4|
|10|ENCPOS_CH4_INC (10)| |Encoder position Channel 4 in increments|
|11|ACTPOS2 (11)| |Actual position of redundant encoder in user units|
|12|Sercos (12)| |Referred to Sercos profile parameters S-x-0426, S-x-0427|
|13|UserRefPos(13)| |Reference position in user units|
|14|MasterPosST(14)| |Master position (ECAM, EGEAR) singleturn, always steps|
|15|CommonMasterPos(15)| |Master position (ECAM, EGEAR) singleturn, always steps|
|16|CommonMasterPosST(15)| |Master position (ECAM, EGEAR) singleturn, always steps|
|1402|MPRO_TP_Channel| | |
|1402|MPRO_TP_Channel| | |
|1402|MPRO_TP_Channel| | |
|1404|MPRO_TP_Lines| |Touch probe: Lines @ pulse counter on channel x|
|1404|MPRO_TP_Lines| | |
|1404|MPRO_TP_Lines| | |

Image 8.71: “Synchronized motion” screen

There are various modes available in the “synchronization mode” drop-down menu (P 242[0] - MPRO_ECAM_SyncModMode):

- Off(0) = Synchronized motion off
- ECAM_iPlc(1) = Electronic cam plate via MSD PLC
- EGEAR_iPlc(2) = Electr. gear unit via MSD PLC
- ECAM_PARA(3) = Electronic camming via parameters
- EGEAR_PARA(4) = Electronic gearing via parameters

NOTE: For more information refer to the bus system User Manuals or the description of the MSD PLC.

# 8.11.1 Electronic cam plate

The other parameters are configured in separate screens that can be accessed with the corresponding buttons.

- Master configuration (see Section ""Master configuration"" on page 280)
- Electronic gearing (see Section ""Electronic gearing"" on page 283)
- Electronic camming (see Section ""Electronic cam plate"" on page 277)

P 1318[0] - MPRO_ECAM_ControlWord is the control word for “synchronized motion” (see Section ""Control word for synchronized motion"" on page 279).

P 1326[0] - MPRO_ECAM_StatusWord is the status word for “synchronized motion” (see Section ""Status word for synchronized motion"" on page 279).

# 8.11.1.1 Table selection

|ID|Index Name|Unit|Description|
|---|---|---|---|
|1300|MPRO_ECAM_CTS_| |ECAM: CamTableSelect - Master reference|
|1301|MasterRef| | |
|1305|MPRO_ECAM_CTS_| |ECAM: CamTableSelect - Method for changing the camtable|
|1306|MPRO_ECAM_CTS_| |ECAM: CamTableSelect - Mode for changing the camtable|
|1307|MPRO_ECAM_CTS_|incr|ECAM: CamTableSelect - Distance for changing the camtable|
|242|MPRO_ECAM_| |ECAM / EGEAR: Mode of synchronized motion SyncModMode|
|265|MPRO_ECAM_| |ECAM / EGEAR: Slave speed factor (1 = 100%).|
|266|CamSlave_SpeedFactor| | |
|268|MPRO_ECAM_| |ECAM / EGEAR: Mode of switching off sync. motion|

# 8.11.1.2 Synchronization

|ID|Index Name|Unit|Description|
|---|---|---|---|
|1342|MPRO_ECAM_CI_|incr|ECAM: CamIn - Synchronization position (multiturn part)|
|1343|MPRO_ECAM_CO_|incr|ECAM: CamOut - Decoupling pos. (multiturn part)|
|1303|MPRO_ECAM_CI_|incr|ECAM: CamIn - Master offset|
|1308|MPRO_ECAM_CI_| |ECAM: CamIn - Master reference|
|1309|MPRO_ECAM_CI_| |ECAM: CamIn - Slave reference|
|1310|MPRO_ECAM_CI_| |ECAM: CamIn - Coupling mode|
|1311|MPRO_ECAM_CI_|incr|ECAM: CamIn - Coupling distance|
|1312|MPRO_ECAM_CI_|incr|ECAM: CamIn - Synchronization position|

Table 8.31: “Electronic camming - Table selection” parameters

Table 8.30: “Synchronized motion” parameters

Table 8.32: “Electronic camming - Synchronization” parameters

MOOG ID No.:CB40859-001 Date:11/2020

MSD ServoDrive - DeviceHelp 277

# 8 Motion profile

MOOG ID No.:CB40859-001 Date:11/2020 MSD ServoDrive - DeviceHelp 278

|ID|Index|Name|Unit|Description|
|---|---|---|---|---|
|1313|0|MPRO_ECAM_CO_SyncPosST|(singleturn part)|ECAM: CamOut - Slave reference|
|1314|0|MPRO_ECAM_CO_DecouplingMode|63|ECAM: CamOut - Decoupling mode|
|1315|0|MPRO_ECAM_CO_BreakingPosST|incr|ECAM: CamOut - Decoupling position|
|1316|0|MPRO_ECAM_CO_DecouplingDist|incr|ECAM: CamOut - Decoupling distance|
|1317|0|MPRO_ECAM_CO_StandstillPos|mDegree|ECAM: CamOut - Slave standstill position|

# Table 8.32: “Electronic camming - Synchronization” parameters (continue)

|ID|Index|Name|Unit|Description|
|---|---|---|---|---|
|1346| |MPRO_ECAM_SP_Table| |ECAM: Setpoint table interface|
|1346|0|Index| |Index of setpoint table|
|1346|1|Value| |Value at index of setpoint table|
|1347|0 to 31|MPRO_ECAM_SP_Index| |ECAM: Setpoint segments start index|
|1348|0 to 31|MPRO_ECAM_SP_Length| |ECAM: Setpoint segments length|
|1349|0 to 31|Length| | |
|1350|0|MPRO_ECAM_SP_MaDist| |ECAM: Setpoint segments master distance|
|1351|0|MPRO_ECAM_SP_IpoType| |ECAM: Setpoint segments interpolation type|
|1352|0 to 31|Checksum| |ECAM: Setpoint table checksum|
|1353|0 to 31|GainNum| |ECAM: Setpoint segments gain numerator|
| | |GainDen| |ECAM: Setpoint segments gain denominator|

# Table 8.33: “Electronic camming - Table segments” parameters

|ID|Index|Name|Unit|Description|
|---|---|---|---|---|
|1329|0 to 63|MPRO_ECAM_SegData_IndexNext| |ECAM: Index of the following segment|
|1330|0 to 63|MPRO_ECAM_SegData_IndexPrev| |ECAM: Index of the previous segment|
|1331|0 to 63|MPRO_ECAM_SegData_ProfileMode| |ECAM: Profile mode of the current segment|
|1332|0 to 63|MPRO_ECAM_SegData_DistMaster| |ECAM: Length of the master section of the current segment|
|1333|0 to 63|MPRO_ECAM_SegData_DistSlave| |ECAM: Length of the slave section of the current segment|
|1334|0 to 63|MPRO_ECAM_SegData_Lambda| |ECAM: Lambda value of the current segment|
|1335|0 to 63|MPRO_ECAM_SegData_StatusWord| |ECAM: Status word of the current segment|
|1336|0 to 63|MPRO_ECAM_SegData_ControlWord| |ECAM: Control word of the current segment|

# 8.11.2 Control word for synchronized motion

|Bit|Function|PLC function|Bit number|Description|
|---|---|---|---|---|
|0-7|Start segment (8-bit value)|-|0-7|Actual segment (8-bit value)|
|8-15|Reserved|-| |Actual ECAM / EGEAR state machine state (4 Bit value)|
|16|Absolute (true) / relative (false) master relationship|-| |- 0: ECAM / EGEAR asynchronous
- 1: ECAM / EGEAR synchronous
|
|17|Absolute (true) / relative (false) master (CAM) relationship at cam in|-| |- 2: ECAM / EGEAR synchronizing
- 3: ECAM / EGEAR desynchronizing
|
|18|Absolute (true) / relative (false) slave (CAM) relationship at cam in|-| |- 4: ECAM / EGEAR active and waiting for going asynchronous
|
|19-23|Reserved|-| |- 5: ECAM / EGEAR inactive and waiting for going synchronous
|
|24|Change gear ratio of the electronic gear online|MCB_GearRatioChange| | |
|25|Disable master calculation|MCB_Cam_MasterEnable| | |
|26|Enable master calculation|MCB_Cam_MasterEnable| | |
|27|Select CAM table|MCB_CamTableSelect| | |
|28|Start Ecam|MCB_CamIn| | |
|29|Stop Ecam|MCB_CamOut| | |
|30|Start Egear|MCB_GearIn| | |
|31|Stop Egear|MCB_GearOut| | |

# 8.11.3 Status word for synchronized motion

|Bit|Function|PLC function|Bit number|Description|
|---|---|---|---|---|
|12-26|Reserved|-| | |
|27|ECAM / EGEAR is active|-| | |
|28|Valid segments chosen|-| | |
|29|Master data are valid|-| | |
|30|Master is initialized|-| | |
|31|Master calculation is active|-| | |

Table 8.35: Control word ECAM (P 1318[0] - MPRO_ECAM_ControlWord)

Table 8.36: ECAM status word (P 1326[0] - MPRO_ECAM_StatusWord)

MOOG ID No.:CB40859-001 Date:11/2020 MSD ServoDrive - DeviceHelp 279

# 8 Motion profile

# 8 Motion profile

MOOG ID No.:CB40859-001 Date:11/2020

MSD ServoDrive - DeviceHelp 280

# 8.11.4 Master configuration

the master encoder, you will need to set the resolution relative to a single motor revolution in P 250 - MPRO_ECAM_PARAMaster_Amplitude (see below).

- ENC CH1 (3) = Encoder channel 1 X7 (Sin/Cos)
- ENC CH2 (4) = Encoder channel 2 X6 (Resolver)
- ENC CH3 (5) = Encoder channel 3 X8 (optional)

This function is only available if an external interface X8 (option module) is present.

- TP0 (6) = Pulse counter on probe channel 0 (TP0)
- TP1 (7) = Pulse counter on probe channel 1 (TP1)
- ENC_CH4 (8) = Encoder channel 4 (p. e. fieldbus)
- TWIN_POS (9) = TWIN remote reference position (P-2607)

Image 8.72: “Master configuration” screen

# Channel selection (master encoder)

P 1319[0] - MPRO_ECAM_CamMaster_AxisType is used to define the master encoder.

- NO AXIS (0) = No axis
- VIRTUAL MASTER (1) = Virtual master

If you select this function, you will be able to configure additional settings by clicking on the enabled “Options...” button (see Section ""Virtual Master"" on page 286).

- PARA (2) = Master parameter interface

If you select this function because a higher-level controller is being used as

# Anti-reverse mode

Slave only starts moving along with it again as soon as the master reaches the zero position.

P 1320[0] - MPRO_ECAM_CamMaster_RevLockMode is used to define the reverse lock mode, which can be used either with or without path compensation. The dashed lines in the following diagrams indicate what the engagement distance is:

# Example:

If the master, which has moved two motor revolutions in the direction blocked for the slave, then moves in the unblocked direction again, the slave only moves off when the master has traversed the zero point.

- INACTIVE (0) = Reverse lock inactive
- ACTIVE (2) = Reverse lock enabled - without path optimization
- ACTIVE WAY COMP (1) = Reverse lock active - with way compensation

While the slave accelerates to the speed of the master during engagement, the master and slave do not move synchronously. This function needs to be selected in order to quickly catch up to the master that is running ahead.

# Example:

- Master (black line) rotates in the blocked direction
- The slave (blue line) remains stopped
- Master rotates in the unblocked direction again
- The slave follows the master directly in the unblocked direction

Assume the master has moved two motor revolutions in the direction for which the slave lock is enabled. If the master now moves in the direction for which there is no lock, the slave will immediately start running in that direction.

MOOG ID No.:CB40859-001 Date:11/2020

MSD ServoDrive - DeviceHelp 281

# 8 Motion profile

MOOG ID No.:CB40859-001 Date:11/2020 MSD ServoDrive - DeviceHelp 282

|Filter type|ID|Index Name|Unit|Description|
|---|---|---|---|---|
|When using a real master encoder, encoder signals may be subject to noise.|P 1340|1319|0|MPRO_ECAM_CamMaster_AxisType|
| | |MPRO_ECAM_CamMaster_SpeedFilTyp| |ECAM / EGEAR: Channel selection of internal master input|
| | |1320|0|MPRO_ECAM_CamMaster_RevLockMode|
| | |1321|0|MPRO_ECAM_CamMaster_Amplitude|
| | |1322|0|MPRO_ECAM_CamMaster_GearNum|
| | |1323|0|MPRO_ECAM_CamMaster_GearDen|
|Filter time|1327|0|ms|ECAM / EGEAR: Filter time constant of master|
|If P 1340[0] is used to enable a filter, P 1327[0] - MPRO_ECAM_CamMaster_SpeedTFil can be used to define the corresponding filter time.|1328|0|speed|ECAM / EGEAR: Speed factor of the internal master|
|Speed factor|1340|0| |MPRO_ECAM_CamMaster_SpeedFilTyp|
|The master encoder can be assigned an additional speed factor P 1328[0] - MPRO_ECAM_CamMaster_SpeedFactor.|1341|0|incr|ECAM / EGEAR: Master drive offset|

Table 8.37: “Synchronized motion - Master configuration” parameters (continue)

| | | |ID|Index Name|Unit|Description|
|---|---|---|---|---|---|---|
|247|0|MPRO_ECAM_ParaMaster_ActPos|incr|ECAM / EGEAR: Parameter interface master position| | |
|248|0|MPRO_ECAM_ParaMaster_ActSpeed|rpm|ECAM / EGEAR: Parameter interface master speed| | |
|249|0|MPRO_ECAM_ParaMaster_ActAcc|rpm|ECAM / EGEAR: Parameter interface master acceleration| | |
| |250|0|MPRO_ECAM_ParaMaster_Amplitude| |ECAM / EGEAR: Parameter interface master amplitude| |

Table 8.37: “Synchronized motion - Master configuration” parameters

# 8.11.5 Electronic gearing

# Gear ratio

The gear ratio is specified as a fraction. This ensures that the position references can be translated to the motor shaft with no rounding error.

- ""Slave"" (P 252[0] - MPRO_ECAM_Egear_GearNum) is the numerator
- ""Master"" (P 251[0] - MPRO_ECAM_Egear_GearDen) is the denominator

# Scaling of speed pre-control

Defined with P 265[0] - MPRO_ECAM_CamSlave_SpeedFactor definiert.

# Scaling of torque pre-control

Defined with P 266[0] - MPRO_ECAM_CamSlave_TorqueFactor.

# Engagement

See Section ""Engagement"" on page 284.

# Disengagement

See Section ""Disengagement"" on page 285.

|ID|Index Name|Unit|Description|
|---|---|---|---|
|251|0 MPRO_ECAM_Egear_GearDen| |EGEAR: Gear denominator|
|252|0 MPRO_ECAM_Egear_GearNum| |EGEAR: Numerator of gear ratio|
|1344|0 MPRO_ECAM_Egear_LimRefAcc|rpm/s|EGEAR: Acceleration limit for reference|
|1345|0 MPRO_ECAM_Egear_LimRefJerk|rpm/s²|EGEAR: Jerk limit for reference|

Table 8.38: “Synchronized motion - Electronic gearing” parameters

Image 8.73: ""Electronic gearing"" screen

MOOG ID No.:CB40859-001 Date:11/2020 MSD ServoDrive - DeviceHelp 283

# 8 Motion profile

# 8 Motion profile

MOOG ID No.:CB40859-001 Date:11/2020

MSD ServoDrive - DeviceHelp 284

# 8.11.6 Engagement

used to define the engagement distance (between the dashed lines).

P 253[0] - MPRO_ECAM_Egear_GearInMode is used to define the mode for engagement.

- DIRECT (0) = Direct
- Direct engagement: Angular synchronous; with jerking (no ramps).
- CROSSFADE (3) = Crossfading
- Engagement with crossfading function (5th degree polynomial): Angular synchronous; jerk-limited; speed will overshoot during engagement.
- RAMP (1) = Linear speed ramp
- Engagement with linear acceleration: Not angular synchronous; with jerking.
- FADE (2) = Engagement fade-out
- Engagement with fade-in function (5th degree polynomial): Not angular synchronous; jerk-limited. The position is ignored. ",What does the backlash parameter do in the analog channels ISA00 and ISA01 in the 'MSD ServoDrive - DeviceHelp' document?,A3,Backlash settings like P 175 and P 185 minimize motion near standstill.,0.83203125,0.89453125,3.078125,1.2265625,0.2470703125
28,msd_servo_drive.txt,76,b87ca5e232c2bdbb6fa16a8a401c6b5d285dc0183e73cc9d134de13dd2fc71d2,"MOOG ID No.:CB40859-001 Date:11/2020

MSD ServoDrive - DeviceHelp 267

# 8 Motion profile

MOOG ID No.:CB40859-001 Date:11/2020 MSD ServoDrive - DeviceHelp 268

# Deceleration

With ...

- P 194 - MPRO_TAB_TDec (for torque control) or
- P 197 - MPRO_TAB_SDec (for speed control) or
- P 200 - MPRO_TAB_PDec (for position control)

and indexes 0–15, the deceleration for each individual motion task can be defined. The input must not be zero.

# Wait time in Auto mode

P 204 - MPRO_TAB_WaitTime is used to define the wait time before the next motion task is carried out.

# Maximum table index in Auto mode

P 206[0] - MPRO_Tab_MaxIdx is used to define the table index up to which driving jobs will be carried out in one of the auto modes.

# Current table index

P 207[0] - MPRO_Tab_ActIdx will show the index for the motion task that is currently active. If parameter P 205 MPRO_TAB_Mode is set to “Para(0)”, a driving set can be entered and approached directly.

# Activation of reference table

The following procedures can be used in order to activate the setpoint table for operation.

|ID|Index Name|Unit|Description|
|---|---|---|---|
|193|MPRO_TAB_TAcc|TAB: Torque mode acceleration|Nm/ms|
|193|0|MPRO_TAB_TAcc|Nm/ms|
|193|1 - 15|MPRO_TAB_TAcc|Nm/ms|
|194|MPRO_TAB_TDec|TAB: Torque mode deceleration| |
|194|0|MPRO_TAB_TDec|Nm/ms|
|194|1 - 15|MPRO_TAB_TDec|Nm/ms|

# Table 8.23: Activation of table references

# Table 8.24: “Setpoint table settings” parameters

# Table 8.24: “Setpoint table settings” parameters (continue)

|ID|Index Name|Unit|Description|ID|Index Name|Unit|Description|
|---|---|---|---|---|---|---|---|
|195|MPRO_TAB_TRef|Nm|TAB: Torque mode reference value|208|MPRO_TAB_OutputNo| |OSD TAB: actual table index and target|
|195|MPRO_TAB_TRef|Nm| |208|MPRO_TAB_OutputNo| | |
|196|MPRO_TAB_SAcc|rev/min/s|TAB: Speed mode acceleration|269|MPRO_TAB_Ctrl| |TAB: control word|
|196|MPRO_TAB_SAcc|rev/min/s| | | | | |
|197|MPRO_TAB_SDec|rev/min/s|TAB: Speed mode deceleration| | | | |
|197|MPRO_TAB_SDec|rev/min/s| | | | | |
|198|MPRO_TAB_SRef|rev/min|TAB: Speed mode reference value| | | | |
|198|MPRO_TAB_SRef|rev/min| | | | | |
|199|MPRO_TAB_PAcc|rev/min/s|TAB: Position control mode acceleration| | | | |
|199|MPRO_TAB_PAcc|rev/min/s| | | | | |
|200|MPRO_TAB_PDec|rev/min/s|TAB: Position control mode Acceleration| | | | |
|200|MPRO_TAB_PDec|rev/min/s| | | | | |
|201|MPRO_TAB_PSpd|rev/min|TAB: Position control mode speed| | | | |
|201|MPRO_TAB_PSpd|rev/min| | | | | |
|202|MPRO_TAB_PPos|mDegree|TAB: Position control mode reference value| | | | |
|202|MPRO_TAB_PPos|mDegree| | | | | |
|203|MPRO_TAB_PMode| |Position control table:Mode| | | | |
|203|MPRO_TAB_PMode| | | | | | |
|204|MPRO_TAB_WaitTime|ms|TAB: Wait time| | | | |
|204|MPRO_TAB_WaitTime|ms| | | | | |
|205|MPRO_TAB_Mode| |TAB mode| | | | |
|206|MPRO_Tab_MaxIdx| |TAB: Max index in AUTO mode| | | | |
|207|MPRO_TAB_ActIdx| |TAB: Actual index| | | | |

MOOG ID No.:CB40859-001 Date:11/2020

MSD ServoDrive - DeviceHelp

# 8 Motion profile

MOOG ID No.:CB40859-001 Date:11/2020

MSD ServoDrive - DeviceHelp 270

# 8.8 Analog channel (ISA00 und ISA01)

# Offset (O)

This parameter (P 174 - MPRO_ANA0_SOffset for ISA00, P 184 - MPRO_ANA1_SOffset for ISA01) compensates for component variations and is used for offset compensation purposes. Depending on the control mode being used (see Section ""Basic settings"" on page 110), the value will be stored in parameter index [0] (torque control), [1] (speed control) or [2] (position control).

# Backlash (B)

This parameter (P 175 - MPRO_ANA0_SThreshold for ISA00, P 185 - MPRO_ANA1_SThreshold for ISA01) can suppress axis motion close to the standstill (stop) position. Depending on the control mode being used (see Section ""Basic settings"" on page 110), the value will be stored in parameter index [0] (torque control), [1] (speed control) or [2] (position control).

Image 8.68: “Analog channel” screen

# Acceleration ramp

Two standard analog inputs (ISA00, ISA01) are available. These inputs can be configured...

- with negative values for analog setpoint settings
- with positive values for digital setpoint processing

(P 109[0] - MPRO_INPUT_FS_ISA00 and P 110[0] - MPRO_INPUT_FS_ISA01).

see also section ""Analog Inputs"" on page 303. By using the ""REV(-2) = Analog setpoint"" setting, an analog input voltage of ±10 V can be processed as a setpoint.

# Deceleration ramp

This parameter serves as a deceleration ramp for torque control (P 176[1] - MPRO_ANA0_TRamp for ISA00, P 186[1] - MPRO_ANA1_TRamp for ISA01) or speed control (P 177[1] - MPRO_ANA0_SRamp for ISA00, P 187[1] - MPRO_ANA1_SRamp for ISA01). Depending on the control mode being used (see Section ""Basic settings"" on page 110), the value will be stored in parameter index [0] (torque control), [1] (speed control) or [2] (position control).

This parameter (P 173 - MPRO_ANA0_Scale for ISA00, P 183 - MPRO_ANA1_Scale for ISA01) is used to define which speed / which torque / which position corresponds to the maximum analog value. Depending on the control mode being used (see Section ""Basic settings"" on page 110), the value will be stored in parameter index [0] (torque control), [1] (speed control) or [2] (position control).

# 8.8.1 Special characteristics of position control mode

A threshold value can also be specified which generates a run-on range around the last reference value. A ramp function calculates a motion profile for the position reference from pre-defined acceleration and speed limits.

The position references on the analog channel are not applied immediately, but dependent on a digital input. Accordingly, one of the ISD00 to ISD06 digital inputs must be set to a value of ""REFANAEN(28) = Enable analog reference value"" (see Section ""Digital inputs"" on page 290). The position setpoint being received will only be applied if the corresponding digital input is active. The acceleration is entered using P 173[0] - MPRO_ANA0_TScale or P 183[0] - MPRO_ANA1_TScale.

# 8.8.2 Wire Break Monitoring

P 399 - CON_ANAWireBrk_Th can be used to configure wire break monitoring for the analog inputs. For details see Section ""Wire Break Monitoring"" on page 306.

|Function|TLIM (-4)|OVR (-3)|REFV (-2)|leer (-1)|OFF (0)|
|---|---|---|---|---|---|
|Digital|(1)-(28)|(1)-(28)|(1)-(28)|(1)-(28)|(1)-(28)|
|Analog channel|Filter|Scale|Offset|Profile|generator|

Control

Image 8.69: Reference processing structure

MOOG ID No.:CB40859-001 Date:11/2020

MSD ServoDrive - DeviceHelp 271

# 8 Motion profile

# 8 Motion profile

MOOG ID No.:CB40859-001 Date:11/2020

|ID|Index Name|Unit|Description|ID|
|---|---|---|---|---|
|395|CON_ANA_Isaf_Scaled| |Analog inputs: Values (filt, norm, comp, scaled)|174|
|395|0 ISA00| |Scaled, compensated, filtered, normalized value|175|
|395|1 ISA01| |Scaled, compensated, filtered, normalized value| |
|396|CON_ANA_Scale_ThUpper| |Analog inputs: Upper scaling limits|175|
|396|0 ISA00|%|Upper scaling (@ 10 V) threshold|175|
|396|1 ISA01|%|Upper scaling (@ 10 V) threshold| |
|397|CON_ANA_Scale_ThZero| |Analog inputs: Zero scaling thresholds|176|
|397|0 ISA00|V|Zero scaling threshold (+/-)|176|
|397|1 ISA01|V|Zero scaling threshold (+/-)| |
|398|CON_ANA_Scale_ThLower| |Analog inputs: Lower scaling limits|177|
|398|0 ISA00|%|Lower scaling (@ zero threshold) threshold|177|
|398|1 ISA01|%|Lower scaling (@ zero threshold) threshold| |
|399|CON_ANA_WireBrk_Th| |Analog inputs: Wire break thresholds|Table 8.26:|
|399|0 ISA00|V|Wire break detection threshold| |
|399|1 ISA01|V|Wire break detection threshold| |
|405|0 CON_ANA_Filt0|ms|Analog input ISA00: Filter time constant (PT 1)|ID|
|408|CON_ANA_Isaf_Norm| |Analog inputs: Values (filt, norm)|183|
|408|0 ISA00| |Filtered, normalized value|183|
|408|1 ISA01| |Filtered, normalized value|183|

Table 8.25: “Analog channel” parameters

|ID|Index Name|Unit|Description|ID|
|---|---|---|---|---|
|173|MPRO_ANA0_Scale| |ANA0: scale factors|184|
|173|0 MPRO_ANA0_TScale|Nm|ANA0: scale factor torque reference|185|
|173|1 MPRO_ANA0_SScale|rev/min|ANA0: scale factor speed reference|185|
|173|2 MPRO_ANA0_PScale|mDegree|ANA0: scale factor position reference| |
|174|MPRO_ANA0_Offset| |ANA0: offsets|185|
|174|0 MPRO_ANA0_TOffset|Nm|ANA0: offsets for torque reference|185|

Table 8.26: “Analog channel ISA00” parameters

|Index Name|Unit|Description|
|---|---|---|
|1 MPRO_ANA0_SOffset|rev/min|ANA0: offsets for speed reference|
|2 MPRO_ANA0_POffset|mDegree|ANA0: offsets for position reference|
|MPRO_ANA0_Threshold| |ANA0: thresholds|
|0 MPRO_ANA0_TThreshold|Nm|ANA0: threshold for torque reference|
|1 MPRO_ANA0_SThreshold|rev/min|ANA0: threshold for speed reference|
|2 MPRO_ANA0_PThreshold|mDegree|ANA0: threshold for position reference|
|MPRO_ANA0_TRamp| |ANA0: Torque mode acceleration [0] and deceleration [1]|
|0 MPRO_ANA0_TRamp|Nm/s| |
|1 MPRO_ANA0_TRamp|Nm/s| |
|MPRO_ANA0_SRamp| |ANA0: Speed mode acceleration [0] and deceleration [1]|
|0 MPRO_ANA0_SRamp|SPEED/s| |
|1 MPRO_ANA0_SRamp|SPEED/s| |

“Analog channel ISA00” parameters (continue)

|Index Name|Unit|Description|
|---|---|---|
|MPRO_ANA1_Scale| |ANA1: scale factors|
|0 MPRO_ANA1_TScale|Nm|ANA0: scale factor torque reference|
|1 MPRO_ANA1_SScale|rev/min|ANA0: scale factor speed reference|
|2 MPRO_ANA1_PScale|mDegree|ANA0: scale factor position reference|
|MPRO_ANA1_Offset| |ANA1: offsets|
|0 MPRO_ANA1_TOffset|Nm|ANA1: offsets for torque reference|
|1 MPRO_ANA1_SOffset|rev/min|ANA1: offsets for speed reference|
|2 MPRO_ANA1_POffset|mDegree|ANA1: offsets for position reference|
|MPRO_ANA1_Threshold| |ANA1: thresholds|
|0 MPRO_ANA1_TThreshold|Nm|ANA1: threshold for torque reference|
|1 MPRO_ANA1_SThreshold|rev/min|ANA1: threshold for speed reference|
|2 MPRO_ANA1_PThreshold|mDegree|ANA1: threshold for position reference|

“Analog channel ISA01” parameters

# 8 Motion profile

|ID|Index Name|Unit|Description|
|---|---|---|---|
|186|MPRO_ANA1_TRamp|Nm/s|ANA1: Torque mode acceleration [0] and deceleration[1]|
|186|MPRO_ANA1_TRamp|Nm/s| |
|187|MPRO_ANA1_SRamp|SPEED/s|ANA1: Speed mode acceleration [0] and deceleration [1]|
|187|MPRO_ANA1_SRamp|SPEED/s| |

# Table 8.27: “Analog channel ISA01” parameters (continue)

Display

- System state
- Initialization on device startup
- Not ready (DC link voltage possibly too low)
- Start inhibit (DC link voltage present, power stage off)
- Starting lockout
- Ready for start
- Control initialization: Auto commutation, flux build-up etc.

# Table 8.28: Central state machine according to CiA 402 device display

MOOG ID No.:CB40859-001 Date:11/2020

MSD ServoDrive - DeviceHelp 273

# 8 Motion profile

MOOG ID No.:CB40859-001 Date:11/2020

MSD ServoDrive - DeviceHelp 274

|Display|System state|power disabled|fault|
|---|---|---|---|
|Control enabled|0|Start|7|
| |fault reaction active|0|14|
|Quick stop active|1|not ready|8|
| |to switch on|1|17|
|Error reaction active|2|switch on|disabled|
| |2|7| |
|Error state (in this state the error is indicated directly on the display.)|3|ready to|switch on|
|Device is reset (display flashes)|power enabled|3|6|
| |10|12| |
|• Number [5.] flashes when “STO” (Safe Torque Off) input is active. Display goes out when STO inactive.| | | |
|• The dot on the display flashes when the power stage is active.| | | |

Table 8.28: Central state machine according to CiA 402 device display (continue)

NOTE

l The system states indicated on the display may differ from the states in the table depending on the drive profile setting.

Image 8.70: State machine diagram based on CANopen communications

⓪ to ① State number

1 to 17 State transition (No. 17: DC link voltage cut off)

Legend for “State machine diagram based on CANopen communications” figure

# 8.10 Touch probe

|ID|Index Name / Setting|
|---|---|
|241|0 MPRO_TP_Position|
|241|1 MPRO_TP_Position|
|241|2 MPRO_TP_Position|
|241|3 MPRO_TP_Position|
|241|4 MPRO_TP_Position|
|1400|0 MPRO_TP_Config|
| |TP_TP (0)|
| |AB (1)|
| |PD_UP (2)|
| |PD_DOWN (3)|
| |PC_PC (4)|
| |PC_TP (5)|
| |TP_PC (6)|
| |ENC_ENC (7)|
| |ENC_TP (8)|
| |TP_ENC (9)|

Using the touch probe inputs, touch probe functions can be performed. In order to be able to do this, P 106[0] - MPRO_INPUT_FS_ISD05 and P 107[0] - MPRO_INPUT_FS_ISD06 must be used to set digital inputs ISD05 and ISD06 to ""PROBE(15) = Touch probe (only ISD05/06)"" (see Section ""Digital inputs"" on page 290). HTL encoders can be evaluated or pulse counters implemented using the MSD PLC.

The touch probe can be triggered with P 240 - MPRO_TP_Ctrl. This enables triggering on a positive or negative edge, or on both edges, of the signal detected on the touch probe inputs. After the measurement, the parameter jumps back to the value ""NONE (0)"" and the latch position is mapped in the corresponding subindex of parameter P 241 - MPRO_TP_Position. A continuous touch probe mode is not possible at present, so the touch probe has to be reactivated after the measurement.

P 1402 - MPRO_TP_Channel can be used to select various positions as actual value sources of the latch position for the touch probe functionality. The following table provides an overview of the available settings. The counters are accessed via the MSD PLC or a bus system.

|ID|Index Name / Setting|Unit|Description|
|---|---|---|---|
|240|MPRO_TP_Ctrl|Touch probe: Control| |
| |0| |NONE (0) = No function|
| |1| |POS (1) = Positive edge|
| |2| |NEG (2) = Negative edge|
| |3| |BOTH (3) = Both edges|
|240|0 MPRO_TP_Ctrl| | |
|240|1 MPRO_TP_Ctrl| | |
|240|2 MPRO_TP_Ctrl| | |
|241|MPRO_TP_Position|Probe: Pos. high/low edge of TP0/1, encoder zero pulse| |

Table 8.29: “Touch probe” parameters

MOOG ID No.:CB40859-001 Date:11/2020

# 8 Motion profile

|Unit|Description|
|---|---|
|mDegree|Touch probe: Configuration|
|mDegree|TP0, TP1 touch probe|
|mDegree|TP0, TP1 as encoder, A/B as quadrature counting|
|mDegree|TP0, TP1 as encoder, pulse (TP0) / direction (TP1), count up on direction high|
|mDegree|TP0, TP1 as encoder, pulse (TP0) / direction (TP1), count down on direction high|
|mDegree|TP0 pulse counter, TP1 pulse counter|
|mDegree|TP0 pulse counter, TP1 touch probe|
|mDegree|TP1 touch probe, TP0 pulse counter|
|mDegree|TP0 encoder counter, TP1 encoder counter|
|mDegree|TP0 encoder counter, TP1 touch probe|
|mDegree|TP0 touch probe, TP1 encoder counter|

Touch probe: Channel

|Unit|Description|
|---|---|
|ACTPOS (0)|Actual position in user units|
|ACTPOSINC (1)|Actual position in increments|
|MASTERPOS (2)|Master position in increments|
|ENCPOS_CH1 (3)|Encoder position Channel 1|
|ENCPOS_CH1_INC (4)|Encoder position Channel 1 in increments|
|ENCPOS_CH2 (5)|Encoder position Channel 2|
|ENCPOS_CH2_INC (6)|Encoder position Channel 2 in increments|

# 8 Motion profile

MOOG ID No.:CB40859-001 Date:11/2020 MSD ServoDrive - DeviceHelp 276

|ID|Index Name / Setting|Unit|Description|
|---|---|---|---|
|7|ENCPOS_CH3 (7)| |Encoder position Channel 3|
|8|ENCPOS_CH3_INC (8)| |Encoder position Channel 3 in increments|
|9|ENCPOS_CH4 (9)| |Encoder position Channel 4|
|10|ENCPOS_CH4_INC (10)| |Encoder position Channel 4 in increments|
|11|ACTPOS2 (11)| |Actual position of redundant encoder in user units|
|12|Sercos (12)| |Referred to Sercos profile parameters S-x-0426, S-x-0427|
|13|UserRefPos(13)| |Reference position in user units|
|14|MasterPosST(14)| |Master position (ECAM, EGEAR) singleturn, always steps|
|15|CommonMasterPos(15)| |Master position (ECAM, EGEAR) singleturn, always steps|
|16|CommonMasterPosST(15)| |Master position (ECAM, EGEAR) singleturn, always steps|
|1402|MPRO_TP_Channel| | |
|1402|MPRO_TP_Channel| | |
|1402|MPRO_TP_Channel| | |
|1404|MPRO_TP_Lines| |Touch probe: Lines @ pulse counter on channel x|
|1404|MPRO_TP_Lines| | |
|1404|MPRO_TP_Lines| | |

Image 8.71: “Synchronized motion” screen

There are various modes available in the “synchronization mode” drop-down menu (P 242[0] - MPRO_ECAM_SyncModMode):

- Off(0) = Synchronized motion off
- ECAM_iPlc(1) = Electronic cam plate via MSD PLC
- EGEAR_iPlc(2) = Electr. gear unit via MSD PLC
- ECAM_PARA(3) = Electronic camming via parameters
- EGEAR_PARA(4) = Electronic gearing via parameters

NOTE: For more information refer to the bus system User Manuals or the description of the MSD PLC.

# 8.11.1 Electronic cam plate

The other parameters are configured in separate screens that can be accessed with the corresponding buttons.

- Master configuration (see Section ""Master configuration"" on page 280)
- Electronic gearing (see Section ""Electronic gearing"" on page 283)
- Electronic camming (see Section ""Electronic cam plate"" on page 277)

P 1318[0] - MPRO_ECAM_ControlWord is the control word for “synchronized motion” (see Section ""Control word for synchronized motion"" on page 279).

P 1326[0] - MPRO_ECAM_StatusWord is the status word for “synchronized motion” (see Section ""Status word for synchronized motion"" on page 279).

# 8.11.1.1 Table selection

|ID|Index Name|Unit|Description|
|---|---|---|---|
|1300|MPRO_ECAM_CTS_| |ECAM: CamTableSelect - Master reference|
|1301|MasterRef| | |
|1305|MPRO_ECAM_CTS_| |ECAM: CamTableSelect - Method for changing the camtable|
|1306|MPRO_ECAM_CTS_| |ECAM: CamTableSelect - Mode for changing the camtable|
|1307|MPRO_ECAM_CTS_|incr|ECAM: CamTableSelect - Distance for changing the camtable|
|242|MPRO_ECAM_| |ECAM / EGEAR: Mode of synchronized motion SyncModMode|
|265|MPRO_ECAM_| |ECAM / EGEAR: Slave speed factor (1 = 100%).|
|266|CamSlave_SpeedFactor| | |
|268|MPRO_ECAM_| |ECAM / EGEAR: Mode of switching off sync. motion|

# 8.11.1.2 Synchronization

|ID|Index Name|Unit|Description|
|---|---|---|---|
|1342|MPRO_ECAM_CI_|incr|ECAM: CamIn - Synchronization position (multiturn part)|
|1343|MPRO_ECAM_CO_|incr|ECAM: CamOut - Decoupling pos. (multiturn part)|
|1303|MPRO_ECAM_CI_|incr|ECAM: CamIn - Master offset|
|1308|MPRO_ECAM_CI_| |ECAM: CamIn - Master reference|
|1309|MPRO_ECAM_CI_| |ECAM: CamIn - Slave reference|
|1310|MPRO_ECAM_CI_| |ECAM: CamIn - Coupling mode|
|1311|MPRO_ECAM_CI_|incr|ECAM: CamIn - Coupling distance|
|1312|MPRO_ECAM_CI_|incr|ECAM: CamIn - Synchronization position|

Table 8.31: “Electronic camming - Table selection” parameters

Table 8.30: “Synchronized motion” parameters

Table 8.32: “Electronic camming - Synchronization” parameters

MOOG ID No.:CB40859-001 Date:11/2020

MSD ServoDrive - DeviceHelp 277

# 8 Motion profile

MOOG ID No.:CB40859-001 Date:11/2020 MSD ServoDrive - DeviceHelp 278

|ID|Index|Name|Unit|Description|
|---|---|---|---|---|
|1313|0|MPRO_ECAM_CO_SyncPosST|(singleturn part)|ECAM: CamOut - Slave reference|
|1314|0|MPRO_ECAM_CO_DecouplingMode|63|ECAM: CamOut - Decoupling mode|
|1315|0|MPRO_ECAM_CO_BreakingPosST|incr|ECAM: CamOut - Decoupling position|
|1316|0|MPRO_ECAM_CO_DecouplingDist|incr|ECAM: CamOut - Decoupling distance|
|1317|0|MPRO_ECAM_CO_StandstillPos|mDegree|ECAM: CamOut - Slave standstill position|

# Table 8.32: “Electronic camming - Synchronization” parameters (continue)

|ID|Index|Name|Unit|Description|
|---|---|---|---|---|
|1346| |MPRO_ECAM_SP_Table| |ECAM: Setpoint table interface|
|1346|0|Index| |Index of setpoint table|
|1346|1|Value| |Value at index of setpoint table|
|1347|0 to 31|MPRO_ECAM_SP_Index| |ECAM: Setpoint segments start index|
|1348|0 to 31|MPRO_ECAM_SP_Length| |ECAM: Setpoint segments length|
|1349|0 to 31|Length| | |
|1350|0|MPRO_ECAM_SP_MaDist| |ECAM: Setpoint segments master distance|
|1351|0|MPRO_ECAM_SP_IpoType| |ECAM: Setpoint segments interpolation type|
|1352|0 to 31|Checksum| |ECAM: Setpoint table checksum|
|1353|0 to 31|GainNum| |ECAM: Setpoint segments gain numerator|
| | |GainDen| |ECAM: Setpoint segments gain denominator|

# Table 8.33: “Electronic camming - Table segments” parameters

|ID|Index|Name|Unit|Description|
|---|---|---|---|---|
|1329|0 to 63|MPRO_ECAM_SegData_IndexNext| |ECAM: Index of the following segment|
|1330|0 to 63|MPRO_ECAM_SegData_IndexPrev| |ECAM: Index of the previous segment|
|1331|0 to 63|MPRO_ECAM_SegData_ProfileMode| |ECAM: Profile mode of the current segment|
|1332|0 to 63|MPRO_ECAM_SegData_DistMaster| |ECAM: Length of the master section of the current segment|
|1333|0 to 63|MPRO_ECAM_SegData_DistSlave| |ECAM: Length of the slave section of the current segment|
|1334|0 to 63|MPRO_ECAM_SegData_Lambda| |ECAM: Lambda value of the current segment|
|1335|0 to 63|MPRO_ECAM_SegData_StatusWord| |ECAM: Status word of the current segment|
|1336|0 to 63|MPRO_ECAM_SegData_ControlWord| |ECAM: Control word of the current segment|

# 8.11.2 Control word for synchronized motion

|Bit|Function|PLC function|Bit number|Description|
|---|---|---|---|---|
|0-7|Start segment (8-bit value)|-|0-7|Actual segment (8-bit value)|
|8-15|Reserved|-| |Actual ECAM / EGEAR state machine state (4 Bit value)|
|16|Absolute (true) / relative (false) master relationship|-| |- 0: ECAM / EGEAR asynchronous
- 1: ECAM / EGEAR synchronous
|
|17|Absolute (true) / relative (false) master (CAM) relationship at cam in|-| |- 2: ECAM / EGEAR synchronizing
- 3: ECAM / EGEAR desynchronizing
|
|18|Absolute (true) / relative (false) slave (CAM) relationship at cam in|-| |- 4: ECAM / EGEAR active and waiting for going asynchronous
|
|19-23|Reserved|-| |- 5: ECAM / EGEAR inactive and waiting for going synchronous
|
|24|Change gear ratio of the electronic gear online|MCB_GearRatioChange| | |
|25|Disable master calculation|MCB_Cam_MasterEnable| | |
|26|Enable master calculation|MCB_Cam_MasterEnable| | |
|27|Select CAM table|MCB_CamTableSelect| | |
|28|Start Ecam|MCB_CamIn| | |
|29|Stop Ecam|MCB_CamOut| | |
|30|Start Egear|MCB_GearIn| | |
|31|Stop Egear|MCB_GearOut| | |

# 8.11.3 Status word for synchronized motion

|Bit|Function|PLC function|Bit number|Description|
|---|---|---|---|---|
|12-26|Reserved|-| | |
|27|ECAM / EGEAR is active|-| | |
|28|Valid segments chosen|-| | |
|29|Master data are valid|-| | |
|30|Master is initialized|-| | |
|31|Master calculation is active|-| | |

Table 8.35: Control word ECAM (P 1318[0] - MPRO_ECAM_ControlWord)

Table 8.36: ECAM status word (P 1326[0] - MPRO_ECAM_StatusWord)

MOOG ID No.:CB40859-001 Date:11/2020 MSD ServoDrive - DeviceHelp 279

# 8 Motion profile

# 8 Motion profile

MOOG ID No.:CB40859-001 Date:11/2020

MSD ServoDrive - DeviceHelp 280

# 8.11.4 Master configuration

the master encoder, you will need to set the resolution relative to a single motor revolution in P 250 - MPRO_ECAM_PARAMaster_Amplitude (see below).

- ENC CH1 (3) = Encoder channel 1 X7 (Sin/Cos)
- ENC CH2 (4) = Encoder channel 2 X6 (Resolver)
- ENC CH3 (5) = Encoder channel 3 X8 (optional)

This function is only available if an external interface X8 (option module) is present.

- TP0 (6) = Pulse counter on probe channel 0 (TP0)
- TP1 (7) = Pulse counter on probe channel 1 (TP1)
- ENC_CH4 (8) = Encoder channel 4 (p. e. fieldbus)
- TWIN_POS (9) = TWIN remote reference position (P-2607)

Image 8.72: “Master configuration” screen

# Channel selection (master encoder)

P 1319[0] - MPRO_ECAM_CamMaster_AxisType is used to define the master encoder.

- NO AXIS (0) = No axis
- VIRTUAL MASTER (1) = Virtual master

If you select this function, you will be able to configure additional settings by clicking on the enabled “Options...” button (see Section ""Virtual Master"" on page 286).

- PARA (2) = Master parameter interface

If you select this function because a higher-level controller is being used as

# Anti-reverse mode

Slave only starts moving along with it again as soon as the master reaches the zero position.

P 1320[0] - MPRO_ECAM_CamMaster_RevLockMode is used to define the reverse lock mode, which can be used either with or without path compensation. The dashed lines in the following diagrams indicate what the engagement distance is:

# Example:

If the master, which has moved two motor revolutions in the direction blocked for the slave, then moves in the unblocked direction again, the slave only moves off when the master has traversed the zero point.

- INACTIVE (0) = Reverse lock inactive
- ACTIVE (2) = Reverse lock enabled - without path optimization
- ACTIVE WAY COMP (1) = Reverse lock active - with way compensation

While the slave accelerates to the speed of the master during engagement, the master and slave do not move synchronously. This function needs to be selected in order to quickly catch up to the master that is running ahead.

# Example:

- Master (black line) rotates in the blocked direction
- The slave (blue line) remains stopped
- Master rotates in the unblocked direction again
- The slave follows the master directly in the unblocked direction

Assume the master has moved two motor revolutions in the direction for which the slave lock is enabled. If the master now moves in the direction for which there is no lock, the slave will immediately start running in that direction.

MOOG ID No.:CB40859-001 Date:11/2020

MSD ServoDrive - DeviceHelp 281

# 8 Motion profile

MOOG ID No.:CB40859-001 Date:11/2020 MSD ServoDrive - DeviceHelp 282

|Filter type|ID|Index Name|Unit|Description|
|---|---|---|---|---|
|When using a real master encoder, encoder signals may be subject to noise.|P 1340|1319|0|MPRO_ECAM_CamMaster_AxisType|
| | |MPRO_ECAM_CamMaster_SpeedFilTyp| |ECAM / EGEAR: Channel selection of internal master input|
| | |1320|0|MPRO_ECAM_CamMaster_RevLockMode|
| | |1321|0|MPRO_ECAM_CamMaster_Amplitude|
| | |1322|0|MPRO_ECAM_CamMaster_GearNum|
| | |1323|0|MPRO_ECAM_CamMaster_GearDen|
|Filter time|1327|0|ms|ECAM / EGEAR: Filter time constant of master|
|If P 1340[0] is used to enable a filter, P 1327[0] - MPRO_ECAM_CamMaster_SpeedTFil can be used to define the corresponding filter time.|1328|0|speed|ECAM / EGEAR: Speed factor of the internal master|
|Speed factor|1340|0| |MPRO_ECAM_CamMaster_SpeedFilTyp|
|The master encoder can be assigned an additional speed factor P 1328[0] - MPRO_ECAM_CamMaster_SpeedFactor.|1341|0|incr|ECAM / EGEAR: Master drive offset|

Table 8.37: “Synchronized motion - Master configuration” parameters (continue)

| | | |ID|Index Name|Unit|Description|
|---|---|---|---|---|---|---|
|247|0|MPRO_ECAM_ParaMaster_ActPos|incr|ECAM / EGEAR: Parameter interface master position| | |
|248|0|MPRO_ECAM_ParaMaster_ActSpeed|rpm|ECAM / EGEAR: Parameter interface master speed| | |
|249|0|MPRO_ECAM_ParaMaster_ActAcc|rpm|ECAM / EGEAR: Parameter interface master acceleration| | |
| |250|0|MPRO_ECAM_ParaMaster_Amplitude| |ECAM / EGEAR: Parameter interface master amplitude| |

Table 8.37: “Synchronized motion - Master configuration” parameters

# 8.11.5 Electronic gearing

# Gear ratio

The gear ratio is specified as a fraction. This ensures that the position references can be translated to the motor shaft with no rounding error.

- ""Slave"" (P 252[0] - MPRO_ECAM_Egear_GearNum) is the numerator
- ""Master"" (P 251[0] - MPRO_ECAM_Egear_GearDen) is the denominator

# Scaling of speed pre-control

Defined with P 265[0] - MPRO_ECAM_CamSlave_SpeedFactor definiert.

# Scaling of torque pre-control

Defined with P 266[0] - MPRO_ECAM_CamSlave_TorqueFactor.

# Engagement

See Section ""Engagement"" on page 284.

# Disengagement

See Section ""Disengagement"" on page 285.

|ID|Index Name|Unit|Description|
|---|---|---|---|
|251|0 MPRO_ECAM_Egear_GearDen| |EGEAR: Gear denominator|
|252|0 MPRO_ECAM_Egear_GearNum| |EGEAR: Numerator of gear ratio|
|1344|0 MPRO_ECAM_Egear_LimRefAcc|rpm/s|EGEAR: Acceleration limit for reference|
|1345|0 MPRO_ECAM_Egear_LimRefJerk|rpm/s²|EGEAR: Jerk limit for reference|

Table 8.38: “Synchronized motion - Electronic gearing” parameters

Image 8.73: ""Electronic gearing"" screen

MOOG ID No.:CB40859-001 Date:11/2020 MSD ServoDrive - DeviceHelp 283

# 8 Motion profile

# 8 Motion profile

MOOG ID No.:CB40859-001 Date:11/2020

MSD ServoDrive - DeviceHelp 284

# 8.11.6 Engagement

used to define the engagement distance (between the dashed lines).

P 253[0] - MPRO_ECAM_Egear_GearInMode is used to define the mode for engagement.

- DIRECT (0) = Direct
- Direct engagement: Angular synchronous; with jerking (no ramps).
- CROSSFADE (3) = Crossfading
- Engagement with crossfading function (5th degree polynomial): Angular synchronous; jerk-limited; speed will overshoot during engagement.
- RAMP (1) = Linear speed ramp
- Engagement with linear acceleration: Not angular synchronous; with jerking.
- FADE (2) = Engagement fade-out
- Engagement with fade-in function (5th degree polynomial): Not angular synchronous; jerk-limited. The position is ignored. ",What does the backlash parameter do in the analog channels ISA00 and ISA01 in the 'MSD ServoDrive - DeviceHelp' document?,A4,This parameter ensures stability by limiting motion close to the stop position.,0.74609375,0.53125,3.109375,1.1328125,0.341796875
29,msd_servo_drive.txt,76,b87ca5e232c2bdbb6fa16a8a401c6b5d285dc0183e73cc9d134de13dd2fc71d2,"MOOG ID No.:CB40859-001 Date:11/2020

MSD ServoDrive - DeviceHelp 267

# 8 Motion profile

MOOG ID No.:CB40859-001 Date:11/2020 MSD ServoDrive - DeviceHelp 268

# Deceleration

With ...

- P 194 - MPRO_TAB_TDec (for torque control) or
- P 197 - MPRO_TAB_SDec (for speed control) or
- P 200 - MPRO_TAB_PDec (for position control)

and indexes 0–15, the deceleration for each individual motion task can be defined. The input must not be zero.

# Wait time in Auto mode

P 204 - MPRO_TAB_WaitTime is used to define the wait time before the next motion task is carried out.

# Maximum table index in Auto mode

P 206[0] - MPRO_Tab_MaxIdx is used to define the table index up to which driving jobs will be carried out in one of the auto modes.

# Current table index

P 207[0] - MPRO_Tab_ActIdx will show the index for the motion task that is currently active. If parameter P 205 MPRO_TAB_Mode is set to “Para(0)”, a driving set can be entered and approached directly.

# Activation of reference table

The following procedures can be used in order to activate the setpoint table for operation.

|ID|Index Name|Unit|Description|
|---|---|---|---|
|193|MPRO_TAB_TAcc|TAB: Torque mode acceleration|Nm/ms|
|193|0|MPRO_TAB_TAcc|Nm/ms|
|193|1 - 15|MPRO_TAB_TAcc|Nm/ms|
|194|MPRO_TAB_TDec|TAB: Torque mode deceleration| |
|194|0|MPRO_TAB_TDec|Nm/ms|
|194|1 - 15|MPRO_TAB_TDec|Nm/ms|

# Table 8.23: Activation of table references

# Table 8.24: “Setpoint table settings” parameters

# Table 8.24: “Setpoint table settings” parameters (continue)

|ID|Index Name|Unit|Description|ID|Index Name|Unit|Description|
|---|---|---|---|---|---|---|---|
|195|MPRO_TAB_TRef|Nm|TAB: Torque mode reference value|208|MPRO_TAB_OutputNo| |OSD TAB: actual table index and target|
|195|MPRO_TAB_TRef|Nm| |208|MPRO_TAB_OutputNo| | |
|196|MPRO_TAB_SAcc|rev/min/s|TAB: Speed mode acceleration|269|MPRO_TAB_Ctrl| |TAB: control word|
|196|MPRO_TAB_SAcc|rev/min/s| | | | | |
|197|MPRO_TAB_SDec|rev/min/s|TAB: Speed mode deceleration| | | | |
|197|MPRO_TAB_SDec|rev/min/s| | | | | |
|198|MPRO_TAB_SRef|rev/min|TAB: Speed mode reference value| | | | |
|198|MPRO_TAB_SRef|rev/min| | | | | |
|199|MPRO_TAB_PAcc|rev/min/s|TAB: Position control mode acceleration| | | | |
|199|MPRO_TAB_PAcc|rev/min/s| | | | | |
|200|MPRO_TAB_PDec|rev/min/s|TAB: Position control mode Acceleration| | | | |
|200|MPRO_TAB_PDec|rev/min/s| | | | | |
|201|MPRO_TAB_PSpd|rev/min|TAB: Position control mode speed| | | | |
|201|MPRO_TAB_PSpd|rev/min| | | | | |
|202|MPRO_TAB_PPos|mDegree|TAB: Position control mode reference value| | | | |
|202|MPRO_TAB_PPos|mDegree| | | | | |
|203|MPRO_TAB_PMode| |Position control table:Mode| | | | |
|203|MPRO_TAB_PMode| | | | | | |
|204|MPRO_TAB_WaitTime|ms|TAB: Wait time| | | | |
|204|MPRO_TAB_WaitTime|ms| | | | | |
|205|MPRO_TAB_Mode| |TAB mode| | | | |
|206|MPRO_Tab_MaxIdx| |TAB: Max index in AUTO mode| | | | |
|207|MPRO_TAB_ActIdx| |TAB: Actual index| | | | |

MOOG ID No.:CB40859-001 Date:11/2020

MSD ServoDrive - DeviceHelp

# 8 Motion profile

MOOG ID No.:CB40859-001 Date:11/2020

MSD ServoDrive - DeviceHelp 270

# 8.8 Analog channel (ISA00 und ISA01)

# Offset (O)

This parameter (P 174 - MPRO_ANA0_SOffset for ISA00, P 184 - MPRO_ANA1_SOffset for ISA01) compensates for component variations and is used for offset compensation purposes. Depending on the control mode being used (see Section ""Basic settings"" on page 110), the value will be stored in parameter index [0] (torque control), [1] (speed control) or [2] (position control).

# Backlash (B)

This parameter (P 175 - MPRO_ANA0_SThreshold for ISA00, P 185 - MPRO_ANA1_SThreshold for ISA01) can suppress axis motion close to the standstill (stop) position. Depending on the control mode being used (see Section ""Basic settings"" on page 110), the value will be stored in parameter index [0] (torque control), [1] (speed control) or [2] (position control).

Image 8.68: “Analog channel” screen

# Acceleration ramp

Two standard analog inputs (ISA00, ISA01) are available. These inputs can be configured...

- with negative values for analog setpoint settings
- with positive values for digital setpoint processing

(P 109[0] - MPRO_INPUT_FS_ISA00 and P 110[0] - MPRO_INPUT_FS_ISA01).

see also section ""Analog Inputs"" on page 303. By using the ""REV(-2) = Analog setpoint"" setting, an analog input voltage of ±10 V can be processed as a setpoint.

# Deceleration ramp

This parameter serves as a deceleration ramp for torque control (P 176[1] - MPRO_ANA0_TRamp for ISA00, P 186[1] - MPRO_ANA1_TRamp for ISA01) or speed control (P 177[1] - MPRO_ANA0_SRamp for ISA00, P 187[1] - MPRO_ANA1_SRamp for ISA01). Depending on the control mode being used (see Section ""Basic settings"" on page 110), the value will be stored in parameter index [0] (torque control), [1] (speed control) or [2] (position control).

This parameter (P 173 - MPRO_ANA0_Scale for ISA00, P 183 - MPRO_ANA1_Scale for ISA01) is used to define which speed / which torque / which position corresponds to the maximum analog value. Depending on the control mode being used (see Section ""Basic settings"" on page 110), the value will be stored in parameter index [0] (torque control), [1] (speed control) or [2] (position control).

# 8.8.1 Special characteristics of position control mode

A threshold value can also be specified which generates a run-on range around the last reference value. A ramp function calculates a motion profile for the position reference from pre-defined acceleration and speed limits.

The position references on the analog channel are not applied immediately, but dependent on a digital input. Accordingly, one of the ISD00 to ISD06 digital inputs must be set to a value of ""REFANAEN(28) = Enable analog reference value"" (see Section ""Digital inputs"" on page 290). The position setpoint being received will only be applied if the corresponding digital input is active. The acceleration is entered using P 173[0] - MPRO_ANA0_TScale or P 183[0] - MPRO_ANA1_TScale.

# 8.8.2 Wire Break Monitoring

P 399 - CON_ANAWireBrk_Th can be used to configure wire break monitoring for the analog inputs. For details see Section ""Wire Break Monitoring"" on page 306.

|Function|TLIM (-4)|OVR (-3)|REFV (-2)|leer (-1)|OFF (0)|
|---|---|---|---|---|---|
|Digital|(1)-(28)|(1)-(28)|(1)-(28)|(1)-(28)|(1)-(28)|
|Analog channel|Filter|Scale|Offset|Profile|generator|

Control

Image 8.69: Reference processing structure

MOOG ID No.:CB40859-001 Date:11/2020

MSD ServoDrive - DeviceHelp 271

# 8 Motion profile

# 8 Motion profile

MOOG ID No.:CB40859-001 Date:11/2020

|ID|Index Name|Unit|Description|ID|
|---|---|---|---|---|
|395|CON_ANA_Isaf_Scaled| |Analog inputs: Values (filt, norm, comp, scaled)|174|
|395|0 ISA00| |Scaled, compensated, filtered, normalized value|175|
|395|1 ISA01| |Scaled, compensated, filtered, normalized value| |
|396|CON_ANA_Scale_ThUpper| |Analog inputs: Upper scaling limits|175|
|396|0 ISA00|%|Upper scaling (@ 10 V) threshold|175|
|396|1 ISA01|%|Upper scaling (@ 10 V) threshold| |
|397|CON_ANA_Scale_ThZero| |Analog inputs: Zero scaling thresholds|176|
|397|0 ISA00|V|Zero scaling threshold (+/-)|176|
|397|1 ISA01|V|Zero scaling threshold (+/-)| |
|398|CON_ANA_Scale_ThLower| |Analog inputs: Lower scaling limits|177|
|398|0 ISA00|%|Lower scaling (@ zero threshold) threshold|177|
|398|1 ISA01|%|Lower scaling (@ zero threshold) threshold| |
|399|CON_ANA_WireBrk_Th| |Analog inputs: Wire break thresholds|Table 8.26:|
|399|0 ISA00|V|Wire break detection threshold| |
|399|1 ISA01|V|Wire break detection threshold| |
|405|0 CON_ANA_Filt0|ms|Analog input ISA00: Filter time constant (PT 1)|ID|
|408|CON_ANA_Isaf_Norm| |Analog inputs: Values (filt, norm)|183|
|408|0 ISA00| |Filtered, normalized value|183|
|408|1 ISA01| |Filtered, normalized value|183|

Table 8.25: “Analog channel” parameters

|ID|Index Name|Unit|Description|ID|
|---|---|---|---|---|
|173|MPRO_ANA0_Scale| |ANA0: scale factors|184|
|173|0 MPRO_ANA0_TScale|Nm|ANA0: scale factor torque reference|185|
|173|1 MPRO_ANA0_SScale|rev/min|ANA0: scale factor speed reference|185|
|173|2 MPRO_ANA0_PScale|mDegree|ANA0: scale factor position reference| |
|174|MPRO_ANA0_Offset| |ANA0: offsets|185|
|174|0 MPRO_ANA0_TOffset|Nm|ANA0: offsets for torque reference|185|

Table 8.26: “Analog channel ISA00” parameters

|Index Name|Unit|Description|
|---|---|---|
|1 MPRO_ANA0_SOffset|rev/min|ANA0: offsets for speed reference|
|2 MPRO_ANA0_POffset|mDegree|ANA0: offsets for position reference|
|MPRO_ANA0_Threshold| |ANA0: thresholds|
|0 MPRO_ANA0_TThreshold|Nm|ANA0: threshold for torque reference|
|1 MPRO_ANA0_SThreshold|rev/min|ANA0: threshold for speed reference|
|2 MPRO_ANA0_PThreshold|mDegree|ANA0: threshold for position reference|
|MPRO_ANA0_TRamp| |ANA0: Torque mode acceleration [0] and deceleration [1]|
|0 MPRO_ANA0_TRamp|Nm/s| |
|1 MPRO_ANA0_TRamp|Nm/s| |
|MPRO_ANA0_SRamp| |ANA0: Speed mode acceleration [0] and deceleration [1]|
|0 MPRO_ANA0_SRamp|SPEED/s| |
|1 MPRO_ANA0_SRamp|SPEED/s| |

“Analog channel ISA00” parameters (continue)

|Index Name|Unit|Description|
|---|---|---|
|MPRO_ANA1_Scale| |ANA1: scale factors|
|0 MPRO_ANA1_TScale|Nm|ANA0: scale factor torque reference|
|1 MPRO_ANA1_SScale|rev/min|ANA0: scale factor speed reference|
|2 MPRO_ANA1_PScale|mDegree|ANA0: scale factor position reference|
|MPRO_ANA1_Offset| |ANA1: offsets|
|0 MPRO_ANA1_TOffset|Nm|ANA1: offsets for torque reference|
|1 MPRO_ANA1_SOffset|rev/min|ANA1: offsets for speed reference|
|2 MPRO_ANA1_POffset|mDegree|ANA1: offsets for position reference|
|MPRO_ANA1_Threshold| |ANA1: thresholds|
|0 MPRO_ANA1_TThreshold|Nm|ANA1: threshold for torque reference|
|1 MPRO_ANA1_SThreshold|rev/min|ANA1: threshold for speed reference|
|2 MPRO_ANA1_PThreshold|mDegree|ANA1: threshold for position reference|

“Analog channel ISA01” parameters

# 8 Motion profile

|ID|Index Name|Unit|Description|
|---|---|---|---|
|186|MPRO_ANA1_TRamp|Nm/s|ANA1: Torque mode acceleration [0] and deceleration[1]|
|186|MPRO_ANA1_TRamp|Nm/s| |
|187|MPRO_ANA1_SRamp|SPEED/s|ANA1: Speed mode acceleration [0] and deceleration [1]|
|187|MPRO_ANA1_SRamp|SPEED/s| |

# Table 8.27: “Analog channel ISA01” parameters (continue)

Display

- System state
- Initialization on device startup
- Not ready (DC link voltage possibly too low)
- Start inhibit (DC link voltage present, power stage off)
- Starting lockout
- Ready for start
- Control initialization: Auto commutation, flux build-up etc.

# Table 8.28: Central state machine according to CiA 402 device display

MOOG ID No.:CB40859-001 Date:11/2020

MSD ServoDrive - DeviceHelp 273

# 8 Motion profile

MOOG ID No.:CB40859-001 Date:11/2020

MSD ServoDrive - DeviceHelp 274

|Display|System state|power disabled|fault|
|---|---|---|---|
|Control enabled|0|Start|7|
| |fault reaction active|0|14|
|Quick stop active|1|not ready|8|
| |to switch on|1|17|
|Error reaction active|2|switch on|disabled|
| |2|7| |
|Error state (in this state the error is indicated directly on the display.)|3|ready to|switch on|
|Device is reset (display flashes)|power enabled|3|6|
| |10|12| |
|• Number [5.] flashes when “STO” (Safe Torque Off) input is active. Display goes out when STO inactive.| | | |
|• The dot on the display flashes when the power stage is active.| | | |

Table 8.28: Central state machine according to CiA 402 device display (continue)

NOTE

l The system states indicated on the display may differ from the states in the table depending on the drive profile setting.

Image 8.70: State machine diagram based on CANopen communications

⓪ to ① State number

1 to 17 State transition (No. 17: DC link voltage cut off)

Legend for “State machine diagram based on CANopen communications” figure

# 8.10 Touch probe

|ID|Index Name / Setting|
|---|---|
|241|0 MPRO_TP_Position|
|241|1 MPRO_TP_Position|
|241|2 MPRO_TP_Position|
|241|3 MPRO_TP_Position|
|241|4 MPRO_TP_Position|
|1400|0 MPRO_TP_Config|
| |TP_TP (0)|
| |AB (1)|
| |PD_UP (2)|
| |PD_DOWN (3)|
| |PC_PC (4)|
| |PC_TP (5)|
| |TP_PC (6)|
| |ENC_ENC (7)|
| |ENC_TP (8)|
| |TP_ENC (9)|

Using the touch probe inputs, touch probe functions can be performed. In order to be able to do this, P 106[0] - MPRO_INPUT_FS_ISD05 and P 107[0] - MPRO_INPUT_FS_ISD06 must be used to set digital inputs ISD05 and ISD06 to ""PROBE(15) = Touch probe (only ISD05/06)"" (see Section ""Digital inputs"" on page 290). HTL encoders can be evaluated or pulse counters implemented using the MSD PLC.

The touch probe can be triggered with P 240 - MPRO_TP_Ctrl. This enables triggering on a positive or negative edge, or on both edges, of the signal detected on the touch probe inputs. After the measurement, the parameter jumps back to the value ""NONE (0)"" and the latch position is mapped in the corresponding subindex of parameter P 241 - MPRO_TP_Position. A continuous touch probe mode is not possible at present, so the touch probe has to be reactivated after the measurement.

P 1402 - MPRO_TP_Channel can be used to select various positions as actual value sources of the latch position for the touch probe functionality. The following table provides an overview of the available settings. The counters are accessed via the MSD PLC or a bus system.

|ID|Index Name / Setting|Unit|Description|
|---|---|---|---|
|240|MPRO_TP_Ctrl|Touch probe: Control| |
| |0| |NONE (0) = No function|
| |1| |POS (1) = Positive edge|
| |2| |NEG (2) = Negative edge|
| |3| |BOTH (3) = Both edges|
|240|0 MPRO_TP_Ctrl| | |
|240|1 MPRO_TP_Ctrl| | |
|240|2 MPRO_TP_Ctrl| | |
|241|MPRO_TP_Position|Probe: Pos. high/low edge of TP0/1, encoder zero pulse| |

Table 8.29: “Touch probe” parameters

MOOG ID No.:CB40859-001 Date:11/2020

# 8 Motion profile

|Unit|Description|
|---|---|
|mDegree|Touch probe: Configuration|
|mDegree|TP0, TP1 touch probe|
|mDegree|TP0, TP1 as encoder, A/B as quadrature counting|
|mDegree|TP0, TP1 as encoder, pulse (TP0) / direction (TP1), count up on direction high|
|mDegree|TP0, TP1 as encoder, pulse (TP0) / direction (TP1), count down on direction high|
|mDegree|TP0 pulse counter, TP1 pulse counter|
|mDegree|TP0 pulse counter, TP1 touch probe|
|mDegree|TP1 touch probe, TP0 pulse counter|
|mDegree|TP0 encoder counter, TP1 encoder counter|
|mDegree|TP0 encoder counter, TP1 touch probe|
|mDegree|TP0 touch probe, TP1 encoder counter|

Touch probe: Channel

|Unit|Description|
|---|---|
|ACTPOS (0)|Actual position in user units|
|ACTPOSINC (1)|Actual position in increments|
|MASTERPOS (2)|Master position in increments|
|ENCPOS_CH1 (3)|Encoder position Channel 1|
|ENCPOS_CH1_INC (4)|Encoder position Channel 1 in increments|
|ENCPOS_CH2 (5)|Encoder position Channel 2|
|ENCPOS_CH2_INC (6)|Encoder position Channel 2 in increments|

# 8 Motion profile

MOOG ID No.:CB40859-001 Date:11/2020 MSD ServoDrive - DeviceHelp 276

|ID|Index Name / Setting|Unit|Description|
|---|---|---|---|
|7|ENCPOS_CH3 (7)| |Encoder position Channel 3|
|8|ENCPOS_CH3_INC (8)| |Encoder position Channel 3 in increments|
|9|ENCPOS_CH4 (9)| |Encoder position Channel 4|
|10|ENCPOS_CH4_INC (10)| |Encoder position Channel 4 in increments|
|11|ACTPOS2 (11)| |Actual position of redundant encoder in user units|
|12|Sercos (12)| |Referred to Sercos profile parameters S-x-0426, S-x-0427|
|13|UserRefPos(13)| |Reference position in user units|
|14|MasterPosST(14)| |Master position (ECAM, EGEAR) singleturn, always steps|
|15|CommonMasterPos(15)| |Master position (ECAM, EGEAR) singleturn, always steps|
|16|CommonMasterPosST(15)| |Master position (ECAM, EGEAR) singleturn, always steps|
|1402|MPRO_TP_Channel| | |
|1402|MPRO_TP_Channel| | |
|1402|MPRO_TP_Channel| | |
|1404|MPRO_TP_Lines| |Touch probe: Lines @ pulse counter on channel x|
|1404|MPRO_TP_Lines| | |
|1404|MPRO_TP_Lines| | |

Image 8.71: “Synchronized motion” screen

There are various modes available in the “synchronization mode” drop-down menu (P 242[0] - MPRO_ECAM_SyncModMode):

- Off(0) = Synchronized motion off
- ECAM_iPlc(1) = Electronic cam plate via MSD PLC
- EGEAR_iPlc(2) = Electr. gear unit via MSD PLC
- ECAM_PARA(3) = Electronic camming via parameters
- EGEAR_PARA(4) = Electronic gearing via parameters

NOTE: For more information refer to the bus system User Manuals or the description of the MSD PLC.

# 8.11.1 Electronic cam plate

The other parameters are configured in separate screens that can be accessed with the corresponding buttons.

- Master configuration (see Section ""Master configuration"" on page 280)
- Electronic gearing (see Section ""Electronic gearing"" on page 283)
- Electronic camming (see Section ""Electronic cam plate"" on page 277)

P 1318[0] - MPRO_ECAM_ControlWord is the control word for “synchronized motion” (see Section ""Control word for synchronized motion"" on page 279).

P 1326[0] - MPRO_ECAM_StatusWord is the status word for “synchronized motion” (see Section ""Status word for synchronized motion"" on page 279).

# 8.11.1.1 Table selection

|ID|Index Name|Unit|Description|
|---|---|---|---|
|1300|MPRO_ECAM_CTS_| |ECAM: CamTableSelect - Master reference|
|1301|MasterRef| | |
|1305|MPRO_ECAM_CTS_| |ECAM: CamTableSelect - Method for changing the camtable|
|1306|MPRO_ECAM_CTS_| |ECAM: CamTableSelect - Mode for changing the camtable|
|1307|MPRO_ECAM_CTS_|incr|ECAM: CamTableSelect - Distance for changing the camtable|
|242|MPRO_ECAM_| |ECAM / EGEAR: Mode of synchronized motion SyncModMode|
|265|MPRO_ECAM_| |ECAM / EGEAR: Slave speed factor (1 = 100%).|
|266|CamSlave_SpeedFactor| | |
|268|MPRO_ECAM_| |ECAM / EGEAR: Mode of switching off sync. motion|

# 8.11.1.2 Synchronization

|ID|Index Name|Unit|Description|
|---|---|---|---|
|1342|MPRO_ECAM_CI_|incr|ECAM: CamIn - Synchronization position (multiturn part)|
|1343|MPRO_ECAM_CO_|incr|ECAM: CamOut - Decoupling pos. (multiturn part)|
|1303|MPRO_ECAM_CI_|incr|ECAM: CamIn - Master offset|
|1308|MPRO_ECAM_CI_| |ECAM: CamIn - Master reference|
|1309|MPRO_ECAM_CI_| |ECAM: CamIn - Slave reference|
|1310|MPRO_ECAM_CI_| |ECAM: CamIn - Coupling mode|
|1311|MPRO_ECAM_CI_|incr|ECAM: CamIn - Coupling distance|
|1312|MPRO_ECAM_CI_|incr|ECAM: CamIn - Synchronization position|

Table 8.31: “Electronic camming - Table selection” parameters

Table 8.30: “Synchronized motion” parameters

Table 8.32: “Electronic camming - Synchronization” parameters

MOOG ID No.:CB40859-001 Date:11/2020

MSD ServoDrive - DeviceHelp 277

# 8 Motion profile

MOOG ID No.:CB40859-001 Date:11/2020 MSD ServoDrive - DeviceHelp 278

|ID|Index|Name|Unit|Description|
|---|---|---|---|---|
|1313|0|MPRO_ECAM_CO_SyncPosST|(singleturn part)|ECAM: CamOut - Slave reference|
|1314|0|MPRO_ECAM_CO_DecouplingMode|63|ECAM: CamOut - Decoupling mode|
|1315|0|MPRO_ECAM_CO_BreakingPosST|incr|ECAM: CamOut - Decoupling position|
|1316|0|MPRO_ECAM_CO_DecouplingDist|incr|ECAM: CamOut - Decoupling distance|
|1317|0|MPRO_ECAM_CO_StandstillPos|mDegree|ECAM: CamOut - Slave standstill position|

# Table 8.32: “Electronic camming - Synchronization” parameters (continue)

|ID|Index|Name|Unit|Description|
|---|---|---|---|---|
|1346| |MPRO_ECAM_SP_Table| |ECAM: Setpoint table interface|
|1346|0|Index| |Index of setpoint table|
|1346|1|Value| |Value at index of setpoint table|
|1347|0 to 31|MPRO_ECAM_SP_Index| |ECAM: Setpoint segments start index|
|1348|0 to 31|MPRO_ECAM_SP_Length| |ECAM: Setpoint segments length|
|1349|0 to 31|Length| | |
|1350|0|MPRO_ECAM_SP_MaDist| |ECAM: Setpoint segments master distance|
|1351|0|MPRO_ECAM_SP_IpoType| |ECAM: Setpoint segments interpolation type|
|1352|0 to 31|Checksum| |ECAM: Setpoint table checksum|
|1353|0 to 31|GainNum| |ECAM: Setpoint segments gain numerator|
| | |GainDen| |ECAM: Setpoint segments gain denominator|

# Table 8.33: “Electronic camming - Table segments” parameters

|ID|Index|Name|Unit|Description|
|---|---|---|---|---|
|1329|0 to 63|MPRO_ECAM_SegData_IndexNext| |ECAM: Index of the following segment|
|1330|0 to 63|MPRO_ECAM_SegData_IndexPrev| |ECAM: Index of the previous segment|
|1331|0 to 63|MPRO_ECAM_SegData_ProfileMode| |ECAM: Profile mode of the current segment|
|1332|0 to 63|MPRO_ECAM_SegData_DistMaster| |ECAM: Length of the master section of the current segment|
|1333|0 to 63|MPRO_ECAM_SegData_DistSlave| |ECAM: Length of the slave section of the current segment|
|1334|0 to 63|MPRO_ECAM_SegData_Lambda| |ECAM: Lambda value of the current segment|
|1335|0 to 63|MPRO_ECAM_SegData_StatusWord| |ECAM: Status word of the current segment|
|1336|0 to 63|MPRO_ECAM_SegData_ControlWord| |ECAM: Control word of the current segment|

# 8.11.2 Control word for synchronized motion

|Bit|Function|PLC function|Bit number|Description|
|---|---|---|---|---|
|0-7|Start segment (8-bit value)|-|0-7|Actual segment (8-bit value)|
|8-15|Reserved|-| |Actual ECAM / EGEAR state machine state (4 Bit value)|
|16|Absolute (true) / relative (false) master relationship|-| |- 0: ECAM / EGEAR asynchronous
- 1: ECAM / EGEAR synchronous
|
|17|Absolute (true) / relative (false) master (CAM) relationship at cam in|-| |- 2: ECAM / EGEAR synchronizing
- 3: ECAM / EGEAR desynchronizing
|
|18|Absolute (true) / relative (false) slave (CAM) relationship at cam in|-| |- 4: ECAM / EGEAR active and waiting for going asynchronous
|
|19-23|Reserved|-| |- 5: ECAM / EGEAR inactive and waiting for going synchronous
|
|24|Change gear ratio of the electronic gear online|MCB_GearRatioChange| | |
|25|Disable master calculation|MCB_Cam_MasterEnable| | |
|26|Enable master calculation|MCB_Cam_MasterEnable| | |
|27|Select CAM table|MCB_CamTableSelect| | |
|28|Start Ecam|MCB_CamIn| | |
|29|Stop Ecam|MCB_CamOut| | |
|30|Start Egear|MCB_GearIn| | |
|31|Stop Egear|MCB_GearOut| | |

# 8.11.3 Status word for synchronized motion

|Bit|Function|PLC function|Bit number|Description|
|---|---|---|---|---|
|12-26|Reserved|-| | |
|27|ECAM / EGEAR is active|-| | |
|28|Valid segments chosen|-| | |
|29|Master data are valid|-| | |
|30|Master is initialized|-| | |
|31|Master calculation is active|-| | |

Table 8.35: Control word ECAM (P 1318[0] - MPRO_ECAM_ControlWord)

Table 8.36: ECAM status word (P 1326[0] - MPRO_ECAM_StatusWord)

MOOG ID No.:CB40859-001 Date:11/2020 MSD ServoDrive - DeviceHelp 279

# 8 Motion profile

# 8 Motion profile

MOOG ID No.:CB40859-001 Date:11/2020

MSD ServoDrive - DeviceHelp 280

# 8.11.4 Master configuration

the master encoder, you will need to set the resolution relative to a single motor revolution in P 250 - MPRO_ECAM_PARAMaster_Amplitude (see below).

- ENC CH1 (3) = Encoder channel 1 X7 (Sin/Cos)
- ENC CH2 (4) = Encoder channel 2 X6 (Resolver)
- ENC CH3 (5) = Encoder channel 3 X8 (optional)

This function is only available if an external interface X8 (option module) is present.

- TP0 (6) = Pulse counter on probe channel 0 (TP0)
- TP1 (7) = Pulse counter on probe channel 1 (TP1)
- ENC_CH4 (8) = Encoder channel 4 (p. e. fieldbus)
- TWIN_POS (9) = TWIN remote reference position (P-2607)

Image 8.72: “Master configuration” screen

# Channel selection (master encoder)

P 1319[0] - MPRO_ECAM_CamMaster_AxisType is used to define the master encoder.

- NO AXIS (0) = No axis
- VIRTUAL MASTER (1) = Virtual master

If you select this function, you will be able to configure additional settings by clicking on the enabled “Options...” button (see Section ""Virtual Master"" on page 286).

- PARA (2) = Master parameter interface

If you select this function because a higher-level controller is being used as

# Anti-reverse mode

Slave only starts moving along with it again as soon as the master reaches the zero position.

P 1320[0] - MPRO_ECAM_CamMaster_RevLockMode is used to define the reverse lock mode, which can be used either with or without path compensation. The dashed lines in the following diagrams indicate what the engagement distance is:

# Example:

If the master, which has moved two motor revolutions in the direction blocked for the slave, then moves in the unblocked direction again, the slave only moves off when the master has traversed the zero point.

- INACTIVE (0) = Reverse lock inactive
- ACTIVE (2) = Reverse lock enabled - without path optimization
- ACTIVE WAY COMP (1) = Reverse lock active - with way compensation

While the slave accelerates to the speed of the master during engagement, the master and slave do not move synchronously. This function needs to be selected in order to quickly catch up to the master that is running ahead.

# Example:

- Master (black line) rotates in the blocked direction
- The slave (blue line) remains stopped
- Master rotates in the unblocked direction again
- The slave follows the master directly in the unblocked direction

Assume the master has moved two motor revolutions in the direction for which the slave lock is enabled. If the master now moves in the direction for which there is no lock, the slave will immediately start running in that direction.

MOOG ID No.:CB40859-001 Date:11/2020

MSD ServoDrive - DeviceHelp 281

# 8 Motion profile

MOOG ID No.:CB40859-001 Date:11/2020 MSD ServoDrive - DeviceHelp 282

|Filter type|ID|Index Name|Unit|Description|
|---|---|---|---|---|
|When using a real master encoder, encoder signals may be subject to noise.|P 1340|1319|0|MPRO_ECAM_CamMaster_AxisType|
| | |MPRO_ECAM_CamMaster_SpeedFilTyp| |ECAM / EGEAR: Channel selection of internal master input|
| | |1320|0|MPRO_ECAM_CamMaster_RevLockMode|
| | |1321|0|MPRO_ECAM_CamMaster_Amplitude|
| | |1322|0|MPRO_ECAM_CamMaster_GearNum|
| | |1323|0|MPRO_ECAM_CamMaster_GearDen|
|Filter time|1327|0|ms|ECAM / EGEAR: Filter time constant of master|
|If P 1340[0] is used to enable a filter, P 1327[0] - MPRO_ECAM_CamMaster_SpeedTFil can be used to define the corresponding filter time.|1328|0|speed|ECAM / EGEAR: Speed factor of the internal master|
|Speed factor|1340|0| |MPRO_ECAM_CamMaster_SpeedFilTyp|
|The master encoder can be assigned an additional speed factor P 1328[0] - MPRO_ECAM_CamMaster_SpeedFactor.|1341|0|incr|ECAM / EGEAR: Master drive offset|

Table 8.37: “Synchronized motion - Master configuration” parameters (continue)

| | | |ID|Index Name|Unit|Description|
|---|---|---|---|---|---|---|
|247|0|MPRO_ECAM_ParaMaster_ActPos|incr|ECAM / EGEAR: Parameter interface master position| | |
|248|0|MPRO_ECAM_ParaMaster_ActSpeed|rpm|ECAM / EGEAR: Parameter interface master speed| | |
|249|0|MPRO_ECAM_ParaMaster_ActAcc|rpm|ECAM / EGEAR: Parameter interface master acceleration| | |
| |250|0|MPRO_ECAM_ParaMaster_Amplitude| |ECAM / EGEAR: Parameter interface master amplitude| |

Table 8.37: “Synchronized motion - Master configuration” parameters

# 8.11.5 Electronic gearing

# Gear ratio

The gear ratio is specified as a fraction. This ensures that the position references can be translated to the motor shaft with no rounding error.

- ""Slave"" (P 252[0] - MPRO_ECAM_Egear_GearNum) is the numerator
- ""Master"" (P 251[0] - MPRO_ECAM_Egear_GearDen) is the denominator

# Scaling of speed pre-control

Defined with P 265[0] - MPRO_ECAM_CamSlave_SpeedFactor definiert.

# Scaling of torque pre-control

Defined with P 266[0] - MPRO_ECAM_CamSlave_TorqueFactor.

# Engagement

See Section ""Engagement"" on page 284.

# Disengagement

See Section ""Disengagement"" on page 285.

|ID|Index Name|Unit|Description|
|---|---|---|---|
|251|0 MPRO_ECAM_Egear_GearDen| |EGEAR: Gear denominator|
|252|0 MPRO_ECAM_Egear_GearNum| |EGEAR: Numerator of gear ratio|
|1344|0 MPRO_ECAM_Egear_LimRefAcc|rpm/s|EGEAR: Acceleration limit for reference|
|1345|0 MPRO_ECAM_Egear_LimRefJerk|rpm/s²|EGEAR: Jerk limit for reference|

Table 8.38: “Synchronized motion - Electronic gearing” parameters

Image 8.73: ""Electronic gearing"" screen

MOOG ID No.:CB40859-001 Date:11/2020 MSD ServoDrive - DeviceHelp 283

# 8 Motion profile

# 8 Motion profile

MOOG ID No.:CB40859-001 Date:11/2020

MSD ServoDrive - DeviceHelp 284

# 8.11.6 Engagement

used to define the engagement distance (between the dashed lines).

P 253[0] - MPRO_ECAM_Egear_GearInMode is used to define the mode for engagement.

- DIRECT (0) = Direct
- Direct engagement: Angular synchronous; with jerking (no ramps).
- CROSSFADE (3) = Crossfading
- Engagement with crossfading function (5th degree polynomial): Angular synchronous; jerk-limited; speed will overshoot during engagement.
- RAMP (1) = Linear speed ramp
- Engagement with linear acceleration: Not angular synchronous; with jerking.
- FADE (2) = Engagement fade-out
- Engagement with fade-in function (5th degree polynomial): Not angular synchronous; jerk-limited. The position is ignored. ",What does the backlash parameter do in the analog channels ISA00 and ISA01 in the 'MSD ServoDrive - DeviceHelp' document?,A5,"In ISA00 and ISA01, backlash parameters control motion suppression near standstill.",1.6171875,1.625,3.40625,1.453125,0.21484375
30,msd_servo_drive.txt,76,b87ca5e232c2bdbb6fa16a8a401c6b5d285dc0183e73cc9d134de13dd2fc71d2,"MOOG ID No.:CB40859-001 Date:11/2020

MSD ServoDrive - DeviceHelp 267

# 8 Motion profile

MOOG ID No.:CB40859-001 Date:11/2020 MSD ServoDrive - DeviceHelp 268

# Deceleration

With ...

- P 194 - MPRO_TAB_TDec (for torque control) or
- P 197 - MPRO_TAB_SDec (for speed control) or
- P 200 - MPRO_TAB_PDec (for position control)

and indexes 0–15, the deceleration for each individual motion task can be defined. The input must not be zero.

# Wait time in Auto mode

P 204 - MPRO_TAB_WaitTime is used to define the wait time before the next motion task is carried out.

# Maximum table index in Auto mode

P 206[0] - MPRO_Tab_MaxIdx is used to define the table index up to which driving jobs will be carried out in one of the auto modes.

# Current table index

P 207[0] - MPRO_Tab_ActIdx will show the index for the motion task that is currently active. If parameter P 205 MPRO_TAB_Mode is set to “Para(0)”, a driving set can be entered and approached directly.

# Activation of reference table

The following procedures can be used in order to activate the setpoint table for operation.

|ID|Index Name|Unit|Description|
|---|---|---|---|
|193|MPRO_TAB_TAcc|TAB: Torque mode acceleration|Nm/ms|
|193|0|MPRO_TAB_TAcc|Nm/ms|
|193|1 - 15|MPRO_TAB_TAcc|Nm/ms|
|194|MPRO_TAB_TDec|TAB: Torque mode deceleration| |
|194|0|MPRO_TAB_TDec|Nm/ms|
|194|1 - 15|MPRO_TAB_TDec|Nm/ms|

# Table 8.23: Activation of table references

# Table 8.24: “Setpoint table settings” parameters

# Table 8.24: “Setpoint table settings” parameters (continue)

|ID|Index Name|Unit|Description|ID|Index Name|Unit|Description|
|---|---|---|---|---|---|---|---|
|195|MPRO_TAB_TRef|Nm|TAB: Torque mode reference value|208|MPRO_TAB_OutputNo| |OSD TAB: actual table index and target|
|195|MPRO_TAB_TRef|Nm| |208|MPRO_TAB_OutputNo| | |
|196|MPRO_TAB_SAcc|rev/min/s|TAB: Speed mode acceleration|269|MPRO_TAB_Ctrl| |TAB: control word|
|196|MPRO_TAB_SAcc|rev/min/s| | | | | |
|197|MPRO_TAB_SDec|rev/min/s|TAB: Speed mode deceleration| | | | |
|197|MPRO_TAB_SDec|rev/min/s| | | | | |
|198|MPRO_TAB_SRef|rev/min|TAB: Speed mode reference value| | | | |
|198|MPRO_TAB_SRef|rev/min| | | | | |
|199|MPRO_TAB_PAcc|rev/min/s|TAB: Position control mode acceleration| | | | |
|199|MPRO_TAB_PAcc|rev/min/s| | | | | |
|200|MPRO_TAB_PDec|rev/min/s|TAB: Position control mode Acceleration| | | | |
|200|MPRO_TAB_PDec|rev/min/s| | | | | |
|201|MPRO_TAB_PSpd|rev/min|TAB: Position control mode speed| | | | |
|201|MPRO_TAB_PSpd|rev/min| | | | | |
|202|MPRO_TAB_PPos|mDegree|TAB: Position control mode reference value| | | | |
|202|MPRO_TAB_PPos|mDegree| | | | | |
|203|MPRO_TAB_PMode| |Position control table:Mode| | | | |
|203|MPRO_TAB_PMode| | | | | | |
|204|MPRO_TAB_WaitTime|ms|TAB: Wait time| | | | |
|204|MPRO_TAB_WaitTime|ms| | | | | |
|205|MPRO_TAB_Mode| |TAB mode| | | | |
|206|MPRO_Tab_MaxIdx| |TAB: Max index in AUTO mode| | | | |
|207|MPRO_TAB_ActIdx| |TAB: Actual index| | | | |

MOOG ID No.:CB40859-001 Date:11/2020

MSD ServoDrive - DeviceHelp

# 8 Motion profile

MOOG ID No.:CB40859-001 Date:11/2020

MSD ServoDrive - DeviceHelp 270

# 8.8 Analog channel (ISA00 und ISA01)

# Offset (O)

This parameter (P 174 - MPRO_ANA0_SOffset for ISA00, P 184 - MPRO_ANA1_SOffset for ISA01) compensates for component variations and is used for offset compensation purposes. Depending on the control mode being used (see Section ""Basic settings"" on page 110), the value will be stored in parameter index [0] (torque control), [1] (speed control) or [2] (position control).

# Backlash (B)

This parameter (P 175 - MPRO_ANA0_SThreshold for ISA00, P 185 - MPRO_ANA1_SThreshold for ISA01) can suppress axis motion close to the standstill (stop) position. Depending on the control mode being used (see Section ""Basic settings"" on page 110), the value will be stored in parameter index [0] (torque control), [1] (speed control) or [2] (position control).

Image 8.68: “Analog channel” screen

# Acceleration ramp

Two standard analog inputs (ISA00, ISA01) are available. These inputs can be configured...

- with negative values for analog setpoint settings
- with positive values for digital setpoint processing

(P 109[0] - MPRO_INPUT_FS_ISA00 and P 110[0] - MPRO_INPUT_FS_ISA01).

see also section ""Analog Inputs"" on page 303. By using the ""REV(-2) = Analog setpoint"" setting, an analog input voltage of ±10 V can be processed as a setpoint.

# Deceleration ramp

This parameter serves as a deceleration ramp for torque control (P 176[1] - MPRO_ANA0_TRamp for ISA00, P 186[1] - MPRO_ANA1_TRamp for ISA01) or speed control (P 177[1] - MPRO_ANA0_SRamp for ISA00, P 187[1] - MPRO_ANA1_SRamp for ISA01). Depending on the control mode being used (see Section ""Basic settings"" on page 110), the value will be stored in parameter index [0] (torque control), [1] (speed control) or [2] (position control).

This parameter (P 173 - MPRO_ANA0_Scale for ISA00, P 183 - MPRO_ANA1_Scale for ISA01) is used to define which speed / which torque / which position corresponds to the maximum analog value. Depending on the control mode being used (see Section ""Basic settings"" on page 110), the value will be stored in parameter index [0] (torque control), [1] (speed control) or [2] (position control).

# 8.8.1 Special characteristics of position control mode

A threshold value can also be specified which generates a run-on range around the last reference value. A ramp function calculates a motion profile for the position reference from pre-defined acceleration and speed limits.

The position references on the analog channel are not applied immediately, but dependent on a digital input. Accordingly, one of the ISD00 to ISD06 digital inputs must be set to a value of ""REFANAEN(28) = Enable analog reference value"" (see Section ""Digital inputs"" on page 290). The position setpoint being received will only be applied if the corresponding digital input is active. The acceleration is entered using P 173[0] - MPRO_ANA0_TScale or P 183[0] - MPRO_ANA1_TScale.

# 8.8.2 Wire Break Monitoring

P 399 - CON_ANAWireBrk_Th can be used to configure wire break monitoring for the analog inputs. For details see Section ""Wire Break Monitoring"" on page 306.

|Function|TLIM (-4)|OVR (-3)|REFV (-2)|leer (-1)|OFF (0)|
|---|---|---|---|---|---|
|Digital|(1)-(28)|(1)-(28)|(1)-(28)|(1)-(28)|(1)-(28)|
|Analog channel|Filter|Scale|Offset|Profile|generator|

Control

Image 8.69: Reference processing structure

MOOG ID No.:CB40859-001 Date:11/2020

MSD ServoDrive - DeviceHelp 271

# 8 Motion profile

# 8 Motion profile

MOOG ID No.:CB40859-001 Date:11/2020

|ID|Index Name|Unit|Description|ID|
|---|---|---|---|---|
|395|CON_ANA_Isaf_Scaled| |Analog inputs: Values (filt, norm, comp, scaled)|174|
|395|0 ISA00| |Scaled, compensated, filtered, normalized value|175|
|395|1 ISA01| |Scaled, compensated, filtered, normalized value| |
|396|CON_ANA_Scale_ThUpper| |Analog inputs: Upper scaling limits|175|
|396|0 ISA00|%|Upper scaling (@ 10 V) threshold|175|
|396|1 ISA01|%|Upper scaling (@ 10 V) threshold| |
|397|CON_ANA_Scale_ThZero| |Analog inputs: Zero scaling thresholds|176|
|397|0 ISA00|V|Zero scaling threshold (+/-)|176|
|397|1 ISA01|V|Zero scaling threshold (+/-)| |
|398|CON_ANA_Scale_ThLower| |Analog inputs: Lower scaling limits|177|
|398|0 ISA00|%|Lower scaling (@ zero threshold) threshold|177|
|398|1 ISA01|%|Lower scaling (@ zero threshold) threshold| |
|399|CON_ANA_WireBrk_Th| |Analog inputs: Wire break thresholds|Table 8.26:|
|399|0 ISA00|V|Wire break detection threshold| |
|399|1 ISA01|V|Wire break detection threshold| |
|405|0 CON_ANA_Filt0|ms|Analog input ISA00: Filter time constant (PT 1)|ID|
|408|CON_ANA_Isaf_Norm| |Analog inputs: Values (filt, norm)|183|
|408|0 ISA00| |Filtered, normalized value|183|
|408|1 ISA01| |Filtered, normalized value|183|

Table 8.25: “Analog channel” parameters

|ID|Index Name|Unit|Description|ID|
|---|---|---|---|---|
|173|MPRO_ANA0_Scale| |ANA0: scale factors|184|
|173|0 MPRO_ANA0_TScale|Nm|ANA0: scale factor torque reference|185|
|173|1 MPRO_ANA0_SScale|rev/min|ANA0: scale factor speed reference|185|
|173|2 MPRO_ANA0_PScale|mDegree|ANA0: scale factor position reference| |
|174|MPRO_ANA0_Offset| |ANA0: offsets|185|
|174|0 MPRO_ANA0_TOffset|Nm|ANA0: offsets for torque reference|185|

Table 8.26: “Analog channel ISA00” parameters

|Index Name|Unit|Description|
|---|---|---|
|1 MPRO_ANA0_SOffset|rev/min|ANA0: offsets for speed reference|
|2 MPRO_ANA0_POffset|mDegree|ANA0: offsets for position reference|
|MPRO_ANA0_Threshold| |ANA0: thresholds|
|0 MPRO_ANA0_TThreshold|Nm|ANA0: threshold for torque reference|
|1 MPRO_ANA0_SThreshold|rev/min|ANA0: threshold for speed reference|
|2 MPRO_ANA0_PThreshold|mDegree|ANA0: threshold for position reference|
|MPRO_ANA0_TRamp| |ANA0: Torque mode acceleration [0] and deceleration [1]|
|0 MPRO_ANA0_TRamp|Nm/s| |
|1 MPRO_ANA0_TRamp|Nm/s| |
|MPRO_ANA0_SRamp| |ANA0: Speed mode acceleration [0] and deceleration [1]|
|0 MPRO_ANA0_SRamp|SPEED/s| |
|1 MPRO_ANA0_SRamp|SPEED/s| |

“Analog channel ISA00” parameters (continue)

|Index Name|Unit|Description|
|---|---|---|
|MPRO_ANA1_Scale| |ANA1: scale factors|
|0 MPRO_ANA1_TScale|Nm|ANA0: scale factor torque reference|
|1 MPRO_ANA1_SScale|rev/min|ANA0: scale factor speed reference|
|2 MPRO_ANA1_PScale|mDegree|ANA0: scale factor position reference|
|MPRO_ANA1_Offset| |ANA1: offsets|
|0 MPRO_ANA1_TOffset|Nm|ANA1: offsets for torque reference|
|1 MPRO_ANA1_SOffset|rev/min|ANA1: offsets for speed reference|
|2 MPRO_ANA1_POffset|mDegree|ANA1: offsets for position reference|
|MPRO_ANA1_Threshold| |ANA1: thresholds|
|0 MPRO_ANA1_TThreshold|Nm|ANA1: threshold for torque reference|
|1 MPRO_ANA1_SThreshold|rev/min|ANA1: threshold for speed reference|
|2 MPRO_ANA1_PThreshold|mDegree|ANA1: threshold for position reference|

“Analog channel ISA01” parameters

# 8 Motion profile

|ID|Index Name|Unit|Description|
|---|---|---|---|
|186|MPRO_ANA1_TRamp|Nm/s|ANA1: Torque mode acceleration [0] and deceleration[1]|
|186|MPRO_ANA1_TRamp|Nm/s| |
|187|MPRO_ANA1_SRamp|SPEED/s|ANA1: Speed mode acceleration [0] and deceleration [1]|
|187|MPRO_ANA1_SRamp|SPEED/s| |

# Table 8.27: “Analog channel ISA01” parameters (continue)

Display

- System state
- Initialization on device startup
- Not ready (DC link voltage possibly too low)
- Start inhibit (DC link voltage present, power stage off)
- Starting lockout
- Ready for start
- Control initialization: Auto commutation, flux build-up etc.

# Table 8.28: Central state machine according to CiA 402 device display

MOOG ID No.:CB40859-001 Date:11/2020

MSD ServoDrive - DeviceHelp 273

# 8 Motion profile

MOOG ID No.:CB40859-001 Date:11/2020

MSD ServoDrive - DeviceHelp 274

|Display|System state|power disabled|fault|
|---|---|---|---|
|Control enabled|0|Start|7|
| |fault reaction active|0|14|
|Quick stop active|1|not ready|8|
| |to switch on|1|17|
|Error reaction active|2|switch on|disabled|
| |2|7| |
|Error state (in this state the error is indicated directly on the display.)|3|ready to|switch on|
|Device is reset (display flashes)|power enabled|3|6|
| |10|12| |
|• Number [5.] flashes when “STO” (Safe Torque Off) input is active. Display goes out when STO inactive.| | | |
|• The dot on the display flashes when the power stage is active.| | | |

Table 8.28: Central state machine according to CiA 402 device display (continue)

NOTE

l The system states indicated on the display may differ from the states in the table depending on the drive profile setting.

Image 8.70: State machine diagram based on CANopen communications

⓪ to ① State number

1 to 17 State transition (No. 17: DC link voltage cut off)

Legend for “State machine diagram based on CANopen communications” figure

# 8.10 Touch probe

|ID|Index Name / Setting|
|---|---|
|241|0 MPRO_TP_Position|
|241|1 MPRO_TP_Position|
|241|2 MPRO_TP_Position|
|241|3 MPRO_TP_Position|
|241|4 MPRO_TP_Position|
|1400|0 MPRO_TP_Config|
| |TP_TP (0)|
| |AB (1)|
| |PD_UP (2)|
| |PD_DOWN (3)|
| |PC_PC (4)|
| |PC_TP (5)|
| |TP_PC (6)|
| |ENC_ENC (7)|
| |ENC_TP (8)|
| |TP_ENC (9)|

Using the touch probe inputs, touch probe functions can be performed. In order to be able to do this, P 106[0] - MPRO_INPUT_FS_ISD05 and P 107[0] - MPRO_INPUT_FS_ISD06 must be used to set digital inputs ISD05 and ISD06 to ""PROBE(15) = Touch probe (only ISD05/06)"" (see Section ""Digital inputs"" on page 290). HTL encoders can be evaluated or pulse counters implemented using the MSD PLC.

The touch probe can be triggered with P 240 - MPRO_TP_Ctrl. This enables triggering on a positive or negative edge, or on both edges, of the signal detected on the touch probe inputs. After the measurement, the parameter jumps back to the value ""NONE (0)"" and the latch position is mapped in the corresponding subindex of parameter P 241 - MPRO_TP_Position. A continuous touch probe mode is not possible at present, so the touch probe has to be reactivated after the measurement.

P 1402 - MPRO_TP_Channel can be used to select various positions as actual value sources of the latch position for the touch probe functionality. The following table provides an overview of the available settings. The counters are accessed via the MSD PLC or a bus system.

|ID|Index Name / Setting|Unit|Description|
|---|---|---|---|
|240|MPRO_TP_Ctrl|Touch probe: Control| |
| |0| |NONE (0) = No function|
| |1| |POS (1) = Positive edge|
| |2| |NEG (2) = Negative edge|
| |3| |BOTH (3) = Both edges|
|240|0 MPRO_TP_Ctrl| | |
|240|1 MPRO_TP_Ctrl| | |
|240|2 MPRO_TP_Ctrl| | |
|241|MPRO_TP_Position|Probe: Pos. high/low edge of TP0/1, encoder zero pulse| |

Table 8.29: “Touch probe” parameters

MOOG ID No.:CB40859-001 Date:11/2020

# 8 Motion profile

|Unit|Description|
|---|---|
|mDegree|Touch probe: Configuration|
|mDegree|TP0, TP1 touch probe|
|mDegree|TP0, TP1 as encoder, A/B as quadrature counting|
|mDegree|TP0, TP1 as encoder, pulse (TP0) / direction (TP1), count up on direction high|
|mDegree|TP0, TP1 as encoder, pulse (TP0) / direction (TP1), count down on direction high|
|mDegree|TP0 pulse counter, TP1 pulse counter|
|mDegree|TP0 pulse counter, TP1 touch probe|
|mDegree|TP1 touch probe, TP0 pulse counter|
|mDegree|TP0 encoder counter, TP1 encoder counter|
|mDegree|TP0 encoder counter, TP1 touch probe|
|mDegree|TP0 touch probe, TP1 encoder counter|

Touch probe: Channel

|Unit|Description|
|---|---|
|ACTPOS (0)|Actual position in user units|
|ACTPOSINC (1)|Actual position in increments|
|MASTERPOS (2)|Master position in increments|
|ENCPOS_CH1 (3)|Encoder position Channel 1|
|ENCPOS_CH1_INC (4)|Encoder position Channel 1 in increments|
|ENCPOS_CH2 (5)|Encoder position Channel 2|
|ENCPOS_CH2_INC (6)|Encoder position Channel 2 in increments|

# 8 Motion profile

MOOG ID No.:CB40859-001 Date:11/2020 MSD ServoDrive - DeviceHelp 276

|ID|Index Name / Setting|Unit|Description|
|---|---|---|---|
|7|ENCPOS_CH3 (7)| |Encoder position Channel 3|
|8|ENCPOS_CH3_INC (8)| |Encoder position Channel 3 in increments|
|9|ENCPOS_CH4 (9)| |Encoder position Channel 4|
|10|ENCPOS_CH4_INC (10)| |Encoder position Channel 4 in increments|
|11|ACTPOS2 (11)| |Actual position of redundant encoder in user units|
|12|Sercos (12)| |Referred to Sercos profile parameters S-x-0426, S-x-0427|
|13|UserRefPos(13)| |Reference position in user units|
|14|MasterPosST(14)| |Master position (ECAM, EGEAR) singleturn, always steps|
|15|CommonMasterPos(15)| |Master position (ECAM, EGEAR) singleturn, always steps|
|16|CommonMasterPosST(15)| |Master position (ECAM, EGEAR) singleturn, always steps|
|1402|MPRO_TP_Channel| | |
|1402|MPRO_TP_Channel| | |
|1402|MPRO_TP_Channel| | |
|1404|MPRO_TP_Lines| |Touch probe: Lines @ pulse counter on channel x|
|1404|MPRO_TP_Lines| | |
|1404|MPRO_TP_Lines| | |

Image 8.71: “Synchronized motion” screen

There are various modes available in the “synchronization mode” drop-down menu (P 242[0] - MPRO_ECAM_SyncModMode):

- Off(0) = Synchronized motion off
- ECAM_iPlc(1) = Electronic cam plate via MSD PLC
- EGEAR_iPlc(2) = Electr. gear unit via MSD PLC
- ECAM_PARA(3) = Electronic camming via parameters
- EGEAR_PARA(4) = Electronic gearing via parameters

NOTE: For more information refer to the bus system User Manuals or the description of the MSD PLC.

# 8.11.1 Electronic cam plate

The other parameters are configured in separate screens that can be accessed with the corresponding buttons.

- Master configuration (see Section ""Master configuration"" on page 280)
- Electronic gearing (see Section ""Electronic gearing"" on page 283)
- Electronic camming (see Section ""Electronic cam plate"" on page 277)

P 1318[0] - MPRO_ECAM_ControlWord is the control word for “synchronized motion” (see Section ""Control word for synchronized motion"" on page 279).

P 1326[0] - MPRO_ECAM_StatusWord is the status word for “synchronized motion” (see Section ""Status word for synchronized motion"" on page 279).

# 8.11.1.1 Table selection

|ID|Index Name|Unit|Description|
|---|---|---|---|
|1300|MPRO_ECAM_CTS_| |ECAM: CamTableSelect - Master reference|
|1301|MasterRef| | |
|1305|MPRO_ECAM_CTS_| |ECAM: CamTableSelect - Method for changing the camtable|
|1306|MPRO_ECAM_CTS_| |ECAM: CamTableSelect - Mode for changing the camtable|
|1307|MPRO_ECAM_CTS_|incr|ECAM: CamTableSelect - Distance for changing the camtable|
|242|MPRO_ECAM_| |ECAM / EGEAR: Mode of synchronized motion SyncModMode|
|265|MPRO_ECAM_| |ECAM / EGEAR: Slave speed factor (1 = 100%).|
|266|CamSlave_SpeedFactor| | |
|268|MPRO_ECAM_| |ECAM / EGEAR: Mode of switching off sync. motion|

# 8.11.1.2 Synchronization

|ID|Index Name|Unit|Description|
|---|---|---|---|
|1342|MPRO_ECAM_CI_|incr|ECAM: CamIn - Synchronization position (multiturn part)|
|1343|MPRO_ECAM_CO_|incr|ECAM: CamOut - Decoupling pos. (multiturn part)|
|1303|MPRO_ECAM_CI_|incr|ECAM: CamIn - Master offset|
|1308|MPRO_ECAM_CI_| |ECAM: CamIn - Master reference|
|1309|MPRO_ECAM_CI_| |ECAM: CamIn - Slave reference|
|1310|MPRO_ECAM_CI_| |ECAM: CamIn - Coupling mode|
|1311|MPRO_ECAM_CI_|incr|ECAM: CamIn - Coupling distance|
|1312|MPRO_ECAM_CI_|incr|ECAM: CamIn - Synchronization position|

Table 8.31: “Electronic camming - Table selection” parameters

Table 8.30: “Synchronized motion” parameters

Table 8.32: “Electronic camming - Synchronization” parameters

MOOG ID No.:CB40859-001 Date:11/2020

MSD ServoDrive - DeviceHelp 277

# 8 Motion profile

MOOG ID No.:CB40859-001 Date:11/2020 MSD ServoDrive - DeviceHelp 278

|ID|Index|Name|Unit|Description|
|---|---|---|---|---|
|1313|0|MPRO_ECAM_CO_SyncPosST|(singleturn part)|ECAM: CamOut - Slave reference|
|1314|0|MPRO_ECAM_CO_DecouplingMode|63|ECAM: CamOut - Decoupling mode|
|1315|0|MPRO_ECAM_CO_BreakingPosST|incr|ECAM: CamOut - Decoupling position|
|1316|0|MPRO_ECAM_CO_DecouplingDist|incr|ECAM: CamOut - Decoupling distance|
|1317|0|MPRO_ECAM_CO_StandstillPos|mDegree|ECAM: CamOut - Slave standstill position|

# Table 8.32: “Electronic camming - Synchronization” parameters (continue)

|ID|Index|Name|Unit|Description|
|---|---|---|---|---|
|1346| |MPRO_ECAM_SP_Table| |ECAM: Setpoint table interface|
|1346|0|Index| |Index of setpoint table|
|1346|1|Value| |Value at index of setpoint table|
|1347|0 to 31|MPRO_ECAM_SP_Index| |ECAM: Setpoint segments start index|
|1348|0 to 31|MPRO_ECAM_SP_Length| |ECAM: Setpoint segments length|
|1349|0 to 31|Length| | |
|1350|0|MPRO_ECAM_SP_MaDist| |ECAM: Setpoint segments master distance|
|1351|0|MPRO_ECAM_SP_IpoType| |ECAM: Setpoint segments interpolation type|
|1352|0 to 31|Checksum| |ECAM: Setpoint table checksum|
|1353|0 to 31|GainNum| |ECAM: Setpoint segments gain numerator|
| | |GainDen| |ECAM: Setpoint segments gain denominator|

# Table 8.33: “Electronic camming - Table segments” parameters

|ID|Index|Name|Unit|Description|
|---|---|---|---|---|
|1329|0 to 63|MPRO_ECAM_SegData_IndexNext| |ECAM: Index of the following segment|
|1330|0 to 63|MPRO_ECAM_SegData_IndexPrev| |ECAM: Index of the previous segment|
|1331|0 to 63|MPRO_ECAM_SegData_ProfileMode| |ECAM: Profile mode of the current segment|
|1332|0 to 63|MPRO_ECAM_SegData_DistMaster| |ECAM: Length of the master section of the current segment|
|1333|0 to 63|MPRO_ECAM_SegData_DistSlave| |ECAM: Length of the slave section of the current segment|
|1334|0 to 63|MPRO_ECAM_SegData_Lambda| |ECAM: Lambda value of the current segment|
|1335|0 to 63|MPRO_ECAM_SegData_StatusWord| |ECAM: Status word of the current segment|
|1336|0 to 63|MPRO_ECAM_SegData_ControlWord| |ECAM: Control word of the current segment|

# 8.11.2 Control word for synchronized motion

|Bit|Function|PLC function|Bit number|Description|
|---|---|---|---|---|
|0-7|Start segment (8-bit value)|-|0-7|Actual segment (8-bit value)|
|8-15|Reserved|-| |Actual ECAM / EGEAR state machine state (4 Bit value)|
|16|Absolute (true) / relative (false) master relationship|-| |- 0: ECAM / EGEAR asynchronous
- 1: ECAM / EGEAR synchronous
|
|17|Absolute (true) / relative (false) master (CAM) relationship at cam in|-| |- 2: ECAM / EGEAR synchronizing
- 3: ECAM / EGEAR desynchronizing
|
|18|Absolute (true) / relative (false) slave (CAM) relationship at cam in|-| |- 4: ECAM / EGEAR active and waiting for going asynchronous
|
|19-23|Reserved|-| |- 5: ECAM / EGEAR inactive and waiting for going synchronous
|
|24|Change gear ratio of the electronic gear online|MCB_GearRatioChange| | |
|25|Disable master calculation|MCB_Cam_MasterEnable| | |
|26|Enable master calculation|MCB_Cam_MasterEnable| | |
|27|Select CAM table|MCB_CamTableSelect| | |
|28|Start Ecam|MCB_CamIn| | |
|29|Stop Ecam|MCB_CamOut| | |
|30|Start Egear|MCB_GearIn| | |
|31|Stop Egear|MCB_GearOut| | |

# 8.11.3 Status word for synchronized motion

|Bit|Function|PLC function|Bit number|Description|
|---|---|---|---|---|
|12-26|Reserved|-| | |
|27|ECAM / EGEAR is active|-| | |
|28|Valid segments chosen|-| | |
|29|Master data are valid|-| | |
|30|Master is initialized|-| | |
|31|Master calculation is active|-| | |

Table 8.35: Control word ECAM (P 1318[0] - MPRO_ECAM_ControlWord)

Table 8.36: ECAM status word (P 1326[0] - MPRO_ECAM_StatusWord)

MOOG ID No.:CB40859-001 Date:11/2020 MSD ServoDrive - DeviceHelp 279

# 8 Motion profile

# 8 Motion profile

MOOG ID No.:CB40859-001 Date:11/2020

MSD ServoDrive - DeviceHelp 280

# 8.11.4 Master configuration

the master encoder, you will need to set the resolution relative to a single motor revolution in P 250 - MPRO_ECAM_PARAMaster_Amplitude (see below).

- ENC CH1 (3) = Encoder channel 1 X7 (Sin/Cos)
- ENC CH2 (4) = Encoder channel 2 X6 (Resolver)
- ENC CH3 (5) = Encoder channel 3 X8 (optional)

This function is only available if an external interface X8 (option module) is present.

- TP0 (6) = Pulse counter on probe channel 0 (TP0)
- TP1 (7) = Pulse counter on probe channel 1 (TP1)
- ENC_CH4 (8) = Encoder channel 4 (p. e. fieldbus)
- TWIN_POS (9) = TWIN remote reference position (P-2607)

Image 8.72: “Master configuration” screen

# Channel selection (master encoder)

P 1319[0] - MPRO_ECAM_CamMaster_AxisType is used to define the master encoder.

- NO AXIS (0) = No axis
- VIRTUAL MASTER (1) = Virtual master

If you select this function, you will be able to configure additional settings by clicking on the enabled “Options...” button (see Section ""Virtual Master"" on page 286).

- PARA (2) = Master parameter interface

If you select this function because a higher-level controller is being used as

# Anti-reverse mode

Slave only starts moving along with it again as soon as the master reaches the zero position.

P 1320[0] - MPRO_ECAM_CamMaster_RevLockMode is used to define the reverse lock mode, which can be used either with or without path compensation. The dashed lines in the following diagrams indicate what the engagement distance is:

# Example:

If the master, which has moved two motor revolutions in the direction blocked for the slave, then moves in the unblocked direction again, the slave only moves off when the master has traversed the zero point.

- INACTIVE (0) = Reverse lock inactive
- ACTIVE (2) = Reverse lock enabled - without path optimization
- ACTIVE WAY COMP (1) = Reverse lock active - with way compensation

While the slave accelerates to the speed of the master during engagement, the master and slave do not move synchronously. This function needs to be selected in order to quickly catch up to the master that is running ahead.

# Example:

- Master (black line) rotates in the blocked direction
- The slave (blue line) remains stopped
- Master rotates in the unblocked direction again
- The slave follows the master directly in the unblocked direction

Assume the master has moved two motor revolutions in the direction for which the slave lock is enabled. If the master now moves in the direction for which there is no lock, the slave will immediately start running in that direction.

MOOG ID No.:CB40859-001 Date:11/2020

MSD ServoDrive - DeviceHelp 281

# 8 Motion profile

MOOG ID No.:CB40859-001 Date:11/2020 MSD ServoDrive - DeviceHelp 282

|Filter type|ID|Index Name|Unit|Description|
|---|---|---|---|---|
|When using a real master encoder, encoder signals may be subject to noise.|P 1340|1319|0|MPRO_ECAM_CamMaster_AxisType|
| | |MPRO_ECAM_CamMaster_SpeedFilTyp| |ECAM / EGEAR: Channel selection of internal master input|
| | |1320|0|MPRO_ECAM_CamMaster_RevLockMode|
| | |1321|0|MPRO_ECAM_CamMaster_Amplitude|
| | |1322|0|MPRO_ECAM_CamMaster_GearNum|
| | |1323|0|MPRO_ECAM_CamMaster_GearDen|
|Filter time|1327|0|ms|ECAM / EGEAR: Filter time constant of master|
|If P 1340[0] is used to enable a filter, P 1327[0] - MPRO_ECAM_CamMaster_SpeedTFil can be used to define the corresponding filter time.|1328|0|speed|ECAM / EGEAR: Speed factor of the internal master|
|Speed factor|1340|0| |MPRO_ECAM_CamMaster_SpeedFilTyp|
|The master encoder can be assigned an additional speed factor P 1328[0] - MPRO_ECAM_CamMaster_SpeedFactor.|1341|0|incr|ECAM / EGEAR: Master drive offset|

Table 8.37: “Synchronized motion - Master configuration” parameters (continue)

| | | |ID|Index Name|Unit|Description|
|---|---|---|---|---|---|---|
|247|0|MPRO_ECAM_ParaMaster_ActPos|incr|ECAM / EGEAR: Parameter interface master position| | |
|248|0|MPRO_ECAM_ParaMaster_ActSpeed|rpm|ECAM / EGEAR: Parameter interface master speed| | |
|249|0|MPRO_ECAM_ParaMaster_ActAcc|rpm|ECAM / EGEAR: Parameter interface master acceleration| | |
| |250|0|MPRO_ECAM_ParaMaster_Amplitude| |ECAM / EGEAR: Parameter interface master amplitude| |

Table 8.37: “Synchronized motion - Master configuration” parameters

# 8.11.5 Electronic gearing

# Gear ratio

The gear ratio is specified as a fraction. This ensures that the position references can be translated to the motor shaft with no rounding error.

- ""Slave"" (P 252[0] - MPRO_ECAM_Egear_GearNum) is the numerator
- ""Master"" (P 251[0] - MPRO_ECAM_Egear_GearDen) is the denominator

# Scaling of speed pre-control

Defined with P 265[0] - MPRO_ECAM_CamSlave_SpeedFactor definiert.

# Scaling of torque pre-control

Defined with P 266[0] - MPRO_ECAM_CamSlave_TorqueFactor.

# Engagement

See Section ""Engagement"" on page 284.

# Disengagement

See Section ""Disengagement"" on page 285.

|ID|Index Name|Unit|Description|
|---|---|---|---|
|251|0 MPRO_ECAM_Egear_GearDen| |EGEAR: Gear denominator|
|252|0 MPRO_ECAM_Egear_GearNum| |EGEAR: Numerator of gear ratio|
|1344|0 MPRO_ECAM_Egear_LimRefAcc|rpm/s|EGEAR: Acceleration limit for reference|
|1345|0 MPRO_ECAM_Egear_LimRefJerk|rpm/s²|EGEAR: Jerk limit for reference|

Table 8.38: “Synchronized motion - Electronic gearing” parameters

Image 8.73: ""Electronic gearing"" screen

MOOG ID No.:CB40859-001 Date:11/2020 MSD ServoDrive - DeviceHelp 283

# 8 Motion profile

# 8 Motion profile

MOOG ID No.:CB40859-001 Date:11/2020

MSD ServoDrive - DeviceHelp 284

# 8.11.6 Engagement

used to define the engagement distance (between the dashed lines).

P 253[0] - MPRO_ECAM_Egear_GearInMode is used to define the mode for engagement.

- DIRECT (0) = Direct
- Direct engagement: Angular synchronous; with jerking (no ramps).
- CROSSFADE (3) = Crossfading
- Engagement with crossfading function (5th degree polynomial): Angular synchronous; jerk-limited; speed will overshoot during engagement.
- RAMP (1) = Linear speed ramp
- Engagement with linear acceleration: Not angular synchronous; with jerking.
- FADE (2) = Engagement fade-out
- Engagement with fade-in function (5th degree polynomial): Not angular synchronous; jerk-limited. The position is ignored. ",What is the function of the deceleration ramp parameter in the analog channels ISA00 and ISA01 in the 'MSD ServoDrive - DeviceHelp' document?,A1,It serves as a deceleration ramp for torque or speed control.,1.4921875,1.515625,3.40625,1.2578125,0.234375
31,msd_servo_drive.txt,76,b87ca5e232c2bdbb6fa16a8a401c6b5d285dc0183e73cc9d134de13dd2fc71d2,"MOOG ID No.:CB40859-001 Date:11/2020

MSD ServoDrive - DeviceHelp 267

# 8 Motion profile

MOOG ID No.:CB40859-001 Date:11/2020 MSD ServoDrive - DeviceHelp 268

# Deceleration

With ...

- P 194 - MPRO_TAB_TDec (for torque control) or
- P 197 - MPRO_TAB_SDec (for speed control) or
- P 200 - MPRO_TAB_PDec (for position control)

and indexes 0–15, the deceleration for each individual motion task can be defined. The input must not be zero.

# Wait time in Auto mode

P 204 - MPRO_TAB_WaitTime is used to define the wait time before the next motion task is carried out.

# Maximum table index in Auto mode

P 206[0] - MPRO_Tab_MaxIdx is used to define the table index up to which driving jobs will be carried out in one of the auto modes.

# Current table index

P 207[0] - MPRO_Tab_ActIdx will show the index for the motion task that is currently active. If parameter P 205 MPRO_TAB_Mode is set to “Para(0)”, a driving set can be entered and approached directly.

# Activation of reference table

The following procedures can be used in order to activate the setpoint table for operation.

|ID|Index Name|Unit|Description|
|---|---|---|---|
|193|MPRO_TAB_TAcc|TAB: Torque mode acceleration|Nm/ms|
|193|0|MPRO_TAB_TAcc|Nm/ms|
|193|1 - 15|MPRO_TAB_TAcc|Nm/ms|
|194|MPRO_TAB_TDec|TAB: Torque mode deceleration| |
|194|0|MPRO_TAB_TDec|Nm/ms|
|194|1 - 15|MPRO_TAB_TDec|Nm/ms|

# Table 8.23: Activation of table references

# Table 8.24: “Setpoint table settings” parameters

# Table 8.24: “Setpoint table settings” parameters (continue)

|ID|Index Name|Unit|Description|ID|Index Name|Unit|Description|
|---|---|---|---|---|---|---|---|
|195|MPRO_TAB_TRef|Nm|TAB: Torque mode reference value|208|MPRO_TAB_OutputNo| |OSD TAB: actual table index and target|
|195|MPRO_TAB_TRef|Nm| |208|MPRO_TAB_OutputNo| | |
|196|MPRO_TAB_SAcc|rev/min/s|TAB: Speed mode acceleration|269|MPRO_TAB_Ctrl| |TAB: control word|
|196|MPRO_TAB_SAcc|rev/min/s| | | | | |
|197|MPRO_TAB_SDec|rev/min/s|TAB: Speed mode deceleration| | | | |
|197|MPRO_TAB_SDec|rev/min/s| | | | | |
|198|MPRO_TAB_SRef|rev/min|TAB: Speed mode reference value| | | | |
|198|MPRO_TAB_SRef|rev/min| | | | | |
|199|MPRO_TAB_PAcc|rev/min/s|TAB: Position control mode acceleration| | | | |
|199|MPRO_TAB_PAcc|rev/min/s| | | | | |
|200|MPRO_TAB_PDec|rev/min/s|TAB: Position control mode Acceleration| | | | |
|200|MPRO_TAB_PDec|rev/min/s| | | | | |
|201|MPRO_TAB_PSpd|rev/min|TAB: Position control mode speed| | | | |
|201|MPRO_TAB_PSpd|rev/min| | | | | |
|202|MPRO_TAB_PPos|mDegree|TAB: Position control mode reference value| | | | |
|202|MPRO_TAB_PPos|mDegree| | | | | |
|203|MPRO_TAB_PMode| |Position control table:Mode| | | | |
|203|MPRO_TAB_PMode| | | | | | |
|204|MPRO_TAB_WaitTime|ms|TAB: Wait time| | | | |
|204|MPRO_TAB_WaitTime|ms| | | | | |
|205|MPRO_TAB_Mode| |TAB mode| | | | |
|206|MPRO_Tab_MaxIdx| |TAB: Max index in AUTO mode| | | | |
|207|MPRO_TAB_ActIdx| |TAB: Actual index| | | | |

MOOG ID No.:CB40859-001 Date:11/2020

MSD ServoDrive - DeviceHelp

# 8 Motion profile

MOOG ID No.:CB40859-001 Date:11/2020

MSD ServoDrive - DeviceHelp 270

# 8.8 Analog channel (ISA00 und ISA01)

# Offset (O)

This parameter (P 174 - MPRO_ANA0_SOffset for ISA00, P 184 - MPRO_ANA1_SOffset for ISA01) compensates for component variations and is used for offset compensation purposes. Depending on the control mode being used (see Section ""Basic settings"" on page 110), the value will be stored in parameter index [0] (torque control), [1] (speed control) or [2] (position control).

# Backlash (B)

This parameter (P 175 - MPRO_ANA0_SThreshold for ISA00, P 185 - MPRO_ANA1_SThreshold for ISA01) can suppress axis motion close to the standstill (stop) position. Depending on the control mode being used (see Section ""Basic settings"" on page 110), the value will be stored in parameter index [0] (torque control), [1] (speed control) or [2] (position control).

Image 8.68: “Analog channel” screen

# Acceleration ramp

Two standard analog inputs (ISA00, ISA01) are available. These inputs can be configured...

- with negative values for analog setpoint settings
- with positive values for digital setpoint processing

(P 109[0] - MPRO_INPUT_FS_ISA00 and P 110[0] - MPRO_INPUT_FS_ISA01).

see also section ""Analog Inputs"" on page 303. By using the ""REV(-2) = Analog setpoint"" setting, an analog input voltage of ±10 V can be processed as a setpoint.

# Deceleration ramp

This parameter serves as a deceleration ramp for torque control (P 176[1] - MPRO_ANA0_TRamp for ISA00, P 186[1] - MPRO_ANA1_TRamp for ISA01) or speed control (P 177[1] - MPRO_ANA0_SRamp for ISA00, P 187[1] - MPRO_ANA1_SRamp for ISA01). Depending on the control mode being used (see Section ""Basic settings"" on page 110), the value will be stored in parameter index [0] (torque control), [1] (speed control) or [2] (position control).

This parameter (P 173 - MPRO_ANA0_Scale for ISA00, P 183 - MPRO_ANA1_Scale for ISA01) is used to define which speed / which torque / which position corresponds to the maximum analog value. Depending on the control mode being used (see Section ""Basic settings"" on page 110), the value will be stored in parameter index [0] (torque control), [1] (speed control) or [2] (position control).

# 8.8.1 Special characteristics of position control mode

A threshold value can also be specified which generates a run-on range around the last reference value. A ramp function calculates a motion profile for the position reference from pre-defined acceleration and speed limits.

The position references on the analog channel are not applied immediately, but dependent on a digital input. Accordingly, one of the ISD00 to ISD06 digital inputs must be set to a value of ""REFANAEN(28) = Enable analog reference value"" (see Section ""Digital inputs"" on page 290). The position setpoint being received will only be applied if the corresponding digital input is active. The acceleration is entered using P 173[0] - MPRO_ANA0_TScale or P 183[0] - MPRO_ANA1_TScale.

# 8.8.2 Wire Break Monitoring

P 399 - CON_ANAWireBrk_Th can be used to configure wire break monitoring for the analog inputs. For details see Section ""Wire Break Monitoring"" on page 306.

|Function|TLIM (-4)|OVR (-3)|REFV (-2)|leer (-1)|OFF (0)|
|---|---|---|---|---|---|
|Digital|(1)-(28)|(1)-(28)|(1)-(28)|(1)-(28)|(1)-(28)|
|Analog channel|Filter|Scale|Offset|Profile|generator|

Control

Image 8.69: Reference processing structure

MOOG ID No.:CB40859-001 Date:11/2020

MSD ServoDrive - DeviceHelp 271

# 8 Motion profile

# 8 Motion profile

MOOG ID No.:CB40859-001 Date:11/2020

|ID|Index Name|Unit|Description|ID|
|---|---|---|---|---|
|395|CON_ANA_Isaf_Scaled| |Analog inputs: Values (filt, norm, comp, scaled)|174|
|395|0 ISA00| |Scaled, compensated, filtered, normalized value|175|
|395|1 ISA01| |Scaled, compensated, filtered, normalized value| |
|396|CON_ANA_Scale_ThUpper| |Analog inputs: Upper scaling limits|175|
|396|0 ISA00|%|Upper scaling (@ 10 V) threshold|175|
|396|1 ISA01|%|Upper scaling (@ 10 V) threshold| |
|397|CON_ANA_Scale_ThZero| |Analog inputs: Zero scaling thresholds|176|
|397|0 ISA00|V|Zero scaling threshold (+/-)|176|
|397|1 ISA01|V|Zero scaling threshold (+/-)| |
|398|CON_ANA_Scale_ThLower| |Analog inputs: Lower scaling limits|177|
|398|0 ISA00|%|Lower scaling (@ zero threshold) threshold|177|
|398|1 ISA01|%|Lower scaling (@ zero threshold) threshold| |
|399|CON_ANA_WireBrk_Th| |Analog inputs: Wire break thresholds|Table 8.26:|
|399|0 ISA00|V|Wire break detection threshold| |
|399|1 ISA01|V|Wire break detection threshold| |
|405|0 CON_ANA_Filt0|ms|Analog input ISA00: Filter time constant (PT 1)|ID|
|408|CON_ANA_Isaf_Norm| |Analog inputs: Values (filt, norm)|183|
|408|0 ISA00| |Filtered, normalized value|183|
|408|1 ISA01| |Filtered, normalized value|183|

Table 8.25: “Analog channel” parameters

|ID|Index Name|Unit|Description|ID|
|---|---|---|---|---|
|173|MPRO_ANA0_Scale| |ANA0: scale factors|184|
|173|0 MPRO_ANA0_TScale|Nm|ANA0: scale factor torque reference|185|
|173|1 MPRO_ANA0_SScale|rev/min|ANA0: scale factor speed reference|185|
|173|2 MPRO_ANA0_PScale|mDegree|ANA0: scale factor position reference| |
|174|MPRO_ANA0_Offset| |ANA0: offsets|185|
|174|0 MPRO_ANA0_TOffset|Nm|ANA0: offsets for torque reference|185|

Table 8.26: “Analog channel ISA00” parameters

|Index Name|Unit|Description|
|---|---|---|
|1 MPRO_ANA0_SOffset|rev/min|ANA0: offsets for speed reference|
|2 MPRO_ANA0_POffset|mDegree|ANA0: offsets for position reference|
|MPRO_ANA0_Threshold| |ANA0: thresholds|
|0 MPRO_ANA0_TThreshold|Nm|ANA0: threshold for torque reference|
|1 MPRO_ANA0_SThreshold|rev/min|ANA0: threshold for speed reference|
|2 MPRO_ANA0_PThreshold|mDegree|ANA0: threshold for position reference|
|MPRO_ANA0_TRamp| |ANA0: Torque mode acceleration [0] and deceleration [1]|
|0 MPRO_ANA0_TRamp|Nm/s| |
|1 MPRO_ANA0_TRamp|Nm/s| |
|MPRO_ANA0_SRamp| |ANA0: Speed mode acceleration [0] and deceleration [1]|
|0 MPRO_ANA0_SRamp|SPEED/s| |
|1 MPRO_ANA0_SRamp|SPEED/s| |

“Analog channel ISA00” parameters (continue)

|Index Name|Unit|Description|
|---|---|---|
|MPRO_ANA1_Scale| |ANA1: scale factors|
|0 MPRO_ANA1_TScale|Nm|ANA0: scale factor torque reference|
|1 MPRO_ANA1_SScale|rev/min|ANA0: scale factor speed reference|
|2 MPRO_ANA1_PScale|mDegree|ANA0: scale factor position reference|
|MPRO_ANA1_Offset| |ANA1: offsets|
|0 MPRO_ANA1_TOffset|Nm|ANA1: offsets for torque reference|
|1 MPRO_ANA1_SOffset|rev/min|ANA1: offsets for speed reference|
|2 MPRO_ANA1_POffset|mDegree|ANA1: offsets for position reference|
|MPRO_ANA1_Threshold| |ANA1: thresholds|
|0 MPRO_ANA1_TThreshold|Nm|ANA1: threshold for torque reference|
|1 MPRO_ANA1_SThreshold|rev/min|ANA1: threshold for speed reference|
|2 MPRO_ANA1_PThreshold|mDegree|ANA1: threshold for position reference|

“Analog channel ISA01” parameters

# 8 Motion profile

|ID|Index Name|Unit|Description|
|---|---|---|---|
|186|MPRO_ANA1_TRamp|Nm/s|ANA1: Torque mode acceleration [0] and deceleration[1]|
|186|MPRO_ANA1_TRamp|Nm/s| |
|187|MPRO_ANA1_SRamp|SPEED/s|ANA1: Speed mode acceleration [0] and deceleration [1]|
|187|MPRO_ANA1_SRamp|SPEED/s| |

# Table 8.27: “Analog channel ISA01” parameters (continue)

Display

- System state
- Initialization on device startup
- Not ready (DC link voltage possibly too low)
- Start inhibit (DC link voltage present, power stage off)
- Starting lockout
- Ready for start
- Control initialization: Auto commutation, flux build-up etc.

# Table 8.28: Central state machine according to CiA 402 device display

MOOG ID No.:CB40859-001 Date:11/2020

MSD ServoDrive - DeviceHelp 273

# 8 Motion profile

MOOG ID No.:CB40859-001 Date:11/2020

MSD ServoDrive - DeviceHelp 274

|Display|System state|power disabled|fault|
|---|---|---|---|
|Control enabled|0|Start|7|
| |fault reaction active|0|14|
|Quick stop active|1|not ready|8|
| |to switch on|1|17|
|Error reaction active|2|switch on|disabled|
| |2|7| |
|Error state (in this state the error is indicated directly on the display.)|3|ready to|switch on|
|Device is reset (display flashes)|power enabled|3|6|
| |10|12| |
|• Number [5.] flashes when “STO” (Safe Torque Off) input is active. Display goes out when STO inactive.| | | |
|• The dot on the display flashes when the power stage is active.| | | |

Table 8.28: Central state machine according to CiA 402 device display (continue)

NOTE

l The system states indicated on the display may differ from the states in the table depending on the drive profile setting.

Image 8.70: State machine diagram based on CANopen communications

⓪ to ① State number

1 to 17 State transition (No. 17: DC link voltage cut off)

Legend for “State machine diagram based on CANopen communications” figure

# 8.10 Touch probe

|ID|Index Name / Setting|
|---|---|
|241|0 MPRO_TP_Position|
|241|1 MPRO_TP_Position|
|241|2 MPRO_TP_Position|
|241|3 MPRO_TP_Position|
|241|4 MPRO_TP_Position|
|1400|0 MPRO_TP_Config|
| |TP_TP (0)|
| |AB (1)|
| |PD_UP (2)|
| |PD_DOWN (3)|
| |PC_PC (4)|
| |PC_TP (5)|
| |TP_PC (6)|
| |ENC_ENC (7)|
| |ENC_TP (8)|
| |TP_ENC (9)|

Using the touch probe inputs, touch probe functions can be performed. In order to be able to do this, P 106[0] - MPRO_INPUT_FS_ISD05 and P 107[0] - MPRO_INPUT_FS_ISD06 must be used to set digital inputs ISD05 and ISD06 to ""PROBE(15) = Touch probe (only ISD05/06)"" (see Section ""Digital inputs"" on page 290). HTL encoders can be evaluated or pulse counters implemented using the MSD PLC.

The touch probe can be triggered with P 240 - MPRO_TP_Ctrl. This enables triggering on a positive or negative edge, or on both edges, of the signal detected on the touch probe inputs. After the measurement, the parameter jumps back to the value ""NONE (0)"" and the latch position is mapped in the corresponding subindex of parameter P 241 - MPRO_TP_Position. A continuous touch probe mode is not possible at present, so the touch probe has to be reactivated after the measurement.

P 1402 - MPRO_TP_Channel can be used to select various positions as actual value sources of the latch position for the touch probe functionality. The following table provides an overview of the available settings. The counters are accessed via the MSD PLC or a bus system.

|ID|Index Name / Setting|Unit|Description|
|---|---|---|---|
|240|MPRO_TP_Ctrl|Touch probe: Control| |
| |0| |NONE (0) = No function|
| |1| |POS (1) = Positive edge|
| |2| |NEG (2) = Negative edge|
| |3| |BOTH (3) = Both edges|
|240|0 MPRO_TP_Ctrl| | |
|240|1 MPRO_TP_Ctrl| | |
|240|2 MPRO_TP_Ctrl| | |
|241|MPRO_TP_Position|Probe: Pos. high/low edge of TP0/1, encoder zero pulse| |

Table 8.29: “Touch probe” parameters

MOOG ID No.:CB40859-001 Date:11/2020

# 8 Motion profile

|Unit|Description|
|---|---|
|mDegree|Touch probe: Configuration|
|mDegree|TP0, TP1 touch probe|
|mDegree|TP0, TP1 as encoder, A/B as quadrature counting|
|mDegree|TP0, TP1 as encoder, pulse (TP0) / direction (TP1), count up on direction high|
|mDegree|TP0, TP1 as encoder, pulse (TP0) / direction (TP1), count down on direction high|
|mDegree|TP0 pulse counter, TP1 pulse counter|
|mDegree|TP0 pulse counter, TP1 touch probe|
|mDegree|TP1 touch probe, TP0 pulse counter|
|mDegree|TP0 encoder counter, TP1 encoder counter|
|mDegree|TP0 encoder counter, TP1 touch probe|
|mDegree|TP0 touch probe, TP1 encoder counter|

Touch probe: Channel

|Unit|Description|
|---|---|
|ACTPOS (0)|Actual position in user units|
|ACTPOSINC (1)|Actual position in increments|
|MASTERPOS (2)|Master position in increments|
|ENCPOS_CH1 (3)|Encoder position Channel 1|
|ENCPOS_CH1_INC (4)|Encoder position Channel 1 in increments|
|ENCPOS_CH2 (5)|Encoder position Channel 2|
|ENCPOS_CH2_INC (6)|Encoder position Channel 2 in increments|

# 8 Motion profile

MOOG ID No.:CB40859-001 Date:11/2020 MSD ServoDrive - DeviceHelp 276

|ID|Index Name / Setting|Unit|Description|
|---|---|---|---|
|7|ENCPOS_CH3 (7)| |Encoder position Channel 3|
|8|ENCPOS_CH3_INC (8)| |Encoder position Channel 3 in increments|
|9|ENCPOS_CH4 (9)| |Encoder position Channel 4|
|10|ENCPOS_CH4_INC (10)| |Encoder position Channel 4 in increments|
|11|ACTPOS2 (11)| |Actual position of redundant encoder in user units|
|12|Sercos (12)| |Referred to Sercos profile parameters S-x-0426, S-x-0427|
|13|UserRefPos(13)| |Reference position in user units|
|14|MasterPosST(14)| |Master position (ECAM, EGEAR) singleturn, always steps|
|15|CommonMasterPos(15)| |Master position (ECAM, EGEAR) singleturn, always steps|
|16|CommonMasterPosST(15)| |Master position (ECAM, EGEAR) singleturn, always steps|
|1402|MPRO_TP_Channel| | |
|1402|MPRO_TP_Channel| | |
|1402|MPRO_TP_Channel| | |
|1404|MPRO_TP_Lines| |Touch probe: Lines @ pulse counter on channel x|
|1404|MPRO_TP_Lines| | |
|1404|MPRO_TP_Lines| | |

Image 8.71: “Synchronized motion” screen

There are various modes available in the “synchronization mode” drop-down menu (P 242[0] - MPRO_ECAM_SyncModMode):

- Off(0) = Synchronized motion off
- ECAM_iPlc(1) = Electronic cam plate via MSD PLC
- EGEAR_iPlc(2) = Electr. gear unit via MSD PLC
- ECAM_PARA(3) = Electronic camming via parameters
- EGEAR_PARA(4) = Electronic gearing via parameters

NOTE: For more information refer to the bus system User Manuals or the description of the MSD PLC.

# 8.11.1 Electronic cam plate

The other parameters are configured in separate screens that can be accessed with the corresponding buttons.

- Master configuration (see Section ""Master configuration"" on page 280)
- Electronic gearing (see Section ""Electronic gearing"" on page 283)
- Electronic camming (see Section ""Electronic cam plate"" on page 277)

P 1318[0] - MPRO_ECAM_ControlWord is the control word for “synchronized motion” (see Section ""Control word for synchronized motion"" on page 279).

P 1326[0] - MPRO_ECAM_StatusWord is the status word for “synchronized motion” (see Section ""Status word for synchronized motion"" on page 279).

# 8.11.1.1 Table selection

|ID|Index Name|Unit|Description|
|---|---|---|---|
|1300|MPRO_ECAM_CTS_| |ECAM: CamTableSelect - Master reference|
|1301|MasterRef| | |
|1305|MPRO_ECAM_CTS_| |ECAM: CamTableSelect - Method for changing the camtable|
|1306|MPRO_ECAM_CTS_| |ECAM: CamTableSelect - Mode for changing the camtable|
|1307|MPRO_ECAM_CTS_|incr|ECAM: CamTableSelect - Distance for changing the camtable|
|242|MPRO_ECAM_| |ECAM / EGEAR: Mode of synchronized motion SyncModMode|
|265|MPRO_ECAM_| |ECAM / EGEAR: Slave speed factor (1 = 100%).|
|266|CamSlave_SpeedFactor| | |
|268|MPRO_ECAM_| |ECAM / EGEAR: Mode of switching off sync. motion|

# 8.11.1.2 Synchronization

|ID|Index Name|Unit|Description|
|---|---|---|---|
|1342|MPRO_ECAM_CI_|incr|ECAM: CamIn - Synchronization position (multiturn part)|
|1343|MPRO_ECAM_CO_|incr|ECAM: CamOut - Decoupling pos. (multiturn part)|
|1303|MPRO_ECAM_CI_|incr|ECAM: CamIn - Master offset|
|1308|MPRO_ECAM_CI_| |ECAM: CamIn - Master reference|
|1309|MPRO_ECAM_CI_| |ECAM: CamIn - Slave reference|
|1310|MPRO_ECAM_CI_| |ECAM: CamIn - Coupling mode|
|1311|MPRO_ECAM_CI_|incr|ECAM: CamIn - Coupling distance|
|1312|MPRO_ECAM_CI_|incr|ECAM: CamIn - Synchronization position|

Table 8.31: “Electronic camming - Table selection” parameters

Table 8.30: “Synchronized motion” parameters

Table 8.32: “Electronic camming - Synchronization” parameters

MOOG ID No.:CB40859-001 Date:11/2020

MSD ServoDrive - DeviceHelp 277

# 8 Motion profile

MOOG ID No.:CB40859-001 Date:11/2020 MSD ServoDrive - DeviceHelp 278

|ID|Index|Name|Unit|Description|
|---|---|---|---|---|
|1313|0|MPRO_ECAM_CO_SyncPosST|(singleturn part)|ECAM: CamOut - Slave reference|
|1314|0|MPRO_ECAM_CO_DecouplingMode|63|ECAM: CamOut - Decoupling mode|
|1315|0|MPRO_ECAM_CO_BreakingPosST|incr|ECAM: CamOut - Decoupling position|
|1316|0|MPRO_ECAM_CO_DecouplingDist|incr|ECAM: CamOut - Decoupling distance|
|1317|0|MPRO_ECAM_CO_StandstillPos|mDegree|ECAM: CamOut - Slave standstill position|

# Table 8.32: “Electronic camming - Synchronization” parameters (continue)

|ID|Index|Name|Unit|Description|
|---|---|---|---|---|
|1346| |MPRO_ECAM_SP_Table| |ECAM: Setpoint table interface|
|1346|0|Index| |Index of setpoint table|
|1346|1|Value| |Value at index of setpoint table|
|1347|0 to 31|MPRO_ECAM_SP_Index| |ECAM: Setpoint segments start index|
|1348|0 to 31|MPRO_ECAM_SP_Length| |ECAM: Setpoint segments length|
|1349|0 to 31|Length| | |
|1350|0|MPRO_ECAM_SP_MaDist| |ECAM: Setpoint segments master distance|
|1351|0|MPRO_ECAM_SP_IpoType| |ECAM: Setpoint segments interpolation type|
|1352|0 to 31|Checksum| |ECAM: Setpoint table checksum|
|1353|0 to 31|GainNum| |ECAM: Setpoint segments gain numerator|
| | |GainDen| |ECAM: Setpoint segments gain denominator|

# Table 8.33: “Electronic camming - Table segments” parameters

|ID|Index|Name|Unit|Description|
|---|---|---|---|---|
|1329|0 to 63|MPRO_ECAM_SegData_IndexNext| |ECAM: Index of the following segment|
|1330|0 to 63|MPRO_ECAM_SegData_IndexPrev| |ECAM: Index of the previous segment|
|1331|0 to 63|MPRO_ECAM_SegData_ProfileMode| |ECAM: Profile mode of the current segment|
|1332|0 to 63|MPRO_ECAM_SegData_DistMaster| |ECAM: Length of the master section of the current segment|
|1333|0 to 63|MPRO_ECAM_SegData_DistSlave| |ECAM: Length of the slave section of the current segment|
|1334|0 to 63|MPRO_ECAM_SegData_Lambda| |ECAM: Lambda value of the current segment|
|1335|0 to 63|MPRO_ECAM_SegData_StatusWord| |ECAM: Status word of the current segment|
|1336|0 to 63|MPRO_ECAM_SegData_ControlWord| |ECAM: Control word of the current segment|

# 8.11.2 Control word for synchronized motion

|Bit|Function|PLC function|Bit number|Description|
|---|---|---|---|---|
|0-7|Start segment (8-bit value)|-|0-7|Actual segment (8-bit value)|
|8-15|Reserved|-| |Actual ECAM / EGEAR state machine state (4 Bit value)|
|16|Absolute (true) / relative (false) master relationship|-| |- 0: ECAM / EGEAR asynchronous
- 1: ECAM / EGEAR synchronous
|
|17|Absolute (true) / relative (false) master (CAM) relationship at cam in|-| |- 2: ECAM / EGEAR synchronizing
- 3: ECAM / EGEAR desynchronizing
|
|18|Absolute (true) / relative (false) slave (CAM) relationship at cam in|-| |- 4: ECAM / EGEAR active and waiting for going asynchronous
|
|19-23|Reserved|-| |- 5: ECAM / EGEAR inactive and waiting for going synchronous
|
|24|Change gear ratio of the electronic gear online|MCB_GearRatioChange| | |
|25|Disable master calculation|MCB_Cam_MasterEnable| | |
|26|Enable master calculation|MCB_Cam_MasterEnable| | |
|27|Select CAM table|MCB_CamTableSelect| | |
|28|Start Ecam|MCB_CamIn| | |
|29|Stop Ecam|MCB_CamOut| | |
|30|Start Egear|MCB_GearIn| | |
|31|Stop Egear|MCB_GearOut| | |

# 8.11.3 Status word for synchronized motion

|Bit|Function|PLC function|Bit number|Description|
|---|---|---|---|---|
|12-26|Reserved|-| | |
|27|ECAM / EGEAR is active|-| | |
|28|Valid segments chosen|-| | |
|29|Master data are valid|-| | |
|30|Master is initialized|-| | |
|31|Master calculation is active|-| | |

Table 8.35: Control word ECAM (P 1318[0] - MPRO_ECAM_ControlWord)

Table 8.36: ECAM status word (P 1326[0] - MPRO_ECAM_StatusWord)

MOOG ID No.:CB40859-001 Date:11/2020 MSD ServoDrive - DeviceHelp 279

# 8 Motion profile

# 8 Motion profile

MOOG ID No.:CB40859-001 Date:11/2020

MSD ServoDrive - DeviceHelp 280

# 8.11.4 Master configuration

the master encoder, you will need to set the resolution relative to a single motor revolution in P 250 - MPRO_ECAM_PARAMaster_Amplitude (see below).

- ENC CH1 (3) = Encoder channel 1 X7 (Sin/Cos)
- ENC CH2 (4) = Encoder channel 2 X6 (Resolver)
- ENC CH3 (5) = Encoder channel 3 X8 (optional)

This function is only available if an external interface X8 (option module) is present.

- TP0 (6) = Pulse counter on probe channel 0 (TP0)
- TP1 (7) = Pulse counter on probe channel 1 (TP1)
- ENC_CH4 (8) = Encoder channel 4 (p. e. fieldbus)
- TWIN_POS (9) = TWIN remote reference position (P-2607)

Image 8.72: “Master configuration” screen

# Channel selection (master encoder)

P 1319[0] - MPRO_ECAM_CamMaster_AxisType is used to define the master encoder.

- NO AXIS (0) = No axis
- VIRTUAL MASTER (1) = Virtual master

If you select this function, you will be able to configure additional settings by clicking on the enabled “Options...” button (see Section ""Virtual Master"" on page 286).

- PARA (2) = Master parameter interface

If you select this function because a higher-level controller is being used as

# Anti-reverse mode

Slave only starts moving along with it again as soon as the master reaches the zero position.

P 1320[0] - MPRO_ECAM_CamMaster_RevLockMode is used to define the reverse lock mode, which can be used either with or without path compensation. The dashed lines in the following diagrams indicate what the engagement distance is:

# Example:

If the master, which has moved two motor revolutions in the direction blocked for the slave, then moves in the unblocked direction again, the slave only moves off when the master has traversed the zero point.

- INACTIVE (0) = Reverse lock inactive
- ACTIVE (2) = Reverse lock enabled - without path optimization
- ACTIVE WAY COMP (1) = Reverse lock active - with way compensation

While the slave accelerates to the speed of the master during engagement, the master and slave do not move synchronously. This function needs to be selected in order to quickly catch up to the master that is running ahead.

# Example:

- Master (black line) rotates in the blocked direction
- The slave (blue line) remains stopped
- Master rotates in the unblocked direction again
- The slave follows the master directly in the unblocked direction

Assume the master has moved two motor revolutions in the direction for which the slave lock is enabled. If the master now moves in the direction for which there is no lock, the slave will immediately start running in that direction.

MOOG ID No.:CB40859-001 Date:11/2020

MSD ServoDrive - DeviceHelp 281

# 8 Motion profile

MOOG ID No.:CB40859-001 Date:11/2020 MSD ServoDrive - DeviceHelp 282

|Filter type|ID|Index Name|Unit|Description|
|---|---|---|---|---|
|When using a real master encoder, encoder signals may be subject to noise.|P 1340|1319|0|MPRO_ECAM_CamMaster_AxisType|
| | |MPRO_ECAM_CamMaster_SpeedFilTyp| |ECAM / EGEAR: Channel selection of internal master input|
| | |1320|0|MPRO_ECAM_CamMaster_RevLockMode|
| | |1321|0|MPRO_ECAM_CamMaster_Amplitude|
| | |1322|0|MPRO_ECAM_CamMaster_GearNum|
| | |1323|0|MPRO_ECAM_CamMaster_GearDen|
|Filter time|1327|0|ms|ECAM / EGEAR: Filter time constant of master|
|If P 1340[0] is used to enable a filter, P 1327[0] - MPRO_ECAM_CamMaster_SpeedTFil can be used to define the corresponding filter time.|1328|0|speed|ECAM / EGEAR: Speed factor of the internal master|
|Speed factor|1340|0| |MPRO_ECAM_CamMaster_SpeedFilTyp|
|The master encoder can be assigned an additional speed factor P 1328[0] - MPRO_ECAM_CamMaster_SpeedFactor.|1341|0|incr|ECAM / EGEAR: Master drive offset|

Table 8.37: “Synchronized motion - Master configuration” parameters (continue)

| | | |ID|Index Name|Unit|Description|
|---|---|---|---|---|---|---|
|247|0|MPRO_ECAM_ParaMaster_ActPos|incr|ECAM / EGEAR: Parameter interface master position| | |
|248|0|MPRO_ECAM_ParaMaster_ActSpeed|rpm|ECAM / EGEAR: Parameter interface master speed| | |
|249|0|MPRO_ECAM_ParaMaster_ActAcc|rpm|ECAM / EGEAR: Parameter interface master acceleration| | |
| |250|0|MPRO_ECAM_ParaMaster_Amplitude| |ECAM / EGEAR: Parameter interface master amplitude| |

Table 8.37: “Synchronized motion - Master configuration” parameters

# 8.11.5 Electronic gearing

# Gear ratio

The gear ratio is specified as a fraction. This ensures that the position references can be translated to the motor shaft with no rounding error.

- ""Slave"" (P 252[0] - MPRO_ECAM_Egear_GearNum) is the numerator
- ""Master"" (P 251[0] - MPRO_ECAM_Egear_GearDen) is the denominator

# Scaling of speed pre-control

Defined with P 265[0] - MPRO_ECAM_CamSlave_SpeedFactor definiert.

# Scaling of torque pre-control

Defined with P 266[0] - MPRO_ECAM_CamSlave_TorqueFactor.

# Engagement

See Section ""Engagement"" on page 284.

# Disengagement

See Section ""Disengagement"" on page 285.

|ID|Index Name|Unit|Description|
|---|---|---|---|
|251|0 MPRO_ECAM_Egear_GearDen| |EGEAR: Gear denominator|
|252|0 MPRO_ECAM_Egear_GearNum| |EGEAR: Numerator of gear ratio|
|1344|0 MPRO_ECAM_Egear_LimRefAcc|rpm/s|EGEAR: Acceleration limit for reference|
|1345|0 MPRO_ECAM_Egear_LimRefJerk|rpm/s²|EGEAR: Jerk limit for reference|

Table 8.38: “Synchronized motion - Electronic gearing” parameters

Image 8.73: ""Electronic gearing"" screen

MOOG ID No.:CB40859-001 Date:11/2020 MSD ServoDrive - DeviceHelp 283

# 8 Motion profile

# 8 Motion profile

MOOG ID No.:CB40859-001 Date:11/2020

MSD ServoDrive - DeviceHelp 284

# 8.11.6 Engagement

used to define the engagement distance (between the dashed lines).

P 253[0] - MPRO_ECAM_Egear_GearInMode is used to define the mode for engagement.

- DIRECT (0) = Direct
- Direct engagement: Angular synchronous; with jerking (no ramps).
- CROSSFADE (3) = Crossfading
- Engagement with crossfading function (5th degree polynomial): Angular synchronous; jerk-limited; speed will overshoot during engagement.
- RAMP (1) = Linear speed ramp
- Engagement with linear acceleration: Not angular synchronous; with jerking.
- FADE (2) = Engagement fade-out
- Engagement with fade-in function (5th degree polynomial): Not angular synchronous; jerk-limited. The position is ignored. ",What is the function of the deceleration ramp parameter in the analog channels ISA00 and ISA01 in the 'MSD ServoDrive - DeviceHelp' document?,A2,The deceleration ramp parameter adjusts the slowdown rate in torque or speed control.,1.7890625,1.6875,3.46875,1.3828125,0.318359375
32,msd_servo_drive.txt,76,b87ca5e232c2bdbb6fa16a8a401c6b5d285dc0183e73cc9d134de13dd2fc71d2,"MOOG ID No.:CB40859-001 Date:11/2020

MSD ServoDrive - DeviceHelp 267

# 8 Motion profile

MOOG ID No.:CB40859-001 Date:11/2020 MSD ServoDrive - DeviceHelp 268

# Deceleration

With ...

- P 194 - MPRO_TAB_TDec (for torque control) or
- P 197 - MPRO_TAB_SDec (for speed control) or
- P 200 - MPRO_TAB_PDec (for position control)

and indexes 0–15, the deceleration for each individual motion task can be defined. The input must not be zero.

# Wait time in Auto mode

P 204 - MPRO_TAB_WaitTime is used to define the wait time before the next motion task is carried out.

# Maximum table index in Auto mode

P 206[0] - MPRO_Tab_MaxIdx is used to define the table index up to which driving jobs will be carried out in one of the auto modes.

# Current table index

P 207[0] - MPRO_Tab_ActIdx will show the index for the motion task that is currently active. If parameter P 205 MPRO_TAB_Mode is set to “Para(0)”, a driving set can be entered and approached directly.

# Activation of reference table

The following procedures can be used in order to activate the setpoint table for operation.

|ID|Index Name|Unit|Description|
|---|---|---|---|
|193|MPRO_TAB_TAcc|TAB: Torque mode acceleration|Nm/ms|
|193|0|MPRO_TAB_TAcc|Nm/ms|
|193|1 - 15|MPRO_TAB_TAcc|Nm/ms|
|194|MPRO_TAB_TDec|TAB: Torque mode deceleration| |
|194|0|MPRO_TAB_TDec|Nm/ms|
|194|1 - 15|MPRO_TAB_TDec|Nm/ms|

# Table 8.23: Activation of table references

# Table 8.24: “Setpoint table settings” parameters

# Table 8.24: “Setpoint table settings” parameters (continue)

|ID|Index Name|Unit|Description|ID|Index Name|Unit|Description|
|---|---|---|---|---|---|---|---|
|195|MPRO_TAB_TRef|Nm|TAB: Torque mode reference value|208|MPRO_TAB_OutputNo| |OSD TAB: actual table index and target|
|195|MPRO_TAB_TRef|Nm| |208|MPRO_TAB_OutputNo| | |
|196|MPRO_TAB_SAcc|rev/min/s|TAB: Speed mode acceleration|269|MPRO_TAB_Ctrl| |TAB: control word|
|196|MPRO_TAB_SAcc|rev/min/s| | | | | |
|197|MPRO_TAB_SDec|rev/min/s|TAB: Speed mode deceleration| | | | |
|197|MPRO_TAB_SDec|rev/min/s| | | | | |
|198|MPRO_TAB_SRef|rev/min|TAB: Speed mode reference value| | | | |
|198|MPRO_TAB_SRef|rev/min| | | | | |
|199|MPRO_TAB_PAcc|rev/min/s|TAB: Position control mode acceleration| | | | |
|199|MPRO_TAB_PAcc|rev/min/s| | | | | |
|200|MPRO_TAB_PDec|rev/min/s|TAB: Position control mode Acceleration| | | | |
|200|MPRO_TAB_PDec|rev/min/s| | | | | |
|201|MPRO_TAB_PSpd|rev/min|TAB: Position control mode speed| | | | |
|201|MPRO_TAB_PSpd|rev/min| | | | | |
|202|MPRO_TAB_PPos|mDegree|TAB: Position control mode reference value| | | | |
|202|MPRO_TAB_PPos|mDegree| | | | | |
|203|MPRO_TAB_PMode| |Position control table:Mode| | | | |
|203|MPRO_TAB_PMode| | | | | | |
|204|MPRO_TAB_WaitTime|ms|TAB: Wait time| | | | |
|204|MPRO_TAB_WaitTime|ms| | | | | |
|205|MPRO_TAB_Mode| |TAB mode| | | | |
|206|MPRO_Tab_MaxIdx| |TAB: Max index in AUTO mode| | | | |
|207|MPRO_TAB_ActIdx| |TAB: Actual index| | | | |

MOOG ID No.:CB40859-001 Date:11/2020

MSD ServoDrive - DeviceHelp

# 8 Motion profile

MOOG ID No.:CB40859-001 Date:11/2020

MSD ServoDrive - DeviceHelp 270

# 8.8 Analog channel (ISA00 und ISA01)

# Offset (O)

This parameter (P 174 - MPRO_ANA0_SOffset for ISA00, P 184 - MPRO_ANA1_SOffset for ISA01) compensates for component variations and is used for offset compensation purposes. Depending on the control mode being used (see Section ""Basic settings"" on page 110), the value will be stored in parameter index [0] (torque control), [1] (speed control) or [2] (position control).

# Backlash (B)

This parameter (P 175 - MPRO_ANA0_SThreshold for ISA00, P 185 - MPRO_ANA1_SThreshold for ISA01) can suppress axis motion close to the standstill (stop) position. Depending on the control mode being used (see Section ""Basic settings"" on page 110), the value will be stored in parameter index [0] (torque control), [1] (speed control) or [2] (position control).

Image 8.68: “Analog channel” screen

# Acceleration ramp

Two standard analog inputs (ISA00, ISA01) are available. These inputs can be configured...

- with negative values for analog setpoint settings
- with positive values for digital setpoint processing

(P 109[0] - MPRO_INPUT_FS_ISA00 and P 110[0] - MPRO_INPUT_FS_ISA01).

see also section ""Analog Inputs"" on page 303. By using the ""REV(-2) = Analog setpoint"" setting, an analog input voltage of ±10 V can be processed as a setpoint.

# Deceleration ramp

This parameter serves as a deceleration ramp for torque control (P 176[1] - MPRO_ANA0_TRamp for ISA00, P 186[1] - MPRO_ANA1_TRamp for ISA01) or speed control (P 177[1] - MPRO_ANA0_SRamp for ISA00, P 187[1] - MPRO_ANA1_SRamp for ISA01). Depending on the control mode being used (see Section ""Basic settings"" on page 110), the value will be stored in parameter index [0] (torque control), [1] (speed control) or [2] (position control).

This parameter (P 173 - MPRO_ANA0_Scale for ISA00, P 183 - MPRO_ANA1_Scale for ISA01) is used to define which speed / which torque / which position corresponds to the maximum analog value. Depending on the control mode being used (see Section ""Basic settings"" on page 110), the value will be stored in parameter index [0] (torque control), [1] (speed control) or [2] (position control).

# 8.8.1 Special characteristics of position control mode

A threshold value can also be specified which generates a run-on range around the last reference value. A ramp function calculates a motion profile for the position reference from pre-defined acceleration and speed limits.

The position references on the analog channel are not applied immediately, but dependent on a digital input. Accordingly, one of the ISD00 to ISD06 digital inputs must be set to a value of ""REFANAEN(28) = Enable analog reference value"" (see Section ""Digital inputs"" on page 290). The position setpoint being received will only be applied if the corresponding digital input is active. The acceleration is entered using P 173[0] - MPRO_ANA0_TScale or P 183[0] - MPRO_ANA1_TScale.

# 8.8.2 Wire Break Monitoring

P 399 - CON_ANAWireBrk_Th can be used to configure wire break monitoring for the analog inputs. For details see Section ""Wire Break Monitoring"" on page 306.

|Function|TLIM (-4)|OVR (-3)|REFV (-2)|leer (-1)|OFF (0)|
|---|---|---|---|---|---|
|Digital|(1)-(28)|(1)-(28)|(1)-(28)|(1)-(28)|(1)-(28)|
|Analog channel|Filter|Scale|Offset|Profile|generator|

Control

Image 8.69: Reference processing structure

MOOG ID No.:CB40859-001 Date:11/2020

MSD ServoDrive - DeviceHelp 271

# 8 Motion profile

# 8 Motion profile

MOOG ID No.:CB40859-001 Date:11/2020

|ID|Index Name|Unit|Description|ID|
|---|---|---|---|---|
|395|CON_ANA_Isaf_Scaled| |Analog inputs: Values (filt, norm, comp, scaled)|174|
|395|0 ISA00| |Scaled, compensated, filtered, normalized value|175|
|395|1 ISA01| |Scaled, compensated, filtered, normalized value| |
|396|CON_ANA_Scale_ThUpper| |Analog inputs: Upper scaling limits|175|
|396|0 ISA00|%|Upper scaling (@ 10 V) threshold|175|
|396|1 ISA01|%|Upper scaling (@ 10 V) threshold| |
|397|CON_ANA_Scale_ThZero| |Analog inputs: Zero scaling thresholds|176|
|397|0 ISA00|V|Zero scaling threshold (+/-)|176|
|397|1 ISA01|V|Zero scaling threshold (+/-)| |
|398|CON_ANA_Scale_ThLower| |Analog inputs: Lower scaling limits|177|
|398|0 ISA00|%|Lower scaling (@ zero threshold) threshold|177|
|398|1 ISA01|%|Lower scaling (@ zero threshold) threshold| |
|399|CON_ANA_WireBrk_Th| |Analog inputs: Wire break thresholds|Table 8.26:|
|399|0 ISA00|V|Wire break detection threshold| |
|399|1 ISA01|V|Wire break detection threshold| |
|405|0 CON_ANA_Filt0|ms|Analog input ISA00: Filter time constant (PT 1)|ID|
|408|CON_ANA_Isaf_Norm| |Analog inputs: Values (filt, norm)|183|
|408|0 ISA00| |Filtered, normalized value|183|
|408|1 ISA01| |Filtered, normalized value|183|

Table 8.25: “Analog channel” parameters

|ID|Index Name|Unit|Description|ID|
|---|---|---|---|---|
|173|MPRO_ANA0_Scale| |ANA0: scale factors|184|
|173|0 MPRO_ANA0_TScale|Nm|ANA0: scale factor torque reference|185|
|173|1 MPRO_ANA0_SScale|rev/min|ANA0: scale factor speed reference|185|
|173|2 MPRO_ANA0_PScale|mDegree|ANA0: scale factor position reference| |
|174|MPRO_ANA0_Offset| |ANA0: offsets|185|
|174|0 MPRO_ANA0_TOffset|Nm|ANA0: offsets for torque reference|185|

Table 8.26: “Analog channel ISA00” parameters

|Index Name|Unit|Description|
|---|---|---|
|1 MPRO_ANA0_SOffset|rev/min|ANA0: offsets for speed reference|
|2 MPRO_ANA0_POffset|mDegree|ANA0: offsets for position reference|
|MPRO_ANA0_Threshold| |ANA0: thresholds|
|0 MPRO_ANA0_TThreshold|Nm|ANA0: threshold for torque reference|
|1 MPRO_ANA0_SThreshold|rev/min|ANA0: threshold for speed reference|
|2 MPRO_ANA0_PThreshold|mDegree|ANA0: threshold for position reference|
|MPRO_ANA0_TRamp| |ANA0: Torque mode acceleration [0] and deceleration [1]|
|0 MPRO_ANA0_TRamp|Nm/s| |
|1 MPRO_ANA0_TRamp|Nm/s| |
|MPRO_ANA0_SRamp| |ANA0: Speed mode acceleration [0] and deceleration [1]|
|0 MPRO_ANA0_SRamp|SPEED/s| |
|1 MPRO_ANA0_SRamp|SPEED/s| |

“Analog channel ISA00” parameters (continue)

|Index Name|Unit|Description|
|---|---|---|
|MPRO_ANA1_Scale| |ANA1: scale factors|
|0 MPRO_ANA1_TScale|Nm|ANA0: scale factor torque reference|
|1 MPRO_ANA1_SScale|rev/min|ANA0: scale factor speed reference|
|2 MPRO_ANA1_PScale|mDegree|ANA0: scale factor position reference|
|MPRO_ANA1_Offset| |ANA1: offsets|
|0 MPRO_ANA1_TOffset|Nm|ANA1: offsets for torque reference|
|1 MPRO_ANA1_SOffset|rev/min|ANA1: offsets for speed reference|
|2 MPRO_ANA1_POffset|mDegree|ANA1: offsets for position reference|
|MPRO_ANA1_Threshold| |ANA1: thresholds|
|0 MPRO_ANA1_TThreshold|Nm|ANA1: threshold for torque reference|
|1 MPRO_ANA1_SThreshold|rev/min|ANA1: threshold for speed reference|
|2 MPRO_ANA1_PThreshold|mDegree|ANA1: threshold for position reference|

“Analog channel ISA01” parameters

# 8 Motion profile

|ID|Index Name|Unit|Description|
|---|---|---|---|
|186|MPRO_ANA1_TRamp|Nm/s|ANA1: Torque mode acceleration [0] and deceleration[1]|
|186|MPRO_ANA1_TRamp|Nm/s| |
|187|MPRO_ANA1_SRamp|SPEED/s|ANA1: Speed mode acceleration [0] and deceleration [1]|
|187|MPRO_ANA1_SRamp|SPEED/s| |

# Table 8.27: “Analog channel ISA01” parameters (continue)

Display

- System state
- Initialization on device startup
- Not ready (DC link voltage possibly too low)
- Start inhibit (DC link voltage present, power stage off)
- Starting lockout
- Ready for start
- Control initialization: Auto commutation, flux build-up etc.

# Table 8.28: Central state machine according to CiA 402 device display

MOOG ID No.:CB40859-001 Date:11/2020

MSD ServoDrive - DeviceHelp 273

# 8 Motion profile

MOOG ID No.:CB40859-001 Date:11/2020

MSD ServoDrive - DeviceHelp 274

|Display|System state|power disabled|fault|
|---|---|---|---|
|Control enabled|0|Start|7|
| |fault reaction active|0|14|
|Quick stop active|1|not ready|8|
| |to switch on|1|17|
|Error reaction active|2|switch on|disabled|
| |2|7| |
|Error state (in this state the error is indicated directly on the display.)|3|ready to|switch on|
|Device is reset (display flashes)|power enabled|3|6|
| |10|12| |
|• Number [5.] flashes when “STO” (Safe Torque Off) input is active. Display goes out when STO inactive.| | | |
|• The dot on the display flashes when the power stage is active.| | | |

Table 8.28: Central state machine according to CiA 402 device display (continue)

NOTE

l The system states indicated on the display may differ from the states in the table depending on the drive profile setting.

Image 8.70: State machine diagram based on CANopen communications

⓪ to ① State number

1 to 17 State transition (No. 17: DC link voltage cut off)

Legend for “State machine diagram based on CANopen communications” figure

# 8.10 Touch probe

|ID|Index Name / Setting|
|---|---|
|241|0 MPRO_TP_Position|
|241|1 MPRO_TP_Position|
|241|2 MPRO_TP_Position|
|241|3 MPRO_TP_Position|
|241|4 MPRO_TP_Position|
|1400|0 MPRO_TP_Config|
| |TP_TP (0)|
| |AB (1)|
| |PD_UP (2)|
| |PD_DOWN (3)|
| |PC_PC (4)|
| |PC_TP (5)|
| |TP_PC (6)|
| |ENC_ENC (7)|
| |ENC_TP (8)|
| |TP_ENC (9)|

Using the touch probe inputs, touch probe functions can be performed. In order to be able to do this, P 106[0] - MPRO_INPUT_FS_ISD05 and P 107[0] - MPRO_INPUT_FS_ISD06 must be used to set digital inputs ISD05 and ISD06 to ""PROBE(15) = Touch probe (only ISD05/06)"" (see Section ""Digital inputs"" on page 290). HTL encoders can be evaluated or pulse counters implemented using the MSD PLC.

The touch probe can be triggered with P 240 - MPRO_TP_Ctrl. This enables triggering on a positive or negative edge, or on both edges, of the signal detected on the touch probe inputs. After the measurement, the parameter jumps back to the value ""NONE (0)"" and the latch position is mapped in the corresponding subindex of parameter P 241 - MPRO_TP_Position. A continuous touch probe mode is not possible at present, so the touch probe has to be reactivated after the measurement.

P 1402 - MPRO_TP_Channel can be used to select various positions as actual value sources of the latch position for the touch probe functionality. The following table provides an overview of the available settings. The counters are accessed via the MSD PLC or a bus system.

|ID|Index Name / Setting|Unit|Description|
|---|---|---|---|
|240|MPRO_TP_Ctrl|Touch probe: Control| |
| |0| |NONE (0) = No function|
| |1| |POS (1) = Positive edge|
| |2| |NEG (2) = Negative edge|
| |3| |BOTH (3) = Both edges|
|240|0 MPRO_TP_Ctrl| | |
|240|1 MPRO_TP_Ctrl| | |
|240|2 MPRO_TP_Ctrl| | |
|241|MPRO_TP_Position|Probe: Pos. high/low edge of TP0/1, encoder zero pulse| |

Table 8.29: “Touch probe” parameters

MOOG ID No.:CB40859-001 Date:11/2020

# 8 Motion profile

|Unit|Description|
|---|---|
|mDegree|Touch probe: Configuration|
|mDegree|TP0, TP1 touch probe|
|mDegree|TP0, TP1 as encoder, A/B as quadrature counting|
|mDegree|TP0, TP1 as encoder, pulse (TP0) / direction (TP1), count up on direction high|
|mDegree|TP0, TP1 as encoder, pulse (TP0) / direction (TP1), count down on direction high|
|mDegree|TP0 pulse counter, TP1 pulse counter|
|mDegree|TP0 pulse counter, TP1 touch probe|
|mDegree|TP1 touch probe, TP0 pulse counter|
|mDegree|TP0 encoder counter, TP1 encoder counter|
|mDegree|TP0 encoder counter, TP1 touch probe|
|mDegree|TP0 touch probe, TP1 encoder counter|

Touch probe: Channel

|Unit|Description|
|---|---|
|ACTPOS (0)|Actual position in user units|
|ACTPOSINC (1)|Actual position in increments|
|MASTERPOS (2)|Master position in increments|
|ENCPOS_CH1 (3)|Encoder position Channel 1|
|ENCPOS_CH1_INC (4)|Encoder position Channel 1 in increments|
|ENCPOS_CH2 (5)|Encoder position Channel 2|
|ENCPOS_CH2_INC (6)|Encoder position Channel 2 in increments|

# 8 Motion profile

MOOG ID No.:CB40859-001 Date:11/2020 MSD ServoDrive - DeviceHelp 276

|ID|Index Name / Setting|Unit|Description|
|---|---|---|---|
|7|ENCPOS_CH3 (7)| |Encoder position Channel 3|
|8|ENCPOS_CH3_INC (8)| |Encoder position Channel 3 in increments|
|9|ENCPOS_CH4 (9)| |Encoder position Channel 4|
|10|ENCPOS_CH4_INC (10)| |Encoder position Channel 4 in increments|
|11|ACTPOS2 (11)| |Actual position of redundant encoder in user units|
|12|Sercos (12)| |Referred to Sercos profile parameters S-x-0426, S-x-0427|
|13|UserRefPos(13)| |Reference position in user units|
|14|MasterPosST(14)| |Master position (ECAM, EGEAR) singleturn, always steps|
|15|CommonMasterPos(15)| |Master position (ECAM, EGEAR) singleturn, always steps|
|16|CommonMasterPosST(15)| |Master position (ECAM, EGEAR) singleturn, always steps|
|1402|MPRO_TP_Channel| | |
|1402|MPRO_TP_Channel| | |
|1402|MPRO_TP_Channel| | |
|1404|MPRO_TP_Lines| |Touch probe: Lines @ pulse counter on channel x|
|1404|MPRO_TP_Lines| | |
|1404|MPRO_TP_Lines| | |

Image 8.71: “Synchronized motion” screen

There are various modes available in the “synchronization mode” drop-down menu (P 242[0] - MPRO_ECAM_SyncModMode):

- Off(0) = Synchronized motion off
- ECAM_iPlc(1) = Electronic cam plate via MSD PLC
- EGEAR_iPlc(2) = Electr. gear unit via MSD PLC
- ECAM_PARA(3) = Electronic camming via parameters
- EGEAR_PARA(4) = Electronic gearing via parameters

NOTE: For more information refer to the bus system User Manuals or the description of the MSD PLC.

# 8.11.1 Electronic cam plate

The other parameters are configured in separate screens that can be accessed with the corresponding buttons.

- Master configuration (see Section ""Master configuration"" on page 280)
- Electronic gearing (see Section ""Electronic gearing"" on page 283)
- Electronic camming (see Section ""Electronic cam plate"" on page 277)

P 1318[0] - MPRO_ECAM_ControlWord is the control word for “synchronized motion” (see Section ""Control word for synchronized motion"" on page 279).

P 1326[0] - MPRO_ECAM_StatusWord is the status word for “synchronized motion” (see Section ""Status word for synchronized motion"" on page 279).

# 8.11.1.1 Table selection

|ID|Index Name|Unit|Description|
|---|---|---|---|
|1300|MPRO_ECAM_CTS_| |ECAM: CamTableSelect - Master reference|
|1301|MasterRef| | |
|1305|MPRO_ECAM_CTS_| |ECAM: CamTableSelect - Method for changing the camtable|
|1306|MPRO_ECAM_CTS_| |ECAM: CamTableSelect - Mode for changing the camtable|
|1307|MPRO_ECAM_CTS_|incr|ECAM: CamTableSelect - Distance for changing the camtable|
|242|MPRO_ECAM_| |ECAM / EGEAR: Mode of synchronized motion SyncModMode|
|265|MPRO_ECAM_| |ECAM / EGEAR: Slave speed factor (1 = 100%).|
|266|CamSlave_SpeedFactor| | |
|268|MPRO_ECAM_| |ECAM / EGEAR: Mode of switching off sync. motion|

# 8.11.1.2 Synchronization

|ID|Index Name|Unit|Description|
|---|---|---|---|
|1342|MPRO_ECAM_CI_|incr|ECAM: CamIn - Synchronization position (multiturn part)|
|1343|MPRO_ECAM_CO_|incr|ECAM: CamOut - Decoupling pos. (multiturn part)|
|1303|MPRO_ECAM_CI_|incr|ECAM: CamIn - Master offset|
|1308|MPRO_ECAM_CI_| |ECAM: CamIn - Master reference|
|1309|MPRO_ECAM_CI_| |ECAM: CamIn - Slave reference|
|1310|MPRO_ECAM_CI_| |ECAM: CamIn - Coupling mode|
|1311|MPRO_ECAM_CI_|incr|ECAM: CamIn - Coupling distance|
|1312|MPRO_ECAM_CI_|incr|ECAM: CamIn - Synchronization position|

Table 8.31: “Electronic camming - Table selection” parameters

Table 8.30: “Synchronized motion” parameters

Table 8.32: “Electronic camming - Synchronization” parameters

MOOG ID No.:CB40859-001 Date:11/2020

MSD ServoDrive - DeviceHelp 277

# 8 Motion profile

MOOG ID No.:CB40859-001 Date:11/2020 MSD ServoDrive - DeviceHelp 278

|ID|Index|Name|Unit|Description|
|---|---|---|---|---|
|1313|0|MPRO_ECAM_CO_SyncPosST|(singleturn part)|ECAM: CamOut - Slave reference|
|1314|0|MPRO_ECAM_CO_DecouplingMode|63|ECAM: CamOut - Decoupling mode|
|1315|0|MPRO_ECAM_CO_BreakingPosST|incr|ECAM: CamOut - Decoupling position|
|1316|0|MPRO_ECAM_CO_DecouplingDist|incr|ECAM: CamOut - Decoupling distance|
|1317|0|MPRO_ECAM_CO_StandstillPos|mDegree|ECAM: CamOut - Slave standstill position|

# Table 8.32: “Electronic camming - Synchronization” parameters (continue)

|ID|Index|Name|Unit|Description|
|---|---|---|---|---|
|1346| |MPRO_ECAM_SP_Table| |ECAM: Setpoint table interface|
|1346|0|Index| |Index of setpoint table|
|1346|1|Value| |Value at index of setpoint table|
|1347|0 to 31|MPRO_ECAM_SP_Index| |ECAM: Setpoint segments start index|
|1348|0 to 31|MPRO_ECAM_SP_Length| |ECAM: Setpoint segments length|
|1349|0 to 31|Length| | |
|1350|0|MPRO_ECAM_SP_MaDist| |ECAM: Setpoint segments master distance|
|1351|0|MPRO_ECAM_SP_IpoType| |ECAM: Setpoint segments interpolation type|
|1352|0 to 31|Checksum| |ECAM: Setpoint table checksum|
|1353|0 to 31|GainNum| |ECAM: Setpoint segments gain numerator|
| | |GainDen| |ECAM: Setpoint segments gain denominator|

# Table 8.33: “Electronic camming - Table segments” parameters

|ID|Index|Name|Unit|Description|
|---|---|---|---|---|
|1329|0 to 63|MPRO_ECAM_SegData_IndexNext| |ECAM: Index of the following segment|
|1330|0 to 63|MPRO_ECAM_SegData_IndexPrev| |ECAM: Index of the previous segment|
|1331|0 to 63|MPRO_ECAM_SegData_ProfileMode| |ECAM: Profile mode of the current segment|
|1332|0 to 63|MPRO_ECAM_SegData_DistMaster| |ECAM: Length of the master section of the current segment|
|1333|0 to 63|MPRO_ECAM_SegData_DistSlave| |ECAM: Length of the slave section of the current segment|
|1334|0 to 63|MPRO_ECAM_SegData_Lambda| |ECAM: Lambda value of the current segment|
|1335|0 to 63|MPRO_ECAM_SegData_StatusWord| |ECAM: Status word of the current segment|
|1336|0 to 63|MPRO_ECAM_SegData_ControlWord| |ECAM: Control word of the current segment|

# 8.11.2 Control word for synchronized motion

|Bit|Function|PLC function|Bit number|Description|
|---|---|---|---|---|
|0-7|Start segment (8-bit value)|-|0-7|Actual segment (8-bit value)|
|8-15|Reserved|-| |Actual ECAM / EGEAR state machine state (4 Bit value)|
|16|Absolute (true) / relative (false) master relationship|-| |- 0: ECAM / EGEAR asynchronous
- 1: ECAM / EGEAR synchronous
|
|17|Absolute (true) / relative (false) master (CAM) relationship at cam in|-| |- 2: ECAM / EGEAR synchronizing
- 3: ECAM / EGEAR desynchronizing
|
|18|Absolute (true) / relative (false) slave (CAM) relationship at cam in|-| |- 4: ECAM / EGEAR active and waiting for going asynchronous
|
|19-23|Reserved|-| |- 5: ECAM / EGEAR inactive and waiting for going synchronous
|
|24|Change gear ratio of the electronic gear online|MCB_GearRatioChange| | |
|25|Disable master calculation|MCB_Cam_MasterEnable| | |
|26|Enable master calculation|MCB_Cam_MasterEnable| | |
|27|Select CAM table|MCB_CamTableSelect| | |
|28|Start Ecam|MCB_CamIn| | |
|29|Stop Ecam|MCB_CamOut| | |
|30|Start Egear|MCB_GearIn| | |
|31|Stop Egear|MCB_GearOut| | |

# 8.11.3 Status word for synchronized motion

|Bit|Function|PLC function|Bit number|Description|
|---|---|---|---|---|
|12-26|Reserved|-| | |
|27|ECAM / EGEAR is active|-| | |
|28|Valid segments chosen|-| | |
|29|Master data are valid|-| | |
|30|Master is initialized|-| | |
|31|Master calculation is active|-| | |

Table 8.35: Control word ECAM (P 1318[0] - MPRO_ECAM_ControlWord)

Table 8.36: ECAM status word (P 1326[0] - MPRO_ECAM_StatusWord)

MOOG ID No.:CB40859-001 Date:11/2020 MSD ServoDrive - DeviceHelp 279

# 8 Motion profile

# 8 Motion profile

MOOG ID No.:CB40859-001 Date:11/2020

MSD ServoDrive - DeviceHelp 280

# 8.11.4 Master configuration

the master encoder, you will need to set the resolution relative to a single motor revolution in P 250 - MPRO_ECAM_PARAMaster_Amplitude (see below).

- ENC CH1 (3) = Encoder channel 1 X7 (Sin/Cos)
- ENC CH2 (4) = Encoder channel 2 X6 (Resolver)
- ENC CH3 (5) = Encoder channel 3 X8 (optional)

This function is only available if an external interface X8 (option module) is present.

- TP0 (6) = Pulse counter on probe channel 0 (TP0)
- TP1 (7) = Pulse counter on probe channel 1 (TP1)
- ENC_CH4 (8) = Encoder channel 4 (p. e. fieldbus)
- TWIN_POS (9) = TWIN remote reference position (P-2607)

Image 8.72: “Master configuration” screen

# Channel selection (master encoder)

P 1319[0] - MPRO_ECAM_CamMaster_AxisType is used to define the master encoder.

- NO AXIS (0) = No axis
- VIRTUAL MASTER (1) = Virtual master

If you select this function, you will be able to configure additional settings by clicking on the enabled “Options...” button (see Section ""Virtual Master"" on page 286).

- PARA (2) = Master parameter interface

If you select this function because a higher-level controller is being used as

# Anti-reverse mode

Slave only starts moving along with it again as soon as the master reaches the zero position.

P 1320[0] - MPRO_ECAM_CamMaster_RevLockMode is used to define the reverse lock mode, which can be used either with or without path compensation. The dashed lines in the following diagrams indicate what the engagement distance is:

# Example:

If the master, which has moved two motor revolutions in the direction blocked for the slave, then moves in the unblocked direction again, the slave only moves off when the master has traversed the zero point.

- INACTIVE (0) = Reverse lock inactive
- ACTIVE (2) = Reverse lock enabled - without path optimization
- ACTIVE WAY COMP (1) = Reverse lock active - with way compensation

While the slave accelerates to the speed of the master during engagement, the master and slave do not move synchronously. This function needs to be selected in order to quickly catch up to the master that is running ahead.

# Example:

- Master (black line) rotates in the blocked direction
- The slave (blue line) remains stopped
- Master rotates in the unblocked direction again
- The slave follows the master directly in the unblocked direction

Assume the master has moved two motor revolutions in the direction for which the slave lock is enabled. If the master now moves in the direction for which there is no lock, the slave will immediately start running in that direction.

MOOG ID No.:CB40859-001 Date:11/2020

MSD ServoDrive - DeviceHelp 281

# 8 Motion profile

MOOG ID No.:CB40859-001 Date:11/2020 MSD ServoDrive - DeviceHelp 282

|Filter type|ID|Index Name|Unit|Description|
|---|---|---|---|---|
|When using a real master encoder, encoder signals may be subject to noise.|P 1340|1319|0|MPRO_ECAM_CamMaster_AxisType|
| | |MPRO_ECAM_CamMaster_SpeedFilTyp| |ECAM / EGEAR: Channel selection of internal master input|
| | |1320|0|MPRO_ECAM_CamMaster_RevLockMode|
| | |1321|0|MPRO_ECAM_CamMaster_Amplitude|
| | |1322|0|MPRO_ECAM_CamMaster_GearNum|
| | |1323|0|MPRO_ECAM_CamMaster_GearDen|
|Filter time|1327|0|ms|ECAM / EGEAR: Filter time constant of master|
|If P 1340[0] is used to enable a filter, P 1327[0] - MPRO_ECAM_CamMaster_SpeedTFil can be used to define the corresponding filter time.|1328|0|speed|ECAM / EGEAR: Speed factor of the internal master|
|Speed factor|1340|0| |MPRO_ECAM_CamMaster_SpeedFilTyp|
|The master encoder can be assigned an additional speed factor P 1328[0] - MPRO_ECAM_CamMaster_SpeedFactor.|1341|0|incr|ECAM / EGEAR: Master drive offset|

Table 8.37: “Synchronized motion - Master configuration” parameters (continue)

| | | |ID|Index Name|Unit|Description|
|---|---|---|---|---|---|---|
|247|0|MPRO_ECAM_ParaMaster_ActPos|incr|ECAM / EGEAR: Parameter interface master position| | |
|248|0|MPRO_ECAM_ParaMaster_ActSpeed|rpm|ECAM / EGEAR: Parameter interface master speed| | |
|249|0|MPRO_ECAM_ParaMaster_ActAcc|rpm|ECAM / EGEAR: Parameter interface master acceleration| | |
| |250|0|MPRO_ECAM_ParaMaster_Amplitude| |ECAM / EGEAR: Parameter interface master amplitude| |

Table 8.37: “Synchronized motion - Master configuration” parameters

# 8.11.5 Electronic gearing

# Gear ratio

The gear ratio is specified as a fraction. This ensures that the position references can be translated to the motor shaft with no rounding error.

- ""Slave"" (P 252[0] - MPRO_ECAM_Egear_GearNum) is the numerator
- ""Master"" (P 251[0] - MPRO_ECAM_Egear_GearDen) is the denominator

# Scaling of speed pre-control

Defined with P 265[0] - MPRO_ECAM_CamSlave_SpeedFactor definiert.

# Scaling of torque pre-control

Defined with P 266[0] - MPRO_ECAM_CamSlave_TorqueFactor.

# Engagement

See Section ""Engagement"" on page 284.

# Disengagement

See Section ""Disengagement"" on page 285.

|ID|Index Name|Unit|Description|
|---|---|---|---|
|251|0 MPRO_ECAM_Egear_GearDen| |EGEAR: Gear denominator|
|252|0 MPRO_ECAM_Egear_GearNum| |EGEAR: Numerator of gear ratio|
|1344|0 MPRO_ECAM_Egear_LimRefAcc|rpm/s|EGEAR: Acceleration limit for reference|
|1345|0 MPRO_ECAM_Egear_LimRefJerk|rpm/s²|EGEAR: Jerk limit for reference|

Table 8.38: “Synchronized motion - Electronic gearing” parameters

Image 8.73: ""Electronic gearing"" screen

MOOG ID No.:CB40859-001 Date:11/2020 MSD ServoDrive - DeviceHelp 283

# 8 Motion profile

# 8 Motion profile

MOOG ID No.:CB40859-001 Date:11/2020

MSD ServoDrive - DeviceHelp 284

# 8.11.6 Engagement

used to define the engagement distance (between the dashed lines).

P 253[0] - MPRO_ECAM_Egear_GearInMode is used to define the mode for engagement.

- DIRECT (0) = Direct
- Direct engagement: Angular synchronous; with jerking (no ramps).
- CROSSFADE (3) = Crossfading
- Engagement with crossfading function (5th degree polynomial): Angular synchronous; jerk-limited; speed will overshoot during engagement.
- RAMP (1) = Linear speed ramp
- Engagement with linear acceleration: Not angular synchronous; with jerking.
- FADE (2) = Engagement fade-out
- Engagement with fade-in function (5th degree polynomial): Not angular synchronous; jerk-limited. The position is ignored. ",What is the function of the deceleration ramp parameter in the analog channels ISA00 and ISA01 in the 'MSD ServoDrive - DeviceHelp' document?,A3,Parameters like P 176[1] and P 186[1] define deceleration ramps for torque control.,1.3046875,1.390625,3.234375,1.484375,0.349609375
33,msd_servo_drive.txt,76,b87ca5e232c2bdbb6fa16a8a401c6b5d285dc0183e73cc9d134de13dd2fc71d2,"MOOG ID No.:CB40859-001 Date:11/2020

MSD ServoDrive - DeviceHelp 267

# 8 Motion profile

MOOG ID No.:CB40859-001 Date:11/2020 MSD ServoDrive - DeviceHelp 268

# Deceleration

With ...

- P 194 - MPRO_TAB_TDec (for torque control) or
- P 197 - MPRO_TAB_SDec (for speed control) or
- P 200 - MPRO_TAB_PDec (for position control)

and indexes 0–15, the deceleration for each individual motion task can be defined. The input must not be zero.

# Wait time in Auto mode

P 204 - MPRO_TAB_WaitTime is used to define the wait time before the next motion task is carried out.

# Maximum table index in Auto mode

P 206[0] - MPRO_Tab_MaxIdx is used to define the table index up to which driving jobs will be carried out in one of the auto modes.

# Current table index

P 207[0] - MPRO_Tab_ActIdx will show the index for the motion task that is currently active. If parameter P 205 MPRO_TAB_Mode is set to “Para(0)”, a driving set can be entered and approached directly.

# Activation of reference table

The following procedures can be used in order to activate the setpoint table for operation.

|ID|Index Name|Unit|Description|
|---|---|---|---|
|193|MPRO_TAB_TAcc|TAB: Torque mode acceleration|Nm/ms|
|193|0|MPRO_TAB_TAcc|Nm/ms|
|193|1 - 15|MPRO_TAB_TAcc|Nm/ms|
|194|MPRO_TAB_TDec|TAB: Torque mode deceleration| |
|194|0|MPRO_TAB_TDec|Nm/ms|
|194|1 - 15|MPRO_TAB_TDec|Nm/ms|

# Table 8.23: Activation of table references

# Table 8.24: “Setpoint table settings” parameters

# Table 8.24: “Setpoint table settings” parameters (continue)

|ID|Index Name|Unit|Description|ID|Index Name|Unit|Description|
|---|---|---|---|---|---|---|---|
|195|MPRO_TAB_TRef|Nm|TAB: Torque mode reference value|208|MPRO_TAB_OutputNo| |OSD TAB: actual table index and target|
|195|MPRO_TAB_TRef|Nm| |208|MPRO_TAB_OutputNo| | |
|196|MPRO_TAB_SAcc|rev/min/s|TAB: Speed mode acceleration|269|MPRO_TAB_Ctrl| |TAB: control word|
|196|MPRO_TAB_SAcc|rev/min/s| | | | | |
|197|MPRO_TAB_SDec|rev/min/s|TAB: Speed mode deceleration| | | | |
|197|MPRO_TAB_SDec|rev/min/s| | | | | |
|198|MPRO_TAB_SRef|rev/min|TAB: Speed mode reference value| | | | |
|198|MPRO_TAB_SRef|rev/min| | | | | |
|199|MPRO_TAB_PAcc|rev/min/s|TAB: Position control mode acceleration| | | | |
|199|MPRO_TAB_PAcc|rev/min/s| | | | | |
|200|MPRO_TAB_PDec|rev/min/s|TAB: Position control mode Acceleration| | | | |
|200|MPRO_TAB_PDec|rev/min/s| | | | | |
|201|MPRO_TAB_PSpd|rev/min|TAB: Position control mode speed| | | | |
|201|MPRO_TAB_PSpd|rev/min| | | | | |
|202|MPRO_TAB_PPos|mDegree|TAB: Position control mode reference value| | | | |
|202|MPRO_TAB_PPos|mDegree| | | | | |
|203|MPRO_TAB_PMode| |Position control table:Mode| | | | |
|203|MPRO_TAB_PMode| | | | | | |
|204|MPRO_TAB_WaitTime|ms|TAB: Wait time| | | | |
|204|MPRO_TAB_WaitTime|ms| | | | | |
|205|MPRO_TAB_Mode| |TAB mode| | | | |
|206|MPRO_Tab_MaxIdx| |TAB: Max index in AUTO mode| | | | |
|207|MPRO_TAB_ActIdx| |TAB: Actual index| | | | |

MOOG ID No.:CB40859-001 Date:11/2020

MSD ServoDrive - DeviceHelp

# 8 Motion profile

MOOG ID No.:CB40859-001 Date:11/2020

MSD ServoDrive - DeviceHelp 270

# 8.8 Analog channel (ISA00 und ISA01)

# Offset (O)

This parameter (P 174 - MPRO_ANA0_SOffset for ISA00, P 184 - MPRO_ANA1_SOffset for ISA01) compensates for component variations and is used for offset compensation purposes. Depending on the control mode being used (see Section ""Basic settings"" on page 110), the value will be stored in parameter index [0] (torque control), [1] (speed control) or [2] (position control).

# Backlash (B)

This parameter (P 175 - MPRO_ANA0_SThreshold for ISA00, P 185 - MPRO_ANA1_SThreshold for ISA01) can suppress axis motion close to the standstill (stop) position. Depending on the control mode being used (see Section ""Basic settings"" on page 110), the value will be stored in parameter index [0] (torque control), [1] (speed control) or [2] (position control).

Image 8.68: “Analog channel” screen

# Acceleration ramp

Two standard analog inputs (ISA00, ISA01) are available. These inputs can be configured...

- with negative values for analog setpoint settings
- with positive values for digital setpoint processing

(P 109[0] - MPRO_INPUT_FS_ISA00 and P 110[0] - MPRO_INPUT_FS_ISA01).

see also section ""Analog Inputs"" on page 303. By using the ""REV(-2) = Analog setpoint"" setting, an analog input voltage of ±10 V can be processed as a setpoint.

# Deceleration ramp

This parameter serves as a deceleration ramp for torque control (P 176[1] - MPRO_ANA0_TRamp for ISA00, P 186[1] - MPRO_ANA1_TRamp for ISA01) or speed control (P 177[1] - MPRO_ANA0_SRamp for ISA00, P 187[1] - MPRO_ANA1_SRamp for ISA01). Depending on the control mode being used (see Section ""Basic settings"" on page 110), the value will be stored in parameter index [0] (torque control), [1] (speed control) or [2] (position control).

This parameter (P 173 - MPRO_ANA0_Scale for ISA00, P 183 - MPRO_ANA1_Scale for ISA01) is used to define which speed / which torque / which position corresponds to the maximum analog value. Depending on the control mode being used (see Section ""Basic settings"" on page 110), the value will be stored in parameter index [0] (torque control), [1] (speed control) or [2] (position control).

# 8.8.1 Special characteristics of position control mode

A threshold value can also be specified which generates a run-on range around the last reference value. A ramp function calculates a motion profile for the position reference from pre-defined acceleration and speed limits.

The position references on the analog channel are not applied immediately, but dependent on a digital input. Accordingly, one of the ISD00 to ISD06 digital inputs must be set to a value of ""REFANAEN(28) = Enable analog reference value"" (see Section ""Digital inputs"" on page 290). The position setpoint being received will only be applied if the corresponding digital input is active. The acceleration is entered using P 173[0] - MPRO_ANA0_TScale or P 183[0] - MPRO_ANA1_TScale.

# 8.8.2 Wire Break Monitoring

P 399 - CON_ANAWireBrk_Th can be used to configure wire break monitoring for the analog inputs. For details see Section ""Wire Break Monitoring"" on page 306.

|Function|TLIM (-4)|OVR (-3)|REFV (-2)|leer (-1)|OFF (0)|
|---|---|---|---|---|---|
|Digital|(1)-(28)|(1)-(28)|(1)-(28)|(1)-(28)|(1)-(28)|
|Analog channel|Filter|Scale|Offset|Profile|generator|

Control

Image 8.69: Reference processing structure

MOOG ID No.:CB40859-001 Date:11/2020

MSD ServoDrive - DeviceHelp 271

# 8 Motion profile

# 8 Motion profile

MOOG ID No.:CB40859-001 Date:11/2020

|ID|Index Name|Unit|Description|ID|
|---|---|---|---|---|
|395|CON_ANA_Isaf_Scaled| |Analog inputs: Values (filt, norm, comp, scaled)|174|
|395|0 ISA00| |Scaled, compensated, filtered, normalized value|175|
|395|1 ISA01| |Scaled, compensated, filtered, normalized value| |
|396|CON_ANA_Scale_ThUpper| |Analog inputs: Upper scaling limits|175|
|396|0 ISA00|%|Upper scaling (@ 10 V) threshold|175|
|396|1 ISA01|%|Upper scaling (@ 10 V) threshold| |
|397|CON_ANA_Scale_ThZero| |Analog inputs: Zero scaling thresholds|176|
|397|0 ISA00|V|Zero scaling threshold (+/-)|176|
|397|1 ISA01|V|Zero scaling threshold (+/-)| |
|398|CON_ANA_Scale_ThLower| |Analog inputs: Lower scaling limits|177|
|398|0 ISA00|%|Lower scaling (@ zero threshold) threshold|177|
|398|1 ISA01|%|Lower scaling (@ zero threshold) threshold| |
|399|CON_ANA_WireBrk_Th| |Analog inputs: Wire break thresholds|Table 8.26:|
|399|0 ISA00|V|Wire break detection threshold| |
|399|1 ISA01|V|Wire break detection threshold| |
|405|0 CON_ANA_Filt0|ms|Analog input ISA00: Filter time constant (PT 1)|ID|
|408|CON_ANA_Isaf_Norm| |Analog inputs: Values (filt, norm)|183|
|408|0 ISA00| |Filtered, normalized value|183|
|408|1 ISA01| |Filtered, normalized value|183|

Table 8.25: “Analog channel” parameters

|ID|Index Name|Unit|Description|ID|
|---|---|---|---|---|
|173|MPRO_ANA0_Scale| |ANA0: scale factors|184|
|173|0 MPRO_ANA0_TScale|Nm|ANA0: scale factor torque reference|185|
|173|1 MPRO_ANA0_SScale|rev/min|ANA0: scale factor speed reference|185|
|173|2 MPRO_ANA0_PScale|mDegree|ANA0: scale factor position reference| |
|174|MPRO_ANA0_Offset| |ANA0: offsets|185|
|174|0 MPRO_ANA0_TOffset|Nm|ANA0: offsets for torque reference|185|

Table 8.26: “Analog channel ISA00” parameters

|Index Name|Unit|Description|
|---|---|---|
|1 MPRO_ANA0_SOffset|rev/min|ANA0: offsets for speed reference|
|2 MPRO_ANA0_POffset|mDegree|ANA0: offsets for position reference|
|MPRO_ANA0_Threshold| |ANA0: thresholds|
|0 MPRO_ANA0_TThreshold|Nm|ANA0: threshold for torque reference|
|1 MPRO_ANA0_SThreshold|rev/min|ANA0: threshold for speed reference|
|2 MPRO_ANA0_PThreshold|mDegree|ANA0: threshold for position reference|
|MPRO_ANA0_TRamp| |ANA0: Torque mode acceleration [0] and deceleration [1]|
|0 MPRO_ANA0_TRamp|Nm/s| |
|1 MPRO_ANA0_TRamp|Nm/s| |
|MPRO_ANA0_SRamp| |ANA0: Speed mode acceleration [0] and deceleration [1]|
|0 MPRO_ANA0_SRamp|SPEED/s| |
|1 MPRO_ANA0_SRamp|SPEED/s| |

“Analog channel ISA00” parameters (continue)

|Index Name|Unit|Description|
|---|---|---|
|MPRO_ANA1_Scale| |ANA1: scale factors|
|0 MPRO_ANA1_TScale|Nm|ANA0: scale factor torque reference|
|1 MPRO_ANA1_SScale|rev/min|ANA0: scale factor speed reference|
|2 MPRO_ANA1_PScale|mDegree|ANA0: scale factor position reference|
|MPRO_ANA1_Offset| |ANA1: offsets|
|0 MPRO_ANA1_TOffset|Nm|ANA1: offsets for torque reference|
|1 MPRO_ANA1_SOffset|rev/min|ANA1: offsets for speed reference|
|2 MPRO_ANA1_POffset|mDegree|ANA1: offsets for position reference|
|MPRO_ANA1_Threshold| |ANA1: thresholds|
|0 MPRO_ANA1_TThreshold|Nm|ANA1: threshold for torque reference|
|1 MPRO_ANA1_SThreshold|rev/min|ANA1: threshold for speed reference|
|2 MPRO_ANA1_PThreshold|mDegree|ANA1: threshold for position reference|

“Analog channel ISA01” parameters

# 8 Motion profile

|ID|Index Name|Unit|Description|
|---|---|---|---|
|186|MPRO_ANA1_TRamp|Nm/s|ANA1: Torque mode acceleration [0] and deceleration[1]|
|186|MPRO_ANA1_TRamp|Nm/s| |
|187|MPRO_ANA1_SRamp|SPEED/s|ANA1: Speed mode acceleration [0] and deceleration [1]|
|187|MPRO_ANA1_SRamp|SPEED/s| |

# Table 8.27: “Analog channel ISA01” parameters (continue)

Display

- System state
- Initialization on device startup
- Not ready (DC link voltage possibly too low)
- Start inhibit (DC link voltage present, power stage off)
- Starting lockout
- Ready for start
- Control initialization: Auto commutation, flux build-up etc.

# Table 8.28: Central state machine according to CiA 402 device display

MOOG ID No.:CB40859-001 Date:11/2020

MSD ServoDrive - DeviceHelp 273

# 8 Motion profile

MOOG ID No.:CB40859-001 Date:11/2020

MSD ServoDrive - DeviceHelp 274

|Display|System state|power disabled|fault|
|---|---|---|---|
|Control enabled|0|Start|7|
| |fault reaction active|0|14|
|Quick stop active|1|not ready|8|
| |to switch on|1|17|
|Error reaction active|2|switch on|disabled|
| |2|7| |
|Error state (in this state the error is indicated directly on the display.)|3|ready to|switch on|
|Device is reset (display flashes)|power enabled|3|6|
| |10|12| |
|• Number [5.] flashes when “STO” (Safe Torque Off) input is active. Display goes out when STO inactive.| | | |
|• The dot on the display flashes when the power stage is active.| | | |

Table 8.28: Central state machine according to CiA 402 device display (continue)

NOTE

l The system states indicated on the display may differ from the states in the table depending on the drive profile setting.

Image 8.70: State machine diagram based on CANopen communications

⓪ to ① State number

1 to 17 State transition (No. 17: DC link voltage cut off)

Legend for “State machine diagram based on CANopen communications” figure

# 8.10 Touch probe

|ID|Index Name / Setting|
|---|---|
|241|0 MPRO_TP_Position|
|241|1 MPRO_TP_Position|
|241|2 MPRO_TP_Position|
|241|3 MPRO_TP_Position|
|241|4 MPRO_TP_Position|
|1400|0 MPRO_TP_Config|
| |TP_TP (0)|
| |AB (1)|
| |PD_UP (2)|
| |PD_DOWN (3)|
| |PC_PC (4)|
| |PC_TP (5)|
| |TP_PC (6)|
| |ENC_ENC (7)|
| |ENC_TP (8)|
| |TP_ENC (9)|

Using the touch probe inputs, touch probe functions can be performed. In order to be able to do this, P 106[0] - MPRO_INPUT_FS_ISD05 and P 107[0] - MPRO_INPUT_FS_ISD06 must be used to set digital inputs ISD05 and ISD06 to ""PROBE(15) = Touch probe (only ISD05/06)"" (see Section ""Digital inputs"" on page 290). HTL encoders can be evaluated or pulse counters implemented using the MSD PLC.

The touch probe can be triggered with P 240 - MPRO_TP_Ctrl. This enables triggering on a positive or negative edge, or on both edges, of the signal detected on the touch probe inputs. After the measurement, the parameter jumps back to the value ""NONE (0)"" and the latch position is mapped in the corresponding subindex of parameter P 241 - MPRO_TP_Position. A continuous touch probe mode is not possible at present, so the touch probe has to be reactivated after the measurement.

P 1402 - MPRO_TP_Channel can be used to select various positions as actual value sources of the latch position for the touch probe functionality. The following table provides an overview of the available settings. The counters are accessed via the MSD PLC or a bus system.

|ID|Index Name / Setting|Unit|Description|
|---|---|---|---|
|240|MPRO_TP_Ctrl|Touch probe: Control| |
| |0| |NONE (0) = No function|
| |1| |POS (1) = Positive edge|
| |2| |NEG (2) = Negative edge|
| |3| |BOTH (3) = Both edges|
|240|0 MPRO_TP_Ctrl| | |
|240|1 MPRO_TP_Ctrl| | |
|240|2 MPRO_TP_Ctrl| | |
|241|MPRO_TP_Position|Probe: Pos. high/low edge of TP0/1, encoder zero pulse| |

Table 8.29: “Touch probe” parameters

MOOG ID No.:CB40859-001 Date:11/2020

# 8 Motion profile

|Unit|Description|
|---|---|
|mDegree|Touch probe: Configuration|
|mDegree|TP0, TP1 touch probe|
|mDegree|TP0, TP1 as encoder, A/B as quadrature counting|
|mDegree|TP0, TP1 as encoder, pulse (TP0) / direction (TP1), count up on direction high|
|mDegree|TP0, TP1 as encoder, pulse (TP0) / direction (TP1), count down on direction high|
|mDegree|TP0 pulse counter, TP1 pulse counter|
|mDegree|TP0 pulse counter, TP1 touch probe|
|mDegree|TP1 touch probe, TP0 pulse counter|
|mDegree|TP0 encoder counter, TP1 encoder counter|
|mDegree|TP0 encoder counter, TP1 touch probe|
|mDegree|TP0 touch probe, TP1 encoder counter|

Touch probe: Channel

|Unit|Description|
|---|---|
|ACTPOS (0)|Actual position in user units|
|ACTPOSINC (1)|Actual position in increments|
|MASTERPOS (2)|Master position in increments|
|ENCPOS_CH1 (3)|Encoder position Channel 1|
|ENCPOS_CH1_INC (4)|Encoder position Channel 1 in increments|
|ENCPOS_CH2 (5)|Encoder position Channel 2|
|ENCPOS_CH2_INC (6)|Encoder position Channel 2 in increments|

# 8 Motion profile

MOOG ID No.:CB40859-001 Date:11/2020 MSD ServoDrive - DeviceHelp 276

|ID|Index Name / Setting|Unit|Description|
|---|---|---|---|
|7|ENCPOS_CH3 (7)| |Encoder position Channel 3|
|8|ENCPOS_CH3_INC (8)| |Encoder position Channel 3 in increments|
|9|ENCPOS_CH4 (9)| |Encoder position Channel 4|
|10|ENCPOS_CH4_INC (10)| |Encoder position Channel 4 in increments|
|11|ACTPOS2 (11)| |Actual position of redundant encoder in user units|
|12|Sercos (12)| |Referred to Sercos profile parameters S-x-0426, S-x-0427|
|13|UserRefPos(13)| |Reference position in user units|
|14|MasterPosST(14)| |Master position (ECAM, EGEAR) singleturn, always steps|
|15|CommonMasterPos(15)| |Master position (ECAM, EGEAR) singleturn, always steps|
|16|CommonMasterPosST(15)| |Master position (ECAM, EGEAR) singleturn, always steps|
|1402|MPRO_TP_Channel| | |
|1402|MPRO_TP_Channel| | |
|1402|MPRO_TP_Channel| | |
|1404|MPRO_TP_Lines| |Touch probe: Lines @ pulse counter on channel x|
|1404|MPRO_TP_Lines| | |
|1404|MPRO_TP_Lines| | |

Image 8.71: “Synchronized motion” screen

There are various modes available in the “synchronization mode” drop-down menu (P 242[0] - MPRO_ECAM_SyncModMode):

- Off(0) = Synchronized motion off
- ECAM_iPlc(1) = Electronic cam plate via MSD PLC
- EGEAR_iPlc(2) = Electr. gear unit via MSD PLC
- ECAM_PARA(3) = Electronic camming via parameters
- EGEAR_PARA(4) = Electronic gearing via parameters

NOTE: For more information refer to the bus system User Manuals or the description of the MSD PLC.

# 8.11.1 Electronic cam plate

The other parameters are configured in separate screens that can be accessed with the corresponding buttons.

- Master configuration (see Section ""Master configuration"" on page 280)
- Electronic gearing (see Section ""Electronic gearing"" on page 283)
- Electronic camming (see Section ""Electronic cam plate"" on page 277)

P 1318[0] - MPRO_ECAM_ControlWord is the control word for “synchronized motion” (see Section ""Control word for synchronized motion"" on page 279).

P 1326[0] - MPRO_ECAM_StatusWord is the status word for “synchronized motion” (see Section ""Status word for synchronized motion"" on page 279).

# 8.11.1.1 Table selection

|ID|Index Name|Unit|Description|
|---|---|---|---|
|1300|MPRO_ECAM_CTS_| |ECAM: CamTableSelect - Master reference|
|1301|MasterRef| | |
|1305|MPRO_ECAM_CTS_| |ECAM: CamTableSelect - Method for changing the camtable|
|1306|MPRO_ECAM_CTS_| |ECAM: CamTableSelect - Mode for changing the camtable|
|1307|MPRO_ECAM_CTS_|incr|ECAM: CamTableSelect - Distance for changing the camtable|
|242|MPRO_ECAM_| |ECAM / EGEAR: Mode of synchronized motion SyncModMode|
|265|MPRO_ECAM_| |ECAM / EGEAR: Slave speed factor (1 = 100%).|
|266|CamSlave_SpeedFactor| | |
|268|MPRO_ECAM_| |ECAM / EGEAR: Mode of switching off sync. motion|

# 8.11.1.2 Synchronization

|ID|Index Name|Unit|Description|
|---|---|---|---|
|1342|MPRO_ECAM_CI_|incr|ECAM: CamIn - Synchronization position (multiturn part)|
|1343|MPRO_ECAM_CO_|incr|ECAM: CamOut - Decoupling pos. (multiturn part)|
|1303|MPRO_ECAM_CI_|incr|ECAM: CamIn - Master offset|
|1308|MPRO_ECAM_CI_| |ECAM: CamIn - Master reference|
|1309|MPRO_ECAM_CI_| |ECAM: CamIn - Slave reference|
|1310|MPRO_ECAM_CI_| |ECAM: CamIn - Coupling mode|
|1311|MPRO_ECAM_CI_|incr|ECAM: CamIn - Coupling distance|
|1312|MPRO_ECAM_CI_|incr|ECAM: CamIn - Synchronization position|

Table 8.31: “Electronic camming - Table selection” parameters

Table 8.30: “Synchronized motion” parameters

Table 8.32: “Electronic camming - Synchronization” parameters

MOOG ID No.:CB40859-001 Date:11/2020

MSD ServoDrive - DeviceHelp 277

# 8 Motion profile

MOOG ID No.:CB40859-001 Date:11/2020 MSD ServoDrive - DeviceHelp 278

|ID|Index|Name|Unit|Description|
|---|---|---|---|---|
|1313|0|MPRO_ECAM_CO_SyncPosST|(singleturn part)|ECAM: CamOut - Slave reference|
|1314|0|MPRO_ECAM_CO_DecouplingMode|63|ECAM: CamOut - Decoupling mode|
|1315|0|MPRO_ECAM_CO_BreakingPosST|incr|ECAM: CamOut - Decoupling position|
|1316|0|MPRO_ECAM_CO_DecouplingDist|incr|ECAM: CamOut - Decoupling distance|
|1317|0|MPRO_ECAM_CO_StandstillPos|mDegree|ECAM: CamOut - Slave standstill position|

# Table 8.32: “Electronic camming - Synchronization” parameters (continue)

|ID|Index|Name|Unit|Description|
|---|---|---|---|---|
|1346| |MPRO_ECAM_SP_Table| |ECAM: Setpoint table interface|
|1346|0|Index| |Index of setpoint table|
|1346|1|Value| |Value at index of setpoint table|
|1347|0 to 31|MPRO_ECAM_SP_Index| |ECAM: Setpoint segments start index|
|1348|0 to 31|MPRO_ECAM_SP_Length| |ECAM: Setpoint segments length|
|1349|0 to 31|Length| | |
|1350|0|MPRO_ECAM_SP_MaDist| |ECAM: Setpoint segments master distance|
|1351|0|MPRO_ECAM_SP_IpoType| |ECAM: Setpoint segments interpolation type|
|1352|0 to 31|Checksum| |ECAM: Setpoint table checksum|
|1353|0 to 31|GainNum| |ECAM: Setpoint segments gain numerator|
| | |GainDen| |ECAM: Setpoint segments gain denominator|

# Table 8.33: “Electronic camming - Table segments” parameters

|ID|Index|Name|Unit|Description|
|---|---|---|---|---|
|1329|0 to 63|MPRO_ECAM_SegData_IndexNext| |ECAM: Index of the following segment|
|1330|0 to 63|MPRO_ECAM_SegData_IndexPrev| |ECAM: Index of the previous segment|
|1331|0 to 63|MPRO_ECAM_SegData_ProfileMode| |ECAM: Profile mode of the current segment|
|1332|0 to 63|MPRO_ECAM_SegData_DistMaster| |ECAM: Length of the master section of the current segment|
|1333|0 to 63|MPRO_ECAM_SegData_DistSlave| |ECAM: Length of the slave section of the current segment|
|1334|0 to 63|MPRO_ECAM_SegData_Lambda| |ECAM: Lambda value of the current segment|
|1335|0 to 63|MPRO_ECAM_SegData_StatusWord| |ECAM: Status word of the current segment|
|1336|0 to 63|MPRO_ECAM_SegData_ControlWord| |ECAM: Control word of the current segment|

# 8.11.2 Control word for synchronized motion

|Bit|Function|PLC function|Bit number|Description|
|---|---|---|---|---|
|0-7|Start segment (8-bit value)|-|0-7|Actual segment (8-bit value)|
|8-15|Reserved|-| |Actual ECAM / EGEAR state machine state (4 Bit value)|
|16|Absolute (true) / relative (false) master relationship|-| |- 0: ECAM / EGEAR asynchronous
- 1: ECAM / EGEAR synchronous
|
|17|Absolute (true) / relative (false) master (CAM) relationship at cam in|-| |- 2: ECAM / EGEAR synchronizing
- 3: ECAM / EGEAR desynchronizing
|
|18|Absolute (true) / relative (false) slave (CAM) relationship at cam in|-| |- 4: ECAM / EGEAR active and waiting for going asynchronous
|
|19-23|Reserved|-| |- 5: ECAM / EGEAR inactive and waiting for going synchronous
|
|24|Change gear ratio of the electronic gear online|MCB_GearRatioChange| | |
|25|Disable master calculation|MCB_Cam_MasterEnable| | |
|26|Enable master calculation|MCB_Cam_MasterEnable| | |
|27|Select CAM table|MCB_CamTableSelect| | |
|28|Start Ecam|MCB_CamIn| | |
|29|Stop Ecam|MCB_CamOut| | |
|30|Start Egear|MCB_GearIn| | |
|31|Stop Egear|MCB_GearOut| | |

# 8.11.3 Status word for synchronized motion

|Bit|Function|PLC function|Bit number|Description|
|---|---|---|---|---|
|12-26|Reserved|-| | |
|27|ECAM / EGEAR is active|-| | |
|28|Valid segments chosen|-| | |
|29|Master data are valid|-| | |
|30|Master is initialized|-| | |
|31|Master calculation is active|-| | |

Table 8.35: Control word ECAM (P 1318[0] - MPRO_ECAM_ControlWord)

Table 8.36: ECAM status word (P 1326[0] - MPRO_ECAM_StatusWord)

MOOG ID No.:CB40859-001 Date:11/2020 MSD ServoDrive - DeviceHelp 279

# 8 Motion profile

# 8 Motion profile

MOOG ID No.:CB40859-001 Date:11/2020

MSD ServoDrive - DeviceHelp 280

# 8.11.4 Master configuration

the master encoder, you will need to set the resolution relative to a single motor revolution in P 250 - MPRO_ECAM_PARAMaster_Amplitude (see below).

- ENC CH1 (3) = Encoder channel 1 X7 (Sin/Cos)
- ENC CH2 (4) = Encoder channel 2 X6 (Resolver)
- ENC CH3 (5) = Encoder channel 3 X8 (optional)

This function is only available if an external interface X8 (option module) is present.

- TP0 (6) = Pulse counter on probe channel 0 (TP0)
- TP1 (7) = Pulse counter on probe channel 1 (TP1)
- ENC_CH4 (8) = Encoder channel 4 (p. e. fieldbus)
- TWIN_POS (9) = TWIN remote reference position (P-2607)

Image 8.72: “Master configuration” screen

# Channel selection (master encoder)

P 1319[0] - MPRO_ECAM_CamMaster_AxisType is used to define the master encoder.

- NO AXIS (0) = No axis
- VIRTUAL MASTER (1) = Virtual master

If you select this function, you will be able to configure additional settings by clicking on the enabled “Options...” button (see Section ""Virtual Master"" on page 286).

- PARA (2) = Master parameter interface

If you select this function because a higher-level controller is being used as

# Anti-reverse mode

Slave only starts moving along with it again as soon as the master reaches the zero position.

P 1320[0] - MPRO_ECAM_CamMaster_RevLockMode is used to define the reverse lock mode, which can be used either with or without path compensation. The dashed lines in the following diagrams indicate what the engagement distance is:

# Example:

If the master, which has moved two motor revolutions in the direction blocked for the slave, then moves in the unblocked direction again, the slave only moves off when the master has traversed the zero point.

- INACTIVE (0) = Reverse lock inactive
- ACTIVE (2) = Reverse lock enabled - without path optimization
- ACTIVE WAY COMP (1) = Reverse lock active - with way compensation

While the slave accelerates to the speed of the master during engagement, the master and slave do not move synchronously. This function needs to be selected in order to quickly catch up to the master that is running ahead.

# Example:

- Master (black line) rotates in the blocked direction
- The slave (blue line) remains stopped
- Master rotates in the unblocked direction again
- The slave follows the master directly in the unblocked direction

Assume the master has moved two motor revolutions in the direction for which the slave lock is enabled. If the master now moves in the direction for which there is no lock, the slave will immediately start running in that direction.

MOOG ID No.:CB40859-001 Date:11/2020

MSD ServoDrive - DeviceHelp 281

# 8 Motion profile

MOOG ID No.:CB40859-001 Date:11/2020 MSD ServoDrive - DeviceHelp 282

|Filter type|ID|Index Name|Unit|Description|
|---|---|---|---|---|
|When using a real master encoder, encoder signals may be subject to noise.|P 1340|1319|0|MPRO_ECAM_CamMaster_AxisType|
| | |MPRO_ECAM_CamMaster_SpeedFilTyp| |ECAM / EGEAR: Channel selection of internal master input|
| | |1320|0|MPRO_ECAM_CamMaster_RevLockMode|
| | |1321|0|MPRO_ECAM_CamMaster_Amplitude|
| | |1322|0|MPRO_ECAM_CamMaster_GearNum|
| | |1323|0|MPRO_ECAM_CamMaster_GearDen|
|Filter time|1327|0|ms|ECAM / EGEAR: Filter time constant of master|
|If P 1340[0] is used to enable a filter, P 1327[0] - MPRO_ECAM_CamMaster_SpeedTFil can be used to define the corresponding filter time.|1328|0|speed|ECAM / EGEAR: Speed factor of the internal master|
|Speed factor|1340|0| |MPRO_ECAM_CamMaster_SpeedFilTyp|
|The master encoder can be assigned an additional speed factor P 1328[0] - MPRO_ECAM_CamMaster_SpeedFactor.|1341|0|incr|ECAM / EGEAR: Master drive offset|

Table 8.37: “Synchronized motion - Master configuration” parameters (continue)

| | | |ID|Index Name|Unit|Description|
|---|---|---|---|---|---|---|
|247|0|MPRO_ECAM_ParaMaster_ActPos|incr|ECAM / EGEAR: Parameter interface master position| | |
|248|0|MPRO_ECAM_ParaMaster_ActSpeed|rpm|ECAM / EGEAR: Parameter interface master speed| | |
|249|0|MPRO_ECAM_ParaMaster_ActAcc|rpm|ECAM / EGEAR: Parameter interface master acceleration| | |
| |250|0|MPRO_ECAM_ParaMaster_Amplitude| |ECAM / EGEAR: Parameter interface master amplitude| |

Table 8.37: “Synchronized motion - Master configuration” parameters

# 8.11.5 Electronic gearing

# Gear ratio

The gear ratio is specified as a fraction. This ensures that the position references can be translated to the motor shaft with no rounding error.

- ""Slave"" (P 252[0] - MPRO_ECAM_Egear_GearNum) is the numerator
- ""Master"" (P 251[0] - MPRO_ECAM_Egear_GearDen) is the denominator

# Scaling of speed pre-control

Defined with P 265[0] - MPRO_ECAM_CamSlave_SpeedFactor definiert.

# Scaling of torque pre-control

Defined with P 266[0] - MPRO_ECAM_CamSlave_TorqueFactor.

# Engagement

See Section ""Engagement"" on page 284.

# Disengagement

See Section ""Disengagement"" on page 285.

|ID|Index Name|Unit|Description|
|---|---|---|---|
|251|0 MPRO_ECAM_Egear_GearDen| |EGEAR: Gear denominator|
|252|0 MPRO_ECAM_Egear_GearNum| |EGEAR: Numerator of gear ratio|
|1344|0 MPRO_ECAM_Egear_LimRefAcc|rpm/s|EGEAR: Acceleration limit for reference|
|1345|0 MPRO_ECAM_Egear_LimRefJerk|rpm/s²|EGEAR: Jerk limit for reference|

Table 8.38: “Synchronized motion - Electronic gearing” parameters

Image 8.73: ""Electronic gearing"" screen

MOOG ID No.:CB40859-001 Date:11/2020 MSD ServoDrive - DeviceHelp 283

# 8 Motion profile

# 8 Motion profile

MOOG ID No.:CB40859-001 Date:11/2020

MSD ServoDrive - DeviceHelp 284

# 8.11.6 Engagement

used to define the engagement distance (between the dashed lines).

P 253[0] - MPRO_ECAM_Egear_GearInMode is used to define the mode for engagement.

- DIRECT (0) = Direct
- Direct engagement: Angular synchronous; with jerking (no ramps).
- CROSSFADE (3) = Crossfading
- Engagement with crossfading function (5th degree polynomial): Angular synchronous; jerk-limited; speed will overshoot during engagement.
- RAMP (1) = Linear speed ramp
- Engagement with linear acceleration: Not angular synchronous; with jerking.
- FADE (2) = Engagement fade-out
- Engagement with fade-in function (5th degree polynomial): Not angular synchronous; jerk-limited. The position is ignored. ",What is the function of the deceleration ramp parameter in the analog channels ISA00 and ISA01 in the 'MSD ServoDrive - DeviceHelp' document?,A4,"For speed control, P 177[1] and P 187[1] set the deceleration ramp.",1.203125,1.3984375,3.265625,1.4375,0.333984375
34,msd_servo_drive.txt,76,b87ca5e232c2bdbb6fa16a8a401c6b5d285dc0183e73cc9d134de13dd2fc71d2,"MOOG ID No.:CB40859-001 Date:11/2020

MSD ServoDrive - DeviceHelp 267

# 8 Motion profile

MOOG ID No.:CB40859-001 Date:11/2020 MSD ServoDrive - DeviceHelp 268

# Deceleration

With ...

- P 194 - MPRO_TAB_TDec (for torque control) or
- P 197 - MPRO_TAB_SDec (for speed control) or
- P 200 - MPRO_TAB_PDec (for position control)

and indexes 0–15, the deceleration for each individual motion task can be defined. The input must not be zero.

# Wait time in Auto mode

P 204 - MPRO_TAB_WaitTime is used to define the wait time before the next motion task is carried out.

# Maximum table index in Auto mode

P 206[0] - MPRO_Tab_MaxIdx is used to define the table index up to which driving jobs will be carried out in one of the auto modes.

# Current table index

P 207[0] - MPRO_Tab_ActIdx will show the index for the motion task that is currently active. If parameter P 205 MPRO_TAB_Mode is set to “Para(0)”, a driving set can be entered and approached directly.

# Activation of reference table

The following procedures can be used in order to activate the setpoint table for operation.

|ID|Index Name|Unit|Description|
|---|---|---|---|
|193|MPRO_TAB_TAcc|TAB: Torque mode acceleration|Nm/ms|
|193|0|MPRO_TAB_TAcc|Nm/ms|
|193|1 - 15|MPRO_TAB_TAcc|Nm/ms|
|194|MPRO_TAB_TDec|TAB: Torque mode deceleration| |
|194|0|MPRO_TAB_TDec|Nm/ms|
|194|1 - 15|MPRO_TAB_TDec|Nm/ms|

# Table 8.23: Activation of table references

# Table 8.24: “Setpoint table settings” parameters

# Table 8.24: “Setpoint table settings” parameters (continue)

|ID|Index Name|Unit|Description|ID|Index Name|Unit|Description|
|---|---|---|---|---|---|---|---|
|195|MPRO_TAB_TRef|Nm|TAB: Torque mode reference value|208|MPRO_TAB_OutputNo| |OSD TAB: actual table index and target|
|195|MPRO_TAB_TRef|Nm| |208|MPRO_TAB_OutputNo| | |
|196|MPRO_TAB_SAcc|rev/min/s|TAB: Speed mode acceleration|269|MPRO_TAB_Ctrl| |TAB: control word|
|196|MPRO_TAB_SAcc|rev/min/s| | | | | |
|197|MPRO_TAB_SDec|rev/min/s|TAB: Speed mode deceleration| | | | |
|197|MPRO_TAB_SDec|rev/min/s| | | | | |
|198|MPRO_TAB_SRef|rev/min|TAB: Speed mode reference value| | | | |
|198|MPRO_TAB_SRef|rev/min| | | | | |
|199|MPRO_TAB_PAcc|rev/min/s|TAB: Position control mode acceleration| | | | |
|199|MPRO_TAB_PAcc|rev/min/s| | | | | |
|200|MPRO_TAB_PDec|rev/min/s|TAB: Position control mode Acceleration| | | | |
|200|MPRO_TAB_PDec|rev/min/s| | | | | |
|201|MPRO_TAB_PSpd|rev/min|TAB: Position control mode speed| | | | |
|201|MPRO_TAB_PSpd|rev/min| | | | | |
|202|MPRO_TAB_PPos|mDegree|TAB: Position control mode reference value| | | | |
|202|MPRO_TAB_PPos|mDegree| | | | | |
|203|MPRO_TAB_PMode| |Position control table:Mode| | | | |
|203|MPRO_TAB_PMode| | | | | | |
|204|MPRO_TAB_WaitTime|ms|TAB: Wait time| | | | |
|204|MPRO_TAB_WaitTime|ms| | | | | |
|205|MPRO_TAB_Mode| |TAB mode| | | | |
|206|MPRO_Tab_MaxIdx| |TAB: Max index in AUTO mode| | | | |
|207|MPRO_TAB_ActIdx| |TAB: Actual index| | | | |

MOOG ID No.:CB40859-001 Date:11/2020

MSD ServoDrive - DeviceHelp

# 8 Motion profile

MOOG ID No.:CB40859-001 Date:11/2020

MSD ServoDrive - DeviceHelp 270

# 8.8 Analog channel (ISA00 und ISA01)

# Offset (O)

This parameter (P 174 - MPRO_ANA0_SOffset for ISA00, P 184 - MPRO_ANA1_SOffset for ISA01) compensates for component variations and is used for offset compensation purposes. Depending on the control mode being used (see Section ""Basic settings"" on page 110), the value will be stored in parameter index [0] (torque control), [1] (speed control) or [2] (position control).

# Backlash (B)

This parameter (P 175 - MPRO_ANA0_SThreshold for ISA00, P 185 - MPRO_ANA1_SThreshold for ISA01) can suppress axis motion close to the standstill (stop) position. Depending on the control mode being used (see Section ""Basic settings"" on page 110), the value will be stored in parameter index [0] (torque control), [1] (speed control) or [2] (position control).

Image 8.68: “Analog channel” screen

# Acceleration ramp

Two standard analog inputs (ISA00, ISA01) are available. These inputs can be configured...

- with negative values for analog setpoint settings
- with positive values for digital setpoint processing

(P 109[0] - MPRO_INPUT_FS_ISA00 and P 110[0] - MPRO_INPUT_FS_ISA01).

see also section ""Analog Inputs"" on page 303. By using the ""REV(-2) = Analog setpoint"" setting, an analog input voltage of ±10 V can be processed as a setpoint.

# Deceleration ramp

This parameter serves as a deceleration ramp for torque control (P 176[1] - MPRO_ANA0_TRamp for ISA00, P 186[1] - MPRO_ANA1_TRamp for ISA01) or speed control (P 177[1] - MPRO_ANA0_SRamp for ISA00, P 187[1] - MPRO_ANA1_SRamp for ISA01). Depending on the control mode being used (see Section ""Basic settings"" on page 110), the value will be stored in parameter index [0] (torque control), [1] (speed control) or [2] (position control).

This parameter (P 173 - MPRO_ANA0_Scale for ISA00, P 183 - MPRO_ANA1_Scale for ISA01) is used to define which speed / which torque / which position corresponds to the maximum analog value. Depending on the control mode being used (see Section ""Basic settings"" on page 110), the value will be stored in parameter index [0] (torque control), [1] (speed control) or [2] (position control).

# 8.8.1 Special characteristics of position control mode

A threshold value can also be specified which generates a run-on range around the last reference value. A ramp function calculates a motion profile for the position reference from pre-defined acceleration and speed limits.

The position references on the analog channel are not applied immediately, but dependent on a digital input. Accordingly, one of the ISD00 to ISD06 digital inputs must be set to a value of ""REFANAEN(28) = Enable analog reference value"" (see Section ""Digital inputs"" on page 290). The position setpoint being received will only be applied if the corresponding digital input is active. The acceleration is entered using P 173[0] - MPRO_ANA0_TScale or P 183[0] - MPRO_ANA1_TScale.

# 8.8.2 Wire Break Monitoring

P 399 - CON_ANAWireBrk_Th can be used to configure wire break monitoring for the analog inputs. For details see Section ""Wire Break Monitoring"" on page 306.

|Function|TLIM (-4)|OVR (-3)|REFV (-2)|leer (-1)|OFF (0)|
|---|---|---|---|---|---|
|Digital|(1)-(28)|(1)-(28)|(1)-(28)|(1)-(28)|(1)-(28)|
|Analog channel|Filter|Scale|Offset|Profile|generator|

Control

Image 8.69: Reference processing structure

MOOG ID No.:CB40859-001 Date:11/2020

MSD ServoDrive - DeviceHelp 271

# 8 Motion profile

# 8 Motion profile

MOOG ID No.:CB40859-001 Date:11/2020

|ID|Index Name|Unit|Description|ID|
|---|---|---|---|---|
|395|CON_ANA_Isaf_Scaled| |Analog inputs: Values (filt, norm, comp, scaled)|174|
|395|0 ISA00| |Scaled, compensated, filtered, normalized value|175|
|395|1 ISA01| |Scaled, compensated, filtered, normalized value| |
|396|CON_ANA_Scale_ThUpper| |Analog inputs: Upper scaling limits|175|
|396|0 ISA00|%|Upper scaling (@ 10 V) threshold|175|
|396|1 ISA01|%|Upper scaling (@ 10 V) threshold| |
|397|CON_ANA_Scale_ThZero| |Analog inputs: Zero scaling thresholds|176|
|397|0 ISA00|V|Zero scaling threshold (+/-)|176|
|397|1 ISA01|V|Zero scaling threshold (+/-)| |
|398|CON_ANA_Scale_ThLower| |Analog inputs: Lower scaling limits|177|
|398|0 ISA00|%|Lower scaling (@ zero threshold) threshold|177|
|398|1 ISA01|%|Lower scaling (@ zero threshold) threshold| |
|399|CON_ANA_WireBrk_Th| |Analog inputs: Wire break thresholds|Table 8.26:|
|399|0 ISA00|V|Wire break detection threshold| |
|399|1 ISA01|V|Wire break detection threshold| |
|405|0 CON_ANA_Filt0|ms|Analog input ISA00: Filter time constant (PT 1)|ID|
|408|CON_ANA_Isaf_Norm| |Analog inputs: Values (filt, norm)|183|
|408|0 ISA00| |Filtered, normalized value|183|
|408|1 ISA01| |Filtered, normalized value|183|

Table 8.25: “Analog channel” parameters

|ID|Index Name|Unit|Description|ID|
|---|---|---|---|---|
|173|MPRO_ANA0_Scale| |ANA0: scale factors|184|
|173|0 MPRO_ANA0_TScale|Nm|ANA0: scale factor torque reference|185|
|173|1 MPRO_ANA0_SScale|rev/min|ANA0: scale factor speed reference|185|
|173|2 MPRO_ANA0_PScale|mDegree|ANA0: scale factor position reference| |
|174|MPRO_ANA0_Offset| |ANA0: offsets|185|
|174|0 MPRO_ANA0_TOffset|Nm|ANA0: offsets for torque reference|185|

Table 8.26: “Analog channel ISA00” parameters

|Index Name|Unit|Description|
|---|---|---|
|1 MPRO_ANA0_SOffset|rev/min|ANA0: offsets for speed reference|
|2 MPRO_ANA0_POffset|mDegree|ANA0: offsets for position reference|
|MPRO_ANA0_Threshold| |ANA0: thresholds|
|0 MPRO_ANA0_TThreshold|Nm|ANA0: threshold for torque reference|
|1 MPRO_ANA0_SThreshold|rev/min|ANA0: threshold for speed reference|
|2 MPRO_ANA0_PThreshold|mDegree|ANA0: threshold for position reference|
|MPRO_ANA0_TRamp| |ANA0: Torque mode acceleration [0] and deceleration [1]|
|0 MPRO_ANA0_TRamp|Nm/s| |
|1 MPRO_ANA0_TRamp|Nm/s| |
|MPRO_ANA0_SRamp| |ANA0: Speed mode acceleration [0] and deceleration [1]|
|0 MPRO_ANA0_SRamp|SPEED/s| |
|1 MPRO_ANA0_SRamp|SPEED/s| |

“Analog channel ISA00” parameters (continue)

|Index Name|Unit|Description|
|---|---|---|
|MPRO_ANA1_Scale| |ANA1: scale factors|
|0 MPRO_ANA1_TScale|Nm|ANA0: scale factor torque reference|
|1 MPRO_ANA1_SScale|rev/min|ANA0: scale factor speed reference|
|2 MPRO_ANA1_PScale|mDegree|ANA0: scale factor position reference|
|MPRO_ANA1_Offset| |ANA1: offsets|
|0 MPRO_ANA1_TOffset|Nm|ANA1: offsets for torque reference|
|1 MPRO_ANA1_SOffset|rev/min|ANA1: offsets for speed reference|
|2 MPRO_ANA1_POffset|mDegree|ANA1: offsets for position reference|
|MPRO_ANA1_Threshold| |ANA1: thresholds|
|0 MPRO_ANA1_TThreshold|Nm|ANA1: threshold for torque reference|
|1 MPRO_ANA1_SThreshold|rev/min|ANA1: threshold for speed reference|
|2 MPRO_ANA1_PThreshold|mDegree|ANA1: threshold for position reference|

“Analog channel ISA01” parameters

# 8 Motion profile

|ID|Index Name|Unit|Description|
|---|---|---|---|
|186|MPRO_ANA1_TRamp|Nm/s|ANA1: Torque mode acceleration [0] and deceleration[1]|
|186|MPRO_ANA1_TRamp|Nm/s| |
|187|MPRO_ANA1_SRamp|SPEED/s|ANA1: Speed mode acceleration [0] and deceleration [1]|
|187|MPRO_ANA1_SRamp|SPEED/s| |

# Table 8.27: “Analog channel ISA01” parameters (continue)

Display

- System state
- Initialization on device startup
- Not ready (DC link voltage possibly too low)
- Start inhibit (DC link voltage present, power stage off)
- Starting lockout
- Ready for start
- Control initialization: Auto commutation, flux build-up etc.

# Table 8.28: Central state machine according to CiA 402 device display

MOOG ID No.:CB40859-001 Date:11/2020

MSD ServoDrive - DeviceHelp 273

# 8 Motion profile

MOOG ID No.:CB40859-001 Date:11/2020

MSD ServoDrive - DeviceHelp 274

|Display|System state|power disabled|fault|
|---|---|---|---|
|Control enabled|0|Start|7|
| |fault reaction active|0|14|
|Quick stop active|1|not ready|8|
| |to switch on|1|17|
|Error reaction active|2|switch on|disabled|
| |2|7| |
|Error state (in this state the error is indicated directly on the display.)|3|ready to|switch on|
|Device is reset (display flashes)|power enabled|3|6|
| |10|12| |
|• Number [5.] flashes when “STO” (Safe Torque Off) input is active. Display goes out when STO inactive.| | | |
|• The dot on the display flashes when the power stage is active.| | | |

Table 8.28: Central state machine according to CiA 402 device display (continue)

NOTE

l The system states indicated on the display may differ from the states in the table depending on the drive profile setting.

Image 8.70: State machine diagram based on CANopen communications

⓪ to ① State number

1 to 17 State transition (No. 17: DC link voltage cut off)

Legend for “State machine diagram based on CANopen communications” figure

# 8.10 Touch probe

|ID|Index Name / Setting|
|---|---|
|241|0 MPRO_TP_Position|
|241|1 MPRO_TP_Position|
|241|2 MPRO_TP_Position|
|241|3 MPRO_TP_Position|
|241|4 MPRO_TP_Position|
|1400|0 MPRO_TP_Config|
| |TP_TP (0)|
| |AB (1)|
| |PD_UP (2)|
| |PD_DOWN (3)|
| |PC_PC (4)|
| |PC_TP (5)|
| |TP_PC (6)|
| |ENC_ENC (7)|
| |ENC_TP (8)|
| |TP_ENC (9)|

Using the touch probe inputs, touch probe functions can be performed. In order to be able to do this, P 106[0] - MPRO_INPUT_FS_ISD05 and P 107[0] - MPRO_INPUT_FS_ISD06 must be used to set digital inputs ISD05 and ISD06 to ""PROBE(15) = Touch probe (only ISD05/06)"" (see Section ""Digital inputs"" on page 290). HTL encoders can be evaluated or pulse counters implemented using the MSD PLC.

The touch probe can be triggered with P 240 - MPRO_TP_Ctrl. This enables triggering on a positive or negative edge, or on both edges, of the signal detected on the touch probe inputs. After the measurement, the parameter jumps back to the value ""NONE (0)"" and the latch position is mapped in the corresponding subindex of parameter P 241 - MPRO_TP_Position. A continuous touch probe mode is not possible at present, so the touch probe has to be reactivated after the measurement.

P 1402 - MPRO_TP_Channel can be used to select various positions as actual value sources of the latch position for the touch probe functionality. The following table provides an overview of the available settings. The counters are accessed via the MSD PLC or a bus system.

|ID|Index Name / Setting|Unit|Description|
|---|---|---|---|
|240|MPRO_TP_Ctrl|Touch probe: Control| |
| |0| |NONE (0) = No function|
| |1| |POS (1) = Positive edge|
| |2| |NEG (2) = Negative edge|
| |3| |BOTH (3) = Both edges|
|240|0 MPRO_TP_Ctrl| | |
|240|1 MPRO_TP_Ctrl| | |
|240|2 MPRO_TP_Ctrl| | |
|241|MPRO_TP_Position|Probe: Pos. high/low edge of TP0/1, encoder zero pulse| |

Table 8.29: “Touch probe” parameters

MOOG ID No.:CB40859-001 Date:11/2020

# 8 Motion profile

|Unit|Description|
|---|---|
|mDegree|Touch probe: Configuration|
|mDegree|TP0, TP1 touch probe|
|mDegree|TP0, TP1 as encoder, A/B as quadrature counting|
|mDegree|TP0, TP1 as encoder, pulse (TP0) / direction (TP1), count up on direction high|
|mDegree|TP0, TP1 as encoder, pulse (TP0) / direction (TP1), count down on direction high|
|mDegree|TP0 pulse counter, TP1 pulse counter|
|mDegree|TP0 pulse counter, TP1 touch probe|
|mDegree|TP1 touch probe, TP0 pulse counter|
|mDegree|TP0 encoder counter, TP1 encoder counter|
|mDegree|TP0 encoder counter, TP1 touch probe|
|mDegree|TP0 touch probe, TP1 encoder counter|

Touch probe: Channel

|Unit|Description|
|---|---|
|ACTPOS (0)|Actual position in user units|
|ACTPOSINC (1)|Actual position in increments|
|MASTERPOS (2)|Master position in increments|
|ENCPOS_CH1 (3)|Encoder position Channel 1|
|ENCPOS_CH1_INC (4)|Encoder position Channel 1 in increments|
|ENCPOS_CH2 (5)|Encoder position Channel 2|
|ENCPOS_CH2_INC (6)|Encoder position Channel 2 in increments|

# 8 Motion profile

MOOG ID No.:CB40859-001 Date:11/2020 MSD ServoDrive - DeviceHelp 276

|ID|Index Name / Setting|Unit|Description|
|---|---|---|---|
|7|ENCPOS_CH3 (7)| |Encoder position Channel 3|
|8|ENCPOS_CH3_INC (8)| |Encoder position Channel 3 in increments|
|9|ENCPOS_CH4 (9)| |Encoder position Channel 4|
|10|ENCPOS_CH4_INC (10)| |Encoder position Channel 4 in increments|
|11|ACTPOS2 (11)| |Actual position of redundant encoder in user units|
|12|Sercos (12)| |Referred to Sercos profile parameters S-x-0426, S-x-0427|
|13|UserRefPos(13)| |Reference position in user units|
|14|MasterPosST(14)| |Master position (ECAM, EGEAR) singleturn, always steps|
|15|CommonMasterPos(15)| |Master position (ECAM, EGEAR) singleturn, always steps|
|16|CommonMasterPosST(15)| |Master position (ECAM, EGEAR) singleturn, always steps|
|1402|MPRO_TP_Channel| | |
|1402|MPRO_TP_Channel| | |
|1402|MPRO_TP_Channel| | |
|1404|MPRO_TP_Lines| |Touch probe: Lines @ pulse counter on channel x|
|1404|MPRO_TP_Lines| | |
|1404|MPRO_TP_Lines| | |

Image 8.71: “Synchronized motion” screen

There are various modes available in the “synchronization mode” drop-down menu (P 242[0] - MPRO_ECAM_SyncModMode):

- Off(0) = Synchronized motion off
- ECAM_iPlc(1) = Electronic cam plate via MSD PLC
- EGEAR_iPlc(2) = Electr. gear unit via MSD PLC
- ECAM_PARA(3) = Electronic camming via parameters
- EGEAR_PARA(4) = Electronic gearing via parameters

NOTE: For more information refer to the bus system User Manuals or the description of the MSD PLC.

# 8.11.1 Electronic cam plate

The other parameters are configured in separate screens that can be accessed with the corresponding buttons.

- Master configuration (see Section ""Master configuration"" on page 280)
- Electronic gearing (see Section ""Electronic gearing"" on page 283)
- Electronic camming (see Section ""Electronic cam plate"" on page 277)

P 1318[0] - MPRO_ECAM_ControlWord is the control word for “synchronized motion” (see Section ""Control word for synchronized motion"" on page 279).

P 1326[0] - MPRO_ECAM_StatusWord is the status word for “synchronized motion” (see Section ""Status word for synchronized motion"" on page 279).

# 8.11.1.1 Table selection

|ID|Index Name|Unit|Description|
|---|---|---|---|
|1300|MPRO_ECAM_CTS_| |ECAM: CamTableSelect - Master reference|
|1301|MasterRef| | |
|1305|MPRO_ECAM_CTS_| |ECAM: CamTableSelect - Method for changing the camtable|
|1306|MPRO_ECAM_CTS_| |ECAM: CamTableSelect - Mode for changing the camtable|
|1307|MPRO_ECAM_CTS_|incr|ECAM: CamTableSelect - Distance for changing the camtable|
|242|MPRO_ECAM_| |ECAM / EGEAR: Mode of synchronized motion SyncModMode|
|265|MPRO_ECAM_| |ECAM / EGEAR: Slave speed factor (1 = 100%).|
|266|CamSlave_SpeedFactor| | |
|268|MPRO_ECAM_| |ECAM / EGEAR: Mode of switching off sync. motion|

# 8.11.1.2 Synchronization

|ID|Index Name|Unit|Description|
|---|---|---|---|
|1342|MPRO_ECAM_CI_|incr|ECAM: CamIn - Synchronization position (multiturn part)|
|1343|MPRO_ECAM_CO_|incr|ECAM: CamOut - Decoupling pos. (multiturn part)|
|1303|MPRO_ECAM_CI_|incr|ECAM: CamIn - Master offset|
|1308|MPRO_ECAM_CI_| |ECAM: CamIn - Master reference|
|1309|MPRO_ECAM_CI_| |ECAM: CamIn - Slave reference|
|1310|MPRO_ECAM_CI_| |ECAM: CamIn - Coupling mode|
|1311|MPRO_ECAM_CI_|incr|ECAM: CamIn - Coupling distance|
|1312|MPRO_ECAM_CI_|incr|ECAM: CamIn - Synchronization position|

Table 8.31: “Electronic camming - Table selection” parameters

Table 8.30: “Synchronized motion” parameters

Table 8.32: “Electronic camming - Synchronization” parameters

MOOG ID No.:CB40859-001 Date:11/2020

MSD ServoDrive - DeviceHelp 277

# 8 Motion profile

MOOG ID No.:CB40859-001 Date:11/2020 MSD ServoDrive - DeviceHelp 278

|ID|Index|Name|Unit|Description|
|---|---|---|---|---|
|1313|0|MPRO_ECAM_CO_SyncPosST|(singleturn part)|ECAM: CamOut - Slave reference|
|1314|0|MPRO_ECAM_CO_DecouplingMode|63|ECAM: CamOut - Decoupling mode|
|1315|0|MPRO_ECAM_CO_BreakingPosST|incr|ECAM: CamOut - Decoupling position|
|1316|0|MPRO_ECAM_CO_DecouplingDist|incr|ECAM: CamOut - Decoupling distance|
|1317|0|MPRO_ECAM_CO_StandstillPos|mDegree|ECAM: CamOut - Slave standstill position|

# Table 8.32: “Electronic camming - Synchronization” parameters (continue)

|ID|Index|Name|Unit|Description|
|---|---|---|---|---|
|1346| |MPRO_ECAM_SP_Table| |ECAM: Setpoint table interface|
|1346|0|Index| |Index of setpoint table|
|1346|1|Value| |Value at index of setpoint table|
|1347|0 to 31|MPRO_ECAM_SP_Index| |ECAM: Setpoint segments start index|
|1348|0 to 31|MPRO_ECAM_SP_Length| |ECAM: Setpoint segments length|
|1349|0 to 31|Length| | |
|1350|0|MPRO_ECAM_SP_MaDist| |ECAM: Setpoint segments master distance|
|1351|0|MPRO_ECAM_SP_IpoType| |ECAM: Setpoint segments interpolation type|
|1352|0 to 31|Checksum| |ECAM: Setpoint table checksum|
|1353|0 to 31|GainNum| |ECAM: Setpoint segments gain numerator|
| | |GainDen| |ECAM: Setpoint segments gain denominator|

# Table 8.33: “Electronic camming - Table segments” parameters

|ID|Index|Name|Unit|Description|
|---|---|---|---|---|
|1329|0 to 63|MPRO_ECAM_SegData_IndexNext| |ECAM: Index of the following segment|
|1330|0 to 63|MPRO_ECAM_SegData_IndexPrev| |ECAM: Index of the previous segment|
|1331|0 to 63|MPRO_ECAM_SegData_ProfileMode| |ECAM: Profile mode of the current segment|
|1332|0 to 63|MPRO_ECAM_SegData_DistMaster| |ECAM: Length of the master section of the current segment|
|1333|0 to 63|MPRO_ECAM_SegData_DistSlave| |ECAM: Length of the slave section of the current segment|
|1334|0 to 63|MPRO_ECAM_SegData_Lambda| |ECAM: Lambda value of the current segment|
|1335|0 to 63|MPRO_ECAM_SegData_StatusWord| |ECAM: Status word of the current segment|
|1336|0 to 63|MPRO_ECAM_SegData_ControlWord| |ECAM: Control word of the current segment|

# 8.11.2 Control word for synchronized motion

|Bit|Function|PLC function|Bit number|Description|
|---|---|---|---|---|
|0-7|Start segment (8-bit value)|-|0-7|Actual segment (8-bit value)|
|8-15|Reserved|-| |Actual ECAM / EGEAR state machine state (4 Bit value)|
|16|Absolute (true) / relative (false) master relationship|-| |- 0: ECAM / EGEAR asynchronous
- 1: ECAM / EGEAR synchronous
|
|17|Absolute (true) / relative (false) master (CAM) relationship at cam in|-| |- 2: ECAM / EGEAR synchronizing
- 3: ECAM / EGEAR desynchronizing
|
|18|Absolute (true) / relative (false) slave (CAM) relationship at cam in|-| |- 4: ECAM / EGEAR active and waiting for going asynchronous
|
|19-23|Reserved|-| |- 5: ECAM / EGEAR inactive and waiting for going synchronous
|
|24|Change gear ratio of the electronic gear online|MCB_GearRatioChange| | |
|25|Disable master calculation|MCB_Cam_MasterEnable| | |
|26|Enable master calculation|MCB_Cam_MasterEnable| | |
|27|Select CAM table|MCB_CamTableSelect| | |
|28|Start Ecam|MCB_CamIn| | |
|29|Stop Ecam|MCB_CamOut| | |
|30|Start Egear|MCB_GearIn| | |
|31|Stop Egear|MCB_GearOut| | |

# 8.11.3 Status word for synchronized motion

|Bit|Function|PLC function|Bit number|Description|
|---|---|---|---|---|
|12-26|Reserved|-| | |
|27|ECAM / EGEAR is active|-| | |
|28|Valid segments chosen|-| | |
|29|Master data are valid|-| | |
|30|Master is initialized|-| | |
|31|Master calculation is active|-| | |

Table 8.35: Control word ECAM (P 1318[0] - MPRO_ECAM_ControlWord)

Table 8.36: ECAM status word (P 1326[0] - MPRO_ECAM_StatusWord)

MOOG ID No.:CB40859-001 Date:11/2020 MSD ServoDrive - DeviceHelp 279

# 8 Motion profile

# 8 Motion profile

MOOG ID No.:CB40859-001 Date:11/2020

MSD ServoDrive - DeviceHelp 280

# 8.11.4 Master configuration

the master encoder, you will need to set the resolution relative to a single motor revolution in P 250 - MPRO_ECAM_PARAMaster_Amplitude (see below).

- ENC CH1 (3) = Encoder channel 1 X7 (Sin/Cos)
- ENC CH2 (4) = Encoder channel 2 X6 (Resolver)
- ENC CH3 (5) = Encoder channel 3 X8 (optional)

This function is only available if an external interface X8 (option module) is present.

- TP0 (6) = Pulse counter on probe channel 0 (TP0)
- TP1 (7) = Pulse counter on probe channel 1 (TP1)
- ENC_CH4 (8) = Encoder channel 4 (p. e. fieldbus)
- TWIN_POS (9) = TWIN remote reference position (P-2607)

Image 8.72: “Master configuration” screen

# Channel selection (master encoder)

P 1319[0] - MPRO_ECAM_CamMaster_AxisType is used to define the master encoder.

- NO AXIS (0) = No axis
- VIRTUAL MASTER (1) = Virtual master

If you select this function, you will be able to configure additional settings by clicking on the enabled “Options...” button (see Section ""Virtual Master"" on page 286).

- PARA (2) = Master parameter interface

If you select this function because a higher-level controller is being used as

# Anti-reverse mode

Slave only starts moving along with it again as soon as the master reaches the zero position.

P 1320[0] - MPRO_ECAM_CamMaster_RevLockMode is used to define the reverse lock mode, which can be used either with or without path compensation. The dashed lines in the following diagrams indicate what the engagement distance is:

# Example:

If the master, which has moved two motor revolutions in the direction blocked for the slave, then moves in the unblocked direction again, the slave only moves off when the master has traversed the zero point.

- INACTIVE (0) = Reverse lock inactive
- ACTIVE (2) = Reverse lock enabled - without path optimization
- ACTIVE WAY COMP (1) = Reverse lock active - with way compensation

While the slave accelerates to the speed of the master during engagement, the master and slave do not move synchronously. This function needs to be selected in order to quickly catch up to the master that is running ahead.

# Example:

- Master (black line) rotates in the blocked direction
- The slave (blue line) remains stopped
- Master rotates in the unblocked direction again
- The slave follows the master directly in the unblocked direction

Assume the master has moved two motor revolutions in the direction for which the slave lock is enabled. If the master now moves in the direction for which there is no lock, the slave will immediately start running in that direction.

MOOG ID No.:CB40859-001 Date:11/2020

MSD ServoDrive - DeviceHelp 281

# 8 Motion profile

MOOG ID No.:CB40859-001 Date:11/2020 MSD ServoDrive - DeviceHelp 282

|Filter type|ID|Index Name|Unit|Description|
|---|---|---|---|---|
|When using a real master encoder, encoder signals may be subject to noise.|P 1340|1319|0|MPRO_ECAM_CamMaster_AxisType|
| | |MPRO_ECAM_CamMaster_SpeedFilTyp| |ECAM / EGEAR: Channel selection of internal master input|
| | |1320|0|MPRO_ECAM_CamMaster_RevLockMode|
| | |1321|0|MPRO_ECAM_CamMaster_Amplitude|
| | |1322|0|MPRO_ECAM_CamMaster_GearNum|
| | |1323|0|MPRO_ECAM_CamMaster_GearDen|
|Filter time|1327|0|ms|ECAM / EGEAR: Filter time constant of master|
|If P 1340[0] is used to enable a filter, P 1327[0] - MPRO_ECAM_CamMaster_SpeedTFil can be used to define the corresponding filter time.|1328|0|speed|ECAM / EGEAR: Speed factor of the internal master|
|Speed factor|1340|0| |MPRO_ECAM_CamMaster_SpeedFilTyp|
|The master encoder can be assigned an additional speed factor P 1328[0] - MPRO_ECAM_CamMaster_SpeedFactor.|1341|0|incr|ECAM / EGEAR: Master drive offset|

Table 8.37: “Synchronized motion - Master configuration” parameters (continue)

| | | |ID|Index Name|Unit|Description|
|---|---|---|---|---|---|---|
|247|0|MPRO_ECAM_ParaMaster_ActPos|incr|ECAM / EGEAR: Parameter interface master position| | |
|248|0|MPRO_ECAM_ParaMaster_ActSpeed|rpm|ECAM / EGEAR: Parameter interface master speed| | |
|249|0|MPRO_ECAM_ParaMaster_ActAcc|rpm|ECAM / EGEAR: Parameter interface master acceleration| | |
| |250|0|MPRO_ECAM_ParaMaster_Amplitude| |ECAM / EGEAR: Parameter interface master amplitude| |

Table 8.37: “Synchronized motion - Master configuration” parameters

# 8.11.5 Electronic gearing

# Gear ratio

The gear ratio is specified as a fraction. This ensures that the position references can be translated to the motor shaft with no rounding error.

- ""Slave"" (P 252[0] - MPRO_ECAM_Egear_GearNum) is the numerator
- ""Master"" (P 251[0] - MPRO_ECAM_Egear_GearDen) is the denominator

# Scaling of speed pre-control

Defined with P 265[0] - MPRO_ECAM_CamSlave_SpeedFactor definiert.

# Scaling of torque pre-control

Defined with P 266[0] - MPRO_ECAM_CamSlave_TorqueFactor.

# Engagement

See Section ""Engagement"" on page 284.

# Disengagement

See Section ""Disengagement"" on page 285.

|ID|Index Name|Unit|Description|
|---|---|---|---|
|251|0 MPRO_ECAM_Egear_GearDen| |EGEAR: Gear denominator|
|252|0 MPRO_ECAM_Egear_GearNum| |EGEAR: Numerator of gear ratio|
|1344|0 MPRO_ECAM_Egear_LimRefAcc|rpm/s|EGEAR: Acceleration limit for reference|
|1345|0 MPRO_ECAM_Egear_LimRefJerk|rpm/s²|EGEAR: Jerk limit for reference|

Table 8.38: “Synchronized motion - Electronic gearing” parameters

Image 8.73: ""Electronic gearing"" screen

MOOG ID No.:CB40859-001 Date:11/2020 MSD ServoDrive - DeviceHelp 283

# 8 Motion profile

# 8 Motion profile

MOOG ID No.:CB40859-001 Date:11/2020

MSD ServoDrive - DeviceHelp 284

# 8.11.6 Engagement

used to define the engagement distance (between the dashed lines).

P 253[0] - MPRO_ECAM_Egear_GearInMode is used to define the mode for engagement.

- DIRECT (0) = Direct
- Direct engagement: Angular synchronous; with jerking (no ramps).
- CROSSFADE (3) = Crossfading
- Engagement with crossfading function (5th degree polynomial): Angular synchronous; jerk-limited; speed will overshoot during engagement.
- RAMP (1) = Linear speed ramp
- Engagement with linear acceleration: Not angular synchronous; with jerking.
- FADE (2) = Engagement fade-out
- Engagement with fade-in function (5th degree polynomial): Not angular synchronous; jerk-limited. The position is ignored. ",What is the function of the deceleration ramp parameter in the analog channels ISA00 and ISA01 in the 'MSD ServoDrive - DeviceHelp' document?,A5,Deceleration ramps in ISA00 and ISA01 are configured for torque and speed control modes.,1.5234375,1.5078125,3.328125,1.53125,0.353515625
35,msd_servo_drive.txt,76,b87ca5e232c2bdbb6fa16a8a401c6b5d285dc0183e73cc9d134de13dd2fc71d2,"MOOG ID No.:CB40859-001 Date:11/2020

MSD ServoDrive - DeviceHelp 267

# 8 Motion profile

MOOG ID No.:CB40859-001 Date:11/2020 MSD ServoDrive - DeviceHelp 268

# Deceleration

With ...

- P 194 - MPRO_TAB_TDec (for torque control) or
- P 197 - MPRO_TAB_SDec (for speed control) or
- P 200 - MPRO_TAB_PDec (for position control)

and indexes 0–15, the deceleration for each individual motion task can be defined. The input must not be zero.

# Wait time in Auto mode

P 204 - MPRO_TAB_WaitTime is used to define the wait time before the next motion task is carried out.

# Maximum table index in Auto mode

P 206[0] - MPRO_Tab_MaxIdx is used to define the table index up to which driving jobs will be carried out in one of the auto modes.

# Current table index

P 207[0] - MPRO_Tab_ActIdx will show the index for the motion task that is currently active. If parameter P 205 MPRO_TAB_Mode is set to “Para(0)”, a driving set can be entered and approached directly.

# Activation of reference table

The following procedures can be used in order to activate the setpoint table for operation.

|ID|Index Name|Unit|Description|
|---|---|---|---|
|193|MPRO_TAB_TAcc|TAB: Torque mode acceleration|Nm/ms|
|193|0|MPRO_TAB_TAcc|Nm/ms|
|193|1 - 15|MPRO_TAB_TAcc|Nm/ms|
|194|MPRO_TAB_TDec|TAB: Torque mode deceleration| |
|194|0|MPRO_TAB_TDec|Nm/ms|
|194|1 - 15|MPRO_TAB_TDec|Nm/ms|

# Table 8.23: Activation of table references

# Table 8.24: “Setpoint table settings” parameters

# Table 8.24: “Setpoint table settings” parameters (continue)

|ID|Index Name|Unit|Description|ID|Index Name|Unit|Description|
|---|---|---|---|---|---|---|---|
|195|MPRO_TAB_TRef|Nm|TAB: Torque mode reference value|208|MPRO_TAB_OutputNo| |OSD TAB: actual table index and target|
|195|MPRO_TAB_TRef|Nm| |208|MPRO_TAB_OutputNo| | |
|196|MPRO_TAB_SAcc|rev/min/s|TAB: Speed mode acceleration|269|MPRO_TAB_Ctrl| |TAB: control word|
|196|MPRO_TAB_SAcc|rev/min/s| | | | | |
|197|MPRO_TAB_SDec|rev/min/s|TAB: Speed mode deceleration| | | | |
|197|MPRO_TAB_SDec|rev/min/s| | | | | |
|198|MPRO_TAB_SRef|rev/min|TAB: Speed mode reference value| | | | |
|198|MPRO_TAB_SRef|rev/min| | | | | |
|199|MPRO_TAB_PAcc|rev/min/s|TAB: Position control mode acceleration| | | | |
|199|MPRO_TAB_PAcc|rev/min/s| | | | | |
|200|MPRO_TAB_PDec|rev/min/s|TAB: Position control mode Acceleration| | | | |
|200|MPRO_TAB_PDec|rev/min/s| | | | | |
|201|MPRO_TAB_PSpd|rev/min|TAB: Position control mode speed| | | | |
|201|MPRO_TAB_PSpd|rev/min| | | | | |
|202|MPRO_TAB_PPos|mDegree|TAB: Position control mode reference value| | | | |
|202|MPRO_TAB_PPos|mDegree| | | | | |
|203|MPRO_TAB_PMode| |Position control table:Mode| | | | |
|203|MPRO_TAB_PMode| | | | | | |
|204|MPRO_TAB_WaitTime|ms|TAB: Wait time| | | | |
|204|MPRO_TAB_WaitTime|ms| | | | | |
|205|MPRO_TAB_Mode| |TAB mode| | | | |
|206|MPRO_Tab_MaxIdx| |TAB: Max index in AUTO mode| | | | |
|207|MPRO_TAB_ActIdx| |TAB: Actual index| | | | |

MOOG ID No.:CB40859-001 Date:11/2020

MSD ServoDrive - DeviceHelp

# 8 Motion profile

MOOG ID No.:CB40859-001 Date:11/2020

MSD ServoDrive - DeviceHelp 270

# 8.8 Analog channel (ISA00 und ISA01)

# Offset (O)

This parameter (P 174 - MPRO_ANA0_SOffset for ISA00, P 184 - MPRO_ANA1_SOffset for ISA01) compensates for component variations and is used for offset compensation purposes. Depending on the control mode being used (see Section ""Basic settings"" on page 110), the value will be stored in parameter index [0] (torque control), [1] (speed control) or [2] (position control).

# Backlash (B)

This parameter (P 175 - MPRO_ANA0_SThreshold for ISA00, P 185 - MPRO_ANA1_SThreshold for ISA01) can suppress axis motion close to the standstill (stop) position. Depending on the control mode being used (see Section ""Basic settings"" on page 110), the value will be stored in parameter index [0] (torque control), [1] (speed control) or [2] (position control).

Image 8.68: “Analog channel” screen

# Acceleration ramp

Two standard analog inputs (ISA00, ISA01) are available. These inputs can be configured...

- with negative values for analog setpoint settings
- with positive values for digital setpoint processing

(P 109[0] - MPRO_INPUT_FS_ISA00 and P 110[0] - MPRO_INPUT_FS_ISA01).

see also section ""Analog Inputs"" on page 303. By using the ""REV(-2) = Analog setpoint"" setting, an analog input voltage of ±10 V can be processed as a setpoint.

# Deceleration ramp

This parameter serves as a deceleration ramp for torque control (P 176[1] - MPRO_ANA0_TRamp for ISA00, P 186[1] - MPRO_ANA1_TRamp for ISA01) or speed control (P 177[1] - MPRO_ANA0_SRamp for ISA00, P 187[1] - MPRO_ANA1_SRamp for ISA01). Depending on the control mode being used (see Section ""Basic settings"" on page 110), the value will be stored in parameter index [0] (torque control), [1] (speed control) or [2] (position control).

This parameter (P 173 - MPRO_ANA0_Scale for ISA00, P 183 - MPRO_ANA1_Scale for ISA01) is used to define which speed / which torque / which position corresponds to the maximum analog value. Depending on the control mode being used (see Section ""Basic settings"" on page 110), the value will be stored in parameter index [0] (torque control), [1] (speed control) or [2] (position control).

# 8.8.1 Special characteristics of position control mode

A threshold value can also be specified which generates a run-on range around the last reference value. A ramp function calculates a motion profile for the position reference from pre-defined acceleration and speed limits.

The position references on the analog channel are not applied immediately, but dependent on a digital input. Accordingly, one of the ISD00 to ISD06 digital inputs must be set to a value of ""REFANAEN(28) = Enable analog reference value"" (see Section ""Digital inputs"" on page 290). The position setpoint being received will only be applied if the corresponding digital input is active. The acceleration is entered using P 173[0] - MPRO_ANA0_TScale or P 183[0] - MPRO_ANA1_TScale.

# 8.8.2 Wire Break Monitoring

P 399 - CON_ANAWireBrk_Th can be used to configure wire break monitoring for the analog inputs. For details see Section ""Wire Break Monitoring"" on page 306.

|Function|TLIM (-4)|OVR (-3)|REFV (-2)|leer (-1)|OFF (0)|
|---|---|---|---|---|---|
|Digital|(1)-(28)|(1)-(28)|(1)-(28)|(1)-(28)|(1)-(28)|
|Analog channel|Filter|Scale|Offset|Profile|generator|

Control

Image 8.69: Reference processing structure

MOOG ID No.:CB40859-001 Date:11/2020

MSD ServoDrive - DeviceHelp 271

# 8 Motion profile

# 8 Motion profile

MOOG ID No.:CB40859-001 Date:11/2020

|ID|Index Name|Unit|Description|ID|
|---|---|---|---|---|
|395|CON_ANA_Isaf_Scaled| |Analog inputs: Values (filt, norm, comp, scaled)|174|
|395|0 ISA00| |Scaled, compensated, filtered, normalized value|175|
|395|1 ISA01| |Scaled, compensated, filtered, normalized value| |
|396|CON_ANA_Scale_ThUpper| |Analog inputs: Upper scaling limits|175|
|396|0 ISA00|%|Upper scaling (@ 10 V) threshold|175|
|396|1 ISA01|%|Upper scaling (@ 10 V) threshold| |
|397|CON_ANA_Scale_ThZero| |Analog inputs: Zero scaling thresholds|176|
|397|0 ISA00|V|Zero scaling threshold (+/-)|176|
|397|1 ISA01|V|Zero scaling threshold (+/-)| |
|398|CON_ANA_Scale_ThLower| |Analog inputs: Lower scaling limits|177|
|398|0 ISA00|%|Lower scaling (@ zero threshold) threshold|177|
|398|1 ISA01|%|Lower scaling (@ zero threshold) threshold| |
|399|CON_ANA_WireBrk_Th| |Analog inputs: Wire break thresholds|Table 8.26:|
|399|0 ISA00|V|Wire break detection threshold| |
|399|1 ISA01|V|Wire break detection threshold| |
|405|0 CON_ANA_Filt0|ms|Analog input ISA00: Filter time constant (PT 1)|ID|
|408|CON_ANA_Isaf_Norm| |Analog inputs: Values (filt, norm)|183|
|408|0 ISA00| |Filtered, normalized value|183|
|408|1 ISA01| |Filtered, normalized value|183|

Table 8.25: “Analog channel” parameters

|ID|Index Name|Unit|Description|ID|
|---|---|---|---|---|
|173|MPRO_ANA0_Scale| |ANA0: scale factors|184|
|173|0 MPRO_ANA0_TScale|Nm|ANA0: scale factor torque reference|185|
|173|1 MPRO_ANA0_SScale|rev/min|ANA0: scale factor speed reference|185|
|173|2 MPRO_ANA0_PScale|mDegree|ANA0: scale factor position reference| |
|174|MPRO_ANA0_Offset| |ANA0: offsets|185|
|174|0 MPRO_ANA0_TOffset|Nm|ANA0: offsets for torque reference|185|

Table 8.26: “Analog channel ISA00” parameters

|Index Name|Unit|Description|
|---|---|---|
|1 MPRO_ANA0_SOffset|rev/min|ANA0: offsets for speed reference|
|2 MPRO_ANA0_POffset|mDegree|ANA0: offsets for position reference|
|MPRO_ANA0_Threshold| |ANA0: thresholds|
|0 MPRO_ANA0_TThreshold|Nm|ANA0: threshold for torque reference|
|1 MPRO_ANA0_SThreshold|rev/min|ANA0: threshold for speed reference|
|2 MPRO_ANA0_PThreshold|mDegree|ANA0: threshold for position reference|
|MPRO_ANA0_TRamp| |ANA0: Torque mode acceleration [0] and deceleration [1]|
|0 MPRO_ANA0_TRamp|Nm/s| |
|1 MPRO_ANA0_TRamp|Nm/s| |
|MPRO_ANA0_SRamp| |ANA0: Speed mode acceleration [0] and deceleration [1]|
|0 MPRO_ANA0_SRamp|SPEED/s| |
|1 MPRO_ANA0_SRamp|SPEED/s| |

“Analog channel ISA00” parameters (continue)

|Index Name|Unit|Description|
|---|---|---|
|MPRO_ANA1_Scale| |ANA1: scale factors|
|0 MPRO_ANA1_TScale|Nm|ANA0: scale factor torque reference|
|1 MPRO_ANA1_SScale|rev/min|ANA0: scale factor speed reference|
|2 MPRO_ANA1_PScale|mDegree|ANA0: scale factor position reference|
|MPRO_ANA1_Offset| |ANA1: offsets|
|0 MPRO_ANA1_TOffset|Nm|ANA1: offsets for torque reference|
|1 MPRO_ANA1_SOffset|rev/min|ANA1: offsets for speed reference|
|2 MPRO_ANA1_POffset|mDegree|ANA1: offsets for position reference|
|MPRO_ANA1_Threshold| |ANA1: thresholds|
|0 MPRO_ANA1_TThreshold|Nm|ANA1: threshold for torque reference|
|1 MPRO_ANA1_SThreshold|rev/min|ANA1: threshold for speed reference|
|2 MPRO_ANA1_PThreshold|mDegree|ANA1: threshold for position reference|

“Analog channel ISA01” parameters

# 8 Motion profile

|ID|Index Name|Unit|Description|
|---|---|---|---|
|186|MPRO_ANA1_TRamp|Nm/s|ANA1: Torque mode acceleration [0] and deceleration[1]|
|186|MPRO_ANA1_TRamp|Nm/s| |
|187|MPRO_ANA1_SRamp|SPEED/s|ANA1: Speed mode acceleration [0] and deceleration [1]|
|187|MPRO_ANA1_SRamp|SPEED/s| |

# Table 8.27: “Analog channel ISA01” parameters (continue)

Display

- System state
- Initialization on device startup
- Not ready (DC link voltage possibly too low)
- Start inhibit (DC link voltage present, power stage off)
- Starting lockout
- Ready for start
- Control initialization: Auto commutation, flux build-up etc.

# Table 8.28: Central state machine according to CiA 402 device display

MOOG ID No.:CB40859-001 Date:11/2020

MSD ServoDrive - DeviceHelp 273

# 8 Motion profile

MOOG ID No.:CB40859-001 Date:11/2020

MSD ServoDrive - DeviceHelp 274

|Display|System state|power disabled|fault|
|---|---|---|---|
|Control enabled|0|Start|7|
| |fault reaction active|0|14|
|Quick stop active|1|not ready|8|
| |to switch on|1|17|
|Error reaction active|2|switch on|disabled|
| |2|7| |
|Error state (in this state the error is indicated directly on the display.)|3|ready to|switch on|
|Device is reset (display flashes)|power enabled|3|6|
| |10|12| |
|• Number [5.] flashes when “STO” (Safe Torque Off) input is active. Display goes out when STO inactive.| | | |
|• The dot on the display flashes when the power stage is active.| | | |

Table 8.28: Central state machine according to CiA 402 device display (continue)

NOTE

l The system states indicated on the display may differ from the states in the table depending on the drive profile setting.

Image 8.70: State machine diagram based on CANopen communications

⓪ to ① State number

1 to 17 State transition (No. 17: DC link voltage cut off)

Legend for “State machine diagram based on CANopen communications” figure

# 8.10 Touch probe

|ID|Index Name / Setting|
|---|---|
|241|0 MPRO_TP_Position|
|241|1 MPRO_TP_Position|
|241|2 MPRO_TP_Position|
|241|3 MPRO_TP_Position|
|241|4 MPRO_TP_Position|
|1400|0 MPRO_TP_Config|
| |TP_TP (0)|
| |AB (1)|
| |PD_UP (2)|
| |PD_DOWN (3)|
| |PC_PC (4)|
| |PC_TP (5)|
| |TP_PC (6)|
| |ENC_ENC (7)|
| |ENC_TP (8)|
| |TP_ENC (9)|

Using the touch probe inputs, touch probe functions can be performed. In order to be able to do this, P 106[0] - MPRO_INPUT_FS_ISD05 and P 107[0] - MPRO_INPUT_FS_ISD06 must be used to set digital inputs ISD05 and ISD06 to ""PROBE(15) = Touch probe (only ISD05/06)"" (see Section ""Digital inputs"" on page 290). HTL encoders can be evaluated or pulse counters implemented using the MSD PLC.

The touch probe can be triggered with P 240 - MPRO_TP_Ctrl. This enables triggering on a positive or negative edge, or on both edges, of the signal detected on the touch probe inputs. After the measurement, the parameter jumps back to the value ""NONE (0)"" and the latch position is mapped in the corresponding subindex of parameter P 241 - MPRO_TP_Position. A continuous touch probe mode is not possible at present, so the touch probe has to be reactivated after the measurement.

P 1402 - MPRO_TP_Channel can be used to select various positions as actual value sources of the latch position for the touch probe functionality. The following table provides an overview of the available settings. The counters are accessed via the MSD PLC or a bus system.

|ID|Index Name / Setting|Unit|Description|
|---|---|---|---|
|240|MPRO_TP_Ctrl|Touch probe: Control| |
| |0| |NONE (0) = No function|
| |1| |POS (1) = Positive edge|
| |2| |NEG (2) = Negative edge|
| |3| |BOTH (3) = Both edges|
|240|0 MPRO_TP_Ctrl| | |
|240|1 MPRO_TP_Ctrl| | |
|240|2 MPRO_TP_Ctrl| | |
|241|MPRO_TP_Position|Probe: Pos. high/low edge of TP0/1, encoder zero pulse| |

Table 8.29: “Touch probe” parameters

MOOG ID No.:CB40859-001 Date:11/2020

# 8 Motion profile

|Unit|Description|
|---|---|
|mDegree|Touch probe: Configuration|
|mDegree|TP0, TP1 touch probe|
|mDegree|TP0, TP1 as encoder, A/B as quadrature counting|
|mDegree|TP0, TP1 as encoder, pulse (TP0) / direction (TP1), count up on direction high|
|mDegree|TP0, TP1 as encoder, pulse (TP0) / direction (TP1), count down on direction high|
|mDegree|TP0 pulse counter, TP1 pulse counter|
|mDegree|TP0 pulse counter, TP1 touch probe|
|mDegree|TP1 touch probe, TP0 pulse counter|
|mDegree|TP0 encoder counter, TP1 encoder counter|
|mDegree|TP0 encoder counter, TP1 touch probe|
|mDegree|TP0 touch probe, TP1 encoder counter|

Touch probe: Channel

|Unit|Description|
|---|---|
|ACTPOS (0)|Actual position in user units|
|ACTPOSINC (1)|Actual position in increments|
|MASTERPOS (2)|Master position in increments|
|ENCPOS_CH1 (3)|Encoder position Channel 1|
|ENCPOS_CH1_INC (4)|Encoder position Channel 1 in increments|
|ENCPOS_CH2 (5)|Encoder position Channel 2|
|ENCPOS_CH2_INC (6)|Encoder position Channel 2 in increments|

# 8 Motion profile

MOOG ID No.:CB40859-001 Date:11/2020 MSD ServoDrive - DeviceHelp 276

|ID|Index Name / Setting|Unit|Description|
|---|---|---|---|
|7|ENCPOS_CH3 (7)| |Encoder position Channel 3|
|8|ENCPOS_CH3_INC (8)| |Encoder position Channel 3 in increments|
|9|ENCPOS_CH4 (9)| |Encoder position Channel 4|
|10|ENCPOS_CH4_INC (10)| |Encoder position Channel 4 in increments|
|11|ACTPOS2 (11)| |Actual position of redundant encoder in user units|
|12|Sercos (12)| |Referred to Sercos profile parameters S-x-0426, S-x-0427|
|13|UserRefPos(13)| |Reference position in user units|
|14|MasterPosST(14)| |Master position (ECAM, EGEAR) singleturn, always steps|
|15|CommonMasterPos(15)| |Master position (ECAM, EGEAR) singleturn, always steps|
|16|CommonMasterPosST(15)| |Master position (ECAM, EGEAR) singleturn, always steps|
|1402|MPRO_TP_Channel| | |
|1402|MPRO_TP_Channel| | |
|1402|MPRO_TP_Channel| | |
|1404|MPRO_TP_Lines| |Touch probe: Lines @ pulse counter on channel x|
|1404|MPRO_TP_Lines| | |
|1404|MPRO_TP_Lines| | |

Image 8.71: “Synchronized motion” screen

There are various modes available in the “synchronization mode” drop-down menu (P 242[0] - MPRO_ECAM_SyncModMode):

- Off(0) = Synchronized motion off
- ECAM_iPlc(1) = Electronic cam plate via MSD PLC
- EGEAR_iPlc(2) = Electr. gear unit via MSD PLC
- ECAM_PARA(3) = Electronic camming via parameters
- EGEAR_PARA(4) = Electronic gearing via parameters

NOTE: For more information refer to the bus system User Manuals or the description of the MSD PLC.

# 8.11.1 Electronic cam plate

The other parameters are configured in separate screens that can be accessed with the corresponding buttons.

- Master configuration (see Section ""Master configuration"" on page 280)
- Electronic gearing (see Section ""Electronic gearing"" on page 283)
- Electronic camming (see Section ""Electronic cam plate"" on page 277)

P 1318[0] - MPRO_ECAM_ControlWord is the control word for “synchronized motion” (see Section ""Control word for synchronized motion"" on page 279).

P 1326[0] - MPRO_ECAM_StatusWord is the status word for “synchronized motion” (see Section ""Status word for synchronized motion"" on page 279).

# 8.11.1.1 Table selection

|ID|Index Name|Unit|Description|
|---|---|---|---|
|1300|MPRO_ECAM_CTS_| |ECAM: CamTableSelect - Master reference|
|1301|MasterRef| | |
|1305|MPRO_ECAM_CTS_| |ECAM: CamTableSelect - Method for changing the camtable|
|1306|MPRO_ECAM_CTS_| |ECAM: CamTableSelect - Mode for changing the camtable|
|1307|MPRO_ECAM_CTS_|incr|ECAM: CamTableSelect - Distance for changing the camtable|
|242|MPRO_ECAM_| |ECAM / EGEAR: Mode of synchronized motion SyncModMode|
|265|MPRO_ECAM_| |ECAM / EGEAR: Slave speed factor (1 = 100%).|
|266|CamSlave_SpeedFactor| | |
|268|MPRO_ECAM_| |ECAM / EGEAR: Mode of switching off sync. motion|

# 8.11.1.2 Synchronization

|ID|Index Name|Unit|Description|
|---|---|---|---|
|1342|MPRO_ECAM_CI_|incr|ECAM: CamIn - Synchronization position (multiturn part)|
|1343|MPRO_ECAM_CO_|incr|ECAM: CamOut - Decoupling pos. (multiturn part)|
|1303|MPRO_ECAM_CI_|incr|ECAM: CamIn - Master offset|
|1308|MPRO_ECAM_CI_| |ECAM: CamIn - Master reference|
|1309|MPRO_ECAM_CI_| |ECAM: CamIn - Slave reference|
|1310|MPRO_ECAM_CI_| |ECAM: CamIn - Coupling mode|
|1311|MPRO_ECAM_CI_|incr|ECAM: CamIn - Coupling distance|
|1312|MPRO_ECAM_CI_|incr|ECAM: CamIn - Synchronization position|

Table 8.31: “Electronic camming - Table selection” parameters

Table 8.30: “Synchronized motion” parameters

Table 8.32: “Electronic camming - Synchronization” parameters

MOOG ID No.:CB40859-001 Date:11/2020

MSD ServoDrive - DeviceHelp 277

# 8 Motion profile

MOOG ID No.:CB40859-001 Date:11/2020 MSD ServoDrive - DeviceHelp 278

|ID|Index|Name|Unit|Description|
|---|---|---|---|---|
|1313|0|MPRO_ECAM_CO_SyncPosST|(singleturn part)|ECAM: CamOut - Slave reference|
|1314|0|MPRO_ECAM_CO_DecouplingMode|63|ECAM: CamOut - Decoupling mode|
|1315|0|MPRO_ECAM_CO_BreakingPosST|incr|ECAM: CamOut - Decoupling position|
|1316|0|MPRO_ECAM_CO_DecouplingDist|incr|ECAM: CamOut - Decoupling distance|
|1317|0|MPRO_ECAM_CO_StandstillPos|mDegree|ECAM: CamOut - Slave standstill position|

# Table 8.32: “Electronic camming - Synchronization” parameters (continue)

|ID|Index|Name|Unit|Description|
|---|---|---|---|---|
|1346| |MPRO_ECAM_SP_Table| |ECAM: Setpoint table interface|
|1346|0|Index| |Index of setpoint table|
|1346|1|Value| |Value at index of setpoint table|
|1347|0 to 31|MPRO_ECAM_SP_Index| |ECAM: Setpoint segments start index|
|1348|0 to 31|MPRO_ECAM_SP_Length| |ECAM: Setpoint segments length|
|1349|0 to 31|Length| | |
|1350|0|MPRO_ECAM_SP_MaDist| |ECAM: Setpoint segments master distance|
|1351|0|MPRO_ECAM_SP_IpoType| |ECAM: Setpoint segments interpolation type|
|1352|0 to 31|Checksum| |ECAM: Setpoint table checksum|
|1353|0 to 31|GainNum| |ECAM: Setpoint segments gain numerator|
| | |GainDen| |ECAM: Setpoint segments gain denominator|

# Table 8.33: “Electronic camming - Table segments” parameters

|ID|Index|Name|Unit|Description|
|---|---|---|---|---|
|1329|0 to 63|MPRO_ECAM_SegData_IndexNext| |ECAM: Index of the following segment|
|1330|0 to 63|MPRO_ECAM_SegData_IndexPrev| |ECAM: Index of the previous segment|
|1331|0 to 63|MPRO_ECAM_SegData_ProfileMode| |ECAM: Profile mode of the current segment|
|1332|0 to 63|MPRO_ECAM_SegData_DistMaster| |ECAM: Length of the master section of the current segment|
|1333|0 to 63|MPRO_ECAM_SegData_DistSlave| |ECAM: Length of the slave section of the current segment|
|1334|0 to 63|MPRO_ECAM_SegData_Lambda| |ECAM: Lambda value of the current segment|
|1335|0 to 63|MPRO_ECAM_SegData_StatusWord| |ECAM: Status word of the current segment|
|1336|0 to 63|MPRO_ECAM_SegData_ControlWord| |ECAM: Control word of the current segment|

# 8.11.2 Control word for synchronized motion

|Bit|Function|PLC function|Bit number|Description|
|---|---|---|---|---|
|0-7|Start segment (8-bit value)|-|0-7|Actual segment (8-bit value)|
|8-15|Reserved|-| |Actual ECAM / EGEAR state machine state (4 Bit value)|
|16|Absolute (true) / relative (false) master relationship|-| |- 0: ECAM / EGEAR asynchronous
- 1: ECAM / EGEAR synchronous
|
|17|Absolute (true) / relative (false) master (CAM) relationship at cam in|-| |- 2: ECAM / EGEAR synchronizing
- 3: ECAM / EGEAR desynchronizing
|
|18|Absolute (true) / relative (false) slave (CAM) relationship at cam in|-| |- 4: ECAM / EGEAR active and waiting for going asynchronous
|
|19-23|Reserved|-| |- 5: ECAM / EGEAR inactive and waiting for going synchronous
|
|24|Change gear ratio of the electronic gear online|MCB_GearRatioChange| | |
|25|Disable master calculation|MCB_Cam_MasterEnable| | |
|26|Enable master calculation|MCB_Cam_MasterEnable| | |
|27|Select CAM table|MCB_CamTableSelect| | |
|28|Start Ecam|MCB_CamIn| | |
|29|Stop Ecam|MCB_CamOut| | |
|30|Start Egear|MCB_GearIn| | |
|31|Stop Egear|MCB_GearOut| | |

# 8.11.3 Status word for synchronized motion

|Bit|Function|PLC function|Bit number|Description|
|---|---|---|---|---|
|12-26|Reserved|-| | |
|27|ECAM / EGEAR is active|-| | |
|28|Valid segments chosen|-| | |
|29|Master data are valid|-| | |
|30|Master is initialized|-| | |
|31|Master calculation is active|-| | |

Table 8.35: Control word ECAM (P 1318[0] - MPRO_ECAM_ControlWord)

Table 8.36: ECAM status word (P 1326[0] - MPRO_ECAM_StatusWord)

MOOG ID No.:CB40859-001 Date:11/2020 MSD ServoDrive - DeviceHelp 279

# 8 Motion profile

# 8 Motion profile

MOOG ID No.:CB40859-001 Date:11/2020

MSD ServoDrive - DeviceHelp 280

# 8.11.4 Master configuration

the master encoder, you will need to set the resolution relative to a single motor revolution in P 250 - MPRO_ECAM_PARAMaster_Amplitude (see below).

- ENC CH1 (3) = Encoder channel 1 X7 (Sin/Cos)
- ENC CH2 (4) = Encoder channel 2 X6 (Resolver)
- ENC CH3 (5) = Encoder channel 3 X8 (optional)

This function is only available if an external interface X8 (option module) is present.

- TP0 (6) = Pulse counter on probe channel 0 (TP0)
- TP1 (7) = Pulse counter on probe channel 1 (TP1)
- ENC_CH4 (8) = Encoder channel 4 (p. e. fieldbus)
- TWIN_POS (9) = TWIN remote reference position (P-2607)

Image 8.72: “Master configuration” screen

# Channel selection (master encoder)

P 1319[0] - MPRO_ECAM_CamMaster_AxisType is used to define the master encoder.

- NO AXIS (0) = No axis
- VIRTUAL MASTER (1) = Virtual master

If you select this function, you will be able to configure additional settings by clicking on the enabled “Options...” button (see Section ""Virtual Master"" on page 286).

- PARA (2) = Master parameter interface

If you select this function because a higher-level controller is being used as

# Anti-reverse mode

Slave only starts moving along with it again as soon as the master reaches the zero position.

P 1320[0] - MPRO_ECAM_CamMaster_RevLockMode is used to define the reverse lock mode, which can be used either with or without path compensation. The dashed lines in the following diagrams indicate what the engagement distance is:

# Example:

If the master, which has moved two motor revolutions in the direction blocked for the slave, then moves in the unblocked direction again, the slave only moves off when the master has traversed the zero point.

- INACTIVE (0) = Reverse lock inactive
- ACTIVE (2) = Reverse lock enabled - without path optimization
- ACTIVE WAY COMP (1) = Reverse lock active - with way compensation

While the slave accelerates to the speed of the master during engagement, the master and slave do not move synchronously. This function needs to be selected in order to quickly catch up to the master that is running ahead.

# Example:

- Master (black line) rotates in the blocked direction
- The slave (blue line) remains stopped
- Master rotates in the unblocked direction again
- The slave follows the master directly in the unblocked direction

Assume the master has moved two motor revolutions in the direction for which the slave lock is enabled. If the master now moves in the direction for which there is no lock, the slave will immediately start running in that direction.

MOOG ID No.:CB40859-001 Date:11/2020

MSD ServoDrive - DeviceHelp 281

# 8 Motion profile

MOOG ID No.:CB40859-001 Date:11/2020 MSD ServoDrive - DeviceHelp 282

|Filter type|ID|Index Name|Unit|Description|
|---|---|---|---|---|
|When using a real master encoder, encoder signals may be subject to noise.|P 1340|1319|0|MPRO_ECAM_CamMaster_AxisType|
| | |MPRO_ECAM_CamMaster_SpeedFilTyp| |ECAM / EGEAR: Channel selection of internal master input|
| | |1320|0|MPRO_ECAM_CamMaster_RevLockMode|
| | |1321|0|MPRO_ECAM_CamMaster_Amplitude|
| | |1322|0|MPRO_ECAM_CamMaster_GearNum|
| | |1323|0|MPRO_ECAM_CamMaster_GearDen|
|Filter time|1327|0|ms|ECAM / EGEAR: Filter time constant of master|
|If P 1340[0] is used to enable a filter, P 1327[0] - MPRO_ECAM_CamMaster_SpeedTFil can be used to define the corresponding filter time.|1328|0|speed|ECAM / EGEAR: Speed factor of the internal master|
|Speed factor|1340|0| |MPRO_ECAM_CamMaster_SpeedFilTyp|
|The master encoder can be assigned an additional speed factor P 1328[0] - MPRO_ECAM_CamMaster_SpeedFactor.|1341|0|incr|ECAM / EGEAR: Master drive offset|

Table 8.37: “Synchronized motion - Master configuration” parameters (continue)

| | | |ID|Index Name|Unit|Description|
|---|---|---|---|---|---|---|
|247|0|MPRO_ECAM_ParaMaster_ActPos|incr|ECAM / EGEAR: Parameter interface master position| | |
|248|0|MPRO_ECAM_ParaMaster_ActSpeed|rpm|ECAM / EGEAR: Parameter interface master speed| | |
|249|0|MPRO_ECAM_ParaMaster_ActAcc|rpm|ECAM / EGEAR: Parameter interface master acceleration| | |
| |250|0|MPRO_ECAM_ParaMaster_Amplitude| |ECAM / EGEAR: Parameter interface master amplitude| |

Table 8.37: “Synchronized motion - Master configuration” parameters

# 8.11.5 Electronic gearing

# Gear ratio

The gear ratio is specified as a fraction. This ensures that the position references can be translated to the motor shaft with no rounding error.

- ""Slave"" (P 252[0] - MPRO_ECAM_Egear_GearNum) is the numerator
- ""Master"" (P 251[0] - MPRO_ECAM_Egear_GearDen) is the denominator

# Scaling of speed pre-control

Defined with P 265[0] - MPRO_ECAM_CamSlave_SpeedFactor definiert.

# Scaling of torque pre-control

Defined with P 266[0] - MPRO_ECAM_CamSlave_TorqueFactor.

# Engagement

See Section ""Engagement"" on page 284.

# Disengagement

See Section ""Disengagement"" on page 285.

|ID|Index Name|Unit|Description|
|---|---|---|---|
|251|0 MPRO_ECAM_Egear_GearDen| |EGEAR: Gear denominator|
|252|0 MPRO_ECAM_Egear_GearNum| |EGEAR: Numerator of gear ratio|
|1344|0 MPRO_ECAM_Egear_LimRefAcc|rpm/s|EGEAR: Acceleration limit for reference|
|1345|0 MPRO_ECAM_Egear_LimRefJerk|rpm/s²|EGEAR: Jerk limit for reference|

Table 8.38: “Synchronized motion - Electronic gearing” parameters

Image 8.73: ""Electronic gearing"" screen

MOOG ID No.:CB40859-001 Date:11/2020 MSD ServoDrive - DeviceHelp 283

# 8 Motion profile

# 8 Motion profile

MOOG ID No.:CB40859-001 Date:11/2020

MSD ServoDrive - DeviceHelp 284

# 8.11.6 Engagement

used to define the engagement distance (between the dashed lines).

P 253[0] - MPRO_ECAM_Egear_GearInMode is used to define the mode for engagement.

- DIRECT (0) = Direct
- Direct engagement: Angular synchronous; with jerking (no ramps).
- CROSSFADE (3) = Crossfading
- Engagement with crossfading function (5th degree polynomial): Angular synchronous; jerk-limited; speed will overshoot during engagement.
- RAMP (1) = Linear speed ramp
- Engagement with linear acceleration: Not angular synchronous; with jerking.
- FADE (2) = Engagement fade-out
- Engagement with fade-in function (5th degree polynomial): Not angular synchronous; jerk-limited. The position is ignored. ",What is the purpose of the offset parameter in the analog channels ISA00 and ISA01 according to the 'MSD ServoDrive - DeviceHelp' document?,A1,The offset parameter compensates for component variations and is used for offset compensation.,2.421875,2.34375,3.765625,1.4296875,0.427734375
36,msd_servo_drive.txt,76,b87ca5e232c2bdbb6fa16a8a401c6b5d285dc0183e73cc9d134de13dd2fc71d2,"MOOG ID No.:CB40859-001 Date:11/2020

MSD ServoDrive - DeviceHelp 267

# 8 Motion profile

MOOG ID No.:CB40859-001 Date:11/2020 MSD ServoDrive - DeviceHelp 268

# Deceleration

With ...

- P 194 - MPRO_TAB_TDec (for torque control) or
- P 197 - MPRO_TAB_SDec (for speed control) or
- P 200 - MPRO_TAB_PDec (for position control)

and indexes 0–15, the deceleration for each individual motion task can be defined. The input must not be zero.

# Wait time in Auto mode

P 204 - MPRO_TAB_WaitTime is used to define the wait time before the next motion task is carried out.

# Maximum table index in Auto mode

P 206[0] - MPRO_Tab_MaxIdx is used to define the table index up to which driving jobs will be carried out in one of the auto modes.

# Current table index

P 207[0] - MPRO_Tab_ActIdx will show the index for the motion task that is currently active. If parameter P 205 MPRO_TAB_Mode is set to “Para(0)”, a driving set can be entered and approached directly.

# Activation of reference table

The following procedures can be used in order to activate the setpoint table for operation.

|ID|Index Name|Unit|Description|
|---|---|---|---|
|193|MPRO_TAB_TAcc|TAB: Torque mode acceleration|Nm/ms|
|193|0|MPRO_TAB_TAcc|Nm/ms|
|193|1 - 15|MPRO_TAB_TAcc|Nm/ms|
|194|MPRO_TAB_TDec|TAB: Torque mode deceleration| |
|194|0|MPRO_TAB_TDec|Nm/ms|
|194|1 - 15|MPRO_TAB_TDec|Nm/ms|

# Table 8.23: Activation of table references

# Table 8.24: “Setpoint table settings” parameters

# Table 8.24: “Setpoint table settings” parameters (continue)

|ID|Index Name|Unit|Description|ID|Index Name|Unit|Description|
|---|---|---|---|---|---|---|---|
|195|MPRO_TAB_TRef|Nm|TAB: Torque mode reference value|208|MPRO_TAB_OutputNo| |OSD TAB: actual table index and target|
|195|MPRO_TAB_TRef|Nm| |208|MPRO_TAB_OutputNo| | |
|196|MPRO_TAB_SAcc|rev/min/s|TAB: Speed mode acceleration|269|MPRO_TAB_Ctrl| |TAB: control word|
|196|MPRO_TAB_SAcc|rev/min/s| | | | | |
|197|MPRO_TAB_SDec|rev/min/s|TAB: Speed mode deceleration| | | | |
|197|MPRO_TAB_SDec|rev/min/s| | | | | |
|198|MPRO_TAB_SRef|rev/min|TAB: Speed mode reference value| | | | |
|198|MPRO_TAB_SRef|rev/min| | | | | |
|199|MPRO_TAB_PAcc|rev/min/s|TAB: Position control mode acceleration| | | | |
|199|MPRO_TAB_PAcc|rev/min/s| | | | | |
|200|MPRO_TAB_PDec|rev/min/s|TAB: Position control mode Acceleration| | | | |
|200|MPRO_TAB_PDec|rev/min/s| | | | | |
|201|MPRO_TAB_PSpd|rev/min|TAB: Position control mode speed| | | | |
|201|MPRO_TAB_PSpd|rev/min| | | | | |
|202|MPRO_TAB_PPos|mDegree|TAB: Position control mode reference value| | | | |
|202|MPRO_TAB_PPos|mDegree| | | | | |
|203|MPRO_TAB_PMode| |Position control table:Mode| | | | |
|203|MPRO_TAB_PMode| | | | | | |
|204|MPRO_TAB_WaitTime|ms|TAB: Wait time| | | | |
|204|MPRO_TAB_WaitTime|ms| | | | | |
|205|MPRO_TAB_Mode| |TAB mode| | | | |
|206|MPRO_Tab_MaxIdx| |TAB: Max index in AUTO mode| | | | |
|207|MPRO_TAB_ActIdx| |TAB: Actual index| | | | |

MOOG ID No.:CB40859-001 Date:11/2020

MSD ServoDrive - DeviceHelp

# 8 Motion profile

MOOG ID No.:CB40859-001 Date:11/2020

MSD ServoDrive - DeviceHelp 270

# 8.8 Analog channel (ISA00 und ISA01)

# Offset (O)

This parameter (P 174 - MPRO_ANA0_SOffset for ISA00, P 184 - MPRO_ANA1_SOffset for ISA01) compensates for component variations and is used for offset compensation purposes. Depending on the control mode being used (see Section ""Basic settings"" on page 110), the value will be stored in parameter index [0] (torque control), [1] (speed control) or [2] (position control).

# Backlash (B)

This parameter (P 175 - MPRO_ANA0_SThreshold for ISA00, P 185 - MPRO_ANA1_SThreshold for ISA01) can suppress axis motion close to the standstill (stop) position. Depending on the control mode being used (see Section ""Basic settings"" on page 110), the value will be stored in parameter index [0] (torque control), [1] (speed control) or [2] (position control).

Image 8.68: “Analog channel” screen

# Acceleration ramp

Two standard analog inputs (ISA00, ISA01) are available. These inputs can be configured...

- with negative values for analog setpoint settings
- with positive values for digital setpoint processing

(P 109[0] - MPRO_INPUT_FS_ISA00 and P 110[0] - MPRO_INPUT_FS_ISA01).

see also section ""Analog Inputs"" on page 303. By using the ""REV(-2) = Analog setpoint"" setting, an analog input voltage of ±10 V can be processed as a setpoint.

# Deceleration ramp

This parameter serves as a deceleration ramp for torque control (P 176[1] - MPRO_ANA0_TRamp for ISA00, P 186[1] - MPRO_ANA1_TRamp for ISA01) or speed control (P 177[1] - MPRO_ANA0_SRamp for ISA00, P 187[1] - MPRO_ANA1_SRamp for ISA01). Depending on the control mode being used (see Section ""Basic settings"" on page 110), the value will be stored in parameter index [0] (torque control), [1] (speed control) or [2] (position control).

This parameter (P 173 - MPRO_ANA0_Scale for ISA00, P 183 - MPRO_ANA1_Scale for ISA01) is used to define which speed / which torque / which position corresponds to the maximum analog value. Depending on the control mode being used (see Section ""Basic settings"" on page 110), the value will be stored in parameter index [0] (torque control), [1] (speed control) or [2] (position control).

# 8.8.1 Special characteristics of position control mode

A threshold value can also be specified which generates a run-on range around the last reference value. A ramp function calculates a motion profile for the position reference from pre-defined acceleration and speed limits.

The position references on the analog channel are not applied immediately, but dependent on a digital input. Accordingly, one of the ISD00 to ISD06 digital inputs must be set to a value of ""REFANAEN(28) = Enable analog reference value"" (see Section ""Digital inputs"" on page 290). The position setpoint being received will only be applied if the corresponding digital input is active. The acceleration is entered using P 173[0] - MPRO_ANA0_TScale or P 183[0] - MPRO_ANA1_TScale.

# 8.8.2 Wire Break Monitoring

P 399 - CON_ANAWireBrk_Th can be used to configure wire break monitoring for the analog inputs. For details see Section ""Wire Break Monitoring"" on page 306.

|Function|TLIM (-4)|OVR (-3)|REFV (-2)|leer (-1)|OFF (0)|
|---|---|---|---|---|---|
|Digital|(1)-(28)|(1)-(28)|(1)-(28)|(1)-(28)|(1)-(28)|
|Analog channel|Filter|Scale|Offset|Profile|generator|

Control

Image 8.69: Reference processing structure

MOOG ID No.:CB40859-001 Date:11/2020

MSD ServoDrive - DeviceHelp 271

# 8 Motion profile

# 8 Motion profile

MOOG ID No.:CB40859-001 Date:11/2020

|ID|Index Name|Unit|Description|ID|
|---|---|---|---|---|
|395|CON_ANA_Isaf_Scaled| |Analog inputs: Values (filt, norm, comp, scaled)|174|
|395|0 ISA00| |Scaled, compensated, filtered, normalized value|175|
|395|1 ISA01| |Scaled, compensated, filtered, normalized value| |
|396|CON_ANA_Scale_ThUpper| |Analog inputs: Upper scaling limits|175|
|396|0 ISA00|%|Upper scaling (@ 10 V) threshold|175|
|396|1 ISA01|%|Upper scaling (@ 10 V) threshold| |
|397|CON_ANA_Scale_ThZero| |Analog inputs: Zero scaling thresholds|176|
|397|0 ISA00|V|Zero scaling threshold (+/-)|176|
|397|1 ISA01|V|Zero scaling threshold (+/-)| |
|398|CON_ANA_Scale_ThLower| |Analog inputs: Lower scaling limits|177|
|398|0 ISA00|%|Lower scaling (@ zero threshold) threshold|177|
|398|1 ISA01|%|Lower scaling (@ zero threshold) threshold| |
|399|CON_ANA_WireBrk_Th| |Analog inputs: Wire break thresholds|Table 8.26:|
|399|0 ISA00|V|Wire break detection threshold| |
|399|1 ISA01|V|Wire break detection threshold| |
|405|0 CON_ANA_Filt0|ms|Analog input ISA00: Filter time constant (PT 1)|ID|
|408|CON_ANA_Isaf_Norm| |Analog inputs: Values (filt, norm)|183|
|408|0 ISA00| |Filtered, normalized value|183|
|408|1 ISA01| |Filtered, normalized value|183|

Table 8.25: “Analog channel” parameters

|ID|Index Name|Unit|Description|ID|
|---|---|---|---|---|
|173|MPRO_ANA0_Scale| |ANA0: scale factors|184|
|173|0 MPRO_ANA0_TScale|Nm|ANA0: scale factor torque reference|185|
|173|1 MPRO_ANA0_SScale|rev/min|ANA0: scale factor speed reference|185|
|173|2 MPRO_ANA0_PScale|mDegree|ANA0: scale factor position reference| |
|174|MPRO_ANA0_Offset| |ANA0: offsets|185|
|174|0 MPRO_ANA0_TOffset|Nm|ANA0: offsets for torque reference|185|

Table 8.26: “Analog channel ISA00” parameters

|Index Name|Unit|Description|
|---|---|---|
|1 MPRO_ANA0_SOffset|rev/min|ANA0: offsets for speed reference|
|2 MPRO_ANA0_POffset|mDegree|ANA0: offsets for position reference|
|MPRO_ANA0_Threshold| |ANA0: thresholds|
|0 MPRO_ANA0_TThreshold|Nm|ANA0: threshold for torque reference|
|1 MPRO_ANA0_SThreshold|rev/min|ANA0: threshold for speed reference|
|2 MPRO_ANA0_PThreshold|mDegree|ANA0: threshold for position reference|
|MPRO_ANA0_TRamp| |ANA0: Torque mode acceleration [0] and deceleration [1]|
|0 MPRO_ANA0_TRamp|Nm/s| |
|1 MPRO_ANA0_TRamp|Nm/s| |
|MPRO_ANA0_SRamp| |ANA0: Speed mode acceleration [0] and deceleration [1]|
|0 MPRO_ANA0_SRamp|SPEED/s| |
|1 MPRO_ANA0_SRamp|SPEED/s| |

“Analog channel ISA00” parameters (continue)

|Index Name|Unit|Description|
|---|---|---|
|MPRO_ANA1_Scale| |ANA1: scale factors|
|0 MPRO_ANA1_TScale|Nm|ANA0: scale factor torque reference|
|1 MPRO_ANA1_SScale|rev/min|ANA0: scale factor speed reference|
|2 MPRO_ANA1_PScale|mDegree|ANA0: scale factor position reference|
|MPRO_ANA1_Offset| |ANA1: offsets|
|0 MPRO_ANA1_TOffset|Nm|ANA1: offsets for torque reference|
|1 MPRO_ANA1_SOffset|rev/min|ANA1: offsets for speed reference|
|2 MPRO_ANA1_POffset|mDegree|ANA1: offsets for position reference|
|MPRO_ANA1_Threshold| |ANA1: thresholds|
|0 MPRO_ANA1_TThreshold|Nm|ANA1: threshold for torque reference|
|1 MPRO_ANA1_SThreshold|rev/min|ANA1: threshold for speed reference|
|2 MPRO_ANA1_PThreshold|mDegree|ANA1: threshold for position reference|

“Analog channel ISA01” parameters

# 8 Motion profile

|ID|Index Name|Unit|Description|
|---|---|---|---|
|186|MPRO_ANA1_TRamp|Nm/s|ANA1: Torque mode acceleration [0] and deceleration[1]|
|186|MPRO_ANA1_TRamp|Nm/s| |
|187|MPRO_ANA1_SRamp|SPEED/s|ANA1: Speed mode acceleration [0] and deceleration [1]|
|187|MPRO_ANA1_SRamp|SPEED/s| |

# Table 8.27: “Analog channel ISA01” parameters (continue)

Display

- System state
- Initialization on device startup
- Not ready (DC link voltage possibly too low)
- Start inhibit (DC link voltage present, power stage off)
- Starting lockout
- Ready for start
- Control initialization: Auto commutation, flux build-up etc.

# Table 8.28: Central state machine according to CiA 402 device display

MOOG ID No.:CB40859-001 Date:11/2020

MSD ServoDrive - DeviceHelp 273

# 8 Motion profile

MOOG ID No.:CB40859-001 Date:11/2020

MSD ServoDrive - DeviceHelp 274

|Display|System state|power disabled|fault|
|---|---|---|---|
|Control enabled|0|Start|7|
| |fault reaction active|0|14|
|Quick stop active|1|not ready|8|
| |to switch on|1|17|
|Error reaction active|2|switch on|disabled|
| |2|7| |
|Error state (in this state the error is indicated directly on the display.)|3|ready to|switch on|
|Device is reset (display flashes)|power enabled|3|6|
| |10|12| |
|• Number [5.] flashes when “STO” (Safe Torque Off) input is active. Display goes out when STO inactive.| | | |
|• The dot on the display flashes when the power stage is active.| | | |

Table 8.28: Central state machine according to CiA 402 device display (continue)

NOTE

l The system states indicated on the display may differ from the states in the table depending on the drive profile setting.

Image 8.70: State machine diagram based on CANopen communications

⓪ to ① State number

1 to 17 State transition (No. 17: DC link voltage cut off)

Legend for “State machine diagram based on CANopen communications” figure

# 8.10 Touch probe

|ID|Index Name / Setting|
|---|---|
|241|0 MPRO_TP_Position|
|241|1 MPRO_TP_Position|
|241|2 MPRO_TP_Position|
|241|3 MPRO_TP_Position|
|241|4 MPRO_TP_Position|
|1400|0 MPRO_TP_Config|
| |TP_TP (0)|
| |AB (1)|
| |PD_UP (2)|
| |PD_DOWN (3)|
| |PC_PC (4)|
| |PC_TP (5)|
| |TP_PC (6)|
| |ENC_ENC (7)|
| |ENC_TP (8)|
| |TP_ENC (9)|

Using the touch probe inputs, touch probe functions can be performed. In order to be able to do this, P 106[0] - MPRO_INPUT_FS_ISD05 and P 107[0] - MPRO_INPUT_FS_ISD06 must be used to set digital inputs ISD05 and ISD06 to ""PROBE(15) = Touch probe (only ISD05/06)"" (see Section ""Digital inputs"" on page 290). HTL encoders can be evaluated or pulse counters implemented using the MSD PLC.

The touch probe can be triggered with P 240 - MPRO_TP_Ctrl. This enables triggering on a positive or negative edge, or on both edges, of the signal detected on the touch probe inputs. After the measurement, the parameter jumps back to the value ""NONE (0)"" and the latch position is mapped in the corresponding subindex of parameter P 241 - MPRO_TP_Position. A continuous touch probe mode is not possible at present, so the touch probe has to be reactivated after the measurement.

P 1402 - MPRO_TP_Channel can be used to select various positions as actual value sources of the latch position for the touch probe functionality. The following table provides an overview of the available settings. The counters are accessed via the MSD PLC or a bus system.

|ID|Index Name / Setting|Unit|Description|
|---|---|---|---|
|240|MPRO_TP_Ctrl|Touch probe: Control| |
| |0| |NONE (0) = No function|
| |1| |POS (1) = Positive edge|
| |2| |NEG (2) = Negative edge|
| |3| |BOTH (3) = Both edges|
|240|0 MPRO_TP_Ctrl| | |
|240|1 MPRO_TP_Ctrl| | |
|240|2 MPRO_TP_Ctrl| | |
|241|MPRO_TP_Position|Probe: Pos. high/low edge of TP0/1, encoder zero pulse| |

Table 8.29: “Touch probe” parameters

MOOG ID No.:CB40859-001 Date:11/2020

# 8 Motion profile

|Unit|Description|
|---|---|
|mDegree|Touch probe: Configuration|
|mDegree|TP0, TP1 touch probe|
|mDegree|TP0, TP1 as encoder, A/B as quadrature counting|
|mDegree|TP0, TP1 as encoder, pulse (TP0) / direction (TP1), count up on direction high|
|mDegree|TP0, TP1 as encoder, pulse (TP0) / direction (TP1), count down on direction high|
|mDegree|TP0 pulse counter, TP1 pulse counter|
|mDegree|TP0 pulse counter, TP1 touch probe|
|mDegree|TP1 touch probe, TP0 pulse counter|
|mDegree|TP0 encoder counter, TP1 encoder counter|
|mDegree|TP0 encoder counter, TP1 touch probe|
|mDegree|TP0 touch probe, TP1 encoder counter|

Touch probe: Channel

|Unit|Description|
|---|---|
|ACTPOS (0)|Actual position in user units|
|ACTPOSINC (1)|Actual position in increments|
|MASTERPOS (2)|Master position in increments|
|ENCPOS_CH1 (3)|Encoder position Channel 1|
|ENCPOS_CH1_INC (4)|Encoder position Channel 1 in increments|
|ENCPOS_CH2 (5)|Encoder position Channel 2|
|ENCPOS_CH2_INC (6)|Encoder position Channel 2 in increments|

# 8 Motion profile

MOOG ID No.:CB40859-001 Date:11/2020 MSD ServoDrive - DeviceHelp 276

|ID|Index Name / Setting|Unit|Description|
|---|---|---|---|
|7|ENCPOS_CH3 (7)| |Encoder position Channel 3|
|8|ENCPOS_CH3_INC (8)| |Encoder position Channel 3 in increments|
|9|ENCPOS_CH4 (9)| |Encoder position Channel 4|
|10|ENCPOS_CH4_INC (10)| |Encoder position Channel 4 in increments|
|11|ACTPOS2 (11)| |Actual position of redundant encoder in user units|
|12|Sercos (12)| |Referred to Sercos profile parameters S-x-0426, S-x-0427|
|13|UserRefPos(13)| |Reference position in user units|
|14|MasterPosST(14)| |Master position (ECAM, EGEAR) singleturn, always steps|
|15|CommonMasterPos(15)| |Master position (ECAM, EGEAR) singleturn, always steps|
|16|CommonMasterPosST(15)| |Master position (ECAM, EGEAR) singleturn, always steps|
|1402|MPRO_TP_Channel| | |
|1402|MPRO_TP_Channel| | |
|1402|MPRO_TP_Channel| | |
|1404|MPRO_TP_Lines| |Touch probe: Lines @ pulse counter on channel x|
|1404|MPRO_TP_Lines| | |
|1404|MPRO_TP_Lines| | |

Image 8.71: “Synchronized motion” screen

There are various modes available in the “synchronization mode” drop-down menu (P 242[0] - MPRO_ECAM_SyncModMode):

- Off(0) = Synchronized motion off
- ECAM_iPlc(1) = Electronic cam plate via MSD PLC
- EGEAR_iPlc(2) = Electr. gear unit via MSD PLC
- ECAM_PARA(3) = Electronic camming via parameters
- EGEAR_PARA(4) = Electronic gearing via parameters

NOTE: For more information refer to the bus system User Manuals or the description of the MSD PLC.

# 8.11.1 Electronic cam plate

The other parameters are configured in separate screens that can be accessed with the corresponding buttons.

- Master configuration (see Section ""Master configuration"" on page 280)
- Electronic gearing (see Section ""Electronic gearing"" on page 283)
- Electronic camming (see Section ""Electronic cam plate"" on page 277)

P 1318[0] - MPRO_ECAM_ControlWord is the control word for “synchronized motion” (see Section ""Control word for synchronized motion"" on page 279).

P 1326[0] - MPRO_ECAM_StatusWord is the status word for “synchronized motion” (see Section ""Status word for synchronized motion"" on page 279).

# 8.11.1.1 Table selection

|ID|Index Name|Unit|Description|
|---|---|---|---|
|1300|MPRO_ECAM_CTS_| |ECAM: CamTableSelect - Master reference|
|1301|MasterRef| | |
|1305|MPRO_ECAM_CTS_| |ECAM: CamTableSelect - Method for changing the camtable|
|1306|MPRO_ECAM_CTS_| |ECAM: CamTableSelect - Mode for changing the camtable|
|1307|MPRO_ECAM_CTS_|incr|ECAM: CamTableSelect - Distance for changing the camtable|
|242|MPRO_ECAM_| |ECAM / EGEAR: Mode of synchronized motion SyncModMode|
|265|MPRO_ECAM_| |ECAM / EGEAR: Slave speed factor (1 = 100%).|
|266|CamSlave_SpeedFactor| | |
|268|MPRO_ECAM_| |ECAM / EGEAR: Mode of switching off sync. motion|

# 8.11.1.2 Synchronization

|ID|Index Name|Unit|Description|
|---|---|---|---|
|1342|MPRO_ECAM_CI_|incr|ECAM: CamIn - Synchronization position (multiturn part)|
|1343|MPRO_ECAM_CO_|incr|ECAM: CamOut - Decoupling pos. (multiturn part)|
|1303|MPRO_ECAM_CI_|incr|ECAM: CamIn - Master offset|
|1308|MPRO_ECAM_CI_| |ECAM: CamIn - Master reference|
|1309|MPRO_ECAM_CI_| |ECAM: CamIn - Slave reference|
|1310|MPRO_ECAM_CI_| |ECAM: CamIn - Coupling mode|
|1311|MPRO_ECAM_CI_|incr|ECAM: CamIn - Coupling distance|
|1312|MPRO_ECAM_CI_|incr|ECAM: CamIn - Synchronization position|

Table 8.31: “Electronic camming - Table selection” parameters

Table 8.30: “Synchronized motion” parameters

Table 8.32: “Electronic camming - Synchronization” parameters

MOOG ID No.:CB40859-001 Date:11/2020

MSD ServoDrive - DeviceHelp 277

# 8 Motion profile

MOOG ID No.:CB40859-001 Date:11/2020 MSD ServoDrive - DeviceHelp 278

|ID|Index|Name|Unit|Description|
|---|---|---|---|---|
|1313|0|MPRO_ECAM_CO_SyncPosST|(singleturn part)|ECAM: CamOut - Slave reference|
|1314|0|MPRO_ECAM_CO_DecouplingMode|63|ECAM: CamOut - Decoupling mode|
|1315|0|MPRO_ECAM_CO_BreakingPosST|incr|ECAM: CamOut - Decoupling position|
|1316|0|MPRO_ECAM_CO_DecouplingDist|incr|ECAM: CamOut - Decoupling distance|
|1317|0|MPRO_ECAM_CO_StandstillPos|mDegree|ECAM: CamOut - Slave standstill position|

# Table 8.32: “Electronic camming - Synchronization” parameters (continue)

|ID|Index|Name|Unit|Description|
|---|---|---|---|---|
|1346| |MPRO_ECAM_SP_Table| |ECAM: Setpoint table interface|
|1346|0|Index| |Index of setpoint table|
|1346|1|Value| |Value at index of setpoint table|
|1347|0 to 31|MPRO_ECAM_SP_Index| |ECAM: Setpoint segments start index|
|1348|0 to 31|MPRO_ECAM_SP_Length| |ECAM: Setpoint segments length|
|1349|0 to 31|Length| | |
|1350|0|MPRO_ECAM_SP_MaDist| |ECAM: Setpoint segments master distance|
|1351|0|MPRO_ECAM_SP_IpoType| |ECAM: Setpoint segments interpolation type|
|1352|0 to 31|Checksum| |ECAM: Setpoint table checksum|
|1353|0 to 31|GainNum| |ECAM: Setpoint segments gain numerator|
| | |GainDen| |ECAM: Setpoint segments gain denominator|

# Table 8.33: “Electronic camming - Table segments” parameters

|ID|Index|Name|Unit|Description|
|---|---|---|---|---|
|1329|0 to 63|MPRO_ECAM_SegData_IndexNext| |ECAM: Index of the following segment|
|1330|0 to 63|MPRO_ECAM_SegData_IndexPrev| |ECAM: Index of the previous segment|
|1331|0 to 63|MPRO_ECAM_SegData_ProfileMode| |ECAM: Profile mode of the current segment|
|1332|0 to 63|MPRO_ECAM_SegData_DistMaster| |ECAM: Length of the master section of the current segment|
|1333|0 to 63|MPRO_ECAM_SegData_DistSlave| |ECAM: Length of the slave section of the current segment|
|1334|0 to 63|MPRO_ECAM_SegData_Lambda| |ECAM: Lambda value of the current segment|
|1335|0 to 63|MPRO_ECAM_SegData_StatusWord| |ECAM: Status word of the current segment|
|1336|0 to 63|MPRO_ECAM_SegData_ControlWord| |ECAM: Control word of the current segment|

# 8.11.2 Control word for synchronized motion

|Bit|Function|PLC function|Bit number|Description|
|---|---|---|---|---|
|0-7|Start segment (8-bit value)|-|0-7|Actual segment (8-bit value)|
|8-15|Reserved|-| |Actual ECAM / EGEAR state machine state (4 Bit value)|
|16|Absolute (true) / relative (false) master relationship|-| |- 0: ECAM / EGEAR asynchronous
- 1: ECAM / EGEAR synchronous
|
|17|Absolute (true) / relative (false) master (CAM) relationship at cam in|-| |- 2: ECAM / EGEAR synchronizing
- 3: ECAM / EGEAR desynchronizing
|
|18|Absolute (true) / relative (false) slave (CAM) relationship at cam in|-| |- 4: ECAM / EGEAR active and waiting for going asynchronous
|
|19-23|Reserved|-| |- 5: ECAM / EGEAR inactive and waiting for going synchronous
|
|24|Change gear ratio of the electronic gear online|MCB_GearRatioChange| | |
|25|Disable master calculation|MCB_Cam_MasterEnable| | |
|26|Enable master calculation|MCB_Cam_MasterEnable| | |
|27|Select CAM table|MCB_CamTableSelect| | |
|28|Start Ecam|MCB_CamIn| | |
|29|Stop Ecam|MCB_CamOut| | |
|30|Start Egear|MCB_GearIn| | |
|31|Stop Egear|MCB_GearOut| | |

# 8.11.3 Status word for synchronized motion

|Bit|Function|PLC function|Bit number|Description|
|---|---|---|---|---|
|12-26|Reserved|-| | |
|27|ECAM / EGEAR is active|-| | |
|28|Valid segments chosen|-| | |
|29|Master data are valid|-| | |
|30|Master is initialized|-| | |
|31|Master calculation is active|-| | |

Table 8.35: Control word ECAM (P 1318[0] - MPRO_ECAM_ControlWord)

Table 8.36: ECAM status word (P 1326[0] - MPRO_ECAM_StatusWord)

MOOG ID No.:CB40859-001 Date:11/2020 MSD ServoDrive - DeviceHelp 279

# 8 Motion profile

# 8 Motion profile

MOOG ID No.:CB40859-001 Date:11/2020

MSD ServoDrive - DeviceHelp 280

# 8.11.4 Master configuration

the master encoder, you will need to set the resolution relative to a single motor revolution in P 250 - MPRO_ECAM_PARAMaster_Amplitude (see below).

- ENC CH1 (3) = Encoder channel 1 X7 (Sin/Cos)
- ENC CH2 (4) = Encoder channel 2 X6 (Resolver)
- ENC CH3 (5) = Encoder channel 3 X8 (optional)

This function is only available if an external interface X8 (option module) is present.

- TP0 (6) = Pulse counter on probe channel 0 (TP0)
- TP1 (7) = Pulse counter on probe channel 1 (TP1)
- ENC_CH4 (8) = Encoder channel 4 (p. e. fieldbus)
- TWIN_POS (9) = TWIN remote reference position (P-2607)

Image 8.72: “Master configuration” screen

# Channel selection (master encoder)

P 1319[0] - MPRO_ECAM_CamMaster_AxisType is used to define the master encoder.

- NO AXIS (0) = No axis
- VIRTUAL MASTER (1) = Virtual master

If you select this function, you will be able to configure additional settings by clicking on the enabled “Options...” button (see Section ""Virtual Master"" on page 286).

- PARA (2) = Master parameter interface

If you select this function because a higher-level controller is being used as

# Anti-reverse mode

Slave only starts moving along with it again as soon as the master reaches the zero position.

P 1320[0] - MPRO_ECAM_CamMaster_RevLockMode is used to define the reverse lock mode, which can be used either with or without path compensation. The dashed lines in the following diagrams indicate what the engagement distance is:

# Example:

If the master, which has moved two motor revolutions in the direction blocked for the slave, then moves in the unblocked direction again, the slave only moves off when the master has traversed the zero point.

- INACTIVE (0) = Reverse lock inactive
- ACTIVE (2) = Reverse lock enabled - without path optimization
- ACTIVE WAY COMP (1) = Reverse lock active - with way compensation

While the slave accelerates to the speed of the master during engagement, the master and slave do not move synchronously. This function needs to be selected in order to quickly catch up to the master that is running ahead.

# Example:

- Master (black line) rotates in the blocked direction
- The slave (blue line) remains stopped
- Master rotates in the unblocked direction again
- The slave follows the master directly in the unblocked direction

Assume the master has moved two motor revolutions in the direction for which the slave lock is enabled. If the master now moves in the direction for which there is no lock, the slave will immediately start running in that direction.

MOOG ID No.:CB40859-001 Date:11/2020

MSD ServoDrive - DeviceHelp 281

# 8 Motion profile

MOOG ID No.:CB40859-001 Date:11/2020 MSD ServoDrive - DeviceHelp 282

|Filter type|ID|Index Name|Unit|Description|
|---|---|---|---|---|
|When using a real master encoder, encoder signals may be subject to noise.|P 1340|1319|0|MPRO_ECAM_CamMaster_AxisType|
| | |MPRO_ECAM_CamMaster_SpeedFilTyp| |ECAM / EGEAR: Channel selection of internal master input|
| | |1320|0|MPRO_ECAM_CamMaster_RevLockMode|
| | |1321|0|MPRO_ECAM_CamMaster_Amplitude|
| | |1322|0|MPRO_ECAM_CamMaster_GearNum|
| | |1323|0|MPRO_ECAM_CamMaster_GearDen|
|Filter time|1327|0|ms|ECAM / EGEAR: Filter time constant of master|
|If P 1340[0] is used to enable a filter, P 1327[0] - MPRO_ECAM_CamMaster_SpeedTFil can be used to define the corresponding filter time.|1328|0|speed|ECAM / EGEAR: Speed factor of the internal master|
|Speed factor|1340|0| |MPRO_ECAM_CamMaster_SpeedFilTyp|
|The master encoder can be assigned an additional speed factor P 1328[0] - MPRO_ECAM_CamMaster_SpeedFactor.|1341|0|incr|ECAM / EGEAR: Master drive offset|

Table 8.37: “Synchronized motion - Master configuration” parameters (continue)

| | | |ID|Index Name|Unit|Description|
|---|---|---|---|---|---|---|
|247|0|MPRO_ECAM_ParaMaster_ActPos|incr|ECAM / EGEAR: Parameter interface master position| | |
|248|0|MPRO_ECAM_ParaMaster_ActSpeed|rpm|ECAM / EGEAR: Parameter interface master speed| | |
|249|0|MPRO_ECAM_ParaMaster_ActAcc|rpm|ECAM / EGEAR: Parameter interface master acceleration| | |
| |250|0|MPRO_ECAM_ParaMaster_Amplitude| |ECAM / EGEAR: Parameter interface master amplitude| |

Table 8.37: “Synchronized motion - Master configuration” parameters

# 8.11.5 Electronic gearing

# Gear ratio

The gear ratio is specified as a fraction. This ensures that the position references can be translated to the motor shaft with no rounding error.

- ""Slave"" (P 252[0] - MPRO_ECAM_Egear_GearNum) is the numerator
- ""Master"" (P 251[0] - MPRO_ECAM_Egear_GearDen) is the denominator

# Scaling of speed pre-control

Defined with P 265[0] - MPRO_ECAM_CamSlave_SpeedFactor definiert.

# Scaling of torque pre-control

Defined with P 266[0] - MPRO_ECAM_CamSlave_TorqueFactor.

# Engagement

See Section ""Engagement"" on page 284.

# Disengagement

See Section ""Disengagement"" on page 285.

|ID|Index Name|Unit|Description|
|---|---|---|---|
|251|0 MPRO_ECAM_Egear_GearDen| |EGEAR: Gear denominator|
|252|0 MPRO_ECAM_Egear_GearNum| |EGEAR: Numerator of gear ratio|
|1344|0 MPRO_ECAM_Egear_LimRefAcc|rpm/s|EGEAR: Acceleration limit for reference|
|1345|0 MPRO_ECAM_Egear_LimRefJerk|rpm/s²|EGEAR: Jerk limit for reference|

Table 8.38: “Synchronized motion - Electronic gearing” parameters

Image 8.73: ""Electronic gearing"" screen

MOOG ID No.:CB40859-001 Date:11/2020 MSD ServoDrive - DeviceHelp 283

# 8 Motion profile

# 8 Motion profile

MOOG ID No.:CB40859-001 Date:11/2020

MSD ServoDrive - DeviceHelp 284

# 8.11.6 Engagement

used to define the engagement distance (between the dashed lines).

P 253[0] - MPRO_ECAM_Egear_GearInMode is used to define the mode for engagement.

- DIRECT (0) = Direct
- Direct engagement: Angular synchronous; with jerking (no ramps).
- CROSSFADE (3) = Crossfading
- Engagement with crossfading function (5th degree polynomial): Angular synchronous; jerk-limited; speed will overshoot during engagement.
- RAMP (1) = Linear speed ramp
- Engagement with linear acceleration: Not angular synchronous; with jerking.
- FADE (2) = Engagement fade-out
- Engagement with fade-in function (5th degree polynomial): Not angular synchronous; jerk-limited. The position is ignored. ",What is the purpose of the offset parameter in the analog channels ISA00 and ISA01 according to the 'MSD ServoDrive - DeviceHelp' document?,A2,"It compensates for component variations, aiding in offset compensation.",1.828125,1.6875,3.53125,1.3125,0.39453125
37,msd_servo_drive.txt,76,b87ca5e232c2bdbb6fa16a8a401c6b5d285dc0183e73cc9d134de13dd2fc71d2,"MOOG ID No.:CB40859-001 Date:11/2020

MSD ServoDrive - DeviceHelp 267

# 8 Motion profile

MOOG ID No.:CB40859-001 Date:11/2020 MSD ServoDrive - DeviceHelp 268

# Deceleration

With ...

- P 194 - MPRO_TAB_TDec (for torque control) or
- P 197 - MPRO_TAB_SDec (for speed control) or
- P 200 - MPRO_TAB_PDec (for position control)

and indexes 0–15, the deceleration for each individual motion task can be defined. The input must not be zero.

# Wait time in Auto mode

P 204 - MPRO_TAB_WaitTime is used to define the wait time before the next motion task is carried out.

# Maximum table index in Auto mode

P 206[0] - MPRO_Tab_MaxIdx is used to define the table index up to which driving jobs will be carried out in one of the auto modes.

# Current table index

P 207[0] - MPRO_Tab_ActIdx will show the index for the motion task that is currently active. If parameter P 205 MPRO_TAB_Mode is set to “Para(0)”, a driving set can be entered and approached directly.

# Activation of reference table

The following procedures can be used in order to activate the setpoint table for operation.

|ID|Index Name|Unit|Description|
|---|---|---|---|
|193|MPRO_TAB_TAcc|TAB: Torque mode acceleration|Nm/ms|
|193|0|MPRO_TAB_TAcc|Nm/ms|
|193|1 - 15|MPRO_TAB_TAcc|Nm/ms|
|194|MPRO_TAB_TDec|TAB: Torque mode deceleration| |
|194|0|MPRO_TAB_TDec|Nm/ms|
|194|1 - 15|MPRO_TAB_TDec|Nm/ms|

# Table 8.23: Activation of table references

# Table 8.24: “Setpoint table settings” parameters

# Table 8.24: “Setpoint table settings” parameters (continue)

|ID|Index Name|Unit|Description|ID|Index Name|Unit|Description|
|---|---|---|---|---|---|---|---|
|195|MPRO_TAB_TRef|Nm|TAB: Torque mode reference value|208|MPRO_TAB_OutputNo| |OSD TAB: actual table index and target|
|195|MPRO_TAB_TRef|Nm| |208|MPRO_TAB_OutputNo| | |
|196|MPRO_TAB_SAcc|rev/min/s|TAB: Speed mode acceleration|269|MPRO_TAB_Ctrl| |TAB: control word|
|196|MPRO_TAB_SAcc|rev/min/s| | | | | |
|197|MPRO_TAB_SDec|rev/min/s|TAB: Speed mode deceleration| | | | |
|197|MPRO_TAB_SDec|rev/min/s| | | | | |
|198|MPRO_TAB_SRef|rev/min|TAB: Speed mode reference value| | | | |
|198|MPRO_TAB_SRef|rev/min| | | | | |
|199|MPRO_TAB_PAcc|rev/min/s|TAB: Position control mode acceleration| | | | |
|199|MPRO_TAB_PAcc|rev/min/s| | | | | |
|200|MPRO_TAB_PDec|rev/min/s|TAB: Position control mode Acceleration| | | | |
|200|MPRO_TAB_PDec|rev/min/s| | | | | |
|201|MPRO_TAB_PSpd|rev/min|TAB: Position control mode speed| | | | |
|201|MPRO_TAB_PSpd|rev/min| | | | | |
|202|MPRO_TAB_PPos|mDegree|TAB: Position control mode reference value| | | | |
|202|MPRO_TAB_PPos|mDegree| | | | | |
|203|MPRO_TAB_PMode| |Position control table:Mode| | | | |
|203|MPRO_TAB_PMode| | | | | | |
|204|MPRO_TAB_WaitTime|ms|TAB: Wait time| | | | |
|204|MPRO_TAB_WaitTime|ms| | | | | |
|205|MPRO_TAB_Mode| |TAB mode| | | | |
|206|MPRO_Tab_MaxIdx| |TAB: Max index in AUTO mode| | | | |
|207|MPRO_TAB_ActIdx| |TAB: Actual index| | | | |

MOOG ID No.:CB40859-001 Date:11/2020

MSD ServoDrive - DeviceHelp

# 8 Motion profile

MOOG ID No.:CB40859-001 Date:11/2020

MSD ServoDrive - DeviceHelp 270

# 8.8 Analog channel (ISA00 und ISA01)

# Offset (O)

This parameter (P 174 - MPRO_ANA0_SOffset for ISA00, P 184 - MPRO_ANA1_SOffset for ISA01) compensates for component variations and is used for offset compensation purposes. Depending on the control mode being used (see Section ""Basic settings"" on page 110), the value will be stored in parameter index [0] (torque control), [1] (speed control) or [2] (position control).

# Backlash (B)

This parameter (P 175 - MPRO_ANA0_SThreshold for ISA00, P 185 - MPRO_ANA1_SThreshold for ISA01) can suppress axis motion close to the standstill (stop) position. Depending on the control mode being used (see Section ""Basic settings"" on page 110), the value will be stored in parameter index [0] (torque control), [1] (speed control) or [2] (position control).

Image 8.68: “Analog channel” screen

# Acceleration ramp

Two standard analog inputs (ISA00, ISA01) are available. These inputs can be configured...

- with negative values for analog setpoint settings
- with positive values for digital setpoint processing

(P 109[0] - MPRO_INPUT_FS_ISA00 and P 110[0] - MPRO_INPUT_FS_ISA01).

see also section ""Analog Inputs"" on page 303. By using the ""REV(-2) = Analog setpoint"" setting, an analog input voltage of ±10 V can be processed as a setpoint.

# Deceleration ramp

This parameter serves as a deceleration ramp for torque control (P 176[1] - MPRO_ANA0_TRamp for ISA00, P 186[1] - MPRO_ANA1_TRamp for ISA01) or speed control (P 177[1] - MPRO_ANA0_SRamp for ISA00, P 187[1] - MPRO_ANA1_SRamp for ISA01). Depending on the control mode being used (see Section ""Basic settings"" on page 110), the value will be stored in parameter index [0] (torque control), [1] (speed control) or [2] (position control).

This parameter (P 173 - MPRO_ANA0_Scale for ISA00, P 183 - MPRO_ANA1_Scale for ISA01) is used to define which speed / which torque / which position corresponds to the maximum analog value. Depending on the control mode being used (see Section ""Basic settings"" on page 110), the value will be stored in parameter index [0] (torque control), [1] (speed control) or [2] (position control).

# 8.8.1 Special characteristics of position control mode

A threshold value can also be specified which generates a run-on range around the last reference value. A ramp function calculates a motion profile for the position reference from pre-defined acceleration and speed limits.

The position references on the analog channel are not applied immediately, but dependent on a digital input. Accordingly, one of the ISD00 to ISD06 digital inputs must be set to a value of ""REFANAEN(28) = Enable analog reference value"" (see Section ""Digital inputs"" on page 290). The position setpoint being received will only be applied if the corresponding digital input is active. The acceleration is entered using P 173[0] - MPRO_ANA0_TScale or P 183[0] - MPRO_ANA1_TScale.

# 8.8.2 Wire Break Monitoring

P 399 - CON_ANAWireBrk_Th can be used to configure wire break monitoring for the analog inputs. For details see Section ""Wire Break Monitoring"" on page 306.

|Function|TLIM (-4)|OVR (-3)|REFV (-2)|leer (-1)|OFF (0)|
|---|---|---|---|---|---|
|Digital|(1)-(28)|(1)-(28)|(1)-(28)|(1)-(28)|(1)-(28)|
|Analog channel|Filter|Scale|Offset|Profile|generator|

Control

Image 8.69: Reference processing structure

MOOG ID No.:CB40859-001 Date:11/2020

MSD ServoDrive - DeviceHelp 271

# 8 Motion profile

# 8 Motion profile

MOOG ID No.:CB40859-001 Date:11/2020

|ID|Index Name|Unit|Description|ID|
|---|---|---|---|---|
|395|CON_ANA_Isaf_Scaled| |Analog inputs: Values (filt, norm, comp, scaled)|174|
|395|0 ISA00| |Scaled, compensated, filtered, normalized value|175|
|395|1 ISA01| |Scaled, compensated, filtered, normalized value| |
|396|CON_ANA_Scale_ThUpper| |Analog inputs: Upper scaling limits|175|
|396|0 ISA00|%|Upper scaling (@ 10 V) threshold|175|
|396|1 ISA01|%|Upper scaling (@ 10 V) threshold| |
|397|CON_ANA_Scale_ThZero| |Analog inputs: Zero scaling thresholds|176|
|397|0 ISA00|V|Zero scaling threshold (+/-)|176|
|397|1 ISA01|V|Zero scaling threshold (+/-)| |
|398|CON_ANA_Scale_ThLower| |Analog inputs: Lower scaling limits|177|
|398|0 ISA00|%|Lower scaling (@ zero threshold) threshold|177|
|398|1 ISA01|%|Lower scaling (@ zero threshold) threshold| |
|399|CON_ANA_WireBrk_Th| |Analog inputs: Wire break thresholds|Table 8.26:|
|399|0 ISA00|V|Wire break detection threshold| |
|399|1 ISA01|V|Wire break detection threshold| |
|405|0 CON_ANA_Filt0|ms|Analog input ISA00: Filter time constant (PT 1)|ID|
|408|CON_ANA_Isaf_Norm| |Analog inputs: Values (filt, norm)|183|
|408|0 ISA00| |Filtered, normalized value|183|
|408|1 ISA01| |Filtered, normalized value|183|

Table 8.25: “Analog channel” parameters

|ID|Index Name|Unit|Description|ID|
|---|---|---|---|---|
|173|MPRO_ANA0_Scale| |ANA0: scale factors|184|
|173|0 MPRO_ANA0_TScale|Nm|ANA0: scale factor torque reference|185|
|173|1 MPRO_ANA0_SScale|rev/min|ANA0: scale factor speed reference|185|
|173|2 MPRO_ANA0_PScale|mDegree|ANA0: scale factor position reference| |
|174|MPRO_ANA0_Offset| |ANA0: offsets|185|
|174|0 MPRO_ANA0_TOffset|Nm|ANA0: offsets for torque reference|185|

Table 8.26: “Analog channel ISA00” parameters

|Index Name|Unit|Description|
|---|---|---|
|1 MPRO_ANA0_SOffset|rev/min|ANA0: offsets for speed reference|
|2 MPRO_ANA0_POffset|mDegree|ANA0: offsets for position reference|
|MPRO_ANA0_Threshold| |ANA0: thresholds|
|0 MPRO_ANA0_TThreshold|Nm|ANA0: threshold for torque reference|
|1 MPRO_ANA0_SThreshold|rev/min|ANA0: threshold for speed reference|
|2 MPRO_ANA0_PThreshold|mDegree|ANA0: threshold for position reference|
|MPRO_ANA0_TRamp| |ANA0: Torque mode acceleration [0] and deceleration [1]|
|0 MPRO_ANA0_TRamp|Nm/s| |
|1 MPRO_ANA0_TRamp|Nm/s| |
|MPRO_ANA0_SRamp| |ANA0: Speed mode acceleration [0] and deceleration [1]|
|0 MPRO_ANA0_SRamp|SPEED/s| |
|1 MPRO_ANA0_SRamp|SPEED/s| |

“Analog channel ISA00” parameters (continue)

|Index Name|Unit|Description|
|---|---|---|
|MPRO_ANA1_Scale| |ANA1: scale factors|
|0 MPRO_ANA1_TScale|Nm|ANA0: scale factor torque reference|
|1 MPRO_ANA1_SScale|rev/min|ANA0: scale factor speed reference|
|2 MPRO_ANA1_PScale|mDegree|ANA0: scale factor position reference|
|MPRO_ANA1_Offset| |ANA1: offsets|
|0 MPRO_ANA1_TOffset|Nm|ANA1: offsets for torque reference|
|1 MPRO_ANA1_SOffset|rev/min|ANA1: offsets for speed reference|
|2 MPRO_ANA1_POffset|mDegree|ANA1: offsets for position reference|
|MPRO_ANA1_Threshold| |ANA1: thresholds|
|0 MPRO_ANA1_TThreshold|Nm|ANA1: threshold for torque reference|
|1 MPRO_ANA1_SThreshold|rev/min|ANA1: threshold for speed reference|
|2 MPRO_ANA1_PThreshold|mDegree|ANA1: threshold for position reference|

“Analog channel ISA01” parameters

# 8 Motion profile

|ID|Index Name|Unit|Description|
|---|---|---|---|
|186|MPRO_ANA1_TRamp|Nm/s|ANA1: Torque mode acceleration [0] and deceleration[1]|
|186|MPRO_ANA1_TRamp|Nm/s| |
|187|MPRO_ANA1_SRamp|SPEED/s|ANA1: Speed mode acceleration [0] and deceleration [1]|
|187|MPRO_ANA1_SRamp|SPEED/s| |

# Table 8.27: “Analog channel ISA01” parameters (continue)

Display

- System state
- Initialization on device startup
- Not ready (DC link voltage possibly too low)
- Start inhibit (DC link voltage present, power stage off)
- Starting lockout
- Ready for start
- Control initialization: Auto commutation, flux build-up etc.

# Table 8.28: Central state machine according to CiA 402 device display

MOOG ID No.:CB40859-001 Date:11/2020

MSD ServoDrive - DeviceHelp 273

# 8 Motion profile

MOOG ID No.:CB40859-001 Date:11/2020

MSD ServoDrive - DeviceHelp 274

|Display|System state|power disabled|fault|
|---|---|---|---|
|Control enabled|0|Start|7|
| |fault reaction active|0|14|
|Quick stop active|1|not ready|8|
| |to switch on|1|17|
|Error reaction active|2|switch on|disabled|
| |2|7| |
|Error state (in this state the error is indicated directly on the display.)|3|ready to|switch on|
|Device is reset (display flashes)|power enabled|3|6|
| |10|12| |
|• Number [5.] flashes when “STO” (Safe Torque Off) input is active. Display goes out when STO inactive.| | | |
|• The dot on the display flashes when the power stage is active.| | | |

Table 8.28: Central state machine according to CiA 402 device display (continue)

NOTE

l The system states indicated on the display may differ from the states in the table depending on the drive profile setting.

Image 8.70: State machine diagram based on CANopen communications

⓪ to ① State number

1 to 17 State transition (No. 17: DC link voltage cut off)

Legend for “State machine diagram based on CANopen communications” figure

# 8.10 Touch probe

|ID|Index Name / Setting|
|---|---|
|241|0 MPRO_TP_Position|
|241|1 MPRO_TP_Position|
|241|2 MPRO_TP_Position|
|241|3 MPRO_TP_Position|
|241|4 MPRO_TP_Position|
|1400|0 MPRO_TP_Config|
| |TP_TP (0)|
| |AB (1)|
| |PD_UP (2)|
| |PD_DOWN (3)|
| |PC_PC (4)|
| |PC_TP (5)|
| |TP_PC (6)|
| |ENC_ENC (7)|
| |ENC_TP (8)|
| |TP_ENC (9)|

Using the touch probe inputs, touch probe functions can be performed. In order to be able to do this, P 106[0] - MPRO_INPUT_FS_ISD05 and P 107[0] - MPRO_INPUT_FS_ISD06 must be used to set digital inputs ISD05 and ISD06 to ""PROBE(15) = Touch probe (only ISD05/06)"" (see Section ""Digital inputs"" on page 290). HTL encoders can be evaluated or pulse counters implemented using the MSD PLC.

The touch probe can be triggered with P 240 - MPRO_TP_Ctrl. This enables triggering on a positive or negative edge, or on both edges, of the signal detected on the touch probe inputs. After the measurement, the parameter jumps back to the value ""NONE (0)"" and the latch position is mapped in the corresponding subindex of parameter P 241 - MPRO_TP_Position. A continuous touch probe mode is not possible at present, so the touch probe has to be reactivated after the measurement.

P 1402 - MPRO_TP_Channel can be used to select various positions as actual value sources of the latch position for the touch probe functionality. The following table provides an overview of the available settings. The counters are accessed via the MSD PLC or a bus system.

|ID|Index Name / Setting|Unit|Description|
|---|---|---|---|
|240|MPRO_TP_Ctrl|Touch probe: Control| |
| |0| |NONE (0) = No function|
| |1| |POS (1) = Positive edge|
| |2| |NEG (2) = Negative edge|
| |3| |BOTH (3) = Both edges|
|240|0 MPRO_TP_Ctrl| | |
|240|1 MPRO_TP_Ctrl| | |
|240|2 MPRO_TP_Ctrl| | |
|241|MPRO_TP_Position|Probe: Pos. high/low edge of TP0/1, encoder zero pulse| |

Table 8.29: “Touch probe” parameters

MOOG ID No.:CB40859-001 Date:11/2020

# 8 Motion profile

|Unit|Description|
|---|---|
|mDegree|Touch probe: Configuration|
|mDegree|TP0, TP1 touch probe|
|mDegree|TP0, TP1 as encoder, A/B as quadrature counting|
|mDegree|TP0, TP1 as encoder, pulse (TP0) / direction (TP1), count up on direction high|
|mDegree|TP0, TP1 as encoder, pulse (TP0) / direction (TP1), count down on direction high|
|mDegree|TP0 pulse counter, TP1 pulse counter|
|mDegree|TP0 pulse counter, TP1 touch probe|
|mDegree|TP1 touch probe, TP0 pulse counter|
|mDegree|TP0 encoder counter, TP1 encoder counter|
|mDegree|TP0 encoder counter, TP1 touch probe|
|mDegree|TP0 touch probe, TP1 encoder counter|

Touch probe: Channel

|Unit|Description|
|---|---|
|ACTPOS (0)|Actual position in user units|
|ACTPOSINC (1)|Actual position in increments|
|MASTERPOS (2)|Master position in increments|
|ENCPOS_CH1 (3)|Encoder position Channel 1|
|ENCPOS_CH1_INC (4)|Encoder position Channel 1 in increments|
|ENCPOS_CH2 (5)|Encoder position Channel 2|
|ENCPOS_CH2_INC (6)|Encoder position Channel 2 in increments|

# 8 Motion profile

MOOG ID No.:CB40859-001 Date:11/2020 MSD ServoDrive - DeviceHelp 276

|ID|Index Name / Setting|Unit|Description|
|---|---|---|---|
|7|ENCPOS_CH3 (7)| |Encoder position Channel 3|
|8|ENCPOS_CH3_INC (8)| |Encoder position Channel 3 in increments|
|9|ENCPOS_CH4 (9)| |Encoder position Channel 4|
|10|ENCPOS_CH4_INC (10)| |Encoder position Channel 4 in increments|
|11|ACTPOS2 (11)| |Actual position of redundant encoder in user units|
|12|Sercos (12)| |Referred to Sercos profile parameters S-x-0426, S-x-0427|
|13|UserRefPos(13)| |Reference position in user units|
|14|MasterPosST(14)| |Master position (ECAM, EGEAR) singleturn, always steps|
|15|CommonMasterPos(15)| |Master position (ECAM, EGEAR) singleturn, always steps|
|16|CommonMasterPosST(15)| |Master position (ECAM, EGEAR) singleturn, always steps|
|1402|MPRO_TP_Channel| | |
|1402|MPRO_TP_Channel| | |
|1402|MPRO_TP_Channel| | |
|1404|MPRO_TP_Lines| |Touch probe: Lines @ pulse counter on channel x|
|1404|MPRO_TP_Lines| | |
|1404|MPRO_TP_Lines| | |

Image 8.71: “Synchronized motion” screen

There are various modes available in the “synchronization mode” drop-down menu (P 242[0] - MPRO_ECAM_SyncModMode):

- Off(0) = Synchronized motion off
- ECAM_iPlc(1) = Electronic cam plate via MSD PLC
- EGEAR_iPlc(2) = Electr. gear unit via MSD PLC
- ECAM_PARA(3) = Electronic camming via parameters
- EGEAR_PARA(4) = Electronic gearing via parameters

NOTE: For more information refer to the bus system User Manuals or the description of the MSD PLC.

# 8.11.1 Electronic cam plate

The other parameters are configured in separate screens that can be accessed with the corresponding buttons.

- Master configuration (see Section ""Master configuration"" on page 280)
- Electronic gearing (see Section ""Electronic gearing"" on page 283)
- Electronic camming (see Section ""Electronic cam plate"" on page 277)

P 1318[0] - MPRO_ECAM_ControlWord is the control word for “synchronized motion” (see Section ""Control word for synchronized motion"" on page 279).

P 1326[0] - MPRO_ECAM_StatusWord is the status word for “synchronized motion” (see Section ""Status word for synchronized motion"" on page 279).

# 8.11.1.1 Table selection

|ID|Index Name|Unit|Description|
|---|---|---|---|
|1300|MPRO_ECAM_CTS_| |ECAM: CamTableSelect - Master reference|
|1301|MasterRef| | |
|1305|MPRO_ECAM_CTS_| |ECAM: CamTableSelect - Method for changing the camtable|
|1306|MPRO_ECAM_CTS_| |ECAM: CamTableSelect - Mode for changing the camtable|
|1307|MPRO_ECAM_CTS_|incr|ECAM: CamTableSelect - Distance for changing the camtable|
|242|MPRO_ECAM_| |ECAM / EGEAR: Mode of synchronized motion SyncModMode|
|265|MPRO_ECAM_| |ECAM / EGEAR: Slave speed factor (1 = 100%).|
|266|CamSlave_SpeedFactor| | |
|268|MPRO_ECAM_| |ECAM / EGEAR: Mode of switching off sync. motion|

# 8.11.1.2 Synchronization

|ID|Index Name|Unit|Description|
|---|---|---|---|
|1342|MPRO_ECAM_CI_|incr|ECAM: CamIn - Synchronization position (multiturn part)|
|1343|MPRO_ECAM_CO_|incr|ECAM: CamOut - Decoupling pos. (multiturn part)|
|1303|MPRO_ECAM_CI_|incr|ECAM: CamIn - Master offset|
|1308|MPRO_ECAM_CI_| |ECAM: CamIn - Master reference|
|1309|MPRO_ECAM_CI_| |ECAM: CamIn - Slave reference|
|1310|MPRO_ECAM_CI_| |ECAM: CamIn - Coupling mode|
|1311|MPRO_ECAM_CI_|incr|ECAM: CamIn - Coupling distance|
|1312|MPRO_ECAM_CI_|incr|ECAM: CamIn - Synchronization position|

Table 8.31: “Electronic camming - Table selection” parameters

Table 8.30: “Synchronized motion” parameters

Table 8.32: “Electronic camming - Synchronization” parameters

MOOG ID No.:CB40859-001 Date:11/2020

MSD ServoDrive - DeviceHelp 277

# 8 Motion profile

MOOG ID No.:CB40859-001 Date:11/2020 MSD ServoDrive - DeviceHelp 278

|ID|Index|Name|Unit|Description|
|---|---|---|---|---|
|1313|0|MPRO_ECAM_CO_SyncPosST|(singleturn part)|ECAM: CamOut - Slave reference|
|1314|0|MPRO_ECAM_CO_DecouplingMode|63|ECAM: CamOut - Decoupling mode|
|1315|0|MPRO_ECAM_CO_BreakingPosST|incr|ECAM: CamOut - Decoupling position|
|1316|0|MPRO_ECAM_CO_DecouplingDist|incr|ECAM: CamOut - Decoupling distance|
|1317|0|MPRO_ECAM_CO_StandstillPos|mDegree|ECAM: CamOut - Slave standstill position|

# Table 8.32: “Electronic camming - Synchronization” parameters (continue)

|ID|Index|Name|Unit|Description|
|---|---|---|---|---|
|1346| |MPRO_ECAM_SP_Table| |ECAM: Setpoint table interface|
|1346|0|Index| |Index of setpoint table|
|1346|1|Value| |Value at index of setpoint table|
|1347|0 to 31|MPRO_ECAM_SP_Index| |ECAM: Setpoint segments start index|
|1348|0 to 31|MPRO_ECAM_SP_Length| |ECAM: Setpoint segments length|
|1349|0 to 31|Length| | |
|1350|0|MPRO_ECAM_SP_MaDist| |ECAM: Setpoint segments master distance|
|1351|0|MPRO_ECAM_SP_IpoType| |ECAM: Setpoint segments interpolation type|
|1352|0 to 31|Checksum| |ECAM: Setpoint table checksum|
|1353|0 to 31|GainNum| |ECAM: Setpoint segments gain numerator|
| | |GainDen| |ECAM: Setpoint segments gain denominator|

# Table 8.33: “Electronic camming - Table segments” parameters

|ID|Index|Name|Unit|Description|
|---|---|---|---|---|
|1329|0 to 63|MPRO_ECAM_SegData_IndexNext| |ECAM: Index of the following segment|
|1330|0 to 63|MPRO_ECAM_SegData_IndexPrev| |ECAM: Index of the previous segment|
|1331|0 to 63|MPRO_ECAM_SegData_ProfileMode| |ECAM: Profile mode of the current segment|
|1332|0 to 63|MPRO_ECAM_SegData_DistMaster| |ECAM: Length of the master section of the current segment|
|1333|0 to 63|MPRO_ECAM_SegData_DistSlave| |ECAM: Length of the slave section of the current segment|
|1334|0 to 63|MPRO_ECAM_SegData_Lambda| |ECAM: Lambda value of the current segment|
|1335|0 to 63|MPRO_ECAM_SegData_StatusWord| |ECAM: Status word of the current segment|
|1336|0 to 63|MPRO_ECAM_SegData_ControlWord| |ECAM: Control word of the current segment|

# 8.11.2 Control word for synchronized motion

|Bit|Function|PLC function|Bit number|Description|
|---|---|---|---|---|
|0-7|Start segment (8-bit value)|-|0-7|Actual segment (8-bit value)|
|8-15|Reserved|-| |Actual ECAM / EGEAR state machine state (4 Bit value)|
|16|Absolute (true) / relative (false) master relationship|-| |- 0: ECAM / EGEAR asynchronous
- 1: ECAM / EGEAR synchronous
|
|17|Absolute (true) / relative (false) master (CAM) relationship at cam in|-| |- 2: ECAM / EGEAR synchronizing
- 3: ECAM / EGEAR desynchronizing
|
|18|Absolute (true) / relative (false) slave (CAM) relationship at cam in|-| |- 4: ECAM / EGEAR active and waiting for going asynchronous
|
|19-23|Reserved|-| |- 5: ECAM / EGEAR inactive and waiting for going synchronous
|
|24|Change gear ratio of the electronic gear online|MCB_GearRatioChange| | |
|25|Disable master calculation|MCB_Cam_MasterEnable| | |
|26|Enable master calculation|MCB_Cam_MasterEnable| | |
|27|Select CAM table|MCB_CamTableSelect| | |
|28|Start Ecam|MCB_CamIn| | |
|29|Stop Ecam|MCB_CamOut| | |
|30|Start Egear|MCB_GearIn| | |
|31|Stop Egear|MCB_GearOut| | |

# 8.11.3 Status word for synchronized motion

|Bit|Function|PLC function|Bit number|Description|
|---|---|---|---|---|
|12-26|Reserved|-| | |
|27|ECAM / EGEAR is active|-| | |
|28|Valid segments chosen|-| | |
|29|Master data are valid|-| | |
|30|Master is initialized|-| | |
|31|Master calculation is active|-| | |

Table 8.35: Control word ECAM (P 1318[0] - MPRO_ECAM_ControlWord)

Table 8.36: ECAM status word (P 1326[0] - MPRO_ECAM_StatusWord)

MOOG ID No.:CB40859-001 Date:11/2020 MSD ServoDrive - DeviceHelp 279

# 8 Motion profile

# 8 Motion profile

MOOG ID No.:CB40859-001 Date:11/2020

MSD ServoDrive - DeviceHelp 280

# 8.11.4 Master configuration

the master encoder, you will need to set the resolution relative to a single motor revolution in P 250 - MPRO_ECAM_PARAMaster_Amplitude (see below).

- ENC CH1 (3) = Encoder channel 1 X7 (Sin/Cos)
- ENC CH2 (4) = Encoder channel 2 X6 (Resolver)
- ENC CH3 (5) = Encoder channel 3 X8 (optional)

This function is only available if an external interface X8 (option module) is present.

- TP0 (6) = Pulse counter on probe channel 0 (TP0)
- TP1 (7) = Pulse counter on probe channel 1 (TP1)
- ENC_CH4 (8) = Encoder channel 4 (p. e. fieldbus)
- TWIN_POS (9) = TWIN remote reference position (P-2607)

Image 8.72: “Master configuration” screen

# Channel selection (master encoder)

P 1319[0] - MPRO_ECAM_CamMaster_AxisType is used to define the master encoder.

- NO AXIS (0) = No axis
- VIRTUAL MASTER (1) = Virtual master

If you select this function, you will be able to configure additional settings by clicking on the enabled “Options...” button (see Section ""Virtual Master"" on page 286).

- PARA (2) = Master parameter interface

If you select this function because a higher-level controller is being used as

# Anti-reverse mode

Slave only starts moving along with it again as soon as the master reaches the zero position.

P 1320[0] - MPRO_ECAM_CamMaster_RevLockMode is used to define the reverse lock mode, which can be used either with or without path compensation. The dashed lines in the following diagrams indicate what the engagement distance is:

# Example:

If the master, which has moved two motor revolutions in the direction blocked for the slave, then moves in the unblocked direction again, the slave only moves off when the master has traversed the zero point.

- INACTIVE (0) = Reverse lock inactive
- ACTIVE (2) = Reverse lock enabled - without path optimization
- ACTIVE WAY COMP (1) = Reverse lock active - with way compensation

While the slave accelerates to the speed of the master during engagement, the master and slave do not move synchronously. This function needs to be selected in order to quickly catch up to the master that is running ahead.

# Example:

- Master (black line) rotates in the blocked direction
- The slave (blue line) remains stopped
- Master rotates in the unblocked direction again
- The slave follows the master directly in the unblocked direction

Assume the master has moved two motor revolutions in the direction for which the slave lock is enabled. If the master now moves in the direction for which there is no lock, the slave will immediately start running in that direction.

MOOG ID No.:CB40859-001 Date:11/2020

MSD ServoDrive - DeviceHelp 281

# 8 Motion profile

MOOG ID No.:CB40859-001 Date:11/2020 MSD ServoDrive - DeviceHelp 282

|Filter type|ID|Index Name|Unit|Description|
|---|---|---|---|---|
|When using a real master encoder, encoder signals may be subject to noise.|P 1340|1319|0|MPRO_ECAM_CamMaster_AxisType|
| | |MPRO_ECAM_CamMaster_SpeedFilTyp| |ECAM / EGEAR: Channel selection of internal master input|
| | |1320|0|MPRO_ECAM_CamMaster_RevLockMode|
| | |1321|0|MPRO_ECAM_CamMaster_Amplitude|
| | |1322|0|MPRO_ECAM_CamMaster_GearNum|
| | |1323|0|MPRO_ECAM_CamMaster_GearDen|
|Filter time|1327|0|ms|ECAM / EGEAR: Filter time constant of master|
|If P 1340[0] is used to enable a filter, P 1327[0] - MPRO_ECAM_CamMaster_SpeedTFil can be used to define the corresponding filter time.|1328|0|speed|ECAM / EGEAR: Speed factor of the internal master|
|Speed factor|1340|0| |MPRO_ECAM_CamMaster_SpeedFilTyp|
|The master encoder can be assigned an additional speed factor P 1328[0] - MPRO_ECAM_CamMaster_SpeedFactor.|1341|0|incr|ECAM / EGEAR: Master drive offset|

Table 8.37: “Synchronized motion - Master configuration” parameters (continue)

| | | |ID|Index Name|Unit|Description|
|---|---|---|---|---|---|---|
|247|0|MPRO_ECAM_ParaMaster_ActPos|incr|ECAM / EGEAR: Parameter interface master position| | |
|248|0|MPRO_ECAM_ParaMaster_ActSpeed|rpm|ECAM / EGEAR: Parameter interface master speed| | |
|249|0|MPRO_ECAM_ParaMaster_ActAcc|rpm|ECAM / EGEAR: Parameter interface master acceleration| | |
| |250|0|MPRO_ECAM_ParaMaster_Amplitude| |ECAM / EGEAR: Parameter interface master amplitude| |

Table 8.37: “Synchronized motion - Master configuration” parameters

# 8.11.5 Electronic gearing

# Gear ratio

The gear ratio is specified as a fraction. This ensures that the position references can be translated to the motor shaft with no rounding error.

- ""Slave"" (P 252[0] - MPRO_ECAM_Egear_GearNum) is the numerator
- ""Master"" (P 251[0] - MPRO_ECAM_Egear_GearDen) is the denominator

# Scaling of speed pre-control

Defined with P 265[0] - MPRO_ECAM_CamSlave_SpeedFactor definiert.

# Scaling of torque pre-control

Defined with P 266[0] - MPRO_ECAM_CamSlave_TorqueFactor.

# Engagement

See Section ""Engagement"" on page 284.

# Disengagement

See Section ""Disengagement"" on page 285.

|ID|Index Name|Unit|Description|
|---|---|---|---|
|251|0 MPRO_ECAM_Egear_GearDen| |EGEAR: Gear denominator|
|252|0 MPRO_ECAM_Egear_GearNum| |EGEAR: Numerator of gear ratio|
|1344|0 MPRO_ECAM_Egear_LimRefAcc|rpm/s|EGEAR: Acceleration limit for reference|
|1345|0 MPRO_ECAM_Egear_LimRefJerk|rpm/s²|EGEAR: Jerk limit for reference|

Table 8.38: “Synchronized motion - Electronic gearing” parameters

Image 8.73: ""Electronic gearing"" screen

MOOG ID No.:CB40859-001 Date:11/2020 MSD ServoDrive - DeviceHelp 283

# 8 Motion profile

# 8 Motion profile

MOOG ID No.:CB40859-001 Date:11/2020

MSD ServoDrive - DeviceHelp 284

# 8.11.6 Engagement

used to define the engagement distance (between the dashed lines).

P 253[0] - MPRO_ECAM_Egear_GearInMode is used to define the mode for engagement.

- DIRECT (0) = Direct
- Direct engagement: Angular synchronous; with jerking (no ramps).
- CROSSFADE (3) = Crossfading
- Engagement with crossfading function (5th degree polynomial): Angular synchronous; jerk-limited; speed will overshoot during engagement.
- RAMP (1) = Linear speed ramp
- Engagement with linear acceleration: Not angular synchronous; with jerking.
- FADE (2) = Engagement fade-out
- Engagement with fade-in function (5th degree polynomial): Not angular synchronous; jerk-limited. The position is ignored. ",What is the purpose of the offset parameter in the analog channels ISA00 and ISA01 according to the 'MSD ServoDrive - DeviceHelp' document?,A3,Offset parameters like P 174 and P 184 adjust for variations to ensure accurate compensation.,1.90625,2.015625,3.609375,1.40625,0.38671875
38,msd_servo_drive.txt,76,b87ca5e232c2bdbb6fa16a8a401c6b5d285dc0183e73cc9d134de13dd2fc71d2,"MOOG ID No.:CB40859-001 Date:11/2020

MSD ServoDrive - DeviceHelp 267

# 8 Motion profile

MOOG ID No.:CB40859-001 Date:11/2020 MSD ServoDrive - DeviceHelp 268

# Deceleration

With ...

- P 194 - MPRO_TAB_TDec (for torque control) or
- P 197 - MPRO_TAB_SDec (for speed control) or
- P 200 - MPRO_TAB_PDec (for position control)

and indexes 0–15, the deceleration for each individual motion task can be defined. The input must not be zero.

# Wait time in Auto mode

P 204 - MPRO_TAB_WaitTime is used to define the wait time before the next motion task is carried out.

# Maximum table index in Auto mode

P 206[0] - MPRO_Tab_MaxIdx is used to define the table index up to which driving jobs will be carried out in one of the auto modes.

# Current table index

P 207[0] - MPRO_Tab_ActIdx will show the index for the motion task that is currently active. If parameter P 205 MPRO_TAB_Mode is set to “Para(0)”, a driving set can be entered and approached directly.

# Activation of reference table

The following procedures can be used in order to activate the setpoint table for operation.

|ID|Index Name|Unit|Description|
|---|---|---|---|
|193|MPRO_TAB_TAcc|TAB: Torque mode acceleration|Nm/ms|
|193|0|MPRO_TAB_TAcc|Nm/ms|
|193|1 - 15|MPRO_TAB_TAcc|Nm/ms|
|194|MPRO_TAB_TDec|TAB: Torque mode deceleration| |
|194|0|MPRO_TAB_TDec|Nm/ms|
|194|1 - 15|MPRO_TAB_TDec|Nm/ms|

# Table 8.23: Activation of table references

# Table 8.24: “Setpoint table settings” parameters

# Table 8.24: “Setpoint table settings” parameters (continue)

|ID|Index Name|Unit|Description|ID|Index Name|Unit|Description|
|---|---|---|---|---|---|---|---|
|195|MPRO_TAB_TRef|Nm|TAB: Torque mode reference value|208|MPRO_TAB_OutputNo| |OSD TAB: actual table index and target|
|195|MPRO_TAB_TRef|Nm| |208|MPRO_TAB_OutputNo| | |
|196|MPRO_TAB_SAcc|rev/min/s|TAB: Speed mode acceleration|269|MPRO_TAB_Ctrl| |TAB: control word|
|196|MPRO_TAB_SAcc|rev/min/s| | | | | |
|197|MPRO_TAB_SDec|rev/min/s|TAB: Speed mode deceleration| | | | |
|197|MPRO_TAB_SDec|rev/min/s| | | | | |
|198|MPRO_TAB_SRef|rev/min|TAB: Speed mode reference value| | | | |
|198|MPRO_TAB_SRef|rev/min| | | | | |
|199|MPRO_TAB_PAcc|rev/min/s|TAB: Position control mode acceleration| | | | |
|199|MPRO_TAB_PAcc|rev/min/s| | | | | |
|200|MPRO_TAB_PDec|rev/min/s|TAB: Position control mode Acceleration| | | | |
|200|MPRO_TAB_PDec|rev/min/s| | | | | |
|201|MPRO_TAB_PSpd|rev/min|TAB: Position control mode speed| | | | |
|201|MPRO_TAB_PSpd|rev/min| | | | | |
|202|MPRO_TAB_PPos|mDegree|TAB: Position control mode reference value| | | | |
|202|MPRO_TAB_PPos|mDegree| | | | | |
|203|MPRO_TAB_PMode| |Position control table:Mode| | | | |
|203|MPRO_TAB_PMode| | | | | | |
|204|MPRO_TAB_WaitTime|ms|TAB: Wait time| | | | |
|204|MPRO_TAB_WaitTime|ms| | | | | |
|205|MPRO_TAB_Mode| |TAB mode| | | | |
|206|MPRO_Tab_MaxIdx| |TAB: Max index in AUTO mode| | | | |
|207|MPRO_TAB_ActIdx| |TAB: Actual index| | | | |

MOOG ID No.:CB40859-001 Date:11/2020

MSD ServoDrive - DeviceHelp

# 8 Motion profile

MOOG ID No.:CB40859-001 Date:11/2020

MSD ServoDrive - DeviceHelp 270

# 8.8 Analog channel (ISA00 und ISA01)

# Offset (O)

This parameter (P 174 - MPRO_ANA0_SOffset for ISA00, P 184 - MPRO_ANA1_SOffset for ISA01) compensates for component variations and is used for offset compensation purposes. Depending on the control mode being used (see Section ""Basic settings"" on page 110), the value will be stored in parameter index [0] (torque control), [1] (speed control) or [2] (position control).

# Backlash (B)

This parameter (P 175 - MPRO_ANA0_SThreshold for ISA00, P 185 - MPRO_ANA1_SThreshold for ISA01) can suppress axis motion close to the standstill (stop) position. Depending on the control mode being used (see Section ""Basic settings"" on page 110), the value will be stored in parameter index [0] (torque control), [1] (speed control) or [2] (position control).

Image 8.68: “Analog channel” screen

# Acceleration ramp

Two standard analog inputs (ISA00, ISA01) are available. These inputs can be configured...

- with negative values for analog setpoint settings
- with positive values for digital setpoint processing

(P 109[0] - MPRO_INPUT_FS_ISA00 and P 110[0] - MPRO_INPUT_FS_ISA01).

see also section ""Analog Inputs"" on page 303. By using the ""REV(-2) = Analog setpoint"" setting, an analog input voltage of ±10 V can be processed as a setpoint.

# Deceleration ramp

This parameter serves as a deceleration ramp for torque control (P 176[1] - MPRO_ANA0_TRamp for ISA00, P 186[1] - MPRO_ANA1_TRamp for ISA01) or speed control (P 177[1] - MPRO_ANA0_SRamp for ISA00, P 187[1] - MPRO_ANA1_SRamp for ISA01). Depending on the control mode being used (see Section ""Basic settings"" on page 110), the value will be stored in parameter index [0] (torque control), [1] (speed control) or [2] (position control).

This parameter (P 173 - MPRO_ANA0_Scale for ISA00, P 183 - MPRO_ANA1_Scale for ISA01) is used to define which speed / which torque / which position corresponds to the maximum analog value. Depending on the control mode being used (see Section ""Basic settings"" on page 110), the value will be stored in parameter index [0] (torque control), [1] (speed control) or [2] (position control).

# 8.8.1 Special characteristics of position control mode

A threshold value can also be specified which generates a run-on range around the last reference value. A ramp function calculates a motion profile for the position reference from pre-defined acceleration and speed limits.

The position references on the analog channel are not applied immediately, but dependent on a digital input. Accordingly, one of the ISD00 to ISD06 digital inputs must be set to a value of ""REFANAEN(28) = Enable analog reference value"" (see Section ""Digital inputs"" on page 290). The position setpoint being received will only be applied if the corresponding digital input is active. The acceleration is entered using P 173[0] - MPRO_ANA0_TScale or P 183[0] - MPRO_ANA1_TScale.

# 8.8.2 Wire Break Monitoring

P 399 - CON_ANAWireBrk_Th can be used to configure wire break monitoring for the analog inputs. For details see Section ""Wire Break Monitoring"" on page 306.

|Function|TLIM (-4)|OVR (-3)|REFV (-2)|leer (-1)|OFF (0)|
|---|---|---|---|---|---|
|Digital|(1)-(28)|(1)-(28)|(1)-(28)|(1)-(28)|(1)-(28)|
|Analog channel|Filter|Scale|Offset|Profile|generator|

Control

Image 8.69: Reference processing structure

MOOG ID No.:CB40859-001 Date:11/2020

MSD ServoDrive - DeviceHelp 271

# 8 Motion profile

# 8 Motion profile

MOOG ID No.:CB40859-001 Date:11/2020

|ID|Index Name|Unit|Description|ID|
|---|---|---|---|---|
|395|CON_ANA_Isaf_Scaled| |Analog inputs: Values (filt, norm, comp, scaled)|174|
|395|0 ISA00| |Scaled, compensated, filtered, normalized value|175|
|395|1 ISA01| |Scaled, compensated, filtered, normalized value| |
|396|CON_ANA_Scale_ThUpper| |Analog inputs: Upper scaling limits|175|
|396|0 ISA00|%|Upper scaling (@ 10 V) threshold|175|
|396|1 ISA01|%|Upper scaling (@ 10 V) threshold| |
|397|CON_ANA_Scale_ThZero| |Analog inputs: Zero scaling thresholds|176|
|397|0 ISA00|V|Zero scaling threshold (+/-)|176|
|397|1 ISA01|V|Zero scaling threshold (+/-)| |
|398|CON_ANA_Scale_ThLower| |Analog inputs: Lower scaling limits|177|
|398|0 ISA00|%|Lower scaling (@ zero threshold) threshold|177|
|398|1 ISA01|%|Lower scaling (@ zero threshold) threshold| |
|399|CON_ANA_WireBrk_Th| |Analog inputs: Wire break thresholds|Table 8.26:|
|399|0 ISA00|V|Wire break detection threshold| |
|399|1 ISA01|V|Wire break detection threshold| |
|405|0 CON_ANA_Filt0|ms|Analog input ISA00: Filter time constant (PT 1)|ID|
|408|CON_ANA_Isaf_Norm| |Analog inputs: Values (filt, norm)|183|
|408|0 ISA00| |Filtered, normalized value|183|
|408|1 ISA01| |Filtered, normalized value|183|

Table 8.25: “Analog channel” parameters

|ID|Index Name|Unit|Description|ID|
|---|---|---|---|---|
|173|MPRO_ANA0_Scale| |ANA0: scale factors|184|
|173|0 MPRO_ANA0_TScale|Nm|ANA0: scale factor torque reference|185|
|173|1 MPRO_ANA0_SScale|rev/min|ANA0: scale factor speed reference|185|
|173|2 MPRO_ANA0_PScale|mDegree|ANA0: scale factor position reference| |
|174|MPRO_ANA0_Offset| |ANA0: offsets|185|
|174|0 MPRO_ANA0_TOffset|Nm|ANA0: offsets for torque reference|185|

Table 8.26: “Analog channel ISA00” parameters

|Index Name|Unit|Description|
|---|---|---|
|1 MPRO_ANA0_SOffset|rev/min|ANA0: offsets for speed reference|
|2 MPRO_ANA0_POffset|mDegree|ANA0: offsets for position reference|
|MPRO_ANA0_Threshold| |ANA0: thresholds|
|0 MPRO_ANA0_TThreshold|Nm|ANA0: threshold for torque reference|
|1 MPRO_ANA0_SThreshold|rev/min|ANA0: threshold for speed reference|
|2 MPRO_ANA0_PThreshold|mDegree|ANA0: threshold for position reference|
|MPRO_ANA0_TRamp| |ANA0: Torque mode acceleration [0] and deceleration [1]|
|0 MPRO_ANA0_TRamp|Nm/s| |
|1 MPRO_ANA0_TRamp|Nm/s| |
|MPRO_ANA0_SRamp| |ANA0: Speed mode acceleration [0] and deceleration [1]|
|0 MPRO_ANA0_SRamp|SPEED/s| |
|1 MPRO_ANA0_SRamp|SPEED/s| |

“Analog channel ISA00” parameters (continue)

|Index Name|Unit|Description|
|---|---|---|
|MPRO_ANA1_Scale| |ANA1: scale factors|
|0 MPRO_ANA1_TScale|Nm|ANA0: scale factor torque reference|
|1 MPRO_ANA1_SScale|rev/min|ANA0: scale factor speed reference|
|2 MPRO_ANA1_PScale|mDegree|ANA0: scale factor position reference|
|MPRO_ANA1_Offset| |ANA1: offsets|
|0 MPRO_ANA1_TOffset|Nm|ANA1: offsets for torque reference|
|1 MPRO_ANA1_SOffset|rev/min|ANA1: offsets for speed reference|
|2 MPRO_ANA1_POffset|mDegree|ANA1: offsets for position reference|
|MPRO_ANA1_Threshold| |ANA1: thresholds|
|0 MPRO_ANA1_TThreshold|Nm|ANA1: threshold for torque reference|
|1 MPRO_ANA1_SThreshold|rev/min|ANA1: threshold for speed reference|
|2 MPRO_ANA1_PThreshold|mDegree|ANA1: threshold for position reference|

“Analog channel ISA01” parameters

# 8 Motion profile

|ID|Index Name|Unit|Description|
|---|---|---|---|
|186|MPRO_ANA1_TRamp|Nm/s|ANA1: Torque mode acceleration [0] and deceleration[1]|
|186|MPRO_ANA1_TRamp|Nm/s| |
|187|MPRO_ANA1_SRamp|SPEED/s|ANA1: Speed mode acceleration [0] and deceleration [1]|
|187|MPRO_ANA1_SRamp|SPEED/s| |

# Table 8.27: “Analog channel ISA01” parameters (continue)

Display

- System state
- Initialization on device startup
- Not ready (DC link voltage possibly too low)
- Start inhibit (DC link voltage present, power stage off)
- Starting lockout
- Ready for start
- Control initialization: Auto commutation, flux build-up etc.

# Table 8.28: Central state machine according to CiA 402 device display

MOOG ID No.:CB40859-001 Date:11/2020

MSD ServoDrive - DeviceHelp 273

# 8 Motion profile

MOOG ID No.:CB40859-001 Date:11/2020

MSD ServoDrive - DeviceHelp 274

|Display|System state|power disabled|fault|
|---|---|---|---|
|Control enabled|0|Start|7|
| |fault reaction active|0|14|
|Quick stop active|1|not ready|8|
| |to switch on|1|17|
|Error reaction active|2|switch on|disabled|
| |2|7| |
|Error state (in this state the error is indicated directly on the display.)|3|ready to|switch on|
|Device is reset (display flashes)|power enabled|3|6|
| |10|12| |
|• Number [5.] flashes when “STO” (Safe Torque Off) input is active. Display goes out when STO inactive.| | | |
|• The dot on the display flashes when the power stage is active.| | | |

Table 8.28: Central state machine according to CiA 402 device display (continue)

NOTE

l The system states indicated on the display may differ from the states in the table depending on the drive profile setting.

Image 8.70: State machine diagram based on CANopen communications

⓪ to ① State number

1 to 17 State transition (No. 17: DC link voltage cut off)

Legend for “State machine diagram based on CANopen communications” figure

# 8.10 Touch probe

|ID|Index Name / Setting|
|---|---|
|241|0 MPRO_TP_Position|
|241|1 MPRO_TP_Position|
|241|2 MPRO_TP_Position|
|241|3 MPRO_TP_Position|
|241|4 MPRO_TP_Position|
|1400|0 MPRO_TP_Config|
| |TP_TP (0)|
| |AB (1)|
| |PD_UP (2)|
| |PD_DOWN (3)|
| |PC_PC (4)|
| |PC_TP (5)|
| |TP_PC (6)|
| |ENC_ENC (7)|
| |ENC_TP (8)|
| |TP_ENC (9)|

Using the touch probe inputs, touch probe functions can be performed. In order to be able to do this, P 106[0] - MPRO_INPUT_FS_ISD05 and P 107[0] - MPRO_INPUT_FS_ISD06 must be used to set digital inputs ISD05 and ISD06 to ""PROBE(15) = Touch probe (only ISD05/06)"" (see Section ""Digital inputs"" on page 290). HTL encoders can be evaluated or pulse counters implemented using the MSD PLC.

The touch probe can be triggered with P 240 - MPRO_TP_Ctrl. This enables triggering on a positive or negative edge, or on both edges, of the signal detected on the touch probe inputs. After the measurement, the parameter jumps back to the value ""NONE (0)"" and the latch position is mapped in the corresponding subindex of parameter P 241 - MPRO_TP_Position. A continuous touch probe mode is not possible at present, so the touch probe has to be reactivated after the measurement.

P 1402 - MPRO_TP_Channel can be used to select various positions as actual value sources of the latch position for the touch probe functionality. The following table provides an overview of the available settings. The counters are accessed via the MSD PLC or a bus system.

|ID|Index Name / Setting|Unit|Description|
|---|---|---|---|
|240|MPRO_TP_Ctrl|Touch probe: Control| |
| |0| |NONE (0) = No function|
| |1| |POS (1) = Positive edge|
| |2| |NEG (2) = Negative edge|
| |3| |BOTH (3) = Both edges|
|240|0 MPRO_TP_Ctrl| | |
|240|1 MPRO_TP_Ctrl| | |
|240|2 MPRO_TP_Ctrl| | |
|241|MPRO_TP_Position|Probe: Pos. high/low edge of TP0/1, encoder zero pulse| |

Table 8.29: “Touch probe” parameters

MOOG ID No.:CB40859-001 Date:11/2020

# 8 Motion profile

|Unit|Description|
|---|---|
|mDegree|Touch probe: Configuration|
|mDegree|TP0, TP1 touch probe|
|mDegree|TP0, TP1 as encoder, A/B as quadrature counting|
|mDegree|TP0, TP1 as encoder, pulse (TP0) / direction (TP1), count up on direction high|
|mDegree|TP0, TP1 as encoder, pulse (TP0) / direction (TP1), count down on direction high|
|mDegree|TP0 pulse counter, TP1 pulse counter|
|mDegree|TP0 pulse counter, TP1 touch probe|
|mDegree|TP1 touch probe, TP0 pulse counter|
|mDegree|TP0 encoder counter, TP1 encoder counter|
|mDegree|TP0 encoder counter, TP1 touch probe|
|mDegree|TP0 touch probe, TP1 encoder counter|

Touch probe: Channel

|Unit|Description|
|---|---|
|ACTPOS (0)|Actual position in user units|
|ACTPOSINC (1)|Actual position in increments|
|MASTERPOS (2)|Master position in increments|
|ENCPOS_CH1 (3)|Encoder position Channel 1|
|ENCPOS_CH1_INC (4)|Encoder position Channel 1 in increments|
|ENCPOS_CH2 (5)|Encoder position Channel 2|
|ENCPOS_CH2_INC (6)|Encoder position Channel 2 in increments|

# 8 Motion profile

MOOG ID No.:CB40859-001 Date:11/2020 MSD ServoDrive - DeviceHelp 276

|ID|Index Name / Setting|Unit|Description|
|---|---|---|---|
|7|ENCPOS_CH3 (7)| |Encoder position Channel 3|
|8|ENCPOS_CH3_INC (8)| |Encoder position Channel 3 in increments|
|9|ENCPOS_CH4 (9)| |Encoder position Channel 4|
|10|ENCPOS_CH4_INC (10)| |Encoder position Channel 4 in increments|
|11|ACTPOS2 (11)| |Actual position of redundant encoder in user units|
|12|Sercos (12)| |Referred to Sercos profile parameters S-x-0426, S-x-0427|
|13|UserRefPos(13)| |Reference position in user units|
|14|MasterPosST(14)| |Master position (ECAM, EGEAR) singleturn, always steps|
|15|CommonMasterPos(15)| |Master position (ECAM, EGEAR) singleturn, always steps|
|16|CommonMasterPosST(15)| |Master position (ECAM, EGEAR) singleturn, always steps|
|1402|MPRO_TP_Channel| | |
|1402|MPRO_TP_Channel| | |
|1402|MPRO_TP_Channel| | |
|1404|MPRO_TP_Lines| |Touch probe: Lines @ pulse counter on channel x|
|1404|MPRO_TP_Lines| | |
|1404|MPRO_TP_Lines| | |

Image 8.71: “Synchronized motion” screen

There are various modes available in the “synchronization mode” drop-down menu (P 242[0] - MPRO_ECAM_SyncModMode):

- Off(0) = Synchronized motion off
- ECAM_iPlc(1) = Electronic cam plate via MSD PLC
- EGEAR_iPlc(2) = Electr. gear unit via MSD PLC
- ECAM_PARA(3) = Electronic camming via parameters
- EGEAR_PARA(4) = Electronic gearing via parameters

NOTE: For more information refer to the bus system User Manuals or the description of the MSD PLC.

# 8.11.1 Electronic cam plate

The other parameters are configured in separate screens that can be accessed with the corresponding buttons.

- Master configuration (see Section ""Master configuration"" on page 280)
- Electronic gearing (see Section ""Electronic gearing"" on page 283)
- Electronic camming (see Section ""Electronic cam plate"" on page 277)

P 1318[0] - MPRO_ECAM_ControlWord is the control word for “synchronized motion” (see Section ""Control word for synchronized motion"" on page 279).

P 1326[0] - MPRO_ECAM_StatusWord is the status word for “synchronized motion” (see Section ""Status word for synchronized motion"" on page 279).

# 8.11.1.1 Table selection

|ID|Index Name|Unit|Description|
|---|---|---|---|
|1300|MPRO_ECAM_CTS_| |ECAM: CamTableSelect - Master reference|
|1301|MasterRef| | |
|1305|MPRO_ECAM_CTS_| |ECAM: CamTableSelect - Method for changing the camtable|
|1306|MPRO_ECAM_CTS_| |ECAM: CamTableSelect - Mode for changing the camtable|
|1307|MPRO_ECAM_CTS_|incr|ECAM: CamTableSelect - Distance for changing the camtable|
|242|MPRO_ECAM_| |ECAM / EGEAR: Mode of synchronized motion SyncModMode|
|265|MPRO_ECAM_| |ECAM / EGEAR: Slave speed factor (1 = 100%).|
|266|CamSlave_SpeedFactor| | |
|268|MPRO_ECAM_| |ECAM / EGEAR: Mode of switching off sync. motion|

# 8.11.1.2 Synchronization

|ID|Index Name|Unit|Description|
|---|---|---|---|
|1342|MPRO_ECAM_CI_|incr|ECAM: CamIn - Synchronization position (multiturn part)|
|1343|MPRO_ECAM_CO_|incr|ECAM: CamOut - Decoupling pos. (multiturn part)|
|1303|MPRO_ECAM_CI_|incr|ECAM: CamIn - Master offset|
|1308|MPRO_ECAM_CI_| |ECAM: CamIn - Master reference|
|1309|MPRO_ECAM_CI_| |ECAM: CamIn - Slave reference|
|1310|MPRO_ECAM_CI_| |ECAM: CamIn - Coupling mode|
|1311|MPRO_ECAM_CI_|incr|ECAM: CamIn - Coupling distance|
|1312|MPRO_ECAM_CI_|incr|ECAM: CamIn - Synchronization position|

Table 8.31: “Electronic camming - Table selection” parameters

Table 8.30: “Synchronized motion” parameters

Table 8.32: “Electronic camming - Synchronization” parameters

MOOG ID No.:CB40859-001 Date:11/2020

MSD ServoDrive - DeviceHelp 277

# 8 Motion profile

MOOG ID No.:CB40859-001 Date:11/2020 MSD ServoDrive - DeviceHelp 278

|ID|Index|Name|Unit|Description|
|---|---|---|---|---|
|1313|0|MPRO_ECAM_CO_SyncPosST|(singleturn part)|ECAM: CamOut - Slave reference|
|1314|0|MPRO_ECAM_CO_DecouplingMode|63|ECAM: CamOut - Decoupling mode|
|1315|0|MPRO_ECAM_CO_BreakingPosST|incr|ECAM: CamOut - Decoupling position|
|1316|0|MPRO_ECAM_CO_DecouplingDist|incr|ECAM: CamOut - Decoupling distance|
|1317|0|MPRO_ECAM_CO_StandstillPos|mDegree|ECAM: CamOut - Slave standstill position|

# Table 8.32: “Electronic camming - Synchronization” parameters (continue)

|ID|Index|Name|Unit|Description|
|---|---|---|---|---|
|1346| |MPRO_ECAM_SP_Table| |ECAM: Setpoint table interface|
|1346|0|Index| |Index of setpoint table|
|1346|1|Value| |Value at index of setpoint table|
|1347|0 to 31|MPRO_ECAM_SP_Index| |ECAM: Setpoint segments start index|
|1348|0 to 31|MPRO_ECAM_SP_Length| |ECAM: Setpoint segments length|
|1349|0 to 31|Length| | |
|1350|0|MPRO_ECAM_SP_MaDist| |ECAM: Setpoint segments master distance|
|1351|0|MPRO_ECAM_SP_IpoType| |ECAM: Setpoint segments interpolation type|
|1352|0 to 31|Checksum| |ECAM: Setpoint table checksum|
|1353|0 to 31|GainNum| |ECAM: Setpoint segments gain numerator|
| | |GainDen| |ECAM: Setpoint segments gain denominator|

# Table 8.33: “Electronic camming - Table segments” parameters

|ID|Index|Name|Unit|Description|
|---|---|---|---|---|
|1329|0 to 63|MPRO_ECAM_SegData_IndexNext| |ECAM: Index of the following segment|
|1330|0 to 63|MPRO_ECAM_SegData_IndexPrev| |ECAM: Index of the previous segment|
|1331|0 to 63|MPRO_ECAM_SegData_ProfileMode| |ECAM: Profile mode of the current segment|
|1332|0 to 63|MPRO_ECAM_SegData_DistMaster| |ECAM: Length of the master section of the current segment|
|1333|0 to 63|MPRO_ECAM_SegData_DistSlave| |ECAM: Length of the slave section of the current segment|
|1334|0 to 63|MPRO_ECAM_SegData_Lambda| |ECAM: Lambda value of the current segment|
|1335|0 to 63|MPRO_ECAM_SegData_StatusWord| |ECAM: Status word of the current segment|
|1336|0 to 63|MPRO_ECAM_SegData_ControlWord| |ECAM: Control word of the current segment|

# 8.11.2 Control word for synchronized motion

|Bit|Function|PLC function|Bit number|Description|
|---|---|---|---|---|
|0-7|Start segment (8-bit value)|-|0-7|Actual segment (8-bit value)|
|8-15|Reserved|-| |Actual ECAM / EGEAR state machine state (4 Bit value)|
|16|Absolute (true) / relative (false) master relationship|-| |- 0: ECAM / EGEAR asynchronous
- 1: ECAM / EGEAR synchronous
|
|17|Absolute (true) / relative (false) master (CAM) relationship at cam in|-| |- 2: ECAM / EGEAR synchronizing
- 3: ECAM / EGEAR desynchronizing
|
|18|Absolute (true) / relative (false) slave (CAM) relationship at cam in|-| |- 4: ECAM / EGEAR active and waiting for going asynchronous
|
|19-23|Reserved|-| |- 5: ECAM / EGEAR inactive and waiting for going synchronous
|
|24|Change gear ratio of the electronic gear online|MCB_GearRatioChange| | |
|25|Disable master calculation|MCB_Cam_MasterEnable| | |
|26|Enable master calculation|MCB_Cam_MasterEnable| | |
|27|Select CAM table|MCB_CamTableSelect| | |
|28|Start Ecam|MCB_CamIn| | |
|29|Stop Ecam|MCB_CamOut| | |
|30|Start Egear|MCB_GearIn| | |
|31|Stop Egear|MCB_GearOut| | |

# 8.11.3 Status word for synchronized motion

|Bit|Function|PLC function|Bit number|Description|
|---|---|---|---|---|
|12-26|Reserved|-| | |
|27|ECAM / EGEAR is active|-| | |
|28|Valid segments chosen|-| | |
|29|Master data are valid|-| | |
|30|Master is initialized|-| | |
|31|Master calculation is active|-| | |

Table 8.35: Control word ECAM (P 1318[0] - MPRO_ECAM_ControlWord)

Table 8.36: ECAM status word (P 1326[0] - MPRO_ECAM_StatusWord)

MOOG ID No.:CB40859-001 Date:11/2020 MSD ServoDrive - DeviceHelp 279

# 8 Motion profile

# 8 Motion profile

MOOG ID No.:CB40859-001 Date:11/2020

MSD ServoDrive - DeviceHelp 280

# 8.11.4 Master configuration

the master encoder, you will need to set the resolution relative to a single motor revolution in P 250 - MPRO_ECAM_PARAMaster_Amplitude (see below).

- ENC CH1 (3) = Encoder channel 1 X7 (Sin/Cos)
- ENC CH2 (4) = Encoder channel 2 X6 (Resolver)
- ENC CH3 (5) = Encoder channel 3 X8 (optional)

This function is only available if an external interface X8 (option module) is present.

- TP0 (6) = Pulse counter on probe channel 0 (TP0)
- TP1 (7) = Pulse counter on probe channel 1 (TP1)
- ENC_CH4 (8) = Encoder channel 4 (p. e. fieldbus)
- TWIN_POS (9) = TWIN remote reference position (P-2607)

Image 8.72: “Master configuration” screen

# Channel selection (master encoder)

P 1319[0] - MPRO_ECAM_CamMaster_AxisType is used to define the master encoder.

- NO AXIS (0) = No axis
- VIRTUAL MASTER (1) = Virtual master

If you select this function, you will be able to configure additional settings by clicking on the enabled “Options...” button (see Section ""Virtual Master"" on page 286).

- PARA (2) = Master parameter interface

If you select this function because a higher-level controller is being used as

# Anti-reverse mode

Slave only starts moving along with it again as soon as the master reaches the zero position.

P 1320[0] - MPRO_ECAM_CamMaster_RevLockMode is used to define the reverse lock mode, which can be used either with or without path compensation. The dashed lines in the following diagrams indicate what the engagement distance is:

# Example:

If the master, which has moved two motor revolutions in the direction blocked for the slave, then moves in the unblocked direction again, the slave only moves off when the master has traversed the zero point.

- INACTIVE (0) = Reverse lock inactive
- ACTIVE (2) = Reverse lock enabled - without path optimization
- ACTIVE WAY COMP (1) = Reverse lock active - with way compensation

While the slave accelerates to the speed of the master during engagement, the master and slave do not move synchronously. This function needs to be selected in order to quickly catch up to the master that is running ahead.

# Example:

- Master (black line) rotates in the blocked direction
- The slave (blue line) remains stopped
- Master rotates in the unblocked direction again
- The slave follows the master directly in the unblocked direction

Assume the master has moved two motor revolutions in the direction for which the slave lock is enabled. If the master now moves in the direction for which there is no lock, the slave will immediately start running in that direction.

MOOG ID No.:CB40859-001 Date:11/2020

MSD ServoDrive - DeviceHelp 281

# 8 Motion profile

MOOG ID No.:CB40859-001 Date:11/2020 MSD ServoDrive - DeviceHelp 282

|Filter type|ID|Index Name|Unit|Description|
|---|---|---|---|---|
|When using a real master encoder, encoder signals may be subject to noise.|P 1340|1319|0|MPRO_ECAM_CamMaster_AxisType|
| | |MPRO_ECAM_CamMaster_SpeedFilTyp| |ECAM / EGEAR: Channel selection of internal master input|
| | |1320|0|MPRO_ECAM_CamMaster_RevLockMode|
| | |1321|0|MPRO_ECAM_CamMaster_Amplitude|
| | |1322|0|MPRO_ECAM_CamMaster_GearNum|
| | |1323|0|MPRO_ECAM_CamMaster_GearDen|
|Filter time|1327|0|ms|ECAM / EGEAR: Filter time constant of master|
|If P 1340[0] is used to enable a filter, P 1327[0] - MPRO_ECAM_CamMaster_SpeedTFil can be used to define the corresponding filter time.|1328|0|speed|ECAM / EGEAR: Speed factor of the internal master|
|Speed factor|1340|0| |MPRO_ECAM_CamMaster_SpeedFilTyp|
|The master encoder can be assigned an additional speed factor P 1328[0] - MPRO_ECAM_CamMaster_SpeedFactor.|1341|0|incr|ECAM / EGEAR: Master drive offset|

Table 8.37: “Synchronized motion - Master configuration” parameters (continue)

| | | |ID|Index Name|Unit|Description|
|---|---|---|---|---|---|---|
|247|0|MPRO_ECAM_ParaMaster_ActPos|incr|ECAM / EGEAR: Parameter interface master position| | |
|248|0|MPRO_ECAM_ParaMaster_ActSpeed|rpm|ECAM / EGEAR: Parameter interface master speed| | |
|249|0|MPRO_ECAM_ParaMaster_ActAcc|rpm|ECAM / EGEAR: Parameter interface master acceleration| | |
| |250|0|MPRO_ECAM_ParaMaster_Amplitude| |ECAM / EGEAR: Parameter interface master amplitude| |

Table 8.37: “Synchronized motion - Master configuration” parameters

# 8.11.5 Electronic gearing

# Gear ratio

The gear ratio is specified as a fraction. This ensures that the position references can be translated to the motor shaft with no rounding error.

- ""Slave"" (P 252[0] - MPRO_ECAM_Egear_GearNum) is the numerator
- ""Master"" (P 251[0] - MPRO_ECAM_Egear_GearDen) is the denominator

# Scaling of speed pre-control

Defined with P 265[0] - MPRO_ECAM_CamSlave_SpeedFactor definiert.

# Scaling of torque pre-control

Defined with P 266[0] - MPRO_ECAM_CamSlave_TorqueFactor.

# Engagement

See Section ""Engagement"" on page 284.

# Disengagement

See Section ""Disengagement"" on page 285.

|ID|Index Name|Unit|Description|
|---|---|---|---|
|251|0 MPRO_ECAM_Egear_GearDen| |EGEAR: Gear denominator|
|252|0 MPRO_ECAM_Egear_GearNum| |EGEAR: Numerator of gear ratio|
|1344|0 MPRO_ECAM_Egear_LimRefAcc|rpm/s|EGEAR: Acceleration limit for reference|
|1345|0 MPRO_ECAM_Egear_LimRefJerk|rpm/s²|EGEAR: Jerk limit for reference|

Table 8.38: “Synchronized motion - Electronic gearing” parameters

Image 8.73: ""Electronic gearing"" screen

MOOG ID No.:CB40859-001 Date:11/2020 MSD ServoDrive - DeviceHelp 283

# 8 Motion profile

# 8 Motion profile

MOOG ID No.:CB40859-001 Date:11/2020

MSD ServoDrive - DeviceHelp 284

# 8.11.6 Engagement

used to define the engagement distance (between the dashed lines).

P 253[0] - MPRO_ECAM_Egear_GearInMode is used to define the mode for engagement.

- DIRECT (0) = Direct
- Direct engagement: Angular synchronous; with jerking (no ramps).
- CROSSFADE (3) = Crossfading
- Engagement with crossfading function (5th degree polynomial): Angular synchronous; jerk-limited; speed will overshoot during engagement.
- RAMP (1) = Linear speed ramp
- Engagement with linear acceleration: Not angular synchronous; with jerking.
- FADE (2) = Engagement fade-out
- Engagement with fade-in function (5th degree polynomial): Not angular synchronous; jerk-limited. The position is ignored. ",What is the purpose of the offset parameter in the analog channels ISA00 and ISA01 according to the 'MSD ServoDrive - DeviceHelp' document?,A4,"To correct for component discrepancies, offset parameters are applied in analog channels.",2.015625,1.8828125,3.609375,1.25,0.41015625
39,msd_servo_drive.txt,76,b87ca5e232c2bdbb6fa16a8a401c6b5d285dc0183e73cc9d134de13dd2fc71d2,"MOOG ID No.:CB40859-001 Date:11/2020

MSD ServoDrive - DeviceHelp 267

# 8 Motion profile

MOOG ID No.:CB40859-001 Date:11/2020 MSD ServoDrive - DeviceHelp 268

# Deceleration

With ...

- P 194 - MPRO_TAB_TDec (for torque control) or
- P 197 - MPRO_TAB_SDec (for speed control) or
- P 200 - MPRO_TAB_PDec (for position control)

and indexes 0–15, the deceleration for each individual motion task can be defined. The input must not be zero.

# Wait time in Auto mode

P 204 - MPRO_TAB_WaitTime is used to define the wait time before the next motion task is carried out.

# Maximum table index in Auto mode

P 206[0] - MPRO_Tab_MaxIdx is used to define the table index up to which driving jobs will be carried out in one of the auto modes.

# Current table index

P 207[0] - MPRO_Tab_ActIdx will show the index for the motion task that is currently active. If parameter P 205 MPRO_TAB_Mode is set to “Para(0)”, a driving set can be entered and approached directly.

# Activation of reference table

The following procedures can be used in order to activate the setpoint table for operation.

|ID|Index Name|Unit|Description|
|---|---|---|---|
|193|MPRO_TAB_TAcc|TAB: Torque mode acceleration|Nm/ms|
|193|0|MPRO_TAB_TAcc|Nm/ms|
|193|1 - 15|MPRO_TAB_TAcc|Nm/ms|
|194|MPRO_TAB_TDec|TAB: Torque mode deceleration| |
|194|0|MPRO_TAB_TDec|Nm/ms|
|194|1 - 15|MPRO_TAB_TDec|Nm/ms|

# Table 8.23: Activation of table references

# Table 8.24: “Setpoint table settings” parameters

# Table 8.24: “Setpoint table settings” parameters (continue)

|ID|Index Name|Unit|Description|ID|Index Name|Unit|Description|
|---|---|---|---|---|---|---|---|
|195|MPRO_TAB_TRef|Nm|TAB: Torque mode reference value|208|MPRO_TAB_OutputNo| |OSD TAB: actual table index and target|
|195|MPRO_TAB_TRef|Nm| |208|MPRO_TAB_OutputNo| | |
|196|MPRO_TAB_SAcc|rev/min/s|TAB: Speed mode acceleration|269|MPRO_TAB_Ctrl| |TAB: control word|
|196|MPRO_TAB_SAcc|rev/min/s| | | | | |
|197|MPRO_TAB_SDec|rev/min/s|TAB: Speed mode deceleration| | | | |
|197|MPRO_TAB_SDec|rev/min/s| | | | | |
|198|MPRO_TAB_SRef|rev/min|TAB: Speed mode reference value| | | | |
|198|MPRO_TAB_SRef|rev/min| | | | | |
|199|MPRO_TAB_PAcc|rev/min/s|TAB: Position control mode acceleration| | | | |
|199|MPRO_TAB_PAcc|rev/min/s| | | | | |
|200|MPRO_TAB_PDec|rev/min/s|TAB: Position control mode Acceleration| | | | |
|200|MPRO_TAB_PDec|rev/min/s| | | | | |
|201|MPRO_TAB_PSpd|rev/min|TAB: Position control mode speed| | | | |
|201|MPRO_TAB_PSpd|rev/min| | | | | |
|202|MPRO_TAB_PPos|mDegree|TAB: Position control mode reference value| | | | |
|202|MPRO_TAB_PPos|mDegree| | | | | |
|203|MPRO_TAB_PMode| |Position control table:Mode| | | | |
|203|MPRO_TAB_PMode| | | | | | |
|204|MPRO_TAB_WaitTime|ms|TAB: Wait time| | | | |
|204|MPRO_TAB_WaitTime|ms| | | | | |
|205|MPRO_TAB_Mode| |TAB mode| | | | |
|206|MPRO_Tab_MaxIdx| |TAB: Max index in AUTO mode| | | | |
|207|MPRO_TAB_ActIdx| |TAB: Actual index| | | | |

MOOG ID No.:CB40859-001 Date:11/2020

MSD ServoDrive - DeviceHelp

# 8 Motion profile

MOOG ID No.:CB40859-001 Date:11/2020

MSD ServoDrive - DeviceHelp 270

# 8.8 Analog channel (ISA00 und ISA01)

# Offset (O)

This parameter (P 174 - MPRO_ANA0_SOffset for ISA00, P 184 - MPRO_ANA1_SOffset for ISA01) compensates for component variations and is used for offset compensation purposes. Depending on the control mode being used (see Section ""Basic settings"" on page 110), the value will be stored in parameter index [0] (torque control), [1] (speed control) or [2] (position control).

# Backlash (B)

This parameter (P 175 - MPRO_ANA0_SThreshold for ISA00, P 185 - MPRO_ANA1_SThreshold for ISA01) can suppress axis motion close to the standstill (stop) position. Depending on the control mode being used (see Section ""Basic settings"" on page 110), the value will be stored in parameter index [0] (torque control), [1] (speed control) or [2] (position control).

Image 8.68: “Analog channel” screen

# Acceleration ramp

Two standard analog inputs (ISA00, ISA01) are available. These inputs can be configured...

- with negative values for analog setpoint settings
- with positive values for digital setpoint processing

(P 109[0] - MPRO_INPUT_FS_ISA00 and P 110[0] - MPRO_INPUT_FS_ISA01).

see also section ""Analog Inputs"" on page 303. By using the ""REV(-2) = Analog setpoint"" setting, an analog input voltage of ±10 V can be processed as a setpoint.

# Deceleration ramp

This parameter serves as a deceleration ramp for torque control (P 176[1] - MPRO_ANA0_TRamp for ISA00, P 186[1] - MPRO_ANA1_TRamp for ISA01) or speed control (P 177[1] - MPRO_ANA0_SRamp for ISA00, P 187[1] - MPRO_ANA1_SRamp for ISA01). Depending on the control mode being used (see Section ""Basic settings"" on page 110), the value will be stored in parameter index [0] (torque control), [1] (speed control) or [2] (position control).

This parameter (P 173 - MPRO_ANA0_Scale for ISA00, P 183 - MPRO_ANA1_Scale for ISA01) is used to define which speed / which torque / which position corresponds to the maximum analog value. Depending on the control mode being used (see Section ""Basic settings"" on page 110), the value will be stored in parameter index [0] (torque control), [1] (speed control) or [2] (position control).

# 8.8.1 Special characteristics of position control mode

A threshold value can also be specified which generates a run-on range around the last reference value. A ramp function calculates a motion profile for the position reference from pre-defined acceleration and speed limits.

The position references on the analog channel are not applied immediately, but dependent on a digital input. Accordingly, one of the ISD00 to ISD06 digital inputs must be set to a value of ""REFANAEN(28) = Enable analog reference value"" (see Section ""Digital inputs"" on page 290). The position setpoint being received will only be applied if the corresponding digital input is active. The acceleration is entered using P 173[0] - MPRO_ANA0_TScale or P 183[0] - MPRO_ANA1_TScale.

# 8.8.2 Wire Break Monitoring

P 399 - CON_ANAWireBrk_Th can be used to configure wire break monitoring for the analog inputs. For details see Section ""Wire Break Monitoring"" on page 306.

|Function|TLIM (-4)|OVR (-3)|REFV (-2)|leer (-1)|OFF (0)|
|---|---|---|---|---|---|
|Digital|(1)-(28)|(1)-(28)|(1)-(28)|(1)-(28)|(1)-(28)|
|Analog channel|Filter|Scale|Offset|Profile|generator|

Control

Image 8.69: Reference processing structure

MOOG ID No.:CB40859-001 Date:11/2020

MSD ServoDrive - DeviceHelp 271

# 8 Motion profile

# 8 Motion profile

MOOG ID No.:CB40859-001 Date:11/2020

|ID|Index Name|Unit|Description|ID|
|---|---|---|---|---|
|395|CON_ANA_Isaf_Scaled| |Analog inputs: Values (filt, norm, comp, scaled)|174|
|395|0 ISA00| |Scaled, compensated, filtered, normalized value|175|
|395|1 ISA01| |Scaled, compensated, filtered, normalized value| |
|396|CON_ANA_Scale_ThUpper| |Analog inputs: Upper scaling limits|175|
|396|0 ISA00|%|Upper scaling (@ 10 V) threshold|175|
|396|1 ISA01|%|Upper scaling (@ 10 V) threshold| |
|397|CON_ANA_Scale_ThZero| |Analog inputs: Zero scaling thresholds|176|
|397|0 ISA00|V|Zero scaling threshold (+/-)|176|
|397|1 ISA01|V|Zero scaling threshold (+/-)| |
|398|CON_ANA_Scale_ThLower| |Analog inputs: Lower scaling limits|177|
|398|0 ISA00|%|Lower scaling (@ zero threshold) threshold|177|
|398|1 ISA01|%|Lower scaling (@ zero threshold) threshold| |
|399|CON_ANA_WireBrk_Th| |Analog inputs: Wire break thresholds|Table 8.26:|
|399|0 ISA00|V|Wire break detection threshold| |
|399|1 ISA01|V|Wire break detection threshold| |
|405|0 CON_ANA_Filt0|ms|Analog input ISA00: Filter time constant (PT 1)|ID|
|408|CON_ANA_Isaf_Norm| |Analog inputs: Values (filt, norm)|183|
|408|0 ISA00| |Filtered, normalized value|183|
|408|1 ISA01| |Filtered, normalized value|183|

Table 8.25: “Analog channel” parameters

|ID|Index Name|Unit|Description|ID|
|---|---|---|---|---|
|173|MPRO_ANA0_Scale| |ANA0: scale factors|184|
|173|0 MPRO_ANA0_TScale|Nm|ANA0: scale factor torque reference|185|
|173|1 MPRO_ANA0_SScale|rev/min|ANA0: scale factor speed reference|185|
|173|2 MPRO_ANA0_PScale|mDegree|ANA0: scale factor position reference| |
|174|MPRO_ANA0_Offset| |ANA0: offsets|185|
|174|0 MPRO_ANA0_TOffset|Nm|ANA0: offsets for torque reference|185|

Table 8.26: “Analog channel ISA00” parameters

|Index Name|Unit|Description|
|---|---|---|
|1 MPRO_ANA0_SOffset|rev/min|ANA0: offsets for speed reference|
|2 MPRO_ANA0_POffset|mDegree|ANA0: offsets for position reference|
|MPRO_ANA0_Threshold| |ANA0: thresholds|
|0 MPRO_ANA0_TThreshold|Nm|ANA0: threshold for torque reference|
|1 MPRO_ANA0_SThreshold|rev/min|ANA0: threshold for speed reference|
|2 MPRO_ANA0_PThreshold|mDegree|ANA0: threshold for position reference|
|MPRO_ANA0_TRamp| |ANA0: Torque mode acceleration [0] and deceleration [1]|
|0 MPRO_ANA0_TRamp|Nm/s| |
|1 MPRO_ANA0_TRamp|Nm/s| |
|MPRO_ANA0_SRamp| |ANA0: Speed mode acceleration [0] and deceleration [1]|
|0 MPRO_ANA0_SRamp|SPEED/s| |
|1 MPRO_ANA0_SRamp|SPEED/s| |

“Analog channel ISA00” parameters (continue)

|Index Name|Unit|Description|
|---|---|---|
|MPRO_ANA1_Scale| |ANA1: scale factors|
|0 MPRO_ANA1_TScale|Nm|ANA0: scale factor torque reference|
|1 MPRO_ANA1_SScale|rev/min|ANA0: scale factor speed reference|
|2 MPRO_ANA1_PScale|mDegree|ANA0: scale factor position reference|
|MPRO_ANA1_Offset| |ANA1: offsets|
|0 MPRO_ANA1_TOffset|Nm|ANA1: offsets for torque reference|
|1 MPRO_ANA1_SOffset|rev/min|ANA1: offsets for speed reference|
|2 MPRO_ANA1_POffset|mDegree|ANA1: offsets for position reference|
|MPRO_ANA1_Threshold| |ANA1: thresholds|
|0 MPRO_ANA1_TThreshold|Nm|ANA1: threshold for torque reference|
|1 MPRO_ANA1_SThreshold|rev/min|ANA1: threshold for speed reference|
|2 MPRO_ANA1_PThreshold|mDegree|ANA1: threshold for position reference|

“Analog channel ISA01” parameters

# 8 Motion profile

|ID|Index Name|Unit|Description|
|---|---|---|---|
|186|MPRO_ANA1_TRamp|Nm/s|ANA1: Torque mode acceleration [0] and deceleration[1]|
|186|MPRO_ANA1_TRamp|Nm/s| |
|187|MPRO_ANA1_SRamp|SPEED/s|ANA1: Speed mode acceleration [0] and deceleration [1]|
|187|MPRO_ANA1_SRamp|SPEED/s| |

# Table 8.27: “Analog channel ISA01” parameters (continue)

Display

- System state
- Initialization on device startup
- Not ready (DC link voltage possibly too low)
- Start inhibit (DC link voltage present, power stage off)
- Starting lockout
- Ready for start
- Control initialization: Auto commutation, flux build-up etc.

# Table 8.28: Central state machine according to CiA 402 device display

MOOG ID No.:CB40859-001 Date:11/2020

MSD ServoDrive - DeviceHelp 273

# 8 Motion profile

MOOG ID No.:CB40859-001 Date:11/2020

MSD ServoDrive - DeviceHelp 274

|Display|System state|power disabled|fault|
|---|---|---|---|
|Control enabled|0|Start|7|
| |fault reaction active|0|14|
|Quick stop active|1|not ready|8|
| |to switch on|1|17|
|Error reaction active|2|switch on|disabled|
| |2|7| |
|Error state (in this state the error is indicated directly on the display.)|3|ready to|switch on|
|Device is reset (display flashes)|power enabled|3|6|
| |10|12| |
|• Number [5.] flashes when “STO” (Safe Torque Off) input is active. Display goes out when STO inactive.| | | |
|• The dot on the display flashes when the power stage is active.| | | |

Table 8.28: Central state machine according to CiA 402 device display (continue)

NOTE

l The system states indicated on the display may differ from the states in the table depending on the drive profile setting.

Image 8.70: State machine diagram based on CANopen communications

⓪ to ① State number

1 to 17 State transition (No. 17: DC link voltage cut off)

Legend for “State machine diagram based on CANopen communications” figure

# 8.10 Touch probe

|ID|Index Name / Setting|
|---|---|
|241|0 MPRO_TP_Position|
|241|1 MPRO_TP_Position|
|241|2 MPRO_TP_Position|
|241|3 MPRO_TP_Position|
|241|4 MPRO_TP_Position|
|1400|0 MPRO_TP_Config|
| |TP_TP (0)|
| |AB (1)|
| |PD_UP (2)|
| |PD_DOWN (3)|
| |PC_PC (4)|
| |PC_TP (5)|
| |TP_PC (6)|
| |ENC_ENC (7)|
| |ENC_TP (8)|
| |TP_ENC (9)|

Using the touch probe inputs, touch probe functions can be performed. In order to be able to do this, P 106[0] - MPRO_INPUT_FS_ISD05 and P 107[0] - MPRO_INPUT_FS_ISD06 must be used to set digital inputs ISD05 and ISD06 to ""PROBE(15) = Touch probe (only ISD05/06)"" (see Section ""Digital inputs"" on page 290). HTL encoders can be evaluated or pulse counters implemented using the MSD PLC.

The touch probe can be triggered with P 240 - MPRO_TP_Ctrl. This enables triggering on a positive or negative edge, or on both edges, of the signal detected on the touch probe inputs. After the measurement, the parameter jumps back to the value ""NONE (0)"" and the latch position is mapped in the corresponding subindex of parameter P 241 - MPRO_TP_Position. A continuous touch probe mode is not possible at present, so the touch probe has to be reactivated after the measurement.

P 1402 - MPRO_TP_Channel can be used to select various positions as actual value sources of the latch position for the touch probe functionality. The following table provides an overview of the available settings. The counters are accessed via the MSD PLC or a bus system.

|ID|Index Name / Setting|Unit|Description|
|---|---|---|---|
|240|MPRO_TP_Ctrl|Touch probe: Control| |
| |0| |NONE (0) = No function|
| |1| |POS (1) = Positive edge|
| |2| |NEG (2) = Negative edge|
| |3| |BOTH (3) = Both edges|
|240|0 MPRO_TP_Ctrl| | |
|240|1 MPRO_TP_Ctrl| | |
|240|2 MPRO_TP_Ctrl| | |
|241|MPRO_TP_Position|Probe: Pos. high/low edge of TP0/1, encoder zero pulse| |

Table 8.29: “Touch probe” parameters

MOOG ID No.:CB40859-001 Date:11/2020

# 8 Motion profile

|Unit|Description|
|---|---|
|mDegree|Touch probe: Configuration|
|mDegree|TP0, TP1 touch probe|
|mDegree|TP0, TP1 as encoder, A/B as quadrature counting|
|mDegree|TP0, TP1 as encoder, pulse (TP0) / direction (TP1), count up on direction high|
|mDegree|TP0, TP1 as encoder, pulse (TP0) / direction (TP1), count down on direction high|
|mDegree|TP0 pulse counter, TP1 pulse counter|
|mDegree|TP0 pulse counter, TP1 touch probe|
|mDegree|TP1 touch probe, TP0 pulse counter|
|mDegree|TP0 encoder counter, TP1 encoder counter|
|mDegree|TP0 encoder counter, TP1 touch probe|
|mDegree|TP0 touch probe, TP1 encoder counter|

Touch probe: Channel

|Unit|Description|
|---|---|
|ACTPOS (0)|Actual position in user units|
|ACTPOSINC (1)|Actual position in increments|
|MASTERPOS (2)|Master position in increments|
|ENCPOS_CH1 (3)|Encoder position Channel 1|
|ENCPOS_CH1_INC (4)|Encoder position Channel 1 in increments|
|ENCPOS_CH2 (5)|Encoder position Channel 2|
|ENCPOS_CH2_INC (6)|Encoder position Channel 2 in increments|

# 8 Motion profile

MOOG ID No.:CB40859-001 Date:11/2020 MSD ServoDrive - DeviceHelp 276

|ID|Index Name / Setting|Unit|Description|
|---|---|---|---|
|7|ENCPOS_CH3 (7)| |Encoder position Channel 3|
|8|ENCPOS_CH3_INC (8)| |Encoder position Channel 3 in increments|
|9|ENCPOS_CH4 (9)| |Encoder position Channel 4|
|10|ENCPOS_CH4_INC (10)| |Encoder position Channel 4 in increments|
|11|ACTPOS2 (11)| |Actual position of redundant encoder in user units|
|12|Sercos (12)| |Referred to Sercos profile parameters S-x-0426, S-x-0427|
|13|UserRefPos(13)| |Reference position in user units|
|14|MasterPosST(14)| |Master position (ECAM, EGEAR) singleturn, always steps|
|15|CommonMasterPos(15)| |Master position (ECAM, EGEAR) singleturn, always steps|
|16|CommonMasterPosST(15)| |Master position (ECAM, EGEAR) singleturn, always steps|
|1402|MPRO_TP_Channel| | |
|1402|MPRO_TP_Channel| | |
|1402|MPRO_TP_Channel| | |
|1404|MPRO_TP_Lines| |Touch probe: Lines @ pulse counter on channel x|
|1404|MPRO_TP_Lines| | |
|1404|MPRO_TP_Lines| | |

Image 8.71: “Synchronized motion” screen

There are various modes available in the “synchronization mode” drop-down menu (P 242[0] - MPRO_ECAM_SyncModMode):

- Off(0) = Synchronized motion off
- ECAM_iPlc(1) = Electronic cam plate via MSD PLC
- EGEAR_iPlc(2) = Electr. gear unit via MSD PLC
- ECAM_PARA(3) = Electronic camming via parameters
- EGEAR_PARA(4) = Electronic gearing via parameters

NOTE: For more information refer to the bus system User Manuals or the description of the MSD PLC.

# 8.11.1 Electronic cam plate

The other parameters are configured in separate screens that can be accessed with the corresponding buttons.

- Master configuration (see Section ""Master configuration"" on page 280)
- Electronic gearing (see Section ""Electronic gearing"" on page 283)
- Electronic camming (see Section ""Electronic cam plate"" on page 277)

P 1318[0] - MPRO_ECAM_ControlWord is the control word for “synchronized motion” (see Section ""Control word for synchronized motion"" on page 279).

P 1326[0] - MPRO_ECAM_StatusWord is the status word for “synchronized motion” (see Section ""Status word for synchronized motion"" on page 279).

# 8.11.1.1 Table selection

|ID|Index Name|Unit|Description|
|---|---|---|---|
|1300|MPRO_ECAM_CTS_| |ECAM: CamTableSelect - Master reference|
|1301|MasterRef| | |
|1305|MPRO_ECAM_CTS_| |ECAM: CamTableSelect - Method for changing the camtable|
|1306|MPRO_ECAM_CTS_| |ECAM: CamTableSelect - Mode for changing the camtable|
|1307|MPRO_ECAM_CTS_|incr|ECAM: CamTableSelect - Distance for changing the camtable|
|242|MPRO_ECAM_| |ECAM / EGEAR: Mode of synchronized motion SyncModMode|
|265|MPRO_ECAM_| |ECAM / EGEAR: Slave speed factor (1 = 100%).|
|266|CamSlave_SpeedFactor| | |
|268|MPRO_ECAM_| |ECAM / EGEAR: Mode of switching off sync. motion|

# 8.11.1.2 Synchronization

|ID|Index Name|Unit|Description|
|---|---|---|---|
|1342|MPRO_ECAM_CI_|incr|ECAM: CamIn - Synchronization position (multiturn part)|
|1343|MPRO_ECAM_CO_|incr|ECAM: CamOut - Decoupling pos. (multiturn part)|
|1303|MPRO_ECAM_CI_|incr|ECAM: CamIn - Master offset|
|1308|MPRO_ECAM_CI_| |ECAM: CamIn - Master reference|
|1309|MPRO_ECAM_CI_| |ECAM: CamIn - Slave reference|
|1310|MPRO_ECAM_CI_| |ECAM: CamIn - Coupling mode|
|1311|MPRO_ECAM_CI_|incr|ECAM: CamIn - Coupling distance|
|1312|MPRO_ECAM_CI_|incr|ECAM: CamIn - Synchronization position|

Table 8.31: “Electronic camming - Table selection” parameters

Table 8.30: “Synchronized motion” parameters

Table 8.32: “Electronic camming - Synchronization” parameters

MOOG ID No.:CB40859-001 Date:11/2020

MSD ServoDrive - DeviceHelp 277

# 8 Motion profile

MOOG ID No.:CB40859-001 Date:11/2020 MSD ServoDrive - DeviceHelp 278

|ID|Index|Name|Unit|Description|
|---|---|---|---|---|
|1313|0|MPRO_ECAM_CO_SyncPosST|(singleturn part)|ECAM: CamOut - Slave reference|
|1314|0|MPRO_ECAM_CO_DecouplingMode|63|ECAM: CamOut - Decoupling mode|
|1315|0|MPRO_ECAM_CO_BreakingPosST|incr|ECAM: CamOut - Decoupling position|
|1316|0|MPRO_ECAM_CO_DecouplingDist|incr|ECAM: CamOut - Decoupling distance|
|1317|0|MPRO_ECAM_CO_StandstillPos|mDegree|ECAM: CamOut - Slave standstill position|

# Table 8.32: “Electronic camming - Synchronization” parameters (continue)

|ID|Index|Name|Unit|Description|
|---|---|---|---|---|
|1346| |MPRO_ECAM_SP_Table| |ECAM: Setpoint table interface|
|1346|0|Index| |Index of setpoint table|
|1346|1|Value| |Value at index of setpoint table|
|1347|0 to 31|MPRO_ECAM_SP_Index| |ECAM: Setpoint segments start index|
|1348|0 to 31|MPRO_ECAM_SP_Length| |ECAM: Setpoint segments length|
|1349|0 to 31|Length| | |
|1350|0|MPRO_ECAM_SP_MaDist| |ECAM: Setpoint segments master distance|
|1351|0|MPRO_ECAM_SP_IpoType| |ECAM: Setpoint segments interpolation type|
|1352|0 to 31|Checksum| |ECAM: Setpoint table checksum|
|1353|0 to 31|GainNum| |ECAM: Setpoint segments gain numerator|
| | |GainDen| |ECAM: Setpoint segments gain denominator|

# Table 8.33: “Electronic camming - Table segments” parameters

|ID|Index|Name|Unit|Description|
|---|---|---|---|---|
|1329|0 to 63|MPRO_ECAM_SegData_IndexNext| |ECAM: Index of the following segment|
|1330|0 to 63|MPRO_ECAM_SegData_IndexPrev| |ECAM: Index of the previous segment|
|1331|0 to 63|MPRO_ECAM_SegData_ProfileMode| |ECAM: Profile mode of the current segment|
|1332|0 to 63|MPRO_ECAM_SegData_DistMaster| |ECAM: Length of the master section of the current segment|
|1333|0 to 63|MPRO_ECAM_SegData_DistSlave| |ECAM: Length of the slave section of the current segment|
|1334|0 to 63|MPRO_ECAM_SegData_Lambda| |ECAM: Lambda value of the current segment|
|1335|0 to 63|MPRO_ECAM_SegData_StatusWord| |ECAM: Status word of the current segment|
|1336|0 to 63|MPRO_ECAM_SegData_ControlWord| |ECAM: Control word of the current segment|

# 8.11.2 Control word for synchronized motion

|Bit|Function|PLC function|Bit number|Description|
|---|---|---|---|---|
|0-7|Start segment (8-bit value)|-|0-7|Actual segment (8-bit value)|
|8-15|Reserved|-| |Actual ECAM / EGEAR state machine state (4 Bit value)|
|16|Absolute (true) / relative (false) master relationship|-| |- 0: ECAM / EGEAR asynchronous
- 1: ECAM / EGEAR synchronous
|
|17|Absolute (true) / relative (false) master (CAM) relationship at cam in|-| |- 2: ECAM / EGEAR synchronizing
- 3: ECAM / EGEAR desynchronizing
|
|18|Absolute (true) / relative (false) slave (CAM) relationship at cam in|-| |- 4: ECAM / EGEAR active and waiting for going asynchronous
|
|19-23|Reserved|-| |- 5: ECAM / EGEAR inactive and waiting for going synchronous
|
|24|Change gear ratio of the electronic gear online|MCB_GearRatioChange| | |
|25|Disable master calculation|MCB_Cam_MasterEnable| | |
|26|Enable master calculation|MCB_Cam_MasterEnable| | |
|27|Select CAM table|MCB_CamTableSelect| | |
|28|Start Ecam|MCB_CamIn| | |
|29|Stop Ecam|MCB_CamOut| | |
|30|Start Egear|MCB_GearIn| | |
|31|Stop Egear|MCB_GearOut| | |

# 8.11.3 Status word for synchronized motion

|Bit|Function|PLC function|Bit number|Description|
|---|---|---|---|---|
|12-26|Reserved|-| | |
|27|ECAM / EGEAR is active|-| | |
|28|Valid segments chosen|-| | |
|29|Master data are valid|-| | |
|30|Master is initialized|-| | |
|31|Master calculation is active|-| | |

Table 8.35: Control word ECAM (P 1318[0] - MPRO_ECAM_ControlWord)

Table 8.36: ECAM status word (P 1326[0] - MPRO_ECAM_StatusWord)

MOOG ID No.:CB40859-001 Date:11/2020 MSD ServoDrive - DeviceHelp 279

# 8 Motion profile

# 8 Motion profile

MOOG ID No.:CB40859-001 Date:11/2020

MSD ServoDrive - DeviceHelp 280

# 8.11.4 Master configuration

the master encoder, you will need to set the resolution relative to a single motor revolution in P 250 - MPRO_ECAM_PARAMaster_Amplitude (see below).

- ENC CH1 (3) = Encoder channel 1 X7 (Sin/Cos)
- ENC CH2 (4) = Encoder channel 2 X6 (Resolver)
- ENC CH3 (5) = Encoder channel 3 X8 (optional)

This function is only available if an external interface X8 (option module) is present.

- TP0 (6) = Pulse counter on probe channel 0 (TP0)
- TP1 (7) = Pulse counter on probe channel 1 (TP1)
- ENC_CH4 (8) = Encoder channel 4 (p. e. fieldbus)
- TWIN_POS (9) = TWIN remote reference position (P-2607)

Image 8.72: “Master configuration” screen

# Channel selection (master encoder)

P 1319[0] - MPRO_ECAM_CamMaster_AxisType is used to define the master encoder.

- NO AXIS (0) = No axis
- VIRTUAL MASTER (1) = Virtual master

If you select this function, you will be able to configure additional settings by clicking on the enabled “Options...” button (see Section ""Virtual Master"" on page 286).

- PARA (2) = Master parameter interface

If you select this function because a higher-level controller is being used as

# Anti-reverse mode

Slave only starts moving along with it again as soon as the master reaches the zero position.

P 1320[0] - MPRO_ECAM_CamMaster_RevLockMode is used to define the reverse lock mode, which can be used either with or without path compensation. The dashed lines in the following diagrams indicate what the engagement distance is:

# Example:

If the master, which has moved two motor revolutions in the direction blocked for the slave, then moves in the unblocked direction again, the slave only moves off when the master has traversed the zero point.

- INACTIVE (0) = Reverse lock inactive
- ACTIVE (2) = Reverse lock enabled - without path optimization
- ACTIVE WAY COMP (1) = Reverse lock active - with way compensation

While the slave accelerates to the speed of the master during engagement, the master and slave do not move synchronously. This function needs to be selected in order to quickly catch up to the master that is running ahead.

# Example:

- Master (black line) rotates in the blocked direction
- The slave (blue line) remains stopped
- Master rotates in the unblocked direction again
- The slave follows the master directly in the unblocked direction

Assume the master has moved two motor revolutions in the direction for which the slave lock is enabled. If the master now moves in the direction for which there is no lock, the slave will immediately start running in that direction.

MOOG ID No.:CB40859-001 Date:11/2020

MSD ServoDrive - DeviceHelp 281

# 8 Motion profile

MOOG ID No.:CB40859-001 Date:11/2020 MSD ServoDrive - DeviceHelp 282

|Filter type|ID|Index Name|Unit|Description|
|---|---|---|---|---|
|When using a real master encoder, encoder signals may be subject to noise.|P 1340|1319|0|MPRO_ECAM_CamMaster_AxisType|
| | |MPRO_ECAM_CamMaster_SpeedFilTyp| |ECAM / EGEAR: Channel selection of internal master input|
| | |1320|0|MPRO_ECAM_CamMaster_RevLockMode|
| | |1321|0|MPRO_ECAM_CamMaster_Amplitude|
| | |1322|0|MPRO_ECAM_CamMaster_GearNum|
| | |1323|0|MPRO_ECAM_CamMaster_GearDen|
|Filter time|1327|0|ms|ECAM / EGEAR: Filter time constant of master|
|If P 1340[0] is used to enable a filter, P 1327[0] - MPRO_ECAM_CamMaster_SpeedTFil can be used to define the corresponding filter time.|1328|0|speed|ECAM / EGEAR: Speed factor of the internal master|
|Speed factor|1340|0| |MPRO_ECAM_CamMaster_SpeedFilTyp|
|The master encoder can be assigned an additional speed factor P 1328[0] - MPRO_ECAM_CamMaster_SpeedFactor.|1341|0|incr|ECAM / EGEAR: Master drive offset|

Table 8.37: “Synchronized motion - Master configuration” parameters (continue)

| | | |ID|Index Name|Unit|Description|
|---|---|---|---|---|---|---|
|247|0|MPRO_ECAM_ParaMaster_ActPos|incr|ECAM / EGEAR: Parameter interface master position| | |
|248|0|MPRO_ECAM_ParaMaster_ActSpeed|rpm|ECAM / EGEAR: Parameter interface master speed| | |
|249|0|MPRO_ECAM_ParaMaster_ActAcc|rpm|ECAM / EGEAR: Parameter interface master acceleration| | |
| |250|0|MPRO_ECAM_ParaMaster_Amplitude| |ECAM / EGEAR: Parameter interface master amplitude| |

Table 8.37: “Synchronized motion - Master configuration” parameters

# 8.11.5 Electronic gearing

# Gear ratio

The gear ratio is specified as a fraction. This ensures that the position references can be translated to the motor shaft with no rounding error.

- ""Slave"" (P 252[0] - MPRO_ECAM_Egear_GearNum) is the numerator
- ""Master"" (P 251[0] - MPRO_ECAM_Egear_GearDen) is the denominator

# Scaling of speed pre-control

Defined with P 265[0] - MPRO_ECAM_CamSlave_SpeedFactor definiert.

# Scaling of torque pre-control

Defined with P 266[0] - MPRO_ECAM_CamSlave_TorqueFactor.

# Engagement

See Section ""Engagement"" on page 284.

# Disengagement

See Section ""Disengagement"" on page 285.

|ID|Index Name|Unit|Description|
|---|---|---|---|
|251|0 MPRO_ECAM_Egear_GearDen| |EGEAR: Gear denominator|
|252|0 MPRO_ECAM_Egear_GearNum| |EGEAR: Numerator of gear ratio|
|1344|0 MPRO_ECAM_Egear_LimRefAcc|rpm/s|EGEAR: Acceleration limit for reference|
|1345|0 MPRO_ECAM_Egear_LimRefJerk|rpm/s²|EGEAR: Jerk limit for reference|

Table 8.38: “Synchronized motion - Electronic gearing” parameters

Image 8.73: ""Electronic gearing"" screen

MOOG ID No.:CB40859-001 Date:11/2020 MSD ServoDrive - DeviceHelp 283

# 8 Motion profile

# 8 Motion profile

MOOG ID No.:CB40859-001 Date:11/2020

MSD ServoDrive - DeviceHelp 284

# 8.11.6 Engagement

used to define the engagement distance (between the dashed lines).

P 253[0] - MPRO_ECAM_Egear_GearInMode is used to define the mode for engagement.

- DIRECT (0) = Direct
- Direct engagement: Angular synchronous; with jerking (no ramps).
- CROSSFADE (3) = Crossfading
- Engagement with crossfading function (5th degree polynomial): Angular synchronous; jerk-limited; speed will overshoot during engagement.
- RAMP (1) = Linear speed ramp
- Engagement with linear acceleration: Not angular synchronous; with jerking.
- FADE (2) = Engagement fade-out
- Engagement with fade-in function (5th degree polynomial): Not angular synchronous; jerk-limited. The position is ignored. ",What is the purpose of the offset parameter in the analog channels ISA00 and ISA01 according to the 'MSD ServoDrive - DeviceHelp' document?,A5,Offset settings in ISA00 and ISA01 ensure precise compensation for component differences.,1.9765625,1.9296875,3.453125,1.4609375,0.28125
40,msd_servo_drive.txt,76,b87ca5e232c2bdbb6fa16a8a401c6b5d285dc0183e73cc9d134de13dd2fc71d2,"MOOG ID No.:CB40859-001 Date:11/2020

MSD ServoDrive - DeviceHelp 267

# 8 Motion profile

MOOG ID No.:CB40859-001 Date:11/2020 MSD ServoDrive - DeviceHelp 268

# Deceleration

With ...

- P 194 - MPRO_TAB_TDec (for torque control) or
- P 197 - MPRO_TAB_SDec (for speed control) or
- P 200 - MPRO_TAB_PDec (for position control)

and indexes 0–15, the deceleration for each individual motion task can be defined. The input must not be zero.

# Wait time in Auto mode

P 204 - MPRO_TAB_WaitTime is used to define the wait time before the next motion task is carried out.

# Maximum table index in Auto mode

P 206[0] - MPRO_Tab_MaxIdx is used to define the table index up to which driving jobs will be carried out in one of the auto modes.

# Current table index

P 207[0] - MPRO_Tab_ActIdx will show the index for the motion task that is currently active. If parameter P 205 MPRO_TAB_Mode is set to “Para(0)”, a driving set can be entered and approached directly.

# Activation of reference table

The following procedures can be used in order to activate the setpoint table for operation.

|ID|Index Name|Unit|Description|
|---|---|---|---|
|193|MPRO_TAB_TAcc|TAB: Torque mode acceleration|Nm/ms|
|193|0|MPRO_TAB_TAcc|Nm/ms|
|193|1 - 15|MPRO_TAB_TAcc|Nm/ms|
|194|MPRO_TAB_TDec|TAB: Torque mode deceleration| |
|194|0|MPRO_TAB_TDec|Nm/ms|
|194|1 - 15|MPRO_TAB_TDec|Nm/ms|

# Table 8.23: Activation of table references

# Table 8.24: “Setpoint table settings” parameters

# Table 8.24: “Setpoint table settings” parameters (continue)

|ID|Index Name|Unit|Description|ID|Index Name|Unit|Description|
|---|---|---|---|---|---|---|---|
|195|MPRO_TAB_TRef|Nm|TAB: Torque mode reference value|208|MPRO_TAB_OutputNo| |OSD TAB: actual table index and target|
|195|MPRO_TAB_TRef|Nm| |208|MPRO_TAB_OutputNo| | |
|196|MPRO_TAB_SAcc|rev/min/s|TAB: Speed mode acceleration|269|MPRO_TAB_Ctrl| |TAB: control word|
|196|MPRO_TAB_SAcc|rev/min/s| | | | | |
|197|MPRO_TAB_SDec|rev/min/s|TAB: Speed mode deceleration| | | | |
|197|MPRO_TAB_SDec|rev/min/s| | | | | |
|198|MPRO_TAB_SRef|rev/min|TAB: Speed mode reference value| | | | |
|198|MPRO_TAB_SRef|rev/min| | | | | |
|199|MPRO_TAB_PAcc|rev/min/s|TAB: Position control mode acceleration| | | | |
|199|MPRO_TAB_PAcc|rev/min/s| | | | | |
|200|MPRO_TAB_PDec|rev/min/s|TAB: Position control mode Acceleration| | | | |
|200|MPRO_TAB_PDec|rev/min/s| | | | | |
|201|MPRO_TAB_PSpd|rev/min|TAB: Position control mode speed| | | | |
|201|MPRO_TAB_PSpd|rev/min| | | | | |
|202|MPRO_TAB_PPos|mDegree|TAB: Position control mode reference value| | | | |
|202|MPRO_TAB_PPos|mDegree| | | | | |
|203|MPRO_TAB_PMode| |Position control table:Mode| | | | |
|203|MPRO_TAB_PMode| | | | | | |
|204|MPRO_TAB_WaitTime|ms|TAB: Wait time| | | | |
|204|MPRO_TAB_WaitTime|ms| | | | | |
|205|MPRO_TAB_Mode| |TAB mode| | | | |
|206|MPRO_Tab_MaxIdx| |TAB: Max index in AUTO mode| | | | |
|207|MPRO_TAB_ActIdx| |TAB: Actual index| | | | |

MOOG ID No.:CB40859-001 Date:11/2020

MSD ServoDrive - DeviceHelp

# 8 Motion profile

MOOG ID No.:CB40859-001 Date:11/2020

MSD ServoDrive - DeviceHelp 270

# 8.8 Analog channel (ISA00 und ISA01)

# Offset (O)

This parameter (P 174 - MPRO_ANA0_SOffset for ISA00, P 184 - MPRO_ANA1_SOffset for ISA01) compensates for component variations and is used for offset compensation purposes. Depending on the control mode being used (see Section ""Basic settings"" on page 110), the value will be stored in parameter index [0] (torque control), [1] (speed control) or [2] (position control).

# Backlash (B)

This parameter (P 175 - MPRO_ANA0_SThreshold for ISA00, P 185 - MPRO_ANA1_SThreshold for ISA01) can suppress axis motion close to the standstill (stop) position. Depending on the control mode being used (see Section ""Basic settings"" on page 110), the value will be stored in parameter index [0] (torque control), [1] (speed control) or [2] (position control).

Image 8.68: “Analog channel” screen

# Acceleration ramp

Two standard analog inputs (ISA00, ISA01) are available. These inputs can be configured...

- with negative values for analog setpoint settings
- with positive values for digital setpoint processing

(P 109[0] - MPRO_INPUT_FS_ISA00 and P 110[0] - MPRO_INPUT_FS_ISA01).

see also section ""Analog Inputs"" on page 303. By using the ""REV(-2) = Analog setpoint"" setting, an analog input voltage of ±10 V can be processed as a setpoint.

# Deceleration ramp

This parameter serves as a deceleration ramp for torque control (P 176[1] - MPRO_ANA0_TRamp for ISA00, P 186[1] - MPRO_ANA1_TRamp for ISA01) or speed control (P 177[1] - MPRO_ANA0_SRamp for ISA00, P 187[1] - MPRO_ANA1_SRamp for ISA01). Depending on the control mode being used (see Section ""Basic settings"" on page 110), the value will be stored in parameter index [0] (torque control), [1] (speed control) or [2] (position control).

This parameter (P 173 - MPRO_ANA0_Scale for ISA00, P 183 - MPRO_ANA1_Scale for ISA01) is used to define which speed / which torque / which position corresponds to the maximum analog value. Depending on the control mode being used (see Section ""Basic settings"" on page 110), the value will be stored in parameter index [0] (torque control), [1] (speed control) or [2] (position control).

# 8.8.1 Special characteristics of position control mode

A threshold value can also be specified which generates a run-on range around the last reference value. A ramp function calculates a motion profile for the position reference from pre-defined acceleration and speed limits.

The position references on the analog channel are not applied immediately, but dependent on a digital input. Accordingly, one of the ISD00 to ISD06 digital inputs must be set to a value of ""REFANAEN(28) = Enable analog reference value"" (see Section ""Digital inputs"" on page 290). The position setpoint being received will only be applied if the corresponding digital input is active. The acceleration is entered using P 173[0] - MPRO_ANA0_TScale or P 183[0] - MPRO_ANA1_TScale.

# 8.8.2 Wire Break Monitoring

P 399 - CON_ANAWireBrk_Th can be used to configure wire break monitoring for the analog inputs. For details see Section ""Wire Break Monitoring"" on page 306.

|Function|TLIM (-4)|OVR (-3)|REFV (-2)|leer (-1)|OFF (0)|
|---|---|---|---|---|---|
|Digital|(1)-(28)|(1)-(28)|(1)-(28)|(1)-(28)|(1)-(28)|
|Analog channel|Filter|Scale|Offset|Profile|generator|

Control

Image 8.69: Reference processing structure

MOOG ID No.:CB40859-001 Date:11/2020

MSD ServoDrive - DeviceHelp 271

# 8 Motion profile

# 8 Motion profile

MOOG ID No.:CB40859-001 Date:11/2020

|ID|Index Name|Unit|Description|ID|
|---|---|---|---|---|
|395|CON_ANA_Isaf_Scaled| |Analog inputs: Values (filt, norm, comp, scaled)|174|
|395|0 ISA00| |Scaled, compensated, filtered, normalized value|175|
|395|1 ISA01| |Scaled, compensated, filtered, normalized value| |
|396|CON_ANA_Scale_ThUpper| |Analog inputs: Upper scaling limits|175|
|396|0 ISA00|%|Upper scaling (@ 10 V) threshold|175|
|396|1 ISA01|%|Upper scaling (@ 10 V) threshold| |
|397|CON_ANA_Scale_ThZero| |Analog inputs: Zero scaling thresholds|176|
|397|0 ISA00|V|Zero scaling threshold (+/-)|176|
|397|1 ISA01|V|Zero scaling threshold (+/-)| |
|398|CON_ANA_Scale_ThLower| |Analog inputs: Lower scaling limits|177|
|398|0 ISA00|%|Lower scaling (@ zero threshold) threshold|177|
|398|1 ISA01|%|Lower scaling (@ zero threshold) threshold| |
|399|CON_ANA_WireBrk_Th| |Analog inputs: Wire break thresholds|Table 8.26:|
|399|0 ISA00|V|Wire break detection threshold| |
|399|1 ISA01|V|Wire break detection threshold| |
|405|0 CON_ANA_Filt0|ms|Analog input ISA00: Filter time constant (PT 1)|ID|
|408|CON_ANA_Isaf_Norm| |Analog inputs: Values (filt, norm)|183|
|408|0 ISA00| |Filtered, normalized value|183|
|408|1 ISA01| |Filtered, normalized value|183|

Table 8.25: “Analog channel” parameters

|ID|Index Name|Unit|Description|ID|
|---|---|---|---|---|
|173|MPRO_ANA0_Scale| |ANA0: scale factors|184|
|173|0 MPRO_ANA0_TScale|Nm|ANA0: scale factor torque reference|185|
|173|1 MPRO_ANA0_SScale|rev/min|ANA0: scale factor speed reference|185|
|173|2 MPRO_ANA0_PScale|mDegree|ANA0: scale factor position reference| |
|174|MPRO_ANA0_Offset| |ANA0: offsets|185|
|174|0 MPRO_ANA0_TOffset|Nm|ANA0: offsets for torque reference|185|

Table 8.26: “Analog channel ISA00” parameters

|Index Name|Unit|Description|
|---|---|---|
|1 MPRO_ANA0_SOffset|rev/min|ANA0: offsets for speed reference|
|2 MPRO_ANA0_POffset|mDegree|ANA0: offsets for position reference|
|MPRO_ANA0_Threshold| |ANA0: thresholds|
|0 MPRO_ANA0_TThreshold|Nm|ANA0: threshold for torque reference|
|1 MPRO_ANA0_SThreshold|rev/min|ANA0: threshold for speed reference|
|2 MPRO_ANA0_PThreshold|mDegree|ANA0: threshold for position reference|
|MPRO_ANA0_TRamp| |ANA0: Torque mode acceleration [0] and deceleration [1]|
|0 MPRO_ANA0_TRamp|Nm/s| |
|1 MPRO_ANA0_TRamp|Nm/s| |
|MPRO_ANA0_SRamp| |ANA0: Speed mode acceleration [0] and deceleration [1]|
|0 MPRO_ANA0_SRamp|SPEED/s| |
|1 MPRO_ANA0_SRamp|SPEED/s| |

“Analog channel ISA00” parameters (continue)

|Index Name|Unit|Description|
|---|---|---|
|MPRO_ANA1_Scale| |ANA1: scale factors|
|0 MPRO_ANA1_TScale|Nm|ANA0: scale factor torque reference|
|1 MPRO_ANA1_SScale|rev/min|ANA0: scale factor speed reference|
|2 MPRO_ANA1_PScale|mDegree|ANA0: scale factor position reference|
|MPRO_ANA1_Offset| |ANA1: offsets|
|0 MPRO_ANA1_TOffset|Nm|ANA1: offsets for torque reference|
|1 MPRO_ANA1_SOffset|rev/min|ANA1: offsets for speed reference|
|2 MPRO_ANA1_POffset|mDegree|ANA1: offsets for position reference|
|MPRO_ANA1_Threshold| |ANA1: thresholds|
|0 MPRO_ANA1_TThreshold|Nm|ANA1: threshold for torque reference|
|1 MPRO_ANA1_SThreshold|rev/min|ANA1: threshold for speed reference|
|2 MPRO_ANA1_PThreshold|mDegree|ANA1: threshold for position reference|

“Analog channel ISA01” parameters

# 8 Motion profile

|ID|Index Name|Unit|Description|
|---|---|---|---|
|186|MPRO_ANA1_TRamp|Nm/s|ANA1: Torque mode acceleration [0] and deceleration[1]|
|186|MPRO_ANA1_TRamp|Nm/s| |
|187|MPRO_ANA1_SRamp|SPEED/s|ANA1: Speed mode acceleration [0] and deceleration [1]|
|187|MPRO_ANA1_SRamp|SPEED/s| |

# Table 8.27: “Analog channel ISA01” parameters (continue)

Display

- System state
- Initialization on device startup
- Not ready (DC link voltage possibly too low)
- Start inhibit (DC link voltage present, power stage off)
- Starting lockout
- Ready for start
- Control initialization: Auto commutation, flux build-up etc.

# Table 8.28: Central state machine according to CiA 402 device display

MOOG ID No.:CB40859-001 Date:11/2020

MSD ServoDrive - DeviceHelp 273

# 8 Motion profile

MOOG ID No.:CB40859-001 Date:11/2020

MSD ServoDrive - DeviceHelp 274

|Display|System state|power disabled|fault|
|---|---|---|---|
|Control enabled|0|Start|7|
| |fault reaction active|0|14|
|Quick stop active|1|not ready|8|
| |to switch on|1|17|
|Error reaction active|2|switch on|disabled|
| |2|7| |
|Error state (in this state the error is indicated directly on the display.)|3|ready to|switch on|
|Device is reset (display flashes)|power enabled|3|6|
| |10|12| |
|• Number [5.] flashes when “STO” (Safe Torque Off) input is active. Display goes out when STO inactive.| | | |
|• The dot on the display flashes when the power stage is active.| | | |

Table 8.28: Central state machine according to CiA 402 device display (continue)

NOTE

l The system states indicated on the display may differ from the states in the table depending on the drive profile setting.

Image 8.70: State machine diagram based on CANopen communications

⓪ to ① State number

1 to 17 State transition (No. 17: DC link voltage cut off)

Legend for “State machine diagram based on CANopen communications” figure

# 8.10 Touch probe

|ID|Index Name / Setting|
|---|---|
|241|0 MPRO_TP_Position|
|241|1 MPRO_TP_Position|
|241|2 MPRO_TP_Position|
|241|3 MPRO_TP_Position|
|241|4 MPRO_TP_Position|
|1400|0 MPRO_TP_Config|
| |TP_TP (0)|
| |AB (1)|
| |PD_UP (2)|
| |PD_DOWN (3)|
| |PC_PC (4)|
| |PC_TP (5)|
| |TP_PC (6)|
| |ENC_ENC (7)|
| |ENC_TP (8)|
| |TP_ENC (9)|

Using the touch probe inputs, touch probe functions can be performed. In order to be able to do this, P 106[0] - MPRO_INPUT_FS_ISD05 and P 107[0] - MPRO_INPUT_FS_ISD06 must be used to set digital inputs ISD05 and ISD06 to ""PROBE(15) = Touch probe (only ISD05/06)"" (see Section ""Digital inputs"" on page 290). HTL encoders can be evaluated or pulse counters implemented using the MSD PLC.

The touch probe can be triggered with P 240 - MPRO_TP_Ctrl. This enables triggering on a positive or negative edge, or on both edges, of the signal detected on the touch probe inputs. After the measurement, the parameter jumps back to the value ""NONE (0)"" and the latch position is mapped in the corresponding subindex of parameter P 241 - MPRO_TP_Position. A continuous touch probe mode is not possible at present, so the touch probe has to be reactivated after the measurement.

P 1402 - MPRO_TP_Channel can be used to select various positions as actual value sources of the latch position for the touch probe functionality. The following table provides an overview of the available settings. The counters are accessed via the MSD PLC or a bus system.

|ID|Index Name / Setting|Unit|Description|
|---|---|---|---|
|240|MPRO_TP_Ctrl|Touch probe: Control| |
| |0| |NONE (0) = No function|
| |1| |POS (1) = Positive edge|
| |2| |NEG (2) = Negative edge|
| |3| |BOTH (3) = Both edges|
|240|0 MPRO_TP_Ctrl| | |
|240|1 MPRO_TP_Ctrl| | |
|240|2 MPRO_TP_Ctrl| | |
|241|MPRO_TP_Position|Probe: Pos. high/low edge of TP0/1, encoder zero pulse| |

Table 8.29: “Touch probe” parameters

MOOG ID No.:CB40859-001 Date:11/2020

# 8 Motion profile

|Unit|Description|
|---|---|
|mDegree|Touch probe: Configuration|
|mDegree|TP0, TP1 touch probe|
|mDegree|TP0, TP1 as encoder, A/B as quadrature counting|
|mDegree|TP0, TP1 as encoder, pulse (TP0) / direction (TP1), count up on direction high|
|mDegree|TP0, TP1 as encoder, pulse (TP0) / direction (TP1), count down on direction high|
|mDegree|TP0 pulse counter, TP1 pulse counter|
|mDegree|TP0 pulse counter, TP1 touch probe|
|mDegree|TP1 touch probe, TP0 pulse counter|
|mDegree|TP0 encoder counter, TP1 encoder counter|
|mDegree|TP0 encoder counter, TP1 touch probe|
|mDegree|TP0 touch probe, TP1 encoder counter|

Touch probe: Channel

|Unit|Description|
|---|---|
|ACTPOS (0)|Actual position in user units|
|ACTPOSINC (1)|Actual position in increments|
|MASTERPOS (2)|Master position in increments|
|ENCPOS_CH1 (3)|Encoder position Channel 1|
|ENCPOS_CH1_INC (4)|Encoder position Channel 1 in increments|
|ENCPOS_CH2 (5)|Encoder position Channel 2|
|ENCPOS_CH2_INC (6)|Encoder position Channel 2 in increments|

# 8 Motion profile

MOOG ID No.:CB40859-001 Date:11/2020 MSD ServoDrive - DeviceHelp 276

|ID|Index Name / Setting|Unit|Description|
|---|---|---|---|
|7|ENCPOS_CH3 (7)| |Encoder position Channel 3|
|8|ENCPOS_CH3_INC (8)| |Encoder position Channel 3 in increments|
|9|ENCPOS_CH4 (9)| |Encoder position Channel 4|
|10|ENCPOS_CH4_INC (10)| |Encoder position Channel 4 in increments|
|11|ACTPOS2 (11)| |Actual position of redundant encoder in user units|
|12|Sercos (12)| |Referred to Sercos profile parameters S-x-0426, S-x-0427|
|13|UserRefPos(13)| |Reference position in user units|
|14|MasterPosST(14)| |Master position (ECAM, EGEAR) singleturn, always steps|
|15|CommonMasterPos(15)| |Master position (ECAM, EGEAR) singleturn, always steps|
|16|CommonMasterPosST(15)| |Master position (ECAM, EGEAR) singleturn, always steps|
|1402|MPRO_TP_Channel| | |
|1402|MPRO_TP_Channel| | |
|1402|MPRO_TP_Channel| | |
|1404|MPRO_TP_Lines| |Touch probe: Lines @ pulse counter on channel x|
|1404|MPRO_TP_Lines| | |
|1404|MPRO_TP_Lines| | |

Image 8.71: “Synchronized motion” screen

There are various modes available in the “synchronization mode” drop-down menu (P 242[0] - MPRO_ECAM_SyncModMode):

- Off(0) = Synchronized motion off
- ECAM_iPlc(1) = Electronic cam plate via MSD PLC
- EGEAR_iPlc(2) = Electr. gear unit via MSD PLC
- ECAM_PARA(3) = Electronic camming via parameters
- EGEAR_PARA(4) = Electronic gearing via parameters

NOTE: For more information refer to the bus system User Manuals or the description of the MSD PLC.

# 8.11.1 Electronic cam plate

The other parameters are configured in separate screens that can be accessed with the corresponding buttons.

- Master configuration (see Section ""Master configuration"" on page 280)
- Electronic gearing (see Section ""Electronic gearing"" on page 283)
- Electronic camming (see Section ""Electronic cam plate"" on page 277)

P 1318[0] - MPRO_ECAM_ControlWord is the control word for “synchronized motion” (see Section ""Control word for synchronized motion"" on page 279).

P 1326[0] - MPRO_ECAM_StatusWord is the status word for “synchronized motion” (see Section ""Status word for synchronized motion"" on page 279).

# 8.11.1.1 Table selection

|ID|Index Name|Unit|Description|
|---|---|---|---|
|1300|MPRO_ECAM_CTS_| |ECAM: CamTableSelect - Master reference|
|1301|MasterRef| | |
|1305|MPRO_ECAM_CTS_| |ECAM: CamTableSelect - Method for changing the camtable|
|1306|MPRO_ECAM_CTS_| |ECAM: CamTableSelect - Mode for changing the camtable|
|1307|MPRO_ECAM_CTS_|incr|ECAM: CamTableSelect - Distance for changing the camtable|
|242|MPRO_ECAM_| |ECAM / EGEAR: Mode of synchronized motion SyncModMode|
|265|MPRO_ECAM_| |ECAM / EGEAR: Slave speed factor (1 = 100%).|
|266|CamSlave_SpeedFactor| | |
|268|MPRO_ECAM_| |ECAM / EGEAR: Mode of switching off sync. motion|

# 8.11.1.2 Synchronization

|ID|Index Name|Unit|Description|
|---|---|---|---|
|1342|MPRO_ECAM_CI_|incr|ECAM: CamIn - Synchronization position (multiturn part)|
|1343|MPRO_ECAM_CO_|incr|ECAM: CamOut - Decoupling pos. (multiturn part)|
|1303|MPRO_ECAM_CI_|incr|ECAM: CamIn - Master offset|
|1308|MPRO_ECAM_CI_| |ECAM: CamIn - Master reference|
|1309|MPRO_ECAM_CI_| |ECAM: CamIn - Slave reference|
|1310|MPRO_ECAM_CI_| |ECAM: CamIn - Coupling mode|
|1311|MPRO_ECAM_CI_|incr|ECAM: CamIn - Coupling distance|
|1312|MPRO_ECAM_CI_|incr|ECAM: CamIn - Synchronization position|

Table 8.31: “Electronic camming - Table selection” parameters

Table 8.30: “Synchronized motion” parameters

Table 8.32: “Electronic camming - Synchronization” parameters

MOOG ID No.:CB40859-001 Date:11/2020

MSD ServoDrive - DeviceHelp 277

# 8 Motion profile

MOOG ID No.:CB40859-001 Date:11/2020 MSD ServoDrive - DeviceHelp 278

|ID|Index|Name|Unit|Description|
|---|---|---|---|---|
|1313|0|MPRO_ECAM_CO_SyncPosST|(singleturn part)|ECAM: CamOut - Slave reference|
|1314|0|MPRO_ECAM_CO_DecouplingMode|63|ECAM: CamOut - Decoupling mode|
|1315|0|MPRO_ECAM_CO_BreakingPosST|incr|ECAM: CamOut - Decoupling position|
|1316|0|MPRO_ECAM_CO_DecouplingDist|incr|ECAM: CamOut - Decoupling distance|
|1317|0|MPRO_ECAM_CO_StandstillPos|mDegree|ECAM: CamOut - Slave standstill position|

# Table 8.32: “Electronic camming - Synchronization” parameters (continue)

|ID|Index|Name|Unit|Description|
|---|---|---|---|---|
|1346| |MPRO_ECAM_SP_Table| |ECAM: Setpoint table interface|
|1346|0|Index| |Index of setpoint table|
|1346|1|Value| |Value at index of setpoint table|
|1347|0 to 31|MPRO_ECAM_SP_Index| |ECAM: Setpoint segments start index|
|1348|0 to 31|MPRO_ECAM_SP_Length| |ECAM: Setpoint segments length|
|1349|0 to 31|Length| | |
|1350|0|MPRO_ECAM_SP_MaDist| |ECAM: Setpoint segments master distance|
|1351|0|MPRO_ECAM_SP_IpoType| |ECAM: Setpoint segments interpolation type|
|1352|0 to 31|Checksum| |ECAM: Setpoint table checksum|
|1353|0 to 31|GainNum| |ECAM: Setpoint segments gain numerator|
| | |GainDen| |ECAM: Setpoint segments gain denominator|

# Table 8.33: “Electronic camming - Table segments” parameters

|ID|Index|Name|Unit|Description|
|---|---|---|---|---|
|1329|0 to 63|MPRO_ECAM_SegData_IndexNext| |ECAM: Index of the following segment|
|1330|0 to 63|MPRO_ECAM_SegData_IndexPrev| |ECAM: Index of the previous segment|
|1331|0 to 63|MPRO_ECAM_SegData_ProfileMode| |ECAM: Profile mode of the current segment|
|1332|0 to 63|MPRO_ECAM_SegData_DistMaster| |ECAM: Length of the master section of the current segment|
|1333|0 to 63|MPRO_ECAM_SegData_DistSlave| |ECAM: Length of the slave section of the current segment|
|1334|0 to 63|MPRO_ECAM_SegData_Lambda| |ECAM: Lambda value of the current segment|
|1335|0 to 63|MPRO_ECAM_SegData_StatusWord| |ECAM: Status word of the current segment|
|1336|0 to 63|MPRO_ECAM_SegData_ControlWord| |ECAM: Control word of the current segment|

# 8.11.2 Control word for synchronized motion

|Bit|Function|PLC function|Bit number|Description|
|---|---|---|---|---|
|0-7|Start segment (8-bit value)|-|0-7|Actual segment (8-bit value)|
|8-15|Reserved|-| |Actual ECAM / EGEAR state machine state (4 Bit value)|
|16|Absolute (true) / relative (false) master relationship|-| |- 0: ECAM / EGEAR asynchronous
- 1: ECAM / EGEAR synchronous
|
|17|Absolute (true) / relative (false) master (CAM) relationship at cam in|-| |- 2: ECAM / EGEAR synchronizing
- 3: ECAM / EGEAR desynchronizing
|
|18|Absolute (true) / relative (false) slave (CAM) relationship at cam in|-| |- 4: ECAM / EGEAR active and waiting for going asynchronous
|
|19-23|Reserved|-| |- 5: ECAM / EGEAR inactive and waiting for going synchronous
|
|24|Change gear ratio of the electronic gear online|MCB_GearRatioChange| | |
|25|Disable master calculation|MCB_Cam_MasterEnable| | |
|26|Enable master calculation|MCB_Cam_MasterEnable| | |
|27|Select CAM table|MCB_CamTableSelect| | |
|28|Start Ecam|MCB_CamIn| | |
|29|Stop Ecam|MCB_CamOut| | |
|30|Start Egear|MCB_GearIn| | |
|31|Stop Egear|MCB_GearOut| | |

# 8.11.3 Status word for synchronized motion

|Bit|Function|PLC function|Bit number|Description|
|---|---|---|---|---|
|12-26|Reserved|-| | |
|27|ECAM / EGEAR is active|-| | |
|28|Valid segments chosen|-| | |
|29|Master data are valid|-| | |
|30|Master is initialized|-| | |
|31|Master calculation is active|-| | |

Table 8.35: Control word ECAM (P 1318[0] - MPRO_ECAM_ControlWord)

Table 8.36: ECAM status word (P 1326[0] - MPRO_ECAM_StatusWord)

MOOG ID No.:CB40859-001 Date:11/2020 MSD ServoDrive - DeviceHelp 279

# 8 Motion profile

# 8 Motion profile

MOOG ID No.:CB40859-001 Date:11/2020

MSD ServoDrive - DeviceHelp 280

# 8.11.4 Master configuration

the master encoder, you will need to set the resolution relative to a single motor revolution in P 250 - MPRO_ECAM_PARAMaster_Amplitude (see below).

- ENC CH1 (3) = Encoder channel 1 X7 (Sin/Cos)
- ENC CH2 (4) = Encoder channel 2 X6 (Resolver)
- ENC CH3 (5) = Encoder channel 3 X8 (optional)

This function is only available if an external interface X8 (option module) is present.

- TP0 (6) = Pulse counter on probe channel 0 (TP0)
- TP1 (7) = Pulse counter on probe channel 1 (TP1)
- ENC_CH4 (8) = Encoder channel 4 (p. e. fieldbus)
- TWIN_POS (9) = TWIN remote reference position (P-2607)

Image 8.72: “Master configuration” screen

# Channel selection (master encoder)

P 1319[0] - MPRO_ECAM_CamMaster_AxisType is used to define the master encoder.

- NO AXIS (0) = No axis
- VIRTUAL MASTER (1) = Virtual master

If you select this function, you will be able to configure additional settings by clicking on the enabled “Options...” button (see Section ""Virtual Master"" on page 286).

- PARA (2) = Master parameter interface

If you select this function because a higher-level controller is being used as

# Anti-reverse mode

Slave only starts moving along with it again as soon as the master reaches the zero position.

P 1320[0] - MPRO_ECAM_CamMaster_RevLockMode is used to define the reverse lock mode, which can be used either with or without path compensation. The dashed lines in the following diagrams indicate what the engagement distance is:

# Example:

If the master, which has moved two motor revolutions in the direction blocked for the slave, then moves in the unblocked direction again, the slave only moves off when the master has traversed the zero point.

- INACTIVE (0) = Reverse lock inactive
- ACTIVE (2) = Reverse lock enabled - without path optimization
- ACTIVE WAY COMP (1) = Reverse lock active - with way compensation

While the slave accelerates to the speed of the master during engagement, the master and slave do not move synchronously. This function needs to be selected in order to quickly catch up to the master that is running ahead.

# Example:

- Master (black line) rotates in the blocked direction
- The slave (blue line) remains stopped
- Master rotates in the unblocked direction again
- The slave follows the master directly in the unblocked direction

Assume the master has moved two motor revolutions in the direction for which the slave lock is enabled. If the master now moves in the direction for which there is no lock, the slave will immediately start running in that direction.

MOOG ID No.:CB40859-001 Date:11/2020

MSD ServoDrive - DeviceHelp 281

# 8 Motion profile

MOOG ID No.:CB40859-001 Date:11/2020 MSD ServoDrive - DeviceHelp 282

|Filter type|ID|Index Name|Unit|Description|
|---|---|---|---|---|
|When using a real master encoder, encoder signals may be subject to noise.|P 1340|1319|0|MPRO_ECAM_CamMaster_AxisType|
| | |MPRO_ECAM_CamMaster_SpeedFilTyp| |ECAM / EGEAR: Channel selection of internal master input|
| | |1320|0|MPRO_ECAM_CamMaster_RevLockMode|
| | |1321|0|MPRO_ECAM_CamMaster_Amplitude|
| | |1322|0|MPRO_ECAM_CamMaster_GearNum|
| | |1323|0|MPRO_ECAM_CamMaster_GearDen|
|Filter time|1327|0|ms|ECAM / EGEAR: Filter time constant of master|
|If P 1340[0] is used to enable a filter, P 1327[0] - MPRO_ECAM_CamMaster_SpeedTFil can be used to define the corresponding filter time.|1328|0|speed|ECAM / EGEAR: Speed factor of the internal master|
|Speed factor|1340|0| |MPRO_ECAM_CamMaster_SpeedFilTyp|
|The master encoder can be assigned an additional speed factor P 1328[0] - MPRO_ECAM_CamMaster_SpeedFactor.|1341|0|incr|ECAM / EGEAR: Master drive offset|

Table 8.37: “Synchronized motion - Master configuration” parameters (continue)

| | | |ID|Index Name|Unit|Description|
|---|---|---|---|---|---|---|
|247|0|MPRO_ECAM_ParaMaster_ActPos|incr|ECAM / EGEAR: Parameter interface master position| | |
|248|0|MPRO_ECAM_ParaMaster_ActSpeed|rpm|ECAM / EGEAR: Parameter interface master speed| | |
|249|0|MPRO_ECAM_ParaMaster_ActAcc|rpm|ECAM / EGEAR: Parameter interface master acceleration| | |
| |250|0|MPRO_ECAM_ParaMaster_Amplitude| |ECAM / EGEAR: Parameter interface master amplitude| |

Table 8.37: “Synchronized motion - Master configuration” parameters

# 8.11.5 Electronic gearing

# Gear ratio

The gear ratio is specified as a fraction. This ensures that the position references can be translated to the motor shaft with no rounding error.

- ""Slave"" (P 252[0] - MPRO_ECAM_Egear_GearNum) is the numerator
- ""Master"" (P 251[0] - MPRO_ECAM_Egear_GearDen) is the denominator

# Scaling of speed pre-control

Defined with P 265[0] - MPRO_ECAM_CamSlave_SpeedFactor definiert.

# Scaling of torque pre-control

Defined with P 266[0] - MPRO_ECAM_CamSlave_TorqueFactor.

# Engagement

See Section ""Engagement"" on page 284.

# Disengagement

See Section ""Disengagement"" on page 285.

|ID|Index Name|Unit|Description|
|---|---|---|---|
|251|0 MPRO_ECAM_Egear_GearDen| |EGEAR: Gear denominator|
|252|0 MPRO_ECAM_Egear_GearNum| |EGEAR: Numerator of gear ratio|
|1344|0 MPRO_ECAM_Egear_LimRefAcc|rpm/s|EGEAR: Acceleration limit for reference|
|1345|0 MPRO_ECAM_Egear_LimRefJerk|rpm/s²|EGEAR: Jerk limit for reference|

Table 8.38: “Synchronized motion - Electronic gearing” parameters

Image 8.73: ""Electronic gearing"" screen

MOOG ID No.:CB40859-001 Date:11/2020 MSD ServoDrive - DeviceHelp 283

# 8 Motion profile

# 8 Motion profile

MOOG ID No.:CB40859-001 Date:11/2020

MSD ServoDrive - DeviceHelp 284

# 8.11.6 Engagement

used to define the engagement distance (between the dashed lines).

P 253[0] - MPRO_ECAM_Egear_GearInMode is used to define the mode for engagement.

- DIRECT (0) = Direct
- Direct engagement: Angular synchronous; with jerking (no ramps).
- CROSSFADE (3) = Crossfading
- Engagement with crossfading function (5th degree polynomial): Angular synchronous; jerk-limited; speed will overshoot during engagement.
- RAMP (1) = Linear speed ramp
- Engagement with linear acceleration: Not angular synchronous; with jerking.
- FADE (2) = Engagement fade-out
- Engagement with fade-in function (5th degree polynomial): Not angular synchronous; jerk-limited. The position is ignored. ",What parameter shows the current active motion task index in the 'MSD ServoDrive - DeviceHelp' document?,A1,P 207[0] - MPRO_Tab_ActIdx shows the current active motion task index.,2.46875,2.484375,3.515625,1.34375,0.50390625
41,msd_servo_drive.txt,76,b87ca5e232c2bdbb6fa16a8a401c6b5d285dc0183e73cc9d134de13dd2fc71d2,"MOOG ID No.:CB40859-001 Date:11/2020

MSD ServoDrive - DeviceHelp 267

# 8 Motion profile

MOOG ID No.:CB40859-001 Date:11/2020 MSD ServoDrive - DeviceHelp 268

# Deceleration

With ...

- P 194 - MPRO_TAB_TDec (for torque control) or
- P 197 - MPRO_TAB_SDec (for speed control) or
- P 200 - MPRO_TAB_PDec (for position control)

and indexes 0–15, the deceleration for each individual motion task can be defined. The input must not be zero.

# Wait time in Auto mode

P 204 - MPRO_TAB_WaitTime is used to define the wait time before the next motion task is carried out.

# Maximum table index in Auto mode

P 206[0] - MPRO_Tab_MaxIdx is used to define the table index up to which driving jobs will be carried out in one of the auto modes.

# Current table index

P 207[0] - MPRO_Tab_ActIdx will show the index for the motion task that is currently active. If parameter P 205 MPRO_TAB_Mode is set to “Para(0)”, a driving set can be entered and approached directly.

# Activation of reference table

The following procedures can be used in order to activate the setpoint table for operation.

|ID|Index Name|Unit|Description|
|---|---|---|---|
|193|MPRO_TAB_TAcc|TAB: Torque mode acceleration|Nm/ms|
|193|0|MPRO_TAB_TAcc|Nm/ms|
|193|1 - 15|MPRO_TAB_TAcc|Nm/ms|
|194|MPRO_TAB_TDec|TAB: Torque mode deceleration| |
|194|0|MPRO_TAB_TDec|Nm/ms|
|194|1 - 15|MPRO_TAB_TDec|Nm/ms|

# Table 8.23: Activation of table references

# Table 8.24: “Setpoint table settings” parameters

# Table 8.24: “Setpoint table settings” parameters (continue)

|ID|Index Name|Unit|Description|ID|Index Name|Unit|Description|
|---|---|---|---|---|---|---|---|
|195|MPRO_TAB_TRef|Nm|TAB: Torque mode reference value|208|MPRO_TAB_OutputNo| |OSD TAB: actual table index and target|
|195|MPRO_TAB_TRef|Nm| |208|MPRO_TAB_OutputNo| | |
|196|MPRO_TAB_SAcc|rev/min/s|TAB: Speed mode acceleration|269|MPRO_TAB_Ctrl| |TAB: control word|
|196|MPRO_TAB_SAcc|rev/min/s| | | | | |
|197|MPRO_TAB_SDec|rev/min/s|TAB: Speed mode deceleration| | | | |
|197|MPRO_TAB_SDec|rev/min/s| | | | | |
|198|MPRO_TAB_SRef|rev/min|TAB: Speed mode reference value| | | | |
|198|MPRO_TAB_SRef|rev/min| | | | | |
|199|MPRO_TAB_PAcc|rev/min/s|TAB: Position control mode acceleration| | | | |
|199|MPRO_TAB_PAcc|rev/min/s| | | | | |
|200|MPRO_TAB_PDec|rev/min/s|TAB: Position control mode Acceleration| | | | |
|200|MPRO_TAB_PDec|rev/min/s| | | | | |
|201|MPRO_TAB_PSpd|rev/min|TAB: Position control mode speed| | | | |
|201|MPRO_TAB_PSpd|rev/min| | | | | |
|202|MPRO_TAB_PPos|mDegree|TAB: Position control mode reference value| | | | |
|202|MPRO_TAB_PPos|mDegree| | | | | |
|203|MPRO_TAB_PMode| |Position control table:Mode| | | | |
|203|MPRO_TAB_PMode| | | | | | |
|204|MPRO_TAB_WaitTime|ms|TAB: Wait time| | | | |
|204|MPRO_TAB_WaitTime|ms| | | | | |
|205|MPRO_TAB_Mode| |TAB mode| | | | |
|206|MPRO_Tab_MaxIdx| |TAB: Max index in AUTO mode| | | | |
|207|MPRO_TAB_ActIdx| |TAB: Actual index| | | | |

MOOG ID No.:CB40859-001 Date:11/2020

MSD ServoDrive - DeviceHelp

# 8 Motion profile

MOOG ID No.:CB40859-001 Date:11/2020

MSD ServoDrive - DeviceHelp 270

# 8.8 Analog channel (ISA00 und ISA01)

# Offset (O)

This parameter (P 174 - MPRO_ANA0_SOffset for ISA00, P 184 - MPRO_ANA1_SOffset for ISA01) compensates for component variations and is used for offset compensation purposes. Depending on the control mode being used (see Section ""Basic settings"" on page 110), the value will be stored in parameter index [0] (torque control), [1] (speed control) or [2] (position control).

# Backlash (B)

This parameter (P 175 - MPRO_ANA0_SThreshold for ISA00, P 185 - MPRO_ANA1_SThreshold for ISA01) can suppress axis motion close to the standstill (stop) position. Depending on the control mode being used (see Section ""Basic settings"" on page 110), the value will be stored in parameter index [0] (torque control), [1] (speed control) or [2] (position control).

Image 8.68: “Analog channel” screen

# Acceleration ramp

Two standard analog inputs (ISA00, ISA01) are available. These inputs can be configured...

- with negative values for analog setpoint settings
- with positive values for digital setpoint processing

(P 109[0] - MPRO_INPUT_FS_ISA00 and P 110[0] - MPRO_INPUT_FS_ISA01).

see also section ""Analog Inputs"" on page 303. By using the ""REV(-2) = Analog setpoint"" setting, an analog input voltage of ±10 V can be processed as a setpoint.

# Deceleration ramp

This parameter serves as a deceleration ramp for torque control (P 176[1] - MPRO_ANA0_TRamp for ISA00, P 186[1] - MPRO_ANA1_TRamp for ISA01) or speed control (P 177[1] - MPRO_ANA0_SRamp for ISA00, P 187[1] - MPRO_ANA1_SRamp for ISA01). Depending on the control mode being used (see Section ""Basic settings"" on page 110), the value will be stored in parameter index [0] (torque control), [1] (speed control) or [2] (position control).

This parameter (P 173 - MPRO_ANA0_Scale for ISA00, P 183 - MPRO_ANA1_Scale for ISA01) is used to define which speed / which torque / which position corresponds to the maximum analog value. Depending on the control mode being used (see Section ""Basic settings"" on page 110), the value will be stored in parameter index [0] (torque control), [1] (speed control) or [2] (position control).

# 8.8.1 Special characteristics of position control mode

A threshold value can also be specified which generates a run-on range around the last reference value. A ramp function calculates a motion profile for the position reference from pre-defined acceleration and speed limits.

The position references on the analog channel are not applied immediately, but dependent on a digital input. Accordingly, one of the ISD00 to ISD06 digital inputs must be set to a value of ""REFANAEN(28) = Enable analog reference value"" (see Section ""Digital inputs"" on page 290). The position setpoint being received will only be applied if the corresponding digital input is active. The acceleration is entered using P 173[0] - MPRO_ANA0_TScale or P 183[0] - MPRO_ANA1_TScale.

# 8.8.2 Wire Break Monitoring

P 399 - CON_ANAWireBrk_Th can be used to configure wire break monitoring for the analog inputs. For details see Section ""Wire Break Monitoring"" on page 306.

|Function|TLIM (-4)|OVR (-3)|REFV (-2)|leer (-1)|OFF (0)|
|---|---|---|---|---|---|
|Digital|(1)-(28)|(1)-(28)|(1)-(28)|(1)-(28)|(1)-(28)|
|Analog channel|Filter|Scale|Offset|Profile|generator|

Control

Image 8.69: Reference processing structure

MOOG ID No.:CB40859-001 Date:11/2020

MSD ServoDrive - DeviceHelp 271

# 8 Motion profile

# 8 Motion profile

MOOG ID No.:CB40859-001 Date:11/2020

|ID|Index Name|Unit|Description|ID|
|---|---|---|---|---|
|395|CON_ANA_Isaf_Scaled| |Analog inputs: Values (filt, norm, comp, scaled)|174|
|395|0 ISA00| |Scaled, compensated, filtered, normalized value|175|
|395|1 ISA01| |Scaled, compensated, filtered, normalized value| |
|396|CON_ANA_Scale_ThUpper| |Analog inputs: Upper scaling limits|175|
|396|0 ISA00|%|Upper scaling (@ 10 V) threshold|175|
|396|1 ISA01|%|Upper scaling (@ 10 V) threshold| |
|397|CON_ANA_Scale_ThZero| |Analog inputs: Zero scaling thresholds|176|
|397|0 ISA00|V|Zero scaling threshold (+/-)|176|
|397|1 ISA01|V|Zero scaling threshold (+/-)| |
|398|CON_ANA_Scale_ThLower| |Analog inputs: Lower scaling limits|177|
|398|0 ISA00|%|Lower scaling (@ zero threshold) threshold|177|
|398|1 ISA01|%|Lower scaling (@ zero threshold) threshold| |
|399|CON_ANA_WireBrk_Th| |Analog inputs: Wire break thresholds|Table 8.26:|
|399|0 ISA00|V|Wire break detection threshold| |
|399|1 ISA01|V|Wire break detection threshold| |
|405|0 CON_ANA_Filt0|ms|Analog input ISA00: Filter time constant (PT 1)|ID|
|408|CON_ANA_Isaf_Norm| |Analog inputs: Values (filt, norm)|183|
|408|0 ISA00| |Filtered, normalized value|183|
|408|1 ISA01| |Filtered, normalized value|183|

Table 8.25: “Analog channel” parameters

|ID|Index Name|Unit|Description|ID|
|---|---|---|---|---|
|173|MPRO_ANA0_Scale| |ANA0: scale factors|184|
|173|0 MPRO_ANA0_TScale|Nm|ANA0: scale factor torque reference|185|
|173|1 MPRO_ANA0_SScale|rev/min|ANA0: scale factor speed reference|185|
|173|2 MPRO_ANA0_PScale|mDegree|ANA0: scale factor position reference| |
|174|MPRO_ANA0_Offset| |ANA0: offsets|185|
|174|0 MPRO_ANA0_TOffset|Nm|ANA0: offsets for torque reference|185|

Table 8.26: “Analog channel ISA00” parameters

|Index Name|Unit|Description|
|---|---|---|
|1 MPRO_ANA0_SOffset|rev/min|ANA0: offsets for speed reference|
|2 MPRO_ANA0_POffset|mDegree|ANA0: offsets for position reference|
|MPRO_ANA0_Threshold| |ANA0: thresholds|
|0 MPRO_ANA0_TThreshold|Nm|ANA0: threshold for torque reference|
|1 MPRO_ANA0_SThreshold|rev/min|ANA0: threshold for speed reference|
|2 MPRO_ANA0_PThreshold|mDegree|ANA0: threshold for position reference|
|MPRO_ANA0_TRamp| |ANA0: Torque mode acceleration [0] and deceleration [1]|
|0 MPRO_ANA0_TRamp|Nm/s| |
|1 MPRO_ANA0_TRamp|Nm/s| |
|MPRO_ANA0_SRamp| |ANA0: Speed mode acceleration [0] and deceleration [1]|
|0 MPRO_ANA0_SRamp|SPEED/s| |
|1 MPRO_ANA0_SRamp|SPEED/s| |

“Analog channel ISA00” parameters (continue)

|Index Name|Unit|Description|
|---|---|---|
|MPRO_ANA1_Scale| |ANA1: scale factors|
|0 MPRO_ANA1_TScale|Nm|ANA0: scale factor torque reference|
|1 MPRO_ANA1_SScale|rev/min|ANA0: scale factor speed reference|
|2 MPRO_ANA1_PScale|mDegree|ANA0: scale factor position reference|
|MPRO_ANA1_Offset| |ANA1: offsets|
|0 MPRO_ANA1_TOffset|Nm|ANA1: offsets for torque reference|
|1 MPRO_ANA1_SOffset|rev/min|ANA1: offsets for speed reference|
|2 MPRO_ANA1_POffset|mDegree|ANA1: offsets for position reference|
|MPRO_ANA1_Threshold| |ANA1: thresholds|
|0 MPRO_ANA1_TThreshold|Nm|ANA1: threshold for torque reference|
|1 MPRO_ANA1_SThreshold|rev/min|ANA1: threshold for speed reference|
|2 MPRO_ANA1_PThreshold|mDegree|ANA1: threshold for position reference|

“Analog channel ISA01” parameters

# 8 Motion profile

|ID|Index Name|Unit|Description|
|---|---|---|---|
|186|MPRO_ANA1_TRamp|Nm/s|ANA1: Torque mode acceleration [0] and deceleration[1]|
|186|MPRO_ANA1_TRamp|Nm/s| |
|187|MPRO_ANA1_SRamp|SPEED/s|ANA1: Speed mode acceleration [0] and deceleration [1]|
|187|MPRO_ANA1_SRamp|SPEED/s| |

# Table 8.27: “Analog channel ISA01” parameters (continue)

Display

- System state
- Initialization on device startup
- Not ready (DC link voltage possibly too low)
- Start inhibit (DC link voltage present, power stage off)
- Starting lockout
- Ready for start
- Control initialization: Auto commutation, flux build-up etc.

# Table 8.28: Central state machine according to CiA 402 device display

MOOG ID No.:CB40859-001 Date:11/2020

MSD ServoDrive - DeviceHelp 273

# 8 Motion profile

MOOG ID No.:CB40859-001 Date:11/2020

MSD ServoDrive - DeviceHelp 274

|Display|System state|power disabled|fault|
|---|---|---|---|
|Control enabled|0|Start|7|
| |fault reaction active|0|14|
|Quick stop active|1|not ready|8|
| |to switch on|1|17|
|Error reaction active|2|switch on|disabled|
| |2|7| |
|Error state (in this state the error is indicated directly on the display.)|3|ready to|switch on|
|Device is reset (display flashes)|power enabled|3|6|
| |10|12| |
|• Number [5.] flashes when “STO” (Safe Torque Off) input is active. Display goes out when STO inactive.| | | |
|• The dot on the display flashes when the power stage is active.| | | |

Table 8.28: Central state machine according to CiA 402 device display (continue)

NOTE

l The system states indicated on the display may differ from the states in the table depending on the drive profile setting.

Image 8.70: State machine diagram based on CANopen communications

⓪ to ① State number

1 to 17 State transition (No. 17: DC link voltage cut off)

Legend for “State machine diagram based on CANopen communications” figure

# 8.10 Touch probe

|ID|Index Name / Setting|
|---|---|
|241|0 MPRO_TP_Position|
|241|1 MPRO_TP_Position|
|241|2 MPRO_TP_Position|
|241|3 MPRO_TP_Position|
|241|4 MPRO_TP_Position|
|1400|0 MPRO_TP_Config|
| |TP_TP (0)|
| |AB (1)|
| |PD_UP (2)|
| |PD_DOWN (3)|
| |PC_PC (4)|
| |PC_TP (5)|
| |TP_PC (6)|
| |ENC_ENC (7)|
| |ENC_TP (8)|
| |TP_ENC (9)|

Using the touch probe inputs, touch probe functions can be performed. In order to be able to do this, P 106[0] - MPRO_INPUT_FS_ISD05 and P 107[0] - MPRO_INPUT_FS_ISD06 must be used to set digital inputs ISD05 and ISD06 to ""PROBE(15) = Touch probe (only ISD05/06)"" (see Section ""Digital inputs"" on page 290). HTL encoders can be evaluated or pulse counters implemented using the MSD PLC.

The touch probe can be triggered with P 240 - MPRO_TP_Ctrl. This enables triggering on a positive or negative edge, or on both edges, of the signal detected on the touch probe inputs. After the measurement, the parameter jumps back to the value ""NONE (0)"" and the latch position is mapped in the corresponding subindex of parameter P 241 - MPRO_TP_Position. A continuous touch probe mode is not possible at present, so the touch probe has to be reactivated after the measurement.

P 1402 - MPRO_TP_Channel can be used to select various positions as actual value sources of the latch position for the touch probe functionality. The following table provides an overview of the available settings. The counters are accessed via the MSD PLC or a bus system.

|ID|Index Name / Setting|Unit|Description|
|---|---|---|---|
|240|MPRO_TP_Ctrl|Touch probe: Control| |
| |0| |NONE (0) = No function|
| |1| |POS (1) = Positive edge|
| |2| |NEG (2) = Negative edge|
| |3| |BOTH (3) = Both edges|
|240|0 MPRO_TP_Ctrl| | |
|240|1 MPRO_TP_Ctrl| | |
|240|2 MPRO_TP_Ctrl| | |
|241|MPRO_TP_Position|Probe: Pos. high/low edge of TP0/1, encoder zero pulse| |

Table 8.29: “Touch probe” parameters

MOOG ID No.:CB40859-001 Date:11/2020

# 8 Motion profile

|Unit|Description|
|---|---|
|mDegree|Touch probe: Configuration|
|mDegree|TP0, TP1 touch probe|
|mDegree|TP0, TP1 as encoder, A/B as quadrature counting|
|mDegree|TP0, TP1 as encoder, pulse (TP0) / direction (TP1), count up on direction high|
|mDegree|TP0, TP1 as encoder, pulse (TP0) / direction (TP1), count down on direction high|
|mDegree|TP0 pulse counter, TP1 pulse counter|
|mDegree|TP0 pulse counter, TP1 touch probe|
|mDegree|TP1 touch probe, TP0 pulse counter|
|mDegree|TP0 encoder counter, TP1 encoder counter|
|mDegree|TP0 encoder counter, TP1 touch probe|
|mDegree|TP0 touch probe, TP1 encoder counter|

Touch probe: Channel

|Unit|Description|
|---|---|
|ACTPOS (0)|Actual position in user units|
|ACTPOSINC (1)|Actual position in increments|
|MASTERPOS (2)|Master position in increments|
|ENCPOS_CH1 (3)|Encoder position Channel 1|
|ENCPOS_CH1_INC (4)|Encoder position Channel 1 in increments|
|ENCPOS_CH2 (5)|Encoder position Channel 2|
|ENCPOS_CH2_INC (6)|Encoder position Channel 2 in increments|

# 8 Motion profile

MOOG ID No.:CB40859-001 Date:11/2020 MSD ServoDrive - DeviceHelp 276

|ID|Index Name / Setting|Unit|Description|
|---|---|---|---|
|7|ENCPOS_CH3 (7)| |Encoder position Channel 3|
|8|ENCPOS_CH3_INC (8)| |Encoder position Channel 3 in increments|
|9|ENCPOS_CH4 (9)| |Encoder position Channel 4|
|10|ENCPOS_CH4_INC (10)| |Encoder position Channel 4 in increments|
|11|ACTPOS2 (11)| |Actual position of redundant encoder in user units|
|12|Sercos (12)| |Referred to Sercos profile parameters S-x-0426, S-x-0427|
|13|UserRefPos(13)| |Reference position in user units|
|14|MasterPosST(14)| |Master position (ECAM, EGEAR) singleturn, always steps|
|15|CommonMasterPos(15)| |Master position (ECAM, EGEAR) singleturn, always steps|
|16|CommonMasterPosST(15)| |Master position (ECAM, EGEAR) singleturn, always steps|
|1402|MPRO_TP_Channel| | |
|1402|MPRO_TP_Channel| | |
|1402|MPRO_TP_Channel| | |
|1404|MPRO_TP_Lines| |Touch probe: Lines @ pulse counter on channel x|
|1404|MPRO_TP_Lines| | |
|1404|MPRO_TP_Lines| | |

Image 8.71: “Synchronized motion” screen

There are various modes available in the “synchronization mode” drop-down menu (P 242[0] - MPRO_ECAM_SyncModMode):

- Off(0) = Synchronized motion off
- ECAM_iPlc(1) = Electronic cam plate via MSD PLC
- EGEAR_iPlc(2) = Electr. gear unit via MSD PLC
- ECAM_PARA(3) = Electronic camming via parameters
- EGEAR_PARA(4) = Electronic gearing via parameters

NOTE: For more information refer to the bus system User Manuals or the description of the MSD PLC.

# 8.11.1 Electronic cam plate

The other parameters are configured in separate screens that can be accessed with the corresponding buttons.

- Master configuration (see Section ""Master configuration"" on page 280)
- Electronic gearing (see Section ""Electronic gearing"" on page 283)
- Electronic camming (see Section ""Electronic cam plate"" on page 277)

P 1318[0] - MPRO_ECAM_ControlWord is the control word for “synchronized motion” (see Section ""Control word for synchronized motion"" on page 279).

P 1326[0] - MPRO_ECAM_StatusWord is the status word for “synchronized motion” (see Section ""Status word for synchronized motion"" on page 279).

# 8.11.1.1 Table selection

|ID|Index Name|Unit|Description|
|---|---|---|---|
|1300|MPRO_ECAM_CTS_| |ECAM: CamTableSelect - Master reference|
|1301|MasterRef| | |
|1305|MPRO_ECAM_CTS_| |ECAM: CamTableSelect - Method for changing the camtable|
|1306|MPRO_ECAM_CTS_| |ECAM: CamTableSelect - Mode for changing the camtable|
|1307|MPRO_ECAM_CTS_|incr|ECAM: CamTableSelect - Distance for changing the camtable|
|242|MPRO_ECAM_| |ECAM / EGEAR: Mode of synchronized motion SyncModMode|
|265|MPRO_ECAM_| |ECAM / EGEAR: Slave speed factor (1 = 100%).|
|266|CamSlave_SpeedFactor| | |
|268|MPRO_ECAM_| |ECAM / EGEAR: Mode of switching off sync. motion|

# 8.11.1.2 Synchronization

|ID|Index Name|Unit|Description|
|---|---|---|---|
|1342|MPRO_ECAM_CI_|incr|ECAM: CamIn - Synchronization position (multiturn part)|
|1343|MPRO_ECAM_CO_|incr|ECAM: CamOut - Decoupling pos. (multiturn part)|
|1303|MPRO_ECAM_CI_|incr|ECAM: CamIn - Master offset|
|1308|MPRO_ECAM_CI_| |ECAM: CamIn - Master reference|
|1309|MPRO_ECAM_CI_| |ECAM: CamIn - Slave reference|
|1310|MPRO_ECAM_CI_| |ECAM: CamIn - Coupling mode|
|1311|MPRO_ECAM_CI_|incr|ECAM: CamIn - Coupling distance|
|1312|MPRO_ECAM_CI_|incr|ECAM: CamIn - Synchronization position|

Table 8.31: “Electronic camming - Table selection” parameters

Table 8.30: “Synchronized motion” parameters

Table 8.32: “Electronic camming - Synchronization” parameters

MOOG ID No.:CB40859-001 Date:11/2020

MSD ServoDrive - DeviceHelp 277

# 8 Motion profile

MOOG ID No.:CB40859-001 Date:11/2020 MSD ServoDrive - DeviceHelp 278

|ID|Index|Name|Unit|Description|
|---|---|---|---|---|
|1313|0|MPRO_ECAM_CO_SyncPosST|(singleturn part)|ECAM: CamOut - Slave reference|
|1314|0|MPRO_ECAM_CO_DecouplingMode|63|ECAM: CamOut - Decoupling mode|
|1315|0|MPRO_ECAM_CO_BreakingPosST|incr|ECAM: CamOut - Decoupling position|
|1316|0|MPRO_ECAM_CO_DecouplingDist|incr|ECAM: CamOut - Decoupling distance|
|1317|0|MPRO_ECAM_CO_StandstillPos|mDegree|ECAM: CamOut - Slave standstill position|

# Table 8.32: “Electronic camming - Synchronization” parameters (continue)

|ID|Index|Name|Unit|Description|
|---|---|---|---|---|
|1346| |MPRO_ECAM_SP_Table| |ECAM: Setpoint table interface|
|1346|0|Index| |Index of setpoint table|
|1346|1|Value| |Value at index of setpoint table|
|1347|0 to 31|MPRO_ECAM_SP_Index| |ECAM: Setpoint segments start index|
|1348|0 to 31|MPRO_ECAM_SP_Length| |ECAM: Setpoint segments length|
|1349|0 to 31|Length| | |
|1350|0|MPRO_ECAM_SP_MaDist| |ECAM: Setpoint segments master distance|
|1351|0|MPRO_ECAM_SP_IpoType| |ECAM: Setpoint segments interpolation type|
|1352|0 to 31|Checksum| |ECAM: Setpoint table checksum|
|1353|0 to 31|GainNum| |ECAM: Setpoint segments gain numerator|
| | |GainDen| |ECAM: Setpoint segments gain denominator|

# Table 8.33: “Electronic camming - Table segments” parameters

|ID|Index|Name|Unit|Description|
|---|---|---|---|---|
|1329|0 to 63|MPRO_ECAM_SegData_IndexNext| |ECAM: Index of the following segment|
|1330|0 to 63|MPRO_ECAM_SegData_IndexPrev| |ECAM: Index of the previous segment|
|1331|0 to 63|MPRO_ECAM_SegData_ProfileMode| |ECAM: Profile mode of the current segment|
|1332|0 to 63|MPRO_ECAM_SegData_DistMaster| |ECAM: Length of the master section of the current segment|
|1333|0 to 63|MPRO_ECAM_SegData_DistSlave| |ECAM: Length of the slave section of the current segment|
|1334|0 to 63|MPRO_ECAM_SegData_Lambda| |ECAM: Lambda value of the current segment|
|1335|0 to 63|MPRO_ECAM_SegData_StatusWord| |ECAM: Status word of the current segment|
|1336|0 to 63|MPRO_ECAM_SegData_ControlWord| |ECAM: Control word of the current segment|

# 8.11.2 Control word for synchronized motion

|Bit|Function|PLC function|Bit number|Description|
|---|---|---|---|---|
|0-7|Start segment (8-bit value)|-|0-7|Actual segment (8-bit value)|
|8-15|Reserved|-| |Actual ECAM / EGEAR state machine state (4 Bit value)|
|16|Absolute (true) / relative (false) master relationship|-| |- 0: ECAM / EGEAR asynchronous
- 1: ECAM / EGEAR synchronous
|
|17|Absolute (true) / relative (false) master (CAM) relationship at cam in|-| |- 2: ECAM / EGEAR synchronizing
- 3: ECAM / EGEAR desynchronizing
|
|18|Absolute (true) / relative (false) slave (CAM) relationship at cam in|-| |- 4: ECAM / EGEAR active and waiting for going asynchronous
|
|19-23|Reserved|-| |- 5: ECAM / EGEAR inactive and waiting for going synchronous
|
|24|Change gear ratio of the electronic gear online|MCB_GearRatioChange| | |
|25|Disable master calculation|MCB_Cam_MasterEnable| | |
|26|Enable master calculation|MCB_Cam_MasterEnable| | |
|27|Select CAM table|MCB_CamTableSelect| | |
|28|Start Ecam|MCB_CamIn| | |
|29|Stop Ecam|MCB_CamOut| | |
|30|Start Egear|MCB_GearIn| | |
|31|Stop Egear|MCB_GearOut| | |

# 8.11.3 Status word for synchronized motion

|Bit|Function|PLC function|Bit number|Description|
|---|---|---|---|---|
|12-26|Reserved|-| | |
|27|ECAM / EGEAR is active|-| | |
|28|Valid segments chosen|-| | |
|29|Master data are valid|-| | |
|30|Master is initialized|-| | |
|31|Master calculation is active|-| | |

Table 8.35: Control word ECAM (P 1318[0] - MPRO_ECAM_ControlWord)

Table 8.36: ECAM status word (P 1326[0] - MPRO_ECAM_StatusWord)

MOOG ID No.:CB40859-001 Date:11/2020 MSD ServoDrive - DeviceHelp 279

# 8 Motion profile

# 8 Motion profile

MOOG ID No.:CB40859-001 Date:11/2020

MSD ServoDrive - DeviceHelp 280

# 8.11.4 Master configuration

the master encoder, you will need to set the resolution relative to a single motor revolution in P 250 - MPRO_ECAM_PARAMaster_Amplitude (see below).

- ENC CH1 (3) = Encoder channel 1 X7 (Sin/Cos)
- ENC CH2 (4) = Encoder channel 2 X6 (Resolver)
- ENC CH3 (5) = Encoder channel 3 X8 (optional)

This function is only available if an external interface X8 (option module) is present.

- TP0 (6) = Pulse counter on probe channel 0 (TP0)
- TP1 (7) = Pulse counter on probe channel 1 (TP1)
- ENC_CH4 (8) = Encoder channel 4 (p. e. fieldbus)
- TWIN_POS (9) = TWIN remote reference position (P-2607)

Image 8.72: “Master configuration” screen

# Channel selection (master encoder)

P 1319[0] - MPRO_ECAM_CamMaster_AxisType is used to define the master encoder.

- NO AXIS (0) = No axis
- VIRTUAL MASTER (1) = Virtual master

If you select this function, you will be able to configure additional settings by clicking on the enabled “Options...” button (see Section ""Virtual Master"" on page 286).

- PARA (2) = Master parameter interface

If you select this function because a higher-level controller is being used as

# Anti-reverse mode

Slave only starts moving along with it again as soon as the master reaches the zero position.

P 1320[0] - MPRO_ECAM_CamMaster_RevLockMode is used to define the reverse lock mode, which can be used either with or without path compensation. The dashed lines in the following diagrams indicate what the engagement distance is:

# Example:

If the master, which has moved two motor revolutions in the direction blocked for the slave, then moves in the unblocked direction again, the slave only moves off when the master has traversed the zero point.

- INACTIVE (0) = Reverse lock inactive
- ACTIVE (2) = Reverse lock enabled - without path optimization
- ACTIVE WAY COMP (1) = Reverse lock active - with way compensation

While the slave accelerates to the speed of the master during engagement, the master and slave do not move synchronously. This function needs to be selected in order to quickly catch up to the master that is running ahead.

# Example:

- Master (black line) rotates in the blocked direction
- The slave (blue line) remains stopped
- Master rotates in the unblocked direction again
- The slave follows the master directly in the unblocked direction

Assume the master has moved two motor revolutions in the direction for which the slave lock is enabled. If the master now moves in the direction for which there is no lock, the slave will immediately start running in that direction.

MOOG ID No.:CB40859-001 Date:11/2020

MSD ServoDrive - DeviceHelp 281

# 8 Motion profile

MOOG ID No.:CB40859-001 Date:11/2020 MSD ServoDrive - DeviceHelp 282

|Filter type|ID|Index Name|Unit|Description|
|---|---|---|---|---|
|When using a real master encoder, encoder signals may be subject to noise.|P 1340|1319|0|MPRO_ECAM_CamMaster_AxisType|
| | |MPRO_ECAM_CamMaster_SpeedFilTyp| |ECAM / EGEAR: Channel selection of internal master input|
| | |1320|0|MPRO_ECAM_CamMaster_RevLockMode|
| | |1321|0|MPRO_ECAM_CamMaster_Amplitude|
| | |1322|0|MPRO_ECAM_CamMaster_GearNum|
| | |1323|0|MPRO_ECAM_CamMaster_GearDen|
|Filter time|1327|0|ms|ECAM / EGEAR: Filter time constant of master|
|If P 1340[0] is used to enable a filter, P 1327[0] - MPRO_ECAM_CamMaster_SpeedTFil can be used to define the corresponding filter time.|1328|0|speed|ECAM / EGEAR: Speed factor of the internal master|
|Speed factor|1340|0| |MPRO_ECAM_CamMaster_SpeedFilTyp|
|The master encoder can be assigned an additional speed factor P 1328[0] - MPRO_ECAM_CamMaster_SpeedFactor.|1341|0|incr|ECAM / EGEAR: Master drive offset|

Table 8.37: “Synchronized motion - Master configuration” parameters (continue)

| | | |ID|Index Name|Unit|Description|
|---|---|---|---|---|---|---|
|247|0|MPRO_ECAM_ParaMaster_ActPos|incr|ECAM / EGEAR: Parameter interface master position| | |
|248|0|MPRO_ECAM_ParaMaster_ActSpeed|rpm|ECAM / EGEAR: Parameter interface master speed| | |
|249|0|MPRO_ECAM_ParaMaster_ActAcc|rpm|ECAM / EGEAR: Parameter interface master acceleration| | |
| |250|0|MPRO_ECAM_ParaMaster_Amplitude| |ECAM / EGEAR: Parameter interface master amplitude| |

Table 8.37: “Synchronized motion - Master configuration” parameters

# 8.11.5 Electronic gearing

# Gear ratio

The gear ratio is specified as a fraction. This ensures that the position references can be translated to the motor shaft with no rounding error.

- ""Slave"" (P 252[0] - MPRO_ECAM_Egear_GearNum) is the numerator
- ""Master"" (P 251[0] - MPRO_ECAM_Egear_GearDen) is the denominator

# Scaling of speed pre-control

Defined with P 265[0] - MPRO_ECAM_CamSlave_SpeedFactor definiert.

# Scaling of torque pre-control

Defined with P 266[0] - MPRO_ECAM_CamSlave_TorqueFactor.

# Engagement

See Section ""Engagement"" on page 284.

# Disengagement

See Section ""Disengagement"" on page 285.

|ID|Index Name|Unit|Description|
|---|---|---|---|
|251|0 MPRO_ECAM_Egear_GearDen| |EGEAR: Gear denominator|
|252|0 MPRO_ECAM_Egear_GearNum| |EGEAR: Numerator of gear ratio|
|1344|0 MPRO_ECAM_Egear_LimRefAcc|rpm/s|EGEAR: Acceleration limit for reference|
|1345|0 MPRO_ECAM_Egear_LimRefJerk|rpm/s²|EGEAR: Jerk limit for reference|

Table 8.38: “Synchronized motion - Electronic gearing” parameters

Image 8.73: ""Electronic gearing"" screen

MOOG ID No.:CB40859-001 Date:11/2020 MSD ServoDrive - DeviceHelp 283

# 8 Motion profile

# 8 Motion profile

MOOG ID No.:CB40859-001 Date:11/2020

MSD ServoDrive - DeviceHelp 284

# 8.11.6 Engagement

used to define the engagement distance (between the dashed lines).

P 253[0] - MPRO_ECAM_Egear_GearInMode is used to define the mode for engagement.

- DIRECT (0) = Direct
- Direct engagement: Angular synchronous; with jerking (no ramps).
- CROSSFADE (3) = Crossfading
- Engagement with crossfading function (5th degree polynomial): Angular synchronous; jerk-limited; speed will overshoot during engagement.
- RAMP (1) = Linear speed ramp
- Engagement with linear acceleration: Not angular synchronous; with jerking.
- FADE (2) = Engagement fade-out
- Engagement with fade-in function (5th degree polynomial): Not angular synchronous; jerk-limited. The position is ignored. ",What parameter shows the current active motion task index in the 'MSD ServoDrive - DeviceHelp' document?,A2,The active motion task index is displayed by P 207[0].,2.8125,2.859375,3.84375,1.15625,0.40625
42,msd_servo_drive.txt,76,b87ca5e232c2bdbb6fa16a8a401c6b5d285dc0183e73cc9d134de13dd2fc71d2,"MOOG ID No.:CB40859-001 Date:11/2020

MSD ServoDrive - DeviceHelp 267

# 8 Motion profile

MOOG ID No.:CB40859-001 Date:11/2020 MSD ServoDrive - DeviceHelp 268

# Deceleration

With ...

- P 194 - MPRO_TAB_TDec (for torque control) or
- P 197 - MPRO_TAB_SDec (for speed control) or
- P 200 - MPRO_TAB_PDec (for position control)

and indexes 0–15, the deceleration for each individual motion task can be defined. The input must not be zero.

# Wait time in Auto mode

P 204 - MPRO_TAB_WaitTime is used to define the wait time before the next motion task is carried out.

# Maximum table index in Auto mode

P 206[0] - MPRO_Tab_MaxIdx is used to define the table index up to which driving jobs will be carried out in one of the auto modes.

# Current table index

P 207[0] - MPRO_Tab_ActIdx will show the index for the motion task that is currently active. If parameter P 205 MPRO_TAB_Mode is set to “Para(0)”, a driving set can be entered and approached directly.

# Activation of reference table

The following procedures can be used in order to activate the setpoint table for operation.

|ID|Index Name|Unit|Description|
|---|---|---|---|
|193|MPRO_TAB_TAcc|TAB: Torque mode acceleration|Nm/ms|
|193|0|MPRO_TAB_TAcc|Nm/ms|
|193|1 - 15|MPRO_TAB_TAcc|Nm/ms|
|194|MPRO_TAB_TDec|TAB: Torque mode deceleration| |
|194|0|MPRO_TAB_TDec|Nm/ms|
|194|1 - 15|MPRO_TAB_TDec|Nm/ms|

# Table 8.23: Activation of table references

# Table 8.24: “Setpoint table settings” parameters

# Table 8.24: “Setpoint table settings” parameters (continue)

|ID|Index Name|Unit|Description|ID|Index Name|Unit|Description|
|---|---|---|---|---|---|---|---|
|195|MPRO_TAB_TRef|Nm|TAB: Torque mode reference value|208|MPRO_TAB_OutputNo| |OSD TAB: actual table index and target|
|195|MPRO_TAB_TRef|Nm| |208|MPRO_TAB_OutputNo| | |
|196|MPRO_TAB_SAcc|rev/min/s|TAB: Speed mode acceleration|269|MPRO_TAB_Ctrl| |TAB: control word|
|196|MPRO_TAB_SAcc|rev/min/s| | | | | |
|197|MPRO_TAB_SDec|rev/min/s|TAB: Speed mode deceleration| | | | |
|197|MPRO_TAB_SDec|rev/min/s| | | | | |
|198|MPRO_TAB_SRef|rev/min|TAB: Speed mode reference value| | | | |
|198|MPRO_TAB_SRef|rev/min| | | | | |
|199|MPRO_TAB_PAcc|rev/min/s|TAB: Position control mode acceleration| | | | |
|199|MPRO_TAB_PAcc|rev/min/s| | | | | |
|200|MPRO_TAB_PDec|rev/min/s|TAB: Position control mode Acceleration| | | | |
|200|MPRO_TAB_PDec|rev/min/s| | | | | |
|201|MPRO_TAB_PSpd|rev/min|TAB: Position control mode speed| | | | |
|201|MPRO_TAB_PSpd|rev/min| | | | | |
|202|MPRO_TAB_PPos|mDegree|TAB: Position control mode reference value| | | | |
|202|MPRO_TAB_PPos|mDegree| | | | | |
|203|MPRO_TAB_PMode| |Position control table:Mode| | | | |
|203|MPRO_TAB_PMode| | | | | | |
|204|MPRO_TAB_WaitTime|ms|TAB: Wait time| | | | |
|204|MPRO_TAB_WaitTime|ms| | | | | |
|205|MPRO_TAB_Mode| |TAB mode| | | | |
|206|MPRO_Tab_MaxIdx| |TAB: Max index in AUTO mode| | | | |
|207|MPRO_TAB_ActIdx| |TAB: Actual index| | | | |

MOOG ID No.:CB40859-001 Date:11/2020

MSD ServoDrive - DeviceHelp

# 8 Motion profile

MOOG ID No.:CB40859-001 Date:11/2020

MSD ServoDrive - DeviceHelp 270

# 8.8 Analog channel (ISA00 und ISA01)

# Offset (O)

This parameter (P 174 - MPRO_ANA0_SOffset for ISA00, P 184 - MPRO_ANA1_SOffset for ISA01) compensates for component variations and is used for offset compensation purposes. Depending on the control mode being used (see Section ""Basic settings"" on page 110), the value will be stored in parameter index [0] (torque control), [1] (speed control) or [2] (position control).

# Backlash (B)

This parameter (P 175 - MPRO_ANA0_SThreshold for ISA00, P 185 - MPRO_ANA1_SThreshold for ISA01) can suppress axis motion close to the standstill (stop) position. Depending on the control mode being used (see Section ""Basic settings"" on page 110), the value will be stored in parameter index [0] (torque control), [1] (speed control) or [2] (position control).

Image 8.68: “Analog channel” screen

# Acceleration ramp

Two standard analog inputs (ISA00, ISA01) are available. These inputs can be configured...

- with negative values for analog setpoint settings
- with positive values for digital setpoint processing

(P 109[0] - MPRO_INPUT_FS_ISA00 and P 110[0] - MPRO_INPUT_FS_ISA01).

see also section ""Analog Inputs"" on page 303. By using the ""REV(-2) = Analog setpoint"" setting, an analog input voltage of ±10 V can be processed as a setpoint.

# Deceleration ramp

This parameter serves as a deceleration ramp for torque control (P 176[1] - MPRO_ANA0_TRamp for ISA00, P 186[1] - MPRO_ANA1_TRamp for ISA01) or speed control (P 177[1] - MPRO_ANA0_SRamp for ISA00, P 187[1] - MPRO_ANA1_SRamp for ISA01). Depending on the control mode being used (see Section ""Basic settings"" on page 110), the value will be stored in parameter index [0] (torque control), [1] (speed control) or [2] (position control).

This parameter (P 173 - MPRO_ANA0_Scale for ISA00, P 183 - MPRO_ANA1_Scale for ISA01) is used to define which speed / which torque / which position corresponds to the maximum analog value. Depending on the control mode being used (see Section ""Basic settings"" on page 110), the value will be stored in parameter index [0] (torque control), [1] (speed control) or [2] (position control).

# 8.8.1 Special characteristics of position control mode

A threshold value can also be specified which generates a run-on range around the last reference value. A ramp function calculates a motion profile for the position reference from pre-defined acceleration and speed limits.

The position references on the analog channel are not applied immediately, but dependent on a digital input. Accordingly, one of the ISD00 to ISD06 digital inputs must be set to a value of ""REFANAEN(28) = Enable analog reference value"" (see Section ""Digital inputs"" on page 290). The position setpoint being received will only be applied if the corresponding digital input is active. The acceleration is entered using P 173[0] - MPRO_ANA0_TScale or P 183[0] - MPRO_ANA1_TScale.

# 8.8.2 Wire Break Monitoring

P 399 - CON_ANAWireBrk_Th can be used to configure wire break monitoring for the analog inputs. For details see Section ""Wire Break Monitoring"" on page 306.

|Function|TLIM (-4)|OVR (-3)|REFV (-2)|leer (-1)|OFF (0)|
|---|---|---|---|---|---|
|Digital|(1)-(28)|(1)-(28)|(1)-(28)|(1)-(28)|(1)-(28)|
|Analog channel|Filter|Scale|Offset|Profile|generator|

Control

Image 8.69: Reference processing structure

MOOG ID No.:CB40859-001 Date:11/2020

MSD ServoDrive - DeviceHelp 271

# 8 Motion profile

# 8 Motion profile

MOOG ID No.:CB40859-001 Date:11/2020

|ID|Index Name|Unit|Description|ID|
|---|---|---|---|---|
|395|CON_ANA_Isaf_Scaled| |Analog inputs: Values (filt, norm, comp, scaled)|174|
|395|0 ISA00| |Scaled, compensated, filtered, normalized value|175|
|395|1 ISA01| |Scaled, compensated, filtered, normalized value| |
|396|CON_ANA_Scale_ThUpper| |Analog inputs: Upper scaling limits|175|
|396|0 ISA00|%|Upper scaling (@ 10 V) threshold|175|
|396|1 ISA01|%|Upper scaling (@ 10 V) threshold| |
|397|CON_ANA_Scale_ThZero| |Analog inputs: Zero scaling thresholds|176|
|397|0 ISA00|V|Zero scaling threshold (+/-)|176|
|397|1 ISA01|V|Zero scaling threshold (+/-)| |
|398|CON_ANA_Scale_ThLower| |Analog inputs: Lower scaling limits|177|
|398|0 ISA00|%|Lower scaling (@ zero threshold) threshold|177|
|398|1 ISA01|%|Lower scaling (@ zero threshold) threshold| |
|399|CON_ANA_WireBrk_Th| |Analog inputs: Wire break thresholds|Table 8.26:|
|399|0 ISA00|V|Wire break detection threshold| |
|399|1 ISA01|V|Wire break detection threshold| |
|405|0 CON_ANA_Filt0|ms|Analog input ISA00: Filter time constant (PT 1)|ID|
|408|CON_ANA_Isaf_Norm| |Analog inputs: Values (filt, norm)|183|
|408|0 ISA00| |Filtered, normalized value|183|
|408|1 ISA01| |Filtered, normalized value|183|

Table 8.25: “Analog channel” parameters

|ID|Index Name|Unit|Description|ID|
|---|---|---|---|---|
|173|MPRO_ANA0_Scale| |ANA0: scale factors|184|
|173|0 MPRO_ANA0_TScale|Nm|ANA0: scale factor torque reference|185|
|173|1 MPRO_ANA0_SScale|rev/min|ANA0: scale factor speed reference|185|
|173|2 MPRO_ANA0_PScale|mDegree|ANA0: scale factor position reference| |
|174|MPRO_ANA0_Offset| |ANA0: offsets|185|
|174|0 MPRO_ANA0_TOffset|Nm|ANA0: offsets for torque reference|185|

Table 8.26: “Analog channel ISA00” parameters

|Index Name|Unit|Description|
|---|---|---|
|1 MPRO_ANA0_SOffset|rev/min|ANA0: offsets for speed reference|
|2 MPRO_ANA0_POffset|mDegree|ANA0: offsets for position reference|
|MPRO_ANA0_Threshold| |ANA0: thresholds|
|0 MPRO_ANA0_TThreshold|Nm|ANA0: threshold for torque reference|
|1 MPRO_ANA0_SThreshold|rev/min|ANA0: threshold for speed reference|
|2 MPRO_ANA0_PThreshold|mDegree|ANA0: threshold for position reference|
|MPRO_ANA0_TRamp| |ANA0: Torque mode acceleration [0] and deceleration [1]|
|0 MPRO_ANA0_TRamp|Nm/s| |
|1 MPRO_ANA0_TRamp|Nm/s| |
|MPRO_ANA0_SRamp| |ANA0: Speed mode acceleration [0] and deceleration [1]|
|0 MPRO_ANA0_SRamp|SPEED/s| |
|1 MPRO_ANA0_SRamp|SPEED/s| |

“Analog channel ISA00” parameters (continue)

|Index Name|Unit|Description|
|---|---|---|
|MPRO_ANA1_Scale| |ANA1: scale factors|
|0 MPRO_ANA1_TScale|Nm|ANA0: scale factor torque reference|
|1 MPRO_ANA1_SScale|rev/min|ANA0: scale factor speed reference|
|2 MPRO_ANA1_PScale|mDegree|ANA0: scale factor position reference|
|MPRO_ANA1_Offset| |ANA1: offsets|
|0 MPRO_ANA1_TOffset|Nm|ANA1: offsets for torque reference|
|1 MPRO_ANA1_SOffset|rev/min|ANA1: offsets for speed reference|
|2 MPRO_ANA1_POffset|mDegree|ANA1: offsets for position reference|
|MPRO_ANA1_Threshold| |ANA1: thresholds|
|0 MPRO_ANA1_TThreshold|Nm|ANA1: threshold for torque reference|
|1 MPRO_ANA1_SThreshold|rev/min|ANA1: threshold for speed reference|
|2 MPRO_ANA1_PThreshold|mDegree|ANA1: threshold for position reference|

“Analog channel ISA01” parameters

# 8 Motion profile

|ID|Index Name|Unit|Description|
|---|---|---|---|
|186|MPRO_ANA1_TRamp|Nm/s|ANA1: Torque mode acceleration [0] and deceleration[1]|
|186|MPRO_ANA1_TRamp|Nm/s| |
|187|MPRO_ANA1_SRamp|SPEED/s|ANA1: Speed mode acceleration [0] and deceleration [1]|
|187|MPRO_ANA1_SRamp|SPEED/s| |

# Table 8.27: “Analog channel ISA01” parameters (continue)

Display

- System state
- Initialization on device startup
- Not ready (DC link voltage possibly too low)
- Start inhibit (DC link voltage present, power stage off)
- Starting lockout
- Ready for start
- Control initialization: Auto commutation, flux build-up etc.

# Table 8.28: Central state machine according to CiA 402 device display

MOOG ID No.:CB40859-001 Date:11/2020

MSD ServoDrive - DeviceHelp 273

# 8 Motion profile

MOOG ID No.:CB40859-001 Date:11/2020

MSD ServoDrive - DeviceHelp 274

|Display|System state|power disabled|fault|
|---|---|---|---|
|Control enabled|0|Start|7|
| |fault reaction active|0|14|
|Quick stop active|1|not ready|8|
| |to switch on|1|17|
|Error reaction active|2|switch on|disabled|
| |2|7| |
|Error state (in this state the error is indicated directly on the display.)|3|ready to|switch on|
|Device is reset (display flashes)|power enabled|3|6|
| |10|12| |
|• Number [5.] flashes when “STO” (Safe Torque Off) input is active. Display goes out when STO inactive.| | | |
|• The dot on the display flashes when the power stage is active.| | | |

Table 8.28: Central state machine according to CiA 402 device display (continue)

NOTE

l The system states indicated on the display may differ from the states in the table depending on the drive profile setting.

Image 8.70: State machine diagram based on CANopen communications

⓪ to ① State number

1 to 17 State transition (No. 17: DC link voltage cut off)

Legend for “State machine diagram based on CANopen communications” figure

# 8.10 Touch probe

|ID|Index Name / Setting|
|---|---|
|241|0 MPRO_TP_Position|
|241|1 MPRO_TP_Position|
|241|2 MPRO_TP_Position|
|241|3 MPRO_TP_Position|
|241|4 MPRO_TP_Position|
|1400|0 MPRO_TP_Config|
| |TP_TP (0)|
| |AB (1)|
| |PD_UP (2)|
| |PD_DOWN (3)|
| |PC_PC (4)|
| |PC_TP (5)|
| |TP_PC (6)|
| |ENC_ENC (7)|
| |ENC_TP (8)|
| |TP_ENC (9)|

Using the touch probe inputs, touch probe functions can be performed. In order to be able to do this, P 106[0] - MPRO_INPUT_FS_ISD05 and P 107[0] - MPRO_INPUT_FS_ISD06 must be used to set digital inputs ISD05 and ISD06 to ""PROBE(15) = Touch probe (only ISD05/06)"" (see Section ""Digital inputs"" on page 290). HTL encoders can be evaluated or pulse counters implemented using the MSD PLC.

The touch probe can be triggered with P 240 - MPRO_TP_Ctrl. This enables triggering on a positive or negative edge, or on both edges, of the signal detected on the touch probe inputs. After the measurement, the parameter jumps back to the value ""NONE (0)"" and the latch position is mapped in the corresponding subindex of parameter P 241 - MPRO_TP_Position. A continuous touch probe mode is not possible at present, so the touch probe has to be reactivated after the measurement.

P 1402 - MPRO_TP_Channel can be used to select various positions as actual value sources of the latch position for the touch probe functionality. The following table provides an overview of the available settings. The counters are accessed via the MSD PLC or a bus system.

|ID|Index Name / Setting|Unit|Description|
|---|---|---|---|
|240|MPRO_TP_Ctrl|Touch probe: Control| |
| |0| |NONE (0) = No function|
| |1| |POS (1) = Positive edge|
| |2| |NEG (2) = Negative edge|
| |3| |BOTH (3) = Both edges|
|240|0 MPRO_TP_Ctrl| | |
|240|1 MPRO_TP_Ctrl| | |
|240|2 MPRO_TP_Ctrl| | |
|241|MPRO_TP_Position|Probe: Pos. high/low edge of TP0/1, encoder zero pulse| |

Table 8.29: “Touch probe” parameters

MOOG ID No.:CB40859-001 Date:11/2020

# 8 Motion profile

|Unit|Description|
|---|---|
|mDegree|Touch probe: Configuration|
|mDegree|TP0, TP1 touch probe|
|mDegree|TP0, TP1 as encoder, A/B as quadrature counting|
|mDegree|TP0, TP1 as encoder, pulse (TP0) / direction (TP1), count up on direction high|
|mDegree|TP0, TP1 as encoder, pulse (TP0) / direction (TP1), count down on direction high|
|mDegree|TP0 pulse counter, TP1 pulse counter|
|mDegree|TP0 pulse counter, TP1 touch probe|
|mDegree|TP1 touch probe, TP0 pulse counter|
|mDegree|TP0 encoder counter, TP1 encoder counter|
|mDegree|TP0 encoder counter, TP1 touch probe|
|mDegree|TP0 touch probe, TP1 encoder counter|

Touch probe: Channel

|Unit|Description|
|---|---|
|ACTPOS (0)|Actual position in user units|
|ACTPOSINC (1)|Actual position in increments|
|MASTERPOS (2)|Master position in increments|
|ENCPOS_CH1 (3)|Encoder position Channel 1|
|ENCPOS_CH1_INC (4)|Encoder position Channel 1 in increments|
|ENCPOS_CH2 (5)|Encoder position Channel 2|
|ENCPOS_CH2_INC (6)|Encoder position Channel 2 in increments|

# 8 Motion profile

MOOG ID No.:CB40859-001 Date:11/2020 MSD ServoDrive - DeviceHelp 276

|ID|Index Name / Setting|Unit|Description|
|---|---|---|---|
|7|ENCPOS_CH3 (7)| |Encoder position Channel 3|
|8|ENCPOS_CH3_INC (8)| |Encoder position Channel 3 in increments|
|9|ENCPOS_CH4 (9)| |Encoder position Channel 4|
|10|ENCPOS_CH4_INC (10)| |Encoder position Channel 4 in increments|
|11|ACTPOS2 (11)| |Actual position of redundant encoder in user units|
|12|Sercos (12)| |Referred to Sercos profile parameters S-x-0426, S-x-0427|
|13|UserRefPos(13)| |Reference position in user units|
|14|MasterPosST(14)| |Master position (ECAM, EGEAR) singleturn, always steps|
|15|CommonMasterPos(15)| |Master position (ECAM, EGEAR) singleturn, always steps|
|16|CommonMasterPosST(15)| |Master position (ECAM, EGEAR) singleturn, always steps|
|1402|MPRO_TP_Channel| | |
|1402|MPRO_TP_Channel| | |
|1402|MPRO_TP_Channel| | |
|1404|MPRO_TP_Lines| |Touch probe: Lines @ pulse counter on channel x|
|1404|MPRO_TP_Lines| | |
|1404|MPRO_TP_Lines| | |

Image 8.71: “Synchronized motion” screen

There are various modes available in the “synchronization mode” drop-down menu (P 242[0] - MPRO_ECAM_SyncModMode):

- Off(0) = Synchronized motion off
- ECAM_iPlc(1) = Electronic cam plate via MSD PLC
- EGEAR_iPlc(2) = Electr. gear unit via MSD PLC
- ECAM_PARA(3) = Electronic camming via parameters
- EGEAR_PARA(4) = Electronic gearing via parameters

NOTE: For more information refer to the bus system User Manuals or the description of the MSD PLC.

# 8.11.1 Electronic cam plate

The other parameters are configured in separate screens that can be accessed with the corresponding buttons.

- Master configuration (see Section ""Master configuration"" on page 280)
- Electronic gearing (see Section ""Electronic gearing"" on page 283)
- Electronic camming (see Section ""Electronic cam plate"" on page 277)

P 1318[0] - MPRO_ECAM_ControlWord is the control word for “synchronized motion” (see Section ""Control word for synchronized motion"" on page 279).

P 1326[0] - MPRO_ECAM_StatusWord is the status word for “synchronized motion” (see Section ""Status word for synchronized motion"" on page 279).

# 8.11.1.1 Table selection

|ID|Index Name|Unit|Description|
|---|---|---|---|
|1300|MPRO_ECAM_CTS_| |ECAM: CamTableSelect - Master reference|
|1301|MasterRef| | |
|1305|MPRO_ECAM_CTS_| |ECAM: CamTableSelect - Method for changing the camtable|
|1306|MPRO_ECAM_CTS_| |ECAM: CamTableSelect - Mode for changing the camtable|
|1307|MPRO_ECAM_CTS_|incr|ECAM: CamTableSelect - Distance for changing the camtable|
|242|MPRO_ECAM_| |ECAM / EGEAR: Mode of synchronized motion SyncModMode|
|265|MPRO_ECAM_| |ECAM / EGEAR: Slave speed factor (1 = 100%).|
|266|CamSlave_SpeedFactor| | |
|268|MPRO_ECAM_| |ECAM / EGEAR: Mode of switching off sync. motion|

# 8.11.1.2 Synchronization

|ID|Index Name|Unit|Description|
|---|---|---|---|
|1342|MPRO_ECAM_CI_|incr|ECAM: CamIn - Synchronization position (multiturn part)|
|1343|MPRO_ECAM_CO_|incr|ECAM: CamOut - Decoupling pos. (multiturn part)|
|1303|MPRO_ECAM_CI_|incr|ECAM: CamIn - Master offset|
|1308|MPRO_ECAM_CI_| |ECAM: CamIn - Master reference|
|1309|MPRO_ECAM_CI_| |ECAM: CamIn - Slave reference|
|1310|MPRO_ECAM_CI_| |ECAM: CamIn - Coupling mode|
|1311|MPRO_ECAM_CI_|incr|ECAM: CamIn - Coupling distance|
|1312|MPRO_ECAM_CI_|incr|ECAM: CamIn - Synchronization position|

Table 8.31: “Electronic camming - Table selection” parameters

Table 8.30: “Synchronized motion” parameters

Table 8.32: “Electronic camming - Synchronization” parameters

MOOG ID No.:CB40859-001 Date:11/2020

MSD ServoDrive - DeviceHelp 277

# 8 Motion profile

MOOG ID No.:CB40859-001 Date:11/2020 MSD ServoDrive - DeviceHelp 278

|ID|Index|Name|Unit|Description|
|---|---|---|---|---|
|1313|0|MPRO_ECAM_CO_SyncPosST|(singleturn part)|ECAM: CamOut - Slave reference|
|1314|0|MPRO_ECAM_CO_DecouplingMode|63|ECAM: CamOut - Decoupling mode|
|1315|0|MPRO_ECAM_CO_BreakingPosST|incr|ECAM: CamOut - Decoupling position|
|1316|0|MPRO_ECAM_CO_DecouplingDist|incr|ECAM: CamOut - Decoupling distance|
|1317|0|MPRO_ECAM_CO_StandstillPos|mDegree|ECAM: CamOut - Slave standstill position|

# Table 8.32: “Electronic camming - Synchronization” parameters (continue)

|ID|Index|Name|Unit|Description|
|---|---|---|---|---|
|1346| |MPRO_ECAM_SP_Table| |ECAM: Setpoint table interface|
|1346|0|Index| |Index of setpoint table|
|1346|1|Value| |Value at index of setpoint table|
|1347|0 to 31|MPRO_ECAM_SP_Index| |ECAM: Setpoint segments start index|
|1348|0 to 31|MPRO_ECAM_SP_Length| |ECAM: Setpoint segments length|
|1349|0 to 31|Length| | |
|1350|0|MPRO_ECAM_SP_MaDist| |ECAM: Setpoint segments master distance|
|1351|0|MPRO_ECAM_SP_IpoType| |ECAM: Setpoint segments interpolation type|
|1352|0 to 31|Checksum| |ECAM: Setpoint table checksum|
|1353|0 to 31|GainNum| |ECAM: Setpoint segments gain numerator|
| | |GainDen| |ECAM: Setpoint segments gain denominator|

# Table 8.33: “Electronic camming - Table segments” parameters

|ID|Index|Name|Unit|Description|
|---|---|---|---|---|
|1329|0 to 63|MPRO_ECAM_SegData_IndexNext| |ECAM: Index of the following segment|
|1330|0 to 63|MPRO_ECAM_SegData_IndexPrev| |ECAM: Index of the previous segment|
|1331|0 to 63|MPRO_ECAM_SegData_ProfileMode| |ECAM: Profile mode of the current segment|
|1332|0 to 63|MPRO_ECAM_SegData_DistMaster| |ECAM: Length of the master section of the current segment|
|1333|0 to 63|MPRO_ECAM_SegData_DistSlave| |ECAM: Length of the slave section of the current segment|
|1334|0 to 63|MPRO_ECAM_SegData_Lambda| |ECAM: Lambda value of the current segment|
|1335|0 to 63|MPRO_ECAM_SegData_StatusWord| |ECAM: Status word of the current segment|
|1336|0 to 63|MPRO_ECAM_SegData_ControlWord| |ECAM: Control word of the current segment|

# 8.11.2 Control word for synchronized motion

|Bit|Function|PLC function|Bit number|Description|
|---|---|---|---|---|
|0-7|Start segment (8-bit value)|-|0-7|Actual segment (8-bit value)|
|8-15|Reserved|-| |Actual ECAM / EGEAR state machine state (4 Bit value)|
|16|Absolute (true) / relative (false) master relationship|-| |- 0: ECAM / EGEAR asynchronous
- 1: ECAM / EGEAR synchronous
|
|17|Absolute (true) / relative (false) master (CAM) relationship at cam in|-| |- 2: ECAM / EGEAR synchronizing
- 3: ECAM / EGEAR desynchronizing
|
|18|Absolute (true) / relative (false) slave (CAM) relationship at cam in|-| |- 4: ECAM / EGEAR active and waiting for going asynchronous
|
|19-23|Reserved|-| |- 5: ECAM / EGEAR inactive and waiting for going synchronous
|
|24|Change gear ratio of the electronic gear online|MCB_GearRatioChange| | |
|25|Disable master calculation|MCB_Cam_MasterEnable| | |
|26|Enable master calculation|MCB_Cam_MasterEnable| | |
|27|Select CAM table|MCB_CamTableSelect| | |
|28|Start Ecam|MCB_CamIn| | |
|29|Stop Ecam|MCB_CamOut| | |
|30|Start Egear|MCB_GearIn| | |
|31|Stop Egear|MCB_GearOut| | |

# 8.11.3 Status word for synchronized motion

|Bit|Function|PLC function|Bit number|Description|
|---|---|---|---|---|
|12-26|Reserved|-| | |
|27|ECAM / EGEAR is active|-| | |
|28|Valid segments chosen|-| | |
|29|Master data are valid|-| | |
|30|Master is initialized|-| | |
|31|Master calculation is active|-| | |

Table 8.35: Control word ECAM (P 1318[0] - MPRO_ECAM_ControlWord)

Table 8.36: ECAM status word (P 1326[0] - MPRO_ECAM_StatusWord)

MOOG ID No.:CB40859-001 Date:11/2020 MSD ServoDrive - DeviceHelp 279

# 8 Motion profile

# 8 Motion profile

MOOG ID No.:CB40859-001 Date:11/2020

MSD ServoDrive - DeviceHelp 280

# 8.11.4 Master configuration

the master encoder, you will need to set the resolution relative to a single motor revolution in P 250 - MPRO_ECAM_PARAMaster_Amplitude (see below).

- ENC CH1 (3) = Encoder channel 1 X7 (Sin/Cos)
- ENC CH2 (4) = Encoder channel 2 X6 (Resolver)
- ENC CH3 (5) = Encoder channel 3 X8 (optional)

This function is only available if an external interface X8 (option module) is present.

- TP0 (6) = Pulse counter on probe channel 0 (TP0)
- TP1 (7) = Pulse counter on probe channel 1 (TP1)
- ENC_CH4 (8) = Encoder channel 4 (p. e. fieldbus)
- TWIN_POS (9) = TWIN remote reference position (P-2607)

Image 8.72: “Master configuration” screen

# Channel selection (master encoder)

P 1319[0] - MPRO_ECAM_CamMaster_AxisType is used to define the master encoder.

- NO AXIS (0) = No axis
- VIRTUAL MASTER (1) = Virtual master

If you select this function, you will be able to configure additional settings by clicking on the enabled “Options...” button (see Section ""Virtual Master"" on page 286).

- PARA (2) = Master parameter interface

If you select this function because a higher-level controller is being used as

# Anti-reverse mode

Slave only starts moving along with it again as soon as the master reaches the zero position.

P 1320[0] - MPRO_ECAM_CamMaster_RevLockMode is used to define the reverse lock mode, which can be used either with or without path compensation. The dashed lines in the following diagrams indicate what the engagement distance is:

# Example:

If the master, which has moved two motor revolutions in the direction blocked for the slave, then moves in the unblocked direction again, the slave only moves off when the master has traversed the zero point.

- INACTIVE (0) = Reverse lock inactive
- ACTIVE (2) = Reverse lock enabled - without path optimization
- ACTIVE WAY COMP (1) = Reverse lock active - with way compensation

While the slave accelerates to the speed of the master during engagement, the master and slave do not move synchronously. This function needs to be selected in order to quickly catch up to the master that is running ahead.

# Example:

- Master (black line) rotates in the blocked direction
- The slave (blue line) remains stopped
- Master rotates in the unblocked direction again
- The slave follows the master directly in the unblocked direction

Assume the master has moved two motor revolutions in the direction for which the slave lock is enabled. If the master now moves in the direction for which there is no lock, the slave will immediately start running in that direction.

MOOG ID No.:CB40859-001 Date:11/2020

MSD ServoDrive - DeviceHelp 281

# 8 Motion profile

MOOG ID No.:CB40859-001 Date:11/2020 MSD ServoDrive - DeviceHelp 282

|Filter type|ID|Index Name|Unit|Description|
|---|---|---|---|---|
|When using a real master encoder, encoder signals may be subject to noise.|P 1340|1319|0|MPRO_ECAM_CamMaster_AxisType|
| | |MPRO_ECAM_CamMaster_SpeedFilTyp| |ECAM / EGEAR: Channel selection of internal master input|
| | |1320|0|MPRO_ECAM_CamMaster_RevLockMode|
| | |1321|0|MPRO_ECAM_CamMaster_Amplitude|
| | |1322|0|MPRO_ECAM_CamMaster_GearNum|
| | |1323|0|MPRO_ECAM_CamMaster_GearDen|
|Filter time|1327|0|ms|ECAM / EGEAR: Filter time constant of master|
|If P 1340[0] is used to enable a filter, P 1327[0] - MPRO_ECAM_CamMaster_SpeedTFil can be used to define the corresponding filter time.|1328|0|speed|ECAM / EGEAR: Speed factor of the internal master|
|Speed factor|1340|0| |MPRO_ECAM_CamMaster_SpeedFilTyp|
|The master encoder can be assigned an additional speed factor P 1328[0] - MPRO_ECAM_CamMaster_SpeedFactor.|1341|0|incr|ECAM / EGEAR: Master drive offset|

Table 8.37: “Synchronized motion - Master configuration” parameters (continue)

| | | |ID|Index Name|Unit|Description|
|---|---|---|---|---|---|---|
|247|0|MPRO_ECAM_ParaMaster_ActPos|incr|ECAM / EGEAR: Parameter interface master position| | |
|248|0|MPRO_ECAM_ParaMaster_ActSpeed|rpm|ECAM / EGEAR: Parameter interface master speed| | |
|249|0|MPRO_ECAM_ParaMaster_ActAcc|rpm|ECAM / EGEAR: Parameter interface master acceleration| | |
| |250|0|MPRO_ECAM_ParaMaster_Amplitude| |ECAM / EGEAR: Parameter interface master amplitude| |

Table 8.37: “Synchronized motion - Master configuration” parameters

# 8.11.5 Electronic gearing

# Gear ratio

The gear ratio is specified as a fraction. This ensures that the position references can be translated to the motor shaft with no rounding error.

- ""Slave"" (P 252[0] - MPRO_ECAM_Egear_GearNum) is the numerator
- ""Master"" (P 251[0] - MPRO_ECAM_Egear_GearDen) is the denominator

# Scaling of speed pre-control

Defined with P 265[0] - MPRO_ECAM_CamSlave_SpeedFactor definiert.

# Scaling of torque pre-control

Defined with P 266[0] - MPRO_ECAM_CamSlave_TorqueFactor.

# Engagement

See Section ""Engagement"" on page 284.

# Disengagement

See Section ""Disengagement"" on page 285.

|ID|Index Name|Unit|Description|
|---|---|---|---|
|251|0 MPRO_ECAM_Egear_GearDen| |EGEAR: Gear denominator|
|252|0 MPRO_ECAM_Egear_GearNum| |EGEAR: Numerator of gear ratio|
|1344|0 MPRO_ECAM_Egear_LimRefAcc|rpm/s|EGEAR: Acceleration limit for reference|
|1345|0 MPRO_ECAM_Egear_LimRefJerk|rpm/s²|EGEAR: Jerk limit for reference|

Table 8.38: “Synchronized motion - Electronic gearing” parameters

Image 8.73: ""Electronic gearing"" screen

MOOG ID No.:CB40859-001 Date:11/2020 MSD ServoDrive - DeviceHelp 283

# 8 Motion profile

# 8 Motion profile

MOOG ID No.:CB40859-001 Date:11/2020

MSD ServoDrive - DeviceHelp 284

# 8.11.6 Engagement

used to define the engagement distance (between the dashed lines).

P 253[0] - MPRO_ECAM_Egear_GearInMode is used to define the mode for engagement.

- DIRECT (0) = Direct
- Direct engagement: Angular synchronous; with jerking (no ramps).
- CROSSFADE (3) = Crossfading
- Engagement with crossfading function (5th degree polynomial): Angular synchronous; jerk-limited; speed will overshoot during engagement.
- RAMP (1) = Linear speed ramp
- Engagement with linear acceleration: Not angular synchronous; with jerking.
- FADE (2) = Engagement fade-out
- Engagement with fade-in function (5th degree polynomial): Not angular synchronous; jerk-limited. The position is ignored. ",What parameter shows the current active motion task index in the 'MSD ServoDrive - DeviceHelp' document?,A3,"To see the current motion task index, refer to P 207[0].",2.328125,2.390625,3.796875,1.125,0.43359375
43,msd_servo_drive.txt,76,b87ca5e232c2bdbb6fa16a8a401c6b5d285dc0183e73cc9d134de13dd2fc71d2,"MOOG ID No.:CB40859-001 Date:11/2020

MSD ServoDrive - DeviceHelp 267

# 8 Motion profile

MOOG ID No.:CB40859-001 Date:11/2020 MSD ServoDrive - DeviceHelp 268

# Deceleration

With ...

- P 194 - MPRO_TAB_TDec (for torque control) or
- P 197 - MPRO_TAB_SDec (for speed control) or
- P 200 - MPRO_TAB_PDec (for position control)

and indexes 0–15, the deceleration for each individual motion task can be defined. The input must not be zero.

# Wait time in Auto mode

P 204 - MPRO_TAB_WaitTime is used to define the wait time before the next motion task is carried out.

# Maximum table index in Auto mode

P 206[0] - MPRO_Tab_MaxIdx is used to define the table index up to which driving jobs will be carried out in one of the auto modes.

# Current table index

P 207[0] - MPRO_Tab_ActIdx will show the index for the motion task that is currently active. If parameter P 205 MPRO_TAB_Mode is set to “Para(0)”, a driving set can be entered and approached directly.

# Activation of reference table

The following procedures can be used in order to activate the setpoint table for operation.

|ID|Index Name|Unit|Description|
|---|---|---|---|
|193|MPRO_TAB_TAcc|TAB: Torque mode acceleration|Nm/ms|
|193|0|MPRO_TAB_TAcc|Nm/ms|
|193|1 - 15|MPRO_TAB_TAcc|Nm/ms|
|194|MPRO_TAB_TDec|TAB: Torque mode deceleration| |
|194|0|MPRO_TAB_TDec|Nm/ms|
|194|1 - 15|MPRO_TAB_TDec|Nm/ms|

# Table 8.23: Activation of table references

# Table 8.24: “Setpoint table settings” parameters

# Table 8.24: “Setpoint table settings” parameters (continue)

|ID|Index Name|Unit|Description|ID|Index Name|Unit|Description|
|---|---|---|---|---|---|---|---|
|195|MPRO_TAB_TRef|Nm|TAB: Torque mode reference value|208|MPRO_TAB_OutputNo| |OSD TAB: actual table index and target|
|195|MPRO_TAB_TRef|Nm| |208|MPRO_TAB_OutputNo| | |
|196|MPRO_TAB_SAcc|rev/min/s|TAB: Speed mode acceleration|269|MPRO_TAB_Ctrl| |TAB: control word|
|196|MPRO_TAB_SAcc|rev/min/s| | | | | |
|197|MPRO_TAB_SDec|rev/min/s|TAB: Speed mode deceleration| | | | |
|197|MPRO_TAB_SDec|rev/min/s| | | | | |
|198|MPRO_TAB_SRef|rev/min|TAB: Speed mode reference value| | | | |
|198|MPRO_TAB_SRef|rev/min| | | | | |
|199|MPRO_TAB_PAcc|rev/min/s|TAB: Position control mode acceleration| | | | |
|199|MPRO_TAB_PAcc|rev/min/s| | | | | |
|200|MPRO_TAB_PDec|rev/min/s|TAB: Position control mode Acceleration| | | | |
|200|MPRO_TAB_PDec|rev/min/s| | | | | |
|201|MPRO_TAB_PSpd|rev/min|TAB: Position control mode speed| | | | |
|201|MPRO_TAB_PSpd|rev/min| | | | | |
|202|MPRO_TAB_PPos|mDegree|TAB: Position control mode reference value| | | | |
|202|MPRO_TAB_PPos|mDegree| | | | | |
|203|MPRO_TAB_PMode| |Position control table:Mode| | | | |
|203|MPRO_TAB_PMode| | | | | | |
|204|MPRO_TAB_WaitTime|ms|TAB: Wait time| | | | |
|204|MPRO_TAB_WaitTime|ms| | | | | |
|205|MPRO_TAB_Mode| |TAB mode| | | | |
|206|MPRO_Tab_MaxIdx| |TAB: Max index in AUTO mode| | | | |
|207|MPRO_TAB_ActIdx| |TAB: Actual index| | | | |

MOOG ID No.:CB40859-001 Date:11/2020

MSD ServoDrive - DeviceHelp

# 8 Motion profile

MOOG ID No.:CB40859-001 Date:11/2020

MSD ServoDrive - DeviceHelp 270

# 8.8 Analog channel (ISA00 und ISA01)

# Offset (O)

This parameter (P 174 - MPRO_ANA0_SOffset for ISA00, P 184 - MPRO_ANA1_SOffset for ISA01) compensates for component variations and is used for offset compensation purposes. Depending on the control mode being used (see Section ""Basic settings"" on page 110), the value will be stored in parameter index [0] (torque control), [1] (speed control) or [2] (position control).

# Backlash (B)

This parameter (P 175 - MPRO_ANA0_SThreshold for ISA00, P 185 - MPRO_ANA1_SThreshold for ISA01) can suppress axis motion close to the standstill (stop) position. Depending on the control mode being used (see Section ""Basic settings"" on page 110), the value will be stored in parameter index [0] (torque control), [1] (speed control) or [2] (position control).

Image 8.68: “Analog channel” screen

# Acceleration ramp

Two standard analog inputs (ISA00, ISA01) are available. These inputs can be configured...

- with negative values for analog setpoint settings
- with positive values for digital setpoint processing

(P 109[0] - MPRO_INPUT_FS_ISA00 and P 110[0] - MPRO_INPUT_FS_ISA01).

see also section ""Analog Inputs"" on page 303. By using the ""REV(-2) = Analog setpoint"" setting, an analog input voltage of ±10 V can be processed as a setpoint.

# Deceleration ramp

This parameter serves as a deceleration ramp for torque control (P 176[1] - MPRO_ANA0_TRamp for ISA00, P 186[1] - MPRO_ANA1_TRamp for ISA01) or speed control (P 177[1] - MPRO_ANA0_SRamp for ISA00, P 187[1] - MPRO_ANA1_SRamp for ISA01). Depending on the control mode being used (see Section ""Basic settings"" on page 110), the value will be stored in parameter index [0] (torque control), [1] (speed control) or [2] (position control).

This parameter (P 173 - MPRO_ANA0_Scale for ISA00, P 183 - MPRO_ANA1_Scale for ISA01) is used to define which speed / which torque / which position corresponds to the maximum analog value. Depending on the control mode being used (see Section ""Basic settings"" on page 110), the value will be stored in parameter index [0] (torque control), [1] (speed control) or [2] (position control).

# 8.8.1 Special characteristics of position control mode

A threshold value can also be specified which generates a run-on range around the last reference value. A ramp function calculates a motion profile for the position reference from pre-defined acceleration and speed limits.

The position references on the analog channel are not applied immediately, but dependent on a digital input. Accordingly, one of the ISD00 to ISD06 digital inputs must be set to a value of ""REFANAEN(28) = Enable analog reference value"" (see Section ""Digital inputs"" on page 290). The position setpoint being received will only be applied if the corresponding digital input is active. The acceleration is entered using P 173[0] - MPRO_ANA0_TScale or P 183[0] - MPRO_ANA1_TScale.

# 8.8.2 Wire Break Monitoring

P 399 - CON_ANAWireBrk_Th can be used to configure wire break monitoring for the analog inputs. For details see Section ""Wire Break Monitoring"" on page 306.

|Function|TLIM (-4)|OVR (-3)|REFV (-2)|leer (-1)|OFF (0)|
|---|---|---|---|---|---|
|Digital|(1)-(28)|(1)-(28)|(1)-(28)|(1)-(28)|(1)-(28)|
|Analog channel|Filter|Scale|Offset|Profile|generator|

Control

Image 8.69: Reference processing structure

MOOG ID No.:CB40859-001 Date:11/2020

MSD ServoDrive - DeviceHelp 271

# 8 Motion profile

# 8 Motion profile

MOOG ID No.:CB40859-001 Date:11/2020

|ID|Index Name|Unit|Description|ID|
|---|---|---|---|---|
|395|CON_ANA_Isaf_Scaled| |Analog inputs: Values (filt, norm, comp, scaled)|174|
|395|0 ISA00| |Scaled, compensated, filtered, normalized value|175|
|395|1 ISA01| |Scaled, compensated, filtered, normalized value| |
|396|CON_ANA_Scale_ThUpper| |Analog inputs: Upper scaling limits|175|
|396|0 ISA00|%|Upper scaling (@ 10 V) threshold|175|
|396|1 ISA01|%|Upper scaling (@ 10 V) threshold| |
|397|CON_ANA_Scale_ThZero| |Analog inputs: Zero scaling thresholds|176|
|397|0 ISA00|V|Zero scaling threshold (+/-)|176|
|397|1 ISA01|V|Zero scaling threshold (+/-)| |
|398|CON_ANA_Scale_ThLower| |Analog inputs: Lower scaling limits|177|
|398|0 ISA00|%|Lower scaling (@ zero threshold) threshold|177|
|398|1 ISA01|%|Lower scaling (@ zero threshold) threshold| |
|399|CON_ANA_WireBrk_Th| |Analog inputs: Wire break thresholds|Table 8.26:|
|399|0 ISA00|V|Wire break detection threshold| |
|399|1 ISA01|V|Wire break detection threshold| |
|405|0 CON_ANA_Filt0|ms|Analog input ISA00: Filter time constant (PT 1)|ID|
|408|CON_ANA_Isaf_Norm| |Analog inputs: Values (filt, norm)|183|
|408|0 ISA00| |Filtered, normalized value|183|
|408|1 ISA01| |Filtered, normalized value|183|

Table 8.25: “Analog channel” parameters

|ID|Index Name|Unit|Description|ID|
|---|---|---|---|---|
|173|MPRO_ANA0_Scale| |ANA0: scale factors|184|
|173|0 MPRO_ANA0_TScale|Nm|ANA0: scale factor torque reference|185|
|173|1 MPRO_ANA0_SScale|rev/min|ANA0: scale factor speed reference|185|
|173|2 MPRO_ANA0_PScale|mDegree|ANA0: scale factor position reference| |
|174|MPRO_ANA0_Offset| |ANA0: offsets|185|
|174|0 MPRO_ANA0_TOffset|Nm|ANA0: offsets for torque reference|185|

Table 8.26: “Analog channel ISA00” parameters

|Index Name|Unit|Description|
|---|---|---|
|1 MPRO_ANA0_SOffset|rev/min|ANA0: offsets for speed reference|
|2 MPRO_ANA0_POffset|mDegree|ANA0: offsets for position reference|
|MPRO_ANA0_Threshold| |ANA0: thresholds|
|0 MPRO_ANA0_TThreshold|Nm|ANA0: threshold for torque reference|
|1 MPRO_ANA0_SThreshold|rev/min|ANA0: threshold for speed reference|
|2 MPRO_ANA0_PThreshold|mDegree|ANA0: threshold for position reference|
|MPRO_ANA0_TRamp| |ANA0: Torque mode acceleration [0] and deceleration [1]|
|0 MPRO_ANA0_TRamp|Nm/s| |
|1 MPRO_ANA0_TRamp|Nm/s| |
|MPRO_ANA0_SRamp| |ANA0: Speed mode acceleration [0] and deceleration [1]|
|0 MPRO_ANA0_SRamp|SPEED/s| |
|1 MPRO_ANA0_SRamp|SPEED/s| |

“Analog channel ISA00” parameters (continue)

|Index Name|Unit|Description|
|---|---|---|
|MPRO_ANA1_Scale| |ANA1: scale factors|
|0 MPRO_ANA1_TScale|Nm|ANA0: scale factor torque reference|
|1 MPRO_ANA1_SScale|rev/min|ANA0: scale factor speed reference|
|2 MPRO_ANA1_PScale|mDegree|ANA0: scale factor position reference|
|MPRO_ANA1_Offset| |ANA1: offsets|
|0 MPRO_ANA1_TOffset|Nm|ANA1: offsets for torque reference|
|1 MPRO_ANA1_SOffset|rev/min|ANA1: offsets for speed reference|
|2 MPRO_ANA1_POffset|mDegree|ANA1: offsets for position reference|
|MPRO_ANA1_Threshold| |ANA1: thresholds|
|0 MPRO_ANA1_TThreshold|Nm|ANA1: threshold for torque reference|
|1 MPRO_ANA1_SThreshold|rev/min|ANA1: threshold for speed reference|
|2 MPRO_ANA1_PThreshold|mDegree|ANA1: threshold for position reference|

“Analog channel ISA01” parameters

# 8 Motion profile

|ID|Index Name|Unit|Description|
|---|---|---|---|
|186|MPRO_ANA1_TRamp|Nm/s|ANA1: Torque mode acceleration [0] and deceleration[1]|
|186|MPRO_ANA1_TRamp|Nm/s| |
|187|MPRO_ANA1_SRamp|SPEED/s|ANA1: Speed mode acceleration [0] and deceleration [1]|
|187|MPRO_ANA1_SRamp|SPEED/s| |

# Table 8.27: “Analog channel ISA01” parameters (continue)

Display

- System state
- Initialization on device startup
- Not ready (DC link voltage possibly too low)
- Start inhibit (DC link voltage present, power stage off)
- Starting lockout
- Ready for start
- Control initialization: Auto commutation, flux build-up etc.

# Table 8.28: Central state machine according to CiA 402 device display

MOOG ID No.:CB40859-001 Date:11/2020

MSD ServoDrive - DeviceHelp 273

# 8 Motion profile

MOOG ID No.:CB40859-001 Date:11/2020

MSD ServoDrive - DeviceHelp 274

|Display|System state|power disabled|fault|
|---|---|---|---|
|Control enabled|0|Start|7|
| |fault reaction active|0|14|
|Quick stop active|1|not ready|8|
| |to switch on|1|17|
|Error reaction active|2|switch on|disabled|
| |2|7| |
|Error state (in this state the error is indicated directly on the display.)|3|ready to|switch on|
|Device is reset (display flashes)|power enabled|3|6|
| |10|12| |
|• Number [5.] flashes when “STO” (Safe Torque Off) input is active. Display goes out when STO inactive.| | | |
|• The dot on the display flashes when the power stage is active.| | | |

Table 8.28: Central state machine according to CiA 402 device display (continue)

NOTE

l The system states indicated on the display may differ from the states in the table depending on the drive profile setting.

Image 8.70: State machine diagram based on CANopen communications

⓪ to ① State number

1 to 17 State transition (No. 17: DC link voltage cut off)

Legend for “State machine diagram based on CANopen communications” figure

# 8.10 Touch probe

|ID|Index Name / Setting|
|---|---|
|241|0 MPRO_TP_Position|
|241|1 MPRO_TP_Position|
|241|2 MPRO_TP_Position|
|241|3 MPRO_TP_Position|
|241|4 MPRO_TP_Position|
|1400|0 MPRO_TP_Config|
| |TP_TP (0)|
| |AB (1)|
| |PD_UP (2)|
| |PD_DOWN (3)|
| |PC_PC (4)|
| |PC_TP (5)|
| |TP_PC (6)|
| |ENC_ENC (7)|
| |ENC_TP (8)|
| |TP_ENC (9)|

Using the touch probe inputs, touch probe functions can be performed. In order to be able to do this, P 106[0] - MPRO_INPUT_FS_ISD05 and P 107[0] - MPRO_INPUT_FS_ISD06 must be used to set digital inputs ISD05 and ISD06 to ""PROBE(15) = Touch probe (only ISD05/06)"" (see Section ""Digital inputs"" on page 290). HTL encoders can be evaluated or pulse counters implemented using the MSD PLC.

The touch probe can be triggered with P 240 - MPRO_TP_Ctrl. This enables triggering on a positive or negative edge, or on both edges, of the signal detected on the touch probe inputs. After the measurement, the parameter jumps back to the value ""NONE (0)"" and the latch position is mapped in the corresponding subindex of parameter P 241 - MPRO_TP_Position. A continuous touch probe mode is not possible at present, so the touch probe has to be reactivated after the measurement.

P 1402 - MPRO_TP_Channel can be used to select various positions as actual value sources of the latch position for the touch probe functionality. The following table provides an overview of the available settings. The counters are accessed via the MSD PLC or a bus system.

|ID|Index Name / Setting|Unit|Description|
|---|---|---|---|
|240|MPRO_TP_Ctrl|Touch probe: Control| |
| |0| |NONE (0) = No function|
| |1| |POS (1) = Positive edge|
| |2| |NEG (2) = Negative edge|
| |3| |BOTH (3) = Both edges|
|240|0 MPRO_TP_Ctrl| | |
|240|1 MPRO_TP_Ctrl| | |
|240|2 MPRO_TP_Ctrl| | |
|241|MPRO_TP_Position|Probe: Pos. high/low edge of TP0/1, encoder zero pulse| |

Table 8.29: “Touch probe” parameters

MOOG ID No.:CB40859-001 Date:11/2020

# 8 Motion profile

|Unit|Description|
|---|---|
|mDegree|Touch probe: Configuration|
|mDegree|TP0, TP1 touch probe|
|mDegree|TP0, TP1 as encoder, A/B as quadrature counting|
|mDegree|TP0, TP1 as encoder, pulse (TP0) / direction (TP1), count up on direction high|
|mDegree|TP0, TP1 as encoder, pulse (TP0) / direction (TP1), count down on direction high|
|mDegree|TP0 pulse counter, TP1 pulse counter|
|mDegree|TP0 pulse counter, TP1 touch probe|
|mDegree|TP1 touch probe, TP0 pulse counter|
|mDegree|TP0 encoder counter, TP1 encoder counter|
|mDegree|TP0 encoder counter, TP1 touch probe|
|mDegree|TP0 touch probe, TP1 encoder counter|

Touch probe: Channel

|Unit|Description|
|---|---|
|ACTPOS (0)|Actual position in user units|
|ACTPOSINC (1)|Actual position in increments|
|MASTERPOS (2)|Master position in increments|
|ENCPOS_CH1 (3)|Encoder position Channel 1|
|ENCPOS_CH1_INC (4)|Encoder position Channel 1 in increments|
|ENCPOS_CH2 (5)|Encoder position Channel 2|
|ENCPOS_CH2_INC (6)|Encoder position Channel 2 in increments|

# 8 Motion profile

MOOG ID No.:CB40859-001 Date:11/2020 MSD ServoDrive - DeviceHelp 276

|ID|Index Name / Setting|Unit|Description|
|---|---|---|---|
|7|ENCPOS_CH3 (7)| |Encoder position Channel 3|
|8|ENCPOS_CH3_INC (8)| |Encoder position Channel 3 in increments|
|9|ENCPOS_CH4 (9)| |Encoder position Channel 4|
|10|ENCPOS_CH4_INC (10)| |Encoder position Channel 4 in increments|
|11|ACTPOS2 (11)| |Actual position of redundant encoder in user units|
|12|Sercos (12)| |Referred to Sercos profile parameters S-x-0426, S-x-0427|
|13|UserRefPos(13)| |Reference position in user units|
|14|MasterPosST(14)| |Master position (ECAM, EGEAR) singleturn, always steps|
|15|CommonMasterPos(15)| |Master position (ECAM, EGEAR) singleturn, always steps|
|16|CommonMasterPosST(15)| |Master position (ECAM, EGEAR) singleturn, always steps|
|1402|MPRO_TP_Channel| | |
|1402|MPRO_TP_Channel| | |
|1402|MPRO_TP_Channel| | |
|1404|MPRO_TP_Lines| |Touch probe: Lines @ pulse counter on channel x|
|1404|MPRO_TP_Lines| | |
|1404|MPRO_TP_Lines| | |

Image 8.71: “Synchronized motion” screen

There are various modes available in the “synchronization mode” drop-down menu (P 242[0] - MPRO_ECAM_SyncModMode):

- Off(0) = Synchronized motion off
- ECAM_iPlc(1) = Electronic cam plate via MSD PLC
- EGEAR_iPlc(2) = Electr. gear unit via MSD PLC
- ECAM_PARA(3) = Electronic camming via parameters
- EGEAR_PARA(4) = Electronic gearing via parameters

NOTE: For more information refer to the bus system User Manuals or the description of the MSD PLC.

# 8.11.1 Electronic cam plate

The other parameters are configured in separate screens that can be accessed with the corresponding buttons.

- Master configuration (see Section ""Master configuration"" on page 280)
- Electronic gearing (see Section ""Electronic gearing"" on page 283)
- Electronic camming (see Section ""Electronic cam plate"" on page 277)

P 1318[0] - MPRO_ECAM_ControlWord is the control word for “synchronized motion” (see Section ""Control word for synchronized motion"" on page 279).

P 1326[0] - MPRO_ECAM_StatusWord is the status word for “synchronized motion” (see Section ""Status word for synchronized motion"" on page 279).

# 8.11.1.1 Table selection

|ID|Index Name|Unit|Description|
|---|---|---|---|
|1300|MPRO_ECAM_CTS_| |ECAM: CamTableSelect - Master reference|
|1301|MasterRef| | |
|1305|MPRO_ECAM_CTS_| |ECAM: CamTableSelect - Method for changing the camtable|
|1306|MPRO_ECAM_CTS_| |ECAM: CamTableSelect - Mode for changing the camtable|
|1307|MPRO_ECAM_CTS_|incr|ECAM: CamTableSelect - Distance for changing the camtable|
|242|MPRO_ECAM_| |ECAM / EGEAR: Mode of synchronized motion SyncModMode|
|265|MPRO_ECAM_| |ECAM / EGEAR: Slave speed factor (1 = 100%).|
|266|CamSlave_SpeedFactor| | |
|268|MPRO_ECAM_| |ECAM / EGEAR: Mode of switching off sync. motion|

# 8.11.1.2 Synchronization

|ID|Index Name|Unit|Description|
|---|---|---|---|
|1342|MPRO_ECAM_CI_|incr|ECAM: CamIn - Synchronization position (multiturn part)|
|1343|MPRO_ECAM_CO_|incr|ECAM: CamOut - Decoupling pos. (multiturn part)|
|1303|MPRO_ECAM_CI_|incr|ECAM: CamIn - Master offset|
|1308|MPRO_ECAM_CI_| |ECAM: CamIn - Master reference|
|1309|MPRO_ECAM_CI_| |ECAM: CamIn - Slave reference|
|1310|MPRO_ECAM_CI_| |ECAM: CamIn - Coupling mode|
|1311|MPRO_ECAM_CI_|incr|ECAM: CamIn - Coupling distance|
|1312|MPRO_ECAM_CI_|incr|ECAM: CamIn - Synchronization position|

Table 8.31: “Electronic camming - Table selection” parameters

Table 8.30: “Synchronized motion” parameters

Table 8.32: “Electronic camming - Synchronization” parameters

MOOG ID No.:CB40859-001 Date:11/2020

MSD ServoDrive - DeviceHelp 277

# 8 Motion profile

MOOG ID No.:CB40859-001 Date:11/2020 MSD ServoDrive - DeviceHelp 278

|ID|Index|Name|Unit|Description|
|---|---|---|---|---|
|1313|0|MPRO_ECAM_CO_SyncPosST|(singleturn part)|ECAM: CamOut - Slave reference|
|1314|0|MPRO_ECAM_CO_DecouplingMode|63|ECAM: CamOut - Decoupling mode|
|1315|0|MPRO_ECAM_CO_BreakingPosST|incr|ECAM: CamOut - Decoupling position|
|1316|0|MPRO_ECAM_CO_DecouplingDist|incr|ECAM: CamOut - Decoupling distance|
|1317|0|MPRO_ECAM_CO_StandstillPos|mDegree|ECAM: CamOut - Slave standstill position|

# Table 8.32: “Electronic camming - Synchronization” parameters (continue)

|ID|Index|Name|Unit|Description|
|---|---|---|---|---|
|1346| |MPRO_ECAM_SP_Table| |ECAM: Setpoint table interface|
|1346|0|Index| |Index of setpoint table|
|1346|1|Value| |Value at index of setpoint table|
|1347|0 to 31|MPRO_ECAM_SP_Index| |ECAM: Setpoint segments start index|
|1348|0 to 31|MPRO_ECAM_SP_Length| |ECAM: Setpoint segments length|
|1349|0 to 31|Length| | |
|1350|0|MPRO_ECAM_SP_MaDist| |ECAM: Setpoint segments master distance|
|1351|0|MPRO_ECAM_SP_IpoType| |ECAM: Setpoint segments interpolation type|
|1352|0 to 31|Checksum| |ECAM: Setpoint table checksum|
|1353|0 to 31|GainNum| |ECAM: Setpoint segments gain numerator|
| | |GainDen| |ECAM: Setpoint segments gain denominator|

# Table 8.33: “Electronic camming - Table segments” parameters

|ID|Index|Name|Unit|Description|
|---|---|---|---|---|
|1329|0 to 63|MPRO_ECAM_SegData_IndexNext| |ECAM: Index of the following segment|
|1330|0 to 63|MPRO_ECAM_SegData_IndexPrev| |ECAM: Index of the previous segment|
|1331|0 to 63|MPRO_ECAM_SegData_ProfileMode| |ECAM: Profile mode of the current segment|
|1332|0 to 63|MPRO_ECAM_SegData_DistMaster| |ECAM: Length of the master section of the current segment|
|1333|0 to 63|MPRO_ECAM_SegData_DistSlave| |ECAM: Length of the slave section of the current segment|
|1334|0 to 63|MPRO_ECAM_SegData_Lambda| |ECAM: Lambda value of the current segment|
|1335|0 to 63|MPRO_ECAM_SegData_StatusWord| |ECAM: Status word of the current segment|
|1336|0 to 63|MPRO_ECAM_SegData_ControlWord| |ECAM: Control word of the current segment|

# 8.11.2 Control word for synchronized motion

|Bit|Function|PLC function|Bit number|Description|
|---|---|---|---|---|
|0-7|Start segment (8-bit value)|-|0-7|Actual segment (8-bit value)|
|8-15|Reserved|-| |Actual ECAM / EGEAR state machine state (4 Bit value)|
|16|Absolute (true) / relative (false) master relationship|-| |- 0: ECAM / EGEAR asynchronous
- 1: ECAM / EGEAR synchronous
|
|17|Absolute (true) / relative (false) master (CAM) relationship at cam in|-| |- 2: ECAM / EGEAR synchronizing
- 3: ECAM / EGEAR desynchronizing
|
|18|Absolute (true) / relative (false) slave (CAM) relationship at cam in|-| |- 4: ECAM / EGEAR active and waiting for going asynchronous
|
|19-23|Reserved|-| |- 5: ECAM / EGEAR inactive and waiting for going synchronous
|
|24|Change gear ratio of the electronic gear online|MCB_GearRatioChange| | |
|25|Disable master calculation|MCB_Cam_MasterEnable| | |
|26|Enable master calculation|MCB_Cam_MasterEnable| | |
|27|Select CAM table|MCB_CamTableSelect| | |
|28|Start Ecam|MCB_CamIn| | |
|29|Stop Ecam|MCB_CamOut| | |
|30|Start Egear|MCB_GearIn| | |
|31|Stop Egear|MCB_GearOut| | |

# 8.11.3 Status word for synchronized motion

|Bit|Function|PLC function|Bit number|Description|
|---|---|---|---|---|
|12-26|Reserved|-| | |
|27|ECAM / EGEAR is active|-| | |
|28|Valid segments chosen|-| | |
|29|Master data are valid|-| | |
|30|Master is initialized|-| | |
|31|Master calculation is active|-| | |

Table 8.35: Control word ECAM (P 1318[0] - MPRO_ECAM_ControlWord)

Table 8.36: ECAM status word (P 1326[0] - MPRO_ECAM_StatusWord)

MOOG ID No.:CB40859-001 Date:11/2020 MSD ServoDrive - DeviceHelp 279

# 8 Motion profile

# 8 Motion profile

MOOG ID No.:CB40859-001 Date:11/2020

MSD ServoDrive - DeviceHelp 280

# 8.11.4 Master configuration

the master encoder, you will need to set the resolution relative to a single motor revolution in P 250 - MPRO_ECAM_PARAMaster_Amplitude (see below).

- ENC CH1 (3) = Encoder channel 1 X7 (Sin/Cos)
- ENC CH2 (4) = Encoder channel 2 X6 (Resolver)
- ENC CH3 (5) = Encoder channel 3 X8 (optional)

This function is only available if an external interface X8 (option module) is present.

- TP0 (6) = Pulse counter on probe channel 0 (TP0)
- TP1 (7) = Pulse counter on probe channel 1 (TP1)
- ENC_CH4 (8) = Encoder channel 4 (p. e. fieldbus)
- TWIN_POS (9) = TWIN remote reference position (P-2607)

Image 8.72: “Master configuration” screen

# Channel selection (master encoder)

P 1319[0] - MPRO_ECAM_CamMaster_AxisType is used to define the master encoder.

- NO AXIS (0) = No axis
- VIRTUAL MASTER (1) = Virtual master

If you select this function, you will be able to configure additional settings by clicking on the enabled “Options...” button (see Section ""Virtual Master"" on page 286).

- PARA (2) = Master parameter interface

If you select this function because a higher-level controller is being used as

# Anti-reverse mode

Slave only starts moving along with it again as soon as the master reaches the zero position.

P 1320[0] - MPRO_ECAM_CamMaster_RevLockMode is used to define the reverse lock mode, which can be used either with or without path compensation. The dashed lines in the following diagrams indicate what the engagement distance is:

# Example:

If the master, which has moved two motor revolutions in the direction blocked for the slave, then moves in the unblocked direction again, the slave only moves off when the master has traversed the zero point.

- INACTIVE (0) = Reverse lock inactive
- ACTIVE (2) = Reverse lock enabled - without path optimization
- ACTIVE WAY COMP (1) = Reverse lock active - with way compensation

While the slave accelerates to the speed of the master during engagement, the master and slave do not move synchronously. This function needs to be selected in order to quickly catch up to the master that is running ahead.

# Example:

- Master (black line) rotates in the blocked direction
- The slave (blue line) remains stopped
- Master rotates in the unblocked direction again
- The slave follows the master directly in the unblocked direction

Assume the master has moved two motor revolutions in the direction for which the slave lock is enabled. If the master now moves in the direction for which there is no lock, the slave will immediately start running in that direction.

MOOG ID No.:CB40859-001 Date:11/2020

MSD ServoDrive - DeviceHelp 281

# 8 Motion profile

MOOG ID No.:CB40859-001 Date:11/2020 MSD ServoDrive - DeviceHelp 282

|Filter type|ID|Index Name|Unit|Description|
|---|---|---|---|---|
|When using a real master encoder, encoder signals may be subject to noise.|P 1340|1319|0|MPRO_ECAM_CamMaster_AxisType|
| | |MPRO_ECAM_CamMaster_SpeedFilTyp| |ECAM / EGEAR: Channel selection of internal master input|
| | |1320|0|MPRO_ECAM_CamMaster_RevLockMode|
| | |1321|0|MPRO_ECAM_CamMaster_Amplitude|
| | |1322|0|MPRO_ECAM_CamMaster_GearNum|
| | |1323|0|MPRO_ECAM_CamMaster_GearDen|
|Filter time|1327|0|ms|ECAM / EGEAR: Filter time constant of master|
|If P 1340[0] is used to enable a filter, P 1327[0] - MPRO_ECAM_CamMaster_SpeedTFil can be used to define the corresponding filter time.|1328|0|speed|ECAM / EGEAR: Speed factor of the internal master|
|Speed factor|1340|0| |MPRO_ECAM_CamMaster_SpeedFilTyp|
|The master encoder can be assigned an additional speed factor P 1328[0] - MPRO_ECAM_CamMaster_SpeedFactor.|1341|0|incr|ECAM / EGEAR: Master drive offset|

Table 8.37: “Synchronized motion - Master configuration” parameters (continue)

| | | |ID|Index Name|Unit|Description|
|---|---|---|---|---|---|---|
|247|0|MPRO_ECAM_ParaMaster_ActPos|incr|ECAM / EGEAR: Parameter interface master position| | |
|248|0|MPRO_ECAM_ParaMaster_ActSpeed|rpm|ECAM / EGEAR: Parameter interface master speed| | |
|249|0|MPRO_ECAM_ParaMaster_ActAcc|rpm|ECAM / EGEAR: Parameter interface master acceleration| | |
| |250|0|MPRO_ECAM_ParaMaster_Amplitude| |ECAM / EGEAR: Parameter interface master amplitude| |

Table 8.37: “Synchronized motion - Master configuration” parameters

# 8.11.5 Electronic gearing

# Gear ratio

The gear ratio is specified as a fraction. This ensures that the position references can be translated to the motor shaft with no rounding error.

- ""Slave"" (P 252[0] - MPRO_ECAM_Egear_GearNum) is the numerator
- ""Master"" (P 251[0] - MPRO_ECAM_Egear_GearDen) is the denominator

# Scaling of speed pre-control

Defined with P 265[0] - MPRO_ECAM_CamSlave_SpeedFactor definiert.

# Scaling of torque pre-control

Defined with P 266[0] - MPRO_ECAM_CamSlave_TorqueFactor.

# Engagement

See Section ""Engagement"" on page 284.

# Disengagement

See Section ""Disengagement"" on page 285.

|ID|Index Name|Unit|Description|
|---|---|---|---|
|251|0 MPRO_ECAM_Egear_GearDen| |EGEAR: Gear denominator|
|252|0 MPRO_ECAM_Egear_GearNum| |EGEAR: Numerator of gear ratio|
|1344|0 MPRO_ECAM_Egear_LimRefAcc|rpm/s|EGEAR: Acceleration limit for reference|
|1345|0 MPRO_ECAM_Egear_LimRefJerk|rpm/s²|EGEAR: Jerk limit for reference|

Table 8.38: “Synchronized motion - Electronic gearing” parameters

Image 8.73: ""Electronic gearing"" screen

MOOG ID No.:CB40859-001 Date:11/2020 MSD ServoDrive - DeviceHelp 283

# 8 Motion profile

# 8 Motion profile

MOOG ID No.:CB40859-001 Date:11/2020

MSD ServoDrive - DeviceHelp 284

# 8.11.6 Engagement

used to define the engagement distance (between the dashed lines).

P 253[0] - MPRO_ECAM_Egear_GearInMode is used to define the mode for engagement.

- DIRECT (0) = Direct
- Direct engagement: Angular synchronous; with jerking (no ramps).
- CROSSFADE (3) = Crossfading
- Engagement with crossfading function (5th degree polynomial): Angular synchronous; jerk-limited; speed will overshoot during engagement.
- RAMP (1) = Linear speed ramp
- Engagement with linear acceleration: Not angular synchronous; with jerking.
- FADE (2) = Engagement fade-out
- Engagement with fade-in function (5th degree polynomial): Not angular synchronous; jerk-limited. The position is ignored. ",What parameter shows the current active motion task index in the 'MSD ServoDrive - DeviceHelp' document?,A4,P 207[0] parameter indicates the index of the currently active motion task.,2.78125,2.734375,3.546875,1.390625,0.51171875
44,msd_servo_drive.txt,76,b87ca5e232c2bdbb6fa16a8a401c6b5d285dc0183e73cc9d134de13dd2fc71d2,"MOOG ID No.:CB40859-001 Date:11/2020

MSD ServoDrive - DeviceHelp 267

# 8 Motion profile

MOOG ID No.:CB40859-001 Date:11/2020 MSD ServoDrive - DeviceHelp 268

# Deceleration

With ...

- P 194 - MPRO_TAB_TDec (for torque control) or
- P 197 - MPRO_TAB_SDec (for speed control) or
- P 200 - MPRO_TAB_PDec (for position control)

and indexes 0–15, the deceleration for each individual motion task can be defined. The input must not be zero.

# Wait time in Auto mode

P 204 - MPRO_TAB_WaitTime is used to define the wait time before the next motion task is carried out.

# Maximum table index in Auto mode

P 206[0] - MPRO_Tab_MaxIdx is used to define the table index up to which driving jobs will be carried out in one of the auto modes.

# Current table index

P 207[0] - MPRO_Tab_ActIdx will show the index for the motion task that is currently active. If parameter P 205 MPRO_TAB_Mode is set to “Para(0)”, a driving set can be entered and approached directly.

# Activation of reference table

The following procedures can be used in order to activate the setpoint table for operation.

|ID|Index Name|Unit|Description|
|---|---|---|---|
|193|MPRO_TAB_TAcc|TAB: Torque mode acceleration|Nm/ms|
|193|0|MPRO_TAB_TAcc|Nm/ms|
|193|1 - 15|MPRO_TAB_TAcc|Nm/ms|
|194|MPRO_TAB_TDec|TAB: Torque mode deceleration| |
|194|0|MPRO_TAB_TDec|Nm/ms|
|194|1 - 15|MPRO_TAB_TDec|Nm/ms|

# Table 8.23: Activation of table references

# Table 8.24: “Setpoint table settings” parameters

# Table 8.24: “Setpoint table settings” parameters (continue)

|ID|Index Name|Unit|Description|ID|Index Name|Unit|Description|
|---|---|---|---|---|---|---|---|
|195|MPRO_TAB_TRef|Nm|TAB: Torque mode reference value|208|MPRO_TAB_OutputNo| |OSD TAB: actual table index and target|
|195|MPRO_TAB_TRef|Nm| |208|MPRO_TAB_OutputNo| | |
|196|MPRO_TAB_SAcc|rev/min/s|TAB: Speed mode acceleration|269|MPRO_TAB_Ctrl| |TAB: control word|
|196|MPRO_TAB_SAcc|rev/min/s| | | | | |
|197|MPRO_TAB_SDec|rev/min/s|TAB: Speed mode deceleration| | | | |
|197|MPRO_TAB_SDec|rev/min/s| | | | | |
|198|MPRO_TAB_SRef|rev/min|TAB: Speed mode reference value| | | | |
|198|MPRO_TAB_SRef|rev/min| | | | | |
|199|MPRO_TAB_PAcc|rev/min/s|TAB: Position control mode acceleration| | | | |
|199|MPRO_TAB_PAcc|rev/min/s| | | | | |
|200|MPRO_TAB_PDec|rev/min/s|TAB: Position control mode Acceleration| | | | |
|200|MPRO_TAB_PDec|rev/min/s| | | | | |
|201|MPRO_TAB_PSpd|rev/min|TAB: Position control mode speed| | | | |
|201|MPRO_TAB_PSpd|rev/min| | | | | |
|202|MPRO_TAB_PPos|mDegree|TAB: Position control mode reference value| | | | |
|202|MPRO_TAB_PPos|mDegree| | | | | |
|203|MPRO_TAB_PMode| |Position control table:Mode| | | | |
|203|MPRO_TAB_PMode| | | | | | |
|204|MPRO_TAB_WaitTime|ms|TAB: Wait time| | | | |
|204|MPRO_TAB_WaitTime|ms| | | | | |
|205|MPRO_TAB_Mode| |TAB mode| | | | |
|206|MPRO_Tab_MaxIdx| |TAB: Max index in AUTO mode| | | | |
|207|MPRO_TAB_ActIdx| |TAB: Actual index| | | | |

MOOG ID No.:CB40859-001 Date:11/2020

MSD ServoDrive - DeviceHelp

# 8 Motion profile

MOOG ID No.:CB40859-001 Date:11/2020

MSD ServoDrive - DeviceHelp 270

# 8.8 Analog channel (ISA00 und ISA01)

# Offset (O)

This parameter (P 174 - MPRO_ANA0_SOffset for ISA00, P 184 - MPRO_ANA1_SOffset for ISA01) compensates for component variations and is used for offset compensation purposes. Depending on the control mode being used (see Section ""Basic settings"" on page 110), the value will be stored in parameter index [0] (torque control), [1] (speed control) or [2] (position control).

# Backlash (B)

This parameter (P 175 - MPRO_ANA0_SThreshold for ISA00, P 185 - MPRO_ANA1_SThreshold for ISA01) can suppress axis motion close to the standstill (stop) position. Depending on the control mode being used (see Section ""Basic settings"" on page 110), the value will be stored in parameter index [0] (torque control), [1] (speed control) or [2] (position control).

Image 8.68: “Analog channel” screen

# Acceleration ramp

Two standard analog inputs (ISA00, ISA01) are available. These inputs can be configured...

- with negative values for analog setpoint settings
- with positive values for digital setpoint processing

(P 109[0] - MPRO_INPUT_FS_ISA00 and P 110[0] - MPRO_INPUT_FS_ISA01).

see also section ""Analog Inputs"" on page 303. By using the ""REV(-2) = Analog setpoint"" setting, an analog input voltage of ±10 V can be processed as a setpoint.

# Deceleration ramp

This parameter serves as a deceleration ramp for torque control (P 176[1] - MPRO_ANA0_TRamp for ISA00, P 186[1] - MPRO_ANA1_TRamp for ISA01) or speed control (P 177[1] - MPRO_ANA0_SRamp for ISA00, P 187[1] - MPRO_ANA1_SRamp for ISA01). Depending on the control mode being used (see Section ""Basic settings"" on page 110), the value will be stored in parameter index [0] (torque control), [1] (speed control) or [2] (position control).

This parameter (P 173 - MPRO_ANA0_Scale for ISA00, P 183 - MPRO_ANA1_Scale for ISA01) is used to define which speed / which torque / which position corresponds to the maximum analog value. Depending on the control mode being used (see Section ""Basic settings"" on page 110), the value will be stored in parameter index [0] (torque control), [1] (speed control) or [2] (position control).

# 8.8.1 Special characteristics of position control mode

A threshold value can also be specified which generates a run-on range around the last reference value. A ramp function calculates a motion profile for the position reference from pre-defined acceleration and speed limits.

The position references on the analog channel are not applied immediately, but dependent on a digital input. Accordingly, one of the ISD00 to ISD06 digital inputs must be set to a value of ""REFANAEN(28) = Enable analog reference value"" (see Section ""Digital inputs"" on page 290). The position setpoint being received will only be applied if the corresponding digital input is active. The acceleration is entered using P 173[0] - MPRO_ANA0_TScale or P 183[0] - MPRO_ANA1_TScale.

# 8.8.2 Wire Break Monitoring

P 399 - CON_ANAWireBrk_Th can be used to configure wire break monitoring for the analog inputs. For details see Section ""Wire Break Monitoring"" on page 306.

|Function|TLIM (-4)|OVR (-3)|REFV (-2)|leer (-1)|OFF (0)|
|---|---|---|---|---|---|
|Digital|(1)-(28)|(1)-(28)|(1)-(28)|(1)-(28)|(1)-(28)|
|Analog channel|Filter|Scale|Offset|Profile|generator|

Control

Image 8.69: Reference processing structure

MOOG ID No.:CB40859-001 Date:11/2020

MSD ServoDrive - DeviceHelp 271

# 8 Motion profile

# 8 Motion profile

MOOG ID No.:CB40859-001 Date:11/2020

|ID|Index Name|Unit|Description|ID|
|---|---|---|---|---|
|395|CON_ANA_Isaf_Scaled| |Analog inputs: Values (filt, norm, comp, scaled)|174|
|395|0 ISA00| |Scaled, compensated, filtered, normalized value|175|
|395|1 ISA01| |Scaled, compensated, filtered, normalized value| |
|396|CON_ANA_Scale_ThUpper| |Analog inputs: Upper scaling limits|175|
|396|0 ISA00|%|Upper scaling (@ 10 V) threshold|175|
|396|1 ISA01|%|Upper scaling (@ 10 V) threshold| |
|397|CON_ANA_Scale_ThZero| |Analog inputs: Zero scaling thresholds|176|
|397|0 ISA00|V|Zero scaling threshold (+/-)|176|
|397|1 ISA01|V|Zero scaling threshold (+/-)| |
|398|CON_ANA_Scale_ThLower| |Analog inputs: Lower scaling limits|177|
|398|0 ISA00|%|Lower scaling (@ zero threshold) threshold|177|
|398|1 ISA01|%|Lower scaling (@ zero threshold) threshold| |
|399|CON_ANA_WireBrk_Th| |Analog inputs: Wire break thresholds|Table 8.26:|
|399|0 ISA00|V|Wire break detection threshold| |
|399|1 ISA01|V|Wire break detection threshold| |
|405|0 CON_ANA_Filt0|ms|Analog input ISA00: Filter time constant (PT 1)|ID|
|408|CON_ANA_Isaf_Norm| |Analog inputs: Values (filt, norm)|183|
|408|0 ISA00| |Filtered, normalized value|183|
|408|1 ISA01| |Filtered, normalized value|183|

Table 8.25: “Analog channel” parameters

|ID|Index Name|Unit|Description|ID|
|---|---|---|---|---|
|173|MPRO_ANA0_Scale| |ANA0: scale factors|184|
|173|0 MPRO_ANA0_TScale|Nm|ANA0: scale factor torque reference|185|
|173|1 MPRO_ANA0_SScale|rev/min|ANA0: scale factor speed reference|185|
|173|2 MPRO_ANA0_PScale|mDegree|ANA0: scale factor position reference| |
|174|MPRO_ANA0_Offset| |ANA0: offsets|185|
|174|0 MPRO_ANA0_TOffset|Nm|ANA0: offsets for torque reference|185|

Table 8.26: “Analog channel ISA00” parameters

|Index Name|Unit|Description|
|---|---|---|
|1 MPRO_ANA0_SOffset|rev/min|ANA0: offsets for speed reference|
|2 MPRO_ANA0_POffset|mDegree|ANA0: offsets for position reference|
|MPRO_ANA0_Threshold| |ANA0: thresholds|
|0 MPRO_ANA0_TThreshold|Nm|ANA0: threshold for torque reference|
|1 MPRO_ANA0_SThreshold|rev/min|ANA0: threshold for speed reference|
|2 MPRO_ANA0_PThreshold|mDegree|ANA0: threshold for position reference|
|MPRO_ANA0_TRamp| |ANA0: Torque mode acceleration [0] and deceleration [1]|
|0 MPRO_ANA0_TRamp|Nm/s| |
|1 MPRO_ANA0_TRamp|Nm/s| |
|MPRO_ANA0_SRamp| |ANA0: Speed mode acceleration [0] and deceleration [1]|
|0 MPRO_ANA0_SRamp|SPEED/s| |
|1 MPRO_ANA0_SRamp|SPEED/s| |

“Analog channel ISA00” parameters (continue)

|Index Name|Unit|Description|
|---|---|---|
|MPRO_ANA1_Scale| |ANA1: scale factors|
|0 MPRO_ANA1_TScale|Nm|ANA0: scale factor torque reference|
|1 MPRO_ANA1_SScale|rev/min|ANA0: scale factor speed reference|
|2 MPRO_ANA1_PScale|mDegree|ANA0: scale factor position reference|
|MPRO_ANA1_Offset| |ANA1: offsets|
|0 MPRO_ANA1_TOffset|Nm|ANA1: offsets for torque reference|
|1 MPRO_ANA1_SOffset|rev/min|ANA1: offsets for speed reference|
|2 MPRO_ANA1_POffset|mDegree|ANA1: offsets for position reference|
|MPRO_ANA1_Threshold| |ANA1: thresholds|
|0 MPRO_ANA1_TThreshold|Nm|ANA1: threshold for torque reference|
|1 MPRO_ANA1_SThreshold|rev/min|ANA1: threshold for speed reference|
|2 MPRO_ANA1_PThreshold|mDegree|ANA1: threshold for position reference|

“Analog channel ISA01” parameters

# 8 Motion profile

|ID|Index Name|Unit|Description|
|---|---|---|---|
|186|MPRO_ANA1_TRamp|Nm/s|ANA1: Torque mode acceleration [0] and deceleration[1]|
|186|MPRO_ANA1_TRamp|Nm/s| |
|187|MPRO_ANA1_SRamp|SPEED/s|ANA1: Speed mode acceleration [0] and deceleration [1]|
|187|MPRO_ANA1_SRamp|SPEED/s| |

# Table 8.27: “Analog channel ISA01” parameters (continue)

Display

- System state
- Initialization on device startup
- Not ready (DC link voltage possibly too low)
- Start inhibit (DC link voltage present, power stage off)
- Starting lockout
- Ready for start
- Control initialization: Auto commutation, flux build-up etc.

# Table 8.28: Central state machine according to CiA 402 device display

MOOG ID No.:CB40859-001 Date:11/2020

MSD ServoDrive - DeviceHelp 273

# 8 Motion profile

MOOG ID No.:CB40859-001 Date:11/2020

MSD ServoDrive - DeviceHelp 274

|Display|System state|power disabled|fault|
|---|---|---|---|
|Control enabled|0|Start|7|
| |fault reaction active|0|14|
|Quick stop active|1|not ready|8|
| |to switch on|1|17|
|Error reaction active|2|switch on|disabled|
| |2|7| |
|Error state (in this state the error is indicated directly on the display.)|3|ready to|switch on|
|Device is reset (display flashes)|power enabled|3|6|
| |10|12| |
|• Number [5.] flashes when “STO” (Safe Torque Off) input is active. Display goes out when STO inactive.| | | |
|• The dot on the display flashes when the power stage is active.| | | |

Table 8.28: Central state machine according to CiA 402 device display (continue)

NOTE

l The system states indicated on the display may differ from the states in the table depending on the drive profile setting.

Image 8.70: State machine diagram based on CANopen communications

⓪ to ① State number

1 to 17 State transition (No. 17: DC link voltage cut off)

Legend for “State machine diagram based on CANopen communications” figure

# 8.10 Touch probe

|ID|Index Name / Setting|
|---|---|
|241|0 MPRO_TP_Position|
|241|1 MPRO_TP_Position|
|241|2 MPRO_TP_Position|
|241|3 MPRO_TP_Position|
|241|4 MPRO_TP_Position|
|1400|0 MPRO_TP_Config|
| |TP_TP (0)|
| |AB (1)|
| |PD_UP (2)|
| |PD_DOWN (3)|
| |PC_PC (4)|
| |PC_TP (5)|
| |TP_PC (6)|
| |ENC_ENC (7)|
| |ENC_TP (8)|
| |TP_ENC (9)|

Using the touch probe inputs, touch probe functions can be performed. In order to be able to do this, P 106[0] - MPRO_INPUT_FS_ISD05 and P 107[0] - MPRO_INPUT_FS_ISD06 must be used to set digital inputs ISD05 and ISD06 to ""PROBE(15) = Touch probe (only ISD05/06)"" (see Section ""Digital inputs"" on page 290). HTL encoders can be evaluated or pulse counters implemented using the MSD PLC.

The touch probe can be triggered with P 240 - MPRO_TP_Ctrl. This enables triggering on a positive or negative edge, or on both edges, of the signal detected on the touch probe inputs. After the measurement, the parameter jumps back to the value ""NONE (0)"" and the latch position is mapped in the corresponding subindex of parameter P 241 - MPRO_TP_Position. A continuous touch probe mode is not possible at present, so the touch probe has to be reactivated after the measurement.

P 1402 - MPRO_TP_Channel can be used to select various positions as actual value sources of the latch position for the touch probe functionality. The following table provides an overview of the available settings. The counters are accessed via the MSD PLC or a bus system.

|ID|Index Name / Setting|Unit|Description|
|---|---|---|---|
|240|MPRO_TP_Ctrl|Touch probe: Control| |
| |0| |NONE (0) = No function|
| |1| |POS (1) = Positive edge|
| |2| |NEG (2) = Negative edge|
| |3| |BOTH (3) = Both edges|
|240|0 MPRO_TP_Ctrl| | |
|240|1 MPRO_TP_Ctrl| | |
|240|2 MPRO_TP_Ctrl| | |
|241|MPRO_TP_Position|Probe: Pos. high/low edge of TP0/1, encoder zero pulse| |

Table 8.29: “Touch probe” parameters

MOOG ID No.:CB40859-001 Date:11/2020

# 8 Motion profile

|Unit|Description|
|---|---|
|mDegree|Touch probe: Configuration|
|mDegree|TP0, TP1 touch probe|
|mDegree|TP0, TP1 as encoder, A/B as quadrature counting|
|mDegree|TP0, TP1 as encoder, pulse (TP0) / direction (TP1), count up on direction high|
|mDegree|TP0, TP1 as encoder, pulse (TP0) / direction (TP1), count down on direction high|
|mDegree|TP0 pulse counter, TP1 pulse counter|
|mDegree|TP0 pulse counter, TP1 touch probe|
|mDegree|TP1 touch probe, TP0 pulse counter|
|mDegree|TP0 encoder counter, TP1 encoder counter|
|mDegree|TP0 encoder counter, TP1 touch probe|
|mDegree|TP0 touch probe, TP1 encoder counter|

Touch probe: Channel

|Unit|Description|
|---|---|
|ACTPOS (0)|Actual position in user units|
|ACTPOSINC (1)|Actual position in increments|
|MASTERPOS (2)|Master position in increments|
|ENCPOS_CH1 (3)|Encoder position Channel 1|
|ENCPOS_CH1_INC (4)|Encoder position Channel 1 in increments|
|ENCPOS_CH2 (5)|Encoder position Channel 2|
|ENCPOS_CH2_INC (6)|Encoder position Channel 2 in increments|

# 8 Motion profile

MOOG ID No.:CB40859-001 Date:11/2020 MSD ServoDrive - DeviceHelp 276

|ID|Index Name / Setting|Unit|Description|
|---|---|---|---|
|7|ENCPOS_CH3 (7)| |Encoder position Channel 3|
|8|ENCPOS_CH3_INC (8)| |Encoder position Channel 3 in increments|
|9|ENCPOS_CH4 (9)| |Encoder position Channel 4|
|10|ENCPOS_CH4_INC (10)| |Encoder position Channel 4 in increments|
|11|ACTPOS2 (11)| |Actual position of redundant encoder in user units|
|12|Sercos (12)| |Referred to Sercos profile parameters S-x-0426, S-x-0427|
|13|UserRefPos(13)| |Reference position in user units|
|14|MasterPosST(14)| |Master position (ECAM, EGEAR) singleturn, always steps|
|15|CommonMasterPos(15)| |Master position (ECAM, EGEAR) singleturn, always steps|
|16|CommonMasterPosST(15)| |Master position (ECAM, EGEAR) singleturn, always steps|
|1402|MPRO_TP_Channel| | |
|1402|MPRO_TP_Channel| | |
|1402|MPRO_TP_Channel| | |
|1404|MPRO_TP_Lines| |Touch probe: Lines @ pulse counter on channel x|
|1404|MPRO_TP_Lines| | |
|1404|MPRO_TP_Lines| | |

Image 8.71: “Synchronized motion” screen

There are various modes available in the “synchronization mode” drop-down menu (P 242[0] - MPRO_ECAM_SyncModMode):

- Off(0) = Synchronized motion off
- ECAM_iPlc(1) = Electronic cam plate via MSD PLC
- EGEAR_iPlc(2) = Electr. gear unit via MSD PLC
- ECAM_PARA(3) = Electronic camming via parameters
- EGEAR_PARA(4) = Electronic gearing via parameters

NOTE: For more information refer to the bus system User Manuals or the description of the MSD PLC.

# 8.11.1 Electronic cam plate

The other parameters are configured in separate screens that can be accessed with the corresponding buttons.

- Master configuration (see Section ""Master configuration"" on page 280)
- Electronic gearing (see Section ""Electronic gearing"" on page 283)
- Electronic camming (see Section ""Electronic cam plate"" on page 277)

P 1318[0] - MPRO_ECAM_ControlWord is the control word for “synchronized motion” (see Section ""Control word for synchronized motion"" on page 279).

P 1326[0] - MPRO_ECAM_StatusWord is the status word for “synchronized motion” (see Section ""Status word for synchronized motion"" on page 279).

# 8.11.1.1 Table selection

|ID|Index Name|Unit|Description|
|---|---|---|---|
|1300|MPRO_ECAM_CTS_| |ECAM: CamTableSelect - Master reference|
|1301|MasterRef| | |
|1305|MPRO_ECAM_CTS_| |ECAM: CamTableSelect - Method for changing the camtable|
|1306|MPRO_ECAM_CTS_| |ECAM: CamTableSelect - Mode for changing the camtable|
|1307|MPRO_ECAM_CTS_|incr|ECAM: CamTableSelect - Distance for changing the camtable|
|242|MPRO_ECAM_| |ECAM / EGEAR: Mode of synchronized motion SyncModMode|
|265|MPRO_ECAM_| |ECAM / EGEAR: Slave speed factor (1 = 100%).|
|266|CamSlave_SpeedFactor| | |
|268|MPRO_ECAM_| |ECAM / EGEAR: Mode of switching off sync. motion|

# 8.11.1.2 Synchronization

|ID|Index Name|Unit|Description|
|---|---|---|---|
|1342|MPRO_ECAM_CI_|incr|ECAM: CamIn - Synchronization position (multiturn part)|
|1343|MPRO_ECAM_CO_|incr|ECAM: CamOut - Decoupling pos. (multiturn part)|
|1303|MPRO_ECAM_CI_|incr|ECAM: CamIn - Master offset|
|1308|MPRO_ECAM_CI_| |ECAM: CamIn - Master reference|
|1309|MPRO_ECAM_CI_| |ECAM: CamIn - Slave reference|
|1310|MPRO_ECAM_CI_| |ECAM: CamIn - Coupling mode|
|1311|MPRO_ECAM_CI_|incr|ECAM: CamIn - Coupling distance|
|1312|MPRO_ECAM_CI_|incr|ECAM: CamIn - Synchronization position|

Table 8.31: “Electronic camming - Table selection” parameters

Table 8.30: “Synchronized motion” parameters

Table 8.32: “Electronic camming - Synchronization” parameters

MOOG ID No.:CB40859-001 Date:11/2020

MSD ServoDrive - DeviceHelp 277

# 8 Motion profile

MOOG ID No.:CB40859-001 Date:11/2020 MSD ServoDrive - DeviceHelp 278

|ID|Index|Name|Unit|Description|
|---|---|---|---|---|
|1313|0|MPRO_ECAM_CO_SyncPosST|(singleturn part)|ECAM: CamOut - Slave reference|
|1314|0|MPRO_ECAM_CO_DecouplingMode|63|ECAM: CamOut - Decoupling mode|
|1315|0|MPRO_ECAM_CO_BreakingPosST|incr|ECAM: CamOut - Decoupling position|
|1316|0|MPRO_ECAM_CO_DecouplingDist|incr|ECAM: CamOut - Decoupling distance|
|1317|0|MPRO_ECAM_CO_StandstillPos|mDegree|ECAM: CamOut - Slave standstill position|

# Table 8.32: “Electronic camming - Synchronization” parameters (continue)

|ID|Index|Name|Unit|Description|
|---|---|---|---|---|
|1346| |MPRO_ECAM_SP_Table| |ECAM: Setpoint table interface|
|1346|0|Index| |Index of setpoint table|
|1346|1|Value| |Value at index of setpoint table|
|1347|0 to 31|MPRO_ECAM_SP_Index| |ECAM: Setpoint segments start index|
|1348|0 to 31|MPRO_ECAM_SP_Length| |ECAM: Setpoint segments length|
|1349|0 to 31|Length| | |
|1350|0|MPRO_ECAM_SP_MaDist| |ECAM: Setpoint segments master distance|
|1351|0|MPRO_ECAM_SP_IpoType| |ECAM: Setpoint segments interpolation type|
|1352|0 to 31|Checksum| |ECAM: Setpoint table checksum|
|1353|0 to 31|GainNum| |ECAM: Setpoint segments gain numerator|
| | |GainDen| |ECAM: Setpoint segments gain denominator|

# Table 8.33: “Electronic camming - Table segments” parameters

|ID|Index|Name|Unit|Description|
|---|---|---|---|---|
|1329|0 to 63|MPRO_ECAM_SegData_IndexNext| |ECAM: Index of the following segment|
|1330|0 to 63|MPRO_ECAM_SegData_IndexPrev| |ECAM: Index of the previous segment|
|1331|0 to 63|MPRO_ECAM_SegData_ProfileMode| |ECAM: Profile mode of the current segment|
|1332|0 to 63|MPRO_ECAM_SegData_DistMaster| |ECAM: Length of the master section of the current segment|
|1333|0 to 63|MPRO_ECAM_SegData_DistSlave| |ECAM: Length of the slave section of the current segment|
|1334|0 to 63|MPRO_ECAM_SegData_Lambda| |ECAM: Lambda value of the current segment|
|1335|0 to 63|MPRO_ECAM_SegData_StatusWord| |ECAM: Status word of the current segment|
|1336|0 to 63|MPRO_ECAM_SegData_ControlWord| |ECAM: Control word of the current segment|

# 8.11.2 Control word for synchronized motion

|Bit|Function|PLC function|Bit number|Description|
|---|---|---|---|---|
|0-7|Start segment (8-bit value)|-|0-7|Actual segment (8-bit value)|
|8-15|Reserved|-| |Actual ECAM / EGEAR state machine state (4 Bit value)|
|16|Absolute (true) / relative (false) master relationship|-| |- 0: ECAM / EGEAR asynchronous
- 1: ECAM / EGEAR synchronous
|
|17|Absolute (true) / relative (false) master (CAM) relationship at cam in|-| |- 2: ECAM / EGEAR synchronizing
- 3: ECAM / EGEAR desynchronizing
|
|18|Absolute (true) / relative (false) slave (CAM) relationship at cam in|-| |- 4: ECAM / EGEAR active and waiting for going asynchronous
|
|19-23|Reserved|-| |- 5: ECAM / EGEAR inactive and waiting for going synchronous
|
|24|Change gear ratio of the electronic gear online|MCB_GearRatioChange| | |
|25|Disable master calculation|MCB_Cam_MasterEnable| | |
|26|Enable master calculation|MCB_Cam_MasterEnable| | |
|27|Select CAM table|MCB_CamTableSelect| | |
|28|Start Ecam|MCB_CamIn| | |
|29|Stop Ecam|MCB_CamOut| | |
|30|Start Egear|MCB_GearIn| | |
|31|Stop Egear|MCB_GearOut| | |

# 8.11.3 Status word for synchronized motion

|Bit|Function|PLC function|Bit number|Description|
|---|---|---|---|---|
|12-26|Reserved|-| | |
|27|ECAM / EGEAR is active|-| | |
|28|Valid segments chosen|-| | |
|29|Master data are valid|-| | |
|30|Master is initialized|-| | |
|31|Master calculation is active|-| | |

Table 8.35: Control word ECAM (P 1318[0] - MPRO_ECAM_ControlWord)

Table 8.36: ECAM status word (P 1326[0] - MPRO_ECAM_StatusWord)

MOOG ID No.:CB40859-001 Date:11/2020 MSD ServoDrive - DeviceHelp 279

# 8 Motion profile

# 8 Motion profile

MOOG ID No.:CB40859-001 Date:11/2020

MSD ServoDrive - DeviceHelp 280

# 8.11.4 Master configuration

the master encoder, you will need to set the resolution relative to a single motor revolution in P 250 - MPRO_ECAM_PARAMaster_Amplitude (see below).

- ENC CH1 (3) = Encoder channel 1 X7 (Sin/Cos)
- ENC CH2 (4) = Encoder channel 2 X6 (Resolver)
- ENC CH3 (5) = Encoder channel 3 X8 (optional)

This function is only available if an external interface X8 (option module) is present.

- TP0 (6) = Pulse counter on probe channel 0 (TP0)
- TP1 (7) = Pulse counter on probe channel 1 (TP1)
- ENC_CH4 (8) = Encoder channel 4 (p. e. fieldbus)
- TWIN_POS (9) = TWIN remote reference position (P-2607)

Image 8.72: “Master configuration” screen

# Channel selection (master encoder)

P 1319[0] - MPRO_ECAM_CamMaster_AxisType is used to define the master encoder.

- NO AXIS (0) = No axis
- VIRTUAL MASTER (1) = Virtual master

If you select this function, you will be able to configure additional settings by clicking on the enabled “Options...” button (see Section ""Virtual Master"" on page 286).

- PARA (2) = Master parameter interface

If you select this function because a higher-level controller is being used as

# Anti-reverse mode

Slave only starts moving along with it again as soon as the master reaches the zero position.

P 1320[0] - MPRO_ECAM_CamMaster_RevLockMode is used to define the reverse lock mode, which can be used either with or without path compensation. The dashed lines in the following diagrams indicate what the engagement distance is:

# Example:

If the master, which has moved two motor revolutions in the direction blocked for the slave, then moves in the unblocked direction again, the slave only moves off when the master has traversed the zero point.

- INACTIVE (0) = Reverse lock inactive
- ACTIVE (2) = Reverse lock enabled - without path optimization
- ACTIVE WAY COMP (1) = Reverse lock active - with way compensation

While the slave accelerates to the speed of the master during engagement, the master and slave do not move synchronously. This function needs to be selected in order to quickly catch up to the master that is running ahead.

# Example:

- Master (black line) rotates in the blocked direction
- The slave (blue line) remains stopped
- Master rotates in the unblocked direction again
- The slave follows the master directly in the unblocked direction

Assume the master has moved two motor revolutions in the direction for which the slave lock is enabled. If the master now moves in the direction for which there is no lock, the slave will immediately start running in that direction.

MOOG ID No.:CB40859-001 Date:11/2020

MSD ServoDrive - DeviceHelp 281

# 8 Motion profile

MOOG ID No.:CB40859-001 Date:11/2020 MSD ServoDrive - DeviceHelp 282

|Filter type|ID|Index Name|Unit|Description|
|---|---|---|---|---|
|When using a real master encoder, encoder signals may be subject to noise.|P 1340|1319|0|MPRO_ECAM_CamMaster_AxisType|
| | |MPRO_ECAM_CamMaster_SpeedFilTyp| |ECAM / EGEAR: Channel selection of internal master input|
| | |1320|0|MPRO_ECAM_CamMaster_RevLockMode|
| | |1321|0|MPRO_ECAM_CamMaster_Amplitude|
| | |1322|0|MPRO_ECAM_CamMaster_GearNum|
| | |1323|0|MPRO_ECAM_CamMaster_GearDen|
|Filter time|1327|0|ms|ECAM / EGEAR: Filter time constant of master|
|If P 1340[0] is used to enable a filter, P 1327[0] - MPRO_ECAM_CamMaster_SpeedTFil can be used to define the corresponding filter time.|1328|0|speed|ECAM / EGEAR: Speed factor of the internal master|
|Speed factor|1340|0| |MPRO_ECAM_CamMaster_SpeedFilTyp|
|The master encoder can be assigned an additional speed factor P 1328[0] - MPRO_ECAM_CamMaster_SpeedFactor.|1341|0|incr|ECAM / EGEAR: Master drive offset|

Table 8.37: “Synchronized motion - Master configuration” parameters (continue)

| | | |ID|Index Name|Unit|Description|
|---|---|---|---|---|---|---|
|247|0|MPRO_ECAM_ParaMaster_ActPos|incr|ECAM / EGEAR: Parameter interface master position| | |
|248|0|MPRO_ECAM_ParaMaster_ActSpeed|rpm|ECAM / EGEAR: Parameter interface master speed| | |
|249|0|MPRO_ECAM_ParaMaster_ActAcc|rpm|ECAM / EGEAR: Parameter interface master acceleration| | |
| |250|0|MPRO_ECAM_ParaMaster_Amplitude| |ECAM / EGEAR: Parameter interface master amplitude| |

Table 8.37: “Synchronized motion - Master configuration” parameters

# 8.11.5 Electronic gearing

# Gear ratio

The gear ratio is specified as a fraction. This ensures that the position references can be translated to the motor shaft with no rounding error.

- ""Slave"" (P 252[0] - MPRO_ECAM_Egear_GearNum) is the numerator
- ""Master"" (P 251[0] - MPRO_ECAM_Egear_GearDen) is the denominator

# Scaling of speed pre-control

Defined with P 265[0] - MPRO_ECAM_CamSlave_SpeedFactor definiert.

# Scaling of torque pre-control

Defined with P 266[0] - MPRO_ECAM_CamSlave_TorqueFactor.

# Engagement

See Section ""Engagement"" on page 284.

# Disengagement

See Section ""Disengagement"" on page 285.

|ID|Index Name|Unit|Description|
|---|---|---|---|
|251|0 MPRO_ECAM_Egear_GearDen| |EGEAR: Gear denominator|
|252|0 MPRO_ECAM_Egear_GearNum| |EGEAR: Numerator of gear ratio|
|1344|0 MPRO_ECAM_Egear_LimRefAcc|rpm/s|EGEAR: Acceleration limit for reference|
|1345|0 MPRO_ECAM_Egear_LimRefJerk|rpm/s²|EGEAR: Jerk limit for reference|

Table 8.38: “Synchronized motion - Electronic gearing” parameters

Image 8.73: ""Electronic gearing"" screen

MOOG ID No.:CB40859-001 Date:11/2020 MSD ServoDrive - DeviceHelp 283

# 8 Motion profile

# 8 Motion profile

MOOG ID No.:CB40859-001 Date:11/2020

MSD ServoDrive - DeviceHelp 284

# 8.11.6 Engagement

used to define the engagement distance (between the dashed lines).

P 253[0] - MPRO_ECAM_Egear_GearInMode is used to define the mode for engagement.

- DIRECT (0) = Direct
- Direct engagement: Angular synchronous; with jerking (no ramps).
- CROSSFADE (3) = Crossfading
- Engagement with crossfading function (5th degree polynomial): Angular synchronous; jerk-limited; speed will overshoot during engagement.
- RAMP (1) = Linear speed ramp
- Engagement with linear acceleration: Not angular synchronous; with jerking.
- FADE (2) = Engagement fade-out
- Engagement with fade-in function (5th degree polynomial): Not angular synchronous; jerk-limited. The position is ignored. ",What parameter shows the current active motion task index in the 'MSD ServoDrive - DeviceHelp' document?,A5,Current motion task index is visible in P 207[0] in the document.,1.8828125,1.8359375,3.578125,1.046875,0.45703125
45,msd_servo_drive.txt,76,b87ca5e232c2bdbb6fa16a8a401c6b5d285dc0183e73cc9d134de13dd2fc71d2,"MOOG ID No.:CB40859-001 Date:11/2020

MSD ServoDrive - DeviceHelp 267

# 8 Motion profile

MOOG ID No.:CB40859-001 Date:11/2020 MSD ServoDrive - DeviceHelp 268

# Deceleration

With ...

- P 194 - MPRO_TAB_TDec (for torque control) or
- P 197 - MPRO_TAB_SDec (for speed control) or
- P 200 - MPRO_TAB_PDec (for position control)

and indexes 0–15, the deceleration for each individual motion task can be defined. The input must not be zero.

# Wait time in Auto mode

P 204 - MPRO_TAB_WaitTime is used to define the wait time before the next motion task is carried out.

# Maximum table index in Auto mode

P 206[0] - MPRO_Tab_MaxIdx is used to define the table index up to which driving jobs will be carried out in one of the auto modes.

# Current table index

P 207[0] - MPRO_Tab_ActIdx will show the index for the motion task that is currently active. If parameter P 205 MPRO_TAB_Mode is set to “Para(0)”, a driving set can be entered and approached directly.

# Activation of reference table

The following procedures can be used in order to activate the setpoint table for operation.

|ID|Index Name|Unit|Description|
|---|---|---|---|
|193|MPRO_TAB_TAcc|TAB: Torque mode acceleration|Nm/ms|
|193|0|MPRO_TAB_TAcc|Nm/ms|
|193|1 - 15|MPRO_TAB_TAcc|Nm/ms|
|194|MPRO_TAB_TDec|TAB: Torque mode deceleration| |
|194|0|MPRO_TAB_TDec|Nm/ms|
|194|1 - 15|MPRO_TAB_TDec|Nm/ms|

# Table 8.23: Activation of table references

# Table 8.24: “Setpoint table settings” parameters

# Table 8.24: “Setpoint table settings” parameters (continue)

|ID|Index Name|Unit|Description|ID|Index Name|Unit|Description|
|---|---|---|---|---|---|---|---|
|195|MPRO_TAB_TRef|Nm|TAB: Torque mode reference value|208|MPRO_TAB_OutputNo| |OSD TAB: actual table index and target|
|195|MPRO_TAB_TRef|Nm| |208|MPRO_TAB_OutputNo| | |
|196|MPRO_TAB_SAcc|rev/min/s|TAB: Speed mode acceleration|269|MPRO_TAB_Ctrl| |TAB: control word|
|196|MPRO_TAB_SAcc|rev/min/s| | | | | |
|197|MPRO_TAB_SDec|rev/min/s|TAB: Speed mode deceleration| | | | |
|197|MPRO_TAB_SDec|rev/min/s| | | | | |
|198|MPRO_TAB_SRef|rev/min|TAB: Speed mode reference value| | | | |
|198|MPRO_TAB_SRef|rev/min| | | | | |
|199|MPRO_TAB_PAcc|rev/min/s|TAB: Position control mode acceleration| | | | |
|199|MPRO_TAB_PAcc|rev/min/s| | | | | |
|200|MPRO_TAB_PDec|rev/min/s|TAB: Position control mode Acceleration| | | | |
|200|MPRO_TAB_PDec|rev/min/s| | | | | |
|201|MPRO_TAB_PSpd|rev/min|TAB: Position control mode speed| | | | |
|201|MPRO_TAB_PSpd|rev/min| | | | | |
|202|MPRO_TAB_PPos|mDegree|TAB: Position control mode reference value| | | | |
|202|MPRO_TAB_PPos|mDegree| | | | | |
|203|MPRO_TAB_PMode| |Position control table:Mode| | | | |
|203|MPRO_TAB_PMode| | | | | | |
|204|MPRO_TAB_WaitTime|ms|TAB: Wait time| | | | |
|204|MPRO_TAB_WaitTime|ms| | | | | |
|205|MPRO_TAB_Mode| |TAB mode| | | | |
|206|MPRO_Tab_MaxIdx| |TAB: Max index in AUTO mode| | | | |
|207|MPRO_TAB_ActIdx| |TAB: Actual index| | | | |

MOOG ID No.:CB40859-001 Date:11/2020

MSD ServoDrive - DeviceHelp

# 8 Motion profile

MOOG ID No.:CB40859-001 Date:11/2020

MSD ServoDrive - DeviceHelp 270

# 8.8 Analog channel (ISA00 und ISA01)

# Offset (O)

This parameter (P 174 - MPRO_ANA0_SOffset for ISA00, P 184 - MPRO_ANA1_SOffset for ISA01) compensates for component variations and is used for offset compensation purposes. Depending on the control mode being used (see Section ""Basic settings"" on page 110), the value will be stored in parameter index [0] (torque control), [1] (speed control) or [2] (position control).

# Backlash (B)

This parameter (P 175 - MPRO_ANA0_SThreshold for ISA00, P 185 - MPRO_ANA1_SThreshold for ISA01) can suppress axis motion close to the standstill (stop) position. Depending on the control mode being used (see Section ""Basic settings"" on page 110), the value will be stored in parameter index [0] (torque control), [1] (speed control) or [2] (position control).

Image 8.68: “Analog channel” screen

# Acceleration ramp

Two standard analog inputs (ISA00, ISA01) are available. These inputs can be configured...

- with negative values for analog setpoint settings
- with positive values for digital setpoint processing

(P 109[0] - MPRO_INPUT_FS_ISA00 and P 110[0] - MPRO_INPUT_FS_ISA01).

see also section ""Analog Inputs"" on page 303. By using the ""REV(-2) = Analog setpoint"" setting, an analog input voltage of ±10 V can be processed as a setpoint.

# Deceleration ramp

This parameter serves as a deceleration ramp for torque control (P 176[1] - MPRO_ANA0_TRamp for ISA00, P 186[1] - MPRO_ANA1_TRamp for ISA01) or speed control (P 177[1] - MPRO_ANA0_SRamp for ISA00, P 187[1] - MPRO_ANA1_SRamp for ISA01). Depending on the control mode being used (see Section ""Basic settings"" on page 110), the value will be stored in parameter index [0] (torque control), [1] (speed control) or [2] (position control).

This parameter (P 173 - MPRO_ANA0_Scale for ISA00, P 183 - MPRO_ANA1_Scale for ISA01) is used to define which speed / which torque / which position corresponds to the maximum analog value. Depending on the control mode being used (see Section ""Basic settings"" on page 110), the value will be stored in parameter index [0] (torque control), [1] (speed control) or [2] (position control).

# 8.8.1 Special characteristics of position control mode

A threshold value can also be specified which generates a run-on range around the last reference value. A ramp function calculates a motion profile for the position reference from pre-defined acceleration and speed limits.

The position references on the analog channel are not applied immediately, but dependent on a digital input. Accordingly, one of the ISD00 to ISD06 digital inputs must be set to a value of ""REFANAEN(28) = Enable analog reference value"" (see Section ""Digital inputs"" on page 290). The position setpoint being received will only be applied if the corresponding digital input is active. The acceleration is entered using P 173[0] - MPRO_ANA0_TScale or P 183[0] - MPRO_ANA1_TScale.

# 8.8.2 Wire Break Monitoring

P 399 - CON_ANAWireBrk_Th can be used to configure wire break monitoring for the analog inputs. For details see Section ""Wire Break Monitoring"" on page 306.

|Function|TLIM (-4)|OVR (-3)|REFV (-2)|leer (-1)|OFF (0)|
|---|---|---|---|---|---|
|Digital|(1)-(28)|(1)-(28)|(1)-(28)|(1)-(28)|(1)-(28)|
|Analog channel|Filter|Scale|Offset|Profile|generator|

Control

Image 8.69: Reference processing structure

MOOG ID No.:CB40859-001 Date:11/2020

MSD ServoDrive - DeviceHelp 271

# 8 Motion profile

# 8 Motion profile

MOOG ID No.:CB40859-001 Date:11/2020

|ID|Index Name|Unit|Description|ID|
|---|---|---|---|---|
|395|CON_ANA_Isaf_Scaled| |Analog inputs: Values (filt, norm, comp, scaled)|174|
|395|0 ISA00| |Scaled, compensated, filtered, normalized value|175|
|395|1 ISA01| |Scaled, compensated, filtered, normalized value| |
|396|CON_ANA_Scale_ThUpper| |Analog inputs: Upper scaling limits|175|
|396|0 ISA00|%|Upper scaling (@ 10 V) threshold|175|
|396|1 ISA01|%|Upper scaling (@ 10 V) threshold| |
|397|CON_ANA_Scale_ThZero| |Analog inputs: Zero scaling thresholds|176|
|397|0 ISA00|V|Zero scaling threshold (+/-)|176|
|397|1 ISA01|V|Zero scaling threshold (+/-)| |
|398|CON_ANA_Scale_ThLower| |Analog inputs: Lower scaling limits|177|
|398|0 ISA00|%|Lower scaling (@ zero threshold) threshold|177|
|398|1 ISA01|%|Lower scaling (@ zero threshold) threshold| |
|399|CON_ANA_WireBrk_Th| |Analog inputs: Wire break thresholds|Table 8.26:|
|399|0 ISA00|V|Wire break detection threshold| |
|399|1 ISA01|V|Wire break detection threshold| |
|405|0 CON_ANA_Filt0|ms|Analog input ISA00: Filter time constant (PT 1)|ID|
|408|CON_ANA_Isaf_Norm| |Analog inputs: Values (filt, norm)|183|
|408|0 ISA00| |Filtered, normalized value|183|
|408|1 ISA01| |Filtered, normalized value|183|

Table 8.25: “Analog channel” parameters

|ID|Index Name|Unit|Description|ID|
|---|---|---|---|---|
|173|MPRO_ANA0_Scale| |ANA0: scale factors|184|
|173|0 MPRO_ANA0_TScale|Nm|ANA0: scale factor torque reference|185|
|173|1 MPRO_ANA0_SScale|rev/min|ANA0: scale factor speed reference|185|
|173|2 MPRO_ANA0_PScale|mDegree|ANA0: scale factor position reference| |
|174|MPRO_ANA0_Offset| |ANA0: offsets|185|
|174|0 MPRO_ANA0_TOffset|Nm|ANA0: offsets for torque reference|185|

Table 8.26: “Analog channel ISA00” parameters

|Index Name|Unit|Description|
|---|---|---|
|1 MPRO_ANA0_SOffset|rev/min|ANA0: offsets for speed reference|
|2 MPRO_ANA0_POffset|mDegree|ANA0: offsets for position reference|
|MPRO_ANA0_Threshold| |ANA0: thresholds|
|0 MPRO_ANA0_TThreshold|Nm|ANA0: threshold for torque reference|
|1 MPRO_ANA0_SThreshold|rev/min|ANA0: threshold for speed reference|
|2 MPRO_ANA0_PThreshold|mDegree|ANA0: threshold for position reference|
|MPRO_ANA0_TRamp| |ANA0: Torque mode acceleration [0] and deceleration [1]|
|0 MPRO_ANA0_TRamp|Nm/s| |
|1 MPRO_ANA0_TRamp|Nm/s| |
|MPRO_ANA0_SRamp| |ANA0: Speed mode acceleration [0] and deceleration [1]|
|0 MPRO_ANA0_SRamp|SPEED/s| |
|1 MPRO_ANA0_SRamp|SPEED/s| |

“Analog channel ISA00” parameters (continue)

|Index Name|Unit|Description|
|---|---|---|
|MPRO_ANA1_Scale| |ANA1: scale factors|
|0 MPRO_ANA1_TScale|Nm|ANA0: scale factor torque reference|
|1 MPRO_ANA1_SScale|rev/min|ANA0: scale factor speed reference|
|2 MPRO_ANA1_PScale|mDegree|ANA0: scale factor position reference|
|MPRO_ANA1_Offset| |ANA1: offsets|
|0 MPRO_ANA1_TOffset|Nm|ANA1: offsets for torque reference|
|1 MPRO_ANA1_SOffset|rev/min|ANA1: offsets for speed reference|
|2 MPRO_ANA1_POffset|mDegree|ANA1: offsets for position reference|
|MPRO_ANA1_Threshold| |ANA1: thresholds|
|0 MPRO_ANA1_TThreshold|Nm|ANA1: threshold for torque reference|
|1 MPRO_ANA1_SThreshold|rev/min|ANA1: threshold for speed reference|
|2 MPRO_ANA1_PThreshold|mDegree|ANA1: threshold for position reference|

“Analog channel ISA01” parameters

# 8 Motion profile

|ID|Index Name|Unit|Description|
|---|---|---|---|
|186|MPRO_ANA1_TRamp|Nm/s|ANA1: Torque mode acceleration [0] and deceleration[1]|
|186|MPRO_ANA1_TRamp|Nm/s| |
|187|MPRO_ANA1_SRamp|SPEED/s|ANA1: Speed mode acceleration [0] and deceleration [1]|
|187|MPRO_ANA1_SRamp|SPEED/s| |

# Table 8.27: “Analog channel ISA01” parameters (continue)

Display

- System state
- Initialization on device startup
- Not ready (DC link voltage possibly too low)
- Start inhibit (DC link voltage present, power stage off)
- Starting lockout
- Ready for start
- Control initialization: Auto commutation, flux build-up etc.

# Table 8.28: Central state machine according to CiA 402 device display

MOOG ID No.:CB40859-001 Date:11/2020

MSD ServoDrive - DeviceHelp 273

# 8 Motion profile

MOOG ID No.:CB40859-001 Date:11/2020

MSD ServoDrive - DeviceHelp 274

|Display|System state|power disabled|fault|
|---|---|---|---|
|Control enabled|0|Start|7|
| |fault reaction active|0|14|
|Quick stop active|1|not ready|8|
| |to switch on|1|17|
|Error reaction active|2|switch on|disabled|
| |2|7| |
|Error state (in this state the error is indicated directly on the display.)|3|ready to|switch on|
|Device is reset (display flashes)|power enabled|3|6|
| |10|12| |
|• Number [5.] flashes when “STO” (Safe Torque Off) input is active. Display goes out when STO inactive.| | | |
|• The dot on the display flashes when the power stage is active.| | | |

Table 8.28: Central state machine according to CiA 402 device display (continue)

NOTE

l The system states indicated on the display may differ from the states in the table depending on the drive profile setting.

Image 8.70: State machine diagram based on CANopen communications

⓪ to ① State number

1 to 17 State transition (No. 17: DC link voltage cut off)

Legend for “State machine diagram based on CANopen communications” figure

# 8.10 Touch probe

|ID|Index Name / Setting|
|---|---|
|241|0 MPRO_TP_Position|
|241|1 MPRO_TP_Position|
|241|2 MPRO_TP_Position|
|241|3 MPRO_TP_Position|
|241|4 MPRO_TP_Position|
|1400|0 MPRO_TP_Config|
| |TP_TP (0)|
| |AB (1)|
| |PD_UP (2)|
| |PD_DOWN (3)|
| |PC_PC (4)|
| |PC_TP (5)|
| |TP_PC (6)|
| |ENC_ENC (7)|
| |ENC_TP (8)|
| |TP_ENC (9)|

Using the touch probe inputs, touch probe functions can be performed. In order to be able to do this, P 106[0] - MPRO_INPUT_FS_ISD05 and P 107[0] - MPRO_INPUT_FS_ISD06 must be used to set digital inputs ISD05 and ISD06 to ""PROBE(15) = Touch probe (only ISD05/06)"" (see Section ""Digital inputs"" on page 290). HTL encoders can be evaluated or pulse counters implemented using the MSD PLC.

The touch probe can be triggered with P 240 - MPRO_TP_Ctrl. This enables triggering on a positive or negative edge, or on both edges, of the signal detected on the touch probe inputs. After the measurement, the parameter jumps back to the value ""NONE (0)"" and the latch position is mapped in the corresponding subindex of parameter P 241 - MPRO_TP_Position. A continuous touch probe mode is not possible at present, so the touch probe has to be reactivated after the measurement.

P 1402 - MPRO_TP_Channel can be used to select various positions as actual value sources of the latch position for the touch probe functionality. The following table provides an overview of the available settings. The counters are accessed via the MSD PLC or a bus system.

|ID|Index Name / Setting|Unit|Description|
|---|---|---|---|
|240|MPRO_TP_Ctrl|Touch probe: Control| |
| |0| |NONE (0) = No function|
| |1| |POS (1) = Positive edge|
| |2| |NEG (2) = Negative edge|
| |3| |BOTH (3) = Both edges|
|240|0 MPRO_TP_Ctrl| | |
|240|1 MPRO_TP_Ctrl| | |
|240|2 MPRO_TP_Ctrl| | |
|241|MPRO_TP_Position|Probe: Pos. high/low edge of TP0/1, encoder zero pulse| |

Table 8.29: “Touch probe” parameters

MOOG ID No.:CB40859-001 Date:11/2020

# 8 Motion profile

|Unit|Description|
|---|---|
|mDegree|Touch probe: Configuration|
|mDegree|TP0, TP1 touch probe|
|mDegree|TP0, TP1 as encoder, A/B as quadrature counting|
|mDegree|TP0, TP1 as encoder, pulse (TP0) / direction (TP1), count up on direction high|
|mDegree|TP0, TP1 as encoder, pulse (TP0) / direction (TP1), count down on direction high|
|mDegree|TP0 pulse counter, TP1 pulse counter|
|mDegree|TP0 pulse counter, TP1 touch probe|
|mDegree|TP1 touch probe, TP0 pulse counter|
|mDegree|TP0 encoder counter, TP1 encoder counter|
|mDegree|TP0 encoder counter, TP1 touch probe|
|mDegree|TP0 touch probe, TP1 encoder counter|

Touch probe: Channel

|Unit|Description|
|---|---|
|ACTPOS (0)|Actual position in user units|
|ACTPOSINC (1)|Actual position in increments|
|MASTERPOS (2)|Master position in increments|
|ENCPOS_CH1 (3)|Encoder position Channel 1|
|ENCPOS_CH1_INC (4)|Encoder position Channel 1 in increments|
|ENCPOS_CH2 (5)|Encoder position Channel 2|
|ENCPOS_CH2_INC (6)|Encoder position Channel 2 in increments|

# 8 Motion profile

MOOG ID No.:CB40859-001 Date:11/2020 MSD ServoDrive - DeviceHelp 276

|ID|Index Name / Setting|Unit|Description|
|---|---|---|---|
|7|ENCPOS_CH3 (7)| |Encoder position Channel 3|
|8|ENCPOS_CH3_INC (8)| |Encoder position Channel 3 in increments|
|9|ENCPOS_CH4 (9)| |Encoder position Channel 4|
|10|ENCPOS_CH4_INC (10)| |Encoder position Channel 4 in increments|
|11|ACTPOS2 (11)| |Actual position of redundant encoder in user units|
|12|Sercos (12)| |Referred to Sercos profile parameters S-x-0426, S-x-0427|
|13|UserRefPos(13)| |Reference position in user units|
|14|MasterPosST(14)| |Master position (ECAM, EGEAR) singleturn, always steps|
|15|CommonMasterPos(15)| |Master position (ECAM, EGEAR) singleturn, always steps|
|16|CommonMasterPosST(15)| |Master position (ECAM, EGEAR) singleturn, always steps|
|1402|MPRO_TP_Channel| | |
|1402|MPRO_TP_Channel| | |
|1402|MPRO_TP_Channel| | |
|1404|MPRO_TP_Lines| |Touch probe: Lines @ pulse counter on channel x|
|1404|MPRO_TP_Lines| | |
|1404|MPRO_TP_Lines| | |

Image 8.71: “Synchronized motion” screen

There are various modes available in the “synchronization mode” drop-down menu (P 242[0] - MPRO_ECAM_SyncModMode):

- Off(0) = Synchronized motion off
- ECAM_iPlc(1) = Electronic cam plate via MSD PLC
- EGEAR_iPlc(2) = Electr. gear unit via MSD PLC
- ECAM_PARA(3) = Electronic camming via parameters
- EGEAR_PARA(4) = Electronic gearing via parameters

NOTE: For more information refer to the bus system User Manuals or the description of the MSD PLC.

# 8.11.1 Electronic cam plate

The other parameters are configured in separate screens that can be accessed with the corresponding buttons.

- Master configuration (see Section ""Master configuration"" on page 280)
- Electronic gearing (see Section ""Electronic gearing"" on page 283)
- Electronic camming (see Section ""Electronic cam plate"" on page 277)

P 1318[0] - MPRO_ECAM_ControlWord is the control word for “synchronized motion” (see Section ""Control word for synchronized motion"" on page 279).

P 1326[0] - MPRO_ECAM_StatusWord is the status word for “synchronized motion” (see Section ""Status word for synchronized motion"" on page 279).

# 8.11.1.1 Table selection

|ID|Index Name|Unit|Description|
|---|---|---|---|
|1300|MPRO_ECAM_CTS_| |ECAM: CamTableSelect - Master reference|
|1301|MasterRef| | |
|1305|MPRO_ECAM_CTS_| |ECAM: CamTableSelect - Method for changing the camtable|
|1306|MPRO_ECAM_CTS_| |ECAM: CamTableSelect - Mode for changing the camtable|
|1307|MPRO_ECAM_CTS_|incr|ECAM: CamTableSelect - Distance for changing the camtable|
|242|MPRO_ECAM_| |ECAM / EGEAR: Mode of synchronized motion SyncModMode|
|265|MPRO_ECAM_| |ECAM / EGEAR: Slave speed factor (1 = 100%).|
|266|CamSlave_SpeedFactor| | |
|268|MPRO_ECAM_| |ECAM / EGEAR: Mode of switching off sync. motion|

# 8.11.1.2 Synchronization

|ID|Index Name|Unit|Description|
|---|---|---|---|
|1342|MPRO_ECAM_CI_|incr|ECAM: CamIn - Synchronization position (multiturn part)|
|1343|MPRO_ECAM_CO_|incr|ECAM: CamOut - Decoupling pos. (multiturn part)|
|1303|MPRO_ECAM_CI_|incr|ECAM: CamIn - Master offset|
|1308|MPRO_ECAM_CI_| |ECAM: CamIn - Master reference|
|1309|MPRO_ECAM_CI_| |ECAM: CamIn - Slave reference|
|1310|MPRO_ECAM_CI_| |ECAM: CamIn - Coupling mode|
|1311|MPRO_ECAM_CI_|incr|ECAM: CamIn - Coupling distance|
|1312|MPRO_ECAM_CI_|incr|ECAM: CamIn - Synchronization position|

Table 8.31: “Electronic camming - Table selection” parameters

Table 8.30: “Synchronized motion” parameters

Table 8.32: “Electronic camming - Synchronization” parameters

MOOG ID No.:CB40859-001 Date:11/2020

MSD ServoDrive - DeviceHelp 277

# 8 Motion profile

MOOG ID No.:CB40859-001 Date:11/2020 MSD ServoDrive - DeviceHelp 278

|ID|Index|Name|Unit|Description|
|---|---|---|---|---|
|1313|0|MPRO_ECAM_CO_SyncPosST|(singleturn part)|ECAM: CamOut - Slave reference|
|1314|0|MPRO_ECAM_CO_DecouplingMode|63|ECAM: CamOut - Decoupling mode|
|1315|0|MPRO_ECAM_CO_BreakingPosST|incr|ECAM: CamOut - Decoupling position|
|1316|0|MPRO_ECAM_CO_DecouplingDist|incr|ECAM: CamOut - Decoupling distance|
|1317|0|MPRO_ECAM_CO_StandstillPos|mDegree|ECAM: CamOut - Slave standstill position|

# Table 8.32: “Electronic camming - Synchronization” parameters (continue)

|ID|Index|Name|Unit|Description|
|---|---|---|---|---|
|1346| |MPRO_ECAM_SP_Table| |ECAM: Setpoint table interface|
|1346|0|Index| |Index of setpoint table|
|1346|1|Value| |Value at index of setpoint table|
|1347|0 to 31|MPRO_ECAM_SP_Index| |ECAM: Setpoint segments start index|
|1348|0 to 31|MPRO_ECAM_SP_Length| |ECAM: Setpoint segments length|
|1349|0 to 31|Length| | |
|1350|0|MPRO_ECAM_SP_MaDist| |ECAM: Setpoint segments master distance|
|1351|0|MPRO_ECAM_SP_IpoType| |ECAM: Setpoint segments interpolation type|
|1352|0 to 31|Checksum| |ECAM: Setpoint table checksum|
|1353|0 to 31|GainNum| |ECAM: Setpoint segments gain numerator|
| | |GainDen| |ECAM: Setpoint segments gain denominator|

# Table 8.33: “Electronic camming - Table segments” parameters

|ID|Index|Name|Unit|Description|
|---|---|---|---|---|
|1329|0 to 63|MPRO_ECAM_SegData_IndexNext| |ECAM: Index of the following segment|
|1330|0 to 63|MPRO_ECAM_SegData_IndexPrev| |ECAM: Index of the previous segment|
|1331|0 to 63|MPRO_ECAM_SegData_ProfileMode| |ECAM: Profile mode of the current segment|
|1332|0 to 63|MPRO_ECAM_SegData_DistMaster| |ECAM: Length of the master section of the current segment|
|1333|0 to 63|MPRO_ECAM_SegData_DistSlave| |ECAM: Length of the slave section of the current segment|
|1334|0 to 63|MPRO_ECAM_SegData_Lambda| |ECAM: Lambda value of the current segment|
|1335|0 to 63|MPRO_ECAM_SegData_StatusWord| |ECAM: Status word of the current segment|
|1336|0 to 63|MPRO_ECAM_SegData_ControlWord| |ECAM: Control word of the current segment|

# 8.11.2 Control word for synchronized motion

|Bit|Function|PLC function|Bit number|Description|
|---|---|---|---|---|
|0-7|Start segment (8-bit value)|-|0-7|Actual segment (8-bit value)|
|8-15|Reserved|-| |Actual ECAM / EGEAR state machine state (4 Bit value)|
|16|Absolute (true) / relative (false) master relationship|-| |- 0: ECAM / EGEAR asynchronous
- 1: ECAM / EGEAR synchronous
|
|17|Absolute (true) / relative (false) master (CAM) relationship at cam in|-| |- 2: ECAM / EGEAR synchronizing
- 3: ECAM / EGEAR desynchronizing
|
|18|Absolute (true) / relative (false) slave (CAM) relationship at cam in|-| |- 4: ECAM / EGEAR active and waiting for going asynchronous
|
|19-23|Reserved|-| |- 5: ECAM / EGEAR inactive and waiting for going synchronous
|
|24|Change gear ratio of the electronic gear online|MCB_GearRatioChange| | |
|25|Disable master calculation|MCB_Cam_MasterEnable| | |
|26|Enable master calculation|MCB_Cam_MasterEnable| | |
|27|Select CAM table|MCB_CamTableSelect| | |
|28|Start Ecam|MCB_CamIn| | |
|29|Stop Ecam|MCB_CamOut| | |
|30|Start Egear|MCB_GearIn| | |
|31|Stop Egear|MCB_GearOut| | |

# 8.11.3 Status word for synchronized motion

|Bit|Function|PLC function|Bit number|Description|
|---|---|---|---|---|
|12-26|Reserved|-| | |
|27|ECAM / EGEAR is active|-| | |
|28|Valid segments chosen|-| | |
|29|Master data are valid|-| | |
|30|Master is initialized|-| | |
|31|Master calculation is active|-| | |

Table 8.35: Control word ECAM (P 1318[0] - MPRO_ECAM_ControlWord)

Table 8.36: ECAM status word (P 1326[0] - MPRO_ECAM_StatusWord)

MOOG ID No.:CB40859-001 Date:11/2020 MSD ServoDrive - DeviceHelp 279

# 8 Motion profile

# 8 Motion profile

MOOG ID No.:CB40859-001 Date:11/2020

MSD ServoDrive - DeviceHelp 280

# 8.11.4 Master configuration

the master encoder, you will need to set the resolution relative to a single motor revolution in P 250 - MPRO_ECAM_PARAMaster_Amplitude (see below).

- ENC CH1 (3) = Encoder channel 1 X7 (Sin/Cos)
- ENC CH2 (4) = Encoder channel 2 X6 (Resolver)
- ENC CH3 (5) = Encoder channel 3 X8 (optional)

This function is only available if an external interface X8 (option module) is present.

- TP0 (6) = Pulse counter on probe channel 0 (TP0)
- TP1 (7) = Pulse counter on probe channel 1 (TP1)
- ENC_CH4 (8) = Encoder channel 4 (p. e. fieldbus)
- TWIN_POS (9) = TWIN remote reference position (P-2607)

Image 8.72: “Master configuration” screen

# Channel selection (master encoder)

P 1319[0] - MPRO_ECAM_CamMaster_AxisType is used to define the master encoder.

- NO AXIS (0) = No axis
- VIRTUAL MASTER (1) = Virtual master

If you select this function, you will be able to configure additional settings by clicking on the enabled “Options...” button (see Section ""Virtual Master"" on page 286).

- PARA (2) = Master parameter interface

If you select this function because a higher-level controller is being used as

# Anti-reverse mode

Slave only starts moving along with it again as soon as the master reaches the zero position.

P 1320[0] - MPRO_ECAM_CamMaster_RevLockMode is used to define the reverse lock mode, which can be used either with or without path compensation. The dashed lines in the following diagrams indicate what the engagement distance is:

# Example:

If the master, which has moved two motor revolutions in the direction blocked for the slave, then moves in the unblocked direction again, the slave only moves off when the master has traversed the zero point.

- INACTIVE (0) = Reverse lock inactive
- ACTIVE (2) = Reverse lock enabled - without path optimization
- ACTIVE WAY COMP (1) = Reverse lock active - with way compensation

While the slave accelerates to the speed of the master during engagement, the master and slave do not move synchronously. This function needs to be selected in order to quickly catch up to the master that is running ahead.

# Example:

- Master (black line) rotates in the blocked direction
- The slave (blue line) remains stopped
- Master rotates in the unblocked direction again
- The slave follows the master directly in the unblocked direction

Assume the master has moved two motor revolutions in the direction for which the slave lock is enabled. If the master now moves in the direction for which there is no lock, the slave will immediately start running in that direction.

MOOG ID No.:CB40859-001 Date:11/2020

MSD ServoDrive - DeviceHelp 281

# 8 Motion profile

MOOG ID No.:CB40859-001 Date:11/2020 MSD ServoDrive - DeviceHelp 282

|Filter type|ID|Index Name|Unit|Description|
|---|---|---|---|---|
|When using a real master encoder, encoder signals may be subject to noise.|P 1340|1319|0|MPRO_ECAM_CamMaster_AxisType|
| | |MPRO_ECAM_CamMaster_SpeedFilTyp| |ECAM / EGEAR: Channel selection of internal master input|
| | |1320|0|MPRO_ECAM_CamMaster_RevLockMode|
| | |1321|0|MPRO_ECAM_CamMaster_Amplitude|
| | |1322|0|MPRO_ECAM_CamMaster_GearNum|
| | |1323|0|MPRO_ECAM_CamMaster_GearDen|
|Filter time|1327|0|ms|ECAM / EGEAR: Filter time constant of master|
|If P 1340[0] is used to enable a filter, P 1327[0] - MPRO_ECAM_CamMaster_SpeedTFil can be used to define the corresponding filter time.|1328|0|speed|ECAM / EGEAR: Speed factor of the internal master|
|Speed factor|1340|0| |MPRO_ECAM_CamMaster_SpeedFilTyp|
|The master encoder can be assigned an additional speed factor P 1328[0] - MPRO_ECAM_CamMaster_SpeedFactor.|1341|0|incr|ECAM / EGEAR: Master drive offset|

Table 8.37: “Synchronized motion - Master configuration” parameters (continue)

| | | |ID|Index Name|Unit|Description|
|---|---|---|---|---|---|---|
|247|0|MPRO_ECAM_ParaMaster_ActPos|incr|ECAM / EGEAR: Parameter interface master position| | |
|248|0|MPRO_ECAM_ParaMaster_ActSpeed|rpm|ECAM / EGEAR: Parameter interface master speed| | |
|249|0|MPRO_ECAM_ParaMaster_ActAcc|rpm|ECAM / EGEAR: Parameter interface master acceleration| | |
| |250|0|MPRO_ECAM_ParaMaster_Amplitude| |ECAM / EGEAR: Parameter interface master amplitude| |

Table 8.37: “Synchronized motion - Master configuration” parameters

# 8.11.5 Electronic gearing

# Gear ratio

The gear ratio is specified as a fraction. This ensures that the position references can be translated to the motor shaft with no rounding error.

- ""Slave"" (P 252[0] - MPRO_ECAM_Egear_GearNum) is the numerator
- ""Master"" (P 251[0] - MPRO_ECAM_Egear_GearDen) is the denominator

# Scaling of speed pre-control

Defined with P 265[0] - MPRO_ECAM_CamSlave_SpeedFactor definiert.

# Scaling of torque pre-control

Defined with P 266[0] - MPRO_ECAM_CamSlave_TorqueFactor.

# Engagement

See Section ""Engagement"" on page 284.

# Disengagement

See Section ""Disengagement"" on page 285.

|ID|Index Name|Unit|Description|
|---|---|---|---|
|251|0 MPRO_ECAM_Egear_GearDen| |EGEAR: Gear denominator|
|252|0 MPRO_ECAM_Egear_GearNum| |EGEAR: Numerator of gear ratio|
|1344|0 MPRO_ECAM_Egear_LimRefAcc|rpm/s|EGEAR: Acceleration limit for reference|
|1345|0 MPRO_ECAM_Egear_LimRefJerk|rpm/s²|EGEAR: Jerk limit for reference|

Table 8.38: “Synchronized motion - Electronic gearing” parameters

Image 8.73: ""Electronic gearing"" screen

MOOG ID No.:CB40859-001 Date:11/2020 MSD ServoDrive - DeviceHelp 283

# 8 Motion profile

# 8 Motion profile

MOOG ID No.:CB40859-001 Date:11/2020

MSD ServoDrive - DeviceHelp 284

# 8.11.6 Engagement

used to define the engagement distance (between the dashed lines).

P 253[0] - MPRO_ECAM_Egear_GearInMode is used to define the mode for engagement.

- DIRECT (0) = Direct
- Direct engagement: Angular synchronous; with jerking (no ramps).
- CROSSFADE (3) = Crossfading
- Engagement with crossfading function (5th degree polynomial): Angular synchronous; jerk-limited; speed will overshoot during engagement.
- RAMP (1) = Linear speed ramp
- Engagement with linear acceleration: Not angular synchronous; with jerking.
- FADE (2) = Engagement fade-out
- Engagement with fade-in function (5th degree polynomial): Not angular synchronous; jerk-limited. The position is ignored. ","What parameters are used to define deceleration in torque, speed, and position control modes in the 'MSD ServoDrive - DeviceHelp' document?",A1,"P 194 - MPRO_TAB_TDec for torque control, P 197 - MPRO_TAB_SDec for speed control, and P 200 - MPRO_TAB_PDec for position control.",2.53125,2.5625,3.78125,1.65625,0.6875
46,msd_servo_drive.txt,76,b87ca5e232c2bdbb6fa16a8a401c6b5d285dc0183e73cc9d134de13dd2fc71d2,"MOOG ID No.:CB40859-001 Date:11/2020

MSD ServoDrive - DeviceHelp 267

# 8 Motion profile

MOOG ID No.:CB40859-001 Date:11/2020 MSD ServoDrive - DeviceHelp 268

# Deceleration

With ...

- P 194 - MPRO_TAB_TDec (for torque control) or
- P 197 - MPRO_TAB_SDec (for speed control) or
- P 200 - MPRO_TAB_PDec (for position control)

and indexes 0–15, the deceleration for each individual motion task can be defined. The input must not be zero.

# Wait time in Auto mode

P 204 - MPRO_TAB_WaitTime is used to define the wait time before the next motion task is carried out.

# Maximum table index in Auto mode

P 206[0] - MPRO_Tab_MaxIdx is used to define the table index up to which driving jobs will be carried out in one of the auto modes.

# Current table index

P 207[0] - MPRO_Tab_ActIdx will show the index for the motion task that is currently active. If parameter P 205 MPRO_TAB_Mode is set to “Para(0)”, a driving set can be entered and approached directly.

# Activation of reference table

The following procedures can be used in order to activate the setpoint table for operation.

|ID|Index Name|Unit|Description|
|---|---|---|---|
|193|MPRO_TAB_TAcc|TAB: Torque mode acceleration|Nm/ms|
|193|0|MPRO_TAB_TAcc|Nm/ms|
|193|1 - 15|MPRO_TAB_TAcc|Nm/ms|
|194|MPRO_TAB_TDec|TAB: Torque mode deceleration| |
|194|0|MPRO_TAB_TDec|Nm/ms|
|194|1 - 15|MPRO_TAB_TDec|Nm/ms|

# Table 8.23: Activation of table references

# Table 8.24: “Setpoint table settings” parameters

# Table 8.24: “Setpoint table settings” parameters (continue)

|ID|Index Name|Unit|Description|ID|Index Name|Unit|Description|
|---|---|---|---|---|---|---|---|
|195|MPRO_TAB_TRef|Nm|TAB: Torque mode reference value|208|MPRO_TAB_OutputNo| |OSD TAB: actual table index and target|
|195|MPRO_TAB_TRef|Nm| |208|MPRO_TAB_OutputNo| | |
|196|MPRO_TAB_SAcc|rev/min/s|TAB: Speed mode acceleration|269|MPRO_TAB_Ctrl| |TAB: control word|
|196|MPRO_TAB_SAcc|rev/min/s| | | | | |
|197|MPRO_TAB_SDec|rev/min/s|TAB: Speed mode deceleration| | | | |
|197|MPRO_TAB_SDec|rev/min/s| | | | | |
|198|MPRO_TAB_SRef|rev/min|TAB: Speed mode reference value| | | | |
|198|MPRO_TAB_SRef|rev/min| | | | | |
|199|MPRO_TAB_PAcc|rev/min/s|TAB: Position control mode acceleration| | | | |
|199|MPRO_TAB_PAcc|rev/min/s| | | | | |
|200|MPRO_TAB_PDec|rev/min/s|TAB: Position control mode Acceleration| | | | |
|200|MPRO_TAB_PDec|rev/min/s| | | | | |
|201|MPRO_TAB_PSpd|rev/min|TAB: Position control mode speed| | | | |
|201|MPRO_TAB_PSpd|rev/min| | | | | |
|202|MPRO_TAB_PPos|mDegree|TAB: Position control mode reference value| | | | |
|202|MPRO_TAB_PPos|mDegree| | | | | |
|203|MPRO_TAB_PMode| |Position control table:Mode| | | | |
|203|MPRO_TAB_PMode| | | | | | |
|204|MPRO_TAB_WaitTime|ms|TAB: Wait time| | | | |
|204|MPRO_TAB_WaitTime|ms| | | | | |
|205|MPRO_TAB_Mode| |TAB mode| | | | |
|206|MPRO_Tab_MaxIdx| |TAB: Max index in AUTO mode| | | | |
|207|MPRO_TAB_ActIdx| |TAB: Actual index| | | | |

MOOG ID No.:CB40859-001 Date:11/2020

MSD ServoDrive - DeviceHelp

# 8 Motion profile

MOOG ID No.:CB40859-001 Date:11/2020

MSD ServoDrive - DeviceHelp 270

# 8.8 Analog channel (ISA00 und ISA01)

# Offset (O)

This parameter (P 174 - MPRO_ANA0_SOffset for ISA00, P 184 - MPRO_ANA1_SOffset for ISA01) compensates for component variations and is used for offset compensation purposes. Depending on the control mode being used (see Section ""Basic settings"" on page 110), the value will be stored in parameter index [0] (torque control), [1] (speed control) or [2] (position control).

# Backlash (B)

This parameter (P 175 - MPRO_ANA0_SThreshold for ISA00, P 185 - MPRO_ANA1_SThreshold for ISA01) can suppress axis motion close to the standstill (stop) position. Depending on the control mode being used (see Section ""Basic settings"" on page 110), the value will be stored in parameter index [0] (torque control), [1] (speed control) or [2] (position control).

Image 8.68: “Analog channel” screen

# Acceleration ramp

Two standard analog inputs (ISA00, ISA01) are available. These inputs can be configured...

- with negative values for analog setpoint settings
- with positive values for digital setpoint processing

(P 109[0] - MPRO_INPUT_FS_ISA00 and P 110[0] - MPRO_INPUT_FS_ISA01).

see also section ""Analog Inputs"" on page 303. By using the ""REV(-2) = Analog setpoint"" setting, an analog input voltage of ±10 V can be processed as a setpoint.

# Deceleration ramp

This parameter serves as a deceleration ramp for torque control (P 176[1] - MPRO_ANA0_TRamp for ISA00, P 186[1] - MPRO_ANA1_TRamp for ISA01) or speed control (P 177[1] - MPRO_ANA0_SRamp for ISA00, P 187[1] - MPRO_ANA1_SRamp for ISA01). Depending on the control mode being used (see Section ""Basic settings"" on page 110), the value will be stored in parameter index [0] (torque control), [1] (speed control) or [2] (position control).

This parameter (P 173 - MPRO_ANA0_Scale for ISA00, P 183 - MPRO_ANA1_Scale for ISA01) is used to define which speed / which torque / which position corresponds to the maximum analog value. Depending on the control mode being used (see Section ""Basic settings"" on page 110), the value will be stored in parameter index [0] (torque control), [1] (speed control) or [2] (position control).

# 8.8.1 Special characteristics of position control mode

A threshold value can also be specified which generates a run-on range around the last reference value. A ramp function calculates a motion profile for the position reference from pre-defined acceleration and speed limits.

The position references on the analog channel are not applied immediately, but dependent on a digital input. Accordingly, one of the ISD00 to ISD06 digital inputs must be set to a value of ""REFANAEN(28) = Enable analog reference value"" (see Section ""Digital inputs"" on page 290). The position setpoint being received will only be applied if the corresponding digital input is active. The acceleration is entered using P 173[0] - MPRO_ANA0_TScale or P 183[0] - MPRO_ANA1_TScale.

# 8.8.2 Wire Break Monitoring

P 399 - CON_ANAWireBrk_Th can be used to configure wire break monitoring for the analog inputs. For details see Section ""Wire Break Monitoring"" on page 306.

|Function|TLIM (-4)|OVR (-3)|REFV (-2)|leer (-1)|OFF (0)|
|---|---|---|---|---|---|
|Digital|(1)-(28)|(1)-(28)|(1)-(28)|(1)-(28)|(1)-(28)|
|Analog channel|Filter|Scale|Offset|Profile|generator|

Control

Image 8.69: Reference processing structure

MOOG ID No.:CB40859-001 Date:11/2020

MSD ServoDrive - DeviceHelp 271

# 8 Motion profile

# 8 Motion profile

MOOG ID No.:CB40859-001 Date:11/2020

|ID|Index Name|Unit|Description|ID|
|---|---|---|---|---|
|395|CON_ANA_Isaf_Scaled| |Analog inputs: Values (filt, norm, comp, scaled)|174|
|395|0 ISA00| |Scaled, compensated, filtered, normalized value|175|
|395|1 ISA01| |Scaled, compensated, filtered, normalized value| |
|396|CON_ANA_Scale_ThUpper| |Analog inputs: Upper scaling limits|175|
|396|0 ISA00|%|Upper scaling (@ 10 V) threshold|175|
|396|1 ISA01|%|Upper scaling (@ 10 V) threshold| |
|397|CON_ANA_Scale_ThZero| |Analog inputs: Zero scaling thresholds|176|
|397|0 ISA00|V|Zero scaling threshold (+/-)|176|
|397|1 ISA01|V|Zero scaling threshold (+/-)| |
|398|CON_ANA_Scale_ThLower| |Analog inputs: Lower scaling limits|177|
|398|0 ISA00|%|Lower scaling (@ zero threshold) threshold|177|
|398|1 ISA01|%|Lower scaling (@ zero threshold) threshold| |
|399|CON_ANA_WireBrk_Th| |Analog inputs: Wire break thresholds|Table 8.26:|
|399|0 ISA00|V|Wire break detection threshold| |
|399|1 ISA01|V|Wire break detection threshold| |
|405|0 CON_ANA_Filt0|ms|Analog input ISA00: Filter time constant (PT 1)|ID|
|408|CON_ANA_Isaf_Norm| |Analog inputs: Values (filt, norm)|183|
|408|0 ISA00| |Filtered, normalized value|183|
|408|1 ISA01| |Filtered, normalized value|183|

Table 8.25: “Analog channel” parameters

|ID|Index Name|Unit|Description|ID|
|---|---|---|---|---|
|173|MPRO_ANA0_Scale| |ANA0: scale factors|184|
|173|0 MPRO_ANA0_TScale|Nm|ANA0: scale factor torque reference|185|
|173|1 MPRO_ANA0_SScale|rev/min|ANA0: scale factor speed reference|185|
|173|2 MPRO_ANA0_PScale|mDegree|ANA0: scale factor position reference| |
|174|MPRO_ANA0_Offset| |ANA0: offsets|185|
|174|0 MPRO_ANA0_TOffset|Nm|ANA0: offsets for torque reference|185|

Table 8.26: “Analog channel ISA00” parameters

|Index Name|Unit|Description|
|---|---|---|
|1 MPRO_ANA0_SOffset|rev/min|ANA0: offsets for speed reference|
|2 MPRO_ANA0_POffset|mDegree|ANA0: offsets for position reference|
|MPRO_ANA0_Threshold| |ANA0: thresholds|
|0 MPRO_ANA0_TThreshold|Nm|ANA0: threshold for torque reference|
|1 MPRO_ANA0_SThreshold|rev/min|ANA0: threshold for speed reference|
|2 MPRO_ANA0_PThreshold|mDegree|ANA0: threshold for position reference|
|MPRO_ANA0_TRamp| |ANA0: Torque mode acceleration [0] and deceleration [1]|
|0 MPRO_ANA0_TRamp|Nm/s| |
|1 MPRO_ANA0_TRamp|Nm/s| |
|MPRO_ANA0_SRamp| |ANA0: Speed mode acceleration [0] and deceleration [1]|
|0 MPRO_ANA0_SRamp|SPEED/s| |
|1 MPRO_ANA0_SRamp|SPEED/s| |

“Analog channel ISA00” parameters (continue)

|Index Name|Unit|Description|
|---|---|---|
|MPRO_ANA1_Scale| |ANA1: scale factors|
|0 MPRO_ANA1_TScale|Nm|ANA0: scale factor torque reference|
|1 MPRO_ANA1_SScale|rev/min|ANA0: scale factor speed reference|
|2 MPRO_ANA1_PScale|mDegree|ANA0: scale factor position reference|
|MPRO_ANA1_Offset| |ANA1: offsets|
|0 MPRO_ANA1_TOffset|Nm|ANA1: offsets for torque reference|
|1 MPRO_ANA1_SOffset|rev/min|ANA1: offsets for speed reference|
|2 MPRO_ANA1_POffset|mDegree|ANA1: offsets for position reference|
|MPRO_ANA1_Threshold| |ANA1: thresholds|
|0 MPRO_ANA1_TThreshold|Nm|ANA1: threshold for torque reference|
|1 MPRO_ANA1_SThreshold|rev/min|ANA1: threshold for speed reference|
|2 MPRO_ANA1_PThreshold|mDegree|ANA1: threshold for position reference|

“Analog channel ISA01” parameters

# 8 Motion profile

|ID|Index Name|Unit|Description|
|---|---|---|---|
|186|MPRO_ANA1_TRamp|Nm/s|ANA1: Torque mode acceleration [0] and deceleration[1]|
|186|MPRO_ANA1_TRamp|Nm/s| |
|187|MPRO_ANA1_SRamp|SPEED/s|ANA1: Speed mode acceleration [0] and deceleration [1]|
|187|MPRO_ANA1_SRamp|SPEED/s| |

# Table 8.27: “Analog channel ISA01” parameters (continue)

Display

- System state
- Initialization on device startup
- Not ready (DC link voltage possibly too low)
- Start inhibit (DC link voltage present, power stage off)
- Starting lockout
- Ready for start
- Control initialization: Auto commutation, flux build-up etc.

# Table 8.28: Central state machine according to CiA 402 device display

MOOG ID No.:CB40859-001 Date:11/2020

MSD ServoDrive - DeviceHelp 273

# 8 Motion profile

MOOG ID No.:CB40859-001 Date:11/2020

MSD ServoDrive - DeviceHelp 274

|Display|System state|power disabled|fault|
|---|---|---|---|
|Control enabled|0|Start|7|
| |fault reaction active|0|14|
|Quick stop active|1|not ready|8|
| |to switch on|1|17|
|Error reaction active|2|switch on|disabled|
| |2|7| |
|Error state (in this state the error is indicated directly on the display.)|3|ready to|switch on|
|Device is reset (display flashes)|power enabled|3|6|
| |10|12| |
|• Number [5.] flashes when “STO” (Safe Torque Off) input is active. Display goes out when STO inactive.| | | |
|• The dot on the display flashes when the power stage is active.| | | |

Table 8.28: Central state machine according to CiA 402 device display (continue)

NOTE

l The system states indicated on the display may differ from the states in the table depending on the drive profile setting.

Image 8.70: State machine diagram based on CANopen communications

⓪ to ① State number

1 to 17 State transition (No. 17: DC link voltage cut off)

Legend for “State machine diagram based on CANopen communications” figure

# 8.10 Touch probe

|ID|Index Name / Setting|
|---|---|
|241|0 MPRO_TP_Position|
|241|1 MPRO_TP_Position|
|241|2 MPRO_TP_Position|
|241|3 MPRO_TP_Position|
|241|4 MPRO_TP_Position|
|1400|0 MPRO_TP_Config|
| |TP_TP (0)|
| |AB (1)|
| |PD_UP (2)|
| |PD_DOWN (3)|
| |PC_PC (4)|
| |PC_TP (5)|
| |TP_PC (6)|
| |ENC_ENC (7)|
| |ENC_TP (8)|
| |TP_ENC (9)|

Using the touch probe inputs, touch probe functions can be performed. In order to be able to do this, P 106[0] - MPRO_INPUT_FS_ISD05 and P 107[0] - MPRO_INPUT_FS_ISD06 must be used to set digital inputs ISD05 and ISD06 to ""PROBE(15) = Touch probe (only ISD05/06)"" (see Section ""Digital inputs"" on page 290). HTL encoders can be evaluated or pulse counters implemented using the MSD PLC.

The touch probe can be triggered with P 240 - MPRO_TP_Ctrl. This enables triggering on a positive or negative edge, or on both edges, of the signal detected on the touch probe inputs. After the measurement, the parameter jumps back to the value ""NONE (0)"" and the latch position is mapped in the corresponding subindex of parameter P 241 - MPRO_TP_Position. A continuous touch probe mode is not possible at present, so the touch probe has to be reactivated after the measurement.

P 1402 - MPRO_TP_Channel can be used to select various positions as actual value sources of the latch position for the touch probe functionality. The following table provides an overview of the available settings. The counters are accessed via the MSD PLC or a bus system.

|ID|Index Name / Setting|Unit|Description|
|---|---|---|---|
|240|MPRO_TP_Ctrl|Touch probe: Control| |
| |0| |NONE (0) = No function|
| |1| |POS (1) = Positive edge|
| |2| |NEG (2) = Negative edge|
| |3| |BOTH (3) = Both edges|
|240|0 MPRO_TP_Ctrl| | |
|240|1 MPRO_TP_Ctrl| | |
|240|2 MPRO_TP_Ctrl| | |
|241|MPRO_TP_Position|Probe: Pos. high/low edge of TP0/1, encoder zero pulse| |

Table 8.29: “Touch probe” parameters

MOOG ID No.:CB40859-001 Date:11/2020

# 8 Motion profile

|Unit|Description|
|---|---|
|mDegree|Touch probe: Configuration|
|mDegree|TP0, TP1 touch probe|
|mDegree|TP0, TP1 as encoder, A/B as quadrature counting|
|mDegree|TP0, TP1 as encoder, pulse (TP0) / direction (TP1), count up on direction high|
|mDegree|TP0, TP1 as encoder, pulse (TP0) / direction (TP1), count down on direction high|
|mDegree|TP0 pulse counter, TP1 pulse counter|
|mDegree|TP0 pulse counter, TP1 touch probe|
|mDegree|TP1 touch probe, TP0 pulse counter|
|mDegree|TP0 encoder counter, TP1 encoder counter|
|mDegree|TP0 encoder counter, TP1 touch probe|
|mDegree|TP0 touch probe, TP1 encoder counter|

Touch probe: Channel

|Unit|Description|
|---|---|
|ACTPOS (0)|Actual position in user units|
|ACTPOSINC (1)|Actual position in increments|
|MASTERPOS (2)|Master position in increments|
|ENCPOS_CH1 (3)|Encoder position Channel 1|
|ENCPOS_CH1_INC (4)|Encoder position Channel 1 in increments|
|ENCPOS_CH2 (5)|Encoder position Channel 2|
|ENCPOS_CH2_INC (6)|Encoder position Channel 2 in increments|

# 8 Motion profile

MOOG ID No.:CB40859-001 Date:11/2020 MSD ServoDrive - DeviceHelp 276

|ID|Index Name / Setting|Unit|Description|
|---|---|---|---|
|7|ENCPOS_CH3 (7)| |Encoder position Channel 3|
|8|ENCPOS_CH3_INC (8)| |Encoder position Channel 3 in increments|
|9|ENCPOS_CH4 (9)| |Encoder position Channel 4|
|10|ENCPOS_CH4_INC (10)| |Encoder position Channel 4 in increments|
|11|ACTPOS2 (11)| |Actual position of redundant encoder in user units|
|12|Sercos (12)| |Referred to Sercos profile parameters S-x-0426, S-x-0427|
|13|UserRefPos(13)| |Reference position in user units|
|14|MasterPosST(14)| |Master position (ECAM, EGEAR) singleturn, always steps|
|15|CommonMasterPos(15)| |Master position (ECAM, EGEAR) singleturn, always steps|
|16|CommonMasterPosST(15)| |Master position (ECAM, EGEAR) singleturn, always steps|
|1402|MPRO_TP_Channel| | |
|1402|MPRO_TP_Channel| | |
|1402|MPRO_TP_Channel| | |
|1404|MPRO_TP_Lines| |Touch probe: Lines @ pulse counter on channel x|
|1404|MPRO_TP_Lines| | |
|1404|MPRO_TP_Lines| | |

Image 8.71: “Synchronized motion” screen

There are various modes available in the “synchronization mode” drop-down menu (P 242[0] - MPRO_ECAM_SyncModMode):

- Off(0) = Synchronized motion off
- ECAM_iPlc(1) = Electronic cam plate via MSD PLC
- EGEAR_iPlc(2) = Electr. gear unit via MSD PLC
- ECAM_PARA(3) = Electronic camming via parameters
- EGEAR_PARA(4) = Electronic gearing via parameters

NOTE: For more information refer to the bus system User Manuals or the description of the MSD PLC.

# 8.11.1 Electronic cam plate

The other parameters are configured in separate screens that can be accessed with the corresponding buttons.

- Master configuration (see Section ""Master configuration"" on page 280)
- Electronic gearing (see Section ""Electronic gearing"" on page 283)
- Electronic camming (see Section ""Electronic cam plate"" on page 277)

P 1318[0] - MPRO_ECAM_ControlWord is the control word for “synchronized motion” (see Section ""Control word for synchronized motion"" on page 279).

P 1326[0] - MPRO_ECAM_StatusWord is the status word for “synchronized motion” (see Section ""Status word for synchronized motion"" on page 279).

# 8.11.1.1 Table selection

|ID|Index Name|Unit|Description|
|---|---|---|---|
|1300|MPRO_ECAM_CTS_| |ECAM: CamTableSelect - Master reference|
|1301|MasterRef| | |
|1305|MPRO_ECAM_CTS_| |ECAM: CamTableSelect - Method for changing the camtable|
|1306|MPRO_ECAM_CTS_| |ECAM: CamTableSelect - Mode for changing the camtable|
|1307|MPRO_ECAM_CTS_|incr|ECAM: CamTableSelect - Distance for changing the camtable|
|242|MPRO_ECAM_| |ECAM / EGEAR: Mode of synchronized motion SyncModMode|
|265|MPRO_ECAM_| |ECAM / EGEAR: Slave speed factor (1 = 100%).|
|266|CamSlave_SpeedFactor| | |
|268|MPRO_ECAM_| |ECAM / EGEAR: Mode of switching off sync. motion|

# 8.11.1.2 Synchronization

|ID|Index Name|Unit|Description|
|---|---|---|---|
|1342|MPRO_ECAM_CI_|incr|ECAM: CamIn - Synchronization position (multiturn part)|
|1343|MPRO_ECAM_CO_|incr|ECAM: CamOut - Decoupling pos. (multiturn part)|
|1303|MPRO_ECAM_CI_|incr|ECAM: CamIn - Master offset|
|1308|MPRO_ECAM_CI_| |ECAM: CamIn - Master reference|
|1309|MPRO_ECAM_CI_| |ECAM: CamIn - Slave reference|
|1310|MPRO_ECAM_CI_| |ECAM: CamIn - Coupling mode|
|1311|MPRO_ECAM_CI_|incr|ECAM: CamIn - Coupling distance|
|1312|MPRO_ECAM_CI_|incr|ECAM: CamIn - Synchronization position|

Table 8.31: “Electronic camming - Table selection” parameters

Table 8.30: “Synchronized motion” parameters

Table 8.32: “Electronic camming - Synchronization” parameters

MOOG ID No.:CB40859-001 Date:11/2020

MSD ServoDrive - DeviceHelp 277

# 8 Motion profile

MOOG ID No.:CB40859-001 Date:11/2020 MSD ServoDrive - DeviceHelp 278

|ID|Index|Name|Unit|Description|
|---|---|---|---|---|
|1313|0|MPRO_ECAM_CO_SyncPosST|(singleturn part)|ECAM: CamOut - Slave reference|
|1314|0|MPRO_ECAM_CO_DecouplingMode|63|ECAM: CamOut - Decoupling mode|
|1315|0|MPRO_ECAM_CO_BreakingPosST|incr|ECAM: CamOut - Decoupling position|
|1316|0|MPRO_ECAM_CO_DecouplingDist|incr|ECAM: CamOut - Decoupling distance|
|1317|0|MPRO_ECAM_CO_StandstillPos|mDegree|ECAM: CamOut - Slave standstill position|

# Table 8.32: “Electronic camming - Synchronization” parameters (continue)

|ID|Index|Name|Unit|Description|
|---|---|---|---|---|
|1346| |MPRO_ECAM_SP_Table| |ECAM: Setpoint table interface|
|1346|0|Index| |Index of setpoint table|
|1346|1|Value| |Value at index of setpoint table|
|1347|0 to 31|MPRO_ECAM_SP_Index| |ECAM: Setpoint segments start index|
|1348|0 to 31|MPRO_ECAM_SP_Length| |ECAM: Setpoint segments length|
|1349|0 to 31|Length| | |
|1350|0|MPRO_ECAM_SP_MaDist| |ECAM: Setpoint segments master distance|
|1351|0|MPRO_ECAM_SP_IpoType| |ECAM: Setpoint segments interpolation type|
|1352|0 to 31|Checksum| |ECAM: Setpoint table checksum|
|1353|0 to 31|GainNum| |ECAM: Setpoint segments gain numerator|
| | |GainDen| |ECAM: Setpoint segments gain denominator|

# Table 8.33: “Electronic camming - Table segments” parameters

|ID|Index|Name|Unit|Description|
|---|---|---|---|---|
|1329|0 to 63|MPRO_ECAM_SegData_IndexNext| |ECAM: Index of the following segment|
|1330|0 to 63|MPRO_ECAM_SegData_IndexPrev| |ECAM: Index of the previous segment|
|1331|0 to 63|MPRO_ECAM_SegData_ProfileMode| |ECAM: Profile mode of the current segment|
|1332|0 to 63|MPRO_ECAM_SegData_DistMaster| |ECAM: Length of the master section of the current segment|
|1333|0 to 63|MPRO_ECAM_SegData_DistSlave| |ECAM: Length of the slave section of the current segment|
|1334|0 to 63|MPRO_ECAM_SegData_Lambda| |ECAM: Lambda value of the current segment|
|1335|0 to 63|MPRO_ECAM_SegData_StatusWord| |ECAM: Status word of the current segment|
|1336|0 to 63|MPRO_ECAM_SegData_ControlWord| |ECAM: Control word of the current segment|

# 8.11.2 Control word for synchronized motion

|Bit|Function|PLC function|Bit number|Description|
|---|---|---|---|---|
|0-7|Start segment (8-bit value)|-|0-7|Actual segment (8-bit value)|
|8-15|Reserved|-| |Actual ECAM / EGEAR state machine state (4 Bit value)|
|16|Absolute (true) / relative (false) master relationship|-| |- 0: ECAM / EGEAR asynchronous
- 1: ECAM / EGEAR synchronous
|
|17|Absolute (true) / relative (false) master (CAM) relationship at cam in|-| |- 2: ECAM / EGEAR synchronizing
- 3: ECAM / EGEAR desynchronizing
|
|18|Absolute (true) / relative (false) slave (CAM) relationship at cam in|-| |- 4: ECAM / EGEAR active and waiting for going asynchronous
|
|19-23|Reserved|-| |- 5: ECAM / EGEAR inactive and waiting for going synchronous
|
|24|Change gear ratio of the electronic gear online|MCB_GearRatioChange| | |
|25|Disable master calculation|MCB_Cam_MasterEnable| | |
|26|Enable master calculation|MCB_Cam_MasterEnable| | |
|27|Select CAM table|MCB_CamTableSelect| | |
|28|Start Ecam|MCB_CamIn| | |
|29|Stop Ecam|MCB_CamOut| | |
|30|Start Egear|MCB_GearIn| | |
|31|Stop Egear|MCB_GearOut| | |

# 8.11.3 Status word for synchronized motion

|Bit|Function|PLC function|Bit number|Description|
|---|---|---|---|---|
|12-26|Reserved|-| | |
|27|ECAM / EGEAR is active|-| | |
|28|Valid segments chosen|-| | |
|29|Master data are valid|-| | |
|30|Master is initialized|-| | |
|31|Master calculation is active|-| | |

Table 8.35: Control word ECAM (P 1318[0] - MPRO_ECAM_ControlWord)

Table 8.36: ECAM status word (P 1326[0] - MPRO_ECAM_StatusWord)

MOOG ID No.:CB40859-001 Date:11/2020 MSD ServoDrive - DeviceHelp 279

# 8 Motion profile

# 8 Motion profile

MOOG ID No.:CB40859-001 Date:11/2020

MSD ServoDrive - DeviceHelp 280

# 8.11.4 Master configuration

the master encoder, you will need to set the resolution relative to a single motor revolution in P 250 - MPRO_ECAM_PARAMaster_Amplitude (see below).

- ENC CH1 (3) = Encoder channel 1 X7 (Sin/Cos)
- ENC CH2 (4) = Encoder channel 2 X6 (Resolver)
- ENC CH3 (5) = Encoder channel 3 X8 (optional)

This function is only available if an external interface X8 (option module) is present.

- TP0 (6) = Pulse counter on probe channel 0 (TP0)
- TP1 (7) = Pulse counter on probe channel 1 (TP1)
- ENC_CH4 (8) = Encoder channel 4 (p. e. fieldbus)
- TWIN_POS (9) = TWIN remote reference position (P-2607)

Image 8.72: “Master configuration” screen

# Channel selection (master encoder)

P 1319[0] - MPRO_ECAM_CamMaster_AxisType is used to define the master encoder.

- NO AXIS (0) = No axis
- VIRTUAL MASTER (1) = Virtual master

If you select this function, you will be able to configure additional settings by clicking on the enabled “Options...” button (see Section ""Virtual Master"" on page 286).

- PARA (2) = Master parameter interface

If you select this function because a higher-level controller is being used as

# Anti-reverse mode

Slave only starts moving along with it again as soon as the master reaches the zero position.

P 1320[0] - MPRO_ECAM_CamMaster_RevLockMode is used to define the reverse lock mode, which can be used either with or without path compensation. The dashed lines in the following diagrams indicate what the engagement distance is:

# Example:

If the master, which has moved two motor revolutions in the direction blocked for the slave, then moves in the unblocked direction again, the slave only moves off when the master has traversed the zero point.

- INACTIVE (0) = Reverse lock inactive
- ACTIVE (2) = Reverse lock enabled - without path optimization
- ACTIVE WAY COMP (1) = Reverse lock active - with way compensation

While the slave accelerates to the speed of the master during engagement, the master and slave do not move synchronously. This function needs to be selected in order to quickly catch up to the master that is running ahead.

# Example:

- Master (black line) rotates in the blocked direction
- The slave (blue line) remains stopped
- Master rotates in the unblocked direction again
- The slave follows the master directly in the unblocked direction

Assume the master has moved two motor revolutions in the direction for which the slave lock is enabled. If the master now moves in the direction for which there is no lock, the slave will immediately start running in that direction.

MOOG ID No.:CB40859-001 Date:11/2020

MSD ServoDrive - DeviceHelp 281

# 8 Motion profile

MOOG ID No.:CB40859-001 Date:11/2020 MSD ServoDrive - DeviceHelp 282

|Filter type|ID|Index Name|Unit|Description|
|---|---|---|---|---|
|When using a real master encoder, encoder signals may be subject to noise.|P 1340|1319|0|MPRO_ECAM_CamMaster_AxisType|
| | |MPRO_ECAM_CamMaster_SpeedFilTyp| |ECAM / EGEAR: Channel selection of internal master input|
| | |1320|0|MPRO_ECAM_CamMaster_RevLockMode|
| | |1321|0|MPRO_ECAM_CamMaster_Amplitude|
| | |1322|0|MPRO_ECAM_CamMaster_GearNum|
| | |1323|0|MPRO_ECAM_CamMaster_GearDen|
|Filter time|1327|0|ms|ECAM / EGEAR: Filter time constant of master|
|If P 1340[0] is used to enable a filter, P 1327[0] - MPRO_ECAM_CamMaster_SpeedTFil can be used to define the corresponding filter time.|1328|0|speed|ECAM / EGEAR: Speed factor of the internal master|
|Speed factor|1340|0| |MPRO_ECAM_CamMaster_SpeedFilTyp|
|The master encoder can be assigned an additional speed factor P 1328[0] - MPRO_ECAM_CamMaster_SpeedFactor.|1341|0|incr|ECAM / EGEAR: Master drive offset|

Table 8.37: “Synchronized motion - Master configuration” parameters (continue)

| | | |ID|Index Name|Unit|Description|
|---|---|---|---|---|---|---|
|247|0|MPRO_ECAM_ParaMaster_ActPos|incr|ECAM / EGEAR: Parameter interface master position| | |
|248|0|MPRO_ECAM_ParaMaster_ActSpeed|rpm|ECAM / EGEAR: Parameter interface master speed| | |
|249|0|MPRO_ECAM_ParaMaster_ActAcc|rpm|ECAM / EGEAR: Parameter interface master acceleration| | |
| |250|0|MPRO_ECAM_ParaMaster_Amplitude| |ECAM / EGEAR: Parameter interface master amplitude| |

Table 8.37: “Synchronized motion - Master configuration” parameters

# 8.11.5 Electronic gearing

# Gear ratio

The gear ratio is specified as a fraction. This ensures that the position references can be translated to the motor shaft with no rounding error.

- ""Slave"" (P 252[0] - MPRO_ECAM_Egear_GearNum) is the numerator
- ""Master"" (P 251[0] - MPRO_ECAM_Egear_GearDen) is the denominator

# Scaling of speed pre-control

Defined with P 265[0] - MPRO_ECAM_CamSlave_SpeedFactor definiert.

# Scaling of torque pre-control

Defined with P 266[0] - MPRO_ECAM_CamSlave_TorqueFactor.

# Engagement

See Section ""Engagement"" on page 284.

# Disengagement

See Section ""Disengagement"" on page 285.

|ID|Index Name|Unit|Description|
|---|---|---|---|
|251|0 MPRO_ECAM_Egear_GearDen| |EGEAR: Gear denominator|
|252|0 MPRO_ECAM_Egear_GearNum| |EGEAR: Numerator of gear ratio|
|1344|0 MPRO_ECAM_Egear_LimRefAcc|rpm/s|EGEAR: Acceleration limit for reference|
|1345|0 MPRO_ECAM_Egear_LimRefJerk|rpm/s²|EGEAR: Jerk limit for reference|

Table 8.38: “Synchronized motion - Electronic gearing” parameters

Image 8.73: ""Electronic gearing"" screen

MOOG ID No.:CB40859-001 Date:11/2020 MSD ServoDrive - DeviceHelp 283

# 8 Motion profile

# 8 Motion profile

MOOG ID No.:CB40859-001 Date:11/2020

MSD ServoDrive - DeviceHelp 284

# 8.11.6 Engagement

used to define the engagement distance (between the dashed lines).

P 253[0] - MPRO_ECAM_Egear_GearInMode is used to define the mode for engagement.

- DIRECT (0) = Direct
- Direct engagement: Angular synchronous; with jerking (no ramps).
- CROSSFADE (3) = Crossfading
- Engagement with crossfading function (5th degree polynomial): Angular synchronous; jerk-limited; speed will overshoot during engagement.
- RAMP (1) = Linear speed ramp
- Engagement with linear acceleration: Not angular synchronous; with jerking.
- FADE (2) = Engagement fade-out
- Engagement with fade-in function (5th degree polynomial): Not angular synchronous; jerk-limited. The position is ignored. ","What parameters are used to define deceleration in torque, speed, and position control modes in the 'MSD ServoDrive - DeviceHelp' document?",A2,"Deceleration is defined by P 194 in torque control, P 197 in speed control, and P 200 in position control.",2.1875,2.234375,3.609375,1.5703125,0.59375
47,msd_servo_drive.txt,76,b87ca5e232c2bdbb6fa16a8a401c6b5d285dc0183e73cc9d134de13dd2fc71d2,"MOOG ID No.:CB40859-001 Date:11/2020

MSD ServoDrive - DeviceHelp 267

# 8 Motion profile

MOOG ID No.:CB40859-001 Date:11/2020 MSD ServoDrive - DeviceHelp 268

# Deceleration

With ...

- P 194 - MPRO_TAB_TDec (for torque control) or
- P 197 - MPRO_TAB_SDec (for speed control) or
- P 200 - MPRO_TAB_PDec (for position control)

and indexes 0–15, the deceleration for each individual motion task can be defined. The input must not be zero.

# Wait time in Auto mode

P 204 - MPRO_TAB_WaitTime is used to define the wait time before the next motion task is carried out.

# Maximum table index in Auto mode

P 206[0] - MPRO_Tab_MaxIdx is used to define the table index up to which driving jobs will be carried out in one of the auto modes.

# Current table index

P 207[0] - MPRO_Tab_ActIdx will show the index for the motion task that is currently active. If parameter P 205 MPRO_TAB_Mode is set to “Para(0)”, a driving set can be entered and approached directly.

# Activation of reference table

The following procedures can be used in order to activate the setpoint table for operation.

|ID|Index Name|Unit|Description|
|---|---|---|---|
|193|MPRO_TAB_TAcc|TAB: Torque mode acceleration|Nm/ms|
|193|0|MPRO_TAB_TAcc|Nm/ms|
|193|1 - 15|MPRO_TAB_TAcc|Nm/ms|
|194|MPRO_TAB_TDec|TAB: Torque mode deceleration| |
|194|0|MPRO_TAB_TDec|Nm/ms|
|194|1 - 15|MPRO_TAB_TDec|Nm/ms|

# Table 8.23: Activation of table references

# Table 8.24: “Setpoint table settings” parameters

# Table 8.24: “Setpoint table settings” parameters (continue)

|ID|Index Name|Unit|Description|ID|Index Name|Unit|Description|
|---|---|---|---|---|---|---|---|
|195|MPRO_TAB_TRef|Nm|TAB: Torque mode reference value|208|MPRO_TAB_OutputNo| |OSD TAB: actual table index and target|
|195|MPRO_TAB_TRef|Nm| |208|MPRO_TAB_OutputNo| | |
|196|MPRO_TAB_SAcc|rev/min/s|TAB: Speed mode acceleration|269|MPRO_TAB_Ctrl| |TAB: control word|
|196|MPRO_TAB_SAcc|rev/min/s| | | | | |
|197|MPRO_TAB_SDec|rev/min/s|TAB: Speed mode deceleration| | | | |
|197|MPRO_TAB_SDec|rev/min/s| | | | | |
|198|MPRO_TAB_SRef|rev/min|TAB: Speed mode reference value| | | | |
|198|MPRO_TAB_SRef|rev/min| | | | | |
|199|MPRO_TAB_PAcc|rev/min/s|TAB: Position control mode acceleration| | | | |
|199|MPRO_TAB_PAcc|rev/min/s| | | | | |
|200|MPRO_TAB_PDec|rev/min/s|TAB: Position control mode Acceleration| | | | |
|200|MPRO_TAB_PDec|rev/min/s| | | | | |
|201|MPRO_TAB_PSpd|rev/min|TAB: Position control mode speed| | | | |
|201|MPRO_TAB_PSpd|rev/min| | | | | |
|202|MPRO_TAB_PPos|mDegree|TAB: Position control mode reference value| | | | |
|202|MPRO_TAB_PPos|mDegree| | | | | |
|203|MPRO_TAB_PMode| |Position control table:Mode| | | | |
|203|MPRO_TAB_PMode| | | | | | |
|204|MPRO_TAB_WaitTime|ms|TAB: Wait time| | | | |
|204|MPRO_TAB_WaitTime|ms| | | | | |
|205|MPRO_TAB_Mode| |TAB mode| | | | |
|206|MPRO_Tab_MaxIdx| |TAB: Max index in AUTO mode| | | | |
|207|MPRO_TAB_ActIdx| |TAB: Actual index| | | | |

MOOG ID No.:CB40859-001 Date:11/2020

MSD ServoDrive - DeviceHelp

# 8 Motion profile

MOOG ID No.:CB40859-001 Date:11/2020

MSD ServoDrive - DeviceHelp 270

# 8.8 Analog channel (ISA00 und ISA01)

# Offset (O)

This parameter (P 174 - MPRO_ANA0_SOffset for ISA00, P 184 - MPRO_ANA1_SOffset for ISA01) compensates for component variations and is used for offset compensation purposes. Depending on the control mode being used (see Section ""Basic settings"" on page 110), the value will be stored in parameter index [0] (torque control), [1] (speed control) or [2] (position control).

# Backlash (B)

This parameter (P 175 - MPRO_ANA0_SThreshold for ISA00, P 185 - MPRO_ANA1_SThreshold for ISA01) can suppress axis motion close to the standstill (stop) position. Depending on the control mode being used (see Section ""Basic settings"" on page 110), the value will be stored in parameter index [0] (torque control), [1] (speed control) or [2] (position control).

Image 8.68: “Analog channel” screen

# Acceleration ramp

Two standard analog inputs (ISA00, ISA01) are available. These inputs can be configured...

- with negative values for analog setpoint settings
- with positive values for digital setpoint processing

(P 109[0] - MPRO_INPUT_FS_ISA00 and P 110[0] - MPRO_INPUT_FS_ISA01).

see also section ""Analog Inputs"" on page 303. By using the ""REV(-2) = Analog setpoint"" setting, an analog input voltage of ±10 V can be processed as a setpoint.

# Deceleration ramp

This parameter serves as a deceleration ramp for torque control (P 176[1] - MPRO_ANA0_TRamp for ISA00, P 186[1] - MPRO_ANA1_TRamp for ISA01) or speed control (P 177[1] - MPRO_ANA0_SRamp for ISA00, P 187[1] - MPRO_ANA1_SRamp for ISA01). Depending on the control mode being used (see Section ""Basic settings"" on page 110), the value will be stored in parameter index [0] (torque control), [1] (speed control) or [2] (position control).

This parameter (P 173 - MPRO_ANA0_Scale for ISA00, P 183 - MPRO_ANA1_Scale for ISA01) is used to define which speed / which torque / which position corresponds to the maximum analog value. Depending on the control mode being used (see Section ""Basic settings"" on page 110), the value will be stored in parameter index [0] (torque control), [1] (speed control) or [2] (position control).

# 8.8.1 Special characteristics of position control mode

A threshold value can also be specified which generates a run-on range around the last reference value. A ramp function calculates a motion profile for the position reference from pre-defined acceleration and speed limits.

The position references on the analog channel are not applied immediately, but dependent on a digital input. Accordingly, one of the ISD00 to ISD06 digital inputs must be set to a value of ""REFANAEN(28) = Enable analog reference value"" (see Section ""Digital inputs"" on page 290). The position setpoint being received will only be applied if the corresponding digital input is active. The acceleration is entered using P 173[0] - MPRO_ANA0_TScale or P 183[0] - MPRO_ANA1_TScale.

# 8.8.2 Wire Break Monitoring

P 399 - CON_ANAWireBrk_Th can be used to configure wire break monitoring for the analog inputs. For details see Section ""Wire Break Monitoring"" on page 306.

|Function|TLIM (-4)|OVR (-3)|REFV (-2)|leer (-1)|OFF (0)|
|---|---|---|---|---|---|
|Digital|(1)-(28)|(1)-(28)|(1)-(28)|(1)-(28)|(1)-(28)|
|Analog channel|Filter|Scale|Offset|Profile|generator|

Control

Image 8.69: Reference processing structure

MOOG ID No.:CB40859-001 Date:11/2020

MSD ServoDrive - DeviceHelp 271

# 8 Motion profile

# 8 Motion profile

MOOG ID No.:CB40859-001 Date:11/2020

|ID|Index Name|Unit|Description|ID|
|---|---|---|---|---|
|395|CON_ANA_Isaf_Scaled| |Analog inputs: Values (filt, norm, comp, scaled)|174|
|395|0 ISA00| |Scaled, compensated, filtered, normalized value|175|
|395|1 ISA01| |Scaled, compensated, filtered, normalized value| |
|396|CON_ANA_Scale_ThUpper| |Analog inputs: Upper scaling limits|175|
|396|0 ISA00|%|Upper scaling (@ 10 V) threshold|175|
|396|1 ISA01|%|Upper scaling (@ 10 V) threshold| |
|397|CON_ANA_Scale_ThZero| |Analog inputs: Zero scaling thresholds|176|
|397|0 ISA00|V|Zero scaling threshold (+/-)|176|
|397|1 ISA01|V|Zero scaling threshold (+/-)| |
|398|CON_ANA_Scale_ThLower| |Analog inputs: Lower scaling limits|177|
|398|0 ISA00|%|Lower scaling (@ zero threshold) threshold|177|
|398|1 ISA01|%|Lower scaling (@ zero threshold) threshold| |
|399|CON_ANA_WireBrk_Th| |Analog inputs: Wire break thresholds|Table 8.26:|
|399|0 ISA00|V|Wire break detection threshold| |
|399|1 ISA01|V|Wire break detection threshold| |
|405|0 CON_ANA_Filt0|ms|Analog input ISA00: Filter time constant (PT 1)|ID|
|408|CON_ANA_Isaf_Norm| |Analog inputs: Values (filt, norm)|183|
|408|0 ISA00| |Filtered, normalized value|183|
|408|1 ISA01| |Filtered, normalized value|183|

Table 8.25: “Analog channel” parameters

|ID|Index Name|Unit|Description|ID|
|---|---|---|---|---|
|173|MPRO_ANA0_Scale| |ANA0: scale factors|184|
|173|0 MPRO_ANA0_TScale|Nm|ANA0: scale factor torque reference|185|
|173|1 MPRO_ANA0_SScale|rev/min|ANA0: scale factor speed reference|185|
|173|2 MPRO_ANA0_PScale|mDegree|ANA0: scale factor position reference| |
|174|MPRO_ANA0_Offset| |ANA0: offsets|185|
|174|0 MPRO_ANA0_TOffset|Nm|ANA0: offsets for torque reference|185|

Table 8.26: “Analog channel ISA00” parameters

|Index Name|Unit|Description|
|---|---|---|
|1 MPRO_ANA0_SOffset|rev/min|ANA0: offsets for speed reference|
|2 MPRO_ANA0_POffset|mDegree|ANA0: offsets for position reference|
|MPRO_ANA0_Threshold| |ANA0: thresholds|
|0 MPRO_ANA0_TThreshold|Nm|ANA0: threshold for torque reference|
|1 MPRO_ANA0_SThreshold|rev/min|ANA0: threshold for speed reference|
|2 MPRO_ANA0_PThreshold|mDegree|ANA0: threshold for position reference|
|MPRO_ANA0_TRamp| |ANA0: Torque mode acceleration [0] and deceleration [1]|
|0 MPRO_ANA0_TRamp|Nm/s| |
|1 MPRO_ANA0_TRamp|Nm/s| |
|MPRO_ANA0_SRamp| |ANA0: Speed mode acceleration [0] and deceleration [1]|
|0 MPRO_ANA0_SRamp|SPEED/s| |
|1 MPRO_ANA0_SRamp|SPEED/s| |

“Analog channel ISA00” parameters (continue)

|Index Name|Unit|Description|
|---|---|---|
|MPRO_ANA1_Scale| |ANA1: scale factors|
|0 MPRO_ANA1_TScale|Nm|ANA0: scale factor torque reference|
|1 MPRO_ANA1_SScale|rev/min|ANA0: scale factor speed reference|
|2 MPRO_ANA1_PScale|mDegree|ANA0: scale factor position reference|
|MPRO_ANA1_Offset| |ANA1: offsets|
|0 MPRO_ANA1_TOffset|Nm|ANA1: offsets for torque reference|
|1 MPRO_ANA1_SOffset|rev/min|ANA1: offsets for speed reference|
|2 MPRO_ANA1_POffset|mDegree|ANA1: offsets for position reference|
|MPRO_ANA1_Threshold| |ANA1: thresholds|
|0 MPRO_ANA1_TThreshold|Nm|ANA1: threshold for torque reference|
|1 MPRO_ANA1_SThreshold|rev/min|ANA1: threshold for speed reference|
|2 MPRO_ANA1_PThreshold|mDegree|ANA1: threshold for position reference|

“Analog channel ISA01” parameters

# 8 Motion profile

|ID|Index Name|Unit|Description|
|---|---|---|---|
|186|MPRO_ANA1_TRamp|Nm/s|ANA1: Torque mode acceleration [0] and deceleration[1]|
|186|MPRO_ANA1_TRamp|Nm/s| |
|187|MPRO_ANA1_SRamp|SPEED/s|ANA1: Speed mode acceleration [0] and deceleration [1]|
|187|MPRO_ANA1_SRamp|SPEED/s| |

# Table 8.27: “Analog channel ISA01” parameters (continue)

Display

- System state
- Initialization on device startup
- Not ready (DC link voltage possibly too low)
- Start inhibit (DC link voltage present, power stage off)
- Starting lockout
- Ready for start
- Control initialization: Auto commutation, flux build-up etc.

# Table 8.28: Central state machine according to CiA 402 device display

MOOG ID No.:CB40859-001 Date:11/2020

MSD ServoDrive - DeviceHelp 273

# 8 Motion profile

MOOG ID No.:CB40859-001 Date:11/2020

MSD ServoDrive - DeviceHelp 274

|Display|System state|power disabled|fault|
|---|---|---|---|
|Control enabled|0|Start|7|
| |fault reaction active|0|14|
|Quick stop active|1|not ready|8|
| |to switch on|1|17|
|Error reaction active|2|switch on|disabled|
| |2|7| |
|Error state (in this state the error is indicated directly on the display.)|3|ready to|switch on|
|Device is reset (display flashes)|power enabled|3|6|
| |10|12| |
|• Number [5.] flashes when “STO” (Safe Torque Off) input is active. Display goes out when STO inactive.| | | |
|• The dot on the display flashes when the power stage is active.| | | |

Table 8.28: Central state machine according to CiA 402 device display (continue)

NOTE

l The system states indicated on the display may differ from the states in the table depending on the drive profile setting.

Image 8.70: State machine diagram based on CANopen communications

⓪ to ① State number

1 to 17 State transition (No. 17: DC link voltage cut off)

Legend for “State machine diagram based on CANopen communications” figure

# 8.10 Touch probe

|ID|Index Name / Setting|
|---|---|
|241|0 MPRO_TP_Position|
|241|1 MPRO_TP_Position|
|241|2 MPRO_TP_Position|
|241|3 MPRO_TP_Position|
|241|4 MPRO_TP_Position|
|1400|0 MPRO_TP_Config|
| |TP_TP (0)|
| |AB (1)|
| |PD_UP (2)|
| |PD_DOWN (3)|
| |PC_PC (4)|
| |PC_TP (5)|
| |TP_PC (6)|
| |ENC_ENC (7)|
| |ENC_TP (8)|
| |TP_ENC (9)|

Using the touch probe inputs, touch probe functions can be performed. In order to be able to do this, P 106[0] - MPRO_INPUT_FS_ISD05 and P 107[0] - MPRO_INPUT_FS_ISD06 must be used to set digital inputs ISD05 and ISD06 to ""PROBE(15) = Touch probe (only ISD05/06)"" (see Section ""Digital inputs"" on page 290). HTL encoders can be evaluated or pulse counters implemented using the MSD PLC.

The touch probe can be triggered with P 240 - MPRO_TP_Ctrl. This enables triggering on a positive or negative edge, or on both edges, of the signal detected on the touch probe inputs. After the measurement, the parameter jumps back to the value ""NONE (0)"" and the latch position is mapped in the corresponding subindex of parameter P 241 - MPRO_TP_Position. A continuous touch probe mode is not possible at present, so the touch probe has to be reactivated after the measurement.

P 1402 - MPRO_TP_Channel can be used to select various positions as actual value sources of the latch position for the touch probe functionality. The following table provides an overview of the available settings. The counters are accessed via the MSD PLC or a bus system.

|ID|Index Name / Setting|Unit|Description|
|---|---|---|---|
|240|MPRO_TP_Ctrl|Touch probe: Control| |
| |0| |NONE (0) = No function|
| |1| |POS (1) = Positive edge|
| |2| |NEG (2) = Negative edge|
| |3| |BOTH (3) = Both edges|
|240|0 MPRO_TP_Ctrl| | |
|240|1 MPRO_TP_Ctrl| | |
|240|2 MPRO_TP_Ctrl| | |
|241|MPRO_TP_Position|Probe: Pos. high/low edge of TP0/1, encoder zero pulse| |

Table 8.29: “Touch probe” parameters

MOOG ID No.:CB40859-001 Date:11/2020

# 8 Motion profile

|Unit|Description|
|---|---|
|mDegree|Touch probe: Configuration|
|mDegree|TP0, TP1 touch probe|
|mDegree|TP0, TP1 as encoder, A/B as quadrature counting|
|mDegree|TP0, TP1 as encoder, pulse (TP0) / direction (TP1), count up on direction high|
|mDegree|TP0, TP1 as encoder, pulse (TP0) / direction (TP1), count down on direction high|
|mDegree|TP0 pulse counter, TP1 pulse counter|
|mDegree|TP0 pulse counter, TP1 touch probe|
|mDegree|TP1 touch probe, TP0 pulse counter|
|mDegree|TP0 encoder counter, TP1 encoder counter|
|mDegree|TP0 encoder counter, TP1 touch probe|
|mDegree|TP0 touch probe, TP1 encoder counter|

Touch probe: Channel

|Unit|Description|
|---|---|
|ACTPOS (0)|Actual position in user units|
|ACTPOSINC (1)|Actual position in increments|
|MASTERPOS (2)|Master position in increments|
|ENCPOS_CH1 (3)|Encoder position Channel 1|
|ENCPOS_CH1_INC (4)|Encoder position Channel 1 in increments|
|ENCPOS_CH2 (5)|Encoder position Channel 2|
|ENCPOS_CH2_INC (6)|Encoder position Channel 2 in increments|

# 8 Motion profile

MOOG ID No.:CB40859-001 Date:11/2020 MSD ServoDrive - DeviceHelp 276

|ID|Index Name / Setting|Unit|Description|
|---|---|---|---|
|7|ENCPOS_CH3 (7)| |Encoder position Channel 3|
|8|ENCPOS_CH3_INC (8)| |Encoder position Channel 3 in increments|
|9|ENCPOS_CH4 (9)| |Encoder position Channel 4|
|10|ENCPOS_CH4_INC (10)| |Encoder position Channel 4 in increments|
|11|ACTPOS2 (11)| |Actual position of redundant encoder in user units|
|12|Sercos (12)| |Referred to Sercos profile parameters S-x-0426, S-x-0427|
|13|UserRefPos(13)| |Reference position in user units|
|14|MasterPosST(14)| |Master position (ECAM, EGEAR) singleturn, always steps|
|15|CommonMasterPos(15)| |Master position (ECAM, EGEAR) singleturn, always steps|
|16|CommonMasterPosST(15)| |Master position (ECAM, EGEAR) singleturn, always steps|
|1402|MPRO_TP_Channel| | |
|1402|MPRO_TP_Channel| | |
|1402|MPRO_TP_Channel| | |
|1404|MPRO_TP_Lines| |Touch probe: Lines @ pulse counter on channel x|
|1404|MPRO_TP_Lines| | |
|1404|MPRO_TP_Lines| | |

Image 8.71: “Synchronized motion” screen

There are various modes available in the “synchronization mode” drop-down menu (P 242[0] - MPRO_ECAM_SyncModMode):

- Off(0) = Synchronized motion off
- ECAM_iPlc(1) = Electronic cam plate via MSD PLC
- EGEAR_iPlc(2) = Electr. gear unit via MSD PLC
- ECAM_PARA(3) = Electronic camming via parameters
- EGEAR_PARA(4) = Electronic gearing via parameters

NOTE: For more information refer to the bus system User Manuals or the description of the MSD PLC.

# 8.11.1 Electronic cam plate

The other parameters are configured in separate screens that can be accessed with the corresponding buttons.

- Master configuration (see Section ""Master configuration"" on page 280)
- Electronic gearing (see Section ""Electronic gearing"" on page 283)
- Electronic camming (see Section ""Electronic cam plate"" on page 277)

P 1318[0] - MPRO_ECAM_ControlWord is the control word for “synchronized motion” (see Section ""Control word for synchronized motion"" on page 279).

P 1326[0] - MPRO_ECAM_StatusWord is the status word for “synchronized motion” (see Section ""Status word for synchronized motion"" on page 279).

# 8.11.1.1 Table selection

|ID|Index Name|Unit|Description|
|---|---|---|---|
|1300|MPRO_ECAM_CTS_| |ECAM: CamTableSelect - Master reference|
|1301|MasterRef| | |
|1305|MPRO_ECAM_CTS_| |ECAM: CamTableSelect - Method for changing the camtable|
|1306|MPRO_ECAM_CTS_| |ECAM: CamTableSelect - Mode for changing the camtable|
|1307|MPRO_ECAM_CTS_|incr|ECAM: CamTableSelect - Distance for changing the camtable|
|242|MPRO_ECAM_| |ECAM / EGEAR: Mode of synchronized motion SyncModMode|
|265|MPRO_ECAM_| |ECAM / EGEAR: Slave speed factor (1 = 100%).|
|266|CamSlave_SpeedFactor| | |
|268|MPRO_ECAM_| |ECAM / EGEAR: Mode of switching off sync. motion|

# 8.11.1.2 Synchronization

|ID|Index Name|Unit|Description|
|---|---|---|---|
|1342|MPRO_ECAM_CI_|incr|ECAM: CamIn - Synchronization position (multiturn part)|
|1343|MPRO_ECAM_CO_|incr|ECAM: CamOut - Decoupling pos. (multiturn part)|
|1303|MPRO_ECAM_CI_|incr|ECAM: CamIn - Master offset|
|1308|MPRO_ECAM_CI_| |ECAM: CamIn - Master reference|
|1309|MPRO_ECAM_CI_| |ECAM: CamIn - Slave reference|
|1310|MPRO_ECAM_CI_| |ECAM: CamIn - Coupling mode|
|1311|MPRO_ECAM_CI_|incr|ECAM: CamIn - Coupling distance|
|1312|MPRO_ECAM_CI_|incr|ECAM: CamIn - Synchronization position|

Table 8.31: “Electronic camming - Table selection” parameters

Table 8.30: “Synchronized motion” parameters

Table 8.32: “Electronic camming - Synchronization” parameters

MOOG ID No.:CB40859-001 Date:11/2020

MSD ServoDrive - DeviceHelp 277

# 8 Motion profile

MOOG ID No.:CB40859-001 Date:11/2020 MSD ServoDrive - DeviceHelp 278

|ID|Index|Name|Unit|Description|
|---|---|---|---|---|
|1313|0|MPRO_ECAM_CO_SyncPosST|(singleturn part)|ECAM: CamOut - Slave reference|
|1314|0|MPRO_ECAM_CO_DecouplingMode|63|ECAM: CamOut - Decoupling mode|
|1315|0|MPRO_ECAM_CO_BreakingPosST|incr|ECAM: CamOut - Decoupling position|
|1316|0|MPRO_ECAM_CO_DecouplingDist|incr|ECAM: CamOut - Decoupling distance|
|1317|0|MPRO_ECAM_CO_StandstillPos|mDegree|ECAM: CamOut - Slave standstill position|

# Table 8.32: “Electronic camming - Synchronization” parameters (continue)

|ID|Index|Name|Unit|Description|
|---|---|---|---|---|
|1346| |MPRO_ECAM_SP_Table| |ECAM: Setpoint table interface|
|1346|0|Index| |Index of setpoint table|
|1346|1|Value| |Value at index of setpoint table|
|1347|0 to 31|MPRO_ECAM_SP_Index| |ECAM: Setpoint segments start index|
|1348|0 to 31|MPRO_ECAM_SP_Length| |ECAM: Setpoint segments length|
|1349|0 to 31|Length| | |
|1350|0|MPRO_ECAM_SP_MaDist| |ECAM: Setpoint segments master distance|
|1351|0|MPRO_ECAM_SP_IpoType| |ECAM: Setpoint segments interpolation type|
|1352|0 to 31|Checksum| |ECAM: Setpoint table checksum|
|1353|0 to 31|GainNum| |ECAM: Setpoint segments gain numerator|
| | |GainDen| |ECAM: Setpoint segments gain denominator|

# Table 8.33: “Electronic camming - Table segments” parameters

|ID|Index|Name|Unit|Description|
|---|---|---|---|---|
|1329|0 to 63|MPRO_ECAM_SegData_IndexNext| |ECAM: Index of the following segment|
|1330|0 to 63|MPRO_ECAM_SegData_IndexPrev| |ECAM: Index of the previous segment|
|1331|0 to 63|MPRO_ECAM_SegData_ProfileMode| |ECAM: Profile mode of the current segment|
|1332|0 to 63|MPRO_ECAM_SegData_DistMaster| |ECAM: Length of the master section of the current segment|
|1333|0 to 63|MPRO_ECAM_SegData_DistSlave| |ECAM: Length of the slave section of the current segment|
|1334|0 to 63|MPRO_ECAM_SegData_Lambda| |ECAM: Lambda value of the current segment|
|1335|0 to 63|MPRO_ECAM_SegData_StatusWord| |ECAM: Status word of the current segment|
|1336|0 to 63|MPRO_ECAM_SegData_ControlWord| |ECAM: Control word of the current segment|

# 8.11.2 Control word for synchronized motion

|Bit|Function|PLC function|Bit number|Description|
|---|---|---|---|---|
|0-7|Start segment (8-bit value)|-|0-7|Actual segment (8-bit value)|
|8-15|Reserved|-| |Actual ECAM / EGEAR state machine state (4 Bit value)|
|16|Absolute (true) / relative (false) master relationship|-| |- 0: ECAM / EGEAR asynchronous
- 1: ECAM / EGEAR synchronous
|
|17|Absolute (true) / relative (false) master (CAM) relationship at cam in|-| |- 2: ECAM / EGEAR synchronizing
- 3: ECAM / EGEAR desynchronizing
|
|18|Absolute (true) / relative (false) slave (CAM) relationship at cam in|-| |- 4: ECAM / EGEAR active and waiting for going asynchronous
|
|19-23|Reserved|-| |- 5: ECAM / EGEAR inactive and waiting for going synchronous
|
|24|Change gear ratio of the electronic gear online|MCB_GearRatioChange| | |
|25|Disable master calculation|MCB_Cam_MasterEnable| | |
|26|Enable master calculation|MCB_Cam_MasterEnable| | |
|27|Select CAM table|MCB_CamTableSelect| | |
|28|Start Ecam|MCB_CamIn| | |
|29|Stop Ecam|MCB_CamOut| | |
|30|Start Egear|MCB_GearIn| | |
|31|Stop Egear|MCB_GearOut| | |

# 8.11.3 Status word for synchronized motion

|Bit|Function|PLC function|Bit number|Description|
|---|---|---|---|---|
|12-26|Reserved|-| | |
|27|ECAM / EGEAR is active|-| | |
|28|Valid segments chosen|-| | |
|29|Master data are valid|-| | |
|30|Master is initialized|-| | |
|31|Master calculation is active|-| | |

Table 8.35: Control word ECAM (P 1318[0] - MPRO_ECAM_ControlWord)

Table 8.36: ECAM status word (P 1326[0] - MPRO_ECAM_StatusWord)

MOOG ID No.:CB40859-001 Date:11/2020 MSD ServoDrive - DeviceHelp 279

# 8 Motion profile

# 8 Motion profile

MOOG ID No.:CB40859-001 Date:11/2020

MSD ServoDrive - DeviceHelp 280

# 8.11.4 Master configuration

the master encoder, you will need to set the resolution relative to a single motor revolution in P 250 - MPRO_ECAM_PARAMaster_Amplitude (see below).

- ENC CH1 (3) = Encoder channel 1 X7 (Sin/Cos)
- ENC CH2 (4) = Encoder channel 2 X6 (Resolver)
- ENC CH3 (5) = Encoder channel 3 X8 (optional)

This function is only available if an external interface X8 (option module) is present.

- TP0 (6) = Pulse counter on probe channel 0 (TP0)
- TP1 (7) = Pulse counter on probe channel 1 (TP1)
- ENC_CH4 (8) = Encoder channel 4 (p. e. fieldbus)
- TWIN_POS (9) = TWIN remote reference position (P-2607)

Image 8.72: “Master configuration” screen

# Channel selection (master encoder)

P 1319[0] - MPRO_ECAM_CamMaster_AxisType is used to define the master encoder.

- NO AXIS (0) = No axis
- VIRTUAL MASTER (1) = Virtual master

If you select this function, you will be able to configure additional settings by clicking on the enabled “Options...” button (see Section ""Virtual Master"" on page 286).

- PARA (2) = Master parameter interface

If you select this function because a higher-level controller is being used as

# Anti-reverse mode

Slave only starts moving along with it again as soon as the master reaches the zero position.

P 1320[0] - MPRO_ECAM_CamMaster_RevLockMode is used to define the reverse lock mode, which can be used either with or without path compensation. The dashed lines in the following diagrams indicate what the engagement distance is:

# Example:

If the master, which has moved two motor revolutions in the direction blocked for the slave, then moves in the unblocked direction again, the slave only moves off when the master has traversed the zero point.

- INACTIVE (0) = Reverse lock inactive
- ACTIVE (2) = Reverse lock enabled - without path optimization
- ACTIVE WAY COMP (1) = Reverse lock active - with way compensation

While the slave accelerates to the speed of the master during engagement, the master and slave do not move synchronously. This function needs to be selected in order to quickly catch up to the master that is running ahead.

# Example:

- Master (black line) rotates in the blocked direction
- The slave (blue line) remains stopped
- Master rotates in the unblocked direction again
- The slave follows the master directly in the unblocked direction

Assume the master has moved two motor revolutions in the direction for which the slave lock is enabled. If the master now moves in the direction for which there is no lock, the slave will immediately start running in that direction.

MOOG ID No.:CB40859-001 Date:11/2020

MSD ServoDrive - DeviceHelp 281

# 8 Motion profile

MOOG ID No.:CB40859-001 Date:11/2020 MSD ServoDrive - DeviceHelp 282

|Filter type|ID|Index Name|Unit|Description|
|---|---|---|---|---|
|When using a real master encoder, encoder signals may be subject to noise.|P 1340|1319|0|MPRO_ECAM_CamMaster_AxisType|
| | |MPRO_ECAM_CamMaster_SpeedFilTyp| |ECAM / EGEAR: Channel selection of internal master input|
| | |1320|0|MPRO_ECAM_CamMaster_RevLockMode|
| | |1321|0|MPRO_ECAM_CamMaster_Amplitude|
| | |1322|0|MPRO_ECAM_CamMaster_GearNum|
| | |1323|0|MPRO_ECAM_CamMaster_GearDen|
|Filter time|1327|0|ms|ECAM / EGEAR: Filter time constant of master|
|If P 1340[0] is used to enable a filter, P 1327[0] - MPRO_ECAM_CamMaster_SpeedTFil can be used to define the corresponding filter time.|1328|0|speed|ECAM / EGEAR: Speed factor of the internal master|
|Speed factor|1340|0| |MPRO_ECAM_CamMaster_SpeedFilTyp|
|The master encoder can be assigned an additional speed factor P 1328[0] - MPRO_ECAM_CamMaster_SpeedFactor.|1341|0|incr|ECAM / EGEAR: Master drive offset|

Table 8.37: “Synchronized motion - Master configuration” parameters (continue)

| | | |ID|Index Name|Unit|Description|
|---|---|---|---|---|---|---|
|247|0|MPRO_ECAM_ParaMaster_ActPos|incr|ECAM / EGEAR: Parameter interface master position| | |
|248|0|MPRO_ECAM_ParaMaster_ActSpeed|rpm|ECAM / EGEAR: Parameter interface master speed| | |
|249|0|MPRO_ECAM_ParaMaster_ActAcc|rpm|ECAM / EGEAR: Parameter interface master acceleration| | |
| |250|0|MPRO_ECAM_ParaMaster_Amplitude| |ECAM / EGEAR: Parameter interface master amplitude| |

Table 8.37: “Synchronized motion - Master configuration” parameters

# 8.11.5 Electronic gearing

# Gear ratio

The gear ratio is specified as a fraction. This ensures that the position references can be translated to the motor shaft with no rounding error.

- ""Slave"" (P 252[0] - MPRO_ECAM_Egear_GearNum) is the numerator
- ""Master"" (P 251[0] - MPRO_ECAM_Egear_GearDen) is the denominator

# Scaling of speed pre-control

Defined with P 265[0] - MPRO_ECAM_CamSlave_SpeedFactor definiert.

# Scaling of torque pre-control

Defined with P 266[0] - MPRO_ECAM_CamSlave_TorqueFactor.

# Engagement

See Section ""Engagement"" on page 284.

# Disengagement

See Section ""Disengagement"" on page 285.

|ID|Index Name|Unit|Description|
|---|---|---|---|
|251|0 MPRO_ECAM_Egear_GearDen| |EGEAR: Gear denominator|
|252|0 MPRO_ECAM_Egear_GearNum| |EGEAR: Numerator of gear ratio|
|1344|0 MPRO_ECAM_Egear_LimRefAcc|rpm/s|EGEAR: Acceleration limit for reference|
|1345|0 MPRO_ECAM_Egear_LimRefJerk|rpm/s²|EGEAR: Jerk limit for reference|

Table 8.38: “Synchronized motion - Electronic gearing” parameters

Image 8.73: ""Electronic gearing"" screen

MOOG ID No.:CB40859-001 Date:11/2020 MSD ServoDrive - DeviceHelp 283

# 8 Motion profile

# 8 Motion profile

MOOG ID No.:CB40859-001 Date:11/2020

MSD ServoDrive - DeviceHelp 284

# 8.11.6 Engagement

used to define the engagement distance (between the dashed lines).

P 253[0] - MPRO_ECAM_Egear_GearInMode is used to define the mode for engagement.

- DIRECT (0) = Direct
- Direct engagement: Angular synchronous; with jerking (no ramps).
- CROSSFADE (3) = Crossfading
- Engagement with crossfading function (5th degree polynomial): Angular synchronous; jerk-limited; speed will overshoot during engagement.
- RAMP (1) = Linear speed ramp
- Engagement with linear acceleration: Not angular synchronous; with jerking.
- FADE (2) = Engagement fade-out
- Engagement with fade-in function (5th degree polynomial): Not angular synchronous; jerk-limited. The position is ignored. ","What parameters are used to define deceleration in torque, speed, and position control modes in the 'MSD ServoDrive - DeviceHelp' document?",A3,"For torque control, use P 194; for speed control, P 197; and for position control, P 200 to set deceleration.",2.171875,2.265625,3.703125,1.4375,0.5
48,msd_servo_drive.txt,76,b87ca5e232c2bdbb6fa16a8a401c6b5d285dc0183e73cc9d134de13dd2fc71d2,"MOOG ID No.:CB40859-001 Date:11/2020

MSD ServoDrive - DeviceHelp 267

# 8 Motion profile

MOOG ID No.:CB40859-001 Date:11/2020 MSD ServoDrive - DeviceHelp 268

# Deceleration

With ...

- P 194 - MPRO_TAB_TDec (for torque control) or
- P 197 - MPRO_TAB_SDec (for speed control) or
- P 200 - MPRO_TAB_PDec (for position control)

and indexes 0–15, the deceleration for each individual motion task can be defined. The input must not be zero.

# Wait time in Auto mode

P 204 - MPRO_TAB_WaitTime is used to define the wait time before the next motion task is carried out.

# Maximum table index in Auto mode

P 206[0] - MPRO_Tab_MaxIdx is used to define the table index up to which driving jobs will be carried out in one of the auto modes.

# Current table index

P 207[0] - MPRO_Tab_ActIdx will show the index for the motion task that is currently active. If parameter P 205 MPRO_TAB_Mode is set to “Para(0)”, a driving set can be entered and approached directly.

# Activation of reference table

The following procedures can be used in order to activate the setpoint table for operation.

|ID|Index Name|Unit|Description|
|---|---|---|---|
|193|MPRO_TAB_TAcc|TAB: Torque mode acceleration|Nm/ms|
|193|0|MPRO_TAB_TAcc|Nm/ms|
|193|1 - 15|MPRO_TAB_TAcc|Nm/ms|
|194|MPRO_TAB_TDec|TAB: Torque mode deceleration| |
|194|0|MPRO_TAB_TDec|Nm/ms|
|194|1 - 15|MPRO_TAB_TDec|Nm/ms|

# Table 8.23: Activation of table references

# Table 8.24: “Setpoint table settings” parameters

# Table 8.24: “Setpoint table settings” parameters (continue)

|ID|Index Name|Unit|Description|ID|Index Name|Unit|Description|
|---|---|---|---|---|---|---|---|
|195|MPRO_TAB_TRef|Nm|TAB: Torque mode reference value|208|MPRO_TAB_OutputNo| |OSD TAB: actual table index and target|
|195|MPRO_TAB_TRef|Nm| |208|MPRO_TAB_OutputNo| | |
|196|MPRO_TAB_SAcc|rev/min/s|TAB: Speed mode acceleration|269|MPRO_TAB_Ctrl| |TAB: control word|
|196|MPRO_TAB_SAcc|rev/min/s| | | | | |
|197|MPRO_TAB_SDec|rev/min/s|TAB: Speed mode deceleration| | | | |
|197|MPRO_TAB_SDec|rev/min/s| | | | | |
|198|MPRO_TAB_SRef|rev/min|TAB: Speed mode reference value| | | | |
|198|MPRO_TAB_SRef|rev/min| | | | | |
|199|MPRO_TAB_PAcc|rev/min/s|TAB: Position control mode acceleration| | | | |
|199|MPRO_TAB_PAcc|rev/min/s| | | | | |
|200|MPRO_TAB_PDec|rev/min/s|TAB: Position control mode Acceleration| | | | |
|200|MPRO_TAB_PDec|rev/min/s| | | | | |
|201|MPRO_TAB_PSpd|rev/min|TAB: Position control mode speed| | | | |
|201|MPRO_TAB_PSpd|rev/min| | | | | |
|202|MPRO_TAB_PPos|mDegree|TAB: Position control mode reference value| | | | |
|202|MPRO_TAB_PPos|mDegree| | | | | |
|203|MPRO_TAB_PMode| |Position control table:Mode| | | | |
|203|MPRO_TAB_PMode| | | | | | |
|204|MPRO_TAB_WaitTime|ms|TAB: Wait time| | | | |
|204|MPRO_TAB_WaitTime|ms| | | | | |
|205|MPRO_TAB_Mode| |TAB mode| | | | |
|206|MPRO_Tab_MaxIdx| |TAB: Max index in AUTO mode| | | | |
|207|MPRO_TAB_ActIdx| |TAB: Actual index| | | | |

MOOG ID No.:CB40859-001 Date:11/2020

MSD ServoDrive - DeviceHelp

# 8 Motion profile

MOOG ID No.:CB40859-001 Date:11/2020

MSD ServoDrive - DeviceHelp 270

# 8.8 Analog channel (ISA00 und ISA01)

# Offset (O)

This parameter (P 174 - MPRO_ANA0_SOffset for ISA00, P 184 - MPRO_ANA1_SOffset for ISA01) compensates for component variations and is used for offset compensation purposes. Depending on the control mode being used (see Section ""Basic settings"" on page 110), the value will be stored in parameter index [0] (torque control), [1] (speed control) or [2] (position control).

# Backlash (B)

This parameter (P 175 - MPRO_ANA0_SThreshold for ISA00, P 185 - MPRO_ANA1_SThreshold for ISA01) can suppress axis motion close to the standstill (stop) position. Depending on the control mode being used (see Section ""Basic settings"" on page 110), the value will be stored in parameter index [0] (torque control), [1] (speed control) or [2] (position control).

Image 8.68: “Analog channel” screen

# Acceleration ramp

Two standard analog inputs (ISA00, ISA01) are available. These inputs can be configured...

- with negative values for analog setpoint settings
- with positive values for digital setpoint processing

(P 109[0] - MPRO_INPUT_FS_ISA00 and P 110[0] - MPRO_INPUT_FS_ISA01).

see also section ""Analog Inputs"" on page 303. By using the ""REV(-2) = Analog setpoint"" setting, an analog input voltage of ±10 V can be processed as a setpoint.

# Deceleration ramp

This parameter serves as a deceleration ramp for torque control (P 176[1] - MPRO_ANA0_TRamp for ISA00, P 186[1] - MPRO_ANA1_TRamp for ISA01) or speed control (P 177[1] - MPRO_ANA0_SRamp for ISA00, P 187[1] - MPRO_ANA1_SRamp for ISA01). Depending on the control mode being used (see Section ""Basic settings"" on page 110), the value will be stored in parameter index [0] (torque control), [1] (speed control) or [2] (position control).

This parameter (P 173 - MPRO_ANA0_Scale for ISA00, P 183 - MPRO_ANA1_Scale for ISA01) is used to define which speed / which torque / which position corresponds to the maximum analog value. Depending on the control mode being used (see Section ""Basic settings"" on page 110), the value will be stored in parameter index [0] (torque control), [1] (speed control) or [2] (position control).

# 8.8.1 Special characteristics of position control mode

A threshold value can also be specified which generates a run-on range around the last reference value. A ramp function calculates a motion profile for the position reference from pre-defined acceleration and speed limits.

The position references on the analog channel are not applied immediately, but dependent on a digital input. Accordingly, one of the ISD00 to ISD06 digital inputs must be set to a value of ""REFANAEN(28) = Enable analog reference value"" (see Section ""Digital inputs"" on page 290). The position setpoint being received will only be applied if the corresponding digital input is active. The acceleration is entered using P 173[0] - MPRO_ANA0_TScale or P 183[0] - MPRO_ANA1_TScale.

# 8.8.2 Wire Break Monitoring

P 399 - CON_ANAWireBrk_Th can be used to configure wire break monitoring for the analog inputs. For details see Section ""Wire Break Monitoring"" on page 306.

|Function|TLIM (-4)|OVR (-3)|REFV (-2)|leer (-1)|OFF (0)|
|---|---|---|---|---|---|
|Digital|(1)-(28)|(1)-(28)|(1)-(28)|(1)-(28)|(1)-(28)|
|Analog channel|Filter|Scale|Offset|Profile|generator|

Control

Image 8.69: Reference processing structure

MOOG ID No.:CB40859-001 Date:11/2020

MSD ServoDrive - DeviceHelp 271

# 8 Motion profile

# 8 Motion profile

MOOG ID No.:CB40859-001 Date:11/2020

|ID|Index Name|Unit|Description|ID|
|---|---|---|---|---|
|395|CON_ANA_Isaf_Scaled| |Analog inputs: Values (filt, norm, comp, scaled)|174|
|395|0 ISA00| |Scaled, compensated, filtered, normalized value|175|
|395|1 ISA01| |Scaled, compensated, filtered, normalized value| |
|396|CON_ANA_Scale_ThUpper| |Analog inputs: Upper scaling limits|175|
|396|0 ISA00|%|Upper scaling (@ 10 V) threshold|175|
|396|1 ISA01|%|Upper scaling (@ 10 V) threshold| |
|397|CON_ANA_Scale_ThZero| |Analog inputs: Zero scaling thresholds|176|
|397|0 ISA00|V|Zero scaling threshold (+/-)|176|
|397|1 ISA01|V|Zero scaling threshold (+/-)| |
|398|CON_ANA_Scale_ThLower| |Analog inputs: Lower scaling limits|177|
|398|0 ISA00|%|Lower scaling (@ zero threshold) threshold|177|
|398|1 ISA01|%|Lower scaling (@ zero threshold) threshold| |
|399|CON_ANA_WireBrk_Th| |Analog inputs: Wire break thresholds|Table 8.26:|
|399|0 ISA00|V|Wire break detection threshold| |
|399|1 ISA01|V|Wire break detection threshold| |
|405|0 CON_ANA_Filt0|ms|Analog input ISA00: Filter time constant (PT 1)|ID|
|408|CON_ANA_Isaf_Norm| |Analog inputs: Values (filt, norm)|183|
|408|0 ISA00| |Filtered, normalized value|183|
|408|1 ISA01| |Filtered, normalized value|183|

Table 8.25: “Analog channel” parameters

|ID|Index Name|Unit|Description|ID|
|---|---|---|---|---|
|173|MPRO_ANA0_Scale| |ANA0: scale factors|184|
|173|0 MPRO_ANA0_TScale|Nm|ANA0: scale factor torque reference|185|
|173|1 MPRO_ANA0_SScale|rev/min|ANA0: scale factor speed reference|185|
|173|2 MPRO_ANA0_PScale|mDegree|ANA0: scale factor position reference| |
|174|MPRO_ANA0_Offset| |ANA0: offsets|185|
|174|0 MPRO_ANA0_TOffset|Nm|ANA0: offsets for torque reference|185|

Table 8.26: “Analog channel ISA00” parameters

|Index Name|Unit|Description|
|---|---|---|
|1 MPRO_ANA0_SOffset|rev/min|ANA0: offsets for speed reference|
|2 MPRO_ANA0_POffset|mDegree|ANA0: offsets for position reference|
|MPRO_ANA0_Threshold| |ANA0: thresholds|
|0 MPRO_ANA0_TThreshold|Nm|ANA0: threshold for torque reference|
|1 MPRO_ANA0_SThreshold|rev/min|ANA0: threshold for speed reference|
|2 MPRO_ANA0_PThreshold|mDegree|ANA0: threshold for position reference|
|MPRO_ANA0_TRamp| |ANA0: Torque mode acceleration [0] and deceleration [1]|
|0 MPRO_ANA0_TRamp|Nm/s| |
|1 MPRO_ANA0_TRamp|Nm/s| |
|MPRO_ANA0_SRamp| |ANA0: Speed mode acceleration [0] and deceleration [1]|
|0 MPRO_ANA0_SRamp|SPEED/s| |
|1 MPRO_ANA0_SRamp|SPEED/s| |

“Analog channel ISA00” parameters (continue)

|Index Name|Unit|Description|
|---|---|---|
|MPRO_ANA1_Scale| |ANA1: scale factors|
|0 MPRO_ANA1_TScale|Nm|ANA0: scale factor torque reference|
|1 MPRO_ANA1_SScale|rev/min|ANA0: scale factor speed reference|
|2 MPRO_ANA1_PScale|mDegree|ANA0: scale factor position reference|
|MPRO_ANA1_Offset| |ANA1: offsets|
|0 MPRO_ANA1_TOffset|Nm|ANA1: offsets for torque reference|
|1 MPRO_ANA1_SOffset|rev/min|ANA1: offsets for speed reference|
|2 MPRO_ANA1_POffset|mDegree|ANA1: offsets for position reference|
|MPRO_ANA1_Threshold| |ANA1: thresholds|
|0 MPRO_ANA1_TThreshold|Nm|ANA1: threshold for torque reference|
|1 MPRO_ANA1_SThreshold|rev/min|ANA1: threshold for speed reference|
|2 MPRO_ANA1_PThreshold|mDegree|ANA1: threshold for position reference|

“Analog channel ISA01” parameters

# 8 Motion profile

|ID|Index Name|Unit|Description|
|---|---|---|---|
|186|MPRO_ANA1_TRamp|Nm/s|ANA1: Torque mode acceleration [0] and deceleration[1]|
|186|MPRO_ANA1_TRamp|Nm/s| |
|187|MPRO_ANA1_SRamp|SPEED/s|ANA1: Speed mode acceleration [0] and deceleration [1]|
|187|MPRO_ANA1_SRamp|SPEED/s| |

# Table 8.27: “Analog channel ISA01” parameters (continue)

Display

- System state
- Initialization on device startup
- Not ready (DC link voltage possibly too low)
- Start inhibit (DC link voltage present, power stage off)
- Starting lockout
- Ready for start
- Control initialization: Auto commutation, flux build-up etc.

# Table 8.28: Central state machine according to CiA 402 device display

MOOG ID No.:CB40859-001 Date:11/2020

MSD ServoDrive - DeviceHelp 273

# 8 Motion profile

MOOG ID No.:CB40859-001 Date:11/2020

MSD ServoDrive - DeviceHelp 274

|Display|System state|power disabled|fault|
|---|---|---|---|
|Control enabled|0|Start|7|
| |fault reaction active|0|14|
|Quick stop active|1|not ready|8|
| |to switch on|1|17|
|Error reaction active|2|switch on|disabled|
| |2|7| |
|Error state (in this state the error is indicated directly on the display.)|3|ready to|switch on|
|Device is reset (display flashes)|power enabled|3|6|
| |10|12| |
|• Number [5.] flashes when “STO” (Safe Torque Off) input is active. Display goes out when STO inactive.| | | |
|• The dot on the display flashes when the power stage is active.| | | |

Table 8.28: Central state machine according to CiA 402 device display (continue)

NOTE

l The system states indicated on the display may differ from the states in the table depending on the drive profile setting.

Image 8.70: State machine diagram based on CANopen communications

⓪ to ① State number

1 to 17 State transition (No. 17: DC link voltage cut off)

Legend for “State machine diagram based on CANopen communications” figure

# 8.10 Touch probe

|ID|Index Name / Setting|
|---|---|
|241|0 MPRO_TP_Position|
|241|1 MPRO_TP_Position|
|241|2 MPRO_TP_Position|
|241|3 MPRO_TP_Position|
|241|4 MPRO_TP_Position|
|1400|0 MPRO_TP_Config|
| |TP_TP (0)|
| |AB (1)|
| |PD_UP (2)|
| |PD_DOWN (3)|
| |PC_PC (4)|
| |PC_TP (5)|
| |TP_PC (6)|
| |ENC_ENC (7)|
| |ENC_TP (8)|
| |TP_ENC (9)|

Using the touch probe inputs, touch probe functions can be performed. In order to be able to do this, P 106[0] - MPRO_INPUT_FS_ISD05 and P 107[0] - MPRO_INPUT_FS_ISD06 must be used to set digital inputs ISD05 and ISD06 to ""PROBE(15) = Touch probe (only ISD05/06)"" (see Section ""Digital inputs"" on page 290). HTL encoders can be evaluated or pulse counters implemented using the MSD PLC.

The touch probe can be triggered with P 240 - MPRO_TP_Ctrl. This enables triggering on a positive or negative edge, or on both edges, of the signal detected on the touch probe inputs. After the measurement, the parameter jumps back to the value ""NONE (0)"" and the latch position is mapped in the corresponding subindex of parameter P 241 - MPRO_TP_Position. A continuous touch probe mode is not possible at present, so the touch probe has to be reactivated after the measurement.

P 1402 - MPRO_TP_Channel can be used to select various positions as actual value sources of the latch position for the touch probe functionality. The following table provides an overview of the available settings. The counters are accessed via the MSD PLC or a bus system.

|ID|Index Name / Setting|Unit|Description|
|---|---|---|---|
|240|MPRO_TP_Ctrl|Touch probe: Control| |
| |0| |NONE (0) = No function|
| |1| |POS (1) = Positive edge|
| |2| |NEG (2) = Negative edge|
| |3| |BOTH (3) = Both edges|
|240|0 MPRO_TP_Ctrl| | |
|240|1 MPRO_TP_Ctrl| | |
|240|2 MPRO_TP_Ctrl| | |
|241|MPRO_TP_Position|Probe: Pos. high/low edge of TP0/1, encoder zero pulse| |

Table 8.29: “Touch probe” parameters

MOOG ID No.:CB40859-001 Date:11/2020

# 8 Motion profile

|Unit|Description|
|---|---|
|mDegree|Touch probe: Configuration|
|mDegree|TP0, TP1 touch probe|
|mDegree|TP0, TP1 as encoder, A/B as quadrature counting|
|mDegree|TP0, TP1 as encoder, pulse (TP0) / direction (TP1), count up on direction high|
|mDegree|TP0, TP1 as encoder, pulse (TP0) / direction (TP1), count down on direction high|
|mDegree|TP0 pulse counter, TP1 pulse counter|
|mDegree|TP0 pulse counter, TP1 touch probe|
|mDegree|TP1 touch probe, TP0 pulse counter|
|mDegree|TP0 encoder counter, TP1 encoder counter|
|mDegree|TP0 encoder counter, TP1 touch probe|
|mDegree|TP0 touch probe, TP1 encoder counter|

Touch probe: Channel

|Unit|Description|
|---|---|
|ACTPOS (0)|Actual position in user units|
|ACTPOSINC (1)|Actual position in increments|
|MASTERPOS (2)|Master position in increments|
|ENCPOS_CH1 (3)|Encoder position Channel 1|
|ENCPOS_CH1_INC (4)|Encoder position Channel 1 in increments|
|ENCPOS_CH2 (5)|Encoder position Channel 2|
|ENCPOS_CH2_INC (6)|Encoder position Channel 2 in increments|

# 8 Motion profile

MOOG ID No.:CB40859-001 Date:11/2020 MSD ServoDrive - DeviceHelp 276

|ID|Index Name / Setting|Unit|Description|
|---|---|---|---|
|7|ENCPOS_CH3 (7)| |Encoder position Channel 3|
|8|ENCPOS_CH3_INC (8)| |Encoder position Channel 3 in increments|
|9|ENCPOS_CH4 (9)| |Encoder position Channel 4|
|10|ENCPOS_CH4_INC (10)| |Encoder position Channel 4 in increments|
|11|ACTPOS2 (11)| |Actual position of redundant encoder in user units|
|12|Sercos (12)| |Referred to Sercos profile parameters S-x-0426, S-x-0427|
|13|UserRefPos(13)| |Reference position in user units|
|14|MasterPosST(14)| |Master position (ECAM, EGEAR) singleturn, always steps|
|15|CommonMasterPos(15)| |Master position (ECAM, EGEAR) singleturn, always steps|
|16|CommonMasterPosST(15)| |Master position (ECAM, EGEAR) singleturn, always steps|
|1402|MPRO_TP_Channel| | |
|1402|MPRO_TP_Channel| | |
|1402|MPRO_TP_Channel| | |
|1404|MPRO_TP_Lines| |Touch probe: Lines @ pulse counter on channel x|
|1404|MPRO_TP_Lines| | |
|1404|MPRO_TP_Lines| | |

Image 8.71: “Synchronized motion” screen

There are various modes available in the “synchronization mode” drop-down menu (P 242[0] - MPRO_ECAM_SyncModMode):

- Off(0) = Synchronized motion off
- ECAM_iPlc(1) = Electronic cam plate via MSD PLC
- EGEAR_iPlc(2) = Electr. gear unit via MSD PLC
- ECAM_PARA(3) = Electronic camming via parameters
- EGEAR_PARA(4) = Electronic gearing via parameters

NOTE: For more information refer to the bus system User Manuals or the description of the MSD PLC.

# 8.11.1 Electronic cam plate

The other parameters are configured in separate screens that can be accessed with the corresponding buttons.

- Master configuration (see Section ""Master configuration"" on page 280)
- Electronic gearing (see Section ""Electronic gearing"" on page 283)
- Electronic camming (see Section ""Electronic cam plate"" on page 277)

P 1318[0] - MPRO_ECAM_ControlWord is the control word for “synchronized motion” (see Section ""Control word for synchronized motion"" on page 279).

P 1326[0] - MPRO_ECAM_StatusWord is the status word for “synchronized motion” (see Section ""Status word for synchronized motion"" on page 279).

# 8.11.1.1 Table selection

|ID|Index Name|Unit|Description|
|---|---|---|---|
|1300|MPRO_ECAM_CTS_| |ECAM: CamTableSelect - Master reference|
|1301|MasterRef| | |
|1305|MPRO_ECAM_CTS_| |ECAM: CamTableSelect - Method for changing the camtable|
|1306|MPRO_ECAM_CTS_| |ECAM: CamTableSelect - Mode for changing the camtable|
|1307|MPRO_ECAM_CTS_|incr|ECAM: CamTableSelect - Distance for changing the camtable|
|242|MPRO_ECAM_| |ECAM / EGEAR: Mode of synchronized motion SyncModMode|
|265|MPRO_ECAM_| |ECAM / EGEAR: Slave speed factor (1 = 100%).|
|266|CamSlave_SpeedFactor| | |
|268|MPRO_ECAM_| |ECAM / EGEAR: Mode of switching off sync. motion|

# 8.11.1.2 Synchronization

|ID|Index Name|Unit|Description|
|---|---|---|---|
|1342|MPRO_ECAM_CI_|incr|ECAM: CamIn - Synchronization position (multiturn part)|
|1343|MPRO_ECAM_CO_|incr|ECAM: CamOut - Decoupling pos. (multiturn part)|
|1303|MPRO_ECAM_CI_|incr|ECAM: CamIn - Master offset|
|1308|MPRO_ECAM_CI_| |ECAM: CamIn - Master reference|
|1309|MPRO_ECAM_CI_| |ECAM: CamIn - Slave reference|
|1310|MPRO_ECAM_CI_| |ECAM: CamIn - Coupling mode|
|1311|MPRO_ECAM_CI_|incr|ECAM: CamIn - Coupling distance|
|1312|MPRO_ECAM_CI_|incr|ECAM: CamIn - Synchronization position|

Table 8.31: “Electronic camming - Table selection” parameters

Table 8.30: “Synchronized motion” parameters

Table 8.32: “Electronic camming - Synchronization” parameters

MOOG ID No.:CB40859-001 Date:11/2020

MSD ServoDrive - DeviceHelp 277

# 8 Motion profile

MOOG ID No.:CB40859-001 Date:11/2020 MSD ServoDrive - DeviceHelp 278

|ID|Index|Name|Unit|Description|
|---|---|---|---|---|
|1313|0|MPRO_ECAM_CO_SyncPosST|(singleturn part)|ECAM: CamOut - Slave reference|
|1314|0|MPRO_ECAM_CO_DecouplingMode|63|ECAM: CamOut - Decoupling mode|
|1315|0|MPRO_ECAM_CO_BreakingPosST|incr|ECAM: CamOut - Decoupling position|
|1316|0|MPRO_ECAM_CO_DecouplingDist|incr|ECAM: CamOut - Decoupling distance|
|1317|0|MPRO_ECAM_CO_StandstillPos|mDegree|ECAM: CamOut - Slave standstill position|

# Table 8.32: “Electronic camming - Synchronization” parameters (continue)

|ID|Index|Name|Unit|Description|
|---|---|---|---|---|
|1346| |MPRO_ECAM_SP_Table| |ECAM: Setpoint table interface|
|1346|0|Index| |Index of setpoint table|
|1346|1|Value| |Value at index of setpoint table|
|1347|0 to 31|MPRO_ECAM_SP_Index| |ECAM: Setpoint segments start index|
|1348|0 to 31|MPRO_ECAM_SP_Length| |ECAM: Setpoint segments length|
|1349|0 to 31|Length| | |
|1350|0|MPRO_ECAM_SP_MaDist| |ECAM: Setpoint segments master distance|
|1351|0|MPRO_ECAM_SP_IpoType| |ECAM: Setpoint segments interpolation type|
|1352|0 to 31|Checksum| |ECAM: Setpoint table checksum|
|1353|0 to 31|GainNum| |ECAM: Setpoint segments gain numerator|
| | |GainDen| |ECAM: Setpoint segments gain denominator|

# Table 8.33: “Electronic camming - Table segments” parameters

|ID|Index|Name|Unit|Description|
|---|---|---|---|---|
|1329|0 to 63|MPRO_ECAM_SegData_IndexNext| |ECAM: Index of the following segment|
|1330|0 to 63|MPRO_ECAM_SegData_IndexPrev| |ECAM: Index of the previous segment|
|1331|0 to 63|MPRO_ECAM_SegData_ProfileMode| |ECAM: Profile mode of the current segment|
|1332|0 to 63|MPRO_ECAM_SegData_DistMaster| |ECAM: Length of the master section of the current segment|
|1333|0 to 63|MPRO_ECAM_SegData_DistSlave| |ECAM: Length of the slave section of the current segment|
|1334|0 to 63|MPRO_ECAM_SegData_Lambda| |ECAM: Lambda value of the current segment|
|1335|0 to 63|MPRO_ECAM_SegData_StatusWord| |ECAM: Status word of the current segment|
|1336|0 to 63|MPRO_ECAM_SegData_ControlWord| |ECAM: Control word of the current segment|

# 8.11.2 Control word for synchronized motion

|Bit|Function|PLC function|Bit number|Description|
|---|---|---|---|---|
|0-7|Start segment (8-bit value)|-|0-7|Actual segment (8-bit value)|
|8-15|Reserved|-| |Actual ECAM / EGEAR state machine state (4 Bit value)|
|16|Absolute (true) / relative (false) master relationship|-| |- 0: ECAM / EGEAR asynchronous
- 1: ECAM / EGEAR synchronous
|
|17|Absolute (true) / relative (false) master (CAM) relationship at cam in|-| |- 2: ECAM / EGEAR synchronizing
- 3: ECAM / EGEAR desynchronizing
|
|18|Absolute (true) / relative (false) slave (CAM) relationship at cam in|-| |- 4: ECAM / EGEAR active and waiting for going asynchronous
|
|19-23|Reserved|-| |- 5: ECAM / EGEAR inactive and waiting for going synchronous
|
|24|Change gear ratio of the electronic gear online|MCB_GearRatioChange| | |
|25|Disable master calculation|MCB_Cam_MasterEnable| | |
|26|Enable master calculation|MCB_Cam_MasterEnable| | |
|27|Select CAM table|MCB_CamTableSelect| | |
|28|Start Ecam|MCB_CamIn| | |
|29|Stop Ecam|MCB_CamOut| | |
|30|Start Egear|MCB_GearIn| | |
|31|Stop Egear|MCB_GearOut| | |

# 8.11.3 Status word for synchronized motion

|Bit|Function|PLC function|Bit number|Description|
|---|---|---|---|---|
|12-26|Reserved|-| | |
|27|ECAM / EGEAR is active|-| | |
|28|Valid segments chosen|-| | |
|29|Master data are valid|-| | |
|30|Master is initialized|-| | |
|31|Master calculation is active|-| | |

Table 8.35: Control word ECAM (P 1318[0] - MPRO_ECAM_ControlWord)

Table 8.36: ECAM status word (P 1326[0] - MPRO_ECAM_StatusWord)

MOOG ID No.:CB40859-001 Date:11/2020 MSD ServoDrive - DeviceHelp 279

# 8 Motion profile

# 8 Motion profile

MOOG ID No.:CB40859-001 Date:11/2020

MSD ServoDrive - DeviceHelp 280

# 8.11.4 Master configuration

the master encoder, you will need to set the resolution relative to a single motor revolution in P 250 - MPRO_ECAM_PARAMaster_Amplitude (see below).

- ENC CH1 (3) = Encoder channel 1 X7 (Sin/Cos)
- ENC CH2 (4) = Encoder channel 2 X6 (Resolver)
- ENC CH3 (5) = Encoder channel 3 X8 (optional)

This function is only available if an external interface X8 (option module) is present.

- TP0 (6) = Pulse counter on probe channel 0 (TP0)
- TP1 (7) = Pulse counter on probe channel 1 (TP1)
- ENC_CH4 (8) = Encoder channel 4 (p. e. fieldbus)
- TWIN_POS (9) = TWIN remote reference position (P-2607)

Image 8.72: “Master configuration” screen

# Channel selection (master encoder)

P 1319[0] - MPRO_ECAM_CamMaster_AxisType is used to define the master encoder.

- NO AXIS (0) = No axis
- VIRTUAL MASTER (1) = Virtual master

If you select this function, you will be able to configure additional settings by clicking on the enabled “Options...” button (see Section ""Virtual Master"" on page 286).

- PARA (2) = Master parameter interface

If you select this function because a higher-level controller is being used as

# Anti-reverse mode

Slave only starts moving along with it again as soon as the master reaches the zero position.

P 1320[0] - MPRO_ECAM_CamMaster_RevLockMode is used to define the reverse lock mode, which can be used either with or without path compensation. The dashed lines in the following diagrams indicate what the engagement distance is:

# Example:

If the master, which has moved two motor revolutions in the direction blocked for the slave, then moves in the unblocked direction again, the slave only moves off when the master has traversed the zero point.

- INACTIVE (0) = Reverse lock inactive
- ACTIVE (2) = Reverse lock enabled - without path optimization
- ACTIVE WAY COMP (1) = Reverse lock active - with way compensation

While the slave accelerates to the speed of the master during engagement, the master and slave do not move synchronously. This function needs to be selected in order to quickly catch up to the master that is running ahead.

# Example:

- Master (black line) rotates in the blocked direction
- The slave (blue line) remains stopped
- Master rotates in the unblocked direction again
- The slave follows the master directly in the unblocked direction

Assume the master has moved two motor revolutions in the direction for which the slave lock is enabled. If the master now moves in the direction for which there is no lock, the slave will immediately start running in that direction.

MOOG ID No.:CB40859-001 Date:11/2020

MSD ServoDrive - DeviceHelp 281

# 8 Motion profile

MOOG ID No.:CB40859-001 Date:11/2020 MSD ServoDrive - DeviceHelp 282

|Filter type|ID|Index Name|Unit|Description|
|---|---|---|---|---|
|When using a real master encoder, encoder signals may be subject to noise.|P 1340|1319|0|MPRO_ECAM_CamMaster_AxisType|
| | |MPRO_ECAM_CamMaster_SpeedFilTyp| |ECAM / EGEAR: Channel selection of internal master input|
| | |1320|0|MPRO_ECAM_CamMaster_RevLockMode|
| | |1321|0|MPRO_ECAM_CamMaster_Amplitude|
| | |1322|0|MPRO_ECAM_CamMaster_GearNum|
| | |1323|0|MPRO_ECAM_CamMaster_GearDen|
|Filter time|1327|0|ms|ECAM / EGEAR: Filter time constant of master|
|If P 1340[0] is used to enable a filter, P 1327[0] - MPRO_ECAM_CamMaster_SpeedTFil can be used to define the corresponding filter time.|1328|0|speed|ECAM / EGEAR: Speed factor of the internal master|
|Speed factor|1340|0| |MPRO_ECAM_CamMaster_SpeedFilTyp|
|The master encoder can be assigned an additional speed factor P 1328[0] - MPRO_ECAM_CamMaster_SpeedFactor.|1341|0|incr|ECAM / EGEAR: Master drive offset|

Table 8.37: “Synchronized motion - Master configuration” parameters (continue)

| | | |ID|Index Name|Unit|Description|
|---|---|---|---|---|---|---|
|247|0|MPRO_ECAM_ParaMaster_ActPos|incr|ECAM / EGEAR: Parameter interface master position| | |
|248|0|MPRO_ECAM_ParaMaster_ActSpeed|rpm|ECAM / EGEAR: Parameter interface master speed| | |
|249|0|MPRO_ECAM_ParaMaster_ActAcc|rpm|ECAM / EGEAR: Parameter interface master acceleration| | |
| |250|0|MPRO_ECAM_ParaMaster_Amplitude| |ECAM / EGEAR: Parameter interface master amplitude| |

Table 8.37: “Synchronized motion - Master configuration” parameters

# 8.11.5 Electronic gearing

# Gear ratio

The gear ratio is specified as a fraction. This ensures that the position references can be translated to the motor shaft with no rounding error.

- ""Slave"" (P 252[0] - MPRO_ECAM_Egear_GearNum) is the numerator
- ""Master"" (P 251[0] - MPRO_ECAM_Egear_GearDen) is the denominator

# Scaling of speed pre-control

Defined with P 265[0] - MPRO_ECAM_CamSlave_SpeedFactor definiert.

# Scaling of torque pre-control

Defined with P 266[0] - MPRO_ECAM_CamSlave_TorqueFactor.

# Engagement

See Section ""Engagement"" on page 284.

# Disengagement

See Section ""Disengagement"" on page 285.

|ID|Index Name|Unit|Description|
|---|---|---|---|
|251|0 MPRO_ECAM_Egear_GearDen| |EGEAR: Gear denominator|
|252|0 MPRO_ECAM_Egear_GearNum| |EGEAR: Numerator of gear ratio|
|1344|0 MPRO_ECAM_Egear_LimRefAcc|rpm/s|EGEAR: Acceleration limit for reference|
|1345|0 MPRO_ECAM_Egear_LimRefJerk|rpm/s²|EGEAR: Jerk limit for reference|

Table 8.38: “Synchronized motion - Electronic gearing” parameters

Image 8.73: ""Electronic gearing"" screen

MOOG ID No.:CB40859-001 Date:11/2020 MSD ServoDrive - DeviceHelp 283

# 8 Motion profile

# 8 Motion profile

MOOG ID No.:CB40859-001 Date:11/2020

MSD ServoDrive - DeviceHelp 284

# 8.11.6 Engagement

used to define the engagement distance (between the dashed lines).

P 253[0] - MPRO_ECAM_Egear_GearInMode is used to define the mode for engagement.

- DIRECT (0) = Direct
- Direct engagement: Angular synchronous; with jerking (no ramps).
- CROSSFADE (3) = Crossfading
- Engagement with crossfading function (5th degree polynomial): Angular synchronous; jerk-limited; speed will overshoot during engagement.
- RAMP (1) = Linear speed ramp
- Engagement with linear acceleration: Not angular synchronous; with jerking.
- FADE (2) = Engagement fade-out
- Engagement with fade-in function (5th degree polynomial): Not angular synchronous; jerk-limited. The position is ignored. ","What parameters are used to define deceleration in torque, speed, and position control modes in the 'MSD ServoDrive - DeviceHelp' document?",A4,"The document specifies P 194, P 197, and P 200 for deceleration in torque, speed, and position control respectively.",2.25,2.296875,3.671875,1.578125,0.61328125
49,msd_servo_drive.txt,76,b87ca5e232c2bdbb6fa16a8a401c6b5d285dc0183e73cc9d134de13dd2fc71d2,"MOOG ID No.:CB40859-001 Date:11/2020

MSD ServoDrive - DeviceHelp 267

# 8 Motion profile

MOOG ID No.:CB40859-001 Date:11/2020 MSD ServoDrive - DeviceHelp 268

# Deceleration

With ...

- P 194 - MPRO_TAB_TDec (for torque control) or
- P 197 - MPRO_TAB_SDec (for speed control) or
- P 200 - MPRO_TAB_PDec (for position control)

and indexes 0–15, the deceleration for each individual motion task can be defined. The input must not be zero.

# Wait time in Auto mode

P 204 - MPRO_TAB_WaitTime is used to define the wait time before the next motion task is carried out.

# Maximum table index in Auto mode

P 206[0] - MPRO_Tab_MaxIdx is used to define the table index up to which driving jobs will be carried out in one of the auto modes.

# Current table index

P 207[0] - MPRO_Tab_ActIdx will show the index for the motion task that is currently active. If parameter P 205 MPRO_TAB_Mode is set to “Para(0)”, a driving set can be entered and approached directly.

# Activation of reference table

The following procedures can be used in order to activate the setpoint table for operation.

|ID|Index Name|Unit|Description|
|---|---|---|---|
|193|MPRO_TAB_TAcc|TAB: Torque mode acceleration|Nm/ms|
|193|0|MPRO_TAB_TAcc|Nm/ms|
|193|1 - 15|MPRO_TAB_TAcc|Nm/ms|
|194|MPRO_TAB_TDec|TAB: Torque mode deceleration| |
|194|0|MPRO_TAB_TDec|Nm/ms|
|194|1 - 15|MPRO_TAB_TDec|Nm/ms|

# Table 8.23: Activation of table references

# Table 8.24: “Setpoint table settings” parameters

# Table 8.24: “Setpoint table settings” parameters (continue)

|ID|Index Name|Unit|Description|ID|Index Name|Unit|Description|
|---|---|---|---|---|---|---|---|
|195|MPRO_TAB_TRef|Nm|TAB: Torque mode reference value|208|MPRO_TAB_OutputNo| |OSD TAB: actual table index and target|
|195|MPRO_TAB_TRef|Nm| |208|MPRO_TAB_OutputNo| | |
|196|MPRO_TAB_SAcc|rev/min/s|TAB: Speed mode acceleration|269|MPRO_TAB_Ctrl| |TAB: control word|
|196|MPRO_TAB_SAcc|rev/min/s| | | | | |
|197|MPRO_TAB_SDec|rev/min/s|TAB: Speed mode deceleration| | | | |
|197|MPRO_TAB_SDec|rev/min/s| | | | | |
|198|MPRO_TAB_SRef|rev/min|TAB: Speed mode reference value| | | | |
|198|MPRO_TAB_SRef|rev/min| | | | | |
|199|MPRO_TAB_PAcc|rev/min/s|TAB: Position control mode acceleration| | | | |
|199|MPRO_TAB_PAcc|rev/min/s| | | | | |
|200|MPRO_TAB_PDec|rev/min/s|TAB: Position control mode Acceleration| | | | |
|200|MPRO_TAB_PDec|rev/min/s| | | | | |
|201|MPRO_TAB_PSpd|rev/min|TAB: Position control mode speed| | | | |
|201|MPRO_TAB_PSpd|rev/min| | | | | |
|202|MPRO_TAB_PPos|mDegree|TAB: Position control mode reference value| | | | |
|202|MPRO_TAB_PPos|mDegree| | | | | |
|203|MPRO_TAB_PMode| |Position control table:Mode| | | | |
|203|MPRO_TAB_PMode| | | | | | |
|204|MPRO_TAB_WaitTime|ms|TAB: Wait time| | | | |
|204|MPRO_TAB_WaitTime|ms| | | | | |
|205|MPRO_TAB_Mode| |TAB mode| | | | |
|206|MPRO_Tab_MaxIdx| |TAB: Max index in AUTO mode| | | | |
|207|MPRO_TAB_ActIdx| |TAB: Actual index| | | | |

MOOG ID No.:CB40859-001 Date:11/2020

MSD ServoDrive - DeviceHelp

# 8 Motion profile

MOOG ID No.:CB40859-001 Date:11/2020

MSD ServoDrive - DeviceHelp 270

# 8.8 Analog channel (ISA00 und ISA01)

# Offset (O)

This parameter (P 174 - MPRO_ANA0_SOffset for ISA00, P 184 - MPRO_ANA1_SOffset for ISA01) compensates for component variations and is used for offset compensation purposes. Depending on the control mode being used (see Section ""Basic settings"" on page 110), the value will be stored in parameter index [0] (torque control), [1] (speed control) or [2] (position control).

# Backlash (B)

This parameter (P 175 - MPRO_ANA0_SThreshold for ISA00, P 185 - MPRO_ANA1_SThreshold for ISA01) can suppress axis motion close to the standstill (stop) position. Depending on the control mode being used (see Section ""Basic settings"" on page 110), the value will be stored in parameter index [0] (torque control), [1] (speed control) or [2] (position control).

Image 8.68: “Analog channel” screen

# Acceleration ramp

Two standard analog inputs (ISA00, ISA01) are available. These inputs can be configured...

- with negative values for analog setpoint settings
- with positive values for digital setpoint processing

(P 109[0] - MPRO_INPUT_FS_ISA00 and P 110[0] - MPRO_INPUT_FS_ISA01).

see also section ""Analog Inputs"" on page 303. By using the ""REV(-2) = Analog setpoint"" setting, an analog input voltage of ±10 V can be processed as a setpoint.

# Deceleration ramp

This parameter serves as a deceleration ramp for torque control (P 176[1] - MPRO_ANA0_TRamp for ISA00, P 186[1] - MPRO_ANA1_TRamp for ISA01) or speed control (P 177[1] - MPRO_ANA0_SRamp for ISA00, P 187[1] - MPRO_ANA1_SRamp for ISA01). Depending on the control mode being used (see Section ""Basic settings"" on page 110), the value will be stored in parameter index [0] (torque control), [1] (speed control) or [2] (position control).

This parameter (P 173 - MPRO_ANA0_Scale for ISA00, P 183 - MPRO_ANA1_Scale for ISA01) is used to define which speed / which torque / which position corresponds to the maximum analog value. Depending on the control mode being used (see Section ""Basic settings"" on page 110), the value will be stored in parameter index [0] (torque control), [1] (speed control) or [2] (position control).

# 8.8.1 Special characteristics of position control mode

A threshold value can also be specified which generates a run-on range around the last reference value. A ramp function calculates a motion profile for the position reference from pre-defined acceleration and speed limits.

The position references on the analog channel are not applied immediately, but dependent on a digital input. Accordingly, one of the ISD00 to ISD06 digital inputs must be set to a value of ""REFANAEN(28) = Enable analog reference value"" (see Section ""Digital inputs"" on page 290). The position setpoint being received will only be applied if the corresponding digital input is active. The acceleration is entered using P 173[0] - MPRO_ANA0_TScale or P 183[0] - MPRO_ANA1_TScale.

# 8.8.2 Wire Break Monitoring

P 399 - CON_ANAWireBrk_Th can be used to configure wire break monitoring for the analog inputs. For details see Section ""Wire Break Monitoring"" on page 306.

|Function|TLIM (-4)|OVR (-3)|REFV (-2)|leer (-1)|OFF (0)|
|---|---|---|---|---|---|
|Digital|(1)-(28)|(1)-(28)|(1)-(28)|(1)-(28)|(1)-(28)|
|Analog channel|Filter|Scale|Offset|Profile|generator|

Control

Image 8.69: Reference processing structure

MOOG ID No.:CB40859-001 Date:11/2020

MSD ServoDrive - DeviceHelp 271

# 8 Motion profile

# 8 Motion profile

MOOG ID No.:CB40859-001 Date:11/2020

|ID|Index Name|Unit|Description|ID|
|---|---|---|---|---|
|395|CON_ANA_Isaf_Scaled| |Analog inputs: Values (filt, norm, comp, scaled)|174|
|395|0 ISA00| |Scaled, compensated, filtered, normalized value|175|
|395|1 ISA01| |Scaled, compensated, filtered, normalized value| |
|396|CON_ANA_Scale_ThUpper| |Analog inputs: Upper scaling limits|175|
|396|0 ISA00|%|Upper scaling (@ 10 V) threshold|175|
|396|1 ISA01|%|Upper scaling (@ 10 V) threshold| |
|397|CON_ANA_Scale_ThZero| |Analog inputs: Zero scaling thresholds|176|
|397|0 ISA00|V|Zero scaling threshold (+/-)|176|
|397|1 ISA01|V|Zero scaling threshold (+/-)| |
|398|CON_ANA_Scale_ThLower| |Analog inputs: Lower scaling limits|177|
|398|0 ISA00|%|Lower scaling (@ zero threshold) threshold|177|
|398|1 ISA01|%|Lower scaling (@ zero threshold) threshold| |
|399|CON_ANA_WireBrk_Th| |Analog inputs: Wire break thresholds|Table 8.26:|
|399|0 ISA00|V|Wire break detection threshold| |
|399|1 ISA01|V|Wire break detection threshold| |
|405|0 CON_ANA_Filt0|ms|Analog input ISA00: Filter time constant (PT 1)|ID|
|408|CON_ANA_Isaf_Norm| |Analog inputs: Values (filt, norm)|183|
|408|0 ISA00| |Filtered, normalized value|183|
|408|1 ISA01| |Filtered, normalized value|183|

Table 8.25: “Analog channel” parameters

|ID|Index Name|Unit|Description|ID|
|---|---|---|---|---|
|173|MPRO_ANA0_Scale| |ANA0: scale factors|184|
|173|0 MPRO_ANA0_TScale|Nm|ANA0: scale factor torque reference|185|
|173|1 MPRO_ANA0_SScale|rev/min|ANA0: scale factor speed reference|185|
|173|2 MPRO_ANA0_PScale|mDegree|ANA0: scale factor position reference| |
|174|MPRO_ANA0_Offset| |ANA0: offsets|185|
|174|0 MPRO_ANA0_TOffset|Nm|ANA0: offsets for torque reference|185|

Table 8.26: “Analog channel ISA00” parameters

|Index Name|Unit|Description|
|---|---|---|
|1 MPRO_ANA0_SOffset|rev/min|ANA0: offsets for speed reference|
|2 MPRO_ANA0_POffset|mDegree|ANA0: offsets for position reference|
|MPRO_ANA0_Threshold| |ANA0: thresholds|
|0 MPRO_ANA0_TThreshold|Nm|ANA0: threshold for torque reference|
|1 MPRO_ANA0_SThreshold|rev/min|ANA0: threshold for speed reference|
|2 MPRO_ANA0_PThreshold|mDegree|ANA0: threshold for position reference|
|MPRO_ANA0_TRamp| |ANA0: Torque mode acceleration [0] and deceleration [1]|
|0 MPRO_ANA0_TRamp|Nm/s| |
|1 MPRO_ANA0_TRamp|Nm/s| |
|MPRO_ANA0_SRamp| |ANA0: Speed mode acceleration [0] and deceleration [1]|
|0 MPRO_ANA0_SRamp|SPEED/s| |
|1 MPRO_ANA0_SRamp|SPEED/s| |

“Analog channel ISA00” parameters (continue)

|Index Name|Unit|Description|
|---|---|---|
|MPRO_ANA1_Scale| |ANA1: scale factors|
|0 MPRO_ANA1_TScale|Nm|ANA0: scale factor torque reference|
|1 MPRO_ANA1_SScale|rev/min|ANA0: scale factor speed reference|
|2 MPRO_ANA1_PScale|mDegree|ANA0: scale factor position reference|
|MPRO_ANA1_Offset| |ANA1: offsets|
|0 MPRO_ANA1_TOffset|Nm|ANA1: offsets for torque reference|
|1 MPRO_ANA1_SOffset|rev/min|ANA1: offsets for speed reference|
|2 MPRO_ANA1_POffset|mDegree|ANA1: offsets for position reference|
|MPRO_ANA1_Threshold| |ANA1: thresholds|
|0 MPRO_ANA1_TThreshold|Nm|ANA1: threshold for torque reference|
|1 MPRO_ANA1_SThreshold|rev/min|ANA1: threshold for speed reference|
|2 MPRO_ANA1_PThreshold|mDegree|ANA1: threshold for position reference|

“Analog channel ISA01” parameters

# 8 Motion profile

|ID|Index Name|Unit|Description|
|---|---|---|---|
|186|MPRO_ANA1_TRamp|Nm/s|ANA1: Torque mode acceleration [0] and deceleration[1]|
|186|MPRO_ANA1_TRamp|Nm/s| |
|187|MPRO_ANA1_SRamp|SPEED/s|ANA1: Speed mode acceleration [0] and deceleration [1]|
|187|MPRO_ANA1_SRamp|SPEED/s| |

# Table 8.27: “Analog channel ISA01” parameters (continue)

Display

- System state
- Initialization on device startup
- Not ready (DC link voltage possibly too low)
- Start inhibit (DC link voltage present, power stage off)
- Starting lockout
- Ready for start
- Control initialization: Auto commutation, flux build-up etc.

# Table 8.28: Central state machine according to CiA 402 device display

MOOG ID No.:CB40859-001 Date:11/2020

MSD ServoDrive - DeviceHelp 273

# 8 Motion profile

MOOG ID No.:CB40859-001 Date:11/2020

MSD ServoDrive - DeviceHelp 274

|Display|System state|power disabled|fault|
|---|---|---|---|
|Control enabled|0|Start|7|
| |fault reaction active|0|14|
|Quick stop active|1|not ready|8|
| |to switch on|1|17|
|Error reaction active|2|switch on|disabled|
| |2|7| |
|Error state (in this state the error is indicated directly on the display.)|3|ready to|switch on|
|Device is reset (display flashes)|power enabled|3|6|
| |10|12| |
|• Number [5.] flashes when “STO” (Safe Torque Off) input is active. Display goes out when STO inactive.| | | |
|• The dot on the display flashes when the power stage is active.| | | |

Table 8.28: Central state machine according to CiA 402 device display (continue)

NOTE

l The system states indicated on the display may differ from the states in the table depending on the drive profile setting.

Image 8.70: State machine diagram based on CANopen communications

⓪ to ① State number

1 to 17 State transition (No. 17: DC link voltage cut off)

Legend for “State machine diagram based on CANopen communications” figure

# 8.10 Touch probe

|ID|Index Name / Setting|
|---|---|
|241|0 MPRO_TP_Position|
|241|1 MPRO_TP_Position|
|241|2 MPRO_TP_Position|
|241|3 MPRO_TP_Position|
|241|4 MPRO_TP_Position|
|1400|0 MPRO_TP_Config|
| |TP_TP (0)|
| |AB (1)|
| |PD_UP (2)|
| |PD_DOWN (3)|
| |PC_PC (4)|
| |PC_TP (5)|
| |TP_PC (6)|
| |ENC_ENC (7)|
| |ENC_TP (8)|
| |TP_ENC (9)|

Using the touch probe inputs, touch probe functions can be performed. In order to be able to do this, P 106[0] - MPRO_INPUT_FS_ISD05 and P 107[0] - MPRO_INPUT_FS_ISD06 must be used to set digital inputs ISD05 and ISD06 to ""PROBE(15) = Touch probe (only ISD05/06)"" (see Section ""Digital inputs"" on page 290). HTL encoders can be evaluated or pulse counters implemented using the MSD PLC.

The touch probe can be triggered with P 240 - MPRO_TP_Ctrl. This enables triggering on a positive or negative edge, or on both edges, of the signal detected on the touch probe inputs. After the measurement, the parameter jumps back to the value ""NONE (0)"" and the latch position is mapped in the corresponding subindex of parameter P 241 - MPRO_TP_Position. A continuous touch probe mode is not possible at present, so the touch probe has to be reactivated after the measurement.

P 1402 - MPRO_TP_Channel can be used to select various positions as actual value sources of the latch position for the touch probe functionality. The following table provides an overview of the available settings. The counters are accessed via the MSD PLC or a bus system.

|ID|Index Name / Setting|Unit|Description|
|---|---|---|---|
|240|MPRO_TP_Ctrl|Touch probe: Control| |
| |0| |NONE (0) = No function|
| |1| |POS (1) = Positive edge|
| |2| |NEG (2) = Negative edge|
| |3| |BOTH (3) = Both edges|
|240|0 MPRO_TP_Ctrl| | |
|240|1 MPRO_TP_Ctrl| | |
|240|2 MPRO_TP_Ctrl| | |
|241|MPRO_TP_Position|Probe: Pos. high/low edge of TP0/1, encoder zero pulse| |

Table 8.29: “Touch probe” parameters

MOOG ID No.:CB40859-001 Date:11/2020

# 8 Motion profile

|Unit|Description|
|---|---|
|mDegree|Touch probe: Configuration|
|mDegree|TP0, TP1 touch probe|
|mDegree|TP0, TP1 as encoder, A/B as quadrature counting|
|mDegree|TP0, TP1 as encoder, pulse (TP0) / direction (TP1), count up on direction high|
|mDegree|TP0, TP1 as encoder, pulse (TP0) / direction (TP1), count down on direction high|
|mDegree|TP0 pulse counter, TP1 pulse counter|
|mDegree|TP0 pulse counter, TP1 touch probe|
|mDegree|TP1 touch probe, TP0 pulse counter|
|mDegree|TP0 encoder counter, TP1 encoder counter|
|mDegree|TP0 encoder counter, TP1 touch probe|
|mDegree|TP0 touch probe, TP1 encoder counter|

Touch probe: Channel

|Unit|Description|
|---|---|
|ACTPOS (0)|Actual position in user units|
|ACTPOSINC (1)|Actual position in increments|
|MASTERPOS (2)|Master position in increments|
|ENCPOS_CH1 (3)|Encoder position Channel 1|
|ENCPOS_CH1_INC (4)|Encoder position Channel 1 in increments|
|ENCPOS_CH2 (5)|Encoder position Channel 2|
|ENCPOS_CH2_INC (6)|Encoder position Channel 2 in increments|

# 8 Motion profile

MOOG ID No.:CB40859-001 Date:11/2020 MSD ServoDrive - DeviceHelp 276

|ID|Index Name / Setting|Unit|Description|
|---|---|---|---|
|7|ENCPOS_CH3 (7)| |Encoder position Channel 3|
|8|ENCPOS_CH3_INC (8)| |Encoder position Channel 3 in increments|
|9|ENCPOS_CH4 (9)| |Encoder position Channel 4|
|10|ENCPOS_CH4_INC (10)| |Encoder position Channel 4 in increments|
|11|ACTPOS2 (11)| |Actual position of redundant encoder in user units|
|12|Sercos (12)| |Referred to Sercos profile parameters S-x-0426, S-x-0427|
|13|UserRefPos(13)| |Reference position in user units|
|14|MasterPosST(14)| |Master position (ECAM, EGEAR) singleturn, always steps|
|15|CommonMasterPos(15)| |Master position (ECAM, EGEAR) singleturn, always steps|
|16|CommonMasterPosST(15)| |Master position (ECAM, EGEAR) singleturn, always steps|
|1402|MPRO_TP_Channel| | |
|1402|MPRO_TP_Channel| | |
|1402|MPRO_TP_Channel| | |
|1404|MPRO_TP_Lines| |Touch probe: Lines @ pulse counter on channel x|
|1404|MPRO_TP_Lines| | |
|1404|MPRO_TP_Lines| | |

Image 8.71: “Synchronized motion” screen

There are various modes available in the “synchronization mode” drop-down menu (P 242[0] - MPRO_ECAM_SyncModMode):

- Off(0) = Synchronized motion off
- ECAM_iPlc(1) = Electronic cam plate via MSD PLC
- EGEAR_iPlc(2) = Electr. gear unit via MSD PLC
- ECAM_PARA(3) = Electronic camming via parameters
- EGEAR_PARA(4) = Electronic gearing via parameters

NOTE: For more information refer to the bus system User Manuals or the description of the MSD PLC.

# 8.11.1 Electronic cam plate

The other parameters are configured in separate screens that can be accessed with the corresponding buttons.

- Master configuration (see Section ""Master configuration"" on page 280)
- Electronic gearing (see Section ""Electronic gearing"" on page 283)
- Electronic camming (see Section ""Electronic cam plate"" on page 277)

P 1318[0] - MPRO_ECAM_ControlWord is the control word for “synchronized motion” (see Section ""Control word for synchronized motion"" on page 279).

P 1326[0] - MPRO_ECAM_StatusWord is the status word for “synchronized motion” (see Section ""Status word for synchronized motion"" on page 279).

# 8.11.1.1 Table selection

|ID|Index Name|Unit|Description|
|---|---|---|---|
|1300|MPRO_ECAM_CTS_| |ECAM: CamTableSelect - Master reference|
|1301|MasterRef| | |
|1305|MPRO_ECAM_CTS_| |ECAM: CamTableSelect - Method for changing the camtable|
|1306|MPRO_ECAM_CTS_| |ECAM: CamTableSelect - Mode for changing the camtable|
|1307|MPRO_ECAM_CTS_|incr|ECAM: CamTableSelect - Distance for changing the camtable|
|242|MPRO_ECAM_| |ECAM / EGEAR: Mode of synchronized motion SyncModMode|
|265|MPRO_ECAM_| |ECAM / EGEAR: Slave speed factor (1 = 100%).|
|266|CamSlave_SpeedFactor| | |
|268|MPRO_ECAM_| |ECAM / EGEAR: Mode of switching off sync. motion|

# 8.11.1.2 Synchronization

|ID|Index Name|Unit|Description|
|---|---|---|---|
|1342|MPRO_ECAM_CI_|incr|ECAM: CamIn - Synchronization position (multiturn part)|
|1343|MPRO_ECAM_CO_|incr|ECAM: CamOut - Decoupling pos. (multiturn part)|
|1303|MPRO_ECAM_CI_|incr|ECAM: CamIn - Master offset|
|1308|MPRO_ECAM_CI_| |ECAM: CamIn - Master reference|
|1309|MPRO_ECAM_CI_| |ECAM: CamIn - Slave reference|
|1310|MPRO_ECAM_CI_| |ECAM: CamIn - Coupling mode|
|1311|MPRO_ECAM_CI_|incr|ECAM: CamIn - Coupling distance|
|1312|MPRO_ECAM_CI_|incr|ECAM: CamIn - Synchronization position|

Table 8.31: “Electronic camming - Table selection” parameters

Table 8.30: “Synchronized motion” parameters

Table 8.32: “Electronic camming - Synchronization” parameters

MOOG ID No.:CB40859-001 Date:11/2020

MSD ServoDrive - DeviceHelp 277

# 8 Motion profile

MOOG ID No.:CB40859-001 Date:11/2020 MSD ServoDrive - DeviceHelp 278

|ID|Index|Name|Unit|Description|
|---|---|---|---|---|
|1313|0|MPRO_ECAM_CO_SyncPosST|(singleturn part)|ECAM: CamOut - Slave reference|
|1314|0|MPRO_ECAM_CO_DecouplingMode|63|ECAM: CamOut - Decoupling mode|
|1315|0|MPRO_ECAM_CO_BreakingPosST|incr|ECAM: CamOut - Decoupling position|
|1316|0|MPRO_ECAM_CO_DecouplingDist|incr|ECAM: CamOut - Decoupling distance|
|1317|0|MPRO_ECAM_CO_StandstillPos|mDegree|ECAM: CamOut - Slave standstill position|

# Table 8.32: “Electronic camming - Synchronization” parameters (continue)

|ID|Index|Name|Unit|Description|
|---|---|---|---|---|
|1346| |MPRO_ECAM_SP_Table| |ECAM: Setpoint table interface|
|1346|0|Index| |Index of setpoint table|
|1346|1|Value| |Value at index of setpoint table|
|1347|0 to 31|MPRO_ECAM_SP_Index| |ECAM: Setpoint segments start index|
|1348|0 to 31|MPRO_ECAM_SP_Length| |ECAM: Setpoint segments length|
|1349|0 to 31|Length| | |
|1350|0|MPRO_ECAM_SP_MaDist| |ECAM: Setpoint segments master distance|
|1351|0|MPRO_ECAM_SP_IpoType| |ECAM: Setpoint segments interpolation type|
|1352|0 to 31|Checksum| |ECAM: Setpoint table checksum|
|1353|0 to 31|GainNum| |ECAM: Setpoint segments gain numerator|
| | |GainDen| |ECAM: Setpoint segments gain denominator|

# Table 8.33: “Electronic camming - Table segments” parameters

|ID|Index|Name|Unit|Description|
|---|---|---|---|---|
|1329|0 to 63|MPRO_ECAM_SegData_IndexNext| |ECAM: Index of the following segment|
|1330|0 to 63|MPRO_ECAM_SegData_IndexPrev| |ECAM: Index of the previous segment|
|1331|0 to 63|MPRO_ECAM_SegData_ProfileMode| |ECAM: Profile mode of the current segment|
|1332|0 to 63|MPRO_ECAM_SegData_DistMaster| |ECAM: Length of the master section of the current segment|
|1333|0 to 63|MPRO_ECAM_SegData_DistSlave| |ECAM: Length of the slave section of the current segment|
|1334|0 to 63|MPRO_ECAM_SegData_Lambda| |ECAM: Lambda value of the current segment|
|1335|0 to 63|MPRO_ECAM_SegData_StatusWord| |ECAM: Status word of the current segment|
|1336|0 to 63|MPRO_ECAM_SegData_ControlWord| |ECAM: Control word of the current segment|

# 8.11.2 Control word for synchronized motion

|Bit|Function|PLC function|Bit number|Description|
|---|---|---|---|---|
|0-7|Start segment (8-bit value)|-|0-7|Actual segment (8-bit value)|
|8-15|Reserved|-| |Actual ECAM / EGEAR state machine state (4 Bit value)|
|16|Absolute (true) / relative (false) master relationship|-| |- 0: ECAM / EGEAR asynchronous
- 1: ECAM / EGEAR synchronous
|
|17|Absolute (true) / relative (false) master (CAM) relationship at cam in|-| |- 2: ECAM / EGEAR synchronizing
- 3: ECAM / EGEAR desynchronizing
|
|18|Absolute (true) / relative (false) slave (CAM) relationship at cam in|-| |- 4: ECAM / EGEAR active and waiting for going asynchronous
|
|19-23|Reserved|-| |- 5: ECAM / EGEAR inactive and waiting for going synchronous
|
|24|Change gear ratio of the electronic gear online|MCB_GearRatioChange| | |
|25|Disable master calculation|MCB_Cam_MasterEnable| | |
|26|Enable master calculation|MCB_Cam_MasterEnable| | |
|27|Select CAM table|MCB_CamTableSelect| | |
|28|Start Ecam|MCB_CamIn| | |
|29|Stop Ecam|MCB_CamOut| | |
|30|Start Egear|MCB_GearIn| | |
|31|Stop Egear|MCB_GearOut| | |

# 8.11.3 Status word for synchronized motion

|Bit|Function|PLC function|Bit number|Description|
|---|---|---|---|---|
|12-26|Reserved|-| | |
|27|ECAM / EGEAR is active|-| | |
|28|Valid segments chosen|-| | |
|29|Master data are valid|-| | |
|30|Master is initialized|-| | |
|31|Master calculation is active|-| | |

Table 8.35: Control word ECAM (P 1318[0] - MPRO_ECAM_ControlWord)

Table 8.36: ECAM status word (P 1326[0] - MPRO_ECAM_StatusWord)

MOOG ID No.:CB40859-001 Date:11/2020 MSD ServoDrive - DeviceHelp 279

# 8 Motion profile

# 8 Motion profile

MOOG ID No.:CB40859-001 Date:11/2020

MSD ServoDrive - DeviceHelp 280

# 8.11.4 Master configuration

the master encoder, you will need to set the resolution relative to a single motor revolution in P 250 - MPRO_ECAM_PARAMaster_Amplitude (see below).

- ENC CH1 (3) = Encoder channel 1 X7 (Sin/Cos)
- ENC CH2 (4) = Encoder channel 2 X6 (Resolver)
- ENC CH3 (5) = Encoder channel 3 X8 (optional)

This function is only available if an external interface X8 (option module) is present.

- TP0 (6) = Pulse counter on probe channel 0 (TP0)
- TP1 (7) = Pulse counter on probe channel 1 (TP1)
- ENC_CH4 (8) = Encoder channel 4 (p. e. fieldbus)
- TWIN_POS (9) = TWIN remote reference position (P-2607)

Image 8.72: “Master configuration” screen

# Channel selection (master encoder)

P 1319[0] - MPRO_ECAM_CamMaster_AxisType is used to define the master encoder.

- NO AXIS (0) = No axis
- VIRTUAL MASTER (1) = Virtual master

If you select this function, you will be able to configure additional settings by clicking on the enabled “Options...” button (see Section ""Virtual Master"" on page 286).

- PARA (2) = Master parameter interface

If you select this function because a higher-level controller is being used as

# Anti-reverse mode

Slave only starts moving along with it again as soon as the master reaches the zero position.

P 1320[0] - MPRO_ECAM_CamMaster_RevLockMode is used to define the reverse lock mode, which can be used either with or without path compensation. The dashed lines in the following diagrams indicate what the engagement distance is:

# Example:

If the master, which has moved two motor revolutions in the direction blocked for the slave, then moves in the unblocked direction again, the slave only moves off when the master has traversed the zero point.

- INACTIVE (0) = Reverse lock inactive
- ACTIVE (2) = Reverse lock enabled - without path optimization
- ACTIVE WAY COMP (1) = Reverse lock active - with way compensation

While the slave accelerates to the speed of the master during engagement, the master and slave do not move synchronously. This function needs to be selected in order to quickly catch up to the master that is running ahead.

# Example:

- Master (black line) rotates in the blocked direction
- The slave (blue line) remains stopped
- Master rotates in the unblocked direction again
- The slave follows the master directly in the unblocked direction

Assume the master has moved two motor revolutions in the direction for which the slave lock is enabled. If the master now moves in the direction for which there is no lock, the slave will immediately start running in that direction.

MOOG ID No.:CB40859-001 Date:11/2020

MSD ServoDrive - DeviceHelp 281

# 8 Motion profile

MOOG ID No.:CB40859-001 Date:11/2020 MSD ServoDrive - DeviceHelp 282

|Filter type|ID|Index Name|Unit|Description|
|---|---|---|---|---|
|When using a real master encoder, encoder signals may be subject to noise.|P 1340|1319|0|MPRO_ECAM_CamMaster_AxisType|
| | |MPRO_ECAM_CamMaster_SpeedFilTyp| |ECAM / EGEAR: Channel selection of internal master input|
| | |1320|0|MPRO_ECAM_CamMaster_RevLockMode|
| | |1321|0|MPRO_ECAM_CamMaster_Amplitude|
| | |1322|0|MPRO_ECAM_CamMaster_GearNum|
| | |1323|0|MPRO_ECAM_CamMaster_GearDen|
|Filter time|1327|0|ms|ECAM / EGEAR: Filter time constant of master|
|If P 1340[0] is used to enable a filter, P 1327[0] - MPRO_ECAM_CamMaster_SpeedTFil can be used to define the corresponding filter time.|1328|0|speed|ECAM / EGEAR: Speed factor of the internal master|
|Speed factor|1340|0| |MPRO_ECAM_CamMaster_SpeedFilTyp|
|The master encoder can be assigned an additional speed factor P 1328[0] - MPRO_ECAM_CamMaster_SpeedFactor.|1341|0|incr|ECAM / EGEAR: Master drive offset|

Table 8.37: “Synchronized motion - Master configuration” parameters (continue)

| | | |ID|Index Name|Unit|Description|
|---|---|---|---|---|---|---|
|247|0|MPRO_ECAM_ParaMaster_ActPos|incr|ECAM / EGEAR: Parameter interface master position| | |
|248|0|MPRO_ECAM_ParaMaster_ActSpeed|rpm|ECAM / EGEAR: Parameter interface master speed| | |
|249|0|MPRO_ECAM_ParaMaster_ActAcc|rpm|ECAM / EGEAR: Parameter interface master acceleration| | |
| |250|0|MPRO_ECAM_ParaMaster_Amplitude| |ECAM / EGEAR: Parameter interface master amplitude| |

Table 8.37: “Synchronized motion - Master configuration” parameters

# 8.11.5 Electronic gearing

# Gear ratio

The gear ratio is specified as a fraction. This ensures that the position references can be translated to the motor shaft with no rounding error.

- ""Slave"" (P 252[0] - MPRO_ECAM_Egear_GearNum) is the numerator
- ""Master"" (P 251[0] - MPRO_ECAM_Egear_GearDen) is the denominator

# Scaling of speed pre-control

Defined with P 265[0] - MPRO_ECAM_CamSlave_SpeedFactor definiert.

# Scaling of torque pre-control

Defined with P 266[0] - MPRO_ECAM_CamSlave_TorqueFactor.

# Engagement

See Section ""Engagement"" on page 284.

# Disengagement

See Section ""Disengagement"" on page 285.

|ID|Index Name|Unit|Description|
|---|---|---|---|
|251|0 MPRO_ECAM_Egear_GearDen| |EGEAR: Gear denominator|
|252|0 MPRO_ECAM_Egear_GearNum| |EGEAR: Numerator of gear ratio|
|1344|0 MPRO_ECAM_Egear_LimRefAcc|rpm/s|EGEAR: Acceleration limit for reference|
|1345|0 MPRO_ECAM_Egear_LimRefJerk|rpm/s²|EGEAR: Jerk limit for reference|

Table 8.38: “Synchronized motion - Electronic gearing” parameters

Image 8.73: ""Electronic gearing"" screen

MOOG ID No.:CB40859-001 Date:11/2020 MSD ServoDrive - DeviceHelp 283

# 8 Motion profile

# 8 Motion profile

MOOG ID No.:CB40859-001 Date:11/2020

MSD ServoDrive - DeviceHelp 284

# 8.11.6 Engagement

used to define the engagement distance (between the dashed lines).

P 253[0] - MPRO_ECAM_Egear_GearInMode is used to define the mode for engagement.

- DIRECT (0) = Direct
- Direct engagement: Angular synchronous; with jerking (no ramps).
- CROSSFADE (3) = Crossfading
- Engagement with crossfading function (5th degree polynomial): Angular synchronous; jerk-limited; speed will overshoot during engagement.
- RAMP (1) = Linear speed ramp
- Engagement with linear acceleration: Not angular synchronous; with jerking.
- FADE (2) = Engagement fade-out
- Engagement with fade-in function (5th degree polynomial): Not angular synchronous; jerk-limited. The position is ignored. ","What parameters are used to define deceleration in torque, speed, and position control modes in the 'MSD ServoDrive - DeviceHelp' document?",A5,"In the MSD ServoDrive document, deceleration parameters are P 194 (torque), P 197 (speed), and P 200 (position).",2.03125,2.03125,3.703125,1.40625,0.46484375
