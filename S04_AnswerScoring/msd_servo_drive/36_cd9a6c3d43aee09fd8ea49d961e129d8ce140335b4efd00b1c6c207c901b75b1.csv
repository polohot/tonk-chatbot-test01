,NODE_FILE_NAME,NODE_NUMBER,NODE_HASH,NODE_TEXT,Q,A_NUMBER,A,helpfulness,correctness,coherence,complexity,verbosity
0,msd_servo_drive.txt,36,cd9a6c3d43aee09fd8ea49d961e129d8ce140335b4efd00b1c6c207c901b75b1,"Before being fed into the circuit, speeds n_kal and n_eps can each be smoothed with a filter (P 351[0] for n_eps and P 339[0] for n_kal). The expanded speed control circuit can be started with P 350[0] (“4” => Kalman).

The inductance difference is important when it comes to sensorless control, as the Kalman filter can determine the position based on the inductance difference in.

Image 6.10: Expanded speed controller layout

Measurements have shown that, when using the expanded control circuit, motors with a marked saliency can be operated in a sensorless manner even without a test signal.

# 6 Encoder

MOOG ID No.:CB40859-001 Date:11/2020

MSD ServoDrive - DeviceHelp 96

In combination with a test signal when the motor is stopped. In addition, the total moment of inertia resulting from the motor and the connected load must be set as accurately as possible.

The encoder communications will be used to calculate and pass the actual speed and actual position. Accordingly, in order to select the sensorless method, a value of 2 must be set for encoder channel 4 in the selector (P 508[0] - ENC_CH4_Sel = 2), and a value of 4 must be set for P 520[0] - ENC_MCon, P 521[0] - ENC_SCon and P 522[0] - ENC_PCon.

The Kalman filter needs to be configured further by following the steps below:

|Step|Action|
|---|---|
|1|Automatically configure noise covariance matrices Q and R by setting the control parameter for encoder channel 4 (P 783[0] - ENC-CH4-Ctrl) to a value of 6.|
| |Manually configure the test signal generator:|
| |Recommendation: Sinusoidal test signal in d axis|
| |P 792[09] = 1|
| |P 792[19] = 500 Hz|
| |P 792[2] = P 792[9] = 10% of rated motor current|
| |P 792[79] = 15% of rated motor speed|
| |P 792[89] = 5% of rated motor speed|
| |P 792[9] = 30% of rated motor current|
| |Set the other values to 0|
|2|Or set the control parameter for encoder channel 4 (P 783[0] - ENC-CH4-Ctrl) to a value of 3, which will trigger a general initialization routine in which steps 1 and 2, as well as encoder initialization, will be automatically carried out based on the motor parameters.|

# Table 6.30: Configuring the Kalman filter for sensorless control

# Step

# Action

In order to make the encoderless control commissioning process easier, a function used to calculate the position difference between encoderless control and a real encoder can be activated. To use this function, the encoder channel that will be used for the comparison must be selected in P 797[0] - ENC_CH4_Kalman_Compare.

As described in Section ""Auto commutation"" on page 92 or Recommendation:

- P 390[0] = 1
- P 392[0] = 500
- P 392[1] = 500
- P 392[2] = 500
- P 392[3] = 500
- P 393[0] = Rated motor current
- P 393[1] = Rated motor current

# Mode 2

Parameters 792.1 and 792.2 are used as the measuring frequency and measuring amplitude (see step 2)

Recommendation:

- P 794[0] = 100 ms
- P 794[1] = 50% of rated motor current
- P 794[2] = 250 ms

Starting the expanded speed control circuit is not absolutely necessary, but will result in control with better dynamic performance. The circuit can be started by setting P 350[0] - SEL_ObserverMethod to a value of 4. P 339 - CON_SCON_Kalman can be used for tuning purposes. If necessary, adjust the noise covariance matrices and the filter time constants for the expanded speed control circuit (changes will take effect in real-time).

# Table 6.30: Configuring the Kalman filter for sensorless control (continue)

MOOG ID No.:CB40859-001 Date:11/2020

MSD ServoDrive - DeviceHelp 97

# 6 Encoder

# 6 Encoder

MOOG ID No.:CB40859-001 Date:11/2020

# 6.8.2.1 Activation of sensorless control for asynchronous motors

Proceed as follows:

|No.|Activity|
|---|---|
|1|Set motor type (P 450[0] - MOT_Type) to “2 (ASM) = asynchronous motor”.|
|2|Enter the motor name (P 451[0] - MOT_Name).|
|3|Copy the motor variables from the rating plate into the appropriate input box.|
|4|Start motor identification to identify other motor parameters. In the “Encoder selection” screen (see also section ""Encoder selection"" on page 53) under “Encoder for commutation and torque control,” set P 520[0] - ENC_MCon to “CH4(4) = virtual encoder (Channel 4)”.|
|5|Under “virtual encoder (Channel 4)” ""Encoder selection"" set (P 508[0] - ENC_CH4_Sel) to ""SFC(8) = take values of SFC model"".|
|6|In the “Basic Control Settings” screen (see section “Basic settings” on page 101) set “Speed filter TF” (P 351[0] - CON_SCALC_Tf) to 10 ms. In the “Asynchronous motor control settings identification” screen (see also section ""Asynchronous motor"" on page 38) enter the “Total moment of inertia” of the system (P 1516[0] - SCD_JSum). Enter a value that is too small rather than too big to avoid a tendency to oscillate. Automatic detection is not advisable due to the control dynamics and accuracy required.|
|7|In the same screen under “Control design by stiffness” set P 1515[0] - SCD_ConDesign (Stiffness) to 10%.|

# Table 6.31: Commissioning a sensorless-controlled asynchronous motor

|P No.|Index Name|Unit|Description|
|---|---|---|---|
|351|CON_SCALC_Tf| |Speed filter|
| |0|ms|Filter time const. speed control (motor)|
| |1|ms|Filter time const. ",How can the expanded speed control circuit be started according to the book 'MSD ServoDrive - DeviceHelp'?,A1,By setting P 350[0] to a value of 4.,1.5859375,1.8125,3.390625,1.25,0.33203125
1,msd_servo_drive.txt,36,cd9a6c3d43aee09fd8ea49d961e129d8ce140335b4efd00b1c6c207c901b75b1,"Before being fed into the circuit, speeds n_kal and n_eps can each be smoothed with a filter (P 351[0] for n_eps and P 339[0] for n_kal). The expanded speed control circuit can be started with P 350[0] (“4” => Kalman).

The inductance difference is important when it comes to sensorless control, as the Kalman filter can determine the position based on the inductance difference in.

Image 6.10: Expanded speed controller layout

Measurements have shown that, when using the expanded control circuit, motors with a marked saliency can be operated in a sensorless manner even without a test signal.

# 6 Encoder

MOOG ID No.:CB40859-001 Date:11/2020

MSD ServoDrive - DeviceHelp 96

In combination with a test signal when the motor is stopped. In addition, the total moment of inertia resulting from the motor and the connected load must be set as accurately as possible.

The encoder communications will be used to calculate and pass the actual speed and actual position. Accordingly, in order to select the sensorless method, a value of 2 must be set for encoder channel 4 in the selector (P 508[0] - ENC_CH4_Sel = 2), and a value of 4 must be set for P 520[0] - ENC_MCon, P 521[0] - ENC_SCon and P 522[0] - ENC_PCon.

The Kalman filter needs to be configured further by following the steps below:

|Step|Action|
|---|---|
|1|Automatically configure noise covariance matrices Q and R by setting the control parameter for encoder channel 4 (P 783[0] - ENC-CH4-Ctrl) to a value of 6.|
| |Manually configure the test signal generator:|
| |Recommendation: Sinusoidal test signal in d axis|
| |P 792[09] = 1|
| |P 792[19] = 500 Hz|
| |P 792[2] = P 792[9] = 10% of rated motor current|
| |P 792[79] = 15% of rated motor speed|
| |P 792[89] = 5% of rated motor speed|
| |P 792[9] = 30% of rated motor current|
| |Set the other values to 0|
|2|Or set the control parameter for encoder channel 4 (P 783[0] - ENC-CH4-Ctrl) to a value of 3, which will trigger a general initialization routine in which steps 1 and 2, as well as encoder initialization, will be automatically carried out based on the motor parameters.|

# Table 6.30: Configuring the Kalman filter for sensorless control

# Step

# Action

In order to make the encoderless control commissioning process easier, a function used to calculate the position difference between encoderless control and a real encoder can be activated. To use this function, the encoder channel that will be used for the comparison must be selected in P 797[0] - ENC_CH4_Kalman_Compare.

As described in Section ""Auto commutation"" on page 92 or Recommendation:

- P 390[0] = 1
- P 392[0] = 500
- P 392[1] = 500
- P 392[2] = 500
- P 392[3] = 500
- P 393[0] = Rated motor current
- P 393[1] = Rated motor current

# Mode 2

Parameters 792.1 and 792.2 are used as the measuring frequency and measuring amplitude (see step 2)

Recommendation:

- P 794[0] = 100 ms
- P 794[1] = 50% of rated motor current
- P 794[2] = 250 ms

Starting the expanded speed control circuit is not absolutely necessary, but will result in control with better dynamic performance. The circuit can be started by setting P 350[0] - SEL_ObserverMethod to a value of 4. P 339 - CON_SCON_Kalman can be used for tuning purposes. If necessary, adjust the noise covariance matrices and the filter time constants for the expanded speed control circuit (changes will take effect in real-time).

# Table 6.30: Configuring the Kalman filter for sensorless control (continue)

MOOG ID No.:CB40859-001 Date:11/2020

MSD ServoDrive - DeviceHelp 97

# 6 Encoder

# 6 Encoder

MOOG ID No.:CB40859-001 Date:11/2020

# 6.8.2.1 Activation of sensorless control for asynchronous motors

Proceed as follows:

|No.|Activity|
|---|---|
|1|Set motor type (P 450[0] - MOT_Type) to “2 (ASM) = asynchronous motor”.|
|2|Enter the motor name (P 451[0] - MOT_Name).|
|3|Copy the motor variables from the rating plate into the appropriate input box.|
|4|Start motor identification to identify other motor parameters. In the “Encoder selection” screen (see also section ""Encoder selection"" on page 53) under “Encoder for commutation and torque control,” set P 520[0] - ENC_MCon to “CH4(4) = virtual encoder (Channel 4)”.|
|5|Under “virtual encoder (Channel 4)” ""Encoder selection"" set (P 508[0] - ENC_CH4_Sel) to ""SFC(8) = take values of SFC model"".|
|6|In the “Basic Control Settings” screen (see section “Basic settings” on page 101) set “Speed filter TF” (P 351[0] - CON_SCALC_Tf) to 10 ms. In the “Asynchronous motor control settings identification” screen (see also section ""Asynchronous motor"" on page 38) enter the “Total moment of inertia” of the system (P 1516[0] - SCD_JSum). Enter a value that is too small rather than too big to avoid a tendency to oscillate. Automatic detection is not advisable due to the control dynamics and accuracy required.|
|7|In the same screen under “Control design by stiffness” set P 1515[0] - SCD_ConDesign (Stiffness) to 10%.|

# Table 6.31: Commissioning a sensorless-controlled asynchronous motor

|P No.|Index Name|Unit|Description|
|---|---|---|---|
|351|CON_SCALC_Tf| |Speed filter|
| |0|ms|Filter time const. speed control (motor)|
| |1|ms|Filter time const. ",How can the expanded speed control circuit be started according to the book 'MSD ServoDrive - DeviceHelp'?,A2,Initiate the circuit by adjusting the control parameter P 350[0] to '4' for Kalman.,1.90625,1.9296875,3.46875,1.3671875,0.4296875
2,msd_servo_drive.txt,36,cd9a6c3d43aee09fd8ea49d961e129d8ce140335b4efd00b1c6c207c901b75b1,"Before being fed into the circuit, speeds n_kal and n_eps can each be smoothed with a filter (P 351[0] for n_eps and P 339[0] for n_kal). The expanded speed control circuit can be started with P 350[0] (“4” => Kalman).

The inductance difference is important when it comes to sensorless control, as the Kalman filter can determine the position based on the inductance difference in.

Image 6.10: Expanded speed controller layout

Measurements have shown that, when using the expanded control circuit, motors with a marked saliency can be operated in a sensorless manner even without a test signal.

# 6 Encoder

MOOG ID No.:CB40859-001 Date:11/2020

MSD ServoDrive - DeviceHelp 96

In combination with a test signal when the motor is stopped. In addition, the total moment of inertia resulting from the motor and the connected load must be set as accurately as possible.

The encoder communications will be used to calculate and pass the actual speed and actual position. Accordingly, in order to select the sensorless method, a value of 2 must be set for encoder channel 4 in the selector (P 508[0] - ENC_CH4_Sel = 2), and a value of 4 must be set for P 520[0] - ENC_MCon, P 521[0] - ENC_SCon and P 522[0] - ENC_PCon.

The Kalman filter needs to be configured further by following the steps below:

|Step|Action|
|---|---|
|1|Automatically configure noise covariance matrices Q and R by setting the control parameter for encoder channel 4 (P 783[0] - ENC-CH4-Ctrl) to a value of 6.|
| |Manually configure the test signal generator:|
| |Recommendation: Sinusoidal test signal in d axis|
| |P 792[09] = 1|
| |P 792[19] = 500 Hz|
| |P 792[2] = P 792[9] = 10% of rated motor current|
| |P 792[79] = 15% of rated motor speed|
| |P 792[89] = 5% of rated motor speed|
| |P 792[9] = 30% of rated motor current|
| |Set the other values to 0|
|2|Or set the control parameter for encoder channel 4 (P 783[0] - ENC-CH4-Ctrl) to a value of 3, which will trigger a general initialization routine in which steps 1 and 2, as well as encoder initialization, will be automatically carried out based on the motor parameters.|

# Table 6.30: Configuring the Kalman filter for sensorless control

# Step

# Action

In order to make the encoderless control commissioning process easier, a function used to calculate the position difference between encoderless control and a real encoder can be activated. To use this function, the encoder channel that will be used for the comparison must be selected in P 797[0] - ENC_CH4_Kalman_Compare.

As described in Section ""Auto commutation"" on page 92 or Recommendation:

- P 390[0] = 1
- P 392[0] = 500
- P 392[1] = 500
- P 392[2] = 500
- P 392[3] = 500
- P 393[0] = Rated motor current
- P 393[1] = Rated motor current

# Mode 2

Parameters 792.1 and 792.2 are used as the measuring frequency and measuring amplitude (see step 2)

Recommendation:

- P 794[0] = 100 ms
- P 794[1] = 50% of rated motor current
- P 794[2] = 250 ms

Starting the expanded speed control circuit is not absolutely necessary, but will result in control with better dynamic performance. The circuit can be started by setting P 350[0] - SEL_ObserverMethod to a value of 4. P 339 - CON_SCON_Kalman can be used for tuning purposes. If necessary, adjust the noise covariance matrices and the filter time constants for the expanded speed control circuit (changes will take effect in real-time).

# Table 6.30: Configuring the Kalman filter for sensorless control (continue)

MOOG ID No.:CB40859-001 Date:11/2020

MSD ServoDrive - DeviceHelp 97

# 6 Encoder

# 6 Encoder

MOOG ID No.:CB40859-001 Date:11/2020

# 6.8.2.1 Activation of sensorless control for asynchronous motors

Proceed as follows:

|No.|Activity|
|---|---|
|1|Set motor type (P 450[0] - MOT_Type) to “2 (ASM) = asynchronous motor”.|
|2|Enter the motor name (P 451[0] - MOT_Name).|
|3|Copy the motor variables from the rating plate into the appropriate input box.|
|4|Start motor identification to identify other motor parameters. In the “Encoder selection” screen (see also section ""Encoder selection"" on page 53) under “Encoder for commutation and torque control,” set P 520[0] - ENC_MCon to “CH4(4) = virtual encoder (Channel 4)”.|
|5|Under “virtual encoder (Channel 4)” ""Encoder selection"" set (P 508[0] - ENC_CH4_Sel) to ""SFC(8) = take values of SFC model"".|
|6|In the “Basic Control Settings” screen (see section “Basic settings” on page 101) set “Speed filter TF” (P 351[0] - CON_SCALC_Tf) to 10 ms. In the “Asynchronous motor control settings identification” screen (see also section ""Asynchronous motor"" on page 38) enter the “Total moment of inertia” of the system (P 1516[0] - SCD_JSum). Enter a value that is too small rather than too big to avoid a tendency to oscillate. Automatic detection is not advisable due to the control dynamics and accuracy required.|
|7|In the same screen under “Control design by stiffness” set P 1515[0] - SCD_ConDesign (Stiffness) to 10%.|

# Table 6.31: Commissioning a sensorless-controlled asynchronous motor

|P No.|Index Name|Unit|Description|
|---|---|---|---|
|351|CON_SCALC_Tf| |Speed filter|
| |0|ms|Filter time const. speed control (motor)|
| |1|ms|Filter time const. ",How can the expanded speed control circuit be started according to the book 'MSD ServoDrive - DeviceHelp'?,A3,The circuit starts when the SEL_ObserverMethod parameter (P 350[0]) is configured to 4.,1.9609375,2.09375,3.578125,1.4140625,0.515625
3,msd_servo_drive.txt,36,cd9a6c3d43aee09fd8ea49d961e129d8ce140335b4efd00b1c6c207c901b75b1,"Before being fed into the circuit, speeds n_kal and n_eps can each be smoothed with a filter (P 351[0] for n_eps and P 339[0] for n_kal). The expanded speed control circuit can be started with P 350[0] (“4” => Kalman).

The inductance difference is important when it comes to sensorless control, as the Kalman filter can determine the position based on the inductance difference in.

Image 6.10: Expanded speed controller layout

Measurements have shown that, when using the expanded control circuit, motors with a marked saliency can be operated in a sensorless manner even without a test signal.

# 6 Encoder

MOOG ID No.:CB40859-001 Date:11/2020

MSD ServoDrive - DeviceHelp 96

In combination with a test signal when the motor is stopped. In addition, the total moment of inertia resulting from the motor and the connected load must be set as accurately as possible.

The encoder communications will be used to calculate and pass the actual speed and actual position. Accordingly, in order to select the sensorless method, a value of 2 must be set for encoder channel 4 in the selector (P 508[0] - ENC_CH4_Sel = 2), and a value of 4 must be set for P 520[0] - ENC_MCon, P 521[0] - ENC_SCon and P 522[0] - ENC_PCon.

The Kalman filter needs to be configured further by following the steps below:

|Step|Action|
|---|---|
|1|Automatically configure noise covariance matrices Q and R by setting the control parameter for encoder channel 4 (P 783[0] - ENC-CH4-Ctrl) to a value of 6.|
| |Manually configure the test signal generator:|
| |Recommendation: Sinusoidal test signal in d axis|
| |P 792[09] = 1|
| |P 792[19] = 500 Hz|
| |P 792[2] = P 792[9] = 10% of rated motor current|
| |P 792[79] = 15% of rated motor speed|
| |P 792[89] = 5% of rated motor speed|
| |P 792[9] = 30% of rated motor current|
| |Set the other values to 0|
|2|Or set the control parameter for encoder channel 4 (P 783[0] - ENC-CH4-Ctrl) to a value of 3, which will trigger a general initialization routine in which steps 1 and 2, as well as encoder initialization, will be automatically carried out based on the motor parameters.|

# Table 6.30: Configuring the Kalman filter for sensorless control

# Step

# Action

In order to make the encoderless control commissioning process easier, a function used to calculate the position difference between encoderless control and a real encoder can be activated. To use this function, the encoder channel that will be used for the comparison must be selected in P 797[0] - ENC_CH4_Kalman_Compare.

As described in Section ""Auto commutation"" on page 92 or Recommendation:

- P 390[0] = 1
- P 392[0] = 500
- P 392[1] = 500
- P 392[2] = 500
- P 392[3] = 500
- P 393[0] = Rated motor current
- P 393[1] = Rated motor current

# Mode 2

Parameters 792.1 and 792.2 are used as the measuring frequency and measuring amplitude (see step 2)

Recommendation:

- P 794[0] = 100 ms
- P 794[1] = 50% of rated motor current
- P 794[2] = 250 ms

Starting the expanded speed control circuit is not absolutely necessary, but will result in control with better dynamic performance. The circuit can be started by setting P 350[0] - SEL_ObserverMethod to a value of 4. P 339 - CON_SCON_Kalman can be used for tuning purposes. If necessary, adjust the noise covariance matrices and the filter time constants for the expanded speed control circuit (changes will take effect in real-time).

# Table 6.30: Configuring the Kalman filter for sensorless control (continue)

MOOG ID No.:CB40859-001 Date:11/2020

MSD ServoDrive - DeviceHelp 97

# 6 Encoder

# 6 Encoder

MOOG ID No.:CB40859-001 Date:11/2020

# 6.8.2.1 Activation of sensorless control for asynchronous motors

Proceed as follows:

|No.|Activity|
|---|---|
|1|Set motor type (P 450[0] - MOT_Type) to “2 (ASM) = asynchronous motor”.|
|2|Enter the motor name (P 451[0] - MOT_Name).|
|3|Copy the motor variables from the rating plate into the appropriate input box.|
|4|Start motor identification to identify other motor parameters. In the “Encoder selection” screen (see also section ""Encoder selection"" on page 53) under “Encoder for commutation and torque control,” set P 520[0] - ENC_MCon to “CH4(4) = virtual encoder (Channel 4)”.|
|5|Under “virtual encoder (Channel 4)” ""Encoder selection"" set (P 508[0] - ENC_CH4_Sel) to ""SFC(8) = take values of SFC model"".|
|6|In the “Basic Control Settings” screen (see section “Basic settings” on page 101) set “Speed filter TF” (P 351[0] - CON_SCALC_Tf) to 10 ms. In the “Asynchronous motor control settings identification” screen (see also section ""Asynchronous motor"" on page 38) enter the “Total moment of inertia” of the system (P 1516[0] - SCD_JSum). Enter a value that is too small rather than too big to avoid a tendency to oscillate. Automatic detection is not advisable due to the control dynamics and accuracy required.|
|7|In the same screen under “Control design by stiffness” set P 1515[0] - SCD_ConDesign (Stiffness) to 10%.|

# Table 6.31: Commissioning a sensorless-controlled asynchronous motor

|P No.|Index Name|Unit|Description|
|---|---|---|---|
|351|CON_SCALC_Tf| |Speed filter|
| |0|ms|Filter time const. speed control (motor)|
| |1|ms|Filter time const. ",How can the expanded speed control circuit be started according to the book 'MSD ServoDrive - DeviceHelp'?,A4,Setting the parameter P 350[0] to '4' activates the expanded speed control circuit using the Kalman method.,1.7578125,1.90625,3.453125,1.4140625,0.5859375
4,msd_servo_drive.txt,36,cd9a6c3d43aee09fd8ea49d961e129d8ce140335b4efd00b1c6c207c901b75b1,"Before being fed into the circuit, speeds n_kal and n_eps can each be smoothed with a filter (P 351[0] for n_eps and P 339[0] for n_kal). The expanded speed control circuit can be started with P 350[0] (“4” => Kalman).

The inductance difference is important when it comes to sensorless control, as the Kalman filter can determine the position based on the inductance difference in.

Image 6.10: Expanded speed controller layout

Measurements have shown that, when using the expanded control circuit, motors with a marked saliency can be operated in a sensorless manner even without a test signal.

# 6 Encoder

MOOG ID No.:CB40859-001 Date:11/2020

MSD ServoDrive - DeviceHelp 96

In combination with a test signal when the motor is stopped. In addition, the total moment of inertia resulting from the motor and the connected load must be set as accurately as possible.

The encoder communications will be used to calculate and pass the actual speed and actual position. Accordingly, in order to select the sensorless method, a value of 2 must be set for encoder channel 4 in the selector (P 508[0] - ENC_CH4_Sel = 2), and a value of 4 must be set for P 520[0] - ENC_MCon, P 521[0] - ENC_SCon and P 522[0] - ENC_PCon.

The Kalman filter needs to be configured further by following the steps below:

|Step|Action|
|---|---|
|1|Automatically configure noise covariance matrices Q and R by setting the control parameter for encoder channel 4 (P 783[0] - ENC-CH4-Ctrl) to a value of 6.|
| |Manually configure the test signal generator:|
| |Recommendation: Sinusoidal test signal in d axis|
| |P 792[09] = 1|
| |P 792[19] = 500 Hz|
| |P 792[2] = P 792[9] = 10% of rated motor current|
| |P 792[79] = 15% of rated motor speed|
| |P 792[89] = 5% of rated motor speed|
| |P 792[9] = 30% of rated motor current|
| |Set the other values to 0|
|2|Or set the control parameter for encoder channel 4 (P 783[0] - ENC-CH4-Ctrl) to a value of 3, which will trigger a general initialization routine in which steps 1 and 2, as well as encoder initialization, will be automatically carried out based on the motor parameters.|

# Table 6.30: Configuring the Kalman filter for sensorless control

# Step

# Action

In order to make the encoderless control commissioning process easier, a function used to calculate the position difference between encoderless control and a real encoder can be activated. To use this function, the encoder channel that will be used for the comparison must be selected in P 797[0] - ENC_CH4_Kalman_Compare.

As described in Section ""Auto commutation"" on page 92 or Recommendation:

- P 390[0] = 1
- P 392[0] = 500
- P 392[1] = 500
- P 392[2] = 500
- P 392[3] = 500
- P 393[0] = Rated motor current
- P 393[1] = Rated motor current

# Mode 2

Parameters 792.1 and 792.2 are used as the measuring frequency and measuring amplitude (see step 2)

Recommendation:

- P 794[0] = 100 ms
- P 794[1] = 50% of rated motor current
- P 794[2] = 250 ms

Starting the expanded speed control circuit is not absolutely necessary, but will result in control with better dynamic performance. The circuit can be started by setting P 350[0] - SEL_ObserverMethod to a value of 4. P 339 - CON_SCON_Kalman can be used for tuning purposes. If necessary, adjust the noise covariance matrices and the filter time constants for the expanded speed control circuit (changes will take effect in real-time).

# Table 6.30: Configuring the Kalman filter for sensorless control (continue)

MOOG ID No.:CB40859-001 Date:11/2020

MSD ServoDrive - DeviceHelp 97

# 6 Encoder

# 6 Encoder

MOOG ID No.:CB40859-001 Date:11/2020

# 6.8.2.1 Activation of sensorless control for asynchronous motors

Proceed as follows:

|No.|Activity|
|---|---|
|1|Set motor type (P 450[0] - MOT_Type) to “2 (ASM) = asynchronous motor”.|
|2|Enter the motor name (P 451[0] - MOT_Name).|
|3|Copy the motor variables from the rating plate into the appropriate input box.|
|4|Start motor identification to identify other motor parameters. In the “Encoder selection” screen (see also section ""Encoder selection"" on page 53) under “Encoder for commutation and torque control,” set P 520[0] - ENC_MCon to “CH4(4) = virtual encoder (Channel 4)”.|
|5|Under “virtual encoder (Channel 4)” ""Encoder selection"" set (P 508[0] - ENC_CH4_Sel) to ""SFC(8) = take values of SFC model"".|
|6|In the “Basic Control Settings” screen (see section “Basic settings” on page 101) set “Speed filter TF” (P 351[0] - CON_SCALC_Tf) to 10 ms. In the “Asynchronous motor control settings identification” screen (see also section ""Asynchronous motor"" on page 38) enter the “Total moment of inertia” of the system (P 1516[0] - SCD_JSum). Enter a value that is too small rather than too big to avoid a tendency to oscillate. Automatic detection is not advisable due to the control dynamics and accuracy required.|
|7|In the same screen under “Control design by stiffness” set P 1515[0] - SCD_ConDesign (Stiffness) to 10%.|

# Table 6.31: Commissioning a sensorless-controlled asynchronous motor

|P No.|Index Name|Unit|Description|
|---|---|---|---|
|351|CON_SCALC_Tf| |Speed filter|
| |0|ms|Filter time const. speed control (motor)|
| |1|ms|Filter time const. ",How can the expanded speed control circuit be started according to the book 'MSD ServoDrive - DeviceHelp'?,A5,"Activation requires configuring P 350[0] as '4', which selects the Kalman filter for the expanded speed control.",1.21875,1.2890625,3.265625,1.3125,0.61328125
5,msd_servo_drive.txt,36,cd9a6c3d43aee09fd8ea49d961e129d8ce140335b4efd00b1c6c207c901b75b1,"Before being fed into the circuit, speeds n_kal and n_eps can each be smoothed with a filter (P 351[0] for n_eps and P 339[0] for n_kal). The expanded speed control circuit can be started with P 350[0] (“4” => Kalman).

The inductance difference is important when it comes to sensorless control, as the Kalman filter can determine the position based on the inductance difference in.

Image 6.10: Expanded speed controller layout

Measurements have shown that, when using the expanded control circuit, motors with a marked saliency can be operated in a sensorless manner even without a test signal.

# 6 Encoder

MOOG ID No.:CB40859-001 Date:11/2020

MSD ServoDrive - DeviceHelp 96

In combination with a test signal when the motor is stopped. In addition, the total moment of inertia resulting from the motor and the connected load must be set as accurately as possible.

The encoder communications will be used to calculate and pass the actual speed and actual position. Accordingly, in order to select the sensorless method, a value of 2 must be set for encoder channel 4 in the selector (P 508[0] - ENC_CH4_Sel = 2), and a value of 4 must be set for P 520[0] - ENC_MCon, P 521[0] - ENC_SCon and P 522[0] - ENC_PCon.

The Kalman filter needs to be configured further by following the steps below:

|Step|Action|
|---|---|
|1|Automatically configure noise covariance matrices Q and R by setting the control parameter for encoder channel 4 (P 783[0] - ENC-CH4-Ctrl) to a value of 6.|
| |Manually configure the test signal generator:|
| |Recommendation: Sinusoidal test signal in d axis|
| |P 792[09] = 1|
| |P 792[19] = 500 Hz|
| |P 792[2] = P 792[9] = 10% of rated motor current|
| |P 792[79] = 15% of rated motor speed|
| |P 792[89] = 5% of rated motor speed|
| |P 792[9] = 30% of rated motor current|
| |Set the other values to 0|
|2|Or set the control parameter for encoder channel 4 (P 783[0] - ENC-CH4-Ctrl) to a value of 3, which will trigger a general initialization routine in which steps 1 and 2, as well as encoder initialization, will be automatically carried out based on the motor parameters.|

# Table 6.30: Configuring the Kalman filter for sensorless control

# Step

# Action

In order to make the encoderless control commissioning process easier, a function used to calculate the position difference between encoderless control and a real encoder can be activated. To use this function, the encoder channel that will be used for the comparison must be selected in P 797[0] - ENC_CH4_Kalman_Compare.

As described in Section ""Auto commutation"" on page 92 or Recommendation:

- P 390[0] = 1
- P 392[0] = 500
- P 392[1] = 500
- P 392[2] = 500
- P 392[3] = 500
- P 393[0] = Rated motor current
- P 393[1] = Rated motor current

# Mode 2

Parameters 792.1 and 792.2 are used as the measuring frequency and measuring amplitude (see step 2)

Recommendation:

- P 794[0] = 100 ms
- P 794[1] = 50% of rated motor current
- P 794[2] = 250 ms

Starting the expanded speed control circuit is not absolutely necessary, but will result in control with better dynamic performance. The circuit can be started by setting P 350[0] - SEL_ObserverMethod to a value of 4. P 339 - CON_SCON_Kalman can be used for tuning purposes. If necessary, adjust the noise covariance matrices and the filter time constants for the expanded speed control circuit (changes will take effect in real-time).

# Table 6.30: Configuring the Kalman filter for sensorless control (continue)

MOOG ID No.:CB40859-001 Date:11/2020

MSD ServoDrive - DeviceHelp 97

# 6 Encoder

# 6 Encoder

MOOG ID No.:CB40859-001 Date:11/2020

# 6.8.2.1 Activation of sensorless control for asynchronous motors

Proceed as follows:

|No.|Activity|
|---|---|
|1|Set motor type (P 450[0] - MOT_Type) to “2 (ASM) = asynchronous motor”.|
|2|Enter the motor name (P 451[0] - MOT_Name).|
|3|Copy the motor variables from the rating plate into the appropriate input box.|
|4|Start motor identification to identify other motor parameters. In the “Encoder selection” screen (see also section ""Encoder selection"" on page 53) under “Encoder for commutation and torque control,” set P 520[0] - ENC_MCon to “CH4(4) = virtual encoder (Channel 4)”.|
|5|Under “virtual encoder (Channel 4)” ""Encoder selection"" set (P 508[0] - ENC_CH4_Sel) to ""SFC(8) = take values of SFC model"".|
|6|In the “Basic Control Settings” screen (see section “Basic settings” on page 101) set “Speed filter TF” (P 351[0] - CON_SCALC_Tf) to 10 ms. In the “Asynchronous motor control settings identification” screen (see also section ""Asynchronous motor"" on page 38) enter the “Total moment of inertia” of the system (P 1516[0] - SCD_JSum). Enter a value that is too small rather than too big to avoid a tendency to oscillate. Automatic detection is not advisable due to the control dynamics and accuracy required.|
|7|In the same screen under “Control design by stiffness” set P 1515[0] - SCD_ConDesign (Stiffness) to 10%.|

# Table 6.31: Commissioning a sensorless-controlled asynchronous motor

|P No.|Index Name|Unit|Description|
|---|---|---|---|
|351|CON_SCALC_Tf| |Speed filter|
| |0|ms|Filter time const. speed control (motor)|
| |1|ms|Filter time const. ",How is sensorless control activated for asynchronous motors in 'MSD ServoDrive - DeviceHelp'?,A1,By setting the motor type to asynchronous and configuring specific parameters including encoder and control settings.,1.65625,1.6328125,3.46875,1.234375,0.52734375
6,msd_servo_drive.txt,36,cd9a6c3d43aee09fd8ea49d961e129d8ce140335b4efd00b1c6c207c901b75b1,"Before being fed into the circuit, speeds n_kal and n_eps can each be smoothed with a filter (P 351[0] for n_eps and P 339[0] for n_kal). The expanded speed control circuit can be started with P 350[0] (“4” => Kalman).

The inductance difference is important when it comes to sensorless control, as the Kalman filter can determine the position based on the inductance difference in.

Image 6.10: Expanded speed controller layout

Measurements have shown that, when using the expanded control circuit, motors with a marked saliency can be operated in a sensorless manner even without a test signal.

# 6 Encoder

MOOG ID No.:CB40859-001 Date:11/2020

MSD ServoDrive - DeviceHelp 96

In combination with a test signal when the motor is stopped. In addition, the total moment of inertia resulting from the motor and the connected load must be set as accurately as possible.

The encoder communications will be used to calculate and pass the actual speed and actual position. Accordingly, in order to select the sensorless method, a value of 2 must be set for encoder channel 4 in the selector (P 508[0] - ENC_CH4_Sel = 2), and a value of 4 must be set for P 520[0] - ENC_MCon, P 521[0] - ENC_SCon and P 522[0] - ENC_PCon.

The Kalman filter needs to be configured further by following the steps below:

|Step|Action|
|---|---|
|1|Automatically configure noise covariance matrices Q and R by setting the control parameter for encoder channel 4 (P 783[0] - ENC-CH4-Ctrl) to a value of 6.|
| |Manually configure the test signal generator:|
| |Recommendation: Sinusoidal test signal in d axis|
| |P 792[09] = 1|
| |P 792[19] = 500 Hz|
| |P 792[2] = P 792[9] = 10% of rated motor current|
| |P 792[79] = 15% of rated motor speed|
| |P 792[89] = 5% of rated motor speed|
| |P 792[9] = 30% of rated motor current|
| |Set the other values to 0|
|2|Or set the control parameter for encoder channel 4 (P 783[0] - ENC-CH4-Ctrl) to a value of 3, which will trigger a general initialization routine in which steps 1 and 2, as well as encoder initialization, will be automatically carried out based on the motor parameters.|

# Table 6.30: Configuring the Kalman filter for sensorless control

# Step

# Action

In order to make the encoderless control commissioning process easier, a function used to calculate the position difference between encoderless control and a real encoder can be activated. To use this function, the encoder channel that will be used for the comparison must be selected in P 797[0] - ENC_CH4_Kalman_Compare.

As described in Section ""Auto commutation"" on page 92 or Recommendation:

- P 390[0] = 1
- P 392[0] = 500
- P 392[1] = 500
- P 392[2] = 500
- P 392[3] = 500
- P 393[0] = Rated motor current
- P 393[1] = Rated motor current

# Mode 2

Parameters 792.1 and 792.2 are used as the measuring frequency and measuring amplitude (see step 2)

Recommendation:

- P 794[0] = 100 ms
- P 794[1] = 50% of rated motor current
- P 794[2] = 250 ms

Starting the expanded speed control circuit is not absolutely necessary, but will result in control with better dynamic performance. The circuit can be started by setting P 350[0] - SEL_ObserverMethod to a value of 4. P 339 - CON_SCON_Kalman can be used for tuning purposes. If necessary, adjust the noise covariance matrices and the filter time constants for the expanded speed control circuit (changes will take effect in real-time).

# Table 6.30: Configuring the Kalman filter for sensorless control (continue)

MOOG ID No.:CB40859-001 Date:11/2020

MSD ServoDrive - DeviceHelp 97

# 6 Encoder

# 6 Encoder

MOOG ID No.:CB40859-001 Date:11/2020

# 6.8.2.1 Activation of sensorless control for asynchronous motors

Proceed as follows:

|No.|Activity|
|---|---|
|1|Set motor type (P 450[0] - MOT_Type) to “2 (ASM) = asynchronous motor”.|
|2|Enter the motor name (P 451[0] - MOT_Name).|
|3|Copy the motor variables from the rating plate into the appropriate input box.|
|4|Start motor identification to identify other motor parameters. In the “Encoder selection” screen (see also section ""Encoder selection"" on page 53) under “Encoder for commutation and torque control,” set P 520[0] - ENC_MCon to “CH4(4) = virtual encoder (Channel 4)”.|
|5|Under “virtual encoder (Channel 4)” ""Encoder selection"" set (P 508[0] - ENC_CH4_Sel) to ""SFC(8) = take values of SFC model"".|
|6|In the “Basic Control Settings” screen (see section “Basic settings” on page 101) set “Speed filter TF” (P 351[0] - CON_SCALC_Tf) to 10 ms. In the “Asynchronous motor control settings identification” screen (see also section ""Asynchronous motor"" on page 38) enter the “Total moment of inertia” of the system (P 1516[0] - SCD_JSum). Enter a value that is too small rather than too big to avoid a tendency to oscillate. Automatic detection is not advisable due to the control dynamics and accuracy required.|
|7|In the same screen under “Control design by stiffness” set P 1515[0] - SCD_ConDesign (Stiffness) to 10%.|

# Table 6.31: Commissioning a sensorless-controlled asynchronous motor

|P No.|Index Name|Unit|Description|
|---|---|---|---|
|351|CON_SCALC_Tf| |Speed filter|
| |0|ms|Filter time const. speed control (motor)|
| |1|ms|Filter time const. ",How is sensorless control activated for asynchronous motors in 'MSD ServoDrive - DeviceHelp'?,A2,"Activation involves selecting the motor type, entering motor details, and adjusting encoder and control parameters.",1.0546875,1.1953125,3.390625,1.1875,0.55859375
7,msd_servo_drive.txt,36,cd9a6c3d43aee09fd8ea49d961e129d8ce140335b4efd00b1c6c207c901b75b1,"Before being fed into the circuit, speeds n_kal and n_eps can each be smoothed with a filter (P 351[0] for n_eps and P 339[0] for n_kal). The expanded speed control circuit can be started with P 350[0] (“4” => Kalman).

The inductance difference is important when it comes to sensorless control, as the Kalman filter can determine the position based on the inductance difference in.

Image 6.10: Expanded speed controller layout

Measurements have shown that, when using the expanded control circuit, motors with a marked saliency can be operated in a sensorless manner even without a test signal.

# 6 Encoder

MOOG ID No.:CB40859-001 Date:11/2020

MSD ServoDrive - DeviceHelp 96

In combination with a test signal when the motor is stopped. In addition, the total moment of inertia resulting from the motor and the connected load must be set as accurately as possible.

The encoder communications will be used to calculate and pass the actual speed and actual position. Accordingly, in order to select the sensorless method, a value of 2 must be set for encoder channel 4 in the selector (P 508[0] - ENC_CH4_Sel = 2), and a value of 4 must be set for P 520[0] - ENC_MCon, P 521[0] - ENC_SCon and P 522[0] - ENC_PCon.

The Kalman filter needs to be configured further by following the steps below:

|Step|Action|
|---|---|
|1|Automatically configure noise covariance matrices Q and R by setting the control parameter for encoder channel 4 (P 783[0] - ENC-CH4-Ctrl) to a value of 6.|
| |Manually configure the test signal generator:|
| |Recommendation: Sinusoidal test signal in d axis|
| |P 792[09] = 1|
| |P 792[19] = 500 Hz|
| |P 792[2] = P 792[9] = 10% of rated motor current|
| |P 792[79] = 15% of rated motor speed|
| |P 792[89] = 5% of rated motor speed|
| |P 792[9] = 30% of rated motor current|
| |Set the other values to 0|
|2|Or set the control parameter for encoder channel 4 (P 783[0] - ENC-CH4-Ctrl) to a value of 3, which will trigger a general initialization routine in which steps 1 and 2, as well as encoder initialization, will be automatically carried out based on the motor parameters.|

# Table 6.30: Configuring the Kalman filter for sensorless control

# Step

# Action

In order to make the encoderless control commissioning process easier, a function used to calculate the position difference between encoderless control and a real encoder can be activated. To use this function, the encoder channel that will be used for the comparison must be selected in P 797[0] - ENC_CH4_Kalman_Compare.

As described in Section ""Auto commutation"" on page 92 or Recommendation:

- P 390[0] = 1
- P 392[0] = 500
- P 392[1] = 500
- P 392[2] = 500
- P 392[3] = 500
- P 393[0] = Rated motor current
- P 393[1] = Rated motor current

# Mode 2

Parameters 792.1 and 792.2 are used as the measuring frequency and measuring amplitude (see step 2)

Recommendation:

- P 794[0] = 100 ms
- P 794[1] = 50% of rated motor current
- P 794[2] = 250 ms

Starting the expanded speed control circuit is not absolutely necessary, but will result in control with better dynamic performance. The circuit can be started by setting P 350[0] - SEL_ObserverMethod to a value of 4. P 339 - CON_SCON_Kalman can be used for tuning purposes. If necessary, adjust the noise covariance matrices and the filter time constants for the expanded speed control circuit (changes will take effect in real-time).

# Table 6.30: Configuring the Kalman filter for sensorless control (continue)

MOOG ID No.:CB40859-001 Date:11/2020

MSD ServoDrive - DeviceHelp 97

# 6 Encoder

# 6 Encoder

MOOG ID No.:CB40859-001 Date:11/2020

# 6.8.2.1 Activation of sensorless control for asynchronous motors

Proceed as follows:

|No.|Activity|
|---|---|
|1|Set motor type (P 450[0] - MOT_Type) to “2 (ASM) = asynchronous motor”.|
|2|Enter the motor name (P 451[0] - MOT_Name).|
|3|Copy the motor variables from the rating plate into the appropriate input box.|
|4|Start motor identification to identify other motor parameters. In the “Encoder selection” screen (see also section ""Encoder selection"" on page 53) under “Encoder for commutation and torque control,” set P 520[0] - ENC_MCon to “CH4(4) = virtual encoder (Channel 4)”.|
|5|Under “virtual encoder (Channel 4)” ""Encoder selection"" set (P 508[0] - ENC_CH4_Sel) to ""SFC(8) = take values of SFC model"".|
|6|In the “Basic Control Settings” screen (see section “Basic settings” on page 101) set “Speed filter TF” (P 351[0] - CON_SCALC_Tf) to 10 ms. In the “Asynchronous motor control settings identification” screen (see also section ""Asynchronous motor"" on page 38) enter the “Total moment of inertia” of the system (P 1516[0] - SCD_JSum). Enter a value that is too small rather than too big to avoid a tendency to oscillate. Automatic detection is not advisable due to the control dynamics and accuracy required.|
|7|In the same screen under “Control design by stiffness” set P 1515[0] - SCD_ConDesign (Stiffness) to 10%.|

# Table 6.31: Commissioning a sensorless-controlled asynchronous motor

|P No.|Index Name|Unit|Description|
|---|---|---|---|
|351|CON_SCALC_Tf| |Speed filter|
| |0|ms|Filter time const. speed control (motor)|
| |1|ms|Filter time const. ",How is sensorless control activated for asynchronous motors in 'MSD ServoDrive - DeviceHelp'?,A3,"The process includes setting the motor as asynchronous, specifying encoder settings, and configuring control parameters.",1.2421875,1.25,3.296875,1.2734375,0.546875
8,msd_servo_drive.txt,36,cd9a6c3d43aee09fd8ea49d961e129d8ce140335b4efd00b1c6c207c901b75b1,"Before being fed into the circuit, speeds n_kal and n_eps can each be smoothed with a filter (P 351[0] for n_eps and P 339[0] for n_kal). The expanded speed control circuit can be started with P 350[0] (“4” => Kalman).

The inductance difference is important when it comes to sensorless control, as the Kalman filter can determine the position based on the inductance difference in.

Image 6.10: Expanded speed controller layout

Measurements have shown that, when using the expanded control circuit, motors with a marked saliency can be operated in a sensorless manner even without a test signal.

# 6 Encoder

MOOG ID No.:CB40859-001 Date:11/2020

MSD ServoDrive - DeviceHelp 96

In combination with a test signal when the motor is stopped. In addition, the total moment of inertia resulting from the motor and the connected load must be set as accurately as possible.

The encoder communications will be used to calculate and pass the actual speed and actual position. Accordingly, in order to select the sensorless method, a value of 2 must be set for encoder channel 4 in the selector (P 508[0] - ENC_CH4_Sel = 2), and a value of 4 must be set for P 520[0] - ENC_MCon, P 521[0] - ENC_SCon and P 522[0] - ENC_PCon.

The Kalman filter needs to be configured further by following the steps below:

|Step|Action|
|---|---|
|1|Automatically configure noise covariance matrices Q and R by setting the control parameter for encoder channel 4 (P 783[0] - ENC-CH4-Ctrl) to a value of 6.|
| |Manually configure the test signal generator:|
| |Recommendation: Sinusoidal test signal in d axis|
| |P 792[09] = 1|
| |P 792[19] = 500 Hz|
| |P 792[2] = P 792[9] = 10% of rated motor current|
| |P 792[79] = 15% of rated motor speed|
| |P 792[89] = 5% of rated motor speed|
| |P 792[9] = 30% of rated motor current|
| |Set the other values to 0|
|2|Or set the control parameter for encoder channel 4 (P 783[0] - ENC-CH4-Ctrl) to a value of 3, which will trigger a general initialization routine in which steps 1 and 2, as well as encoder initialization, will be automatically carried out based on the motor parameters.|

# Table 6.30: Configuring the Kalman filter for sensorless control

# Step

# Action

In order to make the encoderless control commissioning process easier, a function used to calculate the position difference between encoderless control and a real encoder can be activated. To use this function, the encoder channel that will be used for the comparison must be selected in P 797[0] - ENC_CH4_Kalman_Compare.

As described in Section ""Auto commutation"" on page 92 or Recommendation:

- P 390[0] = 1
- P 392[0] = 500
- P 392[1] = 500
- P 392[2] = 500
- P 392[3] = 500
- P 393[0] = Rated motor current
- P 393[1] = Rated motor current

# Mode 2

Parameters 792.1 and 792.2 are used as the measuring frequency and measuring amplitude (see step 2)

Recommendation:

- P 794[0] = 100 ms
- P 794[1] = 50% of rated motor current
- P 794[2] = 250 ms

Starting the expanded speed control circuit is not absolutely necessary, but will result in control with better dynamic performance. The circuit can be started by setting P 350[0] - SEL_ObserverMethod to a value of 4. P 339 - CON_SCON_Kalman can be used for tuning purposes. If necessary, adjust the noise covariance matrices and the filter time constants for the expanded speed control circuit (changes will take effect in real-time).

# Table 6.30: Configuring the Kalman filter for sensorless control (continue)

MOOG ID No.:CB40859-001 Date:11/2020

MSD ServoDrive - DeviceHelp 97

# 6 Encoder

# 6 Encoder

MOOG ID No.:CB40859-001 Date:11/2020

# 6.8.2.1 Activation of sensorless control for asynchronous motors

Proceed as follows:

|No.|Activity|
|---|---|
|1|Set motor type (P 450[0] - MOT_Type) to “2 (ASM) = asynchronous motor”.|
|2|Enter the motor name (P 451[0] - MOT_Name).|
|3|Copy the motor variables from the rating plate into the appropriate input box.|
|4|Start motor identification to identify other motor parameters. In the “Encoder selection” screen (see also section ""Encoder selection"" on page 53) under “Encoder for commutation and torque control,” set P 520[0] - ENC_MCon to “CH4(4) = virtual encoder (Channel 4)”.|
|5|Under “virtual encoder (Channel 4)” ""Encoder selection"" set (P 508[0] - ENC_CH4_Sel) to ""SFC(8) = take values of SFC model"".|
|6|In the “Basic Control Settings” screen (see section “Basic settings” on page 101) set “Speed filter TF” (P 351[0] - CON_SCALC_Tf) to 10 ms. In the “Asynchronous motor control settings identification” screen (see also section ""Asynchronous motor"" on page 38) enter the “Total moment of inertia” of the system (P 1516[0] - SCD_JSum). Enter a value that is too small rather than too big to avoid a tendency to oscillate. Automatic detection is not advisable due to the control dynamics and accuracy required.|
|7|In the same screen under “Control design by stiffness” set P 1515[0] - SCD_ConDesign (Stiffness) to 10%.|

# Table 6.31: Commissioning a sensorless-controlled asynchronous motor

|P No.|Index Name|Unit|Description|
|---|---|---|---|
|351|CON_SCALC_Tf| |Speed filter|
| |0|ms|Filter time const. speed control (motor)|
| |1|ms|Filter time const. ",How is sensorless control activated for asynchronous motors in 'MSD ServoDrive - DeviceHelp'?,A4,"For asynchronous motors, sensorless control is enabled through a series of parameter adjustments and motor identification.",1.2734375,1.515625,3.046875,1.3515625,0.267578125
9,msd_servo_drive.txt,36,cd9a6c3d43aee09fd8ea49d961e129d8ce140335b4efd00b1c6c207c901b75b1,"Before being fed into the circuit, speeds n_kal and n_eps can each be smoothed with a filter (P 351[0] for n_eps and P 339[0] for n_kal). The expanded speed control circuit can be started with P 350[0] (“4” => Kalman).

The inductance difference is important when it comes to sensorless control, as the Kalman filter can determine the position based on the inductance difference in.

Image 6.10: Expanded speed controller layout

Measurements have shown that, when using the expanded control circuit, motors with a marked saliency can be operated in a sensorless manner even without a test signal.

# 6 Encoder

MOOG ID No.:CB40859-001 Date:11/2020

MSD ServoDrive - DeviceHelp 96

In combination with a test signal when the motor is stopped. In addition, the total moment of inertia resulting from the motor and the connected load must be set as accurately as possible.

The encoder communications will be used to calculate and pass the actual speed and actual position. Accordingly, in order to select the sensorless method, a value of 2 must be set for encoder channel 4 in the selector (P 508[0] - ENC_CH4_Sel = 2), and a value of 4 must be set for P 520[0] - ENC_MCon, P 521[0] - ENC_SCon and P 522[0] - ENC_PCon.

The Kalman filter needs to be configured further by following the steps below:

|Step|Action|
|---|---|
|1|Automatically configure noise covariance matrices Q and R by setting the control parameter for encoder channel 4 (P 783[0] - ENC-CH4-Ctrl) to a value of 6.|
| |Manually configure the test signal generator:|
| |Recommendation: Sinusoidal test signal in d axis|
| |P 792[09] = 1|
| |P 792[19] = 500 Hz|
| |P 792[2] = P 792[9] = 10% of rated motor current|
| |P 792[79] = 15% of rated motor speed|
| |P 792[89] = 5% of rated motor speed|
| |P 792[9] = 30% of rated motor current|
| |Set the other values to 0|
|2|Or set the control parameter for encoder channel 4 (P 783[0] - ENC-CH4-Ctrl) to a value of 3, which will trigger a general initialization routine in which steps 1 and 2, as well as encoder initialization, will be automatically carried out based on the motor parameters.|

# Table 6.30: Configuring the Kalman filter for sensorless control

# Step

# Action

In order to make the encoderless control commissioning process easier, a function used to calculate the position difference between encoderless control and a real encoder can be activated. To use this function, the encoder channel that will be used for the comparison must be selected in P 797[0] - ENC_CH4_Kalman_Compare.

As described in Section ""Auto commutation"" on page 92 or Recommendation:

- P 390[0] = 1
- P 392[0] = 500
- P 392[1] = 500
- P 392[2] = 500
- P 392[3] = 500
- P 393[0] = Rated motor current
- P 393[1] = Rated motor current

# Mode 2

Parameters 792.1 and 792.2 are used as the measuring frequency and measuring amplitude (see step 2)

Recommendation:

- P 794[0] = 100 ms
- P 794[1] = 50% of rated motor current
- P 794[2] = 250 ms

Starting the expanded speed control circuit is not absolutely necessary, but will result in control with better dynamic performance. The circuit can be started by setting P 350[0] - SEL_ObserverMethod to a value of 4. P 339 - CON_SCON_Kalman can be used for tuning purposes. If necessary, adjust the noise covariance matrices and the filter time constants for the expanded speed control circuit (changes will take effect in real-time).

# Table 6.30: Configuring the Kalman filter for sensorless control (continue)

MOOG ID No.:CB40859-001 Date:11/2020

MSD ServoDrive - DeviceHelp 97

# 6 Encoder

# 6 Encoder

MOOG ID No.:CB40859-001 Date:11/2020

# 6.8.2.1 Activation of sensorless control for asynchronous motors

Proceed as follows:

|No.|Activity|
|---|---|
|1|Set motor type (P 450[0] - MOT_Type) to “2 (ASM) = asynchronous motor”.|
|2|Enter the motor name (P 451[0] - MOT_Name).|
|3|Copy the motor variables from the rating plate into the appropriate input box.|
|4|Start motor identification to identify other motor parameters. In the “Encoder selection” screen (see also section ""Encoder selection"" on page 53) under “Encoder for commutation and torque control,” set P 520[0] - ENC_MCon to “CH4(4) = virtual encoder (Channel 4)”.|
|5|Under “virtual encoder (Channel 4)” ""Encoder selection"" set (P 508[0] - ENC_CH4_Sel) to ""SFC(8) = take values of SFC model"".|
|6|In the “Basic Control Settings” screen (see section “Basic settings” on page 101) set “Speed filter TF” (P 351[0] - CON_SCALC_Tf) to 10 ms. In the “Asynchronous motor control settings identification” screen (see also section ""Asynchronous motor"" on page 38) enter the “Total moment of inertia” of the system (P 1516[0] - SCD_JSum). Enter a value that is too small rather than too big to avoid a tendency to oscillate. Automatic detection is not advisable due to the control dynamics and accuracy required.|
|7|In the same screen under “Control design by stiffness” set P 1515[0] - SCD_ConDesign (Stiffness) to 10%.|

# Table 6.31: Commissioning a sensorless-controlled asynchronous motor

|P No.|Index Name|Unit|Description|
|---|---|---|---|
|351|CON_SCALC_Tf| |Speed filter|
| |0|ms|Filter time const. speed control (motor)|
| |1|ms|Filter time const. ",How is sensorless control activated for asynchronous motors in 'MSD ServoDrive - DeviceHelp'?,A5,"Enabling sensorless control for asynchronous motors requires motor type selection, parameter entry, and specific encoder and control configurations.",1.09375,1.3515625,3.21875,1.46875,0.453125
10,msd_servo_drive.txt,36,cd9a6c3d43aee09fd8ea49d961e129d8ce140335b4efd00b1c6c207c901b75b1,"Before being fed into the circuit, speeds n_kal and n_eps can each be smoothed with a filter (P 351[0] for n_eps and P 339[0] for n_kal). The expanded speed control circuit can be started with P 350[0] (“4” => Kalman).

The inductance difference is important when it comes to sensorless control, as the Kalman filter can determine the position based on the inductance difference in.

Image 6.10: Expanded speed controller layout

Measurements have shown that, when using the expanded control circuit, motors with a marked saliency can be operated in a sensorless manner even without a test signal.

# 6 Encoder

MOOG ID No.:CB40859-001 Date:11/2020

MSD ServoDrive - DeviceHelp 96

In combination with a test signal when the motor is stopped. In addition, the total moment of inertia resulting from the motor and the connected load must be set as accurately as possible.

The encoder communications will be used to calculate and pass the actual speed and actual position. Accordingly, in order to select the sensorless method, a value of 2 must be set for encoder channel 4 in the selector (P 508[0] - ENC_CH4_Sel = 2), and a value of 4 must be set for P 520[0] - ENC_MCon, P 521[0] - ENC_SCon and P 522[0] - ENC_PCon.

The Kalman filter needs to be configured further by following the steps below:

|Step|Action|
|---|---|
|1|Automatically configure noise covariance matrices Q and R by setting the control parameter for encoder channel 4 (P 783[0] - ENC-CH4-Ctrl) to a value of 6.|
| |Manually configure the test signal generator:|
| |Recommendation: Sinusoidal test signal in d axis|
| |P 792[09] = 1|
| |P 792[19] = 500 Hz|
| |P 792[2] = P 792[9] = 10% of rated motor current|
| |P 792[79] = 15% of rated motor speed|
| |P 792[89] = 5% of rated motor speed|
| |P 792[9] = 30% of rated motor current|
| |Set the other values to 0|
|2|Or set the control parameter for encoder channel 4 (P 783[0] - ENC-CH4-Ctrl) to a value of 3, which will trigger a general initialization routine in which steps 1 and 2, as well as encoder initialization, will be automatically carried out based on the motor parameters.|

# Table 6.30: Configuring the Kalman filter for sensorless control

# Step

# Action

In order to make the encoderless control commissioning process easier, a function used to calculate the position difference between encoderless control and a real encoder can be activated. To use this function, the encoder channel that will be used for the comparison must be selected in P 797[0] - ENC_CH4_Kalman_Compare.

As described in Section ""Auto commutation"" on page 92 or Recommendation:

- P 390[0] = 1
- P 392[0] = 500
- P 392[1] = 500
- P 392[2] = 500
- P 392[3] = 500
- P 393[0] = Rated motor current
- P 393[1] = Rated motor current

# Mode 2

Parameters 792.1 and 792.2 are used as the measuring frequency and measuring amplitude (see step 2)

Recommendation:

- P 794[0] = 100 ms
- P 794[1] = 50% of rated motor current
- P 794[2] = 250 ms

Starting the expanded speed control circuit is not absolutely necessary, but will result in control with better dynamic performance. The circuit can be started by setting P 350[0] - SEL_ObserverMethod to a value of 4. P 339 - CON_SCON_Kalman can be used for tuning purposes. If necessary, adjust the noise covariance matrices and the filter time constants for the expanded speed control circuit (changes will take effect in real-time).

# Table 6.30: Configuring the Kalman filter for sensorless control (continue)

MOOG ID No.:CB40859-001 Date:11/2020

MSD ServoDrive - DeviceHelp 97

# 6 Encoder

# 6 Encoder

MOOG ID No.:CB40859-001 Date:11/2020

# 6.8.2.1 Activation of sensorless control for asynchronous motors

Proceed as follows:

|No.|Activity|
|---|---|
|1|Set motor type (P 450[0] - MOT_Type) to “2 (ASM) = asynchronous motor”.|
|2|Enter the motor name (P 451[0] - MOT_Name).|
|3|Copy the motor variables from the rating plate into the appropriate input box.|
|4|Start motor identification to identify other motor parameters. In the “Encoder selection” screen (see also section ""Encoder selection"" on page 53) under “Encoder for commutation and torque control,” set P 520[0] - ENC_MCon to “CH4(4) = virtual encoder (Channel 4)”.|
|5|Under “virtual encoder (Channel 4)” ""Encoder selection"" set (P 508[0] - ENC_CH4_Sel) to ""SFC(8) = take values of SFC model"".|
|6|In the “Basic Control Settings” screen (see section “Basic settings” on page 101) set “Speed filter TF” (P 351[0] - CON_SCALC_Tf) to 10 ms. In the “Asynchronous motor control settings identification” screen (see also section ""Asynchronous motor"" on page 38) enter the “Total moment of inertia” of the system (P 1516[0] - SCD_JSum). Enter a value that is too small rather than too big to avoid a tendency to oscillate. Automatic detection is not advisable due to the control dynamics and accuracy required.|
|7|In the same screen under “Control design by stiffness” set P 1515[0] - SCD_ConDesign (Stiffness) to 10%.|

# Table 6.31: Commissioning a sensorless-controlled asynchronous motor

|P No.|Index Name|Unit|Description|
|---|---|---|---|
|351|CON_SCALC_Tf| |Speed filter|
| |0|ms|Filter time const. speed control (motor)|
| |1|ms|Filter time const. ",How is the Kalman filter configured for sensorless control in 'MSD ServoDrive - DeviceHelp'?,A1,By automatically or manually configuring noise covariance matrices Q and R and setting specific parameters.,1.2109375,1.3125,3.203125,1.421875,0.166015625
11,msd_servo_drive.txt,36,cd9a6c3d43aee09fd8ea49d961e129d8ce140335b4efd00b1c6c207c901b75b1,"Before being fed into the circuit, speeds n_kal and n_eps can each be smoothed with a filter (P 351[0] for n_eps and P 339[0] for n_kal). The expanded speed control circuit can be started with P 350[0] (“4” => Kalman).

The inductance difference is important when it comes to sensorless control, as the Kalman filter can determine the position based on the inductance difference in.

Image 6.10: Expanded speed controller layout

Measurements have shown that, when using the expanded control circuit, motors with a marked saliency can be operated in a sensorless manner even without a test signal.

# 6 Encoder

MOOG ID No.:CB40859-001 Date:11/2020

MSD ServoDrive - DeviceHelp 96

In combination with a test signal when the motor is stopped. In addition, the total moment of inertia resulting from the motor and the connected load must be set as accurately as possible.

The encoder communications will be used to calculate and pass the actual speed and actual position. Accordingly, in order to select the sensorless method, a value of 2 must be set for encoder channel 4 in the selector (P 508[0] - ENC_CH4_Sel = 2), and a value of 4 must be set for P 520[0] - ENC_MCon, P 521[0] - ENC_SCon and P 522[0] - ENC_PCon.

The Kalman filter needs to be configured further by following the steps below:

|Step|Action|
|---|---|
|1|Automatically configure noise covariance matrices Q and R by setting the control parameter for encoder channel 4 (P 783[0] - ENC-CH4-Ctrl) to a value of 6.|
| |Manually configure the test signal generator:|
| |Recommendation: Sinusoidal test signal in d axis|
| |P 792[09] = 1|
| |P 792[19] = 500 Hz|
| |P 792[2] = P 792[9] = 10% of rated motor current|
| |P 792[79] = 15% of rated motor speed|
| |P 792[89] = 5% of rated motor speed|
| |P 792[9] = 30% of rated motor current|
| |Set the other values to 0|
|2|Or set the control parameter for encoder channel 4 (P 783[0] - ENC-CH4-Ctrl) to a value of 3, which will trigger a general initialization routine in which steps 1 and 2, as well as encoder initialization, will be automatically carried out based on the motor parameters.|

# Table 6.30: Configuring the Kalman filter for sensorless control

# Step

# Action

In order to make the encoderless control commissioning process easier, a function used to calculate the position difference between encoderless control and a real encoder can be activated. To use this function, the encoder channel that will be used for the comparison must be selected in P 797[0] - ENC_CH4_Kalman_Compare.

As described in Section ""Auto commutation"" on page 92 or Recommendation:

- P 390[0] = 1
- P 392[0] = 500
- P 392[1] = 500
- P 392[2] = 500
- P 392[3] = 500
- P 393[0] = Rated motor current
- P 393[1] = Rated motor current

# Mode 2

Parameters 792.1 and 792.2 are used as the measuring frequency and measuring amplitude (see step 2)

Recommendation:

- P 794[0] = 100 ms
- P 794[1] = 50% of rated motor current
- P 794[2] = 250 ms

Starting the expanded speed control circuit is not absolutely necessary, but will result in control with better dynamic performance. The circuit can be started by setting P 350[0] - SEL_ObserverMethod to a value of 4. P 339 - CON_SCON_Kalman can be used for tuning purposes. If necessary, adjust the noise covariance matrices and the filter time constants for the expanded speed control circuit (changes will take effect in real-time).

# Table 6.30: Configuring the Kalman filter for sensorless control (continue)

MOOG ID No.:CB40859-001 Date:11/2020

MSD ServoDrive - DeviceHelp 97

# 6 Encoder

# 6 Encoder

MOOG ID No.:CB40859-001 Date:11/2020

# 6.8.2.1 Activation of sensorless control for asynchronous motors

Proceed as follows:

|No.|Activity|
|---|---|
|1|Set motor type (P 450[0] - MOT_Type) to “2 (ASM) = asynchronous motor”.|
|2|Enter the motor name (P 451[0] - MOT_Name).|
|3|Copy the motor variables from the rating plate into the appropriate input box.|
|4|Start motor identification to identify other motor parameters. In the “Encoder selection” screen (see also section ""Encoder selection"" on page 53) under “Encoder for commutation and torque control,” set P 520[0] - ENC_MCon to “CH4(4) = virtual encoder (Channel 4)”.|
|5|Under “virtual encoder (Channel 4)” ""Encoder selection"" set (P 508[0] - ENC_CH4_Sel) to ""SFC(8) = take values of SFC model"".|
|6|In the “Basic Control Settings” screen (see section “Basic settings” on page 101) set “Speed filter TF” (P 351[0] - CON_SCALC_Tf) to 10 ms. In the “Asynchronous motor control settings identification” screen (see also section ""Asynchronous motor"" on page 38) enter the “Total moment of inertia” of the system (P 1516[0] - SCD_JSum). Enter a value that is too small rather than too big to avoid a tendency to oscillate. Automatic detection is not advisable due to the control dynamics and accuracy required.|
|7|In the same screen under “Control design by stiffness” set P 1515[0] - SCD_ConDesign (Stiffness) to 10%.|

# Table 6.31: Commissioning a sensorless-controlled asynchronous motor

|P No.|Index Name|Unit|Description|
|---|---|---|---|
|351|CON_SCALC_Tf| |Speed filter|
| |0|ms|Filter time const. speed control (motor)|
| |1|ms|Filter time const. ",How is the Kalman filter configured for sensorless control in 'MSD ServoDrive - DeviceHelp'?,A2,Configuration involves setting P 783[0] to 6 for automatic setup or to 3 for a general initialization routine.,0.62109375,0.494140625,2.90625,1.2734375,0.349609375
12,msd_servo_drive.txt,36,cd9a6c3d43aee09fd8ea49d961e129d8ce140335b4efd00b1c6c207c901b75b1,"Before being fed into the circuit, speeds n_kal and n_eps can each be smoothed with a filter (P 351[0] for n_eps and P 339[0] for n_kal). The expanded speed control circuit can be started with P 350[0] (“4” => Kalman).

The inductance difference is important when it comes to sensorless control, as the Kalman filter can determine the position based on the inductance difference in.

Image 6.10: Expanded speed controller layout

Measurements have shown that, when using the expanded control circuit, motors with a marked saliency can be operated in a sensorless manner even without a test signal.

# 6 Encoder

MOOG ID No.:CB40859-001 Date:11/2020

MSD ServoDrive - DeviceHelp 96

In combination with a test signal when the motor is stopped. In addition, the total moment of inertia resulting from the motor and the connected load must be set as accurately as possible.

The encoder communications will be used to calculate and pass the actual speed and actual position. Accordingly, in order to select the sensorless method, a value of 2 must be set for encoder channel 4 in the selector (P 508[0] - ENC_CH4_Sel = 2), and a value of 4 must be set for P 520[0] - ENC_MCon, P 521[0] - ENC_SCon and P 522[0] - ENC_PCon.

The Kalman filter needs to be configured further by following the steps below:

|Step|Action|
|---|---|
|1|Automatically configure noise covariance matrices Q and R by setting the control parameter for encoder channel 4 (P 783[0] - ENC-CH4-Ctrl) to a value of 6.|
| |Manually configure the test signal generator:|
| |Recommendation: Sinusoidal test signal in d axis|
| |P 792[09] = 1|
| |P 792[19] = 500 Hz|
| |P 792[2] = P 792[9] = 10% of rated motor current|
| |P 792[79] = 15% of rated motor speed|
| |P 792[89] = 5% of rated motor speed|
| |P 792[9] = 30% of rated motor current|
| |Set the other values to 0|
|2|Or set the control parameter for encoder channel 4 (P 783[0] - ENC-CH4-Ctrl) to a value of 3, which will trigger a general initialization routine in which steps 1 and 2, as well as encoder initialization, will be automatically carried out based on the motor parameters.|

# Table 6.30: Configuring the Kalman filter for sensorless control

# Step

# Action

In order to make the encoderless control commissioning process easier, a function used to calculate the position difference between encoderless control and a real encoder can be activated. To use this function, the encoder channel that will be used for the comparison must be selected in P 797[0] - ENC_CH4_Kalman_Compare.

As described in Section ""Auto commutation"" on page 92 or Recommendation:

- P 390[0] = 1
- P 392[0] = 500
- P 392[1] = 500
- P 392[2] = 500
- P 392[3] = 500
- P 393[0] = Rated motor current
- P 393[1] = Rated motor current

# Mode 2

Parameters 792.1 and 792.2 are used as the measuring frequency and measuring amplitude (see step 2)

Recommendation:

- P 794[0] = 100 ms
- P 794[1] = 50% of rated motor current
- P 794[2] = 250 ms

Starting the expanded speed control circuit is not absolutely necessary, but will result in control with better dynamic performance. The circuit can be started by setting P 350[0] - SEL_ObserverMethod to a value of 4. P 339 - CON_SCON_Kalman can be used for tuning purposes. If necessary, adjust the noise covariance matrices and the filter time constants for the expanded speed control circuit (changes will take effect in real-time).

# Table 6.30: Configuring the Kalman filter for sensorless control (continue)

MOOG ID No.:CB40859-001 Date:11/2020

MSD ServoDrive - DeviceHelp 97

# 6 Encoder

# 6 Encoder

MOOG ID No.:CB40859-001 Date:11/2020

# 6.8.2.1 Activation of sensorless control for asynchronous motors

Proceed as follows:

|No.|Activity|
|---|---|
|1|Set motor type (P 450[0] - MOT_Type) to “2 (ASM) = asynchronous motor”.|
|2|Enter the motor name (P 451[0] - MOT_Name).|
|3|Copy the motor variables from the rating plate into the appropriate input box.|
|4|Start motor identification to identify other motor parameters. In the “Encoder selection” screen (see also section ""Encoder selection"" on page 53) under “Encoder for commutation and torque control,” set P 520[0] - ENC_MCon to “CH4(4) = virtual encoder (Channel 4)”.|
|5|Under “virtual encoder (Channel 4)” ""Encoder selection"" set (P 508[0] - ENC_CH4_Sel) to ""SFC(8) = take values of SFC model"".|
|6|In the “Basic Control Settings” screen (see section “Basic settings” on page 101) set “Speed filter TF” (P 351[0] - CON_SCALC_Tf) to 10 ms. In the “Asynchronous motor control settings identification” screen (see also section ""Asynchronous motor"" on page 38) enter the “Total moment of inertia” of the system (P 1516[0] - SCD_JSum). Enter a value that is too small rather than too big to avoid a tendency to oscillate. Automatic detection is not advisable due to the control dynamics and accuracy required.|
|7|In the same screen under “Control design by stiffness” set P 1515[0] - SCD_ConDesign (Stiffness) to 10%.|

# Table 6.31: Commissioning a sensorless-controlled asynchronous motor

|P No.|Index Name|Unit|Description|
|---|---|---|---|
|351|CON_SCALC_Tf| |Speed filter|
| |0|ms|Filter time const. speed control (motor)|
| |1|ms|Filter time const. ",How is the Kalman filter configured for sensorless control in 'MSD ServoDrive - DeviceHelp'?,A3,"Steps include adjusting control parameters and, optionally, manually configuring the test signal generator.",1.296875,1.3046875,3.234375,1.2734375,0.228515625
13,msd_servo_drive.txt,36,cd9a6c3d43aee09fd8ea49d961e129d8ce140335b4efd00b1c6c207c901b75b1,"Before being fed into the circuit, speeds n_kal and n_eps can each be smoothed with a filter (P 351[0] for n_eps and P 339[0] for n_kal). The expanded speed control circuit can be started with P 350[0] (“4” => Kalman).

The inductance difference is important when it comes to sensorless control, as the Kalman filter can determine the position based on the inductance difference in.

Image 6.10: Expanded speed controller layout

Measurements have shown that, when using the expanded control circuit, motors with a marked saliency can be operated in a sensorless manner even without a test signal.

# 6 Encoder

MOOG ID No.:CB40859-001 Date:11/2020

MSD ServoDrive - DeviceHelp 96

In combination with a test signal when the motor is stopped. In addition, the total moment of inertia resulting from the motor and the connected load must be set as accurately as possible.

The encoder communications will be used to calculate and pass the actual speed and actual position. Accordingly, in order to select the sensorless method, a value of 2 must be set for encoder channel 4 in the selector (P 508[0] - ENC_CH4_Sel = 2), and a value of 4 must be set for P 520[0] - ENC_MCon, P 521[0] - ENC_SCon and P 522[0] - ENC_PCon.

The Kalman filter needs to be configured further by following the steps below:

|Step|Action|
|---|---|
|1|Automatically configure noise covariance matrices Q and R by setting the control parameter for encoder channel 4 (P 783[0] - ENC-CH4-Ctrl) to a value of 6.|
| |Manually configure the test signal generator:|
| |Recommendation: Sinusoidal test signal in d axis|
| |P 792[09] = 1|
| |P 792[19] = 500 Hz|
| |P 792[2] = P 792[9] = 10% of rated motor current|
| |P 792[79] = 15% of rated motor speed|
| |P 792[89] = 5% of rated motor speed|
| |P 792[9] = 30% of rated motor current|
| |Set the other values to 0|
|2|Or set the control parameter for encoder channel 4 (P 783[0] - ENC-CH4-Ctrl) to a value of 3, which will trigger a general initialization routine in which steps 1 and 2, as well as encoder initialization, will be automatically carried out based on the motor parameters.|

# Table 6.30: Configuring the Kalman filter for sensorless control

# Step

# Action

In order to make the encoderless control commissioning process easier, a function used to calculate the position difference between encoderless control and a real encoder can be activated. To use this function, the encoder channel that will be used for the comparison must be selected in P 797[0] - ENC_CH4_Kalman_Compare.

As described in Section ""Auto commutation"" on page 92 or Recommendation:

- P 390[0] = 1
- P 392[0] = 500
- P 392[1] = 500
- P 392[2] = 500
- P 392[3] = 500
- P 393[0] = Rated motor current
- P 393[1] = Rated motor current

# Mode 2

Parameters 792.1 and 792.2 are used as the measuring frequency and measuring amplitude (see step 2)

Recommendation:

- P 794[0] = 100 ms
- P 794[1] = 50% of rated motor current
- P 794[2] = 250 ms

Starting the expanded speed control circuit is not absolutely necessary, but will result in control with better dynamic performance. The circuit can be started by setting P 350[0] - SEL_ObserverMethod to a value of 4. P 339 - CON_SCON_Kalman can be used for tuning purposes. If necessary, adjust the noise covariance matrices and the filter time constants for the expanded speed control circuit (changes will take effect in real-time).

# Table 6.30: Configuring the Kalman filter for sensorless control (continue)

MOOG ID No.:CB40859-001 Date:11/2020

MSD ServoDrive - DeviceHelp 97

# 6 Encoder

# 6 Encoder

MOOG ID No.:CB40859-001 Date:11/2020

# 6.8.2.1 Activation of sensorless control for asynchronous motors

Proceed as follows:

|No.|Activity|
|---|---|
|1|Set motor type (P 450[0] - MOT_Type) to “2 (ASM) = asynchronous motor”.|
|2|Enter the motor name (P 451[0] - MOT_Name).|
|3|Copy the motor variables from the rating plate into the appropriate input box.|
|4|Start motor identification to identify other motor parameters. In the “Encoder selection” screen (see also section ""Encoder selection"" on page 53) under “Encoder for commutation and torque control,” set P 520[0] - ENC_MCon to “CH4(4) = virtual encoder (Channel 4)”.|
|5|Under “virtual encoder (Channel 4)” ""Encoder selection"" set (P 508[0] - ENC_CH4_Sel) to ""SFC(8) = take values of SFC model"".|
|6|In the “Basic Control Settings” screen (see section “Basic settings” on page 101) set “Speed filter TF” (P 351[0] - CON_SCALC_Tf) to 10 ms. In the “Asynchronous motor control settings identification” screen (see also section ""Asynchronous motor"" on page 38) enter the “Total moment of inertia” of the system (P 1516[0] - SCD_JSum). Enter a value that is too small rather than too big to avoid a tendency to oscillate. Automatic detection is not advisable due to the control dynamics and accuracy required.|
|7|In the same screen under “Control design by stiffness” set P 1515[0] - SCD_ConDesign (Stiffness) to 10%.|

# Table 6.31: Commissioning a sensorless-controlled asynchronous motor

|P No.|Index Name|Unit|Description|
|---|---|---|---|
|351|CON_SCALC_Tf| |Speed filter|
| |0|ms|Filter time const. speed control (motor)|
| |1|ms|Filter time const. ",How is the Kalman filter configured for sensorless control in 'MSD ServoDrive - DeviceHelp'?,A4,The process requires setting encoder channel 4 parameters and possibly manual test signal adjustments.,0.86328125,0.8125,3.125,1.265625,0.27734375
14,msd_servo_drive.txt,36,cd9a6c3d43aee09fd8ea49d961e129d8ce140335b4efd00b1c6c207c901b75b1,"Before being fed into the circuit, speeds n_kal and n_eps can each be smoothed with a filter (P 351[0] for n_eps and P 339[0] for n_kal). The expanded speed control circuit can be started with P 350[0] (“4” => Kalman).

The inductance difference is important when it comes to sensorless control, as the Kalman filter can determine the position based on the inductance difference in.

Image 6.10: Expanded speed controller layout

Measurements have shown that, when using the expanded control circuit, motors with a marked saliency can be operated in a sensorless manner even without a test signal.

# 6 Encoder

MOOG ID No.:CB40859-001 Date:11/2020

MSD ServoDrive - DeviceHelp 96

In combination with a test signal when the motor is stopped. In addition, the total moment of inertia resulting from the motor and the connected load must be set as accurately as possible.

The encoder communications will be used to calculate and pass the actual speed and actual position. Accordingly, in order to select the sensorless method, a value of 2 must be set for encoder channel 4 in the selector (P 508[0] - ENC_CH4_Sel = 2), and a value of 4 must be set for P 520[0] - ENC_MCon, P 521[0] - ENC_SCon and P 522[0] - ENC_PCon.

The Kalman filter needs to be configured further by following the steps below:

|Step|Action|
|---|---|
|1|Automatically configure noise covariance matrices Q and R by setting the control parameter for encoder channel 4 (P 783[0] - ENC-CH4-Ctrl) to a value of 6.|
| |Manually configure the test signal generator:|
| |Recommendation: Sinusoidal test signal in d axis|
| |P 792[09] = 1|
| |P 792[19] = 500 Hz|
| |P 792[2] = P 792[9] = 10% of rated motor current|
| |P 792[79] = 15% of rated motor speed|
| |P 792[89] = 5% of rated motor speed|
| |P 792[9] = 30% of rated motor current|
| |Set the other values to 0|
|2|Or set the control parameter for encoder channel 4 (P 783[0] - ENC-CH4-Ctrl) to a value of 3, which will trigger a general initialization routine in which steps 1 and 2, as well as encoder initialization, will be automatically carried out based on the motor parameters.|

# Table 6.30: Configuring the Kalman filter for sensorless control

# Step

# Action

In order to make the encoderless control commissioning process easier, a function used to calculate the position difference between encoderless control and a real encoder can be activated. To use this function, the encoder channel that will be used for the comparison must be selected in P 797[0] - ENC_CH4_Kalman_Compare.

As described in Section ""Auto commutation"" on page 92 or Recommendation:

- P 390[0] = 1
- P 392[0] = 500
- P 392[1] = 500
- P 392[2] = 500
- P 392[3] = 500
- P 393[0] = Rated motor current
- P 393[1] = Rated motor current

# Mode 2

Parameters 792.1 and 792.2 are used as the measuring frequency and measuring amplitude (see step 2)

Recommendation:

- P 794[0] = 100 ms
- P 794[1] = 50% of rated motor current
- P 794[2] = 250 ms

Starting the expanded speed control circuit is not absolutely necessary, but will result in control with better dynamic performance. The circuit can be started by setting P 350[0] - SEL_ObserverMethod to a value of 4. P 339 - CON_SCON_Kalman can be used for tuning purposes. If necessary, adjust the noise covariance matrices and the filter time constants for the expanded speed control circuit (changes will take effect in real-time).

# Table 6.30: Configuring the Kalman filter for sensorless control (continue)

MOOG ID No.:CB40859-001 Date:11/2020

MSD ServoDrive - DeviceHelp 97

# 6 Encoder

# 6 Encoder

MOOG ID No.:CB40859-001 Date:11/2020

# 6.8.2.1 Activation of sensorless control for asynchronous motors

Proceed as follows:

|No.|Activity|
|---|---|
|1|Set motor type (P 450[0] - MOT_Type) to “2 (ASM) = asynchronous motor”.|
|2|Enter the motor name (P 451[0] - MOT_Name).|
|3|Copy the motor variables from the rating plate into the appropriate input box.|
|4|Start motor identification to identify other motor parameters. In the “Encoder selection” screen (see also section ""Encoder selection"" on page 53) under “Encoder for commutation and torque control,” set P 520[0] - ENC_MCon to “CH4(4) = virtual encoder (Channel 4)”.|
|5|Under “virtual encoder (Channel 4)” ""Encoder selection"" set (P 508[0] - ENC_CH4_Sel) to ""SFC(8) = take values of SFC model"".|
|6|In the “Basic Control Settings” screen (see section “Basic settings” on page 101) set “Speed filter TF” (P 351[0] - CON_SCALC_Tf) to 10 ms. In the “Asynchronous motor control settings identification” screen (see also section ""Asynchronous motor"" on page 38) enter the “Total moment of inertia” of the system (P 1516[0] - SCD_JSum). Enter a value that is too small rather than too big to avoid a tendency to oscillate. Automatic detection is not advisable due to the control dynamics and accuracy required.|
|7|In the same screen under “Control design by stiffness” set P 1515[0] - SCD_ConDesign (Stiffness) to 10%.|

# Table 6.31: Commissioning a sensorless-controlled asynchronous motor

|P No.|Index Name|Unit|Description|
|---|---|---|---|
|351|CON_SCALC_Tf| |Speed filter|
| |0|ms|Filter time const. speed control (motor)|
| |1|ms|Filter time const. ",How is the Kalman filter configured for sensorless control in 'MSD ServoDrive - DeviceHelp'?,A5,Configuring the Kalman filter entails parameter adjustments for noise matrices and test signal specifications.,1.0390625,0.97265625,3.15625,1.40625,0.1845703125
15,msd_servo_drive.txt,36,cd9a6c3d43aee09fd8ea49d961e129d8ce140335b4efd00b1c6c207c901b75b1,"Before being fed into the circuit, speeds n_kal and n_eps can each be smoothed with a filter (P 351[0] for n_eps and P 339[0] for n_kal). The expanded speed control circuit can be started with P 350[0] (“4” => Kalman).

The inductance difference is important when it comes to sensorless control, as the Kalman filter can determine the position based on the inductance difference in.

Image 6.10: Expanded speed controller layout

Measurements have shown that, when using the expanded control circuit, motors with a marked saliency can be operated in a sensorless manner even without a test signal.

# 6 Encoder

MOOG ID No.:CB40859-001 Date:11/2020

MSD ServoDrive - DeviceHelp 96

In combination with a test signal when the motor is stopped. In addition, the total moment of inertia resulting from the motor and the connected load must be set as accurately as possible.

The encoder communications will be used to calculate and pass the actual speed and actual position. Accordingly, in order to select the sensorless method, a value of 2 must be set for encoder channel 4 in the selector (P 508[0] - ENC_CH4_Sel = 2), and a value of 4 must be set for P 520[0] - ENC_MCon, P 521[0] - ENC_SCon and P 522[0] - ENC_PCon.

The Kalman filter needs to be configured further by following the steps below:

|Step|Action|
|---|---|
|1|Automatically configure noise covariance matrices Q and R by setting the control parameter for encoder channel 4 (P 783[0] - ENC-CH4-Ctrl) to a value of 6.|
| |Manually configure the test signal generator:|
| |Recommendation: Sinusoidal test signal in d axis|
| |P 792[09] = 1|
| |P 792[19] = 500 Hz|
| |P 792[2] = P 792[9] = 10% of rated motor current|
| |P 792[79] = 15% of rated motor speed|
| |P 792[89] = 5% of rated motor speed|
| |P 792[9] = 30% of rated motor current|
| |Set the other values to 0|
|2|Or set the control parameter for encoder channel 4 (P 783[0] - ENC-CH4-Ctrl) to a value of 3, which will trigger a general initialization routine in which steps 1 and 2, as well as encoder initialization, will be automatically carried out based on the motor parameters.|

# Table 6.30: Configuring the Kalman filter for sensorless control

# Step

# Action

In order to make the encoderless control commissioning process easier, a function used to calculate the position difference between encoderless control and a real encoder can be activated. To use this function, the encoder channel that will be used for the comparison must be selected in P 797[0] - ENC_CH4_Kalman_Compare.

As described in Section ""Auto commutation"" on page 92 or Recommendation:

- P 390[0] = 1
- P 392[0] = 500
- P 392[1] = 500
- P 392[2] = 500
- P 392[3] = 500
- P 393[0] = Rated motor current
- P 393[1] = Rated motor current

# Mode 2

Parameters 792.1 and 792.2 are used as the measuring frequency and measuring amplitude (see step 2)

Recommendation:

- P 794[0] = 100 ms
- P 794[1] = 50% of rated motor current
- P 794[2] = 250 ms

Starting the expanded speed control circuit is not absolutely necessary, but will result in control with better dynamic performance. The circuit can be started by setting P 350[0] - SEL_ObserverMethod to a value of 4. P 339 - CON_SCON_Kalman can be used for tuning purposes. If necessary, adjust the noise covariance matrices and the filter time constants for the expanded speed control circuit (changes will take effect in real-time).

# Table 6.30: Configuring the Kalman filter for sensorless control (continue)

MOOG ID No.:CB40859-001 Date:11/2020

MSD ServoDrive - DeviceHelp 97

# 6 Encoder

# 6 Encoder

MOOG ID No.:CB40859-001 Date:11/2020

# 6.8.2.1 Activation of sensorless control for asynchronous motors

Proceed as follows:

|No.|Activity|
|---|---|
|1|Set motor type (P 450[0] - MOT_Type) to “2 (ASM) = asynchronous motor”.|
|2|Enter the motor name (P 451[0] - MOT_Name).|
|3|Copy the motor variables from the rating plate into the appropriate input box.|
|4|Start motor identification to identify other motor parameters. In the “Encoder selection” screen (see also section ""Encoder selection"" on page 53) under “Encoder for commutation and torque control,” set P 520[0] - ENC_MCon to “CH4(4) = virtual encoder (Channel 4)”.|
|5|Under “virtual encoder (Channel 4)” ""Encoder selection"" set (P 508[0] - ENC_CH4_Sel) to ""SFC(8) = take values of SFC model"".|
|6|In the “Basic Control Settings” screen (see section “Basic settings” on page 101) set “Speed filter TF” (P 351[0] - CON_SCALC_Tf) to 10 ms. In the “Asynchronous motor control settings identification” screen (see also section ""Asynchronous motor"" on page 38) enter the “Total moment of inertia” of the system (P 1516[0] - SCD_JSum). Enter a value that is too small rather than too big to avoid a tendency to oscillate. Automatic detection is not advisable due to the control dynamics and accuracy required.|
|7|In the same screen under “Control design by stiffness” set P 1515[0] - SCD_ConDesign (Stiffness) to 10%.|

# Table 6.31: Commissioning a sensorless-controlled asynchronous motor

|P No.|Index Name|Unit|Description|
|---|---|---|---|
|351|CON_SCALC_Tf| |Speed filter|
| |0|ms|Filter time const. speed control (motor)|
| |1|ms|Filter time const. ",What are the recommended settings for the test signal generator in 'MSD ServoDrive - DeviceHelp'?,A1,"Sinusoidal test signal in d axis, P 792[09] = 1, P 792[19] = 500 Hz, among others.",1.5,1.5625,3.046875,1.515625,0.5625
16,msd_servo_drive.txt,36,cd9a6c3d43aee09fd8ea49d961e129d8ce140335b4efd00b1c6c207c901b75b1,"Before being fed into the circuit, speeds n_kal and n_eps can each be smoothed with a filter (P 351[0] for n_eps and P 339[0] for n_kal). The expanded speed control circuit can be started with P 350[0] (“4” => Kalman).

The inductance difference is important when it comes to sensorless control, as the Kalman filter can determine the position based on the inductance difference in.

Image 6.10: Expanded speed controller layout

Measurements have shown that, when using the expanded control circuit, motors with a marked saliency can be operated in a sensorless manner even without a test signal.

# 6 Encoder

MOOG ID No.:CB40859-001 Date:11/2020

MSD ServoDrive - DeviceHelp 96

In combination with a test signal when the motor is stopped. In addition, the total moment of inertia resulting from the motor and the connected load must be set as accurately as possible.

The encoder communications will be used to calculate and pass the actual speed and actual position. Accordingly, in order to select the sensorless method, a value of 2 must be set for encoder channel 4 in the selector (P 508[0] - ENC_CH4_Sel = 2), and a value of 4 must be set for P 520[0] - ENC_MCon, P 521[0] - ENC_SCon and P 522[0] - ENC_PCon.

The Kalman filter needs to be configured further by following the steps below:

|Step|Action|
|---|---|
|1|Automatically configure noise covariance matrices Q and R by setting the control parameter for encoder channel 4 (P 783[0] - ENC-CH4-Ctrl) to a value of 6.|
| |Manually configure the test signal generator:|
| |Recommendation: Sinusoidal test signal in d axis|
| |P 792[09] = 1|
| |P 792[19] = 500 Hz|
| |P 792[2] = P 792[9] = 10% of rated motor current|
| |P 792[79] = 15% of rated motor speed|
| |P 792[89] = 5% of rated motor speed|
| |P 792[9] = 30% of rated motor current|
| |Set the other values to 0|
|2|Or set the control parameter for encoder channel 4 (P 783[0] - ENC-CH4-Ctrl) to a value of 3, which will trigger a general initialization routine in which steps 1 and 2, as well as encoder initialization, will be automatically carried out based on the motor parameters.|

# Table 6.30: Configuring the Kalman filter for sensorless control

# Step

# Action

In order to make the encoderless control commissioning process easier, a function used to calculate the position difference between encoderless control and a real encoder can be activated. To use this function, the encoder channel that will be used for the comparison must be selected in P 797[0] - ENC_CH4_Kalman_Compare.

As described in Section ""Auto commutation"" on page 92 or Recommendation:

- P 390[0] = 1
- P 392[0] = 500
- P 392[1] = 500
- P 392[2] = 500
- P 392[3] = 500
- P 393[0] = Rated motor current
- P 393[1] = Rated motor current

# Mode 2

Parameters 792.1 and 792.2 are used as the measuring frequency and measuring amplitude (see step 2)

Recommendation:

- P 794[0] = 100 ms
- P 794[1] = 50% of rated motor current
- P 794[2] = 250 ms

Starting the expanded speed control circuit is not absolutely necessary, but will result in control with better dynamic performance. The circuit can be started by setting P 350[0] - SEL_ObserverMethod to a value of 4. P 339 - CON_SCON_Kalman can be used for tuning purposes. If necessary, adjust the noise covariance matrices and the filter time constants for the expanded speed control circuit (changes will take effect in real-time).

# Table 6.30: Configuring the Kalman filter for sensorless control (continue)

MOOG ID No.:CB40859-001 Date:11/2020

MSD ServoDrive - DeviceHelp 97

# 6 Encoder

# 6 Encoder

MOOG ID No.:CB40859-001 Date:11/2020

# 6.8.2.1 Activation of sensorless control for asynchronous motors

Proceed as follows:

|No.|Activity|
|---|---|
|1|Set motor type (P 450[0] - MOT_Type) to “2 (ASM) = asynchronous motor”.|
|2|Enter the motor name (P 451[0] - MOT_Name).|
|3|Copy the motor variables from the rating plate into the appropriate input box.|
|4|Start motor identification to identify other motor parameters. In the “Encoder selection” screen (see also section ""Encoder selection"" on page 53) under “Encoder for commutation and torque control,” set P 520[0] - ENC_MCon to “CH4(4) = virtual encoder (Channel 4)”.|
|5|Under “virtual encoder (Channel 4)” ""Encoder selection"" set (P 508[0] - ENC_CH4_Sel) to ""SFC(8) = take values of SFC model"".|
|6|In the “Basic Control Settings” screen (see section “Basic settings” on page 101) set “Speed filter TF” (P 351[0] - CON_SCALC_Tf) to 10 ms. In the “Asynchronous motor control settings identification” screen (see also section ""Asynchronous motor"" on page 38) enter the “Total moment of inertia” of the system (P 1516[0] - SCD_JSum). Enter a value that is too small rather than too big to avoid a tendency to oscillate. Automatic detection is not advisable due to the control dynamics and accuracy required.|
|7|In the same screen under “Control design by stiffness” set P 1515[0] - SCD_ConDesign (Stiffness) to 10%.|

# Table 6.31: Commissioning a sensorless-controlled asynchronous motor

|P No.|Index Name|Unit|Description|
|---|---|---|---|
|351|CON_SCALC_Tf| |Speed filter|
| |0|ms|Filter time const. speed control (motor)|
| |1|ms|Filter time const. ",What are the recommended settings for the test signal generator in 'MSD ServoDrive - DeviceHelp'?,A2,Recommendations include a 500 Hz sinusoidal signal and specific current and speed percentages.,0.72265625,0.65625,2.9375,1.1015625,0.431640625
17,msd_servo_drive.txt,36,cd9a6c3d43aee09fd8ea49d961e129d8ce140335b4efd00b1c6c207c901b75b1,"Before being fed into the circuit, speeds n_kal and n_eps can each be smoothed with a filter (P 351[0] for n_eps and P 339[0] for n_kal). The expanded speed control circuit can be started with P 350[0] (“4” => Kalman).

The inductance difference is important when it comes to sensorless control, as the Kalman filter can determine the position based on the inductance difference in.

Image 6.10: Expanded speed controller layout

Measurements have shown that, when using the expanded control circuit, motors with a marked saliency can be operated in a sensorless manner even without a test signal.

# 6 Encoder

MOOG ID No.:CB40859-001 Date:11/2020

MSD ServoDrive - DeviceHelp 96

In combination with a test signal when the motor is stopped. In addition, the total moment of inertia resulting from the motor and the connected load must be set as accurately as possible.

The encoder communications will be used to calculate and pass the actual speed and actual position. Accordingly, in order to select the sensorless method, a value of 2 must be set for encoder channel 4 in the selector (P 508[0] - ENC_CH4_Sel = 2), and a value of 4 must be set for P 520[0] - ENC_MCon, P 521[0] - ENC_SCon and P 522[0] - ENC_PCon.

The Kalman filter needs to be configured further by following the steps below:

|Step|Action|
|---|---|
|1|Automatically configure noise covariance matrices Q and R by setting the control parameter for encoder channel 4 (P 783[0] - ENC-CH4-Ctrl) to a value of 6.|
| |Manually configure the test signal generator:|
| |Recommendation: Sinusoidal test signal in d axis|
| |P 792[09] = 1|
| |P 792[19] = 500 Hz|
| |P 792[2] = P 792[9] = 10% of rated motor current|
| |P 792[79] = 15% of rated motor speed|
| |P 792[89] = 5% of rated motor speed|
| |P 792[9] = 30% of rated motor current|
| |Set the other values to 0|
|2|Or set the control parameter for encoder channel 4 (P 783[0] - ENC-CH4-Ctrl) to a value of 3, which will trigger a general initialization routine in which steps 1 and 2, as well as encoder initialization, will be automatically carried out based on the motor parameters.|

# Table 6.30: Configuring the Kalman filter for sensorless control

# Step

# Action

In order to make the encoderless control commissioning process easier, a function used to calculate the position difference between encoderless control and a real encoder can be activated. To use this function, the encoder channel that will be used for the comparison must be selected in P 797[0] - ENC_CH4_Kalman_Compare.

As described in Section ""Auto commutation"" on page 92 or Recommendation:

- P 390[0] = 1
- P 392[0] = 500
- P 392[1] = 500
- P 392[2] = 500
- P 392[3] = 500
- P 393[0] = Rated motor current
- P 393[1] = Rated motor current

# Mode 2

Parameters 792.1 and 792.2 are used as the measuring frequency and measuring amplitude (see step 2)

Recommendation:

- P 794[0] = 100 ms
- P 794[1] = 50% of rated motor current
- P 794[2] = 250 ms

Starting the expanded speed control circuit is not absolutely necessary, but will result in control with better dynamic performance. The circuit can be started by setting P 350[0] - SEL_ObserverMethod to a value of 4. P 339 - CON_SCON_Kalman can be used for tuning purposes. If necessary, adjust the noise covariance matrices and the filter time constants for the expanded speed control circuit (changes will take effect in real-time).

# Table 6.30: Configuring the Kalman filter for sensorless control (continue)

MOOG ID No.:CB40859-001 Date:11/2020

MSD ServoDrive - DeviceHelp 97

# 6 Encoder

# 6 Encoder

MOOG ID No.:CB40859-001 Date:11/2020

# 6.8.2.1 Activation of sensorless control for asynchronous motors

Proceed as follows:

|No.|Activity|
|---|---|
|1|Set motor type (P 450[0] - MOT_Type) to “2 (ASM) = asynchronous motor”.|
|2|Enter the motor name (P 451[0] - MOT_Name).|
|3|Copy the motor variables from the rating plate into the appropriate input box.|
|4|Start motor identification to identify other motor parameters. In the “Encoder selection” screen (see also section ""Encoder selection"" on page 53) under “Encoder for commutation and torque control,” set P 520[0] - ENC_MCon to “CH4(4) = virtual encoder (Channel 4)”.|
|5|Under “virtual encoder (Channel 4)” ""Encoder selection"" set (P 508[0] - ENC_CH4_Sel) to ""SFC(8) = take values of SFC model"".|
|6|In the “Basic Control Settings” screen (see section “Basic settings” on page 101) set “Speed filter TF” (P 351[0] - CON_SCALC_Tf) to 10 ms. In the “Asynchronous motor control settings identification” screen (see also section ""Asynchronous motor"" on page 38) enter the “Total moment of inertia” of the system (P 1516[0] - SCD_JSum). Enter a value that is too small rather than too big to avoid a tendency to oscillate. Automatic detection is not advisable due to the control dynamics and accuracy required.|
|7|In the same screen under “Control design by stiffness” set P 1515[0] - SCD_ConDesign (Stiffness) to 10%.|

# Table 6.31: Commissioning a sensorless-controlled asynchronous motor

|P No.|Index Name|Unit|Description|
|---|---|---|---|
|351|CON_SCALC_Tf| |Speed filter|
| |0|ms|Filter time const. speed control (motor)|
| |1|ms|Filter time const. ",What are the recommended settings for the test signal generator in 'MSD ServoDrive - DeviceHelp'?,A3,Optimal settings involve a d-axis sinusoidal signal at 500 Hz with defined current and speed thresholds.,1.0859375,1.03125,3.078125,1.2734375,0.439453125
18,msd_servo_drive.txt,36,cd9a6c3d43aee09fd8ea49d961e129d8ce140335b4efd00b1c6c207c901b75b1,"Before being fed into the circuit, speeds n_kal and n_eps can each be smoothed with a filter (P 351[0] for n_eps and P 339[0] for n_kal). The expanded speed control circuit can be started with P 350[0] (“4” => Kalman).

The inductance difference is important when it comes to sensorless control, as the Kalman filter can determine the position based on the inductance difference in.

Image 6.10: Expanded speed controller layout

Measurements have shown that, when using the expanded control circuit, motors with a marked saliency can be operated in a sensorless manner even without a test signal.

# 6 Encoder

MOOG ID No.:CB40859-001 Date:11/2020

MSD ServoDrive - DeviceHelp 96

In combination with a test signal when the motor is stopped. In addition, the total moment of inertia resulting from the motor and the connected load must be set as accurately as possible.

The encoder communications will be used to calculate and pass the actual speed and actual position. Accordingly, in order to select the sensorless method, a value of 2 must be set for encoder channel 4 in the selector (P 508[0] - ENC_CH4_Sel = 2), and a value of 4 must be set for P 520[0] - ENC_MCon, P 521[0] - ENC_SCon and P 522[0] - ENC_PCon.

The Kalman filter needs to be configured further by following the steps below:

|Step|Action|
|---|---|
|1|Automatically configure noise covariance matrices Q and R by setting the control parameter for encoder channel 4 (P 783[0] - ENC-CH4-Ctrl) to a value of 6.|
| |Manually configure the test signal generator:|
| |Recommendation: Sinusoidal test signal in d axis|
| |P 792[09] = 1|
| |P 792[19] = 500 Hz|
| |P 792[2] = P 792[9] = 10% of rated motor current|
| |P 792[79] = 15% of rated motor speed|
| |P 792[89] = 5% of rated motor speed|
| |P 792[9] = 30% of rated motor current|
| |Set the other values to 0|
|2|Or set the control parameter for encoder channel 4 (P 783[0] - ENC-CH4-Ctrl) to a value of 3, which will trigger a general initialization routine in which steps 1 and 2, as well as encoder initialization, will be automatically carried out based on the motor parameters.|

# Table 6.30: Configuring the Kalman filter for sensorless control

# Step

# Action

In order to make the encoderless control commissioning process easier, a function used to calculate the position difference between encoderless control and a real encoder can be activated. To use this function, the encoder channel that will be used for the comparison must be selected in P 797[0] - ENC_CH4_Kalman_Compare.

As described in Section ""Auto commutation"" on page 92 or Recommendation:

- P 390[0] = 1
- P 392[0] = 500
- P 392[1] = 500
- P 392[2] = 500
- P 392[3] = 500
- P 393[0] = Rated motor current
- P 393[1] = Rated motor current

# Mode 2

Parameters 792.1 and 792.2 are used as the measuring frequency and measuring amplitude (see step 2)

Recommendation:

- P 794[0] = 100 ms
- P 794[1] = 50% of rated motor current
- P 794[2] = 250 ms

Starting the expanded speed control circuit is not absolutely necessary, but will result in control with better dynamic performance. The circuit can be started by setting P 350[0] - SEL_ObserverMethod to a value of 4. P 339 - CON_SCON_Kalman can be used for tuning purposes. If necessary, adjust the noise covariance matrices and the filter time constants for the expanded speed control circuit (changes will take effect in real-time).

# Table 6.30: Configuring the Kalman filter for sensorless control (continue)

MOOG ID No.:CB40859-001 Date:11/2020

MSD ServoDrive - DeviceHelp 97

# 6 Encoder

# 6 Encoder

MOOG ID No.:CB40859-001 Date:11/2020

# 6.8.2.1 Activation of sensorless control for asynchronous motors

Proceed as follows:

|No.|Activity|
|---|---|
|1|Set motor type (P 450[0] - MOT_Type) to “2 (ASM) = asynchronous motor”.|
|2|Enter the motor name (P 451[0] - MOT_Name).|
|3|Copy the motor variables from the rating plate into the appropriate input box.|
|4|Start motor identification to identify other motor parameters. In the “Encoder selection” screen (see also section ""Encoder selection"" on page 53) under “Encoder for commutation and torque control,” set P 520[0] - ENC_MCon to “CH4(4) = virtual encoder (Channel 4)”.|
|5|Under “virtual encoder (Channel 4)” ""Encoder selection"" set (P 508[0] - ENC_CH4_Sel) to ""SFC(8) = take values of SFC model"".|
|6|In the “Basic Control Settings” screen (see section “Basic settings” on page 101) set “Speed filter TF” (P 351[0] - CON_SCALC_Tf) to 10 ms. In the “Asynchronous motor control settings identification” screen (see also section ""Asynchronous motor"" on page 38) enter the “Total moment of inertia” of the system (P 1516[0] - SCD_JSum). Enter a value that is too small rather than too big to avoid a tendency to oscillate. Automatic detection is not advisable due to the control dynamics and accuracy required.|
|7|In the same screen under “Control design by stiffness” set P 1515[0] - SCD_ConDesign (Stiffness) to 10%.|

# Table 6.31: Commissioning a sensorless-controlled asynchronous motor

|P No.|Index Name|Unit|Description|
|---|---|---|---|
|351|CON_SCALC_Tf| |Speed filter|
| |0|ms|Filter time const. speed control (motor)|
| |1|ms|Filter time const. ",What are the recommended settings for the test signal generator in 'MSD ServoDrive - DeviceHelp'?,A4,The guide suggests a sinusoidal test signal configuration with precise frequency and amplitude parameters.,0.8671875,0.859375,2.953125,1.2578125,0.34375
19,msd_servo_drive.txt,36,cd9a6c3d43aee09fd8ea49d961e129d8ce140335b4efd00b1c6c207c901b75b1,"Before being fed into the circuit, speeds n_kal and n_eps can each be smoothed with a filter (P 351[0] for n_eps and P 339[0] for n_kal). The expanded speed control circuit can be started with P 350[0] (“4” => Kalman).

The inductance difference is important when it comes to sensorless control, as the Kalman filter can determine the position based on the inductance difference in.

Image 6.10: Expanded speed controller layout

Measurements have shown that, when using the expanded control circuit, motors with a marked saliency can be operated in a sensorless manner even without a test signal.

# 6 Encoder

MOOG ID No.:CB40859-001 Date:11/2020

MSD ServoDrive - DeviceHelp 96

In combination with a test signal when the motor is stopped. In addition, the total moment of inertia resulting from the motor and the connected load must be set as accurately as possible.

The encoder communications will be used to calculate and pass the actual speed and actual position. Accordingly, in order to select the sensorless method, a value of 2 must be set for encoder channel 4 in the selector (P 508[0] - ENC_CH4_Sel = 2), and a value of 4 must be set for P 520[0] - ENC_MCon, P 521[0] - ENC_SCon and P 522[0] - ENC_PCon.

The Kalman filter needs to be configured further by following the steps below:

|Step|Action|
|---|---|
|1|Automatically configure noise covariance matrices Q and R by setting the control parameter for encoder channel 4 (P 783[0] - ENC-CH4-Ctrl) to a value of 6.|
| |Manually configure the test signal generator:|
| |Recommendation: Sinusoidal test signal in d axis|
| |P 792[09] = 1|
| |P 792[19] = 500 Hz|
| |P 792[2] = P 792[9] = 10% of rated motor current|
| |P 792[79] = 15% of rated motor speed|
| |P 792[89] = 5% of rated motor speed|
| |P 792[9] = 30% of rated motor current|
| |Set the other values to 0|
|2|Or set the control parameter for encoder channel 4 (P 783[0] - ENC-CH4-Ctrl) to a value of 3, which will trigger a general initialization routine in which steps 1 and 2, as well as encoder initialization, will be automatically carried out based on the motor parameters.|

# Table 6.30: Configuring the Kalman filter for sensorless control

# Step

# Action

In order to make the encoderless control commissioning process easier, a function used to calculate the position difference between encoderless control and a real encoder can be activated. To use this function, the encoder channel that will be used for the comparison must be selected in P 797[0] - ENC_CH4_Kalman_Compare.

As described in Section ""Auto commutation"" on page 92 or Recommendation:

- P 390[0] = 1
- P 392[0] = 500
- P 392[1] = 500
- P 392[2] = 500
- P 392[3] = 500
- P 393[0] = Rated motor current
- P 393[1] = Rated motor current

# Mode 2

Parameters 792.1 and 792.2 are used as the measuring frequency and measuring amplitude (see step 2)

Recommendation:

- P 794[0] = 100 ms
- P 794[1] = 50% of rated motor current
- P 794[2] = 250 ms

Starting the expanded speed control circuit is not absolutely necessary, but will result in control with better dynamic performance. The circuit can be started by setting P 350[0] - SEL_ObserverMethod to a value of 4. P 339 - CON_SCON_Kalman can be used for tuning purposes. If necessary, adjust the noise covariance matrices and the filter time constants for the expanded speed control circuit (changes will take effect in real-time).

# Table 6.30: Configuring the Kalman filter for sensorless control (continue)

MOOG ID No.:CB40859-001 Date:11/2020

MSD ServoDrive - DeviceHelp 97

# 6 Encoder

# 6 Encoder

MOOG ID No.:CB40859-001 Date:11/2020

# 6.8.2.1 Activation of sensorless control for asynchronous motors

Proceed as follows:

|No.|Activity|
|---|---|
|1|Set motor type (P 450[0] - MOT_Type) to “2 (ASM) = asynchronous motor”.|
|2|Enter the motor name (P 451[0] - MOT_Name).|
|3|Copy the motor variables from the rating plate into the appropriate input box.|
|4|Start motor identification to identify other motor parameters. In the “Encoder selection” screen (see also section ""Encoder selection"" on page 53) under “Encoder for commutation and torque control,” set P 520[0] - ENC_MCon to “CH4(4) = virtual encoder (Channel 4)”.|
|5|Under “virtual encoder (Channel 4)” ""Encoder selection"" set (P 508[0] - ENC_CH4_Sel) to ""SFC(8) = take values of SFC model"".|
|6|In the “Basic Control Settings” screen (see section “Basic settings” on page 101) set “Speed filter TF” (P 351[0] - CON_SCALC_Tf) to 10 ms. In the “Asynchronous motor control settings identification” screen (see also section ""Asynchronous motor"" on page 38) enter the “Total moment of inertia” of the system (P 1516[0] - SCD_JSum). Enter a value that is too small rather than too big to avoid a tendency to oscillate. Automatic detection is not advisable due to the control dynamics and accuracy required.|
|7|In the same screen under “Control design by stiffness” set P 1515[0] - SCD_ConDesign (Stiffness) to 10%.|

# Table 6.31: Commissioning a sensorless-controlled asynchronous motor

|P No.|Index Name|Unit|Description|
|---|---|---|---|
|351|CON_SCALC_Tf| |Speed filter|
| |0|ms|Filter time const. speed control (motor)|
| |1|ms|Filter time const. ",What are the recommended settings for the test signal generator in 'MSD ServoDrive - DeviceHelp'?,A5,"For the test signal generator, a sinusoidal d-axis signal at 500 Hz with set current and speed values is advised.",1.6171875,1.6015625,3.328125,1.3515625,0.515625
20,msd_servo_drive.txt,36,cd9a6c3d43aee09fd8ea49d961e129d8ce140335b4efd00b1c6c207c901b75b1,"Before being fed into the circuit, speeds n_kal and n_eps can each be smoothed with a filter (P 351[0] for n_eps and P 339[0] for n_kal). The expanded speed control circuit can be started with P 350[0] (“4” => Kalman).

The inductance difference is important when it comes to sensorless control, as the Kalman filter can determine the position based on the inductance difference in.

Image 6.10: Expanded speed controller layout

Measurements have shown that, when using the expanded control circuit, motors with a marked saliency can be operated in a sensorless manner even without a test signal.

# 6 Encoder

MOOG ID No.:CB40859-001 Date:11/2020

MSD ServoDrive - DeviceHelp 96

In combination with a test signal when the motor is stopped. In addition, the total moment of inertia resulting from the motor and the connected load must be set as accurately as possible.

The encoder communications will be used to calculate and pass the actual speed and actual position. Accordingly, in order to select the sensorless method, a value of 2 must be set for encoder channel 4 in the selector (P 508[0] - ENC_CH4_Sel = 2), and a value of 4 must be set for P 520[0] - ENC_MCon, P 521[0] - ENC_SCon and P 522[0] - ENC_PCon.

The Kalman filter needs to be configured further by following the steps below:

|Step|Action|
|---|---|
|1|Automatically configure noise covariance matrices Q and R by setting the control parameter for encoder channel 4 (P 783[0] - ENC-CH4-Ctrl) to a value of 6.|
| |Manually configure the test signal generator:|
| |Recommendation: Sinusoidal test signal in d axis|
| |P 792[09] = 1|
| |P 792[19] = 500 Hz|
| |P 792[2] = P 792[9] = 10% of rated motor current|
| |P 792[79] = 15% of rated motor speed|
| |P 792[89] = 5% of rated motor speed|
| |P 792[9] = 30% of rated motor current|
| |Set the other values to 0|
|2|Or set the control parameter for encoder channel 4 (P 783[0] - ENC-CH4-Ctrl) to a value of 3, which will trigger a general initialization routine in which steps 1 and 2, as well as encoder initialization, will be automatically carried out based on the motor parameters.|

# Table 6.30: Configuring the Kalman filter for sensorless control

# Step

# Action

In order to make the encoderless control commissioning process easier, a function used to calculate the position difference between encoderless control and a real encoder can be activated. To use this function, the encoder channel that will be used for the comparison must be selected in P 797[0] - ENC_CH4_Kalman_Compare.

As described in Section ""Auto commutation"" on page 92 or Recommendation:

- P 390[0] = 1
- P 392[0] = 500
- P 392[1] = 500
- P 392[2] = 500
- P 392[3] = 500
- P 393[0] = Rated motor current
- P 393[1] = Rated motor current

# Mode 2

Parameters 792.1 and 792.2 are used as the measuring frequency and measuring amplitude (see step 2)

Recommendation:

- P 794[0] = 100 ms
- P 794[1] = 50% of rated motor current
- P 794[2] = 250 ms

Starting the expanded speed control circuit is not absolutely necessary, but will result in control with better dynamic performance. The circuit can be started by setting P 350[0] - SEL_ObserverMethod to a value of 4. P 339 - CON_SCON_Kalman can be used for tuning purposes. If necessary, adjust the noise covariance matrices and the filter time constants for the expanded speed control circuit (changes will take effect in real-time).

# Table 6.30: Configuring the Kalman filter for sensorless control (continue)

MOOG ID No.:CB40859-001 Date:11/2020

MSD ServoDrive - DeviceHelp 97

# 6 Encoder

# 6 Encoder

MOOG ID No.:CB40859-001 Date:11/2020

# 6.8.2.1 Activation of sensorless control for asynchronous motors

Proceed as follows:

|No.|Activity|
|---|---|
|1|Set motor type (P 450[0] - MOT_Type) to “2 (ASM) = asynchronous motor”.|
|2|Enter the motor name (P 451[0] - MOT_Name).|
|3|Copy the motor variables from the rating plate into the appropriate input box.|
|4|Start motor identification to identify other motor parameters. In the “Encoder selection” screen (see also section ""Encoder selection"" on page 53) under “Encoder for commutation and torque control,” set P 520[0] - ENC_MCon to “CH4(4) = virtual encoder (Channel 4)”.|
|5|Under “virtual encoder (Channel 4)” ""Encoder selection"" set (P 508[0] - ENC_CH4_Sel) to ""SFC(8) = take values of SFC model"".|
|6|In the “Basic Control Settings” screen (see section “Basic settings” on page 101) set “Speed filter TF” (P 351[0] - CON_SCALC_Tf) to 10 ms. In the “Asynchronous motor control settings identification” screen (see also section ""Asynchronous motor"" on page 38) enter the “Total moment of inertia” of the system (P 1516[0] - SCD_JSum). Enter a value that is too small rather than too big to avoid a tendency to oscillate. Automatic detection is not advisable due to the control dynamics and accuracy required.|
|7|In the same screen under “Control design by stiffness” set P 1515[0] - SCD_ConDesign (Stiffness) to 10%.|

# Table 6.31: Commissioning a sensorless-controlled asynchronous motor

|P No.|Index Name|Unit|Description|
|---|---|---|---|
|351|CON_SCALC_Tf| |Speed filter|
| |0|ms|Filter time const. speed control (motor)|
| |1|ms|Filter time const. ",What function can be activated to simplify the encoderless control commissioning process in 'MSD ServoDrive - DeviceHelp'?,A1,A function to calculate the position difference between encoderless control and a real encoder.,1.546875,1.59375,3.328125,1.234375,0.416015625
21,msd_servo_drive.txt,36,cd9a6c3d43aee09fd8ea49d961e129d8ce140335b4efd00b1c6c207c901b75b1,"Before being fed into the circuit, speeds n_kal and n_eps can each be smoothed with a filter (P 351[0] for n_eps and P 339[0] for n_kal). The expanded speed control circuit can be started with P 350[0] (“4” => Kalman).

The inductance difference is important when it comes to sensorless control, as the Kalman filter can determine the position based on the inductance difference in.

Image 6.10: Expanded speed controller layout

Measurements have shown that, when using the expanded control circuit, motors with a marked saliency can be operated in a sensorless manner even without a test signal.

# 6 Encoder

MOOG ID No.:CB40859-001 Date:11/2020

MSD ServoDrive - DeviceHelp 96

In combination with a test signal when the motor is stopped. In addition, the total moment of inertia resulting from the motor and the connected load must be set as accurately as possible.

The encoder communications will be used to calculate and pass the actual speed and actual position. Accordingly, in order to select the sensorless method, a value of 2 must be set for encoder channel 4 in the selector (P 508[0] - ENC_CH4_Sel = 2), and a value of 4 must be set for P 520[0] - ENC_MCon, P 521[0] - ENC_SCon and P 522[0] - ENC_PCon.

The Kalman filter needs to be configured further by following the steps below:

|Step|Action|
|---|---|
|1|Automatically configure noise covariance matrices Q and R by setting the control parameter for encoder channel 4 (P 783[0] - ENC-CH4-Ctrl) to a value of 6.|
| |Manually configure the test signal generator:|
| |Recommendation: Sinusoidal test signal in d axis|
| |P 792[09] = 1|
| |P 792[19] = 500 Hz|
| |P 792[2] = P 792[9] = 10% of rated motor current|
| |P 792[79] = 15% of rated motor speed|
| |P 792[89] = 5% of rated motor speed|
| |P 792[9] = 30% of rated motor current|
| |Set the other values to 0|
|2|Or set the control parameter for encoder channel 4 (P 783[0] - ENC-CH4-Ctrl) to a value of 3, which will trigger a general initialization routine in which steps 1 and 2, as well as encoder initialization, will be automatically carried out based on the motor parameters.|

# Table 6.30: Configuring the Kalman filter for sensorless control

# Step

# Action

In order to make the encoderless control commissioning process easier, a function used to calculate the position difference between encoderless control and a real encoder can be activated. To use this function, the encoder channel that will be used for the comparison must be selected in P 797[0] - ENC_CH4_Kalman_Compare.

As described in Section ""Auto commutation"" on page 92 or Recommendation:

- P 390[0] = 1
- P 392[0] = 500
- P 392[1] = 500
- P 392[2] = 500
- P 392[3] = 500
- P 393[0] = Rated motor current
- P 393[1] = Rated motor current

# Mode 2

Parameters 792.1 and 792.2 are used as the measuring frequency and measuring amplitude (see step 2)

Recommendation:

- P 794[0] = 100 ms
- P 794[1] = 50% of rated motor current
- P 794[2] = 250 ms

Starting the expanded speed control circuit is not absolutely necessary, but will result in control with better dynamic performance. The circuit can be started by setting P 350[0] - SEL_ObserverMethod to a value of 4. P 339 - CON_SCON_Kalman can be used for tuning purposes. If necessary, adjust the noise covariance matrices and the filter time constants for the expanded speed control circuit (changes will take effect in real-time).

# Table 6.30: Configuring the Kalman filter for sensorless control (continue)

MOOG ID No.:CB40859-001 Date:11/2020

MSD ServoDrive - DeviceHelp 97

# 6 Encoder

# 6 Encoder

MOOG ID No.:CB40859-001 Date:11/2020

# 6.8.2.1 Activation of sensorless control for asynchronous motors

Proceed as follows:

|No.|Activity|
|---|---|
|1|Set motor type (P 450[0] - MOT_Type) to “2 (ASM) = asynchronous motor”.|
|2|Enter the motor name (P 451[0] - MOT_Name).|
|3|Copy the motor variables from the rating plate into the appropriate input box.|
|4|Start motor identification to identify other motor parameters. In the “Encoder selection” screen (see also section ""Encoder selection"" on page 53) under “Encoder for commutation and torque control,” set P 520[0] - ENC_MCon to “CH4(4) = virtual encoder (Channel 4)”.|
|5|Under “virtual encoder (Channel 4)” ""Encoder selection"" set (P 508[0] - ENC_CH4_Sel) to ""SFC(8) = take values of SFC model"".|
|6|In the “Basic Control Settings” screen (see section “Basic settings” on page 101) set “Speed filter TF” (P 351[0] - CON_SCALC_Tf) to 10 ms. In the “Asynchronous motor control settings identification” screen (see also section ""Asynchronous motor"" on page 38) enter the “Total moment of inertia” of the system (P 1516[0] - SCD_JSum). Enter a value that is too small rather than too big to avoid a tendency to oscillate. Automatic detection is not advisable due to the control dynamics and accuracy required.|
|7|In the same screen under “Control design by stiffness” set P 1515[0] - SCD_ConDesign (Stiffness) to 10%.|

# Table 6.31: Commissioning a sensorless-controlled asynchronous motor

|P No.|Index Name|Unit|Description|
|---|---|---|---|
|351|CON_SCALC_Tf| |Speed filter|
| |0|ms|Filter time const. speed control (motor)|
| |1|ms|Filter time const. ",What function can be activated to simplify the encoderless control commissioning process in 'MSD ServoDrive - DeviceHelp'?,A2,Activating a comparison function between encoderless control and actual encoder data simplifies commissioning.,2.171875,2.328125,3.609375,1.4140625,0.59375
22,msd_servo_drive.txt,36,cd9a6c3d43aee09fd8ea49d961e129d8ce140335b4efd00b1c6c207c901b75b1,"Before being fed into the circuit, speeds n_kal and n_eps can each be smoothed with a filter (P 351[0] for n_eps and P 339[0] for n_kal). The expanded speed control circuit can be started with P 350[0] (“4” => Kalman).

The inductance difference is important when it comes to sensorless control, as the Kalman filter can determine the position based on the inductance difference in.

Image 6.10: Expanded speed controller layout

Measurements have shown that, when using the expanded control circuit, motors with a marked saliency can be operated in a sensorless manner even without a test signal.

# 6 Encoder

MOOG ID No.:CB40859-001 Date:11/2020

MSD ServoDrive - DeviceHelp 96

In combination with a test signal when the motor is stopped. In addition, the total moment of inertia resulting from the motor and the connected load must be set as accurately as possible.

The encoder communications will be used to calculate and pass the actual speed and actual position. Accordingly, in order to select the sensorless method, a value of 2 must be set for encoder channel 4 in the selector (P 508[0] - ENC_CH4_Sel = 2), and a value of 4 must be set for P 520[0] - ENC_MCon, P 521[0] - ENC_SCon and P 522[0] - ENC_PCon.

The Kalman filter needs to be configured further by following the steps below:

|Step|Action|
|---|---|
|1|Automatically configure noise covariance matrices Q and R by setting the control parameter for encoder channel 4 (P 783[0] - ENC-CH4-Ctrl) to a value of 6.|
| |Manually configure the test signal generator:|
| |Recommendation: Sinusoidal test signal in d axis|
| |P 792[09] = 1|
| |P 792[19] = 500 Hz|
| |P 792[2] = P 792[9] = 10% of rated motor current|
| |P 792[79] = 15% of rated motor speed|
| |P 792[89] = 5% of rated motor speed|
| |P 792[9] = 30% of rated motor current|
| |Set the other values to 0|
|2|Or set the control parameter for encoder channel 4 (P 783[0] - ENC-CH4-Ctrl) to a value of 3, which will trigger a general initialization routine in which steps 1 and 2, as well as encoder initialization, will be automatically carried out based on the motor parameters.|

# Table 6.30: Configuring the Kalman filter for sensorless control

# Step

# Action

In order to make the encoderless control commissioning process easier, a function used to calculate the position difference between encoderless control and a real encoder can be activated. To use this function, the encoder channel that will be used for the comparison must be selected in P 797[0] - ENC_CH4_Kalman_Compare.

As described in Section ""Auto commutation"" on page 92 or Recommendation:

- P 390[0] = 1
- P 392[0] = 500
- P 392[1] = 500
- P 392[2] = 500
- P 392[3] = 500
- P 393[0] = Rated motor current
- P 393[1] = Rated motor current

# Mode 2

Parameters 792.1 and 792.2 are used as the measuring frequency and measuring amplitude (see step 2)

Recommendation:

- P 794[0] = 100 ms
- P 794[1] = 50% of rated motor current
- P 794[2] = 250 ms

Starting the expanded speed control circuit is not absolutely necessary, but will result in control with better dynamic performance. The circuit can be started by setting P 350[0] - SEL_ObserverMethod to a value of 4. P 339 - CON_SCON_Kalman can be used for tuning purposes. If necessary, adjust the noise covariance matrices and the filter time constants for the expanded speed control circuit (changes will take effect in real-time).

# Table 6.30: Configuring the Kalman filter for sensorless control (continue)

MOOG ID No.:CB40859-001 Date:11/2020

MSD ServoDrive - DeviceHelp 97

# 6 Encoder

# 6 Encoder

MOOG ID No.:CB40859-001 Date:11/2020

# 6.8.2.1 Activation of sensorless control for asynchronous motors

Proceed as follows:

|No.|Activity|
|---|---|
|1|Set motor type (P 450[0] - MOT_Type) to “2 (ASM) = asynchronous motor”.|
|2|Enter the motor name (P 451[0] - MOT_Name).|
|3|Copy the motor variables from the rating plate into the appropriate input box.|
|4|Start motor identification to identify other motor parameters. In the “Encoder selection” screen (see also section ""Encoder selection"" on page 53) under “Encoder for commutation and torque control,” set P 520[0] - ENC_MCon to “CH4(4) = virtual encoder (Channel 4)”.|
|5|Under “virtual encoder (Channel 4)” ""Encoder selection"" set (P 508[0] - ENC_CH4_Sel) to ""SFC(8) = take values of SFC model"".|
|6|In the “Basic Control Settings” screen (see section “Basic settings” on page 101) set “Speed filter TF” (P 351[0] - CON_SCALC_Tf) to 10 ms. In the “Asynchronous motor control settings identification” screen (see also section ""Asynchronous motor"" on page 38) enter the “Total moment of inertia” of the system (P 1516[0] - SCD_JSum). Enter a value that is too small rather than too big to avoid a tendency to oscillate. Automatic detection is not advisable due to the control dynamics and accuracy required.|
|7|In the same screen under “Control design by stiffness” set P 1515[0] - SCD_ConDesign (Stiffness) to 10%.|

# Table 6.31: Commissioning a sensorless-controlled asynchronous motor

|P No.|Index Name|Unit|Description|
|---|---|---|---|
|351|CON_SCALC_Tf| |Speed filter|
| |0|ms|Filter time const. speed control (motor)|
| |1|ms|Filter time const. ",What function can be activated to simplify the encoderless control commissioning process in 'MSD ServoDrive - DeviceHelp'?,A3,The process is eased by enabling a feature that contrasts encoderless control positions with those from a real encoder.,2.078125,2.140625,3.59375,1.375,0.69140625
23,msd_servo_drive.txt,36,cd9a6c3d43aee09fd8ea49d961e129d8ce140335b4efd00b1c6c207c901b75b1,"Before being fed into the circuit, speeds n_kal and n_eps can each be smoothed with a filter (P 351[0] for n_eps and P 339[0] for n_kal). The expanded speed control circuit can be started with P 350[0] (“4” => Kalman).

The inductance difference is important when it comes to sensorless control, as the Kalman filter can determine the position based on the inductance difference in.

Image 6.10: Expanded speed controller layout

Measurements have shown that, when using the expanded control circuit, motors with a marked saliency can be operated in a sensorless manner even without a test signal.

# 6 Encoder

MOOG ID No.:CB40859-001 Date:11/2020

MSD ServoDrive - DeviceHelp 96

In combination with a test signal when the motor is stopped. In addition, the total moment of inertia resulting from the motor and the connected load must be set as accurately as possible.

The encoder communications will be used to calculate and pass the actual speed and actual position. Accordingly, in order to select the sensorless method, a value of 2 must be set for encoder channel 4 in the selector (P 508[0] - ENC_CH4_Sel = 2), and a value of 4 must be set for P 520[0] - ENC_MCon, P 521[0] - ENC_SCon and P 522[0] - ENC_PCon.

The Kalman filter needs to be configured further by following the steps below:

|Step|Action|
|---|---|
|1|Automatically configure noise covariance matrices Q and R by setting the control parameter for encoder channel 4 (P 783[0] - ENC-CH4-Ctrl) to a value of 6.|
| |Manually configure the test signal generator:|
| |Recommendation: Sinusoidal test signal in d axis|
| |P 792[09] = 1|
| |P 792[19] = 500 Hz|
| |P 792[2] = P 792[9] = 10% of rated motor current|
| |P 792[79] = 15% of rated motor speed|
| |P 792[89] = 5% of rated motor speed|
| |P 792[9] = 30% of rated motor current|
| |Set the other values to 0|
|2|Or set the control parameter for encoder channel 4 (P 783[0] - ENC-CH4-Ctrl) to a value of 3, which will trigger a general initialization routine in which steps 1 and 2, as well as encoder initialization, will be automatically carried out based on the motor parameters.|

# Table 6.30: Configuring the Kalman filter for sensorless control

# Step

# Action

In order to make the encoderless control commissioning process easier, a function used to calculate the position difference between encoderless control and a real encoder can be activated. To use this function, the encoder channel that will be used for the comparison must be selected in P 797[0] - ENC_CH4_Kalman_Compare.

As described in Section ""Auto commutation"" on page 92 or Recommendation:

- P 390[0] = 1
- P 392[0] = 500
- P 392[1] = 500
- P 392[2] = 500
- P 392[3] = 500
- P 393[0] = Rated motor current
- P 393[1] = Rated motor current

# Mode 2

Parameters 792.1 and 792.2 are used as the measuring frequency and measuring amplitude (see step 2)

Recommendation:

- P 794[0] = 100 ms
- P 794[1] = 50% of rated motor current
- P 794[2] = 250 ms

Starting the expanded speed control circuit is not absolutely necessary, but will result in control with better dynamic performance. The circuit can be started by setting P 350[0] - SEL_ObserverMethod to a value of 4. P 339 - CON_SCON_Kalman can be used for tuning purposes. If necessary, adjust the noise covariance matrices and the filter time constants for the expanded speed control circuit (changes will take effect in real-time).

# Table 6.30: Configuring the Kalman filter for sensorless control (continue)

MOOG ID No.:CB40859-001 Date:11/2020

MSD ServoDrive - DeviceHelp 97

# 6 Encoder

# 6 Encoder

MOOG ID No.:CB40859-001 Date:11/2020

# 6.8.2.1 Activation of sensorless control for asynchronous motors

Proceed as follows:

|No.|Activity|
|---|---|
|1|Set motor type (P 450[0] - MOT_Type) to “2 (ASM) = asynchronous motor”.|
|2|Enter the motor name (P 451[0] - MOT_Name).|
|3|Copy the motor variables from the rating plate into the appropriate input box.|
|4|Start motor identification to identify other motor parameters. In the “Encoder selection” screen (see also section ""Encoder selection"" on page 53) under “Encoder for commutation and torque control,” set P 520[0] - ENC_MCon to “CH4(4) = virtual encoder (Channel 4)”.|
|5|Under “virtual encoder (Channel 4)” ""Encoder selection"" set (P 508[0] - ENC_CH4_Sel) to ""SFC(8) = take values of SFC model"".|
|6|In the “Basic Control Settings” screen (see section “Basic settings” on page 101) set “Speed filter TF” (P 351[0] - CON_SCALC_Tf) to 10 ms. In the “Asynchronous motor control settings identification” screen (see also section ""Asynchronous motor"" on page 38) enter the “Total moment of inertia” of the system (P 1516[0] - SCD_JSum). Enter a value that is too small rather than too big to avoid a tendency to oscillate. Automatic detection is not advisable due to the control dynamics and accuracy required.|
|7|In the same screen under “Control design by stiffness” set P 1515[0] - SCD_ConDesign (Stiffness) to 10%.|

# Table 6.31: Commissioning a sensorless-controlled asynchronous motor

|P No.|Index Name|Unit|Description|
|---|---|---|---|
|351|CON_SCALC_Tf| |Speed filter|
| |0|ms|Filter time const. speed control (motor)|
| |1|ms|Filter time const. ",What function can be activated to simplify the encoderless control commissioning process in 'MSD ServoDrive - DeviceHelp'?,A4,Simplification is achieved through a function that evaluates discrepancies between virtual and physical encoder outputs.,1.375,1.46875,3.109375,1.3203125,0.55859375
24,msd_servo_drive.txt,36,cd9a6c3d43aee09fd8ea49d961e129d8ce140335b4efd00b1c6c207c901b75b1,"Before being fed into the circuit, speeds n_kal and n_eps can each be smoothed with a filter (P 351[0] for n_eps and P 339[0] for n_kal). The expanded speed control circuit can be started with P 350[0] (“4” => Kalman).

The inductance difference is important when it comes to sensorless control, as the Kalman filter can determine the position based on the inductance difference in.

Image 6.10: Expanded speed controller layout

Measurements have shown that, when using the expanded control circuit, motors with a marked saliency can be operated in a sensorless manner even without a test signal.

# 6 Encoder

MOOG ID No.:CB40859-001 Date:11/2020

MSD ServoDrive - DeviceHelp 96

In combination with a test signal when the motor is stopped. In addition, the total moment of inertia resulting from the motor and the connected load must be set as accurately as possible.

The encoder communications will be used to calculate and pass the actual speed and actual position. Accordingly, in order to select the sensorless method, a value of 2 must be set for encoder channel 4 in the selector (P 508[0] - ENC_CH4_Sel = 2), and a value of 4 must be set for P 520[0] - ENC_MCon, P 521[0] - ENC_SCon and P 522[0] - ENC_PCon.

The Kalman filter needs to be configured further by following the steps below:

|Step|Action|
|---|---|
|1|Automatically configure noise covariance matrices Q and R by setting the control parameter for encoder channel 4 (P 783[0] - ENC-CH4-Ctrl) to a value of 6.|
| |Manually configure the test signal generator:|
| |Recommendation: Sinusoidal test signal in d axis|
| |P 792[09] = 1|
| |P 792[19] = 500 Hz|
| |P 792[2] = P 792[9] = 10% of rated motor current|
| |P 792[79] = 15% of rated motor speed|
| |P 792[89] = 5% of rated motor speed|
| |P 792[9] = 30% of rated motor current|
| |Set the other values to 0|
|2|Or set the control parameter for encoder channel 4 (P 783[0] - ENC-CH4-Ctrl) to a value of 3, which will trigger a general initialization routine in which steps 1 and 2, as well as encoder initialization, will be automatically carried out based on the motor parameters.|

# Table 6.30: Configuring the Kalman filter for sensorless control

# Step

# Action

In order to make the encoderless control commissioning process easier, a function used to calculate the position difference between encoderless control and a real encoder can be activated. To use this function, the encoder channel that will be used for the comparison must be selected in P 797[0] - ENC_CH4_Kalman_Compare.

As described in Section ""Auto commutation"" on page 92 or Recommendation:

- P 390[0] = 1
- P 392[0] = 500
- P 392[1] = 500
- P 392[2] = 500
- P 392[3] = 500
- P 393[0] = Rated motor current
- P 393[1] = Rated motor current

# Mode 2

Parameters 792.1 and 792.2 are used as the measuring frequency and measuring amplitude (see step 2)

Recommendation:

- P 794[0] = 100 ms
- P 794[1] = 50% of rated motor current
- P 794[2] = 250 ms

Starting the expanded speed control circuit is not absolutely necessary, but will result in control with better dynamic performance. The circuit can be started by setting P 350[0] - SEL_ObserverMethod to a value of 4. P 339 - CON_SCON_Kalman can be used for tuning purposes. If necessary, adjust the noise covariance matrices and the filter time constants for the expanded speed control circuit (changes will take effect in real-time).

# Table 6.30: Configuring the Kalman filter for sensorless control (continue)

MOOG ID No.:CB40859-001 Date:11/2020

MSD ServoDrive - DeviceHelp 97

# 6 Encoder

# 6 Encoder

MOOG ID No.:CB40859-001 Date:11/2020

# 6.8.2.1 Activation of sensorless control for asynchronous motors

Proceed as follows:

|No.|Activity|
|---|---|
|1|Set motor type (P 450[0] - MOT_Type) to “2 (ASM) = asynchronous motor”.|
|2|Enter the motor name (P 451[0] - MOT_Name).|
|3|Copy the motor variables from the rating plate into the appropriate input box.|
|4|Start motor identification to identify other motor parameters. In the “Encoder selection” screen (see also section ""Encoder selection"" on page 53) under “Encoder for commutation and torque control,” set P 520[0] - ENC_MCon to “CH4(4) = virtual encoder (Channel 4)”.|
|5|Under “virtual encoder (Channel 4)” ""Encoder selection"" set (P 508[0] - ENC_CH4_Sel) to ""SFC(8) = take values of SFC model"".|
|6|In the “Basic Control Settings” screen (see section “Basic settings” on page 101) set “Speed filter TF” (P 351[0] - CON_SCALC_Tf) to 10 ms. In the “Asynchronous motor control settings identification” screen (see also section ""Asynchronous motor"" on page 38) enter the “Total moment of inertia” of the system (P 1516[0] - SCD_JSum). Enter a value that is too small rather than too big to avoid a tendency to oscillate. Automatic detection is not advisable due to the control dynamics and accuracy required.|
|7|In the same screen under “Control design by stiffness” set P 1515[0] - SCD_ConDesign (Stiffness) to 10%.|

# Table 6.31: Commissioning a sensorless-controlled asynchronous motor

|P No.|Index Name|Unit|Description|
|---|---|---|---|
|351|CON_SCALC_Tf| |Speed filter|
| |0|ms|Filter time const. speed control (motor)|
| |1|ms|Filter time const. ",What function can be activated to simplify the encoderless control commissioning process in 'MSD ServoDrive - DeviceHelp'?,A5,Commissioning is streamlined by utilizing a function that assesses position variances between sensorless and encoder-based controls.,1.59375,1.640625,3.4375,1.515625,0.6640625
25,msd_servo_drive.txt,36,cd9a6c3d43aee09fd8ea49d961e129d8ce140335b4efd00b1c6c207c901b75b1,"Before being fed into the circuit, speeds n_kal and n_eps can each be smoothed with a filter (P 351[0] for n_eps and P 339[0] for n_kal). The expanded speed control circuit can be started with P 350[0] (“4” => Kalman).

The inductance difference is important when it comes to sensorless control, as the Kalman filter can determine the position based on the inductance difference in.

Image 6.10: Expanded speed controller layout

Measurements have shown that, when using the expanded control circuit, motors with a marked saliency can be operated in a sensorless manner even without a test signal.

# 6 Encoder

MOOG ID No.:CB40859-001 Date:11/2020

MSD ServoDrive - DeviceHelp 96

In combination with a test signal when the motor is stopped. In addition, the total moment of inertia resulting from the motor and the connected load must be set as accurately as possible.

The encoder communications will be used to calculate and pass the actual speed and actual position. Accordingly, in order to select the sensorless method, a value of 2 must be set for encoder channel 4 in the selector (P 508[0] - ENC_CH4_Sel = 2), and a value of 4 must be set for P 520[0] - ENC_MCon, P 521[0] - ENC_SCon and P 522[0] - ENC_PCon.

The Kalman filter needs to be configured further by following the steps below:

|Step|Action|
|---|---|
|1|Automatically configure noise covariance matrices Q and R by setting the control parameter for encoder channel 4 (P 783[0] - ENC-CH4-Ctrl) to a value of 6.|
| |Manually configure the test signal generator:|
| |Recommendation: Sinusoidal test signal in d axis|
| |P 792[09] = 1|
| |P 792[19] = 500 Hz|
| |P 792[2] = P 792[9] = 10% of rated motor current|
| |P 792[79] = 15% of rated motor speed|
| |P 792[89] = 5% of rated motor speed|
| |P 792[9] = 30% of rated motor current|
| |Set the other values to 0|
|2|Or set the control parameter for encoder channel 4 (P 783[0] - ENC-CH4-Ctrl) to a value of 3, which will trigger a general initialization routine in which steps 1 and 2, as well as encoder initialization, will be automatically carried out based on the motor parameters.|

# Table 6.30: Configuring the Kalman filter for sensorless control

# Step

# Action

In order to make the encoderless control commissioning process easier, a function used to calculate the position difference between encoderless control and a real encoder can be activated. To use this function, the encoder channel that will be used for the comparison must be selected in P 797[0] - ENC_CH4_Kalman_Compare.

As described in Section ""Auto commutation"" on page 92 or Recommendation:

- P 390[0] = 1
- P 392[0] = 500
- P 392[1] = 500
- P 392[2] = 500
- P 392[3] = 500
- P 393[0] = Rated motor current
- P 393[1] = Rated motor current

# Mode 2

Parameters 792.1 and 792.2 are used as the measuring frequency and measuring amplitude (see step 2)

Recommendation:

- P 794[0] = 100 ms
- P 794[1] = 50% of rated motor current
- P 794[2] = 250 ms

Starting the expanded speed control circuit is not absolutely necessary, but will result in control with better dynamic performance. The circuit can be started by setting P 350[0] - SEL_ObserverMethod to a value of 4. P 339 - CON_SCON_Kalman can be used for tuning purposes. If necessary, adjust the noise covariance matrices and the filter time constants for the expanded speed control circuit (changes will take effect in real-time).

# Table 6.30: Configuring the Kalman filter for sensorless control (continue)

MOOG ID No.:CB40859-001 Date:11/2020

MSD ServoDrive - DeviceHelp 97

# 6 Encoder

# 6 Encoder

MOOG ID No.:CB40859-001 Date:11/2020

# 6.8.2.1 Activation of sensorless control for asynchronous motors

Proceed as follows:

|No.|Activity|
|---|---|
|1|Set motor type (P 450[0] - MOT_Type) to “2 (ASM) = asynchronous motor”.|
|2|Enter the motor name (P 451[0] - MOT_Name).|
|3|Copy the motor variables from the rating plate into the appropriate input box.|
|4|Start motor identification to identify other motor parameters. In the “Encoder selection” screen (see also section ""Encoder selection"" on page 53) under “Encoder for commutation and torque control,” set P 520[0] - ENC_MCon to “CH4(4) = virtual encoder (Channel 4)”.|
|5|Under “virtual encoder (Channel 4)” ""Encoder selection"" set (P 508[0] - ENC_CH4_Sel) to ""SFC(8) = take values of SFC model"".|
|6|In the “Basic Control Settings” screen (see section “Basic settings” on page 101) set “Speed filter TF” (P 351[0] - CON_SCALC_Tf) to 10 ms. In the “Asynchronous motor control settings identification” screen (see also section ""Asynchronous motor"" on page 38) enter the “Total moment of inertia” of the system (P 1516[0] - SCD_JSum). Enter a value that is too small rather than too big to avoid a tendency to oscillate. Automatic detection is not advisable due to the control dynamics and accuracy required.|
|7|In the same screen under “Control design by stiffness” set P 1515[0] - SCD_ConDesign (Stiffness) to 10%.|

# Table 6.31: Commissioning a sensorless-controlled asynchronous motor

|P No.|Index Name|Unit|Description|
|---|---|---|---|
|351|CON_SCALC_Tf| |Speed filter|
| |0|ms|Filter time const. speed control (motor)|
| |1|ms|Filter time const. ",What is the purpose of smoothing speeds n_kal and n_eps before feeding them into the circuit in the book 'MSD ServoDrive - DeviceHelp'?,A1,To ensure smoother operation and better performance of the speed control circuit.,1.9609375,1.96875,3.546875,1.4375,0.26171875
26,msd_servo_drive.txt,36,cd9a6c3d43aee09fd8ea49d961e129d8ce140335b4efd00b1c6c207c901b75b1,"Before being fed into the circuit, speeds n_kal and n_eps can each be smoothed with a filter (P 351[0] for n_eps and P 339[0] for n_kal). The expanded speed control circuit can be started with P 350[0] (“4” => Kalman).

The inductance difference is important when it comes to sensorless control, as the Kalman filter can determine the position based on the inductance difference in.

Image 6.10: Expanded speed controller layout

Measurements have shown that, when using the expanded control circuit, motors with a marked saliency can be operated in a sensorless manner even without a test signal.

# 6 Encoder

MOOG ID No.:CB40859-001 Date:11/2020

MSD ServoDrive - DeviceHelp 96

In combination with a test signal when the motor is stopped. In addition, the total moment of inertia resulting from the motor and the connected load must be set as accurately as possible.

The encoder communications will be used to calculate and pass the actual speed and actual position. Accordingly, in order to select the sensorless method, a value of 2 must be set for encoder channel 4 in the selector (P 508[0] - ENC_CH4_Sel = 2), and a value of 4 must be set for P 520[0] - ENC_MCon, P 521[0] - ENC_SCon and P 522[0] - ENC_PCon.

The Kalman filter needs to be configured further by following the steps below:

|Step|Action|
|---|---|
|1|Automatically configure noise covariance matrices Q and R by setting the control parameter for encoder channel 4 (P 783[0] - ENC-CH4-Ctrl) to a value of 6.|
| |Manually configure the test signal generator:|
| |Recommendation: Sinusoidal test signal in d axis|
| |P 792[09] = 1|
| |P 792[19] = 500 Hz|
| |P 792[2] = P 792[9] = 10% of rated motor current|
| |P 792[79] = 15% of rated motor speed|
| |P 792[89] = 5% of rated motor speed|
| |P 792[9] = 30% of rated motor current|
| |Set the other values to 0|
|2|Or set the control parameter for encoder channel 4 (P 783[0] - ENC-CH4-Ctrl) to a value of 3, which will trigger a general initialization routine in which steps 1 and 2, as well as encoder initialization, will be automatically carried out based on the motor parameters.|

# Table 6.30: Configuring the Kalman filter for sensorless control

# Step

# Action

In order to make the encoderless control commissioning process easier, a function used to calculate the position difference between encoderless control and a real encoder can be activated. To use this function, the encoder channel that will be used for the comparison must be selected in P 797[0] - ENC_CH4_Kalman_Compare.

As described in Section ""Auto commutation"" on page 92 or Recommendation:

- P 390[0] = 1
- P 392[0] = 500
- P 392[1] = 500
- P 392[2] = 500
- P 392[3] = 500
- P 393[0] = Rated motor current
- P 393[1] = Rated motor current

# Mode 2

Parameters 792.1 and 792.2 are used as the measuring frequency and measuring amplitude (see step 2)

Recommendation:

- P 794[0] = 100 ms
- P 794[1] = 50% of rated motor current
- P 794[2] = 250 ms

Starting the expanded speed control circuit is not absolutely necessary, but will result in control with better dynamic performance. The circuit can be started by setting P 350[0] - SEL_ObserverMethod to a value of 4. P 339 - CON_SCON_Kalman can be used for tuning purposes. If necessary, adjust the noise covariance matrices and the filter time constants for the expanded speed control circuit (changes will take effect in real-time).

# Table 6.30: Configuring the Kalman filter for sensorless control (continue)

MOOG ID No.:CB40859-001 Date:11/2020

MSD ServoDrive - DeviceHelp 97

# 6 Encoder

# 6 Encoder

MOOG ID No.:CB40859-001 Date:11/2020

# 6.8.2.1 Activation of sensorless control for asynchronous motors

Proceed as follows:

|No.|Activity|
|---|---|
|1|Set motor type (P 450[0] - MOT_Type) to “2 (ASM) = asynchronous motor”.|
|2|Enter the motor name (P 451[0] - MOT_Name).|
|3|Copy the motor variables from the rating plate into the appropriate input box.|
|4|Start motor identification to identify other motor parameters. In the “Encoder selection” screen (see also section ""Encoder selection"" on page 53) under “Encoder for commutation and torque control,” set P 520[0] - ENC_MCon to “CH4(4) = virtual encoder (Channel 4)”.|
|5|Under “virtual encoder (Channel 4)” ""Encoder selection"" set (P 508[0] - ENC_CH4_Sel) to ""SFC(8) = take values of SFC model"".|
|6|In the “Basic Control Settings” screen (see section “Basic settings” on page 101) set “Speed filter TF” (P 351[0] - CON_SCALC_Tf) to 10 ms. In the “Asynchronous motor control settings identification” screen (see also section ""Asynchronous motor"" on page 38) enter the “Total moment of inertia” of the system (P 1516[0] - SCD_JSum). Enter a value that is too small rather than too big to avoid a tendency to oscillate. Automatic detection is not advisable due to the control dynamics and accuracy required.|
|7|In the same screen under “Control design by stiffness” set P 1515[0] - SCD_ConDesign (Stiffness) to 10%.|

# Table 6.31: Commissioning a sensorless-controlled asynchronous motor

|P No.|Index Name|Unit|Description|
|---|---|---|---|
|351|CON_SCALC_Tf| |Speed filter|
| |0|ms|Filter time const. speed control (motor)|
| |1|ms|Filter time const. ",What is the purpose of smoothing speeds n_kal and n_eps before feeding them into the circuit in the book 'MSD ServoDrive - DeviceHelp'?,A2,Smoothing these speeds helps in reducing noise and improving the accuracy of the control circuit.,2.28125,2.453125,3.703125,1.609375,0.4140625
27,msd_servo_drive.txt,36,cd9a6c3d43aee09fd8ea49d961e129d8ce140335b4efd00b1c6c207c901b75b1,"Before being fed into the circuit, speeds n_kal and n_eps can each be smoothed with a filter (P 351[0] for n_eps and P 339[0] for n_kal). The expanded speed control circuit can be started with P 350[0] (“4” => Kalman).

The inductance difference is important when it comes to sensorless control, as the Kalman filter can determine the position based on the inductance difference in.

Image 6.10: Expanded speed controller layout

Measurements have shown that, when using the expanded control circuit, motors with a marked saliency can be operated in a sensorless manner even without a test signal.

# 6 Encoder

MOOG ID No.:CB40859-001 Date:11/2020

MSD ServoDrive - DeviceHelp 96

In combination with a test signal when the motor is stopped. In addition, the total moment of inertia resulting from the motor and the connected load must be set as accurately as possible.

The encoder communications will be used to calculate and pass the actual speed and actual position. Accordingly, in order to select the sensorless method, a value of 2 must be set for encoder channel 4 in the selector (P 508[0] - ENC_CH4_Sel = 2), and a value of 4 must be set for P 520[0] - ENC_MCon, P 521[0] - ENC_SCon and P 522[0] - ENC_PCon.

The Kalman filter needs to be configured further by following the steps below:

|Step|Action|
|---|---|
|1|Automatically configure noise covariance matrices Q and R by setting the control parameter for encoder channel 4 (P 783[0] - ENC-CH4-Ctrl) to a value of 6.|
| |Manually configure the test signal generator:|
| |Recommendation: Sinusoidal test signal in d axis|
| |P 792[09] = 1|
| |P 792[19] = 500 Hz|
| |P 792[2] = P 792[9] = 10% of rated motor current|
| |P 792[79] = 15% of rated motor speed|
| |P 792[89] = 5% of rated motor speed|
| |P 792[9] = 30% of rated motor current|
| |Set the other values to 0|
|2|Or set the control parameter for encoder channel 4 (P 783[0] - ENC-CH4-Ctrl) to a value of 3, which will trigger a general initialization routine in which steps 1 and 2, as well as encoder initialization, will be automatically carried out based on the motor parameters.|

# Table 6.30: Configuring the Kalman filter for sensorless control

# Step

# Action

In order to make the encoderless control commissioning process easier, a function used to calculate the position difference between encoderless control and a real encoder can be activated. To use this function, the encoder channel that will be used for the comparison must be selected in P 797[0] - ENC_CH4_Kalman_Compare.

As described in Section ""Auto commutation"" on page 92 or Recommendation:

- P 390[0] = 1
- P 392[0] = 500
- P 392[1] = 500
- P 392[2] = 500
- P 392[3] = 500
- P 393[0] = Rated motor current
- P 393[1] = Rated motor current

# Mode 2

Parameters 792.1 and 792.2 are used as the measuring frequency and measuring amplitude (see step 2)

Recommendation:

- P 794[0] = 100 ms
- P 794[1] = 50% of rated motor current
- P 794[2] = 250 ms

Starting the expanded speed control circuit is not absolutely necessary, but will result in control with better dynamic performance. The circuit can be started by setting P 350[0] - SEL_ObserverMethod to a value of 4. P 339 - CON_SCON_Kalman can be used for tuning purposes. If necessary, adjust the noise covariance matrices and the filter time constants for the expanded speed control circuit (changes will take effect in real-time).

# Table 6.30: Configuring the Kalman filter for sensorless control (continue)

MOOG ID No.:CB40859-001 Date:11/2020

MSD ServoDrive - DeviceHelp 97

# 6 Encoder

# 6 Encoder

MOOG ID No.:CB40859-001 Date:11/2020

# 6.8.2.1 Activation of sensorless control for asynchronous motors

Proceed as follows:

|No.|Activity|
|---|---|
|1|Set motor type (P 450[0] - MOT_Type) to “2 (ASM) = asynchronous motor”.|
|2|Enter the motor name (P 451[0] - MOT_Name).|
|3|Copy the motor variables from the rating plate into the appropriate input box.|
|4|Start motor identification to identify other motor parameters. In the “Encoder selection” screen (see also section ""Encoder selection"" on page 53) under “Encoder for commutation and torque control,” set P 520[0] - ENC_MCon to “CH4(4) = virtual encoder (Channel 4)”.|
|5|Under “virtual encoder (Channel 4)” ""Encoder selection"" set (P 508[0] - ENC_CH4_Sel) to ""SFC(8) = take values of SFC model"".|
|6|In the “Basic Control Settings” screen (see section “Basic settings” on page 101) set “Speed filter TF” (P 351[0] - CON_SCALC_Tf) to 10 ms. In the “Asynchronous motor control settings identification” screen (see also section ""Asynchronous motor"" on page 38) enter the “Total moment of inertia” of the system (P 1516[0] - SCD_JSum). Enter a value that is too small rather than too big to avoid a tendency to oscillate. Automatic detection is not advisable due to the control dynamics and accuracy required.|
|7|In the same screen under “Control design by stiffness” set P 1515[0] - SCD_ConDesign (Stiffness) to 10%.|

# Table 6.31: Commissioning a sensorless-controlled asynchronous motor

|P No.|Index Name|Unit|Description|
|---|---|---|---|
|351|CON_SCALC_Tf| |Speed filter|
| |0|ms|Filter time const. speed control (motor)|
| |1|ms|Filter time const. ",What is the purpose of smoothing speeds n_kal and n_eps before feeding them into the circuit in the book 'MSD ServoDrive - DeviceHelp'?,A3,The smoothing process is essential for minimizing fluctuations and enhancing the stability of the speed control.,2.140625,2.109375,3.5,1.546875,0.39453125
28,msd_servo_drive.txt,36,cd9a6c3d43aee09fd8ea49d961e129d8ce140335b4efd00b1c6c207c901b75b1,"Before being fed into the circuit, speeds n_kal and n_eps can each be smoothed with a filter (P 351[0] for n_eps and P 339[0] for n_kal). The expanded speed control circuit can be started with P 350[0] (“4” => Kalman).

The inductance difference is important when it comes to sensorless control, as the Kalman filter can determine the position based on the inductance difference in.

Image 6.10: Expanded speed controller layout

Measurements have shown that, when using the expanded control circuit, motors with a marked saliency can be operated in a sensorless manner even without a test signal.

# 6 Encoder

MOOG ID No.:CB40859-001 Date:11/2020

MSD ServoDrive - DeviceHelp 96

In combination with a test signal when the motor is stopped. In addition, the total moment of inertia resulting from the motor and the connected load must be set as accurately as possible.

The encoder communications will be used to calculate and pass the actual speed and actual position. Accordingly, in order to select the sensorless method, a value of 2 must be set for encoder channel 4 in the selector (P 508[0] - ENC_CH4_Sel = 2), and a value of 4 must be set for P 520[0] - ENC_MCon, P 521[0] - ENC_SCon and P 522[0] - ENC_PCon.

The Kalman filter needs to be configured further by following the steps below:

|Step|Action|
|---|---|
|1|Automatically configure noise covariance matrices Q and R by setting the control parameter for encoder channel 4 (P 783[0] - ENC-CH4-Ctrl) to a value of 6.|
| |Manually configure the test signal generator:|
| |Recommendation: Sinusoidal test signal in d axis|
| |P 792[09] = 1|
| |P 792[19] = 500 Hz|
| |P 792[2] = P 792[9] = 10% of rated motor current|
| |P 792[79] = 15% of rated motor speed|
| |P 792[89] = 5% of rated motor speed|
| |P 792[9] = 30% of rated motor current|
| |Set the other values to 0|
|2|Or set the control parameter for encoder channel 4 (P 783[0] - ENC-CH4-Ctrl) to a value of 3, which will trigger a general initialization routine in which steps 1 and 2, as well as encoder initialization, will be automatically carried out based on the motor parameters.|

# Table 6.30: Configuring the Kalman filter for sensorless control

# Step

# Action

In order to make the encoderless control commissioning process easier, a function used to calculate the position difference between encoderless control and a real encoder can be activated. To use this function, the encoder channel that will be used for the comparison must be selected in P 797[0] - ENC_CH4_Kalman_Compare.

As described in Section ""Auto commutation"" on page 92 or Recommendation:

- P 390[0] = 1
- P 392[0] = 500
- P 392[1] = 500
- P 392[2] = 500
- P 392[3] = 500
- P 393[0] = Rated motor current
- P 393[1] = Rated motor current

# Mode 2

Parameters 792.1 and 792.2 are used as the measuring frequency and measuring amplitude (see step 2)

Recommendation:

- P 794[0] = 100 ms
- P 794[1] = 50% of rated motor current
- P 794[2] = 250 ms

Starting the expanded speed control circuit is not absolutely necessary, but will result in control with better dynamic performance. The circuit can be started by setting P 350[0] - SEL_ObserverMethod to a value of 4. P 339 - CON_SCON_Kalman can be used for tuning purposes. If necessary, adjust the noise covariance matrices and the filter time constants for the expanded speed control circuit (changes will take effect in real-time).

# Table 6.30: Configuring the Kalman filter for sensorless control (continue)

MOOG ID No.:CB40859-001 Date:11/2020

MSD ServoDrive - DeviceHelp 97

# 6 Encoder

# 6 Encoder

MOOG ID No.:CB40859-001 Date:11/2020

# 6.8.2.1 Activation of sensorless control for asynchronous motors

Proceed as follows:

|No.|Activity|
|---|---|
|1|Set motor type (P 450[0] - MOT_Type) to “2 (ASM) = asynchronous motor”.|
|2|Enter the motor name (P 451[0] - MOT_Name).|
|3|Copy the motor variables from the rating plate into the appropriate input box.|
|4|Start motor identification to identify other motor parameters. In the “Encoder selection” screen (see also section ""Encoder selection"" on page 53) under “Encoder for commutation and torque control,” set P 520[0] - ENC_MCon to “CH4(4) = virtual encoder (Channel 4)”.|
|5|Under “virtual encoder (Channel 4)” ""Encoder selection"" set (P 508[0] - ENC_CH4_Sel) to ""SFC(8) = take values of SFC model"".|
|6|In the “Basic Control Settings” screen (see section “Basic settings” on page 101) set “Speed filter TF” (P 351[0] - CON_SCALC_Tf) to 10 ms. In the “Asynchronous motor control settings identification” screen (see also section ""Asynchronous motor"" on page 38) enter the “Total moment of inertia” of the system (P 1516[0] - SCD_JSum). Enter a value that is too small rather than too big to avoid a tendency to oscillate. Automatic detection is not advisable due to the control dynamics and accuracy required.|
|7|In the same screen under “Control design by stiffness” set P 1515[0] - SCD_ConDesign (Stiffness) to 10%.|

# Table 6.31: Commissioning a sensorless-controlled asynchronous motor

|P No.|Index Name|Unit|Description|
|---|---|---|---|
|351|CON_SCALC_Tf| |Speed filter|
| |0|ms|Filter time const. speed control (motor)|
| |1|ms|Filter time const. ",What is the purpose of smoothing speeds n_kal and n_eps before feeding them into the circuit in the book 'MSD ServoDrive - DeviceHelp'?,A4,"It prepares the speeds for more effective processing within the circuit, leading to optimized control dynamics.",1.796875,1.8203125,3.484375,1.453125,0.451171875
29,msd_servo_drive.txt,36,cd9a6c3d43aee09fd8ea49d961e129d8ce140335b4efd00b1c6c207c901b75b1,"Before being fed into the circuit, speeds n_kal and n_eps can each be smoothed with a filter (P 351[0] for n_eps and P 339[0] for n_kal). The expanded speed control circuit can be started with P 350[0] (“4” => Kalman).

The inductance difference is important when it comes to sensorless control, as the Kalman filter can determine the position based on the inductance difference in.

Image 6.10: Expanded speed controller layout

Measurements have shown that, when using the expanded control circuit, motors with a marked saliency can be operated in a sensorless manner even without a test signal.

# 6 Encoder

MOOG ID No.:CB40859-001 Date:11/2020

MSD ServoDrive - DeviceHelp 96

In combination with a test signal when the motor is stopped. In addition, the total moment of inertia resulting from the motor and the connected load must be set as accurately as possible.

The encoder communications will be used to calculate and pass the actual speed and actual position. Accordingly, in order to select the sensorless method, a value of 2 must be set for encoder channel 4 in the selector (P 508[0] - ENC_CH4_Sel = 2), and a value of 4 must be set for P 520[0] - ENC_MCon, P 521[0] - ENC_SCon and P 522[0] - ENC_PCon.

The Kalman filter needs to be configured further by following the steps below:

|Step|Action|
|---|---|
|1|Automatically configure noise covariance matrices Q and R by setting the control parameter for encoder channel 4 (P 783[0] - ENC-CH4-Ctrl) to a value of 6.|
| |Manually configure the test signal generator:|
| |Recommendation: Sinusoidal test signal in d axis|
| |P 792[09] = 1|
| |P 792[19] = 500 Hz|
| |P 792[2] = P 792[9] = 10% of rated motor current|
| |P 792[79] = 15% of rated motor speed|
| |P 792[89] = 5% of rated motor speed|
| |P 792[9] = 30% of rated motor current|
| |Set the other values to 0|
|2|Or set the control parameter for encoder channel 4 (P 783[0] - ENC-CH4-Ctrl) to a value of 3, which will trigger a general initialization routine in which steps 1 and 2, as well as encoder initialization, will be automatically carried out based on the motor parameters.|

# Table 6.30: Configuring the Kalman filter for sensorless control

# Step

# Action

In order to make the encoderless control commissioning process easier, a function used to calculate the position difference between encoderless control and a real encoder can be activated. To use this function, the encoder channel that will be used for the comparison must be selected in P 797[0] - ENC_CH4_Kalman_Compare.

As described in Section ""Auto commutation"" on page 92 or Recommendation:

- P 390[0] = 1
- P 392[0] = 500
- P 392[1] = 500
- P 392[2] = 500
- P 392[3] = 500
- P 393[0] = Rated motor current
- P 393[1] = Rated motor current

# Mode 2

Parameters 792.1 and 792.2 are used as the measuring frequency and measuring amplitude (see step 2)

Recommendation:

- P 794[0] = 100 ms
- P 794[1] = 50% of rated motor current
- P 794[2] = 250 ms

Starting the expanded speed control circuit is not absolutely necessary, but will result in control with better dynamic performance. The circuit can be started by setting P 350[0] - SEL_ObserverMethod to a value of 4. P 339 - CON_SCON_Kalman can be used for tuning purposes. If necessary, adjust the noise covariance matrices and the filter time constants for the expanded speed control circuit (changes will take effect in real-time).

# Table 6.30: Configuring the Kalman filter for sensorless control (continue)

MOOG ID No.:CB40859-001 Date:11/2020

MSD ServoDrive - DeviceHelp 97

# 6 Encoder

# 6 Encoder

MOOG ID No.:CB40859-001 Date:11/2020

# 6.8.2.1 Activation of sensorless control for asynchronous motors

Proceed as follows:

|No.|Activity|
|---|---|
|1|Set motor type (P 450[0] - MOT_Type) to “2 (ASM) = asynchronous motor”.|
|2|Enter the motor name (P 451[0] - MOT_Name).|
|3|Copy the motor variables from the rating plate into the appropriate input box.|
|4|Start motor identification to identify other motor parameters. In the “Encoder selection” screen (see also section ""Encoder selection"" on page 53) under “Encoder for commutation and torque control,” set P 520[0] - ENC_MCon to “CH4(4) = virtual encoder (Channel 4)”.|
|5|Under “virtual encoder (Channel 4)” ""Encoder selection"" set (P 508[0] - ENC_CH4_Sel) to ""SFC(8) = take values of SFC model"".|
|6|In the “Basic Control Settings” screen (see section “Basic settings” on page 101) set “Speed filter TF” (P 351[0] - CON_SCALC_Tf) to 10 ms. In the “Asynchronous motor control settings identification” screen (see also section ""Asynchronous motor"" on page 38) enter the “Total moment of inertia” of the system (P 1516[0] - SCD_JSum). Enter a value that is too small rather than too big to avoid a tendency to oscillate. Automatic detection is not advisable due to the control dynamics and accuracy required.|
|7|In the same screen under “Control design by stiffness” set P 1515[0] - SCD_ConDesign (Stiffness) to 10%.|

# Table 6.31: Commissioning a sensorless-controlled asynchronous motor

|P No.|Index Name|Unit|Description|
|---|---|---|---|
|351|CON_SCALC_Tf| |Speed filter|
| |0|ms|Filter time const. speed control (motor)|
| |1|ms|Filter time const. ",What is the purpose of smoothing speeds n_kal and n_eps before feeding them into the circuit in the book 'MSD ServoDrive - DeviceHelp'?,A5,Smoothing n_kal and n_eps is a preparatory step that contributes to the overall efficiency and reliability of the speed control system.,1.7890625,1.953125,3.203125,1.7734375,0.296875
30,msd_servo_drive.txt,36,cd9a6c3d43aee09fd8ea49d961e129d8ce140335b4efd00b1c6c207c901b75b1,"Before being fed into the circuit, speeds n_kal and n_eps can each be smoothed with a filter (P 351[0] for n_eps and P 339[0] for n_kal). The expanded speed control circuit can be started with P 350[0] (“4” => Kalman).

The inductance difference is important when it comes to sensorless control, as the Kalman filter can determine the position based on the inductance difference in.

Image 6.10: Expanded speed controller layout

Measurements have shown that, when using the expanded control circuit, motors with a marked saliency can be operated in a sensorless manner even without a test signal.

# 6 Encoder

MOOG ID No.:CB40859-001 Date:11/2020

MSD ServoDrive - DeviceHelp 96

In combination with a test signal when the motor is stopped. In addition, the total moment of inertia resulting from the motor and the connected load must be set as accurately as possible.

The encoder communications will be used to calculate and pass the actual speed and actual position. Accordingly, in order to select the sensorless method, a value of 2 must be set for encoder channel 4 in the selector (P 508[0] - ENC_CH4_Sel = 2), and a value of 4 must be set for P 520[0] - ENC_MCon, P 521[0] - ENC_SCon and P 522[0] - ENC_PCon.

The Kalman filter needs to be configured further by following the steps below:

|Step|Action|
|---|---|
|1|Automatically configure noise covariance matrices Q and R by setting the control parameter for encoder channel 4 (P 783[0] - ENC-CH4-Ctrl) to a value of 6.|
| |Manually configure the test signal generator:|
| |Recommendation: Sinusoidal test signal in d axis|
| |P 792[09] = 1|
| |P 792[19] = 500 Hz|
| |P 792[2] = P 792[9] = 10% of rated motor current|
| |P 792[79] = 15% of rated motor speed|
| |P 792[89] = 5% of rated motor speed|
| |P 792[9] = 30% of rated motor current|
| |Set the other values to 0|
|2|Or set the control parameter for encoder channel 4 (P 783[0] - ENC-CH4-Ctrl) to a value of 3, which will trigger a general initialization routine in which steps 1 and 2, as well as encoder initialization, will be automatically carried out based on the motor parameters.|

# Table 6.30: Configuring the Kalman filter for sensorless control

# Step

# Action

In order to make the encoderless control commissioning process easier, a function used to calculate the position difference between encoderless control and a real encoder can be activated. To use this function, the encoder channel that will be used for the comparison must be selected in P 797[0] - ENC_CH4_Kalman_Compare.

As described in Section ""Auto commutation"" on page 92 or Recommendation:

- P 390[0] = 1
- P 392[0] = 500
- P 392[1] = 500
- P 392[2] = 500
- P 392[3] = 500
- P 393[0] = Rated motor current
- P 393[1] = Rated motor current

# Mode 2

Parameters 792.1 and 792.2 are used as the measuring frequency and measuring amplitude (see step 2)

Recommendation:

- P 794[0] = 100 ms
- P 794[1] = 50% of rated motor current
- P 794[2] = 250 ms

Starting the expanded speed control circuit is not absolutely necessary, but will result in control with better dynamic performance. The circuit can be started by setting P 350[0] - SEL_ObserverMethod to a value of 4. P 339 - CON_SCON_Kalman can be used for tuning purposes. If necessary, adjust the noise covariance matrices and the filter time constants for the expanded speed control circuit (changes will take effect in real-time).

# Table 6.30: Configuring the Kalman filter for sensorless control (continue)

MOOG ID No.:CB40859-001 Date:11/2020

MSD ServoDrive - DeviceHelp 97

# 6 Encoder

# 6 Encoder

MOOG ID No.:CB40859-001 Date:11/2020

# 6.8.2.1 Activation of sensorless control for asynchronous motors

Proceed as follows:

|No.|Activity|
|---|---|
|1|Set motor type (P 450[0] - MOT_Type) to “2 (ASM) = asynchronous motor”.|
|2|Enter the motor name (P 451[0] - MOT_Name).|
|3|Copy the motor variables from the rating plate into the appropriate input box.|
|4|Start motor identification to identify other motor parameters. In the “Encoder selection” screen (see also section ""Encoder selection"" on page 53) under “Encoder for commutation and torque control,” set P 520[0] - ENC_MCon to “CH4(4) = virtual encoder (Channel 4)”.|
|5|Under “virtual encoder (Channel 4)” ""Encoder selection"" set (P 508[0] - ENC_CH4_Sel) to ""SFC(8) = take values of SFC model"".|
|6|In the “Basic Control Settings” screen (see section “Basic settings” on page 101) set “Speed filter TF” (P 351[0] - CON_SCALC_Tf) to 10 ms. In the “Asynchronous motor control settings identification” screen (see also section ""Asynchronous motor"" on page 38) enter the “Total moment of inertia” of the system (P 1516[0] - SCD_JSum). Enter a value that is too small rather than too big to avoid a tendency to oscillate. Automatic detection is not advisable due to the control dynamics and accuracy required.|
|7|In the same screen under “Control design by stiffness” set P 1515[0] - SCD_ConDesign (Stiffness) to 10%.|

# Table 6.31: Commissioning a sensorless-controlled asynchronous motor

|P No.|Index Name|Unit|Description|
|---|---|---|---|
|351|CON_SCALC_Tf| |Speed filter|
| |0|ms|Filter time const. speed control (motor)|
| |1|ms|Filter time const. ",What is the recommended approach for entering the total moment of inertia in 'MSD ServoDrive - DeviceHelp'?,A1,Enter a value that is too small rather than too big to avoid oscillation tendencies.,2.203125,2.203125,3.640625,1.1953125,0.30859375
31,msd_servo_drive.txt,36,cd9a6c3d43aee09fd8ea49d961e129d8ce140335b4efd00b1c6c207c901b75b1,"Before being fed into the circuit, speeds n_kal and n_eps can each be smoothed with a filter (P 351[0] for n_eps and P 339[0] for n_kal). The expanded speed control circuit can be started with P 350[0] (“4” => Kalman).

The inductance difference is important when it comes to sensorless control, as the Kalman filter can determine the position based on the inductance difference in.

Image 6.10: Expanded speed controller layout

Measurements have shown that, when using the expanded control circuit, motors with a marked saliency can be operated in a sensorless manner even without a test signal.

# 6 Encoder

MOOG ID No.:CB40859-001 Date:11/2020

MSD ServoDrive - DeviceHelp 96

In combination with a test signal when the motor is stopped. In addition, the total moment of inertia resulting from the motor and the connected load must be set as accurately as possible.

The encoder communications will be used to calculate and pass the actual speed and actual position. Accordingly, in order to select the sensorless method, a value of 2 must be set for encoder channel 4 in the selector (P 508[0] - ENC_CH4_Sel = 2), and a value of 4 must be set for P 520[0] - ENC_MCon, P 521[0] - ENC_SCon and P 522[0] - ENC_PCon.

The Kalman filter needs to be configured further by following the steps below:

|Step|Action|
|---|---|
|1|Automatically configure noise covariance matrices Q and R by setting the control parameter for encoder channel 4 (P 783[0] - ENC-CH4-Ctrl) to a value of 6.|
| |Manually configure the test signal generator:|
| |Recommendation: Sinusoidal test signal in d axis|
| |P 792[09] = 1|
| |P 792[19] = 500 Hz|
| |P 792[2] = P 792[9] = 10% of rated motor current|
| |P 792[79] = 15% of rated motor speed|
| |P 792[89] = 5% of rated motor speed|
| |P 792[9] = 30% of rated motor current|
| |Set the other values to 0|
|2|Or set the control parameter for encoder channel 4 (P 783[0] - ENC-CH4-Ctrl) to a value of 3, which will trigger a general initialization routine in which steps 1 and 2, as well as encoder initialization, will be automatically carried out based on the motor parameters.|

# Table 6.30: Configuring the Kalman filter for sensorless control

# Step

# Action

In order to make the encoderless control commissioning process easier, a function used to calculate the position difference between encoderless control and a real encoder can be activated. To use this function, the encoder channel that will be used for the comparison must be selected in P 797[0] - ENC_CH4_Kalman_Compare.

As described in Section ""Auto commutation"" on page 92 or Recommendation:

- P 390[0] = 1
- P 392[0] = 500
- P 392[1] = 500
- P 392[2] = 500
- P 392[3] = 500
- P 393[0] = Rated motor current
- P 393[1] = Rated motor current

# Mode 2

Parameters 792.1 and 792.2 are used as the measuring frequency and measuring amplitude (see step 2)

Recommendation:

- P 794[0] = 100 ms
- P 794[1] = 50% of rated motor current
- P 794[2] = 250 ms

Starting the expanded speed control circuit is not absolutely necessary, but will result in control with better dynamic performance. The circuit can be started by setting P 350[0] - SEL_ObserverMethod to a value of 4. P 339 - CON_SCON_Kalman can be used for tuning purposes. If necessary, adjust the noise covariance matrices and the filter time constants for the expanded speed control circuit (changes will take effect in real-time).

# Table 6.30: Configuring the Kalman filter for sensorless control (continue)

MOOG ID No.:CB40859-001 Date:11/2020

MSD ServoDrive - DeviceHelp 97

# 6 Encoder

# 6 Encoder

MOOG ID No.:CB40859-001 Date:11/2020

# 6.8.2.1 Activation of sensorless control for asynchronous motors

Proceed as follows:

|No.|Activity|
|---|---|
|1|Set motor type (P 450[0] - MOT_Type) to “2 (ASM) = asynchronous motor”.|
|2|Enter the motor name (P 451[0] - MOT_Name).|
|3|Copy the motor variables from the rating plate into the appropriate input box.|
|4|Start motor identification to identify other motor parameters. In the “Encoder selection” screen (see also section ""Encoder selection"" on page 53) under “Encoder for commutation and torque control,” set P 520[0] - ENC_MCon to “CH4(4) = virtual encoder (Channel 4)”.|
|5|Under “virtual encoder (Channel 4)” ""Encoder selection"" set (P 508[0] - ENC_CH4_Sel) to ""SFC(8) = take values of SFC model"".|
|6|In the “Basic Control Settings” screen (see section “Basic settings” on page 101) set “Speed filter TF” (P 351[0] - CON_SCALC_Tf) to 10 ms. In the “Asynchronous motor control settings identification” screen (see also section ""Asynchronous motor"" on page 38) enter the “Total moment of inertia” of the system (P 1516[0] - SCD_JSum). Enter a value that is too small rather than too big to avoid a tendency to oscillate. Automatic detection is not advisable due to the control dynamics and accuracy required.|
|7|In the same screen under “Control design by stiffness” set P 1515[0] - SCD_ConDesign (Stiffness) to 10%.|

# Table 6.31: Commissioning a sensorless-controlled asynchronous motor

|P No.|Index Name|Unit|Description|
|---|---|---|---|
|351|CON_SCALC_Tf| |Speed filter|
| |0|ms|Filter time const. speed control (motor)|
| |1|ms|Filter time const. ",What is the recommended approach for entering the total moment of inertia in 'MSD ServoDrive - DeviceHelp'?,A2,Prefer underestimating the total moment of inertia to prevent system oscillations.,1.828125,1.8046875,3.328125,1.1328125,0.33984375
32,msd_servo_drive.txt,36,cd9a6c3d43aee09fd8ea49d961e129d8ce140335b4efd00b1c6c207c901b75b1,"Before being fed into the circuit, speeds n_kal and n_eps can each be smoothed with a filter (P 351[0] for n_eps and P 339[0] for n_kal). The expanded speed control circuit can be started with P 350[0] (“4” => Kalman).

The inductance difference is important when it comes to sensorless control, as the Kalman filter can determine the position based on the inductance difference in.

Image 6.10: Expanded speed controller layout

Measurements have shown that, when using the expanded control circuit, motors with a marked saliency can be operated in a sensorless manner even without a test signal.

# 6 Encoder

MOOG ID No.:CB40859-001 Date:11/2020

MSD ServoDrive - DeviceHelp 96

In combination with a test signal when the motor is stopped. In addition, the total moment of inertia resulting from the motor and the connected load must be set as accurately as possible.

The encoder communications will be used to calculate and pass the actual speed and actual position. Accordingly, in order to select the sensorless method, a value of 2 must be set for encoder channel 4 in the selector (P 508[0] - ENC_CH4_Sel = 2), and a value of 4 must be set for P 520[0] - ENC_MCon, P 521[0] - ENC_SCon and P 522[0] - ENC_PCon.

The Kalman filter needs to be configured further by following the steps below:

|Step|Action|
|---|---|
|1|Automatically configure noise covariance matrices Q and R by setting the control parameter for encoder channel 4 (P 783[0] - ENC-CH4-Ctrl) to a value of 6.|
| |Manually configure the test signal generator:|
| |Recommendation: Sinusoidal test signal in d axis|
| |P 792[09] = 1|
| |P 792[19] = 500 Hz|
| |P 792[2] = P 792[9] = 10% of rated motor current|
| |P 792[79] = 15% of rated motor speed|
| |P 792[89] = 5% of rated motor speed|
| |P 792[9] = 30% of rated motor current|
| |Set the other values to 0|
|2|Or set the control parameter for encoder channel 4 (P 783[0] - ENC-CH4-Ctrl) to a value of 3, which will trigger a general initialization routine in which steps 1 and 2, as well as encoder initialization, will be automatically carried out based on the motor parameters.|

# Table 6.30: Configuring the Kalman filter for sensorless control

# Step

# Action

In order to make the encoderless control commissioning process easier, a function used to calculate the position difference between encoderless control and a real encoder can be activated. To use this function, the encoder channel that will be used for the comparison must be selected in P 797[0] - ENC_CH4_Kalman_Compare.

As described in Section ""Auto commutation"" on page 92 or Recommendation:

- P 390[0] = 1
- P 392[0] = 500
- P 392[1] = 500
- P 392[2] = 500
- P 392[3] = 500
- P 393[0] = Rated motor current
- P 393[1] = Rated motor current

# Mode 2

Parameters 792.1 and 792.2 are used as the measuring frequency and measuring amplitude (see step 2)

Recommendation:

- P 794[0] = 100 ms
- P 794[1] = 50% of rated motor current
- P 794[2] = 250 ms

Starting the expanded speed control circuit is not absolutely necessary, but will result in control with better dynamic performance. The circuit can be started by setting P 350[0] - SEL_ObserverMethod to a value of 4. P 339 - CON_SCON_Kalman can be used for tuning purposes. If necessary, adjust the noise covariance matrices and the filter time constants for the expanded speed control circuit (changes will take effect in real-time).

# Table 6.30: Configuring the Kalman filter for sensorless control (continue)

MOOG ID No.:CB40859-001 Date:11/2020

MSD ServoDrive - DeviceHelp 97

# 6 Encoder

# 6 Encoder

MOOG ID No.:CB40859-001 Date:11/2020

# 6.8.2.1 Activation of sensorless control for asynchronous motors

Proceed as follows:

|No.|Activity|
|---|---|
|1|Set motor type (P 450[0] - MOT_Type) to “2 (ASM) = asynchronous motor”.|
|2|Enter the motor name (P 451[0] - MOT_Name).|
|3|Copy the motor variables from the rating plate into the appropriate input box.|
|4|Start motor identification to identify other motor parameters. In the “Encoder selection” screen (see also section ""Encoder selection"" on page 53) under “Encoder for commutation and torque control,” set P 520[0] - ENC_MCon to “CH4(4) = virtual encoder (Channel 4)”.|
|5|Under “virtual encoder (Channel 4)” ""Encoder selection"" set (P 508[0] - ENC_CH4_Sel) to ""SFC(8) = take values of SFC model"".|
|6|In the “Basic Control Settings” screen (see section “Basic settings” on page 101) set “Speed filter TF” (P 351[0] - CON_SCALC_Tf) to 10 ms. In the “Asynchronous motor control settings identification” screen (see also section ""Asynchronous motor"" on page 38) enter the “Total moment of inertia” of the system (P 1516[0] - SCD_JSum). Enter a value that is too small rather than too big to avoid a tendency to oscillate. Automatic detection is not advisable due to the control dynamics and accuracy required.|
|7|In the same screen under “Control design by stiffness” set P 1515[0] - SCD_ConDesign (Stiffness) to 10%.|

# Table 6.31: Commissioning a sensorless-controlled asynchronous motor

|P No.|Index Name|Unit|Description|
|---|---|---|---|
|351|CON_SCALC_Tf| |Speed filter|
| |0|ms|Filter time const. speed control (motor)|
| |1|ms|Filter time const. ",What is the recommended approach for entering the total moment of inertia in 'MSD ServoDrive - DeviceHelp'?,A3,It's advised to input a slightly lower value to minimize the risk of oscillatory behavior.,1.65625,1.90625,3.671875,1.2109375,0.208984375
33,msd_servo_drive.txt,36,cd9a6c3d43aee09fd8ea49d961e129d8ce140335b4efd00b1c6c207c901b75b1,"Before being fed into the circuit, speeds n_kal and n_eps can each be smoothed with a filter (P 351[0] for n_eps and P 339[0] for n_kal). The expanded speed control circuit can be started with P 350[0] (“4” => Kalman).

The inductance difference is important when it comes to sensorless control, as the Kalman filter can determine the position based on the inductance difference in.

Image 6.10: Expanded speed controller layout

Measurements have shown that, when using the expanded control circuit, motors with a marked saliency can be operated in a sensorless manner even without a test signal.

# 6 Encoder

MOOG ID No.:CB40859-001 Date:11/2020

MSD ServoDrive - DeviceHelp 96

In combination with a test signal when the motor is stopped. In addition, the total moment of inertia resulting from the motor and the connected load must be set as accurately as possible.

The encoder communications will be used to calculate and pass the actual speed and actual position. Accordingly, in order to select the sensorless method, a value of 2 must be set for encoder channel 4 in the selector (P 508[0] - ENC_CH4_Sel = 2), and a value of 4 must be set for P 520[0] - ENC_MCon, P 521[0] - ENC_SCon and P 522[0] - ENC_PCon.

The Kalman filter needs to be configured further by following the steps below:

|Step|Action|
|---|---|
|1|Automatically configure noise covariance matrices Q and R by setting the control parameter for encoder channel 4 (P 783[0] - ENC-CH4-Ctrl) to a value of 6.|
| |Manually configure the test signal generator:|
| |Recommendation: Sinusoidal test signal in d axis|
| |P 792[09] = 1|
| |P 792[19] = 500 Hz|
| |P 792[2] = P 792[9] = 10% of rated motor current|
| |P 792[79] = 15% of rated motor speed|
| |P 792[89] = 5% of rated motor speed|
| |P 792[9] = 30% of rated motor current|
| |Set the other values to 0|
|2|Or set the control parameter for encoder channel 4 (P 783[0] - ENC-CH4-Ctrl) to a value of 3, which will trigger a general initialization routine in which steps 1 and 2, as well as encoder initialization, will be automatically carried out based on the motor parameters.|

# Table 6.30: Configuring the Kalman filter for sensorless control

# Step

# Action

In order to make the encoderless control commissioning process easier, a function used to calculate the position difference between encoderless control and a real encoder can be activated. To use this function, the encoder channel that will be used for the comparison must be selected in P 797[0] - ENC_CH4_Kalman_Compare.

As described in Section ""Auto commutation"" on page 92 or Recommendation:

- P 390[0] = 1
- P 392[0] = 500
- P 392[1] = 500
- P 392[2] = 500
- P 392[3] = 500
- P 393[0] = Rated motor current
- P 393[1] = Rated motor current

# Mode 2

Parameters 792.1 and 792.2 are used as the measuring frequency and measuring amplitude (see step 2)

Recommendation:

- P 794[0] = 100 ms
- P 794[1] = 50% of rated motor current
- P 794[2] = 250 ms

Starting the expanded speed control circuit is not absolutely necessary, but will result in control with better dynamic performance. The circuit can be started by setting P 350[0] - SEL_ObserverMethod to a value of 4. P 339 - CON_SCON_Kalman can be used for tuning purposes. If necessary, adjust the noise covariance matrices and the filter time constants for the expanded speed control circuit (changes will take effect in real-time).

# Table 6.30: Configuring the Kalman filter for sensorless control (continue)

MOOG ID No.:CB40859-001 Date:11/2020

MSD ServoDrive - DeviceHelp 97

# 6 Encoder

# 6 Encoder

MOOG ID No.:CB40859-001 Date:11/2020

# 6.8.2.1 Activation of sensorless control for asynchronous motors

Proceed as follows:

|No.|Activity|
|---|---|
|1|Set motor type (P 450[0] - MOT_Type) to “2 (ASM) = asynchronous motor”.|
|2|Enter the motor name (P 451[0] - MOT_Name).|
|3|Copy the motor variables from the rating plate into the appropriate input box.|
|4|Start motor identification to identify other motor parameters. In the “Encoder selection” screen (see also section ""Encoder selection"" on page 53) under “Encoder for commutation and torque control,” set P 520[0] - ENC_MCon to “CH4(4) = virtual encoder (Channel 4)”.|
|5|Under “virtual encoder (Channel 4)” ""Encoder selection"" set (P 508[0] - ENC_CH4_Sel) to ""SFC(8) = take values of SFC model"".|
|6|In the “Basic Control Settings” screen (see section “Basic settings” on page 101) set “Speed filter TF” (P 351[0] - CON_SCALC_Tf) to 10 ms. In the “Asynchronous motor control settings identification” screen (see also section ""Asynchronous motor"" on page 38) enter the “Total moment of inertia” of the system (P 1516[0] - SCD_JSum). Enter a value that is too small rather than too big to avoid a tendency to oscillate. Automatic detection is not advisable due to the control dynamics and accuracy required.|
|7|In the same screen under “Control design by stiffness” set P 1515[0] - SCD_ConDesign (Stiffness) to 10%.|

# Table 6.31: Commissioning a sensorless-controlled asynchronous motor

|P No.|Index Name|Unit|Description|
|---|---|---|---|
|351|CON_SCALC_Tf| |Speed filter|
| |0|ms|Filter time const. speed control (motor)|
| |1|ms|Filter time const. ",What is the recommended approach for entering the total moment of inertia in 'MSD ServoDrive - DeviceHelp'?,A4,Choosing a smaller value for the total moment of inertia helps in maintaining control stability.,0.953125,0.9375,3.125,1.015625,0.41015625
34,msd_servo_drive.txt,36,cd9a6c3d43aee09fd8ea49d961e129d8ce140335b4efd00b1c6c207c901b75b1,"Before being fed into the circuit, speeds n_kal and n_eps can each be smoothed with a filter (P 351[0] for n_eps and P 339[0] for n_kal). The expanded speed control circuit can be started with P 350[0] (“4” => Kalman).

The inductance difference is important when it comes to sensorless control, as the Kalman filter can determine the position based on the inductance difference in.

Image 6.10: Expanded speed controller layout

Measurements have shown that, when using the expanded control circuit, motors with a marked saliency can be operated in a sensorless manner even without a test signal.

# 6 Encoder

MOOG ID No.:CB40859-001 Date:11/2020

MSD ServoDrive - DeviceHelp 96

In combination with a test signal when the motor is stopped. In addition, the total moment of inertia resulting from the motor and the connected load must be set as accurately as possible.

The encoder communications will be used to calculate and pass the actual speed and actual position. Accordingly, in order to select the sensorless method, a value of 2 must be set for encoder channel 4 in the selector (P 508[0] - ENC_CH4_Sel = 2), and a value of 4 must be set for P 520[0] - ENC_MCon, P 521[0] - ENC_SCon and P 522[0] - ENC_PCon.

The Kalman filter needs to be configured further by following the steps below:

|Step|Action|
|---|---|
|1|Automatically configure noise covariance matrices Q and R by setting the control parameter for encoder channel 4 (P 783[0] - ENC-CH4-Ctrl) to a value of 6.|
| |Manually configure the test signal generator:|
| |Recommendation: Sinusoidal test signal in d axis|
| |P 792[09] = 1|
| |P 792[19] = 500 Hz|
| |P 792[2] = P 792[9] = 10% of rated motor current|
| |P 792[79] = 15% of rated motor speed|
| |P 792[89] = 5% of rated motor speed|
| |P 792[9] = 30% of rated motor current|
| |Set the other values to 0|
|2|Or set the control parameter for encoder channel 4 (P 783[0] - ENC-CH4-Ctrl) to a value of 3, which will trigger a general initialization routine in which steps 1 and 2, as well as encoder initialization, will be automatically carried out based on the motor parameters.|

# Table 6.30: Configuring the Kalman filter for sensorless control

# Step

# Action

In order to make the encoderless control commissioning process easier, a function used to calculate the position difference between encoderless control and a real encoder can be activated. To use this function, the encoder channel that will be used for the comparison must be selected in P 797[0] - ENC_CH4_Kalman_Compare.

As described in Section ""Auto commutation"" on page 92 or Recommendation:

- P 390[0] = 1
- P 392[0] = 500
- P 392[1] = 500
- P 392[2] = 500
- P 392[3] = 500
- P 393[0] = Rated motor current
- P 393[1] = Rated motor current

# Mode 2

Parameters 792.1 and 792.2 are used as the measuring frequency and measuring amplitude (see step 2)

Recommendation:

- P 794[0] = 100 ms
- P 794[1] = 50% of rated motor current
- P 794[2] = 250 ms

Starting the expanded speed control circuit is not absolutely necessary, but will result in control with better dynamic performance. The circuit can be started by setting P 350[0] - SEL_ObserverMethod to a value of 4. P 339 - CON_SCON_Kalman can be used for tuning purposes. If necessary, adjust the noise covariance matrices and the filter time constants for the expanded speed control circuit (changes will take effect in real-time).

# Table 6.30: Configuring the Kalman filter for sensorless control (continue)

MOOG ID No.:CB40859-001 Date:11/2020

MSD ServoDrive - DeviceHelp 97

# 6 Encoder

# 6 Encoder

MOOG ID No.:CB40859-001 Date:11/2020

# 6.8.2.1 Activation of sensorless control for asynchronous motors

Proceed as follows:

|No.|Activity|
|---|---|
|1|Set motor type (P 450[0] - MOT_Type) to “2 (ASM) = asynchronous motor”.|
|2|Enter the motor name (P 451[0] - MOT_Name).|
|3|Copy the motor variables from the rating plate into the appropriate input box.|
|4|Start motor identification to identify other motor parameters. In the “Encoder selection” screen (see also section ""Encoder selection"" on page 53) under “Encoder for commutation and torque control,” set P 520[0] - ENC_MCon to “CH4(4) = virtual encoder (Channel 4)”.|
|5|Under “virtual encoder (Channel 4)” ""Encoder selection"" set (P 508[0] - ENC_CH4_Sel) to ""SFC(8) = take values of SFC model"".|
|6|In the “Basic Control Settings” screen (see section “Basic settings” on page 101) set “Speed filter TF” (P 351[0] - CON_SCALC_Tf) to 10 ms. In the “Asynchronous motor control settings identification” screen (see also section ""Asynchronous motor"" on page 38) enter the “Total moment of inertia” of the system (P 1516[0] - SCD_JSum). Enter a value that is too small rather than too big to avoid a tendency to oscillate. Automatic detection is not advisable due to the control dynamics and accuracy required.|
|7|In the same screen under “Control design by stiffness” set P 1515[0] - SCD_ConDesign (Stiffness) to 10%.|

# Table 6.31: Commissioning a sensorless-controlled asynchronous motor

|P No.|Index Name|Unit|Description|
|---|---|---|---|
|351|CON_SCALC_Tf| |Speed filter|
| |0|ms|Filter time const. speed control (motor)|
| |1|ms|Filter time const. ",What is the recommended approach for entering the total moment of inertia in 'MSD ServoDrive - DeviceHelp'?,A5,"To ensure smooth operation, the manual suggests erring on the side of a smaller total moment of inertia.",1.3515625,1.3203125,3.359375,1.21875,0.376953125
35,msd_servo_drive.txt,36,cd9a6c3d43aee09fd8ea49d961e129d8ce140335b4efd00b1c6c207c901b75b1,"Before being fed into the circuit, speeds n_kal and n_eps can each be smoothed with a filter (P 351[0] for n_eps and P 339[0] for n_kal). The expanded speed control circuit can be started with P 350[0] (“4” => Kalman).

The inductance difference is important when it comes to sensorless control, as the Kalman filter can determine the position based on the inductance difference in.

Image 6.10: Expanded speed controller layout

Measurements have shown that, when using the expanded control circuit, motors with a marked saliency can be operated in a sensorless manner even without a test signal.

# 6 Encoder

MOOG ID No.:CB40859-001 Date:11/2020

MSD ServoDrive - DeviceHelp 96

In combination with a test signal when the motor is stopped. In addition, the total moment of inertia resulting from the motor and the connected load must be set as accurately as possible.

The encoder communications will be used to calculate and pass the actual speed and actual position. Accordingly, in order to select the sensorless method, a value of 2 must be set for encoder channel 4 in the selector (P 508[0] - ENC_CH4_Sel = 2), and a value of 4 must be set for P 520[0] - ENC_MCon, P 521[0] - ENC_SCon and P 522[0] - ENC_PCon.

The Kalman filter needs to be configured further by following the steps below:

|Step|Action|
|---|---|
|1|Automatically configure noise covariance matrices Q and R by setting the control parameter for encoder channel 4 (P 783[0] - ENC-CH4-Ctrl) to a value of 6.|
| |Manually configure the test signal generator:|
| |Recommendation: Sinusoidal test signal in d axis|
| |P 792[09] = 1|
| |P 792[19] = 500 Hz|
| |P 792[2] = P 792[9] = 10% of rated motor current|
| |P 792[79] = 15% of rated motor speed|
| |P 792[89] = 5% of rated motor speed|
| |P 792[9] = 30% of rated motor current|
| |Set the other values to 0|
|2|Or set the control parameter for encoder channel 4 (P 783[0] - ENC-CH4-Ctrl) to a value of 3, which will trigger a general initialization routine in which steps 1 and 2, as well as encoder initialization, will be automatically carried out based on the motor parameters.|

# Table 6.30: Configuring the Kalman filter for sensorless control

# Step

# Action

In order to make the encoderless control commissioning process easier, a function used to calculate the position difference between encoderless control and a real encoder can be activated. To use this function, the encoder channel that will be used for the comparison must be selected in P 797[0] - ENC_CH4_Kalman_Compare.

As described in Section ""Auto commutation"" on page 92 or Recommendation:

- P 390[0] = 1
- P 392[0] = 500
- P 392[1] = 500
- P 392[2] = 500
- P 392[3] = 500
- P 393[0] = Rated motor current
- P 393[1] = Rated motor current

# Mode 2

Parameters 792.1 and 792.2 are used as the measuring frequency and measuring amplitude (see step 2)

Recommendation:

- P 794[0] = 100 ms
- P 794[1] = 50% of rated motor current
- P 794[2] = 250 ms

Starting the expanded speed control circuit is not absolutely necessary, but will result in control with better dynamic performance. The circuit can be started by setting P 350[0] - SEL_ObserverMethod to a value of 4. P 339 - CON_SCON_Kalman can be used for tuning purposes. If necessary, adjust the noise covariance matrices and the filter time constants for the expanded speed control circuit (changes will take effect in real-time).

# Table 6.30: Configuring the Kalman filter for sensorless control (continue)

MOOG ID No.:CB40859-001 Date:11/2020

MSD ServoDrive - DeviceHelp 97

# 6 Encoder

# 6 Encoder

MOOG ID No.:CB40859-001 Date:11/2020

# 6.8.2.1 Activation of sensorless control for asynchronous motors

Proceed as follows:

|No.|Activity|
|---|---|
|1|Set motor type (P 450[0] - MOT_Type) to “2 (ASM) = asynchronous motor”.|
|2|Enter the motor name (P 451[0] - MOT_Name).|
|3|Copy the motor variables from the rating plate into the appropriate input box.|
|4|Start motor identification to identify other motor parameters. In the “Encoder selection” screen (see also section ""Encoder selection"" on page 53) under “Encoder for commutation and torque control,” set P 520[0] - ENC_MCon to “CH4(4) = virtual encoder (Channel 4)”.|
|5|Under “virtual encoder (Channel 4)” ""Encoder selection"" set (P 508[0] - ENC_CH4_Sel) to ""SFC(8) = take values of SFC model"".|
|6|In the “Basic Control Settings” screen (see section “Basic settings” on page 101) set “Speed filter TF” (P 351[0] - CON_SCALC_Tf) to 10 ms. In the “Asynchronous motor control settings identification” screen (see also section ""Asynchronous motor"" on page 38) enter the “Total moment of inertia” of the system (P 1516[0] - SCD_JSum). Enter a value that is too small rather than too big to avoid a tendency to oscillate. Automatic detection is not advisable due to the control dynamics and accuracy required.|
|7|In the same screen under “Control design by stiffness” set P 1515[0] - SCD_ConDesign (Stiffness) to 10%.|

# Table 6.31: Commissioning a sensorless-controlled asynchronous motor

|P No.|Index Name|Unit|Description|
|---|---|---|---|
|351|CON_SCALC_Tf| |Speed filter|
| |0|ms|Filter time const. speed control (motor)|
| |1|ms|Filter time const. ",What is the significance of setting P 350[0] to '4' in 'MSD ServoDrive - DeviceHelp'?,A1,It starts the expanded speed control circuit using the Kalman filter.,0.55078125,0.4296875,2.9375,1.0859375,0.333984375
36,msd_servo_drive.txt,36,cd9a6c3d43aee09fd8ea49d961e129d8ce140335b4efd00b1c6c207c901b75b1,"Before being fed into the circuit, speeds n_kal and n_eps can each be smoothed with a filter (P 351[0] for n_eps and P 339[0] for n_kal). The expanded speed control circuit can be started with P 350[0] (“4” => Kalman).

The inductance difference is important when it comes to sensorless control, as the Kalman filter can determine the position based on the inductance difference in.

Image 6.10: Expanded speed controller layout

Measurements have shown that, when using the expanded control circuit, motors with a marked saliency can be operated in a sensorless manner even without a test signal.

# 6 Encoder

MOOG ID No.:CB40859-001 Date:11/2020

MSD ServoDrive - DeviceHelp 96

In combination with a test signal when the motor is stopped. In addition, the total moment of inertia resulting from the motor and the connected load must be set as accurately as possible.

The encoder communications will be used to calculate and pass the actual speed and actual position. Accordingly, in order to select the sensorless method, a value of 2 must be set for encoder channel 4 in the selector (P 508[0] - ENC_CH4_Sel = 2), and a value of 4 must be set for P 520[0] - ENC_MCon, P 521[0] - ENC_SCon and P 522[0] - ENC_PCon.

The Kalman filter needs to be configured further by following the steps below:

|Step|Action|
|---|---|
|1|Automatically configure noise covariance matrices Q and R by setting the control parameter for encoder channel 4 (P 783[0] - ENC-CH4-Ctrl) to a value of 6.|
| |Manually configure the test signal generator:|
| |Recommendation: Sinusoidal test signal in d axis|
| |P 792[09] = 1|
| |P 792[19] = 500 Hz|
| |P 792[2] = P 792[9] = 10% of rated motor current|
| |P 792[79] = 15% of rated motor speed|
| |P 792[89] = 5% of rated motor speed|
| |P 792[9] = 30% of rated motor current|
| |Set the other values to 0|
|2|Or set the control parameter for encoder channel 4 (P 783[0] - ENC-CH4-Ctrl) to a value of 3, which will trigger a general initialization routine in which steps 1 and 2, as well as encoder initialization, will be automatically carried out based on the motor parameters.|

# Table 6.30: Configuring the Kalman filter for sensorless control

# Step

# Action

In order to make the encoderless control commissioning process easier, a function used to calculate the position difference between encoderless control and a real encoder can be activated. To use this function, the encoder channel that will be used for the comparison must be selected in P 797[0] - ENC_CH4_Kalman_Compare.

As described in Section ""Auto commutation"" on page 92 or Recommendation:

- P 390[0] = 1
- P 392[0] = 500
- P 392[1] = 500
- P 392[2] = 500
- P 392[3] = 500
- P 393[0] = Rated motor current
- P 393[1] = Rated motor current

# Mode 2

Parameters 792.1 and 792.2 are used as the measuring frequency and measuring amplitude (see step 2)

Recommendation:

- P 794[0] = 100 ms
- P 794[1] = 50% of rated motor current
- P 794[2] = 250 ms

Starting the expanded speed control circuit is not absolutely necessary, but will result in control with better dynamic performance. The circuit can be started by setting P 350[0] - SEL_ObserverMethod to a value of 4. P 339 - CON_SCON_Kalman can be used for tuning purposes. If necessary, adjust the noise covariance matrices and the filter time constants for the expanded speed control circuit (changes will take effect in real-time).

# Table 6.30: Configuring the Kalman filter for sensorless control (continue)

MOOG ID No.:CB40859-001 Date:11/2020

MSD ServoDrive - DeviceHelp 97

# 6 Encoder

# 6 Encoder

MOOG ID No.:CB40859-001 Date:11/2020

# 6.8.2.1 Activation of sensorless control for asynchronous motors

Proceed as follows:

|No.|Activity|
|---|---|
|1|Set motor type (P 450[0] - MOT_Type) to “2 (ASM) = asynchronous motor”.|
|2|Enter the motor name (P 451[0] - MOT_Name).|
|3|Copy the motor variables from the rating plate into the appropriate input box.|
|4|Start motor identification to identify other motor parameters. In the “Encoder selection” screen (see also section ""Encoder selection"" on page 53) under “Encoder for commutation and torque control,” set P 520[0] - ENC_MCon to “CH4(4) = virtual encoder (Channel 4)”.|
|5|Under “virtual encoder (Channel 4)” ""Encoder selection"" set (P 508[0] - ENC_CH4_Sel) to ""SFC(8) = take values of SFC model"".|
|6|In the “Basic Control Settings” screen (see section “Basic settings” on page 101) set “Speed filter TF” (P 351[0] - CON_SCALC_Tf) to 10 ms. In the “Asynchronous motor control settings identification” screen (see also section ""Asynchronous motor"" on page 38) enter the “Total moment of inertia” of the system (P 1516[0] - SCD_JSum). Enter a value that is too small rather than too big to avoid a tendency to oscillate. Automatic detection is not advisable due to the control dynamics and accuracy required.|
|7|In the same screen under “Control design by stiffness” set P 1515[0] - SCD_ConDesign (Stiffness) to 10%.|

# Table 6.31: Commissioning a sensorless-controlled asynchronous motor

|P No.|Index Name|Unit|Description|
|---|---|---|---|
|351|CON_SCALC_Tf| |Speed filter|
| |0|ms|Filter time const. speed control (motor)|
| |1|ms|Filter time const. ",What is the significance of setting P 350[0] to '4' in 'MSD ServoDrive - DeviceHelp'?,A2,This setting initiates the expanded control circuit with Kalman filter-based speed observation.,0.98828125,1.03125,3.046875,1.296875,0.423828125
37,msd_servo_drive.txt,36,cd9a6c3d43aee09fd8ea49d961e129d8ce140335b4efd00b1c6c207c901b75b1,"Before being fed into the circuit, speeds n_kal and n_eps can each be smoothed with a filter (P 351[0] for n_eps and P 339[0] for n_kal). The expanded speed control circuit can be started with P 350[0] (“4” => Kalman).

The inductance difference is important when it comes to sensorless control, as the Kalman filter can determine the position based on the inductance difference in.

Image 6.10: Expanded speed controller layout

Measurements have shown that, when using the expanded control circuit, motors with a marked saliency can be operated in a sensorless manner even without a test signal.

# 6 Encoder

MOOG ID No.:CB40859-001 Date:11/2020

MSD ServoDrive - DeviceHelp 96

In combination with a test signal when the motor is stopped. In addition, the total moment of inertia resulting from the motor and the connected load must be set as accurately as possible.

The encoder communications will be used to calculate and pass the actual speed and actual position. Accordingly, in order to select the sensorless method, a value of 2 must be set for encoder channel 4 in the selector (P 508[0] - ENC_CH4_Sel = 2), and a value of 4 must be set for P 520[0] - ENC_MCon, P 521[0] - ENC_SCon and P 522[0] - ENC_PCon.

The Kalman filter needs to be configured further by following the steps below:

|Step|Action|
|---|---|
|1|Automatically configure noise covariance matrices Q and R by setting the control parameter for encoder channel 4 (P 783[0] - ENC-CH4-Ctrl) to a value of 6.|
| |Manually configure the test signal generator:|
| |Recommendation: Sinusoidal test signal in d axis|
| |P 792[09] = 1|
| |P 792[19] = 500 Hz|
| |P 792[2] = P 792[9] = 10% of rated motor current|
| |P 792[79] = 15% of rated motor speed|
| |P 792[89] = 5% of rated motor speed|
| |P 792[9] = 30% of rated motor current|
| |Set the other values to 0|
|2|Or set the control parameter for encoder channel 4 (P 783[0] - ENC-CH4-Ctrl) to a value of 3, which will trigger a general initialization routine in which steps 1 and 2, as well as encoder initialization, will be automatically carried out based on the motor parameters.|

# Table 6.30: Configuring the Kalman filter for sensorless control

# Step

# Action

In order to make the encoderless control commissioning process easier, a function used to calculate the position difference between encoderless control and a real encoder can be activated. To use this function, the encoder channel that will be used for the comparison must be selected in P 797[0] - ENC_CH4_Kalman_Compare.

As described in Section ""Auto commutation"" on page 92 or Recommendation:

- P 390[0] = 1
- P 392[0] = 500
- P 392[1] = 500
- P 392[2] = 500
- P 392[3] = 500
- P 393[0] = Rated motor current
- P 393[1] = Rated motor current

# Mode 2

Parameters 792.1 and 792.2 are used as the measuring frequency and measuring amplitude (see step 2)

Recommendation:

- P 794[0] = 100 ms
- P 794[1] = 50% of rated motor current
- P 794[2] = 250 ms

Starting the expanded speed control circuit is not absolutely necessary, but will result in control with better dynamic performance. The circuit can be started by setting P 350[0] - SEL_ObserverMethod to a value of 4. P 339 - CON_SCON_Kalman can be used for tuning purposes. If necessary, adjust the noise covariance matrices and the filter time constants for the expanded speed control circuit (changes will take effect in real-time).

# Table 6.30: Configuring the Kalman filter for sensorless control (continue)

MOOG ID No.:CB40859-001 Date:11/2020

MSD ServoDrive - DeviceHelp 97

# 6 Encoder

# 6 Encoder

MOOG ID No.:CB40859-001 Date:11/2020

# 6.8.2.1 Activation of sensorless control for asynchronous motors

Proceed as follows:

|No.|Activity|
|---|---|
|1|Set motor type (P 450[0] - MOT_Type) to “2 (ASM) = asynchronous motor”.|
|2|Enter the motor name (P 451[0] - MOT_Name).|
|3|Copy the motor variables from the rating plate into the appropriate input box.|
|4|Start motor identification to identify other motor parameters. In the “Encoder selection” screen (see also section ""Encoder selection"" on page 53) under “Encoder for commutation and torque control,” set P 520[0] - ENC_MCon to “CH4(4) = virtual encoder (Channel 4)”.|
|5|Under “virtual encoder (Channel 4)” ""Encoder selection"" set (P 508[0] - ENC_CH4_Sel) to ""SFC(8) = take values of SFC model"".|
|6|In the “Basic Control Settings” screen (see section “Basic settings” on page 101) set “Speed filter TF” (P 351[0] - CON_SCALC_Tf) to 10 ms. In the “Asynchronous motor control settings identification” screen (see also section ""Asynchronous motor"" on page 38) enter the “Total moment of inertia” of the system (P 1516[0] - SCD_JSum). Enter a value that is too small rather than too big to avoid a tendency to oscillate. Automatic detection is not advisable due to the control dynamics and accuracy required.|
|7|In the same screen under “Control design by stiffness” set P 1515[0] - SCD_ConDesign (Stiffness) to 10%.|

# Table 6.31: Commissioning a sensorless-controlled asynchronous motor

|P No.|Index Name|Unit|Description|
|---|---|---|---|
|351|CON_SCALC_Tf| |Speed filter|
| |0|ms|Filter time const. speed control (motor)|
| |1|ms|Filter time const. ",What is the significance of setting P 350[0] to '4' in 'MSD ServoDrive - DeviceHelp'?,A3,"Choosing '4' enables the expanded speed control feature, leveraging the Kalman method for enhanced dynamics.",1.296875,1.25,3.296875,1.46875,0.5625
38,msd_servo_drive.txt,36,cd9a6c3d43aee09fd8ea49d961e129d8ce140335b4efd00b1c6c207c901b75b1,"Before being fed into the circuit, speeds n_kal and n_eps can each be smoothed with a filter (P 351[0] for n_eps and P 339[0] for n_kal). The expanded speed control circuit can be started with P 350[0] (“4” => Kalman).

The inductance difference is important when it comes to sensorless control, as the Kalman filter can determine the position based on the inductance difference in.

Image 6.10: Expanded speed controller layout

Measurements have shown that, when using the expanded control circuit, motors with a marked saliency can be operated in a sensorless manner even without a test signal.

# 6 Encoder

MOOG ID No.:CB40859-001 Date:11/2020

MSD ServoDrive - DeviceHelp 96

In combination with a test signal when the motor is stopped. In addition, the total moment of inertia resulting from the motor and the connected load must be set as accurately as possible.

The encoder communications will be used to calculate and pass the actual speed and actual position. Accordingly, in order to select the sensorless method, a value of 2 must be set for encoder channel 4 in the selector (P 508[0] - ENC_CH4_Sel = 2), and a value of 4 must be set for P 520[0] - ENC_MCon, P 521[0] - ENC_SCon and P 522[0] - ENC_PCon.

The Kalman filter needs to be configured further by following the steps below:

|Step|Action|
|---|---|
|1|Automatically configure noise covariance matrices Q and R by setting the control parameter for encoder channel 4 (P 783[0] - ENC-CH4-Ctrl) to a value of 6.|
| |Manually configure the test signal generator:|
| |Recommendation: Sinusoidal test signal in d axis|
| |P 792[09] = 1|
| |P 792[19] = 500 Hz|
| |P 792[2] = P 792[9] = 10% of rated motor current|
| |P 792[79] = 15% of rated motor speed|
| |P 792[89] = 5% of rated motor speed|
| |P 792[9] = 30% of rated motor current|
| |Set the other values to 0|
|2|Or set the control parameter for encoder channel 4 (P 783[0] - ENC-CH4-Ctrl) to a value of 3, which will trigger a general initialization routine in which steps 1 and 2, as well as encoder initialization, will be automatically carried out based on the motor parameters.|

# Table 6.30: Configuring the Kalman filter for sensorless control

# Step

# Action

In order to make the encoderless control commissioning process easier, a function used to calculate the position difference between encoderless control and a real encoder can be activated. To use this function, the encoder channel that will be used for the comparison must be selected in P 797[0] - ENC_CH4_Kalman_Compare.

As described in Section ""Auto commutation"" on page 92 or Recommendation:

- P 390[0] = 1
- P 392[0] = 500
- P 392[1] = 500
- P 392[2] = 500
- P 392[3] = 500
- P 393[0] = Rated motor current
- P 393[1] = Rated motor current

# Mode 2

Parameters 792.1 and 792.2 are used as the measuring frequency and measuring amplitude (see step 2)

Recommendation:

- P 794[0] = 100 ms
- P 794[1] = 50% of rated motor current
- P 794[2] = 250 ms

Starting the expanded speed control circuit is not absolutely necessary, but will result in control with better dynamic performance. The circuit can be started by setting P 350[0] - SEL_ObserverMethod to a value of 4. P 339 - CON_SCON_Kalman can be used for tuning purposes. If necessary, adjust the noise covariance matrices and the filter time constants for the expanded speed control circuit (changes will take effect in real-time).

# Table 6.30: Configuring the Kalman filter for sensorless control (continue)

MOOG ID No.:CB40859-001 Date:11/2020

MSD ServoDrive - DeviceHelp 97

# 6 Encoder

# 6 Encoder

MOOG ID No.:CB40859-001 Date:11/2020

# 6.8.2.1 Activation of sensorless control for asynchronous motors

Proceed as follows:

|No.|Activity|
|---|---|
|1|Set motor type (P 450[0] - MOT_Type) to “2 (ASM) = asynchronous motor”.|
|2|Enter the motor name (P 451[0] - MOT_Name).|
|3|Copy the motor variables from the rating plate into the appropriate input box.|
|4|Start motor identification to identify other motor parameters. In the “Encoder selection” screen (see also section ""Encoder selection"" on page 53) under “Encoder for commutation and torque control,” set P 520[0] - ENC_MCon to “CH4(4) = virtual encoder (Channel 4)”.|
|5|Under “virtual encoder (Channel 4)” ""Encoder selection"" set (P 508[0] - ENC_CH4_Sel) to ""SFC(8) = take values of SFC model"".|
|6|In the “Basic Control Settings” screen (see section “Basic settings” on page 101) set “Speed filter TF” (P 351[0] - CON_SCALC_Tf) to 10 ms. In the “Asynchronous motor control settings identification” screen (see also section ""Asynchronous motor"" on page 38) enter the “Total moment of inertia” of the system (P 1516[0] - SCD_JSum). Enter a value that is too small rather than too big to avoid a tendency to oscillate. Automatic detection is not advisable due to the control dynamics and accuracy required.|
|7|In the same screen under “Control design by stiffness” set P 1515[0] - SCD_ConDesign (Stiffness) to 10%.|

# Table 6.31: Commissioning a sensorless-controlled asynchronous motor

|P No.|Index Name|Unit|Description|
|---|---|---|---|
|351|CON_SCALC_Tf| |Speed filter|
| |0|ms|Filter time const. speed control (motor)|
| |1|ms|Filter time const. ",What is the significance of setting P 350[0] to '4' in 'MSD ServoDrive - DeviceHelp'?,A4,"The value '4' activates the expanded speed control circuit, optimizing performance through Kalman filtering.",0.87890625,0.68359375,3.140625,1.3203125,0.4921875
39,msd_servo_drive.txt,36,cd9a6c3d43aee09fd8ea49d961e129d8ce140335b4efd00b1c6c207c901b75b1,"Before being fed into the circuit, speeds n_kal and n_eps can each be smoothed with a filter (P 351[0] for n_eps and P 339[0] for n_kal). The expanded speed control circuit can be started with P 350[0] (“4” => Kalman).

The inductance difference is important when it comes to sensorless control, as the Kalman filter can determine the position based on the inductance difference in.

Image 6.10: Expanded speed controller layout

Measurements have shown that, when using the expanded control circuit, motors with a marked saliency can be operated in a sensorless manner even without a test signal.

# 6 Encoder

MOOG ID No.:CB40859-001 Date:11/2020

MSD ServoDrive - DeviceHelp 96

In combination with a test signal when the motor is stopped. In addition, the total moment of inertia resulting from the motor and the connected load must be set as accurately as possible.

The encoder communications will be used to calculate and pass the actual speed and actual position. Accordingly, in order to select the sensorless method, a value of 2 must be set for encoder channel 4 in the selector (P 508[0] - ENC_CH4_Sel = 2), and a value of 4 must be set for P 520[0] - ENC_MCon, P 521[0] - ENC_SCon and P 522[0] - ENC_PCon.

The Kalman filter needs to be configured further by following the steps below:

|Step|Action|
|---|---|
|1|Automatically configure noise covariance matrices Q and R by setting the control parameter for encoder channel 4 (P 783[0] - ENC-CH4-Ctrl) to a value of 6.|
| |Manually configure the test signal generator:|
| |Recommendation: Sinusoidal test signal in d axis|
| |P 792[09] = 1|
| |P 792[19] = 500 Hz|
| |P 792[2] = P 792[9] = 10% of rated motor current|
| |P 792[79] = 15% of rated motor speed|
| |P 792[89] = 5% of rated motor speed|
| |P 792[9] = 30% of rated motor current|
| |Set the other values to 0|
|2|Or set the control parameter for encoder channel 4 (P 783[0] - ENC-CH4-Ctrl) to a value of 3, which will trigger a general initialization routine in which steps 1 and 2, as well as encoder initialization, will be automatically carried out based on the motor parameters.|

# Table 6.30: Configuring the Kalman filter for sensorless control

# Step

# Action

In order to make the encoderless control commissioning process easier, a function used to calculate the position difference between encoderless control and a real encoder can be activated. To use this function, the encoder channel that will be used for the comparison must be selected in P 797[0] - ENC_CH4_Kalman_Compare.

As described in Section ""Auto commutation"" on page 92 or Recommendation:

- P 390[0] = 1
- P 392[0] = 500
- P 392[1] = 500
- P 392[2] = 500
- P 392[3] = 500
- P 393[0] = Rated motor current
- P 393[1] = Rated motor current

# Mode 2

Parameters 792.1 and 792.2 are used as the measuring frequency and measuring amplitude (see step 2)

Recommendation:

- P 794[0] = 100 ms
- P 794[1] = 50% of rated motor current
- P 794[2] = 250 ms

Starting the expanded speed control circuit is not absolutely necessary, but will result in control with better dynamic performance. The circuit can be started by setting P 350[0] - SEL_ObserverMethod to a value of 4. P 339 - CON_SCON_Kalman can be used for tuning purposes. If necessary, adjust the noise covariance matrices and the filter time constants for the expanded speed control circuit (changes will take effect in real-time).

# Table 6.30: Configuring the Kalman filter for sensorless control (continue)

MOOG ID No.:CB40859-001 Date:11/2020

MSD ServoDrive - DeviceHelp 97

# 6 Encoder

# 6 Encoder

MOOG ID No.:CB40859-001 Date:11/2020

# 6.8.2.1 Activation of sensorless control for asynchronous motors

Proceed as follows:

|No.|Activity|
|---|---|
|1|Set motor type (P 450[0] - MOT_Type) to “2 (ASM) = asynchronous motor”.|
|2|Enter the motor name (P 451[0] - MOT_Name).|
|3|Copy the motor variables from the rating plate into the appropriate input box.|
|4|Start motor identification to identify other motor parameters. In the “Encoder selection” screen (see also section ""Encoder selection"" on page 53) under “Encoder for commutation and torque control,” set P 520[0] - ENC_MCon to “CH4(4) = virtual encoder (Channel 4)”.|
|5|Under “virtual encoder (Channel 4)” ""Encoder selection"" set (P 508[0] - ENC_CH4_Sel) to ""SFC(8) = take values of SFC model"".|
|6|In the “Basic Control Settings” screen (see section “Basic settings” on page 101) set “Speed filter TF” (P 351[0] - CON_SCALC_Tf) to 10 ms. In the “Asynchronous motor control settings identification” screen (see also section ""Asynchronous motor"" on page 38) enter the “Total moment of inertia” of the system (P 1516[0] - SCD_JSum). Enter a value that is too small rather than too big to avoid a tendency to oscillate. Automatic detection is not advisable due to the control dynamics and accuracy required.|
|7|In the same screen under “Control design by stiffness” set P 1515[0] - SCD_ConDesign (Stiffness) to 10%.|

# Table 6.31: Commissioning a sensorless-controlled asynchronous motor

|P No.|Index Name|Unit|Description|
|---|---|---|---|
|351|CON_SCALC_Tf| |Speed filter|
| |0|ms|Filter time const. speed control (motor)|
| |1|ms|Filter time const. ",What is the significance of setting P 350[0] to '4' in 'MSD ServoDrive - DeviceHelp'?,A5,"Setting P 350[0] to '4' engages the expanded speed control circuit, improving dynamic control with the Kalman filter.",1.0234375,1.171875,3.359375,1.46875,0.44140625
40,msd_servo_drive.txt,36,cd9a6c3d43aee09fd8ea49d961e129d8ce140335b4efd00b1c6c207c901b75b1,"Before being fed into the circuit, speeds n_kal and n_eps can each be smoothed with a filter (P 351[0] for n_eps and P 339[0] for n_kal). The expanded speed control circuit can be started with P 350[0] (“4” => Kalman).

The inductance difference is important when it comes to sensorless control, as the Kalman filter can determine the position based on the inductance difference in.

Image 6.10: Expanded speed controller layout

Measurements have shown that, when using the expanded control circuit, motors with a marked saliency can be operated in a sensorless manner even without a test signal.

# 6 Encoder

MOOG ID No.:CB40859-001 Date:11/2020

MSD ServoDrive - DeviceHelp 96

In combination with a test signal when the motor is stopped. In addition, the total moment of inertia resulting from the motor and the connected load must be set as accurately as possible.

The encoder communications will be used to calculate and pass the actual speed and actual position. Accordingly, in order to select the sensorless method, a value of 2 must be set for encoder channel 4 in the selector (P 508[0] - ENC_CH4_Sel = 2), and a value of 4 must be set for P 520[0] - ENC_MCon, P 521[0] - ENC_SCon and P 522[0] - ENC_PCon.

The Kalman filter needs to be configured further by following the steps below:

|Step|Action|
|---|---|
|1|Automatically configure noise covariance matrices Q and R by setting the control parameter for encoder channel 4 (P 783[0] - ENC-CH4-Ctrl) to a value of 6.|
| |Manually configure the test signal generator:|
| |Recommendation: Sinusoidal test signal in d axis|
| |P 792[09] = 1|
| |P 792[19] = 500 Hz|
| |P 792[2] = P 792[9] = 10% of rated motor current|
| |P 792[79] = 15% of rated motor speed|
| |P 792[89] = 5% of rated motor speed|
| |P 792[9] = 30% of rated motor current|
| |Set the other values to 0|
|2|Or set the control parameter for encoder channel 4 (P 783[0] - ENC-CH4-Ctrl) to a value of 3, which will trigger a general initialization routine in which steps 1 and 2, as well as encoder initialization, will be automatically carried out based on the motor parameters.|

# Table 6.30: Configuring the Kalman filter for sensorless control

# Step

# Action

In order to make the encoderless control commissioning process easier, a function used to calculate the position difference between encoderless control and a real encoder can be activated. To use this function, the encoder channel that will be used for the comparison must be selected in P 797[0] - ENC_CH4_Kalman_Compare.

As described in Section ""Auto commutation"" on page 92 or Recommendation:

- P 390[0] = 1
- P 392[0] = 500
- P 392[1] = 500
- P 392[2] = 500
- P 392[3] = 500
- P 393[0] = Rated motor current
- P 393[1] = Rated motor current

# Mode 2

Parameters 792.1 and 792.2 are used as the measuring frequency and measuring amplitude (see step 2)

Recommendation:

- P 794[0] = 100 ms
- P 794[1] = 50% of rated motor current
- P 794[2] = 250 ms

Starting the expanded speed control circuit is not absolutely necessary, but will result in control with better dynamic performance. The circuit can be started by setting P 350[0] - SEL_ObserverMethod to a value of 4. P 339 - CON_SCON_Kalman can be used for tuning purposes. If necessary, adjust the noise covariance matrices and the filter time constants for the expanded speed control circuit (changes will take effect in real-time).

# Table 6.30: Configuring the Kalman filter for sensorless control (continue)

MOOG ID No.:CB40859-001 Date:11/2020

MSD ServoDrive - DeviceHelp 97

# 6 Encoder

# 6 Encoder

MOOG ID No.:CB40859-001 Date:11/2020

# 6.8.2.1 Activation of sensorless control for asynchronous motors

Proceed as follows:

|No.|Activity|
|---|---|
|1|Set motor type (P 450[0] - MOT_Type) to “2 (ASM) = asynchronous motor”.|
|2|Enter the motor name (P 451[0] - MOT_Name).|
|3|Copy the motor variables from the rating plate into the appropriate input box.|
|4|Start motor identification to identify other motor parameters. In the “Encoder selection” screen (see also section ""Encoder selection"" on page 53) under “Encoder for commutation and torque control,” set P 520[0] - ENC_MCon to “CH4(4) = virtual encoder (Channel 4)”.|
|5|Under “virtual encoder (Channel 4)” ""Encoder selection"" set (P 508[0] - ENC_CH4_Sel) to ""SFC(8) = take values of SFC model"".|
|6|In the “Basic Control Settings” screen (see section “Basic settings” on page 101) set “Speed filter TF” (P 351[0] - CON_SCALC_Tf) to 10 ms. In the “Asynchronous motor control settings identification” screen (see also section ""Asynchronous motor"" on page 38) enter the “Total moment of inertia” of the system (P 1516[0] - SCD_JSum). Enter a value that is too small rather than too big to avoid a tendency to oscillate. Automatic detection is not advisable due to the control dynamics and accuracy required.|
|7|In the same screen under “Control design by stiffness” set P 1515[0] - SCD_ConDesign (Stiffness) to 10%.|

# Table 6.31: Commissioning a sensorless-controlled asynchronous motor

|P No.|Index Name|Unit|Description|
|---|---|---|---|
|351|CON_SCALC_Tf| |Speed filter|
| |0|ms|Filter time const. speed control (motor)|
| |1|ms|Filter time const. ",What must be set accurately for sensorless operation of motors with marked saliency in 'MSD ServoDrive - DeviceHelp'?,A1,The total moment of inertia from the motor and connected load.,1.71875,1.6875,3.40625,1.1484375,0.22265625
41,msd_servo_drive.txt,36,cd9a6c3d43aee09fd8ea49d961e129d8ce140335b4efd00b1c6c207c901b75b1,"Before being fed into the circuit, speeds n_kal and n_eps can each be smoothed with a filter (P 351[0] for n_eps and P 339[0] for n_kal). The expanded speed control circuit can be started with P 350[0] (“4” => Kalman).

The inductance difference is important when it comes to sensorless control, as the Kalman filter can determine the position based on the inductance difference in.

Image 6.10: Expanded speed controller layout

Measurements have shown that, when using the expanded control circuit, motors with a marked saliency can be operated in a sensorless manner even without a test signal.

# 6 Encoder

MOOG ID No.:CB40859-001 Date:11/2020

MSD ServoDrive - DeviceHelp 96

In combination with a test signal when the motor is stopped. In addition, the total moment of inertia resulting from the motor and the connected load must be set as accurately as possible.

The encoder communications will be used to calculate and pass the actual speed and actual position. Accordingly, in order to select the sensorless method, a value of 2 must be set for encoder channel 4 in the selector (P 508[0] - ENC_CH4_Sel = 2), and a value of 4 must be set for P 520[0] - ENC_MCon, P 521[0] - ENC_SCon and P 522[0] - ENC_PCon.

The Kalman filter needs to be configured further by following the steps below:

|Step|Action|
|---|---|
|1|Automatically configure noise covariance matrices Q and R by setting the control parameter for encoder channel 4 (P 783[0] - ENC-CH4-Ctrl) to a value of 6.|
| |Manually configure the test signal generator:|
| |Recommendation: Sinusoidal test signal in d axis|
| |P 792[09] = 1|
| |P 792[19] = 500 Hz|
| |P 792[2] = P 792[9] = 10% of rated motor current|
| |P 792[79] = 15% of rated motor speed|
| |P 792[89] = 5% of rated motor speed|
| |P 792[9] = 30% of rated motor current|
| |Set the other values to 0|
|2|Or set the control parameter for encoder channel 4 (P 783[0] - ENC-CH4-Ctrl) to a value of 3, which will trigger a general initialization routine in which steps 1 and 2, as well as encoder initialization, will be automatically carried out based on the motor parameters.|

# Table 6.30: Configuring the Kalman filter for sensorless control

# Step

# Action

In order to make the encoderless control commissioning process easier, a function used to calculate the position difference between encoderless control and a real encoder can be activated. To use this function, the encoder channel that will be used for the comparison must be selected in P 797[0] - ENC_CH4_Kalman_Compare.

As described in Section ""Auto commutation"" on page 92 or Recommendation:

- P 390[0] = 1
- P 392[0] = 500
- P 392[1] = 500
- P 392[2] = 500
- P 392[3] = 500
- P 393[0] = Rated motor current
- P 393[1] = Rated motor current

# Mode 2

Parameters 792.1 and 792.2 are used as the measuring frequency and measuring amplitude (see step 2)

Recommendation:

- P 794[0] = 100 ms
- P 794[1] = 50% of rated motor current
- P 794[2] = 250 ms

Starting the expanded speed control circuit is not absolutely necessary, but will result in control with better dynamic performance. The circuit can be started by setting P 350[0] - SEL_ObserverMethod to a value of 4. P 339 - CON_SCON_Kalman can be used for tuning purposes. If necessary, adjust the noise covariance matrices and the filter time constants for the expanded speed control circuit (changes will take effect in real-time).

# Table 6.30: Configuring the Kalman filter for sensorless control (continue)

MOOG ID No.:CB40859-001 Date:11/2020

MSD ServoDrive - DeviceHelp 97

# 6 Encoder

# 6 Encoder

MOOG ID No.:CB40859-001 Date:11/2020

# 6.8.2.1 Activation of sensorless control for asynchronous motors

Proceed as follows:

|No.|Activity|
|---|---|
|1|Set motor type (P 450[0] - MOT_Type) to “2 (ASM) = asynchronous motor”.|
|2|Enter the motor name (P 451[0] - MOT_Name).|
|3|Copy the motor variables from the rating plate into the appropriate input box.|
|4|Start motor identification to identify other motor parameters. In the “Encoder selection” screen (see also section ""Encoder selection"" on page 53) under “Encoder for commutation and torque control,” set P 520[0] - ENC_MCon to “CH4(4) = virtual encoder (Channel 4)”.|
|5|Under “virtual encoder (Channel 4)” ""Encoder selection"" set (P 508[0] - ENC_CH4_Sel) to ""SFC(8) = take values of SFC model"".|
|6|In the “Basic Control Settings” screen (see section “Basic settings” on page 101) set “Speed filter TF” (P 351[0] - CON_SCALC_Tf) to 10 ms. In the “Asynchronous motor control settings identification” screen (see also section ""Asynchronous motor"" on page 38) enter the “Total moment of inertia” of the system (P 1516[0] - SCD_JSum). Enter a value that is too small rather than too big to avoid a tendency to oscillate. Automatic detection is not advisable due to the control dynamics and accuracy required.|
|7|In the same screen under “Control design by stiffness” set P 1515[0] - SCD_ConDesign (Stiffness) to 10%.|

# Table 6.31: Commissioning a sensorless-controlled asynchronous motor

|P No.|Index Name|Unit|Description|
|---|---|---|---|
|351|CON_SCALC_Tf| |Speed filter|
| |0|ms|Filter time const. speed control (motor)|
| |1|ms|Filter time const. ",What must be set accurately for sensorless operation of motors with marked saliency in 'MSD ServoDrive - DeviceHelp'?,A2,Accurate setting of the combined moment of inertia of the motor and its load is essential.,2.125,2.015625,3.5,1.2265625,0.337890625
42,msd_servo_drive.txt,36,cd9a6c3d43aee09fd8ea49d961e129d8ce140335b4efd00b1c6c207c901b75b1,"Before being fed into the circuit, speeds n_kal and n_eps can each be smoothed with a filter (P 351[0] for n_eps and P 339[0] for n_kal). The expanded speed control circuit can be started with P 350[0] (“4” => Kalman).

The inductance difference is important when it comes to sensorless control, as the Kalman filter can determine the position based on the inductance difference in.

Image 6.10: Expanded speed controller layout

Measurements have shown that, when using the expanded control circuit, motors with a marked saliency can be operated in a sensorless manner even without a test signal.

# 6 Encoder

MOOG ID No.:CB40859-001 Date:11/2020

MSD ServoDrive - DeviceHelp 96

In combination with a test signal when the motor is stopped. In addition, the total moment of inertia resulting from the motor and the connected load must be set as accurately as possible.

The encoder communications will be used to calculate and pass the actual speed and actual position. Accordingly, in order to select the sensorless method, a value of 2 must be set for encoder channel 4 in the selector (P 508[0] - ENC_CH4_Sel = 2), and a value of 4 must be set for P 520[0] - ENC_MCon, P 521[0] - ENC_SCon and P 522[0] - ENC_PCon.

The Kalman filter needs to be configured further by following the steps below:

|Step|Action|
|---|---|
|1|Automatically configure noise covariance matrices Q and R by setting the control parameter for encoder channel 4 (P 783[0] - ENC-CH4-Ctrl) to a value of 6.|
| |Manually configure the test signal generator:|
| |Recommendation: Sinusoidal test signal in d axis|
| |P 792[09] = 1|
| |P 792[19] = 500 Hz|
| |P 792[2] = P 792[9] = 10% of rated motor current|
| |P 792[79] = 15% of rated motor speed|
| |P 792[89] = 5% of rated motor speed|
| |P 792[9] = 30% of rated motor current|
| |Set the other values to 0|
|2|Or set the control parameter for encoder channel 4 (P 783[0] - ENC-CH4-Ctrl) to a value of 3, which will trigger a general initialization routine in which steps 1 and 2, as well as encoder initialization, will be automatically carried out based on the motor parameters.|

# Table 6.30: Configuring the Kalman filter for sensorless control

# Step

# Action

In order to make the encoderless control commissioning process easier, a function used to calculate the position difference between encoderless control and a real encoder can be activated. To use this function, the encoder channel that will be used for the comparison must be selected in P 797[0] - ENC_CH4_Kalman_Compare.

As described in Section ""Auto commutation"" on page 92 or Recommendation:

- P 390[0] = 1
- P 392[0] = 500
- P 392[1] = 500
- P 392[2] = 500
- P 392[3] = 500
- P 393[0] = Rated motor current
- P 393[1] = Rated motor current

# Mode 2

Parameters 792.1 and 792.2 are used as the measuring frequency and measuring amplitude (see step 2)

Recommendation:

- P 794[0] = 100 ms
- P 794[1] = 50% of rated motor current
- P 794[2] = 250 ms

Starting the expanded speed control circuit is not absolutely necessary, but will result in control with better dynamic performance. The circuit can be started by setting P 350[0] - SEL_ObserverMethod to a value of 4. P 339 - CON_SCON_Kalman can be used for tuning purposes. If necessary, adjust the noise covariance matrices and the filter time constants for the expanded speed control circuit (changes will take effect in real-time).

# Table 6.30: Configuring the Kalman filter for sensorless control (continue)

MOOG ID No.:CB40859-001 Date:11/2020

MSD ServoDrive - DeviceHelp 97

# 6 Encoder

# 6 Encoder

MOOG ID No.:CB40859-001 Date:11/2020

# 6.8.2.1 Activation of sensorless control for asynchronous motors

Proceed as follows:

|No.|Activity|
|---|---|
|1|Set motor type (P 450[0] - MOT_Type) to “2 (ASM) = asynchronous motor”.|
|2|Enter the motor name (P 451[0] - MOT_Name).|
|3|Copy the motor variables from the rating plate into the appropriate input box.|
|4|Start motor identification to identify other motor parameters. In the “Encoder selection” screen (see also section ""Encoder selection"" on page 53) under “Encoder for commutation and torque control,” set P 520[0] - ENC_MCon to “CH4(4) = virtual encoder (Channel 4)”.|
|5|Under “virtual encoder (Channel 4)” ""Encoder selection"" set (P 508[0] - ENC_CH4_Sel) to ""SFC(8) = take values of SFC model"".|
|6|In the “Basic Control Settings” screen (see section “Basic settings” on page 101) set “Speed filter TF” (P 351[0] - CON_SCALC_Tf) to 10 ms. In the “Asynchronous motor control settings identification” screen (see also section ""Asynchronous motor"" on page 38) enter the “Total moment of inertia” of the system (P 1516[0] - SCD_JSum). Enter a value that is too small rather than too big to avoid a tendency to oscillate. Automatic detection is not advisable due to the control dynamics and accuracy required.|
|7|In the same screen under “Control design by stiffness” set P 1515[0] - SCD_ConDesign (Stiffness) to 10%.|

# Table 6.31: Commissioning a sensorless-controlled asynchronous motor

|P No.|Index Name|Unit|Description|
|---|---|---|---|
|351|CON_SCALC_Tf| |Speed filter|
| |0|ms|Filter time const. speed control (motor)|
| |1|ms|Filter time const. ",What must be set accurately for sensorless operation of motors with marked saliency in 'MSD ServoDrive - DeviceHelp'?,A3,"For optimal sensorless operation, the system's total moment of inertia must be precisely configured.",2.171875,2.25,3.5625,1.3984375,0.310546875
43,msd_servo_drive.txt,36,cd9a6c3d43aee09fd8ea49d961e129d8ce140335b4efd00b1c6c207c901b75b1,"Before being fed into the circuit, speeds n_kal and n_eps can each be smoothed with a filter (P 351[0] for n_eps and P 339[0] for n_kal). The expanded speed control circuit can be started with P 350[0] (“4” => Kalman).

The inductance difference is important when it comes to sensorless control, as the Kalman filter can determine the position based on the inductance difference in.

Image 6.10: Expanded speed controller layout

Measurements have shown that, when using the expanded control circuit, motors with a marked saliency can be operated in a sensorless manner even without a test signal.

# 6 Encoder

MOOG ID No.:CB40859-001 Date:11/2020

MSD ServoDrive - DeviceHelp 96

In combination with a test signal when the motor is stopped. In addition, the total moment of inertia resulting from the motor and the connected load must be set as accurately as possible.

The encoder communications will be used to calculate and pass the actual speed and actual position. Accordingly, in order to select the sensorless method, a value of 2 must be set for encoder channel 4 in the selector (P 508[0] - ENC_CH4_Sel = 2), and a value of 4 must be set for P 520[0] - ENC_MCon, P 521[0] - ENC_SCon and P 522[0] - ENC_PCon.

The Kalman filter needs to be configured further by following the steps below:

|Step|Action|
|---|---|
|1|Automatically configure noise covariance matrices Q and R by setting the control parameter for encoder channel 4 (P 783[0] - ENC-CH4-Ctrl) to a value of 6.|
| |Manually configure the test signal generator:|
| |Recommendation: Sinusoidal test signal in d axis|
| |P 792[09] = 1|
| |P 792[19] = 500 Hz|
| |P 792[2] = P 792[9] = 10% of rated motor current|
| |P 792[79] = 15% of rated motor speed|
| |P 792[89] = 5% of rated motor speed|
| |P 792[9] = 30% of rated motor current|
| |Set the other values to 0|
|2|Or set the control parameter for encoder channel 4 (P 783[0] - ENC-CH4-Ctrl) to a value of 3, which will trigger a general initialization routine in which steps 1 and 2, as well as encoder initialization, will be automatically carried out based on the motor parameters.|

# Table 6.30: Configuring the Kalman filter for sensorless control

# Step

# Action

In order to make the encoderless control commissioning process easier, a function used to calculate the position difference between encoderless control and a real encoder can be activated. To use this function, the encoder channel that will be used for the comparison must be selected in P 797[0] - ENC_CH4_Kalman_Compare.

As described in Section ""Auto commutation"" on page 92 or Recommendation:

- P 390[0] = 1
- P 392[0] = 500
- P 392[1] = 500
- P 392[2] = 500
- P 392[3] = 500
- P 393[0] = Rated motor current
- P 393[1] = Rated motor current

# Mode 2

Parameters 792.1 and 792.2 are used as the measuring frequency and measuring amplitude (see step 2)

Recommendation:

- P 794[0] = 100 ms
- P 794[1] = 50% of rated motor current
- P 794[2] = 250 ms

Starting the expanded speed control circuit is not absolutely necessary, but will result in control with better dynamic performance. The circuit can be started by setting P 350[0] - SEL_ObserverMethod to a value of 4. P 339 - CON_SCON_Kalman can be used for tuning purposes. If necessary, adjust the noise covariance matrices and the filter time constants for the expanded speed control circuit (changes will take effect in real-time).

# Table 6.30: Configuring the Kalman filter for sensorless control (continue)

MOOG ID No.:CB40859-001 Date:11/2020

MSD ServoDrive - DeviceHelp 97

# 6 Encoder

# 6 Encoder

MOOG ID No.:CB40859-001 Date:11/2020

# 6.8.2.1 Activation of sensorless control for asynchronous motors

Proceed as follows:

|No.|Activity|
|---|---|
|1|Set motor type (P 450[0] - MOT_Type) to “2 (ASM) = asynchronous motor”.|
|2|Enter the motor name (P 451[0] - MOT_Name).|
|3|Copy the motor variables from the rating plate into the appropriate input box.|
|4|Start motor identification to identify other motor parameters. In the “Encoder selection” screen (see also section ""Encoder selection"" on page 53) under “Encoder for commutation and torque control,” set P 520[0] - ENC_MCon to “CH4(4) = virtual encoder (Channel 4)”.|
|5|Under “virtual encoder (Channel 4)” ""Encoder selection"" set (P 508[0] - ENC_CH4_Sel) to ""SFC(8) = take values of SFC model"".|
|6|In the “Basic Control Settings” screen (see section “Basic settings” on page 101) set “Speed filter TF” (P 351[0] - CON_SCALC_Tf) to 10 ms. In the “Asynchronous motor control settings identification” screen (see also section ""Asynchronous motor"" on page 38) enter the “Total moment of inertia” of the system (P 1516[0] - SCD_JSum). Enter a value that is too small rather than too big to avoid a tendency to oscillate. Automatic detection is not advisable due to the control dynamics and accuracy required.|
|7|In the same screen under “Control design by stiffness” set P 1515[0] - SCD_ConDesign (Stiffness) to 10%.|

# Table 6.31: Commissioning a sensorless-controlled asynchronous motor

|P No.|Index Name|Unit|Description|
|---|---|---|---|
|351|CON_SCALC_Tf| |Speed filter|
| |0|ms|Filter time const. speed control (motor)|
| |1|ms|Filter time const. ",What must be set accurately for sensorless operation of motors with marked saliency in 'MSD ServoDrive - DeviceHelp'?,A4,The key requirement is the accurate determination of the total moment of inertia affecting the motor.,2.015625,2.03125,3.578125,1.359375,0.359375
44,msd_servo_drive.txt,36,cd9a6c3d43aee09fd8ea49d961e129d8ce140335b4efd00b1c6c207c901b75b1,"Before being fed into the circuit, speeds n_kal and n_eps can each be smoothed with a filter (P 351[0] for n_eps and P 339[0] for n_kal). The expanded speed control circuit can be started with P 350[0] (“4” => Kalman).

The inductance difference is important when it comes to sensorless control, as the Kalman filter can determine the position based on the inductance difference in.

Image 6.10: Expanded speed controller layout

Measurements have shown that, when using the expanded control circuit, motors with a marked saliency can be operated in a sensorless manner even without a test signal.

# 6 Encoder

MOOG ID No.:CB40859-001 Date:11/2020

MSD ServoDrive - DeviceHelp 96

In combination with a test signal when the motor is stopped. In addition, the total moment of inertia resulting from the motor and the connected load must be set as accurately as possible.

The encoder communications will be used to calculate and pass the actual speed and actual position. Accordingly, in order to select the sensorless method, a value of 2 must be set for encoder channel 4 in the selector (P 508[0] - ENC_CH4_Sel = 2), and a value of 4 must be set for P 520[0] - ENC_MCon, P 521[0] - ENC_SCon and P 522[0] - ENC_PCon.

The Kalman filter needs to be configured further by following the steps below:

|Step|Action|
|---|---|
|1|Automatically configure noise covariance matrices Q and R by setting the control parameter for encoder channel 4 (P 783[0] - ENC-CH4-Ctrl) to a value of 6.|
| |Manually configure the test signal generator:|
| |Recommendation: Sinusoidal test signal in d axis|
| |P 792[09] = 1|
| |P 792[19] = 500 Hz|
| |P 792[2] = P 792[9] = 10% of rated motor current|
| |P 792[79] = 15% of rated motor speed|
| |P 792[89] = 5% of rated motor speed|
| |P 792[9] = 30% of rated motor current|
| |Set the other values to 0|
|2|Or set the control parameter for encoder channel 4 (P 783[0] - ENC-CH4-Ctrl) to a value of 3, which will trigger a general initialization routine in which steps 1 and 2, as well as encoder initialization, will be automatically carried out based on the motor parameters.|

# Table 6.30: Configuring the Kalman filter for sensorless control

# Step

# Action

In order to make the encoderless control commissioning process easier, a function used to calculate the position difference between encoderless control and a real encoder can be activated. To use this function, the encoder channel that will be used for the comparison must be selected in P 797[0] - ENC_CH4_Kalman_Compare.

As described in Section ""Auto commutation"" on page 92 or Recommendation:

- P 390[0] = 1
- P 392[0] = 500
- P 392[1] = 500
- P 392[2] = 500
- P 392[3] = 500
- P 393[0] = Rated motor current
- P 393[1] = Rated motor current

# Mode 2

Parameters 792.1 and 792.2 are used as the measuring frequency and measuring amplitude (see step 2)

Recommendation:

- P 794[0] = 100 ms
- P 794[1] = 50% of rated motor current
- P 794[2] = 250 ms

Starting the expanded speed control circuit is not absolutely necessary, but will result in control with better dynamic performance. The circuit can be started by setting P 350[0] - SEL_ObserverMethod to a value of 4. P 339 - CON_SCON_Kalman can be used for tuning purposes. If necessary, adjust the noise covariance matrices and the filter time constants for the expanded speed control circuit (changes will take effect in real-time).

# Table 6.30: Configuring the Kalman filter for sensorless control (continue)

MOOG ID No.:CB40859-001 Date:11/2020

MSD ServoDrive - DeviceHelp 97

# 6 Encoder

# 6 Encoder

MOOG ID No.:CB40859-001 Date:11/2020

# 6.8.2.1 Activation of sensorless control for asynchronous motors

Proceed as follows:

|No.|Activity|
|---|---|
|1|Set motor type (P 450[0] - MOT_Type) to “2 (ASM) = asynchronous motor”.|
|2|Enter the motor name (P 451[0] - MOT_Name).|
|3|Copy the motor variables from the rating plate into the appropriate input box.|
|4|Start motor identification to identify other motor parameters. In the “Encoder selection” screen (see also section ""Encoder selection"" on page 53) under “Encoder for commutation and torque control,” set P 520[0] - ENC_MCon to “CH4(4) = virtual encoder (Channel 4)”.|
|5|Under “virtual encoder (Channel 4)” ""Encoder selection"" set (P 508[0] - ENC_CH4_Sel) to ""SFC(8) = take values of SFC model"".|
|6|In the “Basic Control Settings” screen (see section “Basic settings” on page 101) set “Speed filter TF” (P 351[0] - CON_SCALC_Tf) to 10 ms. In the “Asynchronous motor control settings identification” screen (see also section ""Asynchronous motor"" on page 38) enter the “Total moment of inertia” of the system (P 1516[0] - SCD_JSum). Enter a value that is too small rather than too big to avoid a tendency to oscillate. Automatic detection is not advisable due to the control dynamics and accuracy required.|
|7|In the same screen under “Control design by stiffness” set P 1515[0] - SCD_ConDesign (Stiffness) to 10%.|

# Table 6.31: Commissioning a sensorless-controlled asynchronous motor

|P No.|Index Name|Unit|Description|
|---|---|---|---|
|351|CON_SCALC_Tf| |Speed filter|
| |0|ms|Filter time const. speed control (motor)|
| |1|ms|Filter time const. ",What must be set accurately for sensorless operation of motors with marked saliency in 'MSD ServoDrive - DeviceHelp'?,A5,Precise adjustment of the motor and load's combined moment of inertia is necessary for effective sensorless control.,1.5390625,1.4921875,3.3125,1.3203125,0.373046875
45,msd_servo_drive.txt,36,cd9a6c3d43aee09fd8ea49d961e129d8ce140335b4efd00b1c6c207c901b75b1,"Before being fed into the circuit, speeds n_kal and n_eps can each be smoothed with a filter (P 351[0] for n_eps and P 339[0] for n_kal). The expanded speed control circuit can be started with P 350[0] (“4” => Kalman).

The inductance difference is important when it comes to sensorless control, as the Kalman filter can determine the position based on the inductance difference in.

Image 6.10: Expanded speed controller layout

Measurements have shown that, when using the expanded control circuit, motors with a marked saliency can be operated in a sensorless manner even without a test signal.

# 6 Encoder

MOOG ID No.:CB40859-001 Date:11/2020

MSD ServoDrive - DeviceHelp 96

In combination with a test signal when the motor is stopped. In addition, the total moment of inertia resulting from the motor and the connected load must be set as accurately as possible.

The encoder communications will be used to calculate and pass the actual speed and actual position. Accordingly, in order to select the sensorless method, a value of 2 must be set for encoder channel 4 in the selector (P 508[0] - ENC_CH4_Sel = 2), and a value of 4 must be set for P 520[0] - ENC_MCon, P 521[0] - ENC_SCon and P 522[0] - ENC_PCon.

The Kalman filter needs to be configured further by following the steps below:

|Step|Action|
|---|---|
|1|Automatically configure noise covariance matrices Q and R by setting the control parameter for encoder channel 4 (P 783[0] - ENC-CH4-Ctrl) to a value of 6.|
| |Manually configure the test signal generator:|
| |Recommendation: Sinusoidal test signal in d axis|
| |P 792[09] = 1|
| |P 792[19] = 500 Hz|
| |P 792[2] = P 792[9] = 10% of rated motor current|
| |P 792[79] = 15% of rated motor speed|
| |P 792[89] = 5% of rated motor speed|
| |P 792[9] = 30% of rated motor current|
| |Set the other values to 0|
|2|Or set the control parameter for encoder channel 4 (P 783[0] - ENC-CH4-Ctrl) to a value of 3, which will trigger a general initialization routine in which steps 1 and 2, as well as encoder initialization, will be automatically carried out based on the motor parameters.|

# Table 6.30: Configuring the Kalman filter for sensorless control

# Step

# Action

In order to make the encoderless control commissioning process easier, a function used to calculate the position difference between encoderless control and a real encoder can be activated. To use this function, the encoder channel that will be used for the comparison must be selected in P 797[0] - ENC_CH4_Kalman_Compare.

As described in Section ""Auto commutation"" on page 92 or Recommendation:

- P 390[0] = 1
- P 392[0] = 500
- P 392[1] = 500
- P 392[2] = 500
- P 392[3] = 500
- P 393[0] = Rated motor current
- P 393[1] = Rated motor current

# Mode 2

Parameters 792.1 and 792.2 are used as the measuring frequency and measuring amplitude (see step 2)

Recommendation:

- P 794[0] = 100 ms
- P 794[1] = 50% of rated motor current
- P 794[2] = 250 ms

Starting the expanded speed control circuit is not absolutely necessary, but will result in control with better dynamic performance. The circuit can be started by setting P 350[0] - SEL_ObserverMethod to a value of 4. P 339 - CON_SCON_Kalman can be used for tuning purposes. If necessary, adjust the noise covariance matrices and the filter time constants for the expanded speed control circuit (changes will take effect in real-time).

# Table 6.30: Configuring the Kalman filter for sensorless control (continue)

MOOG ID No.:CB40859-001 Date:11/2020

MSD ServoDrive - DeviceHelp 97

# 6 Encoder

# 6 Encoder

MOOG ID No.:CB40859-001 Date:11/2020

# 6.8.2.1 Activation of sensorless control for asynchronous motors

Proceed as follows:

|No.|Activity|
|---|---|
|1|Set motor type (P 450[0] - MOT_Type) to “2 (ASM) = asynchronous motor”.|
|2|Enter the motor name (P 451[0] - MOT_Name).|
|3|Copy the motor variables from the rating plate into the appropriate input box.|
|4|Start motor identification to identify other motor parameters. In the “Encoder selection” screen (see also section ""Encoder selection"" on page 53) under “Encoder for commutation and torque control,” set P 520[0] - ENC_MCon to “CH4(4) = virtual encoder (Channel 4)”.|
|5|Under “virtual encoder (Channel 4)” ""Encoder selection"" set (P 508[0] - ENC_CH4_Sel) to ""SFC(8) = take values of SFC model"".|
|6|In the “Basic Control Settings” screen (see section “Basic settings” on page 101) set “Speed filter TF” (P 351[0] - CON_SCALC_Tf) to 10 ms. In the “Asynchronous motor control settings identification” screen (see also section ""Asynchronous motor"" on page 38) enter the “Total moment of inertia” of the system (P 1516[0] - SCD_JSum). Enter a value that is too small rather than too big to avoid a tendency to oscillate. Automatic detection is not advisable due to the control dynamics and accuracy required.|
|7|In the same screen under “Control design by stiffness” set P 1515[0] - SCD_ConDesign (Stiffness) to 10%.|

# Table 6.31: Commissioning a sensorless-controlled asynchronous motor

|P No.|Index Name|Unit|Description|
|---|---|---|---|
|351|CON_SCALC_Tf| |Speed filter|
| |0|ms|Filter time const. speed control (motor)|
| |1|ms|Filter time const. ",What role does the inductance difference play in sensorless control as described in 'MSD ServoDrive - DeviceHelp'?,A1,It allows the Kalman filter to determine the motor's position.,1.96875,2.21875,3.671875,1.2421875,0.28515625
46,msd_servo_drive.txt,36,cd9a6c3d43aee09fd8ea49d961e129d8ce140335b4efd00b1c6c207c901b75b1,"Before being fed into the circuit, speeds n_kal and n_eps can each be smoothed with a filter (P 351[0] for n_eps and P 339[0] for n_kal). The expanded speed control circuit can be started with P 350[0] (“4” => Kalman).

The inductance difference is important when it comes to sensorless control, as the Kalman filter can determine the position based on the inductance difference in.

Image 6.10: Expanded speed controller layout

Measurements have shown that, when using the expanded control circuit, motors with a marked saliency can be operated in a sensorless manner even without a test signal.

# 6 Encoder

MOOG ID No.:CB40859-001 Date:11/2020

MSD ServoDrive - DeviceHelp 96

In combination with a test signal when the motor is stopped. In addition, the total moment of inertia resulting from the motor and the connected load must be set as accurately as possible.

The encoder communications will be used to calculate and pass the actual speed and actual position. Accordingly, in order to select the sensorless method, a value of 2 must be set for encoder channel 4 in the selector (P 508[0] - ENC_CH4_Sel = 2), and a value of 4 must be set for P 520[0] - ENC_MCon, P 521[0] - ENC_SCon and P 522[0] - ENC_PCon.

The Kalman filter needs to be configured further by following the steps below:

|Step|Action|
|---|---|
|1|Automatically configure noise covariance matrices Q and R by setting the control parameter for encoder channel 4 (P 783[0] - ENC-CH4-Ctrl) to a value of 6.|
| |Manually configure the test signal generator:|
| |Recommendation: Sinusoidal test signal in d axis|
| |P 792[09] = 1|
| |P 792[19] = 500 Hz|
| |P 792[2] = P 792[9] = 10% of rated motor current|
| |P 792[79] = 15% of rated motor speed|
| |P 792[89] = 5% of rated motor speed|
| |P 792[9] = 30% of rated motor current|
| |Set the other values to 0|
|2|Or set the control parameter for encoder channel 4 (P 783[0] - ENC-CH4-Ctrl) to a value of 3, which will trigger a general initialization routine in which steps 1 and 2, as well as encoder initialization, will be automatically carried out based on the motor parameters.|

# Table 6.30: Configuring the Kalman filter for sensorless control

# Step

# Action

In order to make the encoderless control commissioning process easier, a function used to calculate the position difference between encoderless control and a real encoder can be activated. To use this function, the encoder channel that will be used for the comparison must be selected in P 797[0] - ENC_CH4_Kalman_Compare.

As described in Section ""Auto commutation"" on page 92 or Recommendation:

- P 390[0] = 1
- P 392[0] = 500
- P 392[1] = 500
- P 392[2] = 500
- P 392[3] = 500
- P 393[0] = Rated motor current
- P 393[1] = Rated motor current

# Mode 2

Parameters 792.1 and 792.2 are used as the measuring frequency and measuring amplitude (see step 2)

Recommendation:

- P 794[0] = 100 ms
- P 794[1] = 50% of rated motor current
- P 794[2] = 250 ms

Starting the expanded speed control circuit is not absolutely necessary, but will result in control with better dynamic performance. The circuit can be started by setting P 350[0] - SEL_ObserverMethod to a value of 4. P 339 - CON_SCON_Kalman can be used for tuning purposes. If necessary, adjust the noise covariance matrices and the filter time constants for the expanded speed control circuit (changes will take effect in real-time).

# Table 6.30: Configuring the Kalman filter for sensorless control (continue)

MOOG ID No.:CB40859-001 Date:11/2020

MSD ServoDrive - DeviceHelp 97

# 6 Encoder

# 6 Encoder

MOOG ID No.:CB40859-001 Date:11/2020

# 6.8.2.1 Activation of sensorless control for asynchronous motors

Proceed as follows:

|No.|Activity|
|---|---|
|1|Set motor type (P 450[0] - MOT_Type) to “2 (ASM) = asynchronous motor”.|
|2|Enter the motor name (P 451[0] - MOT_Name).|
|3|Copy the motor variables from the rating plate into the appropriate input box.|
|4|Start motor identification to identify other motor parameters. In the “Encoder selection” screen (see also section ""Encoder selection"" on page 53) under “Encoder for commutation and torque control,” set P 520[0] - ENC_MCon to “CH4(4) = virtual encoder (Channel 4)”.|
|5|Under “virtual encoder (Channel 4)” ""Encoder selection"" set (P 508[0] - ENC_CH4_Sel) to ""SFC(8) = take values of SFC model"".|
|6|In the “Basic Control Settings” screen (see section “Basic settings” on page 101) set “Speed filter TF” (P 351[0] - CON_SCALC_Tf) to 10 ms. In the “Asynchronous motor control settings identification” screen (see also section ""Asynchronous motor"" on page 38) enter the “Total moment of inertia” of the system (P 1516[0] - SCD_JSum). Enter a value that is too small rather than too big to avoid a tendency to oscillate. Automatic detection is not advisable due to the control dynamics and accuracy required.|
|7|In the same screen under “Control design by stiffness” set P 1515[0] - SCD_ConDesign (Stiffness) to 10%.|

# Table 6.31: Commissioning a sensorless-controlled asynchronous motor

|P No.|Index Name|Unit|Description|
|---|---|---|---|
|351|CON_SCALC_Tf| |Speed filter|
| |0|ms|Filter time const. speed control (motor)|
| |1|ms|Filter time const. ",What role does the inductance difference play in sensorless control as described in 'MSD ServoDrive - DeviceHelp'?,A2,The inductance difference is crucial for the Kalman filter to estimate position without physical sensors.,2.25,2.265625,3.609375,1.34375,0.30078125
47,msd_servo_drive.txt,36,cd9a6c3d43aee09fd8ea49d961e129d8ce140335b4efd00b1c6c207c901b75b1,"Before being fed into the circuit, speeds n_kal and n_eps can each be smoothed with a filter (P 351[0] for n_eps and P 339[0] for n_kal). The expanded speed control circuit can be started with P 350[0] (“4” => Kalman).

The inductance difference is important when it comes to sensorless control, as the Kalman filter can determine the position based on the inductance difference in.

Image 6.10: Expanded speed controller layout

Measurements have shown that, when using the expanded control circuit, motors with a marked saliency can be operated in a sensorless manner even without a test signal.

# 6 Encoder

MOOG ID No.:CB40859-001 Date:11/2020

MSD ServoDrive - DeviceHelp 96

In combination with a test signal when the motor is stopped. In addition, the total moment of inertia resulting from the motor and the connected load must be set as accurately as possible.

The encoder communications will be used to calculate and pass the actual speed and actual position. Accordingly, in order to select the sensorless method, a value of 2 must be set for encoder channel 4 in the selector (P 508[0] - ENC_CH4_Sel = 2), and a value of 4 must be set for P 520[0] - ENC_MCon, P 521[0] - ENC_SCon and P 522[0] - ENC_PCon.

The Kalman filter needs to be configured further by following the steps below:

|Step|Action|
|---|---|
|1|Automatically configure noise covariance matrices Q and R by setting the control parameter for encoder channel 4 (P 783[0] - ENC-CH4-Ctrl) to a value of 6.|
| |Manually configure the test signal generator:|
| |Recommendation: Sinusoidal test signal in d axis|
| |P 792[09] = 1|
| |P 792[19] = 500 Hz|
| |P 792[2] = P 792[9] = 10% of rated motor current|
| |P 792[79] = 15% of rated motor speed|
| |P 792[89] = 5% of rated motor speed|
| |P 792[9] = 30% of rated motor current|
| |Set the other values to 0|
|2|Or set the control parameter for encoder channel 4 (P 783[0] - ENC-CH4-Ctrl) to a value of 3, which will trigger a general initialization routine in which steps 1 and 2, as well as encoder initialization, will be automatically carried out based on the motor parameters.|

# Table 6.30: Configuring the Kalman filter for sensorless control

# Step

# Action

In order to make the encoderless control commissioning process easier, a function used to calculate the position difference between encoderless control and a real encoder can be activated. To use this function, the encoder channel that will be used for the comparison must be selected in P 797[0] - ENC_CH4_Kalman_Compare.

As described in Section ""Auto commutation"" on page 92 or Recommendation:

- P 390[0] = 1
- P 392[0] = 500
- P 392[1] = 500
- P 392[2] = 500
- P 392[3] = 500
- P 393[0] = Rated motor current
- P 393[1] = Rated motor current

# Mode 2

Parameters 792.1 and 792.2 are used as the measuring frequency and measuring amplitude (see step 2)

Recommendation:

- P 794[0] = 100 ms
- P 794[1] = 50% of rated motor current
- P 794[2] = 250 ms

Starting the expanded speed control circuit is not absolutely necessary, but will result in control with better dynamic performance. The circuit can be started by setting P 350[0] - SEL_ObserverMethod to a value of 4. P 339 - CON_SCON_Kalman can be used for tuning purposes. If necessary, adjust the noise covariance matrices and the filter time constants for the expanded speed control circuit (changes will take effect in real-time).

# Table 6.30: Configuring the Kalman filter for sensorless control (continue)

MOOG ID No.:CB40859-001 Date:11/2020

MSD ServoDrive - DeviceHelp 97

# 6 Encoder

# 6 Encoder

MOOG ID No.:CB40859-001 Date:11/2020

# 6.8.2.1 Activation of sensorless control for asynchronous motors

Proceed as follows:

|No.|Activity|
|---|---|
|1|Set motor type (P 450[0] - MOT_Type) to “2 (ASM) = asynchronous motor”.|
|2|Enter the motor name (P 451[0] - MOT_Name).|
|3|Copy the motor variables from the rating plate into the appropriate input box.|
|4|Start motor identification to identify other motor parameters. In the “Encoder selection” screen (see also section ""Encoder selection"" on page 53) under “Encoder for commutation and torque control,” set P 520[0] - ENC_MCon to “CH4(4) = virtual encoder (Channel 4)”.|
|5|Under “virtual encoder (Channel 4)” ""Encoder selection"" set (P 508[0] - ENC_CH4_Sel) to ""SFC(8) = take values of SFC model"".|
|6|In the “Basic Control Settings” screen (see section “Basic settings” on page 101) set “Speed filter TF” (P 351[0] - CON_SCALC_Tf) to 10 ms. In the “Asynchronous motor control settings identification” screen (see also section ""Asynchronous motor"" on page 38) enter the “Total moment of inertia” of the system (P 1516[0] - SCD_JSum). Enter a value that is too small rather than too big to avoid a tendency to oscillate. Automatic detection is not advisable due to the control dynamics and accuracy required.|
|7|In the same screen under “Control design by stiffness” set P 1515[0] - SCD_ConDesign (Stiffness) to 10%.|

# Table 6.31: Commissioning a sensorless-controlled asynchronous motor

|P No.|Index Name|Unit|Description|
|---|---|---|---|
|351|CON_SCALC_Tf| |Speed filter|
| |0|ms|Filter time const. speed control (motor)|
| |1|ms|Filter time const. ",What role does the inductance difference play in sensorless control as described in 'MSD ServoDrive - DeviceHelp'?,A3,"By analyzing the inductance difference, the Kalman filter enables accurate position detection in sensorless control.",2.421875,2.421875,3.625,1.671875,0.49609375
48,msd_servo_drive.txt,36,cd9a6c3d43aee09fd8ea49d961e129d8ce140335b4efd00b1c6c207c901b75b1,"Before being fed into the circuit, speeds n_kal and n_eps can each be smoothed with a filter (P 351[0] for n_eps and P 339[0] for n_kal). The expanded speed control circuit can be started with P 350[0] (“4” => Kalman).

The inductance difference is important when it comes to sensorless control, as the Kalman filter can determine the position based on the inductance difference in.

Image 6.10: Expanded speed controller layout

Measurements have shown that, when using the expanded control circuit, motors with a marked saliency can be operated in a sensorless manner even without a test signal.

# 6 Encoder

MOOG ID No.:CB40859-001 Date:11/2020

MSD ServoDrive - DeviceHelp 96

In combination with a test signal when the motor is stopped. In addition, the total moment of inertia resulting from the motor and the connected load must be set as accurately as possible.

The encoder communications will be used to calculate and pass the actual speed and actual position. Accordingly, in order to select the sensorless method, a value of 2 must be set for encoder channel 4 in the selector (P 508[0] - ENC_CH4_Sel = 2), and a value of 4 must be set for P 520[0] - ENC_MCon, P 521[0] - ENC_SCon and P 522[0] - ENC_PCon.

The Kalman filter needs to be configured further by following the steps below:

|Step|Action|
|---|---|
|1|Automatically configure noise covariance matrices Q and R by setting the control parameter for encoder channel 4 (P 783[0] - ENC-CH4-Ctrl) to a value of 6.|
| |Manually configure the test signal generator:|
| |Recommendation: Sinusoidal test signal in d axis|
| |P 792[09] = 1|
| |P 792[19] = 500 Hz|
| |P 792[2] = P 792[9] = 10% of rated motor current|
| |P 792[79] = 15% of rated motor speed|
| |P 792[89] = 5% of rated motor speed|
| |P 792[9] = 30% of rated motor current|
| |Set the other values to 0|
|2|Or set the control parameter for encoder channel 4 (P 783[0] - ENC-CH4-Ctrl) to a value of 3, which will trigger a general initialization routine in which steps 1 and 2, as well as encoder initialization, will be automatically carried out based on the motor parameters.|

# Table 6.30: Configuring the Kalman filter for sensorless control

# Step

# Action

In order to make the encoderless control commissioning process easier, a function used to calculate the position difference between encoderless control and a real encoder can be activated. To use this function, the encoder channel that will be used for the comparison must be selected in P 797[0] - ENC_CH4_Kalman_Compare.

As described in Section ""Auto commutation"" on page 92 or Recommendation:

- P 390[0] = 1
- P 392[0] = 500
- P 392[1] = 500
- P 392[2] = 500
- P 392[3] = 500
- P 393[0] = Rated motor current
- P 393[1] = Rated motor current

# Mode 2

Parameters 792.1 and 792.2 are used as the measuring frequency and measuring amplitude (see step 2)

Recommendation:

- P 794[0] = 100 ms
- P 794[1] = 50% of rated motor current
- P 794[2] = 250 ms

Starting the expanded speed control circuit is not absolutely necessary, but will result in control with better dynamic performance. The circuit can be started by setting P 350[0] - SEL_ObserverMethod to a value of 4. P 339 - CON_SCON_Kalman can be used for tuning purposes. If necessary, adjust the noise covariance matrices and the filter time constants for the expanded speed control circuit (changes will take effect in real-time).

# Table 6.30: Configuring the Kalman filter for sensorless control (continue)

MOOG ID No.:CB40859-001 Date:11/2020

MSD ServoDrive - DeviceHelp 97

# 6 Encoder

# 6 Encoder

MOOG ID No.:CB40859-001 Date:11/2020

# 6.8.2.1 Activation of sensorless control for asynchronous motors

Proceed as follows:

|No.|Activity|
|---|---|
|1|Set motor type (P 450[0] - MOT_Type) to “2 (ASM) = asynchronous motor”.|
|2|Enter the motor name (P 451[0] - MOT_Name).|
|3|Copy the motor variables from the rating plate into the appropriate input box.|
|4|Start motor identification to identify other motor parameters. In the “Encoder selection” screen (see also section ""Encoder selection"" on page 53) under “Encoder for commutation and torque control,” set P 520[0] - ENC_MCon to “CH4(4) = virtual encoder (Channel 4)”.|
|5|Under “virtual encoder (Channel 4)” ""Encoder selection"" set (P 508[0] - ENC_CH4_Sel) to ""SFC(8) = take values of SFC model"".|
|6|In the “Basic Control Settings” screen (see section “Basic settings” on page 101) set “Speed filter TF” (P 351[0] - CON_SCALC_Tf) to 10 ms. In the “Asynchronous motor control settings identification” screen (see also section ""Asynchronous motor"" on page 38) enter the “Total moment of inertia” of the system (P 1516[0] - SCD_JSum). Enter a value that is too small rather than too big to avoid a tendency to oscillate. Automatic detection is not advisable due to the control dynamics and accuracy required.|
|7|In the same screen under “Control design by stiffness” set P 1515[0] - SCD_ConDesign (Stiffness) to 10%.|

# Table 6.31: Commissioning a sensorless-controlled asynchronous motor

|P No.|Index Name|Unit|Description|
|---|---|---|---|
|351|CON_SCALC_Tf| |Speed filter|
| |0|ms|Filter time const. speed control (motor)|
| |1|ms|Filter time const. ",What role does the inductance difference play in sensorless control as described in 'MSD ServoDrive - DeviceHelp'?,A4,Sensorless control relies on the inductance difference for the Kalman filter to compute the motor's position.,2.4375,2.5625,3.625,1.53125,0.353515625
49,msd_servo_drive.txt,36,cd9a6c3d43aee09fd8ea49d961e129d8ce140335b4efd00b1c6c207c901b75b1,"Before being fed into the circuit, speeds n_kal and n_eps can each be smoothed with a filter (P 351[0] for n_eps and P 339[0] for n_kal). The expanded speed control circuit can be started with P 350[0] (“4” => Kalman).

The inductance difference is important when it comes to sensorless control, as the Kalman filter can determine the position based on the inductance difference in.

Image 6.10: Expanded speed controller layout

Measurements have shown that, when using the expanded control circuit, motors with a marked saliency can be operated in a sensorless manner even without a test signal.

# 6 Encoder

MOOG ID No.:CB40859-001 Date:11/2020

MSD ServoDrive - DeviceHelp 96

In combination with a test signal when the motor is stopped. In addition, the total moment of inertia resulting from the motor and the connected load must be set as accurately as possible.

The encoder communications will be used to calculate and pass the actual speed and actual position. Accordingly, in order to select the sensorless method, a value of 2 must be set for encoder channel 4 in the selector (P 508[0] - ENC_CH4_Sel = 2), and a value of 4 must be set for P 520[0] - ENC_MCon, P 521[0] - ENC_SCon and P 522[0] - ENC_PCon.

The Kalman filter needs to be configured further by following the steps below:

|Step|Action|
|---|---|
|1|Automatically configure noise covariance matrices Q and R by setting the control parameter for encoder channel 4 (P 783[0] - ENC-CH4-Ctrl) to a value of 6.|
| |Manually configure the test signal generator:|
| |Recommendation: Sinusoidal test signal in d axis|
| |P 792[09] = 1|
| |P 792[19] = 500 Hz|
| |P 792[2] = P 792[9] = 10% of rated motor current|
| |P 792[79] = 15% of rated motor speed|
| |P 792[89] = 5% of rated motor speed|
| |P 792[9] = 30% of rated motor current|
| |Set the other values to 0|
|2|Or set the control parameter for encoder channel 4 (P 783[0] - ENC-CH4-Ctrl) to a value of 3, which will trigger a general initialization routine in which steps 1 and 2, as well as encoder initialization, will be automatically carried out based on the motor parameters.|

# Table 6.30: Configuring the Kalman filter for sensorless control

# Step

# Action

In order to make the encoderless control commissioning process easier, a function used to calculate the position difference between encoderless control and a real encoder can be activated. To use this function, the encoder channel that will be used for the comparison must be selected in P 797[0] - ENC_CH4_Kalman_Compare.

As described in Section ""Auto commutation"" on page 92 or Recommendation:

- P 390[0] = 1
- P 392[0] = 500
- P 392[1] = 500
- P 392[2] = 500
- P 392[3] = 500
- P 393[0] = Rated motor current
- P 393[1] = Rated motor current

# Mode 2

Parameters 792.1 and 792.2 are used as the measuring frequency and measuring amplitude (see step 2)

Recommendation:

- P 794[0] = 100 ms
- P 794[1] = 50% of rated motor current
- P 794[2] = 250 ms

Starting the expanded speed control circuit is not absolutely necessary, but will result in control with better dynamic performance. The circuit can be started by setting P 350[0] - SEL_ObserverMethod to a value of 4. P 339 - CON_SCON_Kalman can be used for tuning purposes. If necessary, adjust the noise covariance matrices and the filter time constants for the expanded speed control circuit (changes will take effect in real-time).

# Table 6.30: Configuring the Kalman filter for sensorless control (continue)

MOOG ID No.:CB40859-001 Date:11/2020

MSD ServoDrive - DeviceHelp 97

# 6 Encoder

# 6 Encoder

MOOG ID No.:CB40859-001 Date:11/2020

# 6.8.2.1 Activation of sensorless control for asynchronous motors

Proceed as follows:

|No.|Activity|
|---|---|
|1|Set motor type (P 450[0] - MOT_Type) to “2 (ASM) = asynchronous motor”.|
|2|Enter the motor name (P 451[0] - MOT_Name).|
|3|Copy the motor variables from the rating plate into the appropriate input box.|
|4|Start motor identification to identify other motor parameters. In the “Encoder selection” screen (see also section ""Encoder selection"" on page 53) under “Encoder for commutation and torque control,” set P 520[0] - ENC_MCon to “CH4(4) = virtual encoder (Channel 4)”.|
|5|Under “virtual encoder (Channel 4)” ""Encoder selection"" set (P 508[0] - ENC_CH4_Sel) to ""SFC(8) = take values of SFC model"".|
|6|In the “Basic Control Settings” screen (see section “Basic settings” on page 101) set “Speed filter TF” (P 351[0] - CON_SCALC_Tf) to 10 ms. In the “Asynchronous motor control settings identification” screen (see also section ""Asynchronous motor"" on page 38) enter the “Total moment of inertia” of the system (P 1516[0] - SCD_JSum). Enter a value that is too small rather than too big to avoid a tendency to oscillate. Automatic detection is not advisable due to the control dynamics and accuracy required.|
|7|In the same screen under “Control design by stiffness” set P 1515[0] - SCD_ConDesign (Stiffness) to 10%.|

# Table 6.31: Commissioning a sensorless-controlled asynchronous motor

|P No.|Index Name|Unit|Description|
|---|---|---|---|
|351|CON_SCALC_Tf| |Speed filter|
| |0|ms|Filter time const. speed control (motor)|
| |1|ms|Filter time const. ",What role does the inductance difference play in sensorless control as described in 'MSD ServoDrive - DeviceHelp'?,A5,The Kalman filter uses the inductance difference to facilitate position determination in a sensorless setup.,2.390625,2.375,3.640625,1.453125,0.419921875
