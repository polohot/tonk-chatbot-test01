,NODE_FILE_NAME,NODE_NUMBER,NODE_HASH,NODE_TEXT,Q,A_NUMBER,A,helpfulness,correctness,coherence,complexity,verbosity
0,msd_servo_drive.txt,20,02f242a213dfa4411d028ce46dfba16a3f97395fa25788fcbaea1715e779d934,"), consult with your project supervisor or the Helpline provided by Moog before using any special SSI protocol modes.

# 6.5.2 EnDat (cyclical) X7

Ch1: ENDAT(4) - Cyclical EnDat (2.1 or 2.2) EnDat is a digital encoder interface developed by HEIDENHAIN. For more details, please visit www.heidenhain.de and go to ►Documentation ►Fundamentals ►Interfaces ►EnDat 2.2.

The software versions required to run the EnDat encoder interface are the standard software versions for the MSD Servo Drive and MSD Single-Axis Servo Drive Compact.

MOOG ID No.:CB40859-001 Date:11/2020

# 6 Encoder

NOTE

- Please note the limitations that apply when running EnDat and SSI encoders (see Section ""Limiting for EnDat and SSI"" on page 52).

When using linear encoders, P 554[0] - ENC_CH1_DigitalResolution is used instead of P 543[0] - ENC_CH1_MultiT and P 544[0] - ENC_CH1_SingleT (which are used for rotary encoders). The values will be read from the EnDat encoder and written to the aforementioned parameters.

- P 543[0] - ENC_CH1_MultiT
- The number ""n"" of multiturn bits defines the measuring range in 2n increments per encoder shaft revolution; maximum travel until overflow; maximum travel within which the absolute value initialization can be unambiguous. In the case of single-turn encoders, MultiT = 0.
- P 544[0] - ENC_CH1_SingleT
- The number ""n"" of single-turn bits corresponds to the encoder’s digital resolution in 2n increments per encoder shaft revolution.
- P 554[0] - ENC_CH1_DigitalResolution
- This is the length of an increment, in nanometres, of the encoder’s digitally transmitted position value. This value is read from the EnDat linear head.

In the case of linear encoders, the number n of transmitted position bits from the encoder will be found in SingleT only! 2n * DigitalResolution yields the maximum travel in nanometres (for the encoder head).

P 640 - ENC_ENDAT is intended for additional information, but is normally not needed. This parameter does not have a Ch1 or Ch3 prefix for the encoder channel in the name, as it applies to both encoder channels. Although usually not needed, the parameter is helpful or required in the following cases:

1. Special EnDat encoder with diagnostics for evaluation
In this case, the valuation numbers from the encoder are read cyclically via additional information. Only the valuation numbers that the encoder supports.

# 6 Encoder

MOOG ID No.:CB40859-001 Date:11/2020

will be read. During the initialization process, the system will read the encoder to determine which valuation numbers it supports. When P 640[0] - ENDAT_Select = 1, the function will be enabled in the controller and the internal diagnostics in the EnDaT encoder will be enabled as well. The EnDat encoder will keep this setting even after being powered off. To explicitly disable the internal diagnostics in the EnDat encoder, set P 640[0] - ENDAT_Select to 2.

# 2. Evaluation of internal warnings

In this scenario, certain internal warnings from the encoder will be read from the encoder via additional information. Only the warnings that both the encoder and the Servo Drive’s software support will be read. During the initialization process, the system will read the encoder to determine which warnings it supports. When P 640[0] - ENDAT_Select = 3, the function will be enabled in the controller.

**Table 6.7: Channel 1 encoder configuration (X7) - EnDat parameters**
|ID|Index Name|Unit|Description|
|---|---|---|---|
|505|0 ENC_CH1_Sel|= ENDAT(4)| |
|543|0 ENC_CH1_MultiT|Number of MultiTurn bits (absolute encoder)| |
|544|0 ENC_CH1_SingleT|Number of SingleTurn bits (absolute encoder)| |
|547|0 ENC_CH1_MTBase|Definition of point of discontinuity in multi-turn range| |
|548|0 ENC_CH1_MTEnable|1: Use Multi-turn encoder as a single-turn encoder| |
|616|0 ENC_CH1_CycleCount|Position encoder sampling cycle (n x 125 μsec)| |
|598|0 ENC_CH1_Position|inc|Position encoder channel 1|
|554|0 ENC_CH1_|nm|Length of one increment (linear absolute encoder)|
|640|ENC_ENDAT| |EnDat additional (additional information)|
|640|0 ENDAT_Select|0=off|EnDat function selection, 1/2=diagnosis on/off, 3=warnings, FF=lock|
|640|1 ENDAT_DiagCount|u16|count new diagnosis block header|
|640|2 ENDAT_BWZ_1|lowbyte|vn1: incremental track|
|640|3 ENDAT_BWZ_3|lowbyte|vn3: absolute track|
|640|4 ENDAT_BWZ_4|lowbyte|vn4: position value formation|
|640|5 ENDAT_Status| |EnDat additional status output|
|640|6 ENDAT_Z1_Sel| |EnDat additional information 1 type selection|

**Table 6.7: Overwrite Channel 1 encoder configuration (X7) - EnDat parameters (continue)**
|ID|Index Name|Unit|Description|
|---|---|---|---|
|640|7 ENDAT_Z1_1| |Z1 info: dword 1|
|640|8 ENDAT_Z1_2| |Z1 info: dword 2|
|640|9 ENDAT_Z1_3| |Z1 info: dword 3|
|640|10 ENDAT_Z1_4| |Z1 info: dword 4|
|640|11 ENDAT_Z2_Sel| |EnDat additional information 2 type selection|
|640|12 ENDAT_Z2_1| |Z2 info: dword 1|
|640|13 ENDAT_Z2_2| |Z2 info: dword 2|
|640|14 ENDAT_Z2_3| |Z2 info: dword 3|
|640|15 ENDAT_Z2_4| |Z2 info: dword 4|
|640|16 ENDAT_Mode1|0=off|EnDat additional mode 1 selection|
|640|17 ENDAT_Mode2| |EnDat additional mode 2 selection|
|640|18 ENDAT_Mode3| |EnDat additional mode 3 selection|
|640|19 ENDAT_Mode4| |EnDat additional mode 4 selection|
|640|20 ENDAT_res1| |reserved 1|
|640|21 ENDAT_res2| |reserved 2|
|640|22 ENDAT_res3| |reserved 3|
|640|23 ENDAT_HwSyncStop|0=SyncOn|EnDat cyclic hw sync, stop/start 1/0|
|640|24 ENDAT_CyclCount| |call counter of cyclic function|
|640|25 ENDAT_BWZ_Supported| |vn supported (bit3=vn4, bit2=vn3, bit0=vn1)|
|640|26 ENDAT_BWZ1_| |vn1: bits[7..0] threshold level, bits[31..16]|
|640|27 ThresholdLevel| |how often number|
|640|28 ENDAT_BWZ3_| |vn3: bits[7..0] threshold level, bits[31..16]|
|640|29 ThresholdLevel| |how often number|
|640|30 ENDAT_BWZ4_| |vn4: bits[7..0] threshold level, bits[31..16]|
|640|31 ThresholdLevel| |how often number|
|640|32 ENDAT_BWZ_TEST_| |vn: bits[15..12] 'F', bits[11..8] vn.no., bits [7..0] vn overwrite value|

# 6.5.3 Hall sensor X7

Ch1: HALL(5) - Digital hall signals

Ch1: HALL_TTL(7) - Digital hall signals

NOTE

l The operation and configuration of Hall effect sensors is reserved for special applications. Consult with Moog if needed.

# 6.5.4 Sin/Cos / TTL X7

# 6.5.4.1 TTL encoder

Ch1: TTL(3) - TTL signals

TTL encoders are ...

- a. ... ... usually pure incremental encoders without an absolute value interface.
- b. In this case, P 540[0] - ENC_CH1_Abs must be set to OFF(0). ... ... in a few exceptional cases, incremental encoders with an SSI absolute value interface. In this case, P 540[0] - ENC_CH1_Abs must be accordingly set to SSI(1) (SSI_CONT(4) in special cases), so that it will be possible to read the absolute encoder position for the absolute value initialization routine once during the initialization phase.

# 6.5.4.1.1 Pure TTL incremental encoder

Set P 505[0] - ENC_CH1_Sel to TTL(3) and P 540[0] - ENC_CH1_Abs to OFF(0) when using pure TTL encoders, i.e. encoders without an absolute value interface but with a TTL zero pulse.

Linear TTL encoders are run as rotary encoders. For linear motor operation, P 542 [0] - ENC_CH1_Lines and the encoder gearing (see the “Encoder gearing” section) are used to establish the ratio for the linear motor’s pole pair subdivision (North-North) for commutation. 1 x North-North corresponds to one revolution from Lines. In this case, the motor pole pair number must be set to 1. Moreover, P 553[0] - ENC_CH1_PeriodLen is not used in this case.

The TTL interface accepts various TTL signal types, which can be selected using P 558[0] - ENC_CH1_TTL_SignalType:

- (0)AF_B - A/B tracks (forward counting, X4 encoding) - AB
- (1)AR_B - A/B tracks (reverse counting, X4 encoding) - AB_inv
- (2)ABDFN - A: Clock (falling edge), B: Direction (1 = positive) - PulseDir
- (3)ABDRP - A: Clock (rising edge), B: Direction (1 = negative) - PulseDir_inv
- (4)reserved

A maximum interpolation period, in ms (milliseconds), can be configured for the TTL interface using P 601[0] - ENC_CH1_Period. Within this context, Period is the maximum time of “no activity” since the last TTL counter event:

- Period = 0: Function disabled (default)
- Period > 0 (=n ms): If no counter event is registered in n ms, the speed will be set to 0.

# Zero pulse

There is no parameter for activating the zero pulse evaluation here, as this evaluation is controlled exclusively based on the homing mode (see Section ""Homing"" on page 249). However, setting P 541[0] - ENC_CH1_NpTest to 1 provides a test mode that can be used during commissioning in order to be able to activate the zero pulse evaluation even without homing. Scope signals 1014 and 1016 can be used to view a received zero pulse within this context. This test mode must be disabled during normal operation (P 541[0] = 0).

# Commutation

Motor operation with pure incremental encoders needs for the auto commutation function to be enabled without fail. For details see Section ""Synchronous motor auto commutation"" on page 156.

# 6.5.4.1.2 TTL incremental encoder with SSI absolute value interface

See Section ""Sin/Cos incremental encoders with absolute value interface"" on page 65 and in special Section ""SSI absolute value interface"" on page 67.

MSD ServoDrive - DeviceHelp

# 6 Encoder

MOOG ID No.:CB40859-001 Date:11/2020 MSD ServoDrive - DeviceHelp 64

|ID|Index Name|Unit|Description|
|---|---|---|---|
|505|0|ENC_CH1_Sel = 3|Encoder selection set to TTL(3)|
|510|0|ENC_CH1_Num|Encoder gearing: Numerator Ch1: SINCOS(1) - Sin/Cos signals|
|511|0|ENC_CH1_Denom|Encoder gearing: Denominator|
|540|0|ENC_CH1_Abs|Selection of absolute value interface Sin/Cos encoders can ...|
|541|0|ENC_CH1_NpTest|ENC CH1, TEST-MODE: Index pulse signal(s) to Scope|
|542|0|ENC_CH1_lines|Number of lines (Sin/Cos / TTL encoders) a. Be pure incremental encoders without an absolute value interface. In this|
|558|0|ENC_CH1_TTL_SignalType|Channel 1: TTL signal selection case, P 540[0] - ENC_CH1_Abs must be set to OFF(0).|
|601|0|ENC_CH1_Period|Maximum period of interpolation (TTL encoder)|
|616|0|ENC_CH1_CycleCount|Sampling cycle in: n x 125 μ (microseconds) b. Be incremental encoders with an absolute value interface. In this case,|

Table 6.8: Parameters for Channel 1 (X7) - TTL encoder

ENC_CH1_Abs must be accordingly set to SSI(1), EnDat(2), HIPER(3) or, in special cases, SSI_CONT(4) so that it will be possible to read the absolute encoder position for the absolute value initialization routine once during the initialization phase.

# 6.5.4.2.1 Purely Sin/Cos incremental encoders

To run these encoders as purely incremental encoders with a zero pulse on encoder channel Ch1 (without an absolute value interface), the approach is basically the same as for purely TTL operation (see Section ""TTL encoder"" on page 63). The same parameters apply.

However, there are the following differences:

- a. There are no different signal types for the Sin/Cos signal (always 1 Vss for cosine and sine).
- b. The zero pulse is the analog zero pulse typical of Sin/Cos encoders (see the “Connection for high-resolution encoders” section in the operation manual MSD Servo Drive Single-Axis System, for example).

# 6.5.4.2.2 Linear Sin/Cos

|ID|Index Name|Unit|Description|
|---|---|---|---|
|542|ENC_CH1_lines| |Number of Lines (Sin/Cos / TTL encoders)|
|543|ENC_CH1_MultiT| |Number of MultiTurn bits (absolute encoder)|
|544|ENC_CH1_SingleT| |Number of SingleTurn bits (absolute encoder)|
|545|ENC_CH1_Code| |Code selection (SSI encoder) (binary, gray)|
|546|ENC_CH1_Mode| |Mode selection (SSI encoder)|
|547|ENC_CH1_MTBase| |Definition of point of discontinuity in multi-turn range|
|548|ENC_CH1_MTEnable| |Enable MultiTurn use (negative logic, 1=MToff)|
|549|ENC_CH1_Corr| |Signal correction type|
|550|ENC_CH1_CorrVal|0-4|Signal correction values|
|551|ENC_CH1_EncObsMin| |Encoder monitoring minimum, sqrt(a^2+b^2)|
|552|ENC_CH1_AbsEncStatus| |Error and status codes (absolute encoder)|

# 6.5.4.2.3 Signal correction (GPOC)

|ID|Index Name|Unit|Description|
|---|---|---|---|
|553|ENC_CH1_PeriodLen|nm|Length of signal period (Sin/Cos linear encoder)|
|554|ENC_CH1_DigitalResolution|nm|Length of one increment (linear absolute encoder)|
|555|ENC_CH1_Info| |Encoder information|
|616|ENC_CH1_CycleCount| |Sampling cycle in: n x 125 μ (microseconds)|
|610|ENC_CH1_NominalIncrementA| |Sign. Nominal increment A (distance coded abs. per. encoder)|
|611|ENC_CH1_NominalIncrementB| |Sign. Nominal increment B (distance coded abs. per. encoder)|
|1900|ENC_ETS| |ETS mode, electronic nameplate|

# 6.5.4.2.4 Sin/Cos incremental encoders with absolute value interface

The following table lists the parameters for cyclical Sin/Cos operation on encoder channel Ch 1 with one-time reading of the absolute encoder position via the absolute value interface, i.e. without a zero pulse:

|ID|Index Name|Unit|Description|
|---|---|---|---|
|505|ENC_CH1_Sel|1|Encoder selection set to SINCOS(1)|
|510|ENC_CH1_Num| |Encoder gearing: Numerator|
|511|ENC_CH1_Denom| |Encoder gearing: Denominator|
|540|ENC_CH1_Abs| |Absolute value interface selection (one-time reading)|

Table 6.9: Parameters for channel 1 (X7) - Sin/Cos encoder

The Sel, Num, Denom, Abs, Lines, MultiT, SingleT and CorrVal parameters are self-explanatory.

The Code and Mode parameters are described in Section ""SSI (cyclical) X7"" on page 69.

P 547[0] - ENC_CH1_MTBase = Minimum MultiTurn position

The MTBase parameter is used to set a position in the multi-turn encoder’s travel path that defines the point of discontinuity (overflow/underflow) for the absolute value initialization (that is, the “multi-turn basis”). Assuming a bipolar encoder measuring range, all position values that fall below MTBase will be shifted “up” (the whole MT range will be added to them once).

MOOG ID No.:CB40859-001 Date:11/2020

MSD ServoDrive - DeviceHelp

# 6 Encoder

MOOG ID No.:CB40859-001 Date:11/2020

method makes it possible to place the point of discontinuity at any point within the encoder’s entire measuring range. By default, MTBase will be set to the lowest possible value for the parameter, i.e. reliably outside of the encoder’s value range: In this case, the full bipolar range will remain unaffected, as values will never fall below this MTBase threshold (see Section ""Channel 1: Interface X7"" on page 59).

- P 548[0] - ENC_CH1_MTEnable = MultiTurn as SingleTurn
- The MTEnable parameter makes it possible to use multi-turn encoders as single-turn encoders for test purposes. Negative logic: Default MTEnable = 0 means ""MultiTurn-Enable ON"".

P 549[0] - ENC_CH1_Corr = Signal correction type
- The GPOC routine used for track signal correction purposes for sine/cosine signals is used to compensate for systematic errors. The routine is controlled with the Corr and CorrVal parameters (see Section ""Signal correction GPOC (Gain Phase Offset Correction)"" on page 74).

P 551[0] - ENC_CH1_EncObsMin = Encoder monitoring minimum, sqrt (a^2+b^2)
- The parameter EncObsMin is used to scale the Sin/Cos wire break monitoring and represents the “downwards threshold” for an error message. The default setting is 0.2, corresponding to approx. ",How does the P 548[0] - ENC_CH1_MTEnable parameter affect multi-turn encoder usage?,A1,"P 548[0] allows multi-turn encoders to be used as single-turn encoders for testing, with default (0) enabling multi-turn functionality.",2.5,2.453125,3.5,1.6328125,0.84765625
1,msd_servo_drive.txt,20,02f242a213dfa4411d028ce46dfba16a3f97395fa25788fcbaea1715e779d934,"), consult with your project supervisor or the Helpline provided by Moog before using any special SSI protocol modes.

# 6.5.2 EnDat (cyclical) X7

Ch1: ENDAT(4) - Cyclical EnDat (2.1 or 2.2) EnDat is a digital encoder interface developed by HEIDENHAIN. For more details, please visit www.heidenhain.de and go to ►Documentation ►Fundamentals ►Interfaces ►EnDat 2.2.

The software versions required to run the EnDat encoder interface are the standard software versions for the MSD Servo Drive and MSD Single-Axis Servo Drive Compact.

MOOG ID No.:CB40859-001 Date:11/2020

# 6 Encoder

NOTE

- Please note the limitations that apply when running EnDat and SSI encoders (see Section ""Limiting for EnDat and SSI"" on page 52).

When using linear encoders, P 554[0] - ENC_CH1_DigitalResolution is used instead of P 543[0] - ENC_CH1_MultiT and P 544[0] - ENC_CH1_SingleT (which are used for rotary encoders). The values will be read from the EnDat encoder and written to the aforementioned parameters.

- P 543[0] - ENC_CH1_MultiT
- The number ""n"" of multiturn bits defines the measuring range in 2n increments per encoder shaft revolution; maximum travel until overflow; maximum travel within which the absolute value initialization can be unambiguous. In the case of single-turn encoders, MultiT = 0.
- P 544[0] - ENC_CH1_SingleT
- The number ""n"" of single-turn bits corresponds to the encoder’s digital resolution in 2n increments per encoder shaft revolution.
- P 554[0] - ENC_CH1_DigitalResolution
- This is the length of an increment, in nanometres, of the encoder’s digitally transmitted position value. This value is read from the EnDat linear head.

In the case of linear encoders, the number n of transmitted position bits from the encoder will be found in SingleT only! 2n * DigitalResolution yields the maximum travel in nanometres (for the encoder head).

P 640 - ENC_ENDAT is intended for additional information, but is normally not needed. This parameter does not have a Ch1 or Ch3 prefix for the encoder channel in the name, as it applies to both encoder channels. Although usually not needed, the parameter is helpful or required in the following cases:

1. Special EnDat encoder with diagnostics for evaluation
In this case, the valuation numbers from the encoder are read cyclically via additional information. Only the valuation numbers that the encoder supports.

# 6 Encoder

MOOG ID No.:CB40859-001 Date:11/2020

will be read. During the initialization process, the system will read the encoder to determine which valuation numbers it supports. When P 640[0] - ENDAT_Select = 1, the function will be enabled in the controller and the internal diagnostics in the EnDaT encoder will be enabled as well. The EnDat encoder will keep this setting even after being powered off. To explicitly disable the internal diagnostics in the EnDat encoder, set P 640[0] - ENDAT_Select to 2.

# 2. Evaluation of internal warnings

In this scenario, certain internal warnings from the encoder will be read from the encoder via additional information. Only the warnings that both the encoder and the Servo Drive’s software support will be read. During the initialization process, the system will read the encoder to determine which warnings it supports. When P 640[0] - ENDAT_Select = 3, the function will be enabled in the controller.

**Table 6.7: Channel 1 encoder configuration (X7) - EnDat parameters**
|ID|Index Name|Unit|Description|
|---|---|---|---|
|505|0 ENC_CH1_Sel|= ENDAT(4)| |
|543|0 ENC_CH1_MultiT|Number of MultiTurn bits (absolute encoder)| |
|544|0 ENC_CH1_SingleT|Number of SingleTurn bits (absolute encoder)| |
|547|0 ENC_CH1_MTBase|Definition of point of discontinuity in multi-turn range| |
|548|0 ENC_CH1_MTEnable|1: Use Multi-turn encoder as a single-turn encoder| |
|616|0 ENC_CH1_CycleCount|Position encoder sampling cycle (n x 125 μsec)| |
|598|0 ENC_CH1_Position|inc|Position encoder channel 1|
|554|0 ENC_CH1_|nm|Length of one increment (linear absolute encoder)|
|640|ENC_ENDAT| |EnDat additional (additional information)|
|640|0 ENDAT_Select|0=off|EnDat function selection, 1/2=diagnosis on/off, 3=warnings, FF=lock|
|640|1 ENDAT_DiagCount|u16|count new diagnosis block header|
|640|2 ENDAT_BWZ_1|lowbyte|vn1: incremental track|
|640|3 ENDAT_BWZ_3|lowbyte|vn3: absolute track|
|640|4 ENDAT_BWZ_4|lowbyte|vn4: position value formation|
|640|5 ENDAT_Status| |EnDat additional status output|
|640|6 ENDAT_Z1_Sel| |EnDat additional information 1 type selection|

**Table 6.7: Overwrite Channel 1 encoder configuration (X7) - EnDat parameters (continue)**
|ID|Index Name|Unit|Description|
|---|---|---|---|
|640|7 ENDAT_Z1_1| |Z1 info: dword 1|
|640|8 ENDAT_Z1_2| |Z1 info: dword 2|
|640|9 ENDAT_Z1_3| |Z1 info: dword 3|
|640|10 ENDAT_Z1_4| |Z1 info: dword 4|
|640|11 ENDAT_Z2_Sel| |EnDat additional information 2 type selection|
|640|12 ENDAT_Z2_1| |Z2 info: dword 1|
|640|13 ENDAT_Z2_2| |Z2 info: dword 2|
|640|14 ENDAT_Z2_3| |Z2 info: dword 3|
|640|15 ENDAT_Z2_4| |Z2 info: dword 4|
|640|16 ENDAT_Mode1|0=off|EnDat additional mode 1 selection|
|640|17 ENDAT_Mode2| |EnDat additional mode 2 selection|
|640|18 ENDAT_Mode3| |EnDat additional mode 3 selection|
|640|19 ENDAT_Mode4| |EnDat additional mode 4 selection|
|640|20 ENDAT_res1| |reserved 1|
|640|21 ENDAT_res2| |reserved 2|
|640|22 ENDAT_res3| |reserved 3|
|640|23 ENDAT_HwSyncStop|0=SyncOn|EnDat cyclic hw sync, stop/start 1/0|
|640|24 ENDAT_CyclCount| |call counter of cyclic function|
|640|25 ENDAT_BWZ_Supported| |vn supported (bit3=vn4, bit2=vn3, bit0=vn1)|
|640|26 ENDAT_BWZ1_| |vn1: bits[7..0] threshold level, bits[31..16]|
|640|27 ThresholdLevel| |how often number|
|640|28 ENDAT_BWZ3_| |vn3: bits[7..0] threshold level, bits[31..16]|
|640|29 ThresholdLevel| |how often number|
|640|30 ENDAT_BWZ4_| |vn4: bits[7..0] threshold level, bits[31..16]|
|640|31 ThresholdLevel| |how often number|
|640|32 ENDAT_BWZ_TEST_| |vn: bits[15..12] 'F', bits[11..8] vn.no., bits [7..0] vn overwrite value|

# 6.5.3 Hall sensor X7

Ch1: HALL(5) - Digital hall signals

Ch1: HALL_TTL(7) - Digital hall signals

NOTE

l The operation and configuration of Hall effect sensors is reserved for special applications. Consult with Moog if needed.

# 6.5.4 Sin/Cos / TTL X7

# 6.5.4.1 TTL encoder

Ch1: TTL(3) - TTL signals

TTL encoders are ...

- a. ... ... usually pure incremental encoders without an absolute value interface.
- b. In this case, P 540[0] - ENC_CH1_Abs must be set to OFF(0). ... ... in a few exceptional cases, incremental encoders with an SSI absolute value interface. In this case, P 540[0] - ENC_CH1_Abs must be accordingly set to SSI(1) (SSI_CONT(4) in special cases), so that it will be possible to read the absolute encoder position for the absolute value initialization routine once during the initialization phase.

# 6.5.4.1.1 Pure TTL incremental encoder

Set P 505[0] - ENC_CH1_Sel to TTL(3) and P 540[0] - ENC_CH1_Abs to OFF(0) when using pure TTL encoders, i.e. encoders without an absolute value interface but with a TTL zero pulse.

Linear TTL encoders are run as rotary encoders. For linear motor operation, P 542 [0] - ENC_CH1_Lines and the encoder gearing (see the “Encoder gearing” section) are used to establish the ratio for the linear motor’s pole pair subdivision (North-North) for commutation. 1 x North-North corresponds to one revolution from Lines. In this case, the motor pole pair number must be set to 1. Moreover, P 553[0] - ENC_CH1_PeriodLen is not used in this case.

The TTL interface accepts various TTL signal types, which can be selected using P 558[0] - ENC_CH1_TTL_SignalType:

- (0)AF_B - A/B tracks (forward counting, X4 encoding) - AB
- (1)AR_B - A/B tracks (reverse counting, X4 encoding) - AB_inv
- (2)ABDFN - A: Clock (falling edge), B: Direction (1 = positive) - PulseDir
- (3)ABDRP - A: Clock (rising edge), B: Direction (1 = negative) - PulseDir_inv
- (4)reserved

A maximum interpolation period, in ms (milliseconds), can be configured for the TTL interface using P 601[0] - ENC_CH1_Period. Within this context, Period is the maximum time of “no activity” since the last TTL counter event:

- Period = 0: Function disabled (default)
- Period > 0 (=n ms): If no counter event is registered in n ms, the speed will be set to 0.

# Zero pulse

There is no parameter for activating the zero pulse evaluation here, as this evaluation is controlled exclusively based on the homing mode (see Section ""Homing"" on page 249). However, setting P 541[0] - ENC_CH1_NpTest to 1 provides a test mode that can be used during commissioning in order to be able to activate the zero pulse evaluation even without homing. Scope signals 1014 and 1016 can be used to view a received zero pulse within this context. This test mode must be disabled during normal operation (P 541[0] = 0).

# Commutation

Motor operation with pure incremental encoders needs for the auto commutation function to be enabled without fail. For details see Section ""Synchronous motor auto commutation"" on page 156.

# 6.5.4.1.2 TTL incremental encoder with SSI absolute value interface

See Section ""Sin/Cos incremental encoders with absolute value interface"" on page 65 and in special Section ""SSI absolute value interface"" on page 67.

MSD ServoDrive - DeviceHelp

# 6 Encoder

MOOG ID No.:CB40859-001 Date:11/2020 MSD ServoDrive - DeviceHelp 64

|ID|Index Name|Unit|Description|
|---|---|---|---|
|505|0|ENC_CH1_Sel = 3|Encoder selection set to TTL(3)|
|510|0|ENC_CH1_Num|Encoder gearing: Numerator Ch1: SINCOS(1) - Sin/Cos signals|
|511|0|ENC_CH1_Denom|Encoder gearing: Denominator|
|540|0|ENC_CH1_Abs|Selection of absolute value interface Sin/Cos encoders can ...|
|541|0|ENC_CH1_NpTest|ENC CH1, TEST-MODE: Index pulse signal(s) to Scope|
|542|0|ENC_CH1_lines|Number of lines (Sin/Cos / TTL encoders) a. Be pure incremental encoders without an absolute value interface. In this|
|558|0|ENC_CH1_TTL_SignalType|Channel 1: TTL signal selection case, P 540[0] - ENC_CH1_Abs must be set to OFF(0).|
|601|0|ENC_CH1_Period|Maximum period of interpolation (TTL encoder)|
|616|0|ENC_CH1_CycleCount|Sampling cycle in: n x 125 μ (microseconds) b. Be incremental encoders with an absolute value interface. In this case,|

Table 6.8: Parameters for Channel 1 (X7) - TTL encoder

ENC_CH1_Abs must be accordingly set to SSI(1), EnDat(2), HIPER(3) or, in special cases, SSI_CONT(4) so that it will be possible to read the absolute encoder position for the absolute value initialization routine once during the initialization phase.

# 6.5.4.2.1 Purely Sin/Cos incremental encoders

To run these encoders as purely incremental encoders with a zero pulse on encoder channel Ch1 (without an absolute value interface), the approach is basically the same as for purely TTL operation (see Section ""TTL encoder"" on page 63). The same parameters apply.

However, there are the following differences:

- a. There are no different signal types for the Sin/Cos signal (always 1 Vss for cosine and sine).
- b. The zero pulse is the analog zero pulse typical of Sin/Cos encoders (see the “Connection for high-resolution encoders” section in the operation manual MSD Servo Drive Single-Axis System, for example).

# 6.5.4.2.2 Linear Sin/Cos

|ID|Index Name|Unit|Description|
|---|---|---|---|
|542|ENC_CH1_lines| |Number of Lines (Sin/Cos / TTL encoders)|
|543|ENC_CH1_MultiT| |Number of MultiTurn bits (absolute encoder)|
|544|ENC_CH1_SingleT| |Number of SingleTurn bits (absolute encoder)|
|545|ENC_CH1_Code| |Code selection (SSI encoder) (binary, gray)|
|546|ENC_CH1_Mode| |Mode selection (SSI encoder)|
|547|ENC_CH1_MTBase| |Definition of point of discontinuity in multi-turn range|
|548|ENC_CH1_MTEnable| |Enable MultiTurn use (negative logic, 1=MToff)|
|549|ENC_CH1_Corr| |Signal correction type|
|550|ENC_CH1_CorrVal|0-4|Signal correction values|
|551|ENC_CH1_EncObsMin| |Encoder monitoring minimum, sqrt(a^2+b^2)|
|552|ENC_CH1_AbsEncStatus| |Error and status codes (absolute encoder)|

# 6.5.4.2.3 Signal correction (GPOC)

|ID|Index Name|Unit|Description|
|---|---|---|---|
|553|ENC_CH1_PeriodLen|nm|Length of signal period (Sin/Cos linear encoder)|
|554|ENC_CH1_DigitalResolution|nm|Length of one increment (linear absolute encoder)|
|555|ENC_CH1_Info| |Encoder information|
|616|ENC_CH1_CycleCount| |Sampling cycle in: n x 125 μ (microseconds)|
|610|ENC_CH1_NominalIncrementA| |Sign. Nominal increment A (distance coded abs. per. encoder)|
|611|ENC_CH1_NominalIncrementB| |Sign. Nominal increment B (distance coded abs. per. encoder)|
|1900|ENC_ETS| |ETS mode, electronic nameplate|

# 6.5.4.2.4 Sin/Cos incremental encoders with absolute value interface

The following table lists the parameters for cyclical Sin/Cos operation on encoder channel Ch 1 with one-time reading of the absolute encoder position via the absolute value interface, i.e. without a zero pulse:

|ID|Index Name|Unit|Description|
|---|---|---|---|
|505|ENC_CH1_Sel|1|Encoder selection set to SINCOS(1)|
|510|ENC_CH1_Num| |Encoder gearing: Numerator|
|511|ENC_CH1_Denom| |Encoder gearing: Denominator|
|540|ENC_CH1_Abs| |Absolute value interface selection (one-time reading)|

Table 6.9: Parameters for channel 1 (X7) - Sin/Cos encoder

The Sel, Num, Denom, Abs, Lines, MultiT, SingleT and CorrVal parameters are self-explanatory.

The Code and Mode parameters are described in Section ""SSI (cyclical) X7"" on page 69.

P 547[0] - ENC_CH1_MTBase = Minimum MultiTurn position

The MTBase parameter is used to set a position in the multi-turn encoder’s travel path that defines the point of discontinuity (overflow/underflow) for the absolute value initialization (that is, the “multi-turn basis”). Assuming a bipolar encoder measuring range, all position values that fall below MTBase will be shifted “up” (the whole MT range will be added to them once).

MOOG ID No.:CB40859-001 Date:11/2020

MSD ServoDrive - DeviceHelp

# 6 Encoder

MOOG ID No.:CB40859-001 Date:11/2020

method makes it possible to place the point of discontinuity at any point within the encoder’s entire measuring range. By default, MTBase will be set to the lowest possible value for the parameter, i.e. reliably outside of the encoder’s value range: In this case, the full bipolar range will remain unaffected, as values will never fall below this MTBase threshold (see Section ""Channel 1: Interface X7"" on page 59).

- P 548[0] - ENC_CH1_MTEnable = MultiTurn as SingleTurn
- The MTEnable parameter makes it possible to use multi-turn encoders as single-turn encoders for test purposes. Negative logic: Default MTEnable = 0 means ""MultiTurn-Enable ON"".

P 549[0] - ENC_CH1_Corr = Signal correction type
- The GPOC routine used for track signal correction purposes for sine/cosine signals is used to compensate for systematic errors. The routine is controlled with the Corr and CorrVal parameters (see Section ""Signal correction GPOC (Gain Phase Offset Correction)"" on page 74).

P 551[0] - ENC_CH1_EncObsMin = Encoder monitoring minimum, sqrt (a^2+b^2)
- The parameter EncObsMin is used to scale the Sin/Cos wire break monitoring and represents the “downwards threshold” for an error message. The default setting is 0.2, corresponding to approx. ",How does the P 548[0] - ENC_CH1_MTEnable parameter affect multi-turn encoder usage?,A2,"This parameter, using negative logic, can disable multi-turn features (set to 1) to simulate single-turn encoder behavior during tests.",2.546875,2.609375,3.578125,1.7890625,0.6640625
2,msd_servo_drive.txt,20,02f242a213dfa4411d028ce46dfba16a3f97395fa25788fcbaea1715e779d934,"), consult with your project supervisor or the Helpline provided by Moog before using any special SSI protocol modes.

# 6.5.2 EnDat (cyclical) X7

Ch1: ENDAT(4) - Cyclical EnDat (2.1 or 2.2) EnDat is a digital encoder interface developed by HEIDENHAIN. For more details, please visit www.heidenhain.de and go to ►Documentation ►Fundamentals ►Interfaces ►EnDat 2.2.

The software versions required to run the EnDat encoder interface are the standard software versions for the MSD Servo Drive and MSD Single-Axis Servo Drive Compact.

MOOG ID No.:CB40859-001 Date:11/2020

# 6 Encoder

NOTE

- Please note the limitations that apply when running EnDat and SSI encoders (see Section ""Limiting for EnDat and SSI"" on page 52).

When using linear encoders, P 554[0] - ENC_CH1_DigitalResolution is used instead of P 543[0] - ENC_CH1_MultiT and P 544[0] - ENC_CH1_SingleT (which are used for rotary encoders). The values will be read from the EnDat encoder and written to the aforementioned parameters.

- P 543[0] - ENC_CH1_MultiT
- The number ""n"" of multiturn bits defines the measuring range in 2n increments per encoder shaft revolution; maximum travel until overflow; maximum travel within which the absolute value initialization can be unambiguous. In the case of single-turn encoders, MultiT = 0.
- P 544[0] - ENC_CH1_SingleT
- The number ""n"" of single-turn bits corresponds to the encoder’s digital resolution in 2n increments per encoder shaft revolution.
- P 554[0] - ENC_CH1_DigitalResolution
- This is the length of an increment, in nanometres, of the encoder’s digitally transmitted position value. This value is read from the EnDat linear head.

In the case of linear encoders, the number n of transmitted position bits from the encoder will be found in SingleT only! 2n * DigitalResolution yields the maximum travel in nanometres (for the encoder head).

P 640 - ENC_ENDAT is intended for additional information, but is normally not needed. This parameter does not have a Ch1 or Ch3 prefix for the encoder channel in the name, as it applies to both encoder channels. Although usually not needed, the parameter is helpful or required in the following cases:

1. Special EnDat encoder with diagnostics for evaluation
In this case, the valuation numbers from the encoder are read cyclically via additional information. Only the valuation numbers that the encoder supports.

# 6 Encoder

MOOG ID No.:CB40859-001 Date:11/2020

will be read. During the initialization process, the system will read the encoder to determine which valuation numbers it supports. When P 640[0] - ENDAT_Select = 1, the function will be enabled in the controller and the internal diagnostics in the EnDaT encoder will be enabled as well. The EnDat encoder will keep this setting even after being powered off. To explicitly disable the internal diagnostics in the EnDat encoder, set P 640[0] - ENDAT_Select to 2.

# 2. Evaluation of internal warnings

In this scenario, certain internal warnings from the encoder will be read from the encoder via additional information. Only the warnings that both the encoder and the Servo Drive’s software support will be read. During the initialization process, the system will read the encoder to determine which warnings it supports. When P 640[0] - ENDAT_Select = 3, the function will be enabled in the controller.

**Table 6.7: Channel 1 encoder configuration (X7) - EnDat parameters**
|ID|Index Name|Unit|Description|
|---|---|---|---|
|505|0 ENC_CH1_Sel|= ENDAT(4)| |
|543|0 ENC_CH1_MultiT|Number of MultiTurn bits (absolute encoder)| |
|544|0 ENC_CH1_SingleT|Number of SingleTurn bits (absolute encoder)| |
|547|0 ENC_CH1_MTBase|Definition of point of discontinuity in multi-turn range| |
|548|0 ENC_CH1_MTEnable|1: Use Multi-turn encoder as a single-turn encoder| |
|616|0 ENC_CH1_CycleCount|Position encoder sampling cycle (n x 125 μsec)| |
|598|0 ENC_CH1_Position|inc|Position encoder channel 1|
|554|0 ENC_CH1_|nm|Length of one increment (linear absolute encoder)|
|640|ENC_ENDAT| |EnDat additional (additional information)|
|640|0 ENDAT_Select|0=off|EnDat function selection, 1/2=diagnosis on/off, 3=warnings, FF=lock|
|640|1 ENDAT_DiagCount|u16|count new diagnosis block header|
|640|2 ENDAT_BWZ_1|lowbyte|vn1: incremental track|
|640|3 ENDAT_BWZ_3|lowbyte|vn3: absolute track|
|640|4 ENDAT_BWZ_4|lowbyte|vn4: position value formation|
|640|5 ENDAT_Status| |EnDat additional status output|
|640|6 ENDAT_Z1_Sel| |EnDat additional information 1 type selection|

**Table 6.7: Overwrite Channel 1 encoder configuration (X7) - EnDat parameters (continue)**
|ID|Index Name|Unit|Description|
|---|---|---|---|
|640|7 ENDAT_Z1_1| |Z1 info: dword 1|
|640|8 ENDAT_Z1_2| |Z1 info: dword 2|
|640|9 ENDAT_Z1_3| |Z1 info: dword 3|
|640|10 ENDAT_Z1_4| |Z1 info: dword 4|
|640|11 ENDAT_Z2_Sel| |EnDat additional information 2 type selection|
|640|12 ENDAT_Z2_1| |Z2 info: dword 1|
|640|13 ENDAT_Z2_2| |Z2 info: dword 2|
|640|14 ENDAT_Z2_3| |Z2 info: dword 3|
|640|15 ENDAT_Z2_4| |Z2 info: dword 4|
|640|16 ENDAT_Mode1|0=off|EnDat additional mode 1 selection|
|640|17 ENDAT_Mode2| |EnDat additional mode 2 selection|
|640|18 ENDAT_Mode3| |EnDat additional mode 3 selection|
|640|19 ENDAT_Mode4| |EnDat additional mode 4 selection|
|640|20 ENDAT_res1| |reserved 1|
|640|21 ENDAT_res2| |reserved 2|
|640|22 ENDAT_res3| |reserved 3|
|640|23 ENDAT_HwSyncStop|0=SyncOn|EnDat cyclic hw sync, stop/start 1/0|
|640|24 ENDAT_CyclCount| |call counter of cyclic function|
|640|25 ENDAT_BWZ_Supported| |vn supported (bit3=vn4, bit2=vn3, bit0=vn1)|
|640|26 ENDAT_BWZ1_| |vn1: bits[7..0] threshold level, bits[31..16]|
|640|27 ThresholdLevel| |how often number|
|640|28 ENDAT_BWZ3_| |vn3: bits[7..0] threshold level, bits[31..16]|
|640|29 ThresholdLevel| |how often number|
|640|30 ENDAT_BWZ4_| |vn4: bits[7..0] threshold level, bits[31..16]|
|640|31 ThresholdLevel| |how often number|
|640|32 ENDAT_BWZ_TEST_| |vn: bits[15..12] 'F', bits[11..8] vn.no., bits [7..0] vn overwrite value|

# 6.5.3 Hall sensor X7

Ch1: HALL(5) - Digital hall signals

Ch1: HALL_TTL(7) - Digital hall signals

NOTE

l The operation and configuration of Hall effect sensors is reserved for special applications. Consult with Moog if needed.

# 6.5.4 Sin/Cos / TTL X7

# 6.5.4.1 TTL encoder

Ch1: TTL(3) - TTL signals

TTL encoders are ...

- a. ... ... usually pure incremental encoders without an absolute value interface.
- b. In this case, P 540[0] - ENC_CH1_Abs must be set to OFF(0). ... ... in a few exceptional cases, incremental encoders with an SSI absolute value interface. In this case, P 540[0] - ENC_CH1_Abs must be accordingly set to SSI(1) (SSI_CONT(4) in special cases), so that it will be possible to read the absolute encoder position for the absolute value initialization routine once during the initialization phase.

# 6.5.4.1.1 Pure TTL incremental encoder

Set P 505[0] - ENC_CH1_Sel to TTL(3) and P 540[0] - ENC_CH1_Abs to OFF(0) when using pure TTL encoders, i.e. encoders without an absolute value interface but with a TTL zero pulse.

Linear TTL encoders are run as rotary encoders. For linear motor operation, P 542 [0] - ENC_CH1_Lines and the encoder gearing (see the “Encoder gearing” section) are used to establish the ratio for the linear motor’s pole pair subdivision (North-North) for commutation. 1 x North-North corresponds to one revolution from Lines. In this case, the motor pole pair number must be set to 1. Moreover, P 553[0] - ENC_CH1_PeriodLen is not used in this case.

The TTL interface accepts various TTL signal types, which can be selected using P 558[0] - ENC_CH1_TTL_SignalType:

- (0)AF_B - A/B tracks (forward counting, X4 encoding) - AB
- (1)AR_B - A/B tracks (reverse counting, X4 encoding) - AB_inv
- (2)ABDFN - A: Clock (falling edge), B: Direction (1 = positive) - PulseDir
- (3)ABDRP - A: Clock (rising edge), B: Direction (1 = negative) - PulseDir_inv
- (4)reserved

A maximum interpolation period, in ms (milliseconds), can be configured for the TTL interface using P 601[0] - ENC_CH1_Period. Within this context, Period is the maximum time of “no activity” since the last TTL counter event:

- Period = 0: Function disabled (default)
- Period > 0 (=n ms): If no counter event is registered in n ms, the speed will be set to 0.

# Zero pulse

There is no parameter for activating the zero pulse evaluation here, as this evaluation is controlled exclusively based on the homing mode (see Section ""Homing"" on page 249). However, setting P 541[0] - ENC_CH1_NpTest to 1 provides a test mode that can be used during commissioning in order to be able to activate the zero pulse evaluation even without homing. Scope signals 1014 and 1016 can be used to view a received zero pulse within this context. This test mode must be disabled during normal operation (P 541[0] = 0).

# Commutation

Motor operation with pure incremental encoders needs for the auto commutation function to be enabled without fail. For details see Section ""Synchronous motor auto commutation"" on page 156.

# 6.5.4.1.2 TTL incremental encoder with SSI absolute value interface

See Section ""Sin/Cos incremental encoders with absolute value interface"" on page 65 and in special Section ""SSI absolute value interface"" on page 67.

MSD ServoDrive - DeviceHelp

# 6 Encoder

MOOG ID No.:CB40859-001 Date:11/2020 MSD ServoDrive - DeviceHelp 64

|ID|Index Name|Unit|Description|
|---|---|---|---|
|505|0|ENC_CH1_Sel = 3|Encoder selection set to TTL(3)|
|510|0|ENC_CH1_Num|Encoder gearing: Numerator Ch1: SINCOS(1) - Sin/Cos signals|
|511|0|ENC_CH1_Denom|Encoder gearing: Denominator|
|540|0|ENC_CH1_Abs|Selection of absolute value interface Sin/Cos encoders can ...|
|541|0|ENC_CH1_NpTest|ENC CH1, TEST-MODE: Index pulse signal(s) to Scope|
|542|0|ENC_CH1_lines|Number of lines (Sin/Cos / TTL encoders) a. Be pure incremental encoders without an absolute value interface. In this|
|558|0|ENC_CH1_TTL_SignalType|Channel 1: TTL signal selection case, P 540[0] - ENC_CH1_Abs must be set to OFF(0).|
|601|0|ENC_CH1_Period|Maximum period of interpolation (TTL encoder)|
|616|0|ENC_CH1_CycleCount|Sampling cycle in: n x 125 μ (microseconds) b. Be incremental encoders with an absolute value interface. In this case,|

Table 6.8: Parameters for Channel 1 (X7) - TTL encoder

ENC_CH1_Abs must be accordingly set to SSI(1), EnDat(2), HIPER(3) or, in special cases, SSI_CONT(4) so that it will be possible to read the absolute encoder position for the absolute value initialization routine once during the initialization phase.

# 6.5.4.2.1 Purely Sin/Cos incremental encoders

To run these encoders as purely incremental encoders with a zero pulse on encoder channel Ch1 (without an absolute value interface), the approach is basically the same as for purely TTL operation (see Section ""TTL encoder"" on page 63). The same parameters apply.

However, there are the following differences:

- a. There are no different signal types for the Sin/Cos signal (always 1 Vss for cosine and sine).
- b. The zero pulse is the analog zero pulse typical of Sin/Cos encoders (see the “Connection for high-resolution encoders” section in the operation manual MSD Servo Drive Single-Axis System, for example).

# 6.5.4.2.2 Linear Sin/Cos

|ID|Index Name|Unit|Description|
|---|---|---|---|
|542|ENC_CH1_lines| |Number of Lines (Sin/Cos / TTL encoders)|
|543|ENC_CH1_MultiT| |Number of MultiTurn bits (absolute encoder)|
|544|ENC_CH1_SingleT| |Number of SingleTurn bits (absolute encoder)|
|545|ENC_CH1_Code| |Code selection (SSI encoder) (binary, gray)|
|546|ENC_CH1_Mode| |Mode selection (SSI encoder)|
|547|ENC_CH1_MTBase| |Definition of point of discontinuity in multi-turn range|
|548|ENC_CH1_MTEnable| |Enable MultiTurn use (negative logic, 1=MToff)|
|549|ENC_CH1_Corr| |Signal correction type|
|550|ENC_CH1_CorrVal|0-4|Signal correction values|
|551|ENC_CH1_EncObsMin| |Encoder monitoring minimum, sqrt(a^2+b^2)|
|552|ENC_CH1_AbsEncStatus| |Error and status codes (absolute encoder)|

# 6.5.4.2.3 Signal correction (GPOC)

|ID|Index Name|Unit|Description|
|---|---|---|---|
|553|ENC_CH1_PeriodLen|nm|Length of signal period (Sin/Cos linear encoder)|
|554|ENC_CH1_DigitalResolution|nm|Length of one increment (linear absolute encoder)|
|555|ENC_CH1_Info| |Encoder information|
|616|ENC_CH1_CycleCount| |Sampling cycle in: n x 125 μ (microseconds)|
|610|ENC_CH1_NominalIncrementA| |Sign. Nominal increment A (distance coded abs. per. encoder)|
|611|ENC_CH1_NominalIncrementB| |Sign. Nominal increment B (distance coded abs. per. encoder)|
|1900|ENC_ETS| |ETS mode, electronic nameplate|

# 6.5.4.2.4 Sin/Cos incremental encoders with absolute value interface

The following table lists the parameters for cyclical Sin/Cos operation on encoder channel Ch 1 with one-time reading of the absolute encoder position via the absolute value interface, i.e. without a zero pulse:

|ID|Index Name|Unit|Description|
|---|---|---|---|
|505|ENC_CH1_Sel|1|Encoder selection set to SINCOS(1)|
|510|ENC_CH1_Num| |Encoder gearing: Numerator|
|511|ENC_CH1_Denom| |Encoder gearing: Denominator|
|540|ENC_CH1_Abs| |Absolute value interface selection (one-time reading)|

Table 6.9: Parameters for channel 1 (X7) - Sin/Cos encoder

The Sel, Num, Denom, Abs, Lines, MultiT, SingleT and CorrVal parameters are self-explanatory.

The Code and Mode parameters are described in Section ""SSI (cyclical) X7"" on page 69.

P 547[0] - ENC_CH1_MTBase = Minimum MultiTurn position

The MTBase parameter is used to set a position in the multi-turn encoder’s travel path that defines the point of discontinuity (overflow/underflow) for the absolute value initialization (that is, the “multi-turn basis”). Assuming a bipolar encoder measuring range, all position values that fall below MTBase will be shifted “up” (the whole MT range will be added to them once).

MOOG ID No.:CB40859-001 Date:11/2020

MSD ServoDrive - DeviceHelp

# 6 Encoder

MOOG ID No.:CB40859-001 Date:11/2020

method makes it possible to place the point of discontinuity at any point within the encoder’s entire measuring range. By default, MTBase will be set to the lowest possible value for the parameter, i.e. reliably outside of the encoder’s value range: In this case, the full bipolar range will remain unaffected, as values will never fall below this MTBase threshold (see Section ""Channel 1: Interface X7"" on page 59).

- P 548[0] - ENC_CH1_MTEnable = MultiTurn as SingleTurn
- The MTEnable parameter makes it possible to use multi-turn encoders as single-turn encoders for test purposes. Negative logic: Default MTEnable = 0 means ""MultiTurn-Enable ON"".

P 549[0] - ENC_CH1_Corr = Signal correction type
- The GPOC routine used for track signal correction purposes for sine/cosine signals is used to compensate for systematic errors. The routine is controlled with the Corr and CorrVal parameters (see Section ""Signal correction GPOC (Gain Phase Offset Correction)"" on page 74).

P 551[0] - ENC_CH1_EncObsMin = Encoder monitoring minimum, sqrt (a^2+b^2)
- The parameter EncObsMin is used to scale the Sin/Cos wire break monitoring and represents the “downwards threshold” for an error message. The default setting is 0.2, corresponding to approx. ",How does the P 548[0] - ENC_CH1_MTEnable parameter affect multi-turn encoder usage?,A3,"It provides flexibility in encoder testing by toggling between multi-turn and single-turn modes, with 0 enabling the full multi-turn range.",2.078125,2.21875,3.40625,1.609375,0.69140625
3,msd_servo_drive.txt,20,02f242a213dfa4411d028ce46dfba16a3f97395fa25788fcbaea1715e779d934,"), consult with your project supervisor or the Helpline provided by Moog before using any special SSI protocol modes.

# 6.5.2 EnDat (cyclical) X7

Ch1: ENDAT(4) - Cyclical EnDat (2.1 or 2.2) EnDat is a digital encoder interface developed by HEIDENHAIN. For more details, please visit www.heidenhain.de and go to ►Documentation ►Fundamentals ►Interfaces ►EnDat 2.2.

The software versions required to run the EnDat encoder interface are the standard software versions for the MSD Servo Drive and MSD Single-Axis Servo Drive Compact.

MOOG ID No.:CB40859-001 Date:11/2020

# 6 Encoder

NOTE

- Please note the limitations that apply when running EnDat and SSI encoders (see Section ""Limiting for EnDat and SSI"" on page 52).

When using linear encoders, P 554[0] - ENC_CH1_DigitalResolution is used instead of P 543[0] - ENC_CH1_MultiT and P 544[0] - ENC_CH1_SingleT (which are used for rotary encoders). The values will be read from the EnDat encoder and written to the aforementioned parameters.

- P 543[0] - ENC_CH1_MultiT
- The number ""n"" of multiturn bits defines the measuring range in 2n increments per encoder shaft revolution; maximum travel until overflow; maximum travel within which the absolute value initialization can be unambiguous. In the case of single-turn encoders, MultiT = 0.
- P 544[0] - ENC_CH1_SingleT
- The number ""n"" of single-turn bits corresponds to the encoder’s digital resolution in 2n increments per encoder shaft revolution.
- P 554[0] - ENC_CH1_DigitalResolution
- This is the length of an increment, in nanometres, of the encoder’s digitally transmitted position value. This value is read from the EnDat linear head.

In the case of linear encoders, the number n of transmitted position bits from the encoder will be found in SingleT only! 2n * DigitalResolution yields the maximum travel in nanometres (for the encoder head).

P 640 - ENC_ENDAT is intended for additional information, but is normally not needed. This parameter does not have a Ch1 or Ch3 prefix for the encoder channel in the name, as it applies to both encoder channels. Although usually not needed, the parameter is helpful or required in the following cases:

1. Special EnDat encoder with diagnostics for evaluation
In this case, the valuation numbers from the encoder are read cyclically via additional information. Only the valuation numbers that the encoder supports.

# 6 Encoder

MOOG ID No.:CB40859-001 Date:11/2020

will be read. During the initialization process, the system will read the encoder to determine which valuation numbers it supports. When P 640[0] - ENDAT_Select = 1, the function will be enabled in the controller and the internal diagnostics in the EnDaT encoder will be enabled as well. The EnDat encoder will keep this setting even after being powered off. To explicitly disable the internal diagnostics in the EnDat encoder, set P 640[0] - ENDAT_Select to 2.

# 2. Evaluation of internal warnings

In this scenario, certain internal warnings from the encoder will be read from the encoder via additional information. Only the warnings that both the encoder and the Servo Drive’s software support will be read. During the initialization process, the system will read the encoder to determine which warnings it supports. When P 640[0] - ENDAT_Select = 3, the function will be enabled in the controller.

**Table 6.7: Channel 1 encoder configuration (X7) - EnDat parameters**
|ID|Index Name|Unit|Description|
|---|---|---|---|
|505|0 ENC_CH1_Sel|= ENDAT(4)| |
|543|0 ENC_CH1_MultiT|Number of MultiTurn bits (absolute encoder)| |
|544|0 ENC_CH1_SingleT|Number of SingleTurn bits (absolute encoder)| |
|547|0 ENC_CH1_MTBase|Definition of point of discontinuity in multi-turn range| |
|548|0 ENC_CH1_MTEnable|1: Use Multi-turn encoder as a single-turn encoder| |
|616|0 ENC_CH1_CycleCount|Position encoder sampling cycle (n x 125 μsec)| |
|598|0 ENC_CH1_Position|inc|Position encoder channel 1|
|554|0 ENC_CH1_|nm|Length of one increment (linear absolute encoder)|
|640|ENC_ENDAT| |EnDat additional (additional information)|
|640|0 ENDAT_Select|0=off|EnDat function selection, 1/2=diagnosis on/off, 3=warnings, FF=lock|
|640|1 ENDAT_DiagCount|u16|count new diagnosis block header|
|640|2 ENDAT_BWZ_1|lowbyte|vn1: incremental track|
|640|3 ENDAT_BWZ_3|lowbyte|vn3: absolute track|
|640|4 ENDAT_BWZ_4|lowbyte|vn4: position value formation|
|640|5 ENDAT_Status| |EnDat additional status output|
|640|6 ENDAT_Z1_Sel| |EnDat additional information 1 type selection|

**Table 6.7: Overwrite Channel 1 encoder configuration (X7) - EnDat parameters (continue)**
|ID|Index Name|Unit|Description|
|---|---|---|---|
|640|7 ENDAT_Z1_1| |Z1 info: dword 1|
|640|8 ENDAT_Z1_2| |Z1 info: dword 2|
|640|9 ENDAT_Z1_3| |Z1 info: dword 3|
|640|10 ENDAT_Z1_4| |Z1 info: dword 4|
|640|11 ENDAT_Z2_Sel| |EnDat additional information 2 type selection|
|640|12 ENDAT_Z2_1| |Z2 info: dword 1|
|640|13 ENDAT_Z2_2| |Z2 info: dword 2|
|640|14 ENDAT_Z2_3| |Z2 info: dword 3|
|640|15 ENDAT_Z2_4| |Z2 info: dword 4|
|640|16 ENDAT_Mode1|0=off|EnDat additional mode 1 selection|
|640|17 ENDAT_Mode2| |EnDat additional mode 2 selection|
|640|18 ENDAT_Mode3| |EnDat additional mode 3 selection|
|640|19 ENDAT_Mode4| |EnDat additional mode 4 selection|
|640|20 ENDAT_res1| |reserved 1|
|640|21 ENDAT_res2| |reserved 2|
|640|22 ENDAT_res3| |reserved 3|
|640|23 ENDAT_HwSyncStop|0=SyncOn|EnDat cyclic hw sync, stop/start 1/0|
|640|24 ENDAT_CyclCount| |call counter of cyclic function|
|640|25 ENDAT_BWZ_Supported| |vn supported (bit3=vn4, bit2=vn3, bit0=vn1)|
|640|26 ENDAT_BWZ1_| |vn1: bits[7..0] threshold level, bits[31..16]|
|640|27 ThresholdLevel| |how often number|
|640|28 ENDAT_BWZ3_| |vn3: bits[7..0] threshold level, bits[31..16]|
|640|29 ThresholdLevel| |how often number|
|640|30 ENDAT_BWZ4_| |vn4: bits[7..0] threshold level, bits[31..16]|
|640|31 ThresholdLevel| |how often number|
|640|32 ENDAT_BWZ_TEST_| |vn: bits[15..12] 'F', bits[11..8] vn.no., bits [7..0] vn overwrite value|

# 6.5.3 Hall sensor X7

Ch1: HALL(5) - Digital hall signals

Ch1: HALL_TTL(7) - Digital hall signals

NOTE

l The operation and configuration of Hall effect sensors is reserved for special applications. Consult with Moog if needed.

# 6.5.4 Sin/Cos / TTL X7

# 6.5.4.1 TTL encoder

Ch1: TTL(3) - TTL signals

TTL encoders are ...

- a. ... ... usually pure incremental encoders without an absolute value interface.
- b. In this case, P 540[0] - ENC_CH1_Abs must be set to OFF(0). ... ... in a few exceptional cases, incremental encoders with an SSI absolute value interface. In this case, P 540[0] - ENC_CH1_Abs must be accordingly set to SSI(1) (SSI_CONT(4) in special cases), so that it will be possible to read the absolute encoder position for the absolute value initialization routine once during the initialization phase.

# 6.5.4.1.1 Pure TTL incremental encoder

Set P 505[0] - ENC_CH1_Sel to TTL(3) and P 540[0] - ENC_CH1_Abs to OFF(0) when using pure TTL encoders, i.e. encoders without an absolute value interface but with a TTL zero pulse.

Linear TTL encoders are run as rotary encoders. For linear motor operation, P 542 [0] - ENC_CH1_Lines and the encoder gearing (see the “Encoder gearing” section) are used to establish the ratio for the linear motor’s pole pair subdivision (North-North) for commutation. 1 x North-North corresponds to one revolution from Lines. In this case, the motor pole pair number must be set to 1. Moreover, P 553[0] - ENC_CH1_PeriodLen is not used in this case.

The TTL interface accepts various TTL signal types, which can be selected using P 558[0] - ENC_CH1_TTL_SignalType:

- (0)AF_B - A/B tracks (forward counting, X4 encoding) - AB
- (1)AR_B - A/B tracks (reverse counting, X4 encoding) - AB_inv
- (2)ABDFN - A: Clock (falling edge), B: Direction (1 = positive) - PulseDir
- (3)ABDRP - A: Clock (rising edge), B: Direction (1 = negative) - PulseDir_inv
- (4)reserved

A maximum interpolation period, in ms (milliseconds), can be configured for the TTL interface using P 601[0] - ENC_CH1_Period. Within this context, Period is the maximum time of “no activity” since the last TTL counter event:

- Period = 0: Function disabled (default)
- Period > 0 (=n ms): If no counter event is registered in n ms, the speed will be set to 0.

# Zero pulse

There is no parameter for activating the zero pulse evaluation here, as this evaluation is controlled exclusively based on the homing mode (see Section ""Homing"" on page 249). However, setting P 541[0] - ENC_CH1_NpTest to 1 provides a test mode that can be used during commissioning in order to be able to activate the zero pulse evaluation even without homing. Scope signals 1014 and 1016 can be used to view a received zero pulse within this context. This test mode must be disabled during normal operation (P 541[0] = 0).

# Commutation

Motor operation with pure incremental encoders needs for the auto commutation function to be enabled without fail. For details see Section ""Synchronous motor auto commutation"" on page 156.

# 6.5.4.1.2 TTL incremental encoder with SSI absolute value interface

See Section ""Sin/Cos incremental encoders with absolute value interface"" on page 65 and in special Section ""SSI absolute value interface"" on page 67.

MSD ServoDrive - DeviceHelp

# 6 Encoder

MOOG ID No.:CB40859-001 Date:11/2020 MSD ServoDrive - DeviceHelp 64

|ID|Index Name|Unit|Description|
|---|---|---|---|
|505|0|ENC_CH1_Sel = 3|Encoder selection set to TTL(3)|
|510|0|ENC_CH1_Num|Encoder gearing: Numerator Ch1: SINCOS(1) - Sin/Cos signals|
|511|0|ENC_CH1_Denom|Encoder gearing: Denominator|
|540|0|ENC_CH1_Abs|Selection of absolute value interface Sin/Cos encoders can ...|
|541|0|ENC_CH1_NpTest|ENC CH1, TEST-MODE: Index pulse signal(s) to Scope|
|542|0|ENC_CH1_lines|Number of lines (Sin/Cos / TTL encoders) a. Be pure incremental encoders without an absolute value interface. In this|
|558|0|ENC_CH1_TTL_SignalType|Channel 1: TTL signal selection case, P 540[0] - ENC_CH1_Abs must be set to OFF(0).|
|601|0|ENC_CH1_Period|Maximum period of interpolation (TTL encoder)|
|616|0|ENC_CH1_CycleCount|Sampling cycle in: n x 125 μ (microseconds) b. Be incremental encoders with an absolute value interface. In this case,|

Table 6.8: Parameters for Channel 1 (X7) - TTL encoder

ENC_CH1_Abs must be accordingly set to SSI(1), EnDat(2), HIPER(3) or, in special cases, SSI_CONT(4) so that it will be possible to read the absolute encoder position for the absolute value initialization routine once during the initialization phase.

# 6.5.4.2.1 Purely Sin/Cos incremental encoders

To run these encoders as purely incremental encoders with a zero pulse on encoder channel Ch1 (without an absolute value interface), the approach is basically the same as for purely TTL operation (see Section ""TTL encoder"" on page 63). The same parameters apply.

However, there are the following differences:

- a. There are no different signal types for the Sin/Cos signal (always 1 Vss for cosine and sine).
- b. The zero pulse is the analog zero pulse typical of Sin/Cos encoders (see the “Connection for high-resolution encoders” section in the operation manual MSD Servo Drive Single-Axis System, for example).

# 6.5.4.2.2 Linear Sin/Cos

|ID|Index Name|Unit|Description|
|---|---|---|---|
|542|ENC_CH1_lines| |Number of Lines (Sin/Cos / TTL encoders)|
|543|ENC_CH1_MultiT| |Number of MultiTurn bits (absolute encoder)|
|544|ENC_CH1_SingleT| |Number of SingleTurn bits (absolute encoder)|
|545|ENC_CH1_Code| |Code selection (SSI encoder) (binary, gray)|
|546|ENC_CH1_Mode| |Mode selection (SSI encoder)|
|547|ENC_CH1_MTBase| |Definition of point of discontinuity in multi-turn range|
|548|ENC_CH1_MTEnable| |Enable MultiTurn use (negative logic, 1=MToff)|
|549|ENC_CH1_Corr| |Signal correction type|
|550|ENC_CH1_CorrVal|0-4|Signal correction values|
|551|ENC_CH1_EncObsMin| |Encoder monitoring minimum, sqrt(a^2+b^2)|
|552|ENC_CH1_AbsEncStatus| |Error and status codes (absolute encoder)|

# 6.5.4.2.3 Signal correction (GPOC)

|ID|Index Name|Unit|Description|
|---|---|---|---|
|553|ENC_CH1_PeriodLen|nm|Length of signal period (Sin/Cos linear encoder)|
|554|ENC_CH1_DigitalResolution|nm|Length of one increment (linear absolute encoder)|
|555|ENC_CH1_Info| |Encoder information|
|616|ENC_CH1_CycleCount| |Sampling cycle in: n x 125 μ (microseconds)|
|610|ENC_CH1_NominalIncrementA| |Sign. Nominal increment A (distance coded abs. per. encoder)|
|611|ENC_CH1_NominalIncrementB| |Sign. Nominal increment B (distance coded abs. per. encoder)|
|1900|ENC_ETS| |ETS mode, electronic nameplate|

# 6.5.4.2.4 Sin/Cos incremental encoders with absolute value interface

The following table lists the parameters for cyclical Sin/Cos operation on encoder channel Ch 1 with one-time reading of the absolute encoder position via the absolute value interface, i.e. without a zero pulse:

|ID|Index Name|Unit|Description|
|---|---|---|---|
|505|ENC_CH1_Sel|1|Encoder selection set to SINCOS(1)|
|510|ENC_CH1_Num| |Encoder gearing: Numerator|
|511|ENC_CH1_Denom| |Encoder gearing: Denominator|
|540|ENC_CH1_Abs| |Absolute value interface selection (one-time reading)|

Table 6.9: Parameters for channel 1 (X7) - Sin/Cos encoder

The Sel, Num, Denom, Abs, Lines, MultiT, SingleT and CorrVal parameters are self-explanatory.

The Code and Mode parameters are described in Section ""SSI (cyclical) X7"" on page 69.

P 547[0] - ENC_CH1_MTBase = Minimum MultiTurn position

The MTBase parameter is used to set a position in the multi-turn encoder’s travel path that defines the point of discontinuity (overflow/underflow) for the absolute value initialization (that is, the “multi-turn basis”). Assuming a bipolar encoder measuring range, all position values that fall below MTBase will be shifted “up” (the whole MT range will be added to them once).

MOOG ID No.:CB40859-001 Date:11/2020

MSD ServoDrive - DeviceHelp

# 6 Encoder

MOOG ID No.:CB40859-001 Date:11/2020

method makes it possible to place the point of discontinuity at any point within the encoder’s entire measuring range. By default, MTBase will be set to the lowest possible value for the parameter, i.e. reliably outside of the encoder’s value range: In this case, the full bipolar range will remain unaffected, as values will never fall below this MTBase threshold (see Section ""Channel 1: Interface X7"" on page 59).

- P 548[0] - ENC_CH1_MTEnable = MultiTurn as SingleTurn
- The MTEnable parameter makes it possible to use multi-turn encoders as single-turn encoders for test purposes. Negative logic: Default MTEnable = 0 means ""MultiTurn-Enable ON"".

P 549[0] - ENC_CH1_Corr = Signal correction type
- The GPOC routine used for track signal correction purposes for sine/cosine signals is used to compensate for systematic errors. The routine is controlled with the Corr and CorrVal parameters (see Section ""Signal correction GPOC (Gain Phase Offset Correction)"" on page 74).

P 551[0] - ENC_CH1_EncObsMin = Encoder monitoring minimum, sqrt (a^2+b^2)
- The parameter EncObsMin is used to scale the Sin/Cos wire break monitoring and represents the “downwards threshold” for an error message. The default setting is 0.2, corresponding to approx. ",How does the P 548[0] - ENC_CH1_MTEnable parameter affect multi-turn encoder usage?,A4,"For diagnostic purposes, setting P 548[0] to 1 turns off multi-turn capabilities, allowing the encoder to operate in a single-turn mode.",2.28125,2.453125,3.671875,1.609375,0.68359375
4,msd_servo_drive.txt,20,02f242a213dfa4411d028ce46dfba16a3f97395fa25788fcbaea1715e779d934,"), consult with your project supervisor or the Helpline provided by Moog before using any special SSI protocol modes.

# 6.5.2 EnDat (cyclical) X7

Ch1: ENDAT(4) - Cyclical EnDat (2.1 or 2.2) EnDat is a digital encoder interface developed by HEIDENHAIN. For more details, please visit www.heidenhain.de and go to ►Documentation ►Fundamentals ►Interfaces ►EnDat 2.2.

The software versions required to run the EnDat encoder interface are the standard software versions for the MSD Servo Drive and MSD Single-Axis Servo Drive Compact.

MOOG ID No.:CB40859-001 Date:11/2020

# 6 Encoder

NOTE

- Please note the limitations that apply when running EnDat and SSI encoders (see Section ""Limiting for EnDat and SSI"" on page 52).

When using linear encoders, P 554[0] - ENC_CH1_DigitalResolution is used instead of P 543[0] - ENC_CH1_MultiT and P 544[0] - ENC_CH1_SingleT (which are used for rotary encoders). The values will be read from the EnDat encoder and written to the aforementioned parameters.

- P 543[0] - ENC_CH1_MultiT
- The number ""n"" of multiturn bits defines the measuring range in 2n increments per encoder shaft revolution; maximum travel until overflow; maximum travel within which the absolute value initialization can be unambiguous. In the case of single-turn encoders, MultiT = 0.
- P 544[0] - ENC_CH1_SingleT
- The number ""n"" of single-turn bits corresponds to the encoder’s digital resolution in 2n increments per encoder shaft revolution.
- P 554[0] - ENC_CH1_DigitalResolution
- This is the length of an increment, in nanometres, of the encoder’s digitally transmitted position value. This value is read from the EnDat linear head.

In the case of linear encoders, the number n of transmitted position bits from the encoder will be found in SingleT only! 2n * DigitalResolution yields the maximum travel in nanometres (for the encoder head).

P 640 - ENC_ENDAT is intended for additional information, but is normally not needed. This parameter does not have a Ch1 or Ch3 prefix for the encoder channel in the name, as it applies to both encoder channels. Although usually not needed, the parameter is helpful or required in the following cases:

1. Special EnDat encoder with diagnostics for evaluation
In this case, the valuation numbers from the encoder are read cyclically via additional information. Only the valuation numbers that the encoder supports.

# 6 Encoder

MOOG ID No.:CB40859-001 Date:11/2020

will be read. During the initialization process, the system will read the encoder to determine which valuation numbers it supports. When P 640[0] - ENDAT_Select = 1, the function will be enabled in the controller and the internal diagnostics in the EnDaT encoder will be enabled as well. The EnDat encoder will keep this setting even after being powered off. To explicitly disable the internal diagnostics in the EnDat encoder, set P 640[0] - ENDAT_Select to 2.

# 2. Evaluation of internal warnings

In this scenario, certain internal warnings from the encoder will be read from the encoder via additional information. Only the warnings that both the encoder and the Servo Drive’s software support will be read. During the initialization process, the system will read the encoder to determine which warnings it supports. When P 640[0] - ENDAT_Select = 3, the function will be enabled in the controller.

**Table 6.7: Channel 1 encoder configuration (X7) - EnDat parameters**
|ID|Index Name|Unit|Description|
|---|---|---|---|
|505|0 ENC_CH1_Sel|= ENDAT(4)| |
|543|0 ENC_CH1_MultiT|Number of MultiTurn bits (absolute encoder)| |
|544|0 ENC_CH1_SingleT|Number of SingleTurn bits (absolute encoder)| |
|547|0 ENC_CH1_MTBase|Definition of point of discontinuity in multi-turn range| |
|548|0 ENC_CH1_MTEnable|1: Use Multi-turn encoder as a single-turn encoder| |
|616|0 ENC_CH1_CycleCount|Position encoder sampling cycle (n x 125 μsec)| |
|598|0 ENC_CH1_Position|inc|Position encoder channel 1|
|554|0 ENC_CH1_|nm|Length of one increment (linear absolute encoder)|
|640|ENC_ENDAT| |EnDat additional (additional information)|
|640|0 ENDAT_Select|0=off|EnDat function selection, 1/2=diagnosis on/off, 3=warnings, FF=lock|
|640|1 ENDAT_DiagCount|u16|count new diagnosis block header|
|640|2 ENDAT_BWZ_1|lowbyte|vn1: incremental track|
|640|3 ENDAT_BWZ_3|lowbyte|vn3: absolute track|
|640|4 ENDAT_BWZ_4|lowbyte|vn4: position value formation|
|640|5 ENDAT_Status| |EnDat additional status output|
|640|6 ENDAT_Z1_Sel| |EnDat additional information 1 type selection|

**Table 6.7: Overwrite Channel 1 encoder configuration (X7) - EnDat parameters (continue)**
|ID|Index Name|Unit|Description|
|---|---|---|---|
|640|7 ENDAT_Z1_1| |Z1 info: dword 1|
|640|8 ENDAT_Z1_2| |Z1 info: dword 2|
|640|9 ENDAT_Z1_3| |Z1 info: dword 3|
|640|10 ENDAT_Z1_4| |Z1 info: dword 4|
|640|11 ENDAT_Z2_Sel| |EnDat additional information 2 type selection|
|640|12 ENDAT_Z2_1| |Z2 info: dword 1|
|640|13 ENDAT_Z2_2| |Z2 info: dword 2|
|640|14 ENDAT_Z2_3| |Z2 info: dword 3|
|640|15 ENDAT_Z2_4| |Z2 info: dword 4|
|640|16 ENDAT_Mode1|0=off|EnDat additional mode 1 selection|
|640|17 ENDAT_Mode2| |EnDat additional mode 2 selection|
|640|18 ENDAT_Mode3| |EnDat additional mode 3 selection|
|640|19 ENDAT_Mode4| |EnDat additional mode 4 selection|
|640|20 ENDAT_res1| |reserved 1|
|640|21 ENDAT_res2| |reserved 2|
|640|22 ENDAT_res3| |reserved 3|
|640|23 ENDAT_HwSyncStop|0=SyncOn|EnDat cyclic hw sync, stop/start 1/0|
|640|24 ENDAT_CyclCount| |call counter of cyclic function|
|640|25 ENDAT_BWZ_Supported| |vn supported (bit3=vn4, bit2=vn3, bit0=vn1)|
|640|26 ENDAT_BWZ1_| |vn1: bits[7..0] threshold level, bits[31..16]|
|640|27 ThresholdLevel| |how often number|
|640|28 ENDAT_BWZ3_| |vn3: bits[7..0] threshold level, bits[31..16]|
|640|29 ThresholdLevel| |how often number|
|640|30 ENDAT_BWZ4_| |vn4: bits[7..0] threshold level, bits[31..16]|
|640|31 ThresholdLevel| |how often number|
|640|32 ENDAT_BWZ_TEST_| |vn: bits[15..12] 'F', bits[11..8] vn.no., bits [7..0] vn overwrite value|

# 6.5.3 Hall sensor X7

Ch1: HALL(5) - Digital hall signals

Ch1: HALL_TTL(7) - Digital hall signals

NOTE

l The operation and configuration of Hall effect sensors is reserved for special applications. Consult with Moog if needed.

# 6.5.4 Sin/Cos / TTL X7

# 6.5.4.1 TTL encoder

Ch1: TTL(3) - TTL signals

TTL encoders are ...

- a. ... ... usually pure incremental encoders without an absolute value interface.
- b. In this case, P 540[0] - ENC_CH1_Abs must be set to OFF(0). ... ... in a few exceptional cases, incremental encoders with an SSI absolute value interface. In this case, P 540[0] - ENC_CH1_Abs must be accordingly set to SSI(1) (SSI_CONT(4) in special cases), so that it will be possible to read the absolute encoder position for the absolute value initialization routine once during the initialization phase.

# 6.5.4.1.1 Pure TTL incremental encoder

Set P 505[0] - ENC_CH1_Sel to TTL(3) and P 540[0] - ENC_CH1_Abs to OFF(0) when using pure TTL encoders, i.e. encoders without an absolute value interface but with a TTL zero pulse.

Linear TTL encoders are run as rotary encoders. For linear motor operation, P 542 [0] - ENC_CH1_Lines and the encoder gearing (see the “Encoder gearing” section) are used to establish the ratio for the linear motor’s pole pair subdivision (North-North) for commutation. 1 x North-North corresponds to one revolution from Lines. In this case, the motor pole pair number must be set to 1. Moreover, P 553[0] - ENC_CH1_PeriodLen is not used in this case.

The TTL interface accepts various TTL signal types, which can be selected using P 558[0] - ENC_CH1_TTL_SignalType:

- (0)AF_B - A/B tracks (forward counting, X4 encoding) - AB
- (1)AR_B - A/B tracks (reverse counting, X4 encoding) - AB_inv
- (2)ABDFN - A: Clock (falling edge), B: Direction (1 = positive) - PulseDir
- (3)ABDRP - A: Clock (rising edge), B: Direction (1 = negative) - PulseDir_inv
- (4)reserved

A maximum interpolation period, in ms (milliseconds), can be configured for the TTL interface using P 601[0] - ENC_CH1_Period. Within this context, Period is the maximum time of “no activity” since the last TTL counter event:

- Period = 0: Function disabled (default)
- Period > 0 (=n ms): If no counter event is registered in n ms, the speed will be set to 0.

# Zero pulse

There is no parameter for activating the zero pulse evaluation here, as this evaluation is controlled exclusively based on the homing mode (see Section ""Homing"" on page 249). However, setting P 541[0] - ENC_CH1_NpTest to 1 provides a test mode that can be used during commissioning in order to be able to activate the zero pulse evaluation even without homing. Scope signals 1014 and 1016 can be used to view a received zero pulse within this context. This test mode must be disabled during normal operation (P 541[0] = 0).

# Commutation

Motor operation with pure incremental encoders needs for the auto commutation function to be enabled without fail. For details see Section ""Synchronous motor auto commutation"" on page 156.

# 6.5.4.1.2 TTL incremental encoder with SSI absolute value interface

See Section ""Sin/Cos incremental encoders with absolute value interface"" on page 65 and in special Section ""SSI absolute value interface"" on page 67.

MSD ServoDrive - DeviceHelp

# 6 Encoder

MOOG ID No.:CB40859-001 Date:11/2020 MSD ServoDrive - DeviceHelp 64

|ID|Index Name|Unit|Description|
|---|---|---|---|
|505|0|ENC_CH1_Sel = 3|Encoder selection set to TTL(3)|
|510|0|ENC_CH1_Num|Encoder gearing: Numerator Ch1: SINCOS(1) - Sin/Cos signals|
|511|0|ENC_CH1_Denom|Encoder gearing: Denominator|
|540|0|ENC_CH1_Abs|Selection of absolute value interface Sin/Cos encoders can ...|
|541|0|ENC_CH1_NpTest|ENC CH1, TEST-MODE: Index pulse signal(s) to Scope|
|542|0|ENC_CH1_lines|Number of lines (Sin/Cos / TTL encoders) a. Be pure incremental encoders without an absolute value interface. In this|
|558|0|ENC_CH1_TTL_SignalType|Channel 1: TTL signal selection case, P 540[0] - ENC_CH1_Abs must be set to OFF(0).|
|601|0|ENC_CH1_Period|Maximum period of interpolation (TTL encoder)|
|616|0|ENC_CH1_CycleCount|Sampling cycle in: n x 125 μ (microseconds) b. Be incremental encoders with an absolute value interface. In this case,|

Table 6.8: Parameters for Channel 1 (X7) - TTL encoder

ENC_CH1_Abs must be accordingly set to SSI(1), EnDat(2), HIPER(3) or, in special cases, SSI_CONT(4) so that it will be possible to read the absolute encoder position for the absolute value initialization routine once during the initialization phase.

# 6.5.4.2.1 Purely Sin/Cos incremental encoders

To run these encoders as purely incremental encoders with a zero pulse on encoder channel Ch1 (without an absolute value interface), the approach is basically the same as for purely TTL operation (see Section ""TTL encoder"" on page 63). The same parameters apply.

However, there are the following differences:

- a. There are no different signal types for the Sin/Cos signal (always 1 Vss for cosine and sine).
- b. The zero pulse is the analog zero pulse typical of Sin/Cos encoders (see the “Connection for high-resolution encoders” section in the operation manual MSD Servo Drive Single-Axis System, for example).

# 6.5.4.2.2 Linear Sin/Cos

|ID|Index Name|Unit|Description|
|---|---|---|---|
|542|ENC_CH1_lines| |Number of Lines (Sin/Cos / TTL encoders)|
|543|ENC_CH1_MultiT| |Number of MultiTurn bits (absolute encoder)|
|544|ENC_CH1_SingleT| |Number of SingleTurn bits (absolute encoder)|
|545|ENC_CH1_Code| |Code selection (SSI encoder) (binary, gray)|
|546|ENC_CH1_Mode| |Mode selection (SSI encoder)|
|547|ENC_CH1_MTBase| |Definition of point of discontinuity in multi-turn range|
|548|ENC_CH1_MTEnable| |Enable MultiTurn use (negative logic, 1=MToff)|
|549|ENC_CH1_Corr| |Signal correction type|
|550|ENC_CH1_CorrVal|0-4|Signal correction values|
|551|ENC_CH1_EncObsMin| |Encoder monitoring minimum, sqrt(a^2+b^2)|
|552|ENC_CH1_AbsEncStatus| |Error and status codes (absolute encoder)|

# 6.5.4.2.3 Signal correction (GPOC)

|ID|Index Name|Unit|Description|
|---|---|---|---|
|553|ENC_CH1_PeriodLen|nm|Length of signal period (Sin/Cos linear encoder)|
|554|ENC_CH1_DigitalResolution|nm|Length of one increment (linear absolute encoder)|
|555|ENC_CH1_Info| |Encoder information|
|616|ENC_CH1_CycleCount| |Sampling cycle in: n x 125 μ (microseconds)|
|610|ENC_CH1_NominalIncrementA| |Sign. Nominal increment A (distance coded abs. per. encoder)|
|611|ENC_CH1_NominalIncrementB| |Sign. Nominal increment B (distance coded abs. per. encoder)|
|1900|ENC_ETS| |ETS mode, electronic nameplate|

# 6.5.4.2.4 Sin/Cos incremental encoders with absolute value interface

The following table lists the parameters for cyclical Sin/Cos operation on encoder channel Ch 1 with one-time reading of the absolute encoder position via the absolute value interface, i.e. without a zero pulse:

|ID|Index Name|Unit|Description|
|---|---|---|---|
|505|ENC_CH1_Sel|1|Encoder selection set to SINCOS(1)|
|510|ENC_CH1_Num| |Encoder gearing: Numerator|
|511|ENC_CH1_Denom| |Encoder gearing: Denominator|
|540|ENC_CH1_Abs| |Absolute value interface selection (one-time reading)|

Table 6.9: Parameters for channel 1 (X7) - Sin/Cos encoder

The Sel, Num, Denom, Abs, Lines, MultiT, SingleT and CorrVal parameters are self-explanatory.

The Code and Mode parameters are described in Section ""SSI (cyclical) X7"" on page 69.

P 547[0] - ENC_CH1_MTBase = Minimum MultiTurn position

The MTBase parameter is used to set a position in the multi-turn encoder’s travel path that defines the point of discontinuity (overflow/underflow) for the absolute value initialization (that is, the “multi-turn basis”). Assuming a bipolar encoder measuring range, all position values that fall below MTBase will be shifted “up” (the whole MT range will be added to them once).

MOOG ID No.:CB40859-001 Date:11/2020

MSD ServoDrive - DeviceHelp

# 6 Encoder

MOOG ID No.:CB40859-001 Date:11/2020

method makes it possible to place the point of discontinuity at any point within the encoder’s entire measuring range. By default, MTBase will be set to the lowest possible value for the parameter, i.e. reliably outside of the encoder’s value range: In this case, the full bipolar range will remain unaffected, as values will never fall below this MTBase threshold (see Section ""Channel 1: Interface X7"" on page 59).

- P 548[0] - ENC_CH1_MTEnable = MultiTurn as SingleTurn
- The MTEnable parameter makes it possible to use multi-turn encoders as single-turn encoders for test purposes. Negative logic: Default MTEnable = 0 means ""MultiTurn-Enable ON"".

P 549[0] - ENC_CH1_Corr = Signal correction type
- The GPOC routine used for track signal correction purposes for sine/cosine signals is used to compensate for systematic errors. The routine is controlled with the Corr and CorrVal parameters (see Section ""Signal correction GPOC (Gain Phase Offset Correction)"" on page 74).

P 551[0] - ENC_CH1_EncObsMin = Encoder monitoring minimum, sqrt (a^2+b^2)
- The parameter EncObsMin is used to scale the Sin/Cos wire break monitoring and represents the “downwards threshold” for an error message. The default setting is 0.2, corresponding to approx. ",How does the P 548[0] - ENC_CH1_MTEnable parameter affect multi-turn encoder usage?,A5,"The parameter offers a way to simplify encoder testing by temporarily disabling multi-turn functionality, with normal operation requiring it to be set to 0.",2.078125,2.203125,3.53125,1.75,0.609375
5,msd_servo_drive.txt,20,02f242a213dfa4411d028ce46dfba16a3f97395fa25788fcbaea1715e779d934,"), consult with your project supervisor or the Helpline provided by Moog before using any special SSI protocol modes.

# 6.5.2 EnDat (cyclical) X7

Ch1: ENDAT(4) - Cyclical EnDat (2.1 or 2.2) EnDat is a digital encoder interface developed by HEIDENHAIN. For more details, please visit www.heidenhain.de and go to ►Documentation ►Fundamentals ►Interfaces ►EnDat 2.2.

The software versions required to run the EnDat encoder interface are the standard software versions for the MSD Servo Drive and MSD Single-Axis Servo Drive Compact.

MOOG ID No.:CB40859-001 Date:11/2020

# 6 Encoder

NOTE

- Please note the limitations that apply when running EnDat and SSI encoders (see Section ""Limiting for EnDat and SSI"" on page 52).

When using linear encoders, P 554[0] - ENC_CH1_DigitalResolution is used instead of P 543[0] - ENC_CH1_MultiT and P 544[0] - ENC_CH1_SingleT (which are used for rotary encoders). The values will be read from the EnDat encoder and written to the aforementioned parameters.

- P 543[0] - ENC_CH1_MultiT
- The number ""n"" of multiturn bits defines the measuring range in 2n increments per encoder shaft revolution; maximum travel until overflow; maximum travel within which the absolute value initialization can be unambiguous. In the case of single-turn encoders, MultiT = 0.
- P 544[0] - ENC_CH1_SingleT
- The number ""n"" of single-turn bits corresponds to the encoder’s digital resolution in 2n increments per encoder shaft revolution.
- P 554[0] - ENC_CH1_DigitalResolution
- This is the length of an increment, in nanometres, of the encoder’s digitally transmitted position value. This value is read from the EnDat linear head.

In the case of linear encoders, the number n of transmitted position bits from the encoder will be found in SingleT only! 2n * DigitalResolution yields the maximum travel in nanometres (for the encoder head).

P 640 - ENC_ENDAT is intended for additional information, but is normally not needed. This parameter does not have a Ch1 or Ch3 prefix for the encoder channel in the name, as it applies to both encoder channels. Although usually not needed, the parameter is helpful or required in the following cases:

1. Special EnDat encoder with diagnostics for evaluation
In this case, the valuation numbers from the encoder are read cyclically via additional information. Only the valuation numbers that the encoder supports.

# 6 Encoder

MOOG ID No.:CB40859-001 Date:11/2020

will be read. During the initialization process, the system will read the encoder to determine which valuation numbers it supports. When P 640[0] - ENDAT_Select = 1, the function will be enabled in the controller and the internal diagnostics in the EnDaT encoder will be enabled as well. The EnDat encoder will keep this setting even after being powered off. To explicitly disable the internal diagnostics in the EnDat encoder, set P 640[0] - ENDAT_Select to 2.

# 2. Evaluation of internal warnings

In this scenario, certain internal warnings from the encoder will be read from the encoder via additional information. Only the warnings that both the encoder and the Servo Drive’s software support will be read. During the initialization process, the system will read the encoder to determine which warnings it supports. When P 640[0] - ENDAT_Select = 3, the function will be enabled in the controller.

**Table 6.7: Channel 1 encoder configuration (X7) - EnDat parameters**
|ID|Index Name|Unit|Description|
|---|---|---|---|
|505|0 ENC_CH1_Sel|= ENDAT(4)| |
|543|0 ENC_CH1_MultiT|Number of MultiTurn bits (absolute encoder)| |
|544|0 ENC_CH1_SingleT|Number of SingleTurn bits (absolute encoder)| |
|547|0 ENC_CH1_MTBase|Definition of point of discontinuity in multi-turn range| |
|548|0 ENC_CH1_MTEnable|1: Use Multi-turn encoder as a single-turn encoder| |
|616|0 ENC_CH1_CycleCount|Position encoder sampling cycle (n x 125 μsec)| |
|598|0 ENC_CH1_Position|inc|Position encoder channel 1|
|554|0 ENC_CH1_|nm|Length of one increment (linear absolute encoder)|
|640|ENC_ENDAT| |EnDat additional (additional information)|
|640|0 ENDAT_Select|0=off|EnDat function selection, 1/2=diagnosis on/off, 3=warnings, FF=lock|
|640|1 ENDAT_DiagCount|u16|count new diagnosis block header|
|640|2 ENDAT_BWZ_1|lowbyte|vn1: incremental track|
|640|3 ENDAT_BWZ_3|lowbyte|vn3: absolute track|
|640|4 ENDAT_BWZ_4|lowbyte|vn4: position value formation|
|640|5 ENDAT_Status| |EnDat additional status output|
|640|6 ENDAT_Z1_Sel| |EnDat additional information 1 type selection|

**Table 6.7: Overwrite Channel 1 encoder configuration (X7) - EnDat parameters (continue)**
|ID|Index Name|Unit|Description|
|---|---|---|---|
|640|7 ENDAT_Z1_1| |Z1 info: dword 1|
|640|8 ENDAT_Z1_2| |Z1 info: dword 2|
|640|9 ENDAT_Z1_3| |Z1 info: dword 3|
|640|10 ENDAT_Z1_4| |Z1 info: dword 4|
|640|11 ENDAT_Z2_Sel| |EnDat additional information 2 type selection|
|640|12 ENDAT_Z2_1| |Z2 info: dword 1|
|640|13 ENDAT_Z2_2| |Z2 info: dword 2|
|640|14 ENDAT_Z2_3| |Z2 info: dword 3|
|640|15 ENDAT_Z2_4| |Z2 info: dword 4|
|640|16 ENDAT_Mode1|0=off|EnDat additional mode 1 selection|
|640|17 ENDAT_Mode2| |EnDat additional mode 2 selection|
|640|18 ENDAT_Mode3| |EnDat additional mode 3 selection|
|640|19 ENDAT_Mode4| |EnDat additional mode 4 selection|
|640|20 ENDAT_res1| |reserved 1|
|640|21 ENDAT_res2| |reserved 2|
|640|22 ENDAT_res3| |reserved 3|
|640|23 ENDAT_HwSyncStop|0=SyncOn|EnDat cyclic hw sync, stop/start 1/0|
|640|24 ENDAT_CyclCount| |call counter of cyclic function|
|640|25 ENDAT_BWZ_Supported| |vn supported (bit3=vn4, bit2=vn3, bit0=vn1)|
|640|26 ENDAT_BWZ1_| |vn1: bits[7..0] threshold level, bits[31..16]|
|640|27 ThresholdLevel| |how often number|
|640|28 ENDAT_BWZ3_| |vn3: bits[7..0] threshold level, bits[31..16]|
|640|29 ThresholdLevel| |how often number|
|640|30 ENDAT_BWZ4_| |vn4: bits[7..0] threshold level, bits[31..16]|
|640|31 ThresholdLevel| |how often number|
|640|32 ENDAT_BWZ_TEST_| |vn: bits[15..12] 'F', bits[11..8] vn.no., bits [7..0] vn overwrite value|

# 6.5.3 Hall sensor X7

Ch1: HALL(5) - Digital hall signals

Ch1: HALL_TTL(7) - Digital hall signals

NOTE

l The operation and configuration of Hall effect sensors is reserved for special applications. Consult with Moog if needed.

# 6.5.4 Sin/Cos / TTL X7

# 6.5.4.1 TTL encoder

Ch1: TTL(3) - TTL signals

TTL encoders are ...

- a. ... ... usually pure incremental encoders without an absolute value interface.
- b. In this case, P 540[0] - ENC_CH1_Abs must be set to OFF(0). ... ... in a few exceptional cases, incremental encoders with an SSI absolute value interface. In this case, P 540[0] - ENC_CH1_Abs must be accordingly set to SSI(1) (SSI_CONT(4) in special cases), so that it will be possible to read the absolute encoder position for the absolute value initialization routine once during the initialization phase.

# 6.5.4.1.1 Pure TTL incremental encoder

Set P 505[0] - ENC_CH1_Sel to TTL(3) and P 540[0] - ENC_CH1_Abs to OFF(0) when using pure TTL encoders, i.e. encoders without an absolute value interface but with a TTL zero pulse.

Linear TTL encoders are run as rotary encoders. For linear motor operation, P 542 [0] - ENC_CH1_Lines and the encoder gearing (see the “Encoder gearing” section) are used to establish the ratio for the linear motor’s pole pair subdivision (North-North) for commutation. 1 x North-North corresponds to one revolution from Lines. In this case, the motor pole pair number must be set to 1. Moreover, P 553[0] - ENC_CH1_PeriodLen is not used in this case.

The TTL interface accepts various TTL signal types, which can be selected using P 558[0] - ENC_CH1_TTL_SignalType:

- (0)AF_B - A/B tracks (forward counting, X4 encoding) - AB
- (1)AR_B - A/B tracks (reverse counting, X4 encoding) - AB_inv
- (2)ABDFN - A: Clock (falling edge), B: Direction (1 = positive) - PulseDir
- (3)ABDRP - A: Clock (rising edge), B: Direction (1 = negative) - PulseDir_inv
- (4)reserved

A maximum interpolation period, in ms (milliseconds), can be configured for the TTL interface using P 601[0] - ENC_CH1_Period. Within this context, Period is the maximum time of “no activity” since the last TTL counter event:

- Period = 0: Function disabled (default)
- Period > 0 (=n ms): If no counter event is registered in n ms, the speed will be set to 0.

# Zero pulse

There is no parameter for activating the zero pulse evaluation here, as this evaluation is controlled exclusively based on the homing mode (see Section ""Homing"" on page 249). However, setting P 541[0] - ENC_CH1_NpTest to 1 provides a test mode that can be used during commissioning in order to be able to activate the zero pulse evaluation even without homing. Scope signals 1014 and 1016 can be used to view a received zero pulse within this context. This test mode must be disabled during normal operation (P 541[0] = 0).

# Commutation

Motor operation with pure incremental encoders needs for the auto commutation function to be enabled without fail. For details see Section ""Synchronous motor auto commutation"" on page 156.

# 6.5.4.1.2 TTL incremental encoder with SSI absolute value interface

See Section ""Sin/Cos incremental encoders with absolute value interface"" on page 65 and in special Section ""SSI absolute value interface"" on page 67.

MSD ServoDrive - DeviceHelp

# 6 Encoder

MOOG ID No.:CB40859-001 Date:11/2020 MSD ServoDrive - DeviceHelp 64

|ID|Index Name|Unit|Description|
|---|---|---|---|
|505|0|ENC_CH1_Sel = 3|Encoder selection set to TTL(3)|
|510|0|ENC_CH1_Num|Encoder gearing: Numerator Ch1: SINCOS(1) - Sin/Cos signals|
|511|0|ENC_CH1_Denom|Encoder gearing: Denominator|
|540|0|ENC_CH1_Abs|Selection of absolute value interface Sin/Cos encoders can ...|
|541|0|ENC_CH1_NpTest|ENC CH1, TEST-MODE: Index pulse signal(s) to Scope|
|542|0|ENC_CH1_lines|Number of lines (Sin/Cos / TTL encoders) a. Be pure incremental encoders without an absolute value interface. In this|
|558|0|ENC_CH1_TTL_SignalType|Channel 1: TTL signal selection case, P 540[0] - ENC_CH1_Abs must be set to OFF(0).|
|601|0|ENC_CH1_Period|Maximum period of interpolation (TTL encoder)|
|616|0|ENC_CH1_CycleCount|Sampling cycle in: n x 125 μ (microseconds) b. Be incremental encoders with an absolute value interface. In this case,|

Table 6.8: Parameters for Channel 1 (X7) - TTL encoder

ENC_CH1_Abs must be accordingly set to SSI(1), EnDat(2), HIPER(3) or, in special cases, SSI_CONT(4) so that it will be possible to read the absolute encoder position for the absolute value initialization routine once during the initialization phase.

# 6.5.4.2.1 Purely Sin/Cos incremental encoders

To run these encoders as purely incremental encoders with a zero pulse on encoder channel Ch1 (without an absolute value interface), the approach is basically the same as for purely TTL operation (see Section ""TTL encoder"" on page 63). The same parameters apply.

However, there are the following differences:

- a. There are no different signal types for the Sin/Cos signal (always 1 Vss for cosine and sine).
- b. The zero pulse is the analog zero pulse typical of Sin/Cos encoders (see the “Connection for high-resolution encoders” section in the operation manual MSD Servo Drive Single-Axis System, for example).

# 6.5.4.2.2 Linear Sin/Cos

|ID|Index Name|Unit|Description|
|---|---|---|---|
|542|ENC_CH1_lines| |Number of Lines (Sin/Cos / TTL encoders)|
|543|ENC_CH1_MultiT| |Number of MultiTurn bits (absolute encoder)|
|544|ENC_CH1_SingleT| |Number of SingleTurn bits (absolute encoder)|
|545|ENC_CH1_Code| |Code selection (SSI encoder) (binary, gray)|
|546|ENC_CH1_Mode| |Mode selection (SSI encoder)|
|547|ENC_CH1_MTBase| |Definition of point of discontinuity in multi-turn range|
|548|ENC_CH1_MTEnable| |Enable MultiTurn use (negative logic, 1=MToff)|
|549|ENC_CH1_Corr| |Signal correction type|
|550|ENC_CH1_CorrVal|0-4|Signal correction values|
|551|ENC_CH1_EncObsMin| |Encoder monitoring minimum, sqrt(a^2+b^2)|
|552|ENC_CH1_AbsEncStatus| |Error and status codes (absolute encoder)|

# 6.5.4.2.3 Signal correction (GPOC)

|ID|Index Name|Unit|Description|
|---|---|---|---|
|553|ENC_CH1_PeriodLen|nm|Length of signal period (Sin/Cos linear encoder)|
|554|ENC_CH1_DigitalResolution|nm|Length of one increment (linear absolute encoder)|
|555|ENC_CH1_Info| |Encoder information|
|616|ENC_CH1_CycleCount| |Sampling cycle in: n x 125 μ (microseconds)|
|610|ENC_CH1_NominalIncrementA| |Sign. Nominal increment A (distance coded abs. per. encoder)|
|611|ENC_CH1_NominalIncrementB| |Sign. Nominal increment B (distance coded abs. per. encoder)|
|1900|ENC_ETS| |ETS mode, electronic nameplate|

# 6.5.4.2.4 Sin/Cos incremental encoders with absolute value interface

The following table lists the parameters for cyclical Sin/Cos operation on encoder channel Ch 1 with one-time reading of the absolute encoder position via the absolute value interface, i.e. without a zero pulse:

|ID|Index Name|Unit|Description|
|---|---|---|---|
|505|ENC_CH1_Sel|1|Encoder selection set to SINCOS(1)|
|510|ENC_CH1_Num| |Encoder gearing: Numerator|
|511|ENC_CH1_Denom| |Encoder gearing: Denominator|
|540|ENC_CH1_Abs| |Absolute value interface selection (one-time reading)|

Table 6.9: Parameters for channel 1 (X7) - Sin/Cos encoder

The Sel, Num, Denom, Abs, Lines, MultiT, SingleT and CorrVal parameters are self-explanatory.

The Code and Mode parameters are described in Section ""SSI (cyclical) X7"" on page 69.

P 547[0] - ENC_CH1_MTBase = Minimum MultiTurn position

The MTBase parameter is used to set a position in the multi-turn encoder’s travel path that defines the point of discontinuity (overflow/underflow) for the absolute value initialization (that is, the “multi-turn basis”). Assuming a bipolar encoder measuring range, all position values that fall below MTBase will be shifted “up” (the whole MT range will be added to them once).

MOOG ID No.:CB40859-001 Date:11/2020

MSD ServoDrive - DeviceHelp

# 6 Encoder

MOOG ID No.:CB40859-001 Date:11/2020

method makes it possible to place the point of discontinuity at any point within the encoder’s entire measuring range. By default, MTBase will be set to the lowest possible value for the parameter, i.e. reliably outside of the encoder’s value range: In this case, the full bipolar range will remain unaffected, as values will never fall below this MTBase threshold (see Section ""Channel 1: Interface X7"" on page 59).

- P 548[0] - ENC_CH1_MTEnable = MultiTurn as SingleTurn
- The MTEnable parameter makes it possible to use multi-turn encoders as single-turn encoders for test purposes. Negative logic: Default MTEnable = 0 means ""MultiTurn-Enable ON"".

P 549[0] - ENC_CH1_Corr = Signal correction type
- The GPOC routine used for track signal correction purposes for sine/cosine signals is used to compensate for systematic errors. The routine is controlled with the Corr and CorrVal parameters (see Section ""Signal correction GPOC (Gain Phase Offset Correction)"" on page 74).

P 551[0] - ENC_CH1_EncObsMin = Encoder monitoring minimum, sqrt (a^2+b^2)
- The parameter EncObsMin is used to scale the Sin/Cos wire break monitoring and represents the “downwards threshold” for an error message. The default setting is 0.2, corresponding to approx. ",How does the P 554[0] - ENC_CH1_DigitalResolution parameter function in the context of linear encoders?,A1,"P 554[0] - ENC_CH1_DigitalResolution specifies the length of an increment, in nanometers, for the encoder's digitally transmitted position value in linear encoders.",2.84375,2.953125,3.625,1.9375,0.828125
6,msd_servo_drive.txt,20,02f242a213dfa4411d028ce46dfba16a3f97395fa25788fcbaea1715e779d934,"), consult with your project supervisor or the Helpline provided by Moog before using any special SSI protocol modes.

# 6.5.2 EnDat (cyclical) X7

Ch1: ENDAT(4) - Cyclical EnDat (2.1 or 2.2) EnDat is a digital encoder interface developed by HEIDENHAIN. For more details, please visit www.heidenhain.de and go to ►Documentation ►Fundamentals ►Interfaces ►EnDat 2.2.

The software versions required to run the EnDat encoder interface are the standard software versions for the MSD Servo Drive and MSD Single-Axis Servo Drive Compact.

MOOG ID No.:CB40859-001 Date:11/2020

# 6 Encoder

NOTE

- Please note the limitations that apply when running EnDat and SSI encoders (see Section ""Limiting for EnDat and SSI"" on page 52).

When using linear encoders, P 554[0] - ENC_CH1_DigitalResolution is used instead of P 543[0] - ENC_CH1_MultiT and P 544[0] - ENC_CH1_SingleT (which are used for rotary encoders). The values will be read from the EnDat encoder and written to the aforementioned parameters.

- P 543[0] - ENC_CH1_MultiT
- The number ""n"" of multiturn bits defines the measuring range in 2n increments per encoder shaft revolution; maximum travel until overflow; maximum travel within which the absolute value initialization can be unambiguous. In the case of single-turn encoders, MultiT = 0.
- P 544[0] - ENC_CH1_SingleT
- The number ""n"" of single-turn bits corresponds to the encoder’s digital resolution in 2n increments per encoder shaft revolution.
- P 554[0] - ENC_CH1_DigitalResolution
- This is the length of an increment, in nanometres, of the encoder’s digitally transmitted position value. This value is read from the EnDat linear head.

In the case of linear encoders, the number n of transmitted position bits from the encoder will be found in SingleT only! 2n * DigitalResolution yields the maximum travel in nanometres (for the encoder head).

P 640 - ENC_ENDAT is intended for additional information, but is normally not needed. This parameter does not have a Ch1 or Ch3 prefix for the encoder channel in the name, as it applies to both encoder channels. Although usually not needed, the parameter is helpful or required in the following cases:

1. Special EnDat encoder with diagnostics for evaluation
In this case, the valuation numbers from the encoder are read cyclically via additional information. Only the valuation numbers that the encoder supports.

# 6 Encoder

MOOG ID No.:CB40859-001 Date:11/2020

will be read. During the initialization process, the system will read the encoder to determine which valuation numbers it supports. When P 640[0] - ENDAT_Select = 1, the function will be enabled in the controller and the internal diagnostics in the EnDaT encoder will be enabled as well. The EnDat encoder will keep this setting even after being powered off. To explicitly disable the internal diagnostics in the EnDat encoder, set P 640[0] - ENDAT_Select to 2.

# 2. Evaluation of internal warnings

In this scenario, certain internal warnings from the encoder will be read from the encoder via additional information. Only the warnings that both the encoder and the Servo Drive’s software support will be read. During the initialization process, the system will read the encoder to determine which warnings it supports. When P 640[0] - ENDAT_Select = 3, the function will be enabled in the controller.

**Table 6.7: Channel 1 encoder configuration (X7) - EnDat parameters**
|ID|Index Name|Unit|Description|
|---|---|---|---|
|505|0 ENC_CH1_Sel|= ENDAT(4)| |
|543|0 ENC_CH1_MultiT|Number of MultiTurn bits (absolute encoder)| |
|544|0 ENC_CH1_SingleT|Number of SingleTurn bits (absolute encoder)| |
|547|0 ENC_CH1_MTBase|Definition of point of discontinuity in multi-turn range| |
|548|0 ENC_CH1_MTEnable|1: Use Multi-turn encoder as a single-turn encoder| |
|616|0 ENC_CH1_CycleCount|Position encoder sampling cycle (n x 125 μsec)| |
|598|0 ENC_CH1_Position|inc|Position encoder channel 1|
|554|0 ENC_CH1_|nm|Length of one increment (linear absolute encoder)|
|640|ENC_ENDAT| |EnDat additional (additional information)|
|640|0 ENDAT_Select|0=off|EnDat function selection, 1/2=diagnosis on/off, 3=warnings, FF=lock|
|640|1 ENDAT_DiagCount|u16|count new diagnosis block header|
|640|2 ENDAT_BWZ_1|lowbyte|vn1: incremental track|
|640|3 ENDAT_BWZ_3|lowbyte|vn3: absolute track|
|640|4 ENDAT_BWZ_4|lowbyte|vn4: position value formation|
|640|5 ENDAT_Status| |EnDat additional status output|
|640|6 ENDAT_Z1_Sel| |EnDat additional information 1 type selection|

**Table 6.7: Overwrite Channel 1 encoder configuration (X7) - EnDat parameters (continue)**
|ID|Index Name|Unit|Description|
|---|---|---|---|
|640|7 ENDAT_Z1_1| |Z1 info: dword 1|
|640|8 ENDAT_Z1_2| |Z1 info: dword 2|
|640|9 ENDAT_Z1_3| |Z1 info: dword 3|
|640|10 ENDAT_Z1_4| |Z1 info: dword 4|
|640|11 ENDAT_Z2_Sel| |EnDat additional information 2 type selection|
|640|12 ENDAT_Z2_1| |Z2 info: dword 1|
|640|13 ENDAT_Z2_2| |Z2 info: dword 2|
|640|14 ENDAT_Z2_3| |Z2 info: dword 3|
|640|15 ENDAT_Z2_4| |Z2 info: dword 4|
|640|16 ENDAT_Mode1|0=off|EnDat additional mode 1 selection|
|640|17 ENDAT_Mode2| |EnDat additional mode 2 selection|
|640|18 ENDAT_Mode3| |EnDat additional mode 3 selection|
|640|19 ENDAT_Mode4| |EnDat additional mode 4 selection|
|640|20 ENDAT_res1| |reserved 1|
|640|21 ENDAT_res2| |reserved 2|
|640|22 ENDAT_res3| |reserved 3|
|640|23 ENDAT_HwSyncStop|0=SyncOn|EnDat cyclic hw sync, stop/start 1/0|
|640|24 ENDAT_CyclCount| |call counter of cyclic function|
|640|25 ENDAT_BWZ_Supported| |vn supported (bit3=vn4, bit2=vn3, bit0=vn1)|
|640|26 ENDAT_BWZ1_| |vn1: bits[7..0] threshold level, bits[31..16]|
|640|27 ThresholdLevel| |how often number|
|640|28 ENDAT_BWZ3_| |vn3: bits[7..0] threshold level, bits[31..16]|
|640|29 ThresholdLevel| |how often number|
|640|30 ENDAT_BWZ4_| |vn4: bits[7..0] threshold level, bits[31..16]|
|640|31 ThresholdLevel| |how often number|
|640|32 ENDAT_BWZ_TEST_| |vn: bits[15..12] 'F', bits[11..8] vn.no., bits [7..0] vn overwrite value|

# 6.5.3 Hall sensor X7

Ch1: HALL(5) - Digital hall signals

Ch1: HALL_TTL(7) - Digital hall signals

NOTE

l The operation and configuration of Hall effect sensors is reserved for special applications. Consult with Moog if needed.

# 6.5.4 Sin/Cos / TTL X7

# 6.5.4.1 TTL encoder

Ch1: TTL(3) - TTL signals

TTL encoders are ...

- a. ... ... usually pure incremental encoders without an absolute value interface.
- b. In this case, P 540[0] - ENC_CH1_Abs must be set to OFF(0). ... ... in a few exceptional cases, incremental encoders with an SSI absolute value interface. In this case, P 540[0] - ENC_CH1_Abs must be accordingly set to SSI(1) (SSI_CONT(4) in special cases), so that it will be possible to read the absolute encoder position for the absolute value initialization routine once during the initialization phase.

# 6.5.4.1.1 Pure TTL incremental encoder

Set P 505[0] - ENC_CH1_Sel to TTL(3) and P 540[0] - ENC_CH1_Abs to OFF(0) when using pure TTL encoders, i.e. encoders without an absolute value interface but with a TTL zero pulse.

Linear TTL encoders are run as rotary encoders. For linear motor operation, P 542 [0] - ENC_CH1_Lines and the encoder gearing (see the “Encoder gearing” section) are used to establish the ratio for the linear motor’s pole pair subdivision (North-North) for commutation. 1 x North-North corresponds to one revolution from Lines. In this case, the motor pole pair number must be set to 1. Moreover, P 553[0] - ENC_CH1_PeriodLen is not used in this case.

The TTL interface accepts various TTL signal types, which can be selected using P 558[0] - ENC_CH1_TTL_SignalType:

- (0)AF_B - A/B tracks (forward counting, X4 encoding) - AB
- (1)AR_B - A/B tracks (reverse counting, X4 encoding) - AB_inv
- (2)ABDFN - A: Clock (falling edge), B: Direction (1 = positive) - PulseDir
- (3)ABDRP - A: Clock (rising edge), B: Direction (1 = negative) - PulseDir_inv
- (4)reserved

A maximum interpolation period, in ms (milliseconds), can be configured for the TTL interface using P 601[0] - ENC_CH1_Period. Within this context, Period is the maximum time of “no activity” since the last TTL counter event:

- Period = 0: Function disabled (default)
- Period > 0 (=n ms): If no counter event is registered in n ms, the speed will be set to 0.

# Zero pulse

There is no parameter for activating the zero pulse evaluation here, as this evaluation is controlled exclusively based on the homing mode (see Section ""Homing"" on page 249). However, setting P 541[0] - ENC_CH1_NpTest to 1 provides a test mode that can be used during commissioning in order to be able to activate the zero pulse evaluation even without homing. Scope signals 1014 and 1016 can be used to view a received zero pulse within this context. This test mode must be disabled during normal operation (P 541[0] = 0).

# Commutation

Motor operation with pure incremental encoders needs for the auto commutation function to be enabled without fail. For details see Section ""Synchronous motor auto commutation"" on page 156.

# 6.5.4.1.2 TTL incremental encoder with SSI absolute value interface

See Section ""Sin/Cos incremental encoders with absolute value interface"" on page 65 and in special Section ""SSI absolute value interface"" on page 67.

MSD ServoDrive - DeviceHelp

# 6 Encoder

MOOG ID No.:CB40859-001 Date:11/2020 MSD ServoDrive - DeviceHelp 64

|ID|Index Name|Unit|Description|
|---|---|---|---|
|505|0|ENC_CH1_Sel = 3|Encoder selection set to TTL(3)|
|510|0|ENC_CH1_Num|Encoder gearing: Numerator Ch1: SINCOS(1) - Sin/Cos signals|
|511|0|ENC_CH1_Denom|Encoder gearing: Denominator|
|540|0|ENC_CH1_Abs|Selection of absolute value interface Sin/Cos encoders can ...|
|541|0|ENC_CH1_NpTest|ENC CH1, TEST-MODE: Index pulse signal(s) to Scope|
|542|0|ENC_CH1_lines|Number of lines (Sin/Cos / TTL encoders) a. Be pure incremental encoders without an absolute value interface. In this|
|558|0|ENC_CH1_TTL_SignalType|Channel 1: TTL signal selection case, P 540[0] - ENC_CH1_Abs must be set to OFF(0).|
|601|0|ENC_CH1_Period|Maximum period of interpolation (TTL encoder)|
|616|0|ENC_CH1_CycleCount|Sampling cycle in: n x 125 μ (microseconds) b. Be incremental encoders with an absolute value interface. In this case,|

Table 6.8: Parameters for Channel 1 (X7) - TTL encoder

ENC_CH1_Abs must be accordingly set to SSI(1), EnDat(2), HIPER(3) or, in special cases, SSI_CONT(4) so that it will be possible to read the absolute encoder position for the absolute value initialization routine once during the initialization phase.

# 6.5.4.2.1 Purely Sin/Cos incremental encoders

To run these encoders as purely incremental encoders with a zero pulse on encoder channel Ch1 (without an absolute value interface), the approach is basically the same as for purely TTL operation (see Section ""TTL encoder"" on page 63). The same parameters apply.

However, there are the following differences:

- a. There are no different signal types for the Sin/Cos signal (always 1 Vss for cosine and sine).
- b. The zero pulse is the analog zero pulse typical of Sin/Cos encoders (see the “Connection for high-resolution encoders” section in the operation manual MSD Servo Drive Single-Axis System, for example).

# 6.5.4.2.2 Linear Sin/Cos

|ID|Index Name|Unit|Description|
|---|---|---|---|
|542|ENC_CH1_lines| |Number of Lines (Sin/Cos / TTL encoders)|
|543|ENC_CH1_MultiT| |Number of MultiTurn bits (absolute encoder)|
|544|ENC_CH1_SingleT| |Number of SingleTurn bits (absolute encoder)|
|545|ENC_CH1_Code| |Code selection (SSI encoder) (binary, gray)|
|546|ENC_CH1_Mode| |Mode selection (SSI encoder)|
|547|ENC_CH1_MTBase| |Definition of point of discontinuity in multi-turn range|
|548|ENC_CH1_MTEnable| |Enable MultiTurn use (negative logic, 1=MToff)|
|549|ENC_CH1_Corr| |Signal correction type|
|550|ENC_CH1_CorrVal|0-4|Signal correction values|
|551|ENC_CH1_EncObsMin| |Encoder monitoring minimum, sqrt(a^2+b^2)|
|552|ENC_CH1_AbsEncStatus| |Error and status codes (absolute encoder)|

# 6.5.4.2.3 Signal correction (GPOC)

|ID|Index Name|Unit|Description|
|---|---|---|---|
|553|ENC_CH1_PeriodLen|nm|Length of signal period (Sin/Cos linear encoder)|
|554|ENC_CH1_DigitalResolution|nm|Length of one increment (linear absolute encoder)|
|555|ENC_CH1_Info| |Encoder information|
|616|ENC_CH1_CycleCount| |Sampling cycle in: n x 125 μ (microseconds)|
|610|ENC_CH1_NominalIncrementA| |Sign. Nominal increment A (distance coded abs. per. encoder)|
|611|ENC_CH1_NominalIncrementB| |Sign. Nominal increment B (distance coded abs. per. encoder)|
|1900|ENC_ETS| |ETS mode, electronic nameplate|

# 6.5.4.2.4 Sin/Cos incremental encoders with absolute value interface

The following table lists the parameters for cyclical Sin/Cos operation on encoder channel Ch 1 with one-time reading of the absolute encoder position via the absolute value interface, i.e. without a zero pulse:

|ID|Index Name|Unit|Description|
|---|---|---|---|
|505|ENC_CH1_Sel|1|Encoder selection set to SINCOS(1)|
|510|ENC_CH1_Num| |Encoder gearing: Numerator|
|511|ENC_CH1_Denom| |Encoder gearing: Denominator|
|540|ENC_CH1_Abs| |Absolute value interface selection (one-time reading)|

Table 6.9: Parameters for channel 1 (X7) - Sin/Cos encoder

The Sel, Num, Denom, Abs, Lines, MultiT, SingleT and CorrVal parameters are self-explanatory.

The Code and Mode parameters are described in Section ""SSI (cyclical) X7"" on page 69.

P 547[0] - ENC_CH1_MTBase = Minimum MultiTurn position

The MTBase parameter is used to set a position in the multi-turn encoder’s travel path that defines the point of discontinuity (overflow/underflow) for the absolute value initialization (that is, the “multi-turn basis”). Assuming a bipolar encoder measuring range, all position values that fall below MTBase will be shifted “up” (the whole MT range will be added to them once).

MOOG ID No.:CB40859-001 Date:11/2020

MSD ServoDrive - DeviceHelp

# 6 Encoder

MOOG ID No.:CB40859-001 Date:11/2020

method makes it possible to place the point of discontinuity at any point within the encoder’s entire measuring range. By default, MTBase will be set to the lowest possible value for the parameter, i.e. reliably outside of the encoder’s value range: In this case, the full bipolar range will remain unaffected, as values will never fall below this MTBase threshold (see Section ""Channel 1: Interface X7"" on page 59).

- P 548[0] - ENC_CH1_MTEnable = MultiTurn as SingleTurn
- The MTEnable parameter makes it possible to use multi-turn encoders as single-turn encoders for test purposes. Negative logic: Default MTEnable = 0 means ""MultiTurn-Enable ON"".

P 549[0] - ENC_CH1_Corr = Signal correction type
- The GPOC routine used for track signal correction purposes for sine/cosine signals is used to compensate for systematic errors. The routine is controlled with the Corr and CorrVal parameters (see Section ""Signal correction GPOC (Gain Phase Offset Correction)"" on page 74).

P 551[0] - ENC_CH1_EncObsMin = Encoder monitoring minimum, sqrt (a^2+b^2)
- The parameter EncObsMin is used to scale the Sin/Cos wire break monitoring and represents the “downwards threshold” for an error message. The default setting is 0.2, corresponding to approx. ",How does the P 554[0] - ENC_CH1_DigitalResolution parameter function in the context of linear encoders?,A2,"This parameter defines the nanometer length per increment of the position value from a linear encoder, crucial for calculating maximum travel.",1.9609375,2.046875,3.5625,1.8671875,0.57421875
7,msd_servo_drive.txt,20,02f242a213dfa4411d028ce46dfba16a3f97395fa25788fcbaea1715e779d934,"), consult with your project supervisor or the Helpline provided by Moog before using any special SSI protocol modes.

# 6.5.2 EnDat (cyclical) X7

Ch1: ENDAT(4) - Cyclical EnDat (2.1 or 2.2) EnDat is a digital encoder interface developed by HEIDENHAIN. For more details, please visit www.heidenhain.de and go to ►Documentation ►Fundamentals ►Interfaces ►EnDat 2.2.

The software versions required to run the EnDat encoder interface are the standard software versions for the MSD Servo Drive and MSD Single-Axis Servo Drive Compact.

MOOG ID No.:CB40859-001 Date:11/2020

# 6 Encoder

NOTE

- Please note the limitations that apply when running EnDat and SSI encoders (see Section ""Limiting for EnDat and SSI"" on page 52).

When using linear encoders, P 554[0] - ENC_CH1_DigitalResolution is used instead of P 543[0] - ENC_CH1_MultiT and P 544[0] - ENC_CH1_SingleT (which are used for rotary encoders). The values will be read from the EnDat encoder and written to the aforementioned parameters.

- P 543[0] - ENC_CH1_MultiT
- The number ""n"" of multiturn bits defines the measuring range in 2n increments per encoder shaft revolution; maximum travel until overflow; maximum travel within which the absolute value initialization can be unambiguous. In the case of single-turn encoders, MultiT = 0.
- P 544[0] - ENC_CH1_SingleT
- The number ""n"" of single-turn bits corresponds to the encoder’s digital resolution in 2n increments per encoder shaft revolution.
- P 554[0] - ENC_CH1_DigitalResolution
- This is the length of an increment, in nanometres, of the encoder’s digitally transmitted position value. This value is read from the EnDat linear head.

In the case of linear encoders, the number n of transmitted position bits from the encoder will be found in SingleT only! 2n * DigitalResolution yields the maximum travel in nanometres (for the encoder head).

P 640 - ENC_ENDAT is intended for additional information, but is normally not needed. This parameter does not have a Ch1 or Ch3 prefix for the encoder channel in the name, as it applies to both encoder channels. Although usually not needed, the parameter is helpful or required in the following cases:

1. Special EnDat encoder with diagnostics for evaluation
In this case, the valuation numbers from the encoder are read cyclically via additional information. Only the valuation numbers that the encoder supports.

# 6 Encoder

MOOG ID No.:CB40859-001 Date:11/2020

will be read. During the initialization process, the system will read the encoder to determine which valuation numbers it supports. When P 640[0] - ENDAT_Select = 1, the function will be enabled in the controller and the internal diagnostics in the EnDaT encoder will be enabled as well. The EnDat encoder will keep this setting even after being powered off. To explicitly disable the internal diagnostics in the EnDat encoder, set P 640[0] - ENDAT_Select to 2.

# 2. Evaluation of internal warnings

In this scenario, certain internal warnings from the encoder will be read from the encoder via additional information. Only the warnings that both the encoder and the Servo Drive’s software support will be read. During the initialization process, the system will read the encoder to determine which warnings it supports. When P 640[0] - ENDAT_Select = 3, the function will be enabled in the controller.

**Table 6.7: Channel 1 encoder configuration (X7) - EnDat parameters**
|ID|Index Name|Unit|Description|
|---|---|---|---|
|505|0 ENC_CH1_Sel|= ENDAT(4)| |
|543|0 ENC_CH1_MultiT|Number of MultiTurn bits (absolute encoder)| |
|544|0 ENC_CH1_SingleT|Number of SingleTurn bits (absolute encoder)| |
|547|0 ENC_CH1_MTBase|Definition of point of discontinuity in multi-turn range| |
|548|0 ENC_CH1_MTEnable|1: Use Multi-turn encoder as a single-turn encoder| |
|616|0 ENC_CH1_CycleCount|Position encoder sampling cycle (n x 125 μsec)| |
|598|0 ENC_CH1_Position|inc|Position encoder channel 1|
|554|0 ENC_CH1_|nm|Length of one increment (linear absolute encoder)|
|640|ENC_ENDAT| |EnDat additional (additional information)|
|640|0 ENDAT_Select|0=off|EnDat function selection, 1/2=diagnosis on/off, 3=warnings, FF=lock|
|640|1 ENDAT_DiagCount|u16|count new diagnosis block header|
|640|2 ENDAT_BWZ_1|lowbyte|vn1: incremental track|
|640|3 ENDAT_BWZ_3|lowbyte|vn3: absolute track|
|640|4 ENDAT_BWZ_4|lowbyte|vn4: position value formation|
|640|5 ENDAT_Status| |EnDat additional status output|
|640|6 ENDAT_Z1_Sel| |EnDat additional information 1 type selection|

**Table 6.7: Overwrite Channel 1 encoder configuration (X7) - EnDat parameters (continue)**
|ID|Index Name|Unit|Description|
|---|---|---|---|
|640|7 ENDAT_Z1_1| |Z1 info: dword 1|
|640|8 ENDAT_Z1_2| |Z1 info: dword 2|
|640|9 ENDAT_Z1_3| |Z1 info: dword 3|
|640|10 ENDAT_Z1_4| |Z1 info: dword 4|
|640|11 ENDAT_Z2_Sel| |EnDat additional information 2 type selection|
|640|12 ENDAT_Z2_1| |Z2 info: dword 1|
|640|13 ENDAT_Z2_2| |Z2 info: dword 2|
|640|14 ENDAT_Z2_3| |Z2 info: dword 3|
|640|15 ENDAT_Z2_4| |Z2 info: dword 4|
|640|16 ENDAT_Mode1|0=off|EnDat additional mode 1 selection|
|640|17 ENDAT_Mode2| |EnDat additional mode 2 selection|
|640|18 ENDAT_Mode3| |EnDat additional mode 3 selection|
|640|19 ENDAT_Mode4| |EnDat additional mode 4 selection|
|640|20 ENDAT_res1| |reserved 1|
|640|21 ENDAT_res2| |reserved 2|
|640|22 ENDAT_res3| |reserved 3|
|640|23 ENDAT_HwSyncStop|0=SyncOn|EnDat cyclic hw sync, stop/start 1/0|
|640|24 ENDAT_CyclCount| |call counter of cyclic function|
|640|25 ENDAT_BWZ_Supported| |vn supported (bit3=vn4, bit2=vn3, bit0=vn1)|
|640|26 ENDAT_BWZ1_| |vn1: bits[7..0] threshold level, bits[31..16]|
|640|27 ThresholdLevel| |how often number|
|640|28 ENDAT_BWZ3_| |vn3: bits[7..0] threshold level, bits[31..16]|
|640|29 ThresholdLevel| |how often number|
|640|30 ENDAT_BWZ4_| |vn4: bits[7..0] threshold level, bits[31..16]|
|640|31 ThresholdLevel| |how often number|
|640|32 ENDAT_BWZ_TEST_| |vn: bits[15..12] 'F', bits[11..8] vn.no., bits [7..0] vn overwrite value|

# 6.5.3 Hall sensor X7

Ch1: HALL(5) - Digital hall signals

Ch1: HALL_TTL(7) - Digital hall signals

NOTE

l The operation and configuration of Hall effect sensors is reserved for special applications. Consult with Moog if needed.

# 6.5.4 Sin/Cos / TTL X7

# 6.5.4.1 TTL encoder

Ch1: TTL(3) - TTL signals

TTL encoders are ...

- a. ... ... usually pure incremental encoders without an absolute value interface.
- b. In this case, P 540[0] - ENC_CH1_Abs must be set to OFF(0). ... ... in a few exceptional cases, incremental encoders with an SSI absolute value interface. In this case, P 540[0] - ENC_CH1_Abs must be accordingly set to SSI(1) (SSI_CONT(4) in special cases), so that it will be possible to read the absolute encoder position for the absolute value initialization routine once during the initialization phase.

# 6.5.4.1.1 Pure TTL incremental encoder

Set P 505[0] - ENC_CH1_Sel to TTL(3) and P 540[0] - ENC_CH1_Abs to OFF(0) when using pure TTL encoders, i.e. encoders without an absolute value interface but with a TTL zero pulse.

Linear TTL encoders are run as rotary encoders. For linear motor operation, P 542 [0] - ENC_CH1_Lines and the encoder gearing (see the “Encoder gearing” section) are used to establish the ratio for the linear motor’s pole pair subdivision (North-North) for commutation. 1 x North-North corresponds to one revolution from Lines. In this case, the motor pole pair number must be set to 1. Moreover, P 553[0] - ENC_CH1_PeriodLen is not used in this case.

The TTL interface accepts various TTL signal types, which can be selected using P 558[0] - ENC_CH1_TTL_SignalType:

- (0)AF_B - A/B tracks (forward counting, X4 encoding) - AB
- (1)AR_B - A/B tracks (reverse counting, X4 encoding) - AB_inv
- (2)ABDFN - A: Clock (falling edge), B: Direction (1 = positive) - PulseDir
- (3)ABDRP - A: Clock (rising edge), B: Direction (1 = negative) - PulseDir_inv
- (4)reserved

A maximum interpolation period, in ms (milliseconds), can be configured for the TTL interface using P 601[0] - ENC_CH1_Period. Within this context, Period is the maximum time of “no activity” since the last TTL counter event:

- Period = 0: Function disabled (default)
- Period > 0 (=n ms): If no counter event is registered in n ms, the speed will be set to 0.

# Zero pulse

There is no parameter for activating the zero pulse evaluation here, as this evaluation is controlled exclusively based on the homing mode (see Section ""Homing"" on page 249). However, setting P 541[0] - ENC_CH1_NpTest to 1 provides a test mode that can be used during commissioning in order to be able to activate the zero pulse evaluation even without homing. Scope signals 1014 and 1016 can be used to view a received zero pulse within this context. This test mode must be disabled during normal operation (P 541[0] = 0).

# Commutation

Motor operation with pure incremental encoders needs for the auto commutation function to be enabled without fail. For details see Section ""Synchronous motor auto commutation"" on page 156.

# 6.5.4.1.2 TTL incremental encoder with SSI absolute value interface

See Section ""Sin/Cos incremental encoders with absolute value interface"" on page 65 and in special Section ""SSI absolute value interface"" on page 67.

MSD ServoDrive - DeviceHelp

# 6 Encoder

MOOG ID No.:CB40859-001 Date:11/2020 MSD ServoDrive - DeviceHelp 64

|ID|Index Name|Unit|Description|
|---|---|---|---|
|505|0|ENC_CH1_Sel = 3|Encoder selection set to TTL(3)|
|510|0|ENC_CH1_Num|Encoder gearing: Numerator Ch1: SINCOS(1) - Sin/Cos signals|
|511|0|ENC_CH1_Denom|Encoder gearing: Denominator|
|540|0|ENC_CH1_Abs|Selection of absolute value interface Sin/Cos encoders can ...|
|541|0|ENC_CH1_NpTest|ENC CH1, TEST-MODE: Index pulse signal(s) to Scope|
|542|0|ENC_CH1_lines|Number of lines (Sin/Cos / TTL encoders) a. Be pure incremental encoders without an absolute value interface. In this|
|558|0|ENC_CH1_TTL_SignalType|Channel 1: TTL signal selection case, P 540[0] - ENC_CH1_Abs must be set to OFF(0).|
|601|0|ENC_CH1_Period|Maximum period of interpolation (TTL encoder)|
|616|0|ENC_CH1_CycleCount|Sampling cycle in: n x 125 μ (microseconds) b. Be incremental encoders with an absolute value interface. In this case,|

Table 6.8: Parameters for Channel 1 (X7) - TTL encoder

ENC_CH1_Abs must be accordingly set to SSI(1), EnDat(2), HIPER(3) or, in special cases, SSI_CONT(4) so that it will be possible to read the absolute encoder position for the absolute value initialization routine once during the initialization phase.

# 6.5.4.2.1 Purely Sin/Cos incremental encoders

To run these encoders as purely incremental encoders with a zero pulse on encoder channel Ch1 (without an absolute value interface), the approach is basically the same as for purely TTL operation (see Section ""TTL encoder"" on page 63). The same parameters apply.

However, there are the following differences:

- a. There are no different signal types for the Sin/Cos signal (always 1 Vss for cosine and sine).
- b. The zero pulse is the analog zero pulse typical of Sin/Cos encoders (see the “Connection for high-resolution encoders” section in the operation manual MSD Servo Drive Single-Axis System, for example).

# 6.5.4.2.2 Linear Sin/Cos

|ID|Index Name|Unit|Description|
|---|---|---|---|
|542|ENC_CH1_lines| |Number of Lines (Sin/Cos / TTL encoders)|
|543|ENC_CH1_MultiT| |Number of MultiTurn bits (absolute encoder)|
|544|ENC_CH1_SingleT| |Number of SingleTurn bits (absolute encoder)|
|545|ENC_CH1_Code| |Code selection (SSI encoder) (binary, gray)|
|546|ENC_CH1_Mode| |Mode selection (SSI encoder)|
|547|ENC_CH1_MTBase| |Definition of point of discontinuity in multi-turn range|
|548|ENC_CH1_MTEnable| |Enable MultiTurn use (negative logic, 1=MToff)|
|549|ENC_CH1_Corr| |Signal correction type|
|550|ENC_CH1_CorrVal|0-4|Signal correction values|
|551|ENC_CH1_EncObsMin| |Encoder monitoring minimum, sqrt(a^2+b^2)|
|552|ENC_CH1_AbsEncStatus| |Error and status codes (absolute encoder)|

# 6.5.4.2.3 Signal correction (GPOC)

|ID|Index Name|Unit|Description|
|---|---|---|---|
|553|ENC_CH1_PeriodLen|nm|Length of signal period (Sin/Cos linear encoder)|
|554|ENC_CH1_DigitalResolution|nm|Length of one increment (linear absolute encoder)|
|555|ENC_CH1_Info| |Encoder information|
|616|ENC_CH1_CycleCount| |Sampling cycle in: n x 125 μ (microseconds)|
|610|ENC_CH1_NominalIncrementA| |Sign. Nominal increment A (distance coded abs. per. encoder)|
|611|ENC_CH1_NominalIncrementB| |Sign. Nominal increment B (distance coded abs. per. encoder)|
|1900|ENC_ETS| |ETS mode, electronic nameplate|

# 6.5.4.2.4 Sin/Cos incremental encoders with absolute value interface

The following table lists the parameters for cyclical Sin/Cos operation on encoder channel Ch 1 with one-time reading of the absolute encoder position via the absolute value interface, i.e. without a zero pulse:

|ID|Index Name|Unit|Description|
|---|---|---|---|
|505|ENC_CH1_Sel|1|Encoder selection set to SINCOS(1)|
|510|ENC_CH1_Num| |Encoder gearing: Numerator|
|511|ENC_CH1_Denom| |Encoder gearing: Denominator|
|540|ENC_CH1_Abs| |Absolute value interface selection (one-time reading)|

Table 6.9: Parameters for channel 1 (X7) - Sin/Cos encoder

The Sel, Num, Denom, Abs, Lines, MultiT, SingleT and CorrVal parameters are self-explanatory.

The Code and Mode parameters are described in Section ""SSI (cyclical) X7"" on page 69.

P 547[0] - ENC_CH1_MTBase = Minimum MultiTurn position

The MTBase parameter is used to set a position in the multi-turn encoder’s travel path that defines the point of discontinuity (overflow/underflow) for the absolute value initialization (that is, the “multi-turn basis”). Assuming a bipolar encoder measuring range, all position values that fall below MTBase will be shifted “up” (the whole MT range will be added to them once).

MOOG ID No.:CB40859-001 Date:11/2020

MSD ServoDrive - DeviceHelp

# 6 Encoder

MOOG ID No.:CB40859-001 Date:11/2020

method makes it possible to place the point of discontinuity at any point within the encoder’s entire measuring range. By default, MTBase will be set to the lowest possible value for the parameter, i.e. reliably outside of the encoder’s value range: In this case, the full bipolar range will remain unaffected, as values will never fall below this MTBase threshold (see Section ""Channel 1: Interface X7"" on page 59).

- P 548[0] - ENC_CH1_MTEnable = MultiTurn as SingleTurn
- The MTEnable parameter makes it possible to use multi-turn encoders as single-turn encoders for test purposes. Negative logic: Default MTEnable = 0 means ""MultiTurn-Enable ON"".

P 549[0] - ENC_CH1_Corr = Signal correction type
- The GPOC routine used for track signal correction purposes for sine/cosine signals is used to compensate for systematic errors. The routine is controlled with the Corr and CorrVal parameters (see Section ""Signal correction GPOC (Gain Phase Offset Correction)"" on page 74).

P 551[0] - ENC_CH1_EncObsMin = Encoder monitoring minimum, sqrt (a^2+b^2)
- The parameter EncObsMin is used to scale the Sin/Cos wire break monitoring and represents the “downwards threshold” for an error message. The default setting is 0.2, corresponding to approx. ",How does the P 554[0] - ENC_CH1_DigitalResolution parameter function in the context of linear encoders?,A3,"For linear encoders, it reads the increment length in nanometers from the EnDat linear head, essential for position value transmission.",2.375,2.34375,3.5625,1.8515625,0.640625
8,msd_servo_drive.txt,20,02f242a213dfa4411d028ce46dfba16a3f97395fa25788fcbaea1715e779d934,"), consult with your project supervisor or the Helpline provided by Moog before using any special SSI protocol modes.

# 6.5.2 EnDat (cyclical) X7

Ch1: ENDAT(4) - Cyclical EnDat (2.1 or 2.2) EnDat is a digital encoder interface developed by HEIDENHAIN. For more details, please visit www.heidenhain.de and go to ►Documentation ►Fundamentals ►Interfaces ►EnDat 2.2.

The software versions required to run the EnDat encoder interface are the standard software versions for the MSD Servo Drive and MSD Single-Axis Servo Drive Compact.

MOOG ID No.:CB40859-001 Date:11/2020

# 6 Encoder

NOTE

- Please note the limitations that apply when running EnDat and SSI encoders (see Section ""Limiting for EnDat and SSI"" on page 52).

When using linear encoders, P 554[0] - ENC_CH1_DigitalResolution is used instead of P 543[0] - ENC_CH1_MultiT and P 544[0] - ENC_CH1_SingleT (which are used for rotary encoders). The values will be read from the EnDat encoder and written to the aforementioned parameters.

- P 543[0] - ENC_CH1_MultiT
- The number ""n"" of multiturn bits defines the measuring range in 2n increments per encoder shaft revolution; maximum travel until overflow; maximum travel within which the absolute value initialization can be unambiguous. In the case of single-turn encoders, MultiT = 0.
- P 544[0] - ENC_CH1_SingleT
- The number ""n"" of single-turn bits corresponds to the encoder’s digital resolution in 2n increments per encoder shaft revolution.
- P 554[0] - ENC_CH1_DigitalResolution
- This is the length of an increment, in nanometres, of the encoder’s digitally transmitted position value. This value is read from the EnDat linear head.

In the case of linear encoders, the number n of transmitted position bits from the encoder will be found in SingleT only! 2n * DigitalResolution yields the maximum travel in nanometres (for the encoder head).

P 640 - ENC_ENDAT is intended for additional information, but is normally not needed. This parameter does not have a Ch1 or Ch3 prefix for the encoder channel in the name, as it applies to both encoder channels. Although usually not needed, the parameter is helpful or required in the following cases:

1. Special EnDat encoder with diagnostics for evaluation
In this case, the valuation numbers from the encoder are read cyclically via additional information. Only the valuation numbers that the encoder supports.

# 6 Encoder

MOOG ID No.:CB40859-001 Date:11/2020

will be read. During the initialization process, the system will read the encoder to determine which valuation numbers it supports. When P 640[0] - ENDAT_Select = 1, the function will be enabled in the controller and the internal diagnostics in the EnDaT encoder will be enabled as well. The EnDat encoder will keep this setting even after being powered off. To explicitly disable the internal diagnostics in the EnDat encoder, set P 640[0] - ENDAT_Select to 2.

# 2. Evaluation of internal warnings

In this scenario, certain internal warnings from the encoder will be read from the encoder via additional information. Only the warnings that both the encoder and the Servo Drive’s software support will be read. During the initialization process, the system will read the encoder to determine which warnings it supports. When P 640[0] - ENDAT_Select = 3, the function will be enabled in the controller.

**Table 6.7: Channel 1 encoder configuration (X7) - EnDat parameters**
|ID|Index Name|Unit|Description|
|---|---|---|---|
|505|0 ENC_CH1_Sel|= ENDAT(4)| |
|543|0 ENC_CH1_MultiT|Number of MultiTurn bits (absolute encoder)| |
|544|0 ENC_CH1_SingleT|Number of SingleTurn bits (absolute encoder)| |
|547|0 ENC_CH1_MTBase|Definition of point of discontinuity in multi-turn range| |
|548|0 ENC_CH1_MTEnable|1: Use Multi-turn encoder as a single-turn encoder| |
|616|0 ENC_CH1_CycleCount|Position encoder sampling cycle (n x 125 μsec)| |
|598|0 ENC_CH1_Position|inc|Position encoder channel 1|
|554|0 ENC_CH1_|nm|Length of one increment (linear absolute encoder)|
|640|ENC_ENDAT| |EnDat additional (additional information)|
|640|0 ENDAT_Select|0=off|EnDat function selection, 1/2=diagnosis on/off, 3=warnings, FF=lock|
|640|1 ENDAT_DiagCount|u16|count new diagnosis block header|
|640|2 ENDAT_BWZ_1|lowbyte|vn1: incremental track|
|640|3 ENDAT_BWZ_3|lowbyte|vn3: absolute track|
|640|4 ENDAT_BWZ_4|lowbyte|vn4: position value formation|
|640|5 ENDAT_Status| |EnDat additional status output|
|640|6 ENDAT_Z1_Sel| |EnDat additional information 1 type selection|

**Table 6.7: Overwrite Channel 1 encoder configuration (X7) - EnDat parameters (continue)**
|ID|Index Name|Unit|Description|
|---|---|---|---|
|640|7 ENDAT_Z1_1| |Z1 info: dword 1|
|640|8 ENDAT_Z1_2| |Z1 info: dword 2|
|640|9 ENDAT_Z1_3| |Z1 info: dword 3|
|640|10 ENDAT_Z1_4| |Z1 info: dword 4|
|640|11 ENDAT_Z2_Sel| |EnDat additional information 2 type selection|
|640|12 ENDAT_Z2_1| |Z2 info: dword 1|
|640|13 ENDAT_Z2_2| |Z2 info: dword 2|
|640|14 ENDAT_Z2_3| |Z2 info: dword 3|
|640|15 ENDAT_Z2_4| |Z2 info: dword 4|
|640|16 ENDAT_Mode1|0=off|EnDat additional mode 1 selection|
|640|17 ENDAT_Mode2| |EnDat additional mode 2 selection|
|640|18 ENDAT_Mode3| |EnDat additional mode 3 selection|
|640|19 ENDAT_Mode4| |EnDat additional mode 4 selection|
|640|20 ENDAT_res1| |reserved 1|
|640|21 ENDAT_res2| |reserved 2|
|640|22 ENDAT_res3| |reserved 3|
|640|23 ENDAT_HwSyncStop|0=SyncOn|EnDat cyclic hw sync, stop/start 1/0|
|640|24 ENDAT_CyclCount| |call counter of cyclic function|
|640|25 ENDAT_BWZ_Supported| |vn supported (bit3=vn4, bit2=vn3, bit0=vn1)|
|640|26 ENDAT_BWZ1_| |vn1: bits[7..0] threshold level, bits[31..16]|
|640|27 ThresholdLevel| |how often number|
|640|28 ENDAT_BWZ3_| |vn3: bits[7..0] threshold level, bits[31..16]|
|640|29 ThresholdLevel| |how often number|
|640|30 ENDAT_BWZ4_| |vn4: bits[7..0] threshold level, bits[31..16]|
|640|31 ThresholdLevel| |how often number|
|640|32 ENDAT_BWZ_TEST_| |vn: bits[15..12] 'F', bits[11..8] vn.no., bits [7..0] vn overwrite value|

# 6.5.3 Hall sensor X7

Ch1: HALL(5) - Digital hall signals

Ch1: HALL_TTL(7) - Digital hall signals

NOTE

l The operation and configuration of Hall effect sensors is reserved for special applications. Consult with Moog if needed.

# 6.5.4 Sin/Cos / TTL X7

# 6.5.4.1 TTL encoder

Ch1: TTL(3) - TTL signals

TTL encoders are ...

- a. ... ... usually pure incremental encoders without an absolute value interface.
- b. In this case, P 540[0] - ENC_CH1_Abs must be set to OFF(0). ... ... in a few exceptional cases, incremental encoders with an SSI absolute value interface. In this case, P 540[0] - ENC_CH1_Abs must be accordingly set to SSI(1) (SSI_CONT(4) in special cases), so that it will be possible to read the absolute encoder position for the absolute value initialization routine once during the initialization phase.

# 6.5.4.1.1 Pure TTL incremental encoder

Set P 505[0] - ENC_CH1_Sel to TTL(3) and P 540[0] - ENC_CH1_Abs to OFF(0) when using pure TTL encoders, i.e. encoders without an absolute value interface but with a TTL zero pulse.

Linear TTL encoders are run as rotary encoders. For linear motor operation, P 542 [0] - ENC_CH1_Lines and the encoder gearing (see the “Encoder gearing” section) are used to establish the ratio for the linear motor’s pole pair subdivision (North-North) for commutation. 1 x North-North corresponds to one revolution from Lines. In this case, the motor pole pair number must be set to 1. Moreover, P 553[0] - ENC_CH1_PeriodLen is not used in this case.

The TTL interface accepts various TTL signal types, which can be selected using P 558[0] - ENC_CH1_TTL_SignalType:

- (0)AF_B - A/B tracks (forward counting, X4 encoding) - AB
- (1)AR_B - A/B tracks (reverse counting, X4 encoding) - AB_inv
- (2)ABDFN - A: Clock (falling edge), B: Direction (1 = positive) - PulseDir
- (3)ABDRP - A: Clock (rising edge), B: Direction (1 = negative) - PulseDir_inv
- (4)reserved

A maximum interpolation period, in ms (milliseconds), can be configured for the TTL interface using P 601[0] - ENC_CH1_Period. Within this context, Period is the maximum time of “no activity” since the last TTL counter event:

- Period = 0: Function disabled (default)
- Period > 0 (=n ms): If no counter event is registered in n ms, the speed will be set to 0.

# Zero pulse

There is no parameter for activating the zero pulse evaluation here, as this evaluation is controlled exclusively based on the homing mode (see Section ""Homing"" on page 249). However, setting P 541[0] - ENC_CH1_NpTest to 1 provides a test mode that can be used during commissioning in order to be able to activate the zero pulse evaluation even without homing. Scope signals 1014 and 1016 can be used to view a received zero pulse within this context. This test mode must be disabled during normal operation (P 541[0] = 0).

# Commutation

Motor operation with pure incremental encoders needs for the auto commutation function to be enabled without fail. For details see Section ""Synchronous motor auto commutation"" on page 156.

# 6.5.4.1.2 TTL incremental encoder with SSI absolute value interface

See Section ""Sin/Cos incremental encoders with absolute value interface"" on page 65 and in special Section ""SSI absolute value interface"" on page 67.

MSD ServoDrive - DeviceHelp

# 6 Encoder

MOOG ID No.:CB40859-001 Date:11/2020 MSD ServoDrive - DeviceHelp 64

|ID|Index Name|Unit|Description|
|---|---|---|---|
|505|0|ENC_CH1_Sel = 3|Encoder selection set to TTL(3)|
|510|0|ENC_CH1_Num|Encoder gearing: Numerator Ch1: SINCOS(1) - Sin/Cos signals|
|511|0|ENC_CH1_Denom|Encoder gearing: Denominator|
|540|0|ENC_CH1_Abs|Selection of absolute value interface Sin/Cos encoders can ...|
|541|0|ENC_CH1_NpTest|ENC CH1, TEST-MODE: Index pulse signal(s) to Scope|
|542|0|ENC_CH1_lines|Number of lines (Sin/Cos / TTL encoders) a. Be pure incremental encoders without an absolute value interface. In this|
|558|0|ENC_CH1_TTL_SignalType|Channel 1: TTL signal selection case, P 540[0] - ENC_CH1_Abs must be set to OFF(0).|
|601|0|ENC_CH1_Period|Maximum period of interpolation (TTL encoder)|
|616|0|ENC_CH1_CycleCount|Sampling cycle in: n x 125 μ (microseconds) b. Be incremental encoders with an absolute value interface. In this case,|

Table 6.8: Parameters for Channel 1 (X7) - TTL encoder

ENC_CH1_Abs must be accordingly set to SSI(1), EnDat(2), HIPER(3) or, in special cases, SSI_CONT(4) so that it will be possible to read the absolute encoder position for the absolute value initialization routine once during the initialization phase.

# 6.5.4.2.1 Purely Sin/Cos incremental encoders

To run these encoders as purely incremental encoders with a zero pulse on encoder channel Ch1 (without an absolute value interface), the approach is basically the same as for purely TTL operation (see Section ""TTL encoder"" on page 63). The same parameters apply.

However, there are the following differences:

- a. There are no different signal types for the Sin/Cos signal (always 1 Vss for cosine and sine).
- b. The zero pulse is the analog zero pulse typical of Sin/Cos encoders (see the “Connection for high-resolution encoders” section in the operation manual MSD Servo Drive Single-Axis System, for example).

# 6.5.4.2.2 Linear Sin/Cos

|ID|Index Name|Unit|Description|
|---|---|---|---|
|542|ENC_CH1_lines| |Number of Lines (Sin/Cos / TTL encoders)|
|543|ENC_CH1_MultiT| |Number of MultiTurn bits (absolute encoder)|
|544|ENC_CH1_SingleT| |Number of SingleTurn bits (absolute encoder)|
|545|ENC_CH1_Code| |Code selection (SSI encoder) (binary, gray)|
|546|ENC_CH1_Mode| |Mode selection (SSI encoder)|
|547|ENC_CH1_MTBase| |Definition of point of discontinuity in multi-turn range|
|548|ENC_CH1_MTEnable| |Enable MultiTurn use (negative logic, 1=MToff)|
|549|ENC_CH1_Corr| |Signal correction type|
|550|ENC_CH1_CorrVal|0-4|Signal correction values|
|551|ENC_CH1_EncObsMin| |Encoder monitoring minimum, sqrt(a^2+b^2)|
|552|ENC_CH1_AbsEncStatus| |Error and status codes (absolute encoder)|

# 6.5.4.2.3 Signal correction (GPOC)

|ID|Index Name|Unit|Description|
|---|---|---|---|
|553|ENC_CH1_PeriodLen|nm|Length of signal period (Sin/Cos linear encoder)|
|554|ENC_CH1_DigitalResolution|nm|Length of one increment (linear absolute encoder)|
|555|ENC_CH1_Info| |Encoder information|
|616|ENC_CH1_CycleCount| |Sampling cycle in: n x 125 μ (microseconds)|
|610|ENC_CH1_NominalIncrementA| |Sign. Nominal increment A (distance coded abs. per. encoder)|
|611|ENC_CH1_NominalIncrementB| |Sign. Nominal increment B (distance coded abs. per. encoder)|
|1900|ENC_ETS| |ETS mode, electronic nameplate|

# 6.5.4.2.4 Sin/Cos incremental encoders with absolute value interface

The following table lists the parameters for cyclical Sin/Cos operation on encoder channel Ch 1 with one-time reading of the absolute encoder position via the absolute value interface, i.e. without a zero pulse:

|ID|Index Name|Unit|Description|
|---|---|---|---|
|505|ENC_CH1_Sel|1|Encoder selection set to SINCOS(1)|
|510|ENC_CH1_Num| |Encoder gearing: Numerator|
|511|ENC_CH1_Denom| |Encoder gearing: Denominator|
|540|ENC_CH1_Abs| |Absolute value interface selection (one-time reading)|

Table 6.9: Parameters for channel 1 (X7) - Sin/Cos encoder

The Sel, Num, Denom, Abs, Lines, MultiT, SingleT and CorrVal parameters are self-explanatory.

The Code and Mode parameters are described in Section ""SSI (cyclical) X7"" on page 69.

P 547[0] - ENC_CH1_MTBase = Minimum MultiTurn position

The MTBase parameter is used to set a position in the multi-turn encoder’s travel path that defines the point of discontinuity (overflow/underflow) for the absolute value initialization (that is, the “multi-turn basis”). Assuming a bipolar encoder measuring range, all position values that fall below MTBase will be shifted “up” (the whole MT range will be added to them once).

MOOG ID No.:CB40859-001 Date:11/2020

MSD ServoDrive - DeviceHelp

# 6 Encoder

MOOG ID No.:CB40859-001 Date:11/2020

method makes it possible to place the point of discontinuity at any point within the encoder’s entire measuring range. By default, MTBase will be set to the lowest possible value for the parameter, i.e. reliably outside of the encoder’s value range: In this case, the full bipolar range will remain unaffected, as values will never fall below this MTBase threshold (see Section ""Channel 1: Interface X7"" on page 59).

- P 548[0] - ENC_CH1_MTEnable = MultiTurn as SingleTurn
- The MTEnable parameter makes it possible to use multi-turn encoders as single-turn encoders for test purposes. Negative logic: Default MTEnable = 0 means ""MultiTurn-Enable ON"".

P 549[0] - ENC_CH1_Corr = Signal correction type
- The GPOC routine used for track signal correction purposes for sine/cosine signals is used to compensate for systematic errors. The routine is controlled with the Corr and CorrVal parameters (see Section ""Signal correction GPOC (Gain Phase Offset Correction)"" on page 74).

P 551[0] - ENC_CH1_EncObsMin = Encoder monitoring minimum, sqrt (a^2+b^2)
- The parameter EncObsMin is used to scale the Sin/Cos wire break monitoring and represents the “downwards threshold” for an error message. The default setting is 0.2, corresponding to approx. ",How does the P 554[0] - ENC_CH1_DigitalResolution parameter function in the context of linear encoders?,A4,"It measures the increment length in nanometers, directly affecting the encoder's position value accuracy and maximum travel calculation.",2.09375,1.96875,3.484375,1.7109375,0.65625
9,msd_servo_drive.txt,20,02f242a213dfa4411d028ce46dfba16a3f97395fa25788fcbaea1715e779d934,"), consult with your project supervisor or the Helpline provided by Moog before using any special SSI protocol modes.

# 6.5.2 EnDat (cyclical) X7

Ch1: ENDAT(4) - Cyclical EnDat (2.1 or 2.2) EnDat is a digital encoder interface developed by HEIDENHAIN. For more details, please visit www.heidenhain.de and go to ►Documentation ►Fundamentals ►Interfaces ►EnDat 2.2.

The software versions required to run the EnDat encoder interface are the standard software versions for the MSD Servo Drive and MSD Single-Axis Servo Drive Compact.

MOOG ID No.:CB40859-001 Date:11/2020

# 6 Encoder

NOTE

- Please note the limitations that apply when running EnDat and SSI encoders (see Section ""Limiting for EnDat and SSI"" on page 52).

When using linear encoders, P 554[0] - ENC_CH1_DigitalResolution is used instead of P 543[0] - ENC_CH1_MultiT and P 544[0] - ENC_CH1_SingleT (which are used for rotary encoders). The values will be read from the EnDat encoder and written to the aforementioned parameters.

- P 543[0] - ENC_CH1_MultiT
- The number ""n"" of multiturn bits defines the measuring range in 2n increments per encoder shaft revolution; maximum travel until overflow; maximum travel within which the absolute value initialization can be unambiguous. In the case of single-turn encoders, MultiT = 0.
- P 544[0] - ENC_CH1_SingleT
- The number ""n"" of single-turn bits corresponds to the encoder’s digital resolution in 2n increments per encoder shaft revolution.
- P 554[0] - ENC_CH1_DigitalResolution
- This is the length of an increment, in nanometres, of the encoder’s digitally transmitted position value. This value is read from the EnDat linear head.

In the case of linear encoders, the number n of transmitted position bits from the encoder will be found in SingleT only! 2n * DigitalResolution yields the maximum travel in nanometres (for the encoder head).

P 640 - ENC_ENDAT is intended for additional information, but is normally not needed. This parameter does not have a Ch1 or Ch3 prefix for the encoder channel in the name, as it applies to both encoder channels. Although usually not needed, the parameter is helpful or required in the following cases:

1. Special EnDat encoder with diagnostics for evaluation
In this case, the valuation numbers from the encoder are read cyclically via additional information. Only the valuation numbers that the encoder supports.

# 6 Encoder

MOOG ID No.:CB40859-001 Date:11/2020

will be read. During the initialization process, the system will read the encoder to determine which valuation numbers it supports. When P 640[0] - ENDAT_Select = 1, the function will be enabled in the controller and the internal diagnostics in the EnDaT encoder will be enabled as well. The EnDat encoder will keep this setting even after being powered off. To explicitly disable the internal diagnostics in the EnDat encoder, set P 640[0] - ENDAT_Select to 2.

# 2. Evaluation of internal warnings

In this scenario, certain internal warnings from the encoder will be read from the encoder via additional information. Only the warnings that both the encoder and the Servo Drive’s software support will be read. During the initialization process, the system will read the encoder to determine which warnings it supports. When P 640[0] - ENDAT_Select = 3, the function will be enabled in the controller.

**Table 6.7: Channel 1 encoder configuration (X7) - EnDat parameters**
|ID|Index Name|Unit|Description|
|---|---|---|---|
|505|0 ENC_CH1_Sel|= ENDAT(4)| |
|543|0 ENC_CH1_MultiT|Number of MultiTurn bits (absolute encoder)| |
|544|0 ENC_CH1_SingleT|Number of SingleTurn bits (absolute encoder)| |
|547|0 ENC_CH1_MTBase|Definition of point of discontinuity in multi-turn range| |
|548|0 ENC_CH1_MTEnable|1: Use Multi-turn encoder as a single-turn encoder| |
|616|0 ENC_CH1_CycleCount|Position encoder sampling cycle (n x 125 μsec)| |
|598|0 ENC_CH1_Position|inc|Position encoder channel 1|
|554|0 ENC_CH1_|nm|Length of one increment (linear absolute encoder)|
|640|ENC_ENDAT| |EnDat additional (additional information)|
|640|0 ENDAT_Select|0=off|EnDat function selection, 1/2=diagnosis on/off, 3=warnings, FF=lock|
|640|1 ENDAT_DiagCount|u16|count new diagnosis block header|
|640|2 ENDAT_BWZ_1|lowbyte|vn1: incremental track|
|640|3 ENDAT_BWZ_3|lowbyte|vn3: absolute track|
|640|4 ENDAT_BWZ_4|lowbyte|vn4: position value formation|
|640|5 ENDAT_Status| |EnDat additional status output|
|640|6 ENDAT_Z1_Sel| |EnDat additional information 1 type selection|

**Table 6.7: Overwrite Channel 1 encoder configuration (X7) - EnDat parameters (continue)**
|ID|Index Name|Unit|Description|
|---|---|---|---|
|640|7 ENDAT_Z1_1| |Z1 info: dword 1|
|640|8 ENDAT_Z1_2| |Z1 info: dword 2|
|640|9 ENDAT_Z1_3| |Z1 info: dword 3|
|640|10 ENDAT_Z1_4| |Z1 info: dword 4|
|640|11 ENDAT_Z2_Sel| |EnDat additional information 2 type selection|
|640|12 ENDAT_Z2_1| |Z2 info: dword 1|
|640|13 ENDAT_Z2_2| |Z2 info: dword 2|
|640|14 ENDAT_Z2_3| |Z2 info: dword 3|
|640|15 ENDAT_Z2_4| |Z2 info: dword 4|
|640|16 ENDAT_Mode1|0=off|EnDat additional mode 1 selection|
|640|17 ENDAT_Mode2| |EnDat additional mode 2 selection|
|640|18 ENDAT_Mode3| |EnDat additional mode 3 selection|
|640|19 ENDAT_Mode4| |EnDat additional mode 4 selection|
|640|20 ENDAT_res1| |reserved 1|
|640|21 ENDAT_res2| |reserved 2|
|640|22 ENDAT_res3| |reserved 3|
|640|23 ENDAT_HwSyncStop|0=SyncOn|EnDat cyclic hw sync, stop/start 1/0|
|640|24 ENDAT_CyclCount| |call counter of cyclic function|
|640|25 ENDAT_BWZ_Supported| |vn supported (bit3=vn4, bit2=vn3, bit0=vn1)|
|640|26 ENDAT_BWZ1_| |vn1: bits[7..0] threshold level, bits[31..16]|
|640|27 ThresholdLevel| |how often number|
|640|28 ENDAT_BWZ3_| |vn3: bits[7..0] threshold level, bits[31..16]|
|640|29 ThresholdLevel| |how often number|
|640|30 ENDAT_BWZ4_| |vn4: bits[7..0] threshold level, bits[31..16]|
|640|31 ThresholdLevel| |how often number|
|640|32 ENDAT_BWZ_TEST_| |vn: bits[15..12] 'F', bits[11..8] vn.no., bits [7..0] vn overwrite value|

# 6.5.3 Hall sensor X7

Ch1: HALL(5) - Digital hall signals

Ch1: HALL_TTL(7) - Digital hall signals

NOTE

l The operation and configuration of Hall effect sensors is reserved for special applications. Consult with Moog if needed.

# 6.5.4 Sin/Cos / TTL X7

# 6.5.4.1 TTL encoder

Ch1: TTL(3) - TTL signals

TTL encoders are ...

- a. ... ... usually pure incremental encoders without an absolute value interface.
- b. In this case, P 540[0] - ENC_CH1_Abs must be set to OFF(0). ... ... in a few exceptional cases, incremental encoders with an SSI absolute value interface. In this case, P 540[0] - ENC_CH1_Abs must be accordingly set to SSI(1) (SSI_CONT(4) in special cases), so that it will be possible to read the absolute encoder position for the absolute value initialization routine once during the initialization phase.

# 6.5.4.1.1 Pure TTL incremental encoder

Set P 505[0] - ENC_CH1_Sel to TTL(3) and P 540[0] - ENC_CH1_Abs to OFF(0) when using pure TTL encoders, i.e. encoders without an absolute value interface but with a TTL zero pulse.

Linear TTL encoders are run as rotary encoders. For linear motor operation, P 542 [0] - ENC_CH1_Lines and the encoder gearing (see the “Encoder gearing” section) are used to establish the ratio for the linear motor’s pole pair subdivision (North-North) for commutation. 1 x North-North corresponds to one revolution from Lines. In this case, the motor pole pair number must be set to 1. Moreover, P 553[0] - ENC_CH1_PeriodLen is not used in this case.

The TTL interface accepts various TTL signal types, which can be selected using P 558[0] - ENC_CH1_TTL_SignalType:

- (0)AF_B - A/B tracks (forward counting, X4 encoding) - AB
- (1)AR_B - A/B tracks (reverse counting, X4 encoding) - AB_inv
- (2)ABDFN - A: Clock (falling edge), B: Direction (1 = positive) - PulseDir
- (3)ABDRP - A: Clock (rising edge), B: Direction (1 = negative) - PulseDir_inv
- (4)reserved

A maximum interpolation period, in ms (milliseconds), can be configured for the TTL interface using P 601[0] - ENC_CH1_Period. Within this context, Period is the maximum time of “no activity” since the last TTL counter event:

- Period = 0: Function disabled (default)
- Period > 0 (=n ms): If no counter event is registered in n ms, the speed will be set to 0.

# Zero pulse

There is no parameter for activating the zero pulse evaluation here, as this evaluation is controlled exclusively based on the homing mode (see Section ""Homing"" on page 249). However, setting P 541[0] - ENC_CH1_NpTest to 1 provides a test mode that can be used during commissioning in order to be able to activate the zero pulse evaluation even without homing. Scope signals 1014 and 1016 can be used to view a received zero pulse within this context. This test mode must be disabled during normal operation (P 541[0] = 0).

# Commutation

Motor operation with pure incremental encoders needs for the auto commutation function to be enabled without fail. For details see Section ""Synchronous motor auto commutation"" on page 156.

# 6.5.4.1.2 TTL incremental encoder with SSI absolute value interface

See Section ""Sin/Cos incremental encoders with absolute value interface"" on page 65 and in special Section ""SSI absolute value interface"" on page 67.

MSD ServoDrive - DeviceHelp

# 6 Encoder

MOOG ID No.:CB40859-001 Date:11/2020 MSD ServoDrive - DeviceHelp 64

|ID|Index Name|Unit|Description|
|---|---|---|---|
|505|0|ENC_CH1_Sel = 3|Encoder selection set to TTL(3)|
|510|0|ENC_CH1_Num|Encoder gearing: Numerator Ch1: SINCOS(1) - Sin/Cos signals|
|511|0|ENC_CH1_Denom|Encoder gearing: Denominator|
|540|0|ENC_CH1_Abs|Selection of absolute value interface Sin/Cos encoders can ...|
|541|0|ENC_CH1_NpTest|ENC CH1, TEST-MODE: Index pulse signal(s) to Scope|
|542|0|ENC_CH1_lines|Number of lines (Sin/Cos / TTL encoders) a. Be pure incremental encoders without an absolute value interface. In this|
|558|0|ENC_CH1_TTL_SignalType|Channel 1: TTL signal selection case, P 540[0] - ENC_CH1_Abs must be set to OFF(0).|
|601|0|ENC_CH1_Period|Maximum period of interpolation (TTL encoder)|
|616|0|ENC_CH1_CycleCount|Sampling cycle in: n x 125 μ (microseconds) b. Be incremental encoders with an absolute value interface. In this case,|

Table 6.8: Parameters for Channel 1 (X7) - TTL encoder

ENC_CH1_Abs must be accordingly set to SSI(1), EnDat(2), HIPER(3) or, in special cases, SSI_CONT(4) so that it will be possible to read the absolute encoder position for the absolute value initialization routine once during the initialization phase.

# 6.5.4.2.1 Purely Sin/Cos incremental encoders

To run these encoders as purely incremental encoders with a zero pulse on encoder channel Ch1 (without an absolute value interface), the approach is basically the same as for purely TTL operation (see Section ""TTL encoder"" on page 63). The same parameters apply.

However, there are the following differences:

- a. There are no different signal types for the Sin/Cos signal (always 1 Vss for cosine and sine).
- b. The zero pulse is the analog zero pulse typical of Sin/Cos encoders (see the “Connection for high-resolution encoders” section in the operation manual MSD Servo Drive Single-Axis System, for example).

# 6.5.4.2.2 Linear Sin/Cos

|ID|Index Name|Unit|Description|
|---|---|---|---|
|542|ENC_CH1_lines| |Number of Lines (Sin/Cos / TTL encoders)|
|543|ENC_CH1_MultiT| |Number of MultiTurn bits (absolute encoder)|
|544|ENC_CH1_SingleT| |Number of SingleTurn bits (absolute encoder)|
|545|ENC_CH1_Code| |Code selection (SSI encoder) (binary, gray)|
|546|ENC_CH1_Mode| |Mode selection (SSI encoder)|
|547|ENC_CH1_MTBase| |Definition of point of discontinuity in multi-turn range|
|548|ENC_CH1_MTEnable| |Enable MultiTurn use (negative logic, 1=MToff)|
|549|ENC_CH1_Corr| |Signal correction type|
|550|ENC_CH1_CorrVal|0-4|Signal correction values|
|551|ENC_CH1_EncObsMin| |Encoder monitoring minimum, sqrt(a^2+b^2)|
|552|ENC_CH1_AbsEncStatus| |Error and status codes (absolute encoder)|

# 6.5.4.2.3 Signal correction (GPOC)

|ID|Index Name|Unit|Description|
|---|---|---|---|
|553|ENC_CH1_PeriodLen|nm|Length of signal period (Sin/Cos linear encoder)|
|554|ENC_CH1_DigitalResolution|nm|Length of one increment (linear absolute encoder)|
|555|ENC_CH1_Info| |Encoder information|
|616|ENC_CH1_CycleCount| |Sampling cycle in: n x 125 μ (microseconds)|
|610|ENC_CH1_NominalIncrementA| |Sign. Nominal increment A (distance coded abs. per. encoder)|
|611|ENC_CH1_NominalIncrementB| |Sign. Nominal increment B (distance coded abs. per. encoder)|
|1900|ENC_ETS| |ETS mode, electronic nameplate|

# 6.5.4.2.4 Sin/Cos incremental encoders with absolute value interface

The following table lists the parameters for cyclical Sin/Cos operation on encoder channel Ch 1 with one-time reading of the absolute encoder position via the absolute value interface, i.e. without a zero pulse:

|ID|Index Name|Unit|Description|
|---|---|---|---|
|505|ENC_CH1_Sel|1|Encoder selection set to SINCOS(1)|
|510|ENC_CH1_Num| |Encoder gearing: Numerator|
|511|ENC_CH1_Denom| |Encoder gearing: Denominator|
|540|ENC_CH1_Abs| |Absolute value interface selection (one-time reading)|

Table 6.9: Parameters for channel 1 (X7) - Sin/Cos encoder

The Sel, Num, Denom, Abs, Lines, MultiT, SingleT and CorrVal parameters are self-explanatory.

The Code and Mode parameters are described in Section ""SSI (cyclical) X7"" on page 69.

P 547[0] - ENC_CH1_MTBase = Minimum MultiTurn position

The MTBase parameter is used to set a position in the multi-turn encoder’s travel path that defines the point of discontinuity (overflow/underflow) for the absolute value initialization (that is, the “multi-turn basis”). Assuming a bipolar encoder measuring range, all position values that fall below MTBase will be shifted “up” (the whole MT range will be added to them once).

MOOG ID No.:CB40859-001 Date:11/2020

MSD ServoDrive - DeviceHelp

# 6 Encoder

MOOG ID No.:CB40859-001 Date:11/2020

method makes it possible to place the point of discontinuity at any point within the encoder’s entire measuring range. By default, MTBase will be set to the lowest possible value for the parameter, i.e. reliably outside of the encoder’s value range: In this case, the full bipolar range will remain unaffected, as values will never fall below this MTBase threshold (see Section ""Channel 1: Interface X7"" on page 59).

- P 548[0] - ENC_CH1_MTEnable = MultiTurn as SingleTurn
- The MTEnable parameter makes it possible to use multi-turn encoders as single-turn encoders for test purposes. Negative logic: Default MTEnable = 0 means ""MultiTurn-Enable ON"".

P 549[0] - ENC_CH1_Corr = Signal correction type
- The GPOC routine used for track signal correction purposes for sine/cosine signals is used to compensate for systematic errors. The routine is controlled with the Corr and CorrVal parameters (see Section ""Signal correction GPOC (Gain Phase Offset Correction)"" on page 74).

P 551[0] - ENC_CH1_EncObsMin = Encoder monitoring minimum, sqrt (a^2+b^2)
- The parameter EncObsMin is used to scale the Sin/Cos wire break monitoring and represents the “downwards threshold” for an error message. The default setting is 0.2, corresponding to approx. ",How does the P 554[0] - ENC_CH1_DigitalResolution parameter function in the context of linear encoders?,A5,"The parameter is key for linear encoders, detailing each increment's length in nanometers to ensure precise position value transmission.",2.671875,2.625,3.71875,1.734375,0.79296875
10,msd_servo_drive.txt,20,02f242a213dfa4411d028ce46dfba16a3f97395fa25788fcbaea1715e779d934,"), consult with your project supervisor or the Helpline provided by Moog before using any special SSI protocol modes.

# 6.5.2 EnDat (cyclical) X7

Ch1: ENDAT(4) - Cyclical EnDat (2.1 or 2.2) EnDat is a digital encoder interface developed by HEIDENHAIN. For more details, please visit www.heidenhain.de and go to ►Documentation ►Fundamentals ►Interfaces ►EnDat 2.2.

The software versions required to run the EnDat encoder interface are the standard software versions for the MSD Servo Drive and MSD Single-Axis Servo Drive Compact.

MOOG ID No.:CB40859-001 Date:11/2020

# 6 Encoder

NOTE

- Please note the limitations that apply when running EnDat and SSI encoders (see Section ""Limiting for EnDat and SSI"" on page 52).

When using linear encoders, P 554[0] - ENC_CH1_DigitalResolution is used instead of P 543[0] - ENC_CH1_MultiT and P 544[0] - ENC_CH1_SingleT (which are used for rotary encoders). The values will be read from the EnDat encoder and written to the aforementioned parameters.

- P 543[0] - ENC_CH1_MultiT
- The number ""n"" of multiturn bits defines the measuring range in 2n increments per encoder shaft revolution; maximum travel until overflow; maximum travel within which the absolute value initialization can be unambiguous. In the case of single-turn encoders, MultiT = 0.
- P 544[0] - ENC_CH1_SingleT
- The number ""n"" of single-turn bits corresponds to the encoder’s digital resolution in 2n increments per encoder shaft revolution.
- P 554[0] - ENC_CH1_DigitalResolution
- This is the length of an increment, in nanometres, of the encoder’s digitally transmitted position value. This value is read from the EnDat linear head.

In the case of linear encoders, the number n of transmitted position bits from the encoder will be found in SingleT only! 2n * DigitalResolution yields the maximum travel in nanometres (for the encoder head).

P 640 - ENC_ENDAT is intended for additional information, but is normally not needed. This parameter does not have a Ch1 or Ch3 prefix for the encoder channel in the name, as it applies to both encoder channels. Although usually not needed, the parameter is helpful or required in the following cases:

1. Special EnDat encoder with diagnostics for evaluation
In this case, the valuation numbers from the encoder are read cyclically via additional information. Only the valuation numbers that the encoder supports.

# 6 Encoder

MOOG ID No.:CB40859-001 Date:11/2020

will be read. During the initialization process, the system will read the encoder to determine which valuation numbers it supports. When P 640[0] - ENDAT_Select = 1, the function will be enabled in the controller and the internal diagnostics in the EnDaT encoder will be enabled as well. The EnDat encoder will keep this setting even after being powered off. To explicitly disable the internal diagnostics in the EnDat encoder, set P 640[0] - ENDAT_Select to 2.

# 2. Evaluation of internal warnings

In this scenario, certain internal warnings from the encoder will be read from the encoder via additional information. Only the warnings that both the encoder and the Servo Drive’s software support will be read. During the initialization process, the system will read the encoder to determine which warnings it supports. When P 640[0] - ENDAT_Select = 3, the function will be enabled in the controller.

**Table 6.7: Channel 1 encoder configuration (X7) - EnDat parameters**
|ID|Index Name|Unit|Description|
|---|---|---|---|
|505|0 ENC_CH1_Sel|= ENDAT(4)| |
|543|0 ENC_CH1_MultiT|Number of MultiTurn bits (absolute encoder)| |
|544|0 ENC_CH1_SingleT|Number of SingleTurn bits (absolute encoder)| |
|547|0 ENC_CH1_MTBase|Definition of point of discontinuity in multi-turn range| |
|548|0 ENC_CH1_MTEnable|1: Use Multi-turn encoder as a single-turn encoder| |
|616|0 ENC_CH1_CycleCount|Position encoder sampling cycle (n x 125 μsec)| |
|598|0 ENC_CH1_Position|inc|Position encoder channel 1|
|554|0 ENC_CH1_|nm|Length of one increment (linear absolute encoder)|
|640|ENC_ENDAT| |EnDat additional (additional information)|
|640|0 ENDAT_Select|0=off|EnDat function selection, 1/2=diagnosis on/off, 3=warnings, FF=lock|
|640|1 ENDAT_DiagCount|u16|count new diagnosis block header|
|640|2 ENDAT_BWZ_1|lowbyte|vn1: incremental track|
|640|3 ENDAT_BWZ_3|lowbyte|vn3: absolute track|
|640|4 ENDAT_BWZ_4|lowbyte|vn4: position value formation|
|640|5 ENDAT_Status| |EnDat additional status output|
|640|6 ENDAT_Z1_Sel| |EnDat additional information 1 type selection|

**Table 6.7: Overwrite Channel 1 encoder configuration (X7) - EnDat parameters (continue)**
|ID|Index Name|Unit|Description|
|---|---|---|---|
|640|7 ENDAT_Z1_1| |Z1 info: dword 1|
|640|8 ENDAT_Z1_2| |Z1 info: dword 2|
|640|9 ENDAT_Z1_3| |Z1 info: dword 3|
|640|10 ENDAT_Z1_4| |Z1 info: dword 4|
|640|11 ENDAT_Z2_Sel| |EnDat additional information 2 type selection|
|640|12 ENDAT_Z2_1| |Z2 info: dword 1|
|640|13 ENDAT_Z2_2| |Z2 info: dword 2|
|640|14 ENDAT_Z2_3| |Z2 info: dword 3|
|640|15 ENDAT_Z2_4| |Z2 info: dword 4|
|640|16 ENDAT_Mode1|0=off|EnDat additional mode 1 selection|
|640|17 ENDAT_Mode2| |EnDat additional mode 2 selection|
|640|18 ENDAT_Mode3| |EnDat additional mode 3 selection|
|640|19 ENDAT_Mode4| |EnDat additional mode 4 selection|
|640|20 ENDAT_res1| |reserved 1|
|640|21 ENDAT_res2| |reserved 2|
|640|22 ENDAT_res3| |reserved 3|
|640|23 ENDAT_HwSyncStop|0=SyncOn|EnDat cyclic hw sync, stop/start 1/0|
|640|24 ENDAT_CyclCount| |call counter of cyclic function|
|640|25 ENDAT_BWZ_Supported| |vn supported (bit3=vn4, bit2=vn3, bit0=vn1)|
|640|26 ENDAT_BWZ1_| |vn1: bits[7..0] threshold level, bits[31..16]|
|640|27 ThresholdLevel| |how often number|
|640|28 ENDAT_BWZ3_| |vn3: bits[7..0] threshold level, bits[31..16]|
|640|29 ThresholdLevel| |how often number|
|640|30 ENDAT_BWZ4_| |vn4: bits[7..0] threshold level, bits[31..16]|
|640|31 ThresholdLevel| |how often number|
|640|32 ENDAT_BWZ_TEST_| |vn: bits[15..12] 'F', bits[11..8] vn.no., bits [7..0] vn overwrite value|

# 6.5.3 Hall sensor X7

Ch1: HALL(5) - Digital hall signals

Ch1: HALL_TTL(7) - Digital hall signals

NOTE

l The operation and configuration of Hall effect sensors is reserved for special applications. Consult with Moog if needed.

# 6.5.4 Sin/Cos / TTL X7

# 6.5.4.1 TTL encoder

Ch1: TTL(3) - TTL signals

TTL encoders are ...

- a. ... ... usually pure incremental encoders without an absolute value interface.
- b. In this case, P 540[0] - ENC_CH1_Abs must be set to OFF(0). ... ... in a few exceptional cases, incremental encoders with an SSI absolute value interface. In this case, P 540[0] - ENC_CH1_Abs must be accordingly set to SSI(1) (SSI_CONT(4) in special cases), so that it will be possible to read the absolute encoder position for the absolute value initialization routine once during the initialization phase.

# 6.5.4.1.1 Pure TTL incremental encoder

Set P 505[0] - ENC_CH1_Sel to TTL(3) and P 540[0] - ENC_CH1_Abs to OFF(0) when using pure TTL encoders, i.e. encoders without an absolute value interface but with a TTL zero pulse.

Linear TTL encoders are run as rotary encoders. For linear motor operation, P 542 [0] - ENC_CH1_Lines and the encoder gearing (see the “Encoder gearing” section) are used to establish the ratio for the linear motor’s pole pair subdivision (North-North) for commutation. 1 x North-North corresponds to one revolution from Lines. In this case, the motor pole pair number must be set to 1. Moreover, P 553[0] - ENC_CH1_PeriodLen is not used in this case.

The TTL interface accepts various TTL signal types, which can be selected using P 558[0] - ENC_CH1_TTL_SignalType:

- (0)AF_B - A/B tracks (forward counting, X4 encoding) - AB
- (1)AR_B - A/B tracks (reverse counting, X4 encoding) - AB_inv
- (2)ABDFN - A: Clock (falling edge), B: Direction (1 = positive) - PulseDir
- (3)ABDRP - A: Clock (rising edge), B: Direction (1 = negative) - PulseDir_inv
- (4)reserved

A maximum interpolation period, in ms (milliseconds), can be configured for the TTL interface using P 601[0] - ENC_CH1_Period. Within this context, Period is the maximum time of “no activity” since the last TTL counter event:

- Period = 0: Function disabled (default)
- Period > 0 (=n ms): If no counter event is registered in n ms, the speed will be set to 0.

# Zero pulse

There is no parameter for activating the zero pulse evaluation here, as this evaluation is controlled exclusively based on the homing mode (see Section ""Homing"" on page 249). However, setting P 541[0] - ENC_CH1_NpTest to 1 provides a test mode that can be used during commissioning in order to be able to activate the zero pulse evaluation even without homing. Scope signals 1014 and 1016 can be used to view a received zero pulse within this context. This test mode must be disabled during normal operation (P 541[0] = 0).

# Commutation

Motor operation with pure incremental encoders needs for the auto commutation function to be enabled without fail. For details see Section ""Synchronous motor auto commutation"" on page 156.

# 6.5.4.1.2 TTL incremental encoder with SSI absolute value interface

See Section ""Sin/Cos incremental encoders with absolute value interface"" on page 65 and in special Section ""SSI absolute value interface"" on page 67.

MSD ServoDrive - DeviceHelp

# 6 Encoder

MOOG ID No.:CB40859-001 Date:11/2020 MSD ServoDrive - DeviceHelp 64

|ID|Index Name|Unit|Description|
|---|---|---|---|
|505|0|ENC_CH1_Sel = 3|Encoder selection set to TTL(3)|
|510|0|ENC_CH1_Num|Encoder gearing: Numerator Ch1: SINCOS(1) - Sin/Cos signals|
|511|0|ENC_CH1_Denom|Encoder gearing: Denominator|
|540|0|ENC_CH1_Abs|Selection of absolute value interface Sin/Cos encoders can ...|
|541|0|ENC_CH1_NpTest|ENC CH1, TEST-MODE: Index pulse signal(s) to Scope|
|542|0|ENC_CH1_lines|Number of lines (Sin/Cos / TTL encoders) a. Be pure incremental encoders without an absolute value interface. In this|
|558|0|ENC_CH1_TTL_SignalType|Channel 1: TTL signal selection case, P 540[0] - ENC_CH1_Abs must be set to OFF(0).|
|601|0|ENC_CH1_Period|Maximum period of interpolation (TTL encoder)|
|616|0|ENC_CH1_CycleCount|Sampling cycle in: n x 125 μ (microseconds) b. Be incremental encoders with an absolute value interface. In this case,|

Table 6.8: Parameters for Channel 1 (X7) - TTL encoder

ENC_CH1_Abs must be accordingly set to SSI(1), EnDat(2), HIPER(3) or, in special cases, SSI_CONT(4) so that it will be possible to read the absolute encoder position for the absolute value initialization routine once during the initialization phase.

# 6.5.4.2.1 Purely Sin/Cos incremental encoders

To run these encoders as purely incremental encoders with a zero pulse on encoder channel Ch1 (without an absolute value interface), the approach is basically the same as for purely TTL operation (see Section ""TTL encoder"" on page 63). The same parameters apply.

However, there are the following differences:

- a. There are no different signal types for the Sin/Cos signal (always 1 Vss for cosine and sine).
- b. The zero pulse is the analog zero pulse typical of Sin/Cos encoders (see the “Connection for high-resolution encoders” section in the operation manual MSD Servo Drive Single-Axis System, for example).

# 6.5.4.2.2 Linear Sin/Cos

|ID|Index Name|Unit|Description|
|---|---|---|---|
|542|ENC_CH1_lines| |Number of Lines (Sin/Cos / TTL encoders)|
|543|ENC_CH1_MultiT| |Number of MultiTurn bits (absolute encoder)|
|544|ENC_CH1_SingleT| |Number of SingleTurn bits (absolute encoder)|
|545|ENC_CH1_Code| |Code selection (SSI encoder) (binary, gray)|
|546|ENC_CH1_Mode| |Mode selection (SSI encoder)|
|547|ENC_CH1_MTBase| |Definition of point of discontinuity in multi-turn range|
|548|ENC_CH1_MTEnable| |Enable MultiTurn use (negative logic, 1=MToff)|
|549|ENC_CH1_Corr| |Signal correction type|
|550|ENC_CH1_CorrVal|0-4|Signal correction values|
|551|ENC_CH1_EncObsMin| |Encoder monitoring minimum, sqrt(a^2+b^2)|
|552|ENC_CH1_AbsEncStatus| |Error and status codes (absolute encoder)|

# 6.5.4.2.3 Signal correction (GPOC)

|ID|Index Name|Unit|Description|
|---|---|---|---|
|553|ENC_CH1_PeriodLen|nm|Length of signal period (Sin/Cos linear encoder)|
|554|ENC_CH1_DigitalResolution|nm|Length of one increment (linear absolute encoder)|
|555|ENC_CH1_Info| |Encoder information|
|616|ENC_CH1_CycleCount| |Sampling cycle in: n x 125 μ (microseconds)|
|610|ENC_CH1_NominalIncrementA| |Sign. Nominal increment A (distance coded abs. per. encoder)|
|611|ENC_CH1_NominalIncrementB| |Sign. Nominal increment B (distance coded abs. per. encoder)|
|1900|ENC_ETS| |ETS mode, electronic nameplate|

# 6.5.4.2.4 Sin/Cos incremental encoders with absolute value interface

The following table lists the parameters for cyclical Sin/Cos operation on encoder channel Ch 1 with one-time reading of the absolute encoder position via the absolute value interface, i.e. without a zero pulse:

|ID|Index Name|Unit|Description|
|---|---|---|---|
|505|ENC_CH1_Sel|1|Encoder selection set to SINCOS(1)|
|510|ENC_CH1_Num| |Encoder gearing: Numerator|
|511|ENC_CH1_Denom| |Encoder gearing: Denominator|
|540|ENC_CH1_Abs| |Absolute value interface selection (one-time reading)|

Table 6.9: Parameters for channel 1 (X7) - Sin/Cos encoder

The Sel, Num, Denom, Abs, Lines, MultiT, SingleT and CorrVal parameters are self-explanatory.

The Code and Mode parameters are described in Section ""SSI (cyclical) X7"" on page 69.

P 547[0] - ENC_CH1_MTBase = Minimum MultiTurn position

The MTBase parameter is used to set a position in the multi-turn encoder’s travel path that defines the point of discontinuity (overflow/underflow) for the absolute value initialization (that is, the “multi-turn basis”). Assuming a bipolar encoder measuring range, all position values that fall below MTBase will be shifted “up” (the whole MT range will be added to them once).

MOOG ID No.:CB40859-001 Date:11/2020

MSD ServoDrive - DeviceHelp

# 6 Encoder

MOOG ID No.:CB40859-001 Date:11/2020

method makes it possible to place the point of discontinuity at any point within the encoder’s entire measuring range. By default, MTBase will be set to the lowest possible value for the parameter, i.e. reliably outside of the encoder’s value range: In this case, the full bipolar range will remain unaffected, as values will never fall below this MTBase threshold (see Section ""Channel 1: Interface X7"" on page 59).

- P 548[0] - ENC_CH1_MTEnable = MultiTurn as SingleTurn
- The MTEnable parameter makes it possible to use multi-turn encoders as single-turn encoders for test purposes. Negative logic: Default MTEnable = 0 means ""MultiTurn-Enable ON"".

P 549[0] - ENC_CH1_Corr = Signal correction type
- The GPOC routine used for track signal correction purposes for sine/cosine signals is used to compensate for systematic errors. The routine is controlled with the Corr and CorrVal parameters (see Section ""Signal correction GPOC (Gain Phase Offset Correction)"" on page 74).

P 551[0] - ENC_CH1_EncObsMin = Encoder monitoring minimum, sqrt (a^2+b^2)
- The parameter EncObsMin is used to scale the Sin/Cos wire break monitoring and represents the “downwards threshold” for an error message. The default setting is 0.2, corresponding to approx. ",How is the P 601[0] - ENC_CH1_Period parameter utilized in TTL encoder configurations?,A1,"P 601[0] sets the maximum interpolation period in milliseconds for TTL encoders, defining the inactivity time before speed is reset to zero.",2.3125,2.46875,3.546875,1.7265625,0.58984375
11,msd_servo_drive.txt,20,02f242a213dfa4411d028ce46dfba16a3f97395fa25788fcbaea1715e779d934,"), consult with your project supervisor or the Helpline provided by Moog before using any special SSI protocol modes.

# 6.5.2 EnDat (cyclical) X7

Ch1: ENDAT(4) - Cyclical EnDat (2.1 or 2.2) EnDat is a digital encoder interface developed by HEIDENHAIN. For more details, please visit www.heidenhain.de and go to ►Documentation ►Fundamentals ►Interfaces ►EnDat 2.2.

The software versions required to run the EnDat encoder interface are the standard software versions for the MSD Servo Drive and MSD Single-Axis Servo Drive Compact.

MOOG ID No.:CB40859-001 Date:11/2020

# 6 Encoder

NOTE

- Please note the limitations that apply when running EnDat and SSI encoders (see Section ""Limiting for EnDat and SSI"" on page 52).

When using linear encoders, P 554[0] - ENC_CH1_DigitalResolution is used instead of P 543[0] - ENC_CH1_MultiT and P 544[0] - ENC_CH1_SingleT (which are used for rotary encoders). The values will be read from the EnDat encoder and written to the aforementioned parameters.

- P 543[0] - ENC_CH1_MultiT
- The number ""n"" of multiturn bits defines the measuring range in 2n increments per encoder shaft revolution; maximum travel until overflow; maximum travel within which the absolute value initialization can be unambiguous. In the case of single-turn encoders, MultiT = 0.
- P 544[0] - ENC_CH1_SingleT
- The number ""n"" of single-turn bits corresponds to the encoder’s digital resolution in 2n increments per encoder shaft revolution.
- P 554[0] - ENC_CH1_DigitalResolution
- This is the length of an increment, in nanometres, of the encoder’s digitally transmitted position value. This value is read from the EnDat linear head.

In the case of linear encoders, the number n of transmitted position bits from the encoder will be found in SingleT only! 2n * DigitalResolution yields the maximum travel in nanometres (for the encoder head).

P 640 - ENC_ENDAT is intended for additional information, but is normally not needed. This parameter does not have a Ch1 or Ch3 prefix for the encoder channel in the name, as it applies to both encoder channels. Although usually not needed, the parameter is helpful or required in the following cases:

1. Special EnDat encoder with diagnostics for evaluation
In this case, the valuation numbers from the encoder are read cyclically via additional information. Only the valuation numbers that the encoder supports.

# 6 Encoder

MOOG ID No.:CB40859-001 Date:11/2020

will be read. During the initialization process, the system will read the encoder to determine which valuation numbers it supports. When P 640[0] - ENDAT_Select = 1, the function will be enabled in the controller and the internal diagnostics in the EnDaT encoder will be enabled as well. The EnDat encoder will keep this setting even after being powered off. To explicitly disable the internal diagnostics in the EnDat encoder, set P 640[0] - ENDAT_Select to 2.

# 2. Evaluation of internal warnings

In this scenario, certain internal warnings from the encoder will be read from the encoder via additional information. Only the warnings that both the encoder and the Servo Drive’s software support will be read. During the initialization process, the system will read the encoder to determine which warnings it supports. When P 640[0] - ENDAT_Select = 3, the function will be enabled in the controller.

**Table 6.7: Channel 1 encoder configuration (X7) - EnDat parameters**
|ID|Index Name|Unit|Description|
|---|---|---|---|
|505|0 ENC_CH1_Sel|= ENDAT(4)| |
|543|0 ENC_CH1_MultiT|Number of MultiTurn bits (absolute encoder)| |
|544|0 ENC_CH1_SingleT|Number of SingleTurn bits (absolute encoder)| |
|547|0 ENC_CH1_MTBase|Definition of point of discontinuity in multi-turn range| |
|548|0 ENC_CH1_MTEnable|1: Use Multi-turn encoder as a single-turn encoder| |
|616|0 ENC_CH1_CycleCount|Position encoder sampling cycle (n x 125 μsec)| |
|598|0 ENC_CH1_Position|inc|Position encoder channel 1|
|554|0 ENC_CH1_|nm|Length of one increment (linear absolute encoder)|
|640|ENC_ENDAT| |EnDat additional (additional information)|
|640|0 ENDAT_Select|0=off|EnDat function selection, 1/2=diagnosis on/off, 3=warnings, FF=lock|
|640|1 ENDAT_DiagCount|u16|count new diagnosis block header|
|640|2 ENDAT_BWZ_1|lowbyte|vn1: incremental track|
|640|3 ENDAT_BWZ_3|lowbyte|vn3: absolute track|
|640|4 ENDAT_BWZ_4|lowbyte|vn4: position value formation|
|640|5 ENDAT_Status| |EnDat additional status output|
|640|6 ENDAT_Z1_Sel| |EnDat additional information 1 type selection|

**Table 6.7: Overwrite Channel 1 encoder configuration (X7) - EnDat parameters (continue)**
|ID|Index Name|Unit|Description|
|---|---|---|---|
|640|7 ENDAT_Z1_1| |Z1 info: dword 1|
|640|8 ENDAT_Z1_2| |Z1 info: dword 2|
|640|9 ENDAT_Z1_3| |Z1 info: dword 3|
|640|10 ENDAT_Z1_4| |Z1 info: dword 4|
|640|11 ENDAT_Z2_Sel| |EnDat additional information 2 type selection|
|640|12 ENDAT_Z2_1| |Z2 info: dword 1|
|640|13 ENDAT_Z2_2| |Z2 info: dword 2|
|640|14 ENDAT_Z2_3| |Z2 info: dword 3|
|640|15 ENDAT_Z2_4| |Z2 info: dword 4|
|640|16 ENDAT_Mode1|0=off|EnDat additional mode 1 selection|
|640|17 ENDAT_Mode2| |EnDat additional mode 2 selection|
|640|18 ENDAT_Mode3| |EnDat additional mode 3 selection|
|640|19 ENDAT_Mode4| |EnDat additional mode 4 selection|
|640|20 ENDAT_res1| |reserved 1|
|640|21 ENDAT_res2| |reserved 2|
|640|22 ENDAT_res3| |reserved 3|
|640|23 ENDAT_HwSyncStop|0=SyncOn|EnDat cyclic hw sync, stop/start 1/0|
|640|24 ENDAT_CyclCount| |call counter of cyclic function|
|640|25 ENDAT_BWZ_Supported| |vn supported (bit3=vn4, bit2=vn3, bit0=vn1)|
|640|26 ENDAT_BWZ1_| |vn1: bits[7..0] threshold level, bits[31..16]|
|640|27 ThresholdLevel| |how often number|
|640|28 ENDAT_BWZ3_| |vn3: bits[7..0] threshold level, bits[31..16]|
|640|29 ThresholdLevel| |how often number|
|640|30 ENDAT_BWZ4_| |vn4: bits[7..0] threshold level, bits[31..16]|
|640|31 ThresholdLevel| |how often number|
|640|32 ENDAT_BWZ_TEST_| |vn: bits[15..12] 'F', bits[11..8] vn.no., bits [7..0] vn overwrite value|

# 6.5.3 Hall sensor X7

Ch1: HALL(5) - Digital hall signals

Ch1: HALL_TTL(7) - Digital hall signals

NOTE

l The operation and configuration of Hall effect sensors is reserved for special applications. Consult with Moog if needed.

# 6.5.4 Sin/Cos / TTL X7

# 6.5.4.1 TTL encoder

Ch1: TTL(3) - TTL signals

TTL encoders are ...

- a. ... ... usually pure incremental encoders without an absolute value interface.
- b. In this case, P 540[0] - ENC_CH1_Abs must be set to OFF(0). ... ... in a few exceptional cases, incremental encoders with an SSI absolute value interface. In this case, P 540[0] - ENC_CH1_Abs must be accordingly set to SSI(1) (SSI_CONT(4) in special cases), so that it will be possible to read the absolute encoder position for the absolute value initialization routine once during the initialization phase.

# 6.5.4.1.1 Pure TTL incremental encoder

Set P 505[0] - ENC_CH1_Sel to TTL(3) and P 540[0] - ENC_CH1_Abs to OFF(0) when using pure TTL encoders, i.e. encoders without an absolute value interface but with a TTL zero pulse.

Linear TTL encoders are run as rotary encoders. For linear motor operation, P 542 [0] - ENC_CH1_Lines and the encoder gearing (see the “Encoder gearing” section) are used to establish the ratio for the linear motor’s pole pair subdivision (North-North) for commutation. 1 x North-North corresponds to one revolution from Lines. In this case, the motor pole pair number must be set to 1. Moreover, P 553[0] - ENC_CH1_PeriodLen is not used in this case.

The TTL interface accepts various TTL signal types, which can be selected using P 558[0] - ENC_CH1_TTL_SignalType:

- (0)AF_B - A/B tracks (forward counting, X4 encoding) - AB
- (1)AR_B - A/B tracks (reverse counting, X4 encoding) - AB_inv
- (2)ABDFN - A: Clock (falling edge), B: Direction (1 = positive) - PulseDir
- (3)ABDRP - A: Clock (rising edge), B: Direction (1 = negative) - PulseDir_inv
- (4)reserved

A maximum interpolation period, in ms (milliseconds), can be configured for the TTL interface using P 601[0] - ENC_CH1_Period. Within this context, Period is the maximum time of “no activity” since the last TTL counter event:

- Period = 0: Function disabled (default)
- Period > 0 (=n ms): If no counter event is registered in n ms, the speed will be set to 0.

# Zero pulse

There is no parameter for activating the zero pulse evaluation here, as this evaluation is controlled exclusively based on the homing mode (see Section ""Homing"" on page 249). However, setting P 541[0] - ENC_CH1_NpTest to 1 provides a test mode that can be used during commissioning in order to be able to activate the zero pulse evaluation even without homing. Scope signals 1014 and 1016 can be used to view a received zero pulse within this context. This test mode must be disabled during normal operation (P 541[0] = 0).

# Commutation

Motor operation with pure incremental encoders needs for the auto commutation function to be enabled without fail. For details see Section ""Synchronous motor auto commutation"" on page 156.

# 6.5.4.1.2 TTL incremental encoder with SSI absolute value interface

See Section ""Sin/Cos incremental encoders with absolute value interface"" on page 65 and in special Section ""SSI absolute value interface"" on page 67.

MSD ServoDrive - DeviceHelp

# 6 Encoder

MOOG ID No.:CB40859-001 Date:11/2020 MSD ServoDrive - DeviceHelp 64

|ID|Index Name|Unit|Description|
|---|---|---|---|
|505|0|ENC_CH1_Sel = 3|Encoder selection set to TTL(3)|
|510|0|ENC_CH1_Num|Encoder gearing: Numerator Ch1: SINCOS(1) - Sin/Cos signals|
|511|0|ENC_CH1_Denom|Encoder gearing: Denominator|
|540|0|ENC_CH1_Abs|Selection of absolute value interface Sin/Cos encoders can ...|
|541|0|ENC_CH1_NpTest|ENC CH1, TEST-MODE: Index pulse signal(s) to Scope|
|542|0|ENC_CH1_lines|Number of lines (Sin/Cos / TTL encoders) a. Be pure incremental encoders without an absolute value interface. In this|
|558|0|ENC_CH1_TTL_SignalType|Channel 1: TTL signal selection case, P 540[0] - ENC_CH1_Abs must be set to OFF(0).|
|601|0|ENC_CH1_Period|Maximum period of interpolation (TTL encoder)|
|616|0|ENC_CH1_CycleCount|Sampling cycle in: n x 125 μ (microseconds) b. Be incremental encoders with an absolute value interface. In this case,|

Table 6.8: Parameters for Channel 1 (X7) - TTL encoder

ENC_CH1_Abs must be accordingly set to SSI(1), EnDat(2), HIPER(3) or, in special cases, SSI_CONT(4) so that it will be possible to read the absolute encoder position for the absolute value initialization routine once during the initialization phase.

# 6.5.4.2.1 Purely Sin/Cos incremental encoders

To run these encoders as purely incremental encoders with a zero pulse on encoder channel Ch1 (without an absolute value interface), the approach is basically the same as for purely TTL operation (see Section ""TTL encoder"" on page 63). The same parameters apply.

However, there are the following differences:

- a. There are no different signal types for the Sin/Cos signal (always 1 Vss for cosine and sine).
- b. The zero pulse is the analog zero pulse typical of Sin/Cos encoders (see the “Connection for high-resolution encoders” section in the operation manual MSD Servo Drive Single-Axis System, for example).

# 6.5.4.2.2 Linear Sin/Cos

|ID|Index Name|Unit|Description|
|---|---|---|---|
|542|ENC_CH1_lines| |Number of Lines (Sin/Cos / TTL encoders)|
|543|ENC_CH1_MultiT| |Number of MultiTurn bits (absolute encoder)|
|544|ENC_CH1_SingleT| |Number of SingleTurn bits (absolute encoder)|
|545|ENC_CH1_Code| |Code selection (SSI encoder) (binary, gray)|
|546|ENC_CH1_Mode| |Mode selection (SSI encoder)|
|547|ENC_CH1_MTBase| |Definition of point of discontinuity in multi-turn range|
|548|ENC_CH1_MTEnable| |Enable MultiTurn use (negative logic, 1=MToff)|
|549|ENC_CH1_Corr| |Signal correction type|
|550|ENC_CH1_CorrVal|0-4|Signal correction values|
|551|ENC_CH1_EncObsMin| |Encoder monitoring minimum, sqrt(a^2+b^2)|
|552|ENC_CH1_AbsEncStatus| |Error and status codes (absolute encoder)|

# 6.5.4.2.3 Signal correction (GPOC)

|ID|Index Name|Unit|Description|
|---|---|---|---|
|553|ENC_CH1_PeriodLen|nm|Length of signal period (Sin/Cos linear encoder)|
|554|ENC_CH1_DigitalResolution|nm|Length of one increment (linear absolute encoder)|
|555|ENC_CH1_Info| |Encoder information|
|616|ENC_CH1_CycleCount| |Sampling cycle in: n x 125 μ (microseconds)|
|610|ENC_CH1_NominalIncrementA| |Sign. Nominal increment A (distance coded abs. per. encoder)|
|611|ENC_CH1_NominalIncrementB| |Sign. Nominal increment B (distance coded abs. per. encoder)|
|1900|ENC_ETS| |ETS mode, electronic nameplate|

# 6.5.4.2.4 Sin/Cos incremental encoders with absolute value interface

The following table lists the parameters for cyclical Sin/Cos operation on encoder channel Ch 1 with one-time reading of the absolute encoder position via the absolute value interface, i.e. without a zero pulse:

|ID|Index Name|Unit|Description|
|---|---|---|---|
|505|ENC_CH1_Sel|1|Encoder selection set to SINCOS(1)|
|510|ENC_CH1_Num| |Encoder gearing: Numerator|
|511|ENC_CH1_Denom| |Encoder gearing: Denominator|
|540|ENC_CH1_Abs| |Absolute value interface selection (one-time reading)|

Table 6.9: Parameters for channel 1 (X7) - Sin/Cos encoder

The Sel, Num, Denom, Abs, Lines, MultiT, SingleT and CorrVal parameters are self-explanatory.

The Code and Mode parameters are described in Section ""SSI (cyclical) X7"" on page 69.

P 547[0] - ENC_CH1_MTBase = Minimum MultiTurn position

The MTBase parameter is used to set a position in the multi-turn encoder’s travel path that defines the point of discontinuity (overflow/underflow) for the absolute value initialization (that is, the “multi-turn basis”). Assuming a bipolar encoder measuring range, all position values that fall below MTBase will be shifted “up” (the whole MT range will be added to them once).

MOOG ID No.:CB40859-001 Date:11/2020

MSD ServoDrive - DeviceHelp

# 6 Encoder

MOOG ID No.:CB40859-001 Date:11/2020

method makes it possible to place the point of discontinuity at any point within the encoder’s entire measuring range. By default, MTBase will be set to the lowest possible value for the parameter, i.e. reliably outside of the encoder’s value range: In this case, the full bipolar range will remain unaffected, as values will never fall below this MTBase threshold (see Section ""Channel 1: Interface X7"" on page 59).

- P 548[0] - ENC_CH1_MTEnable = MultiTurn as SingleTurn
- The MTEnable parameter makes it possible to use multi-turn encoders as single-turn encoders for test purposes. Negative logic: Default MTEnable = 0 means ""MultiTurn-Enable ON"".

P 549[0] - ENC_CH1_Corr = Signal correction type
- The GPOC routine used for track signal correction purposes for sine/cosine signals is used to compensate for systematic errors. The routine is controlled with the Corr and CorrVal parameters (see Section ""Signal correction GPOC (Gain Phase Offset Correction)"" on page 74).

P 551[0] - ENC_CH1_EncObsMin = Encoder monitoring minimum, sqrt (a^2+b^2)
- The parameter EncObsMin is used to scale the Sin/Cos wire break monitoring and represents the “downwards threshold” for an error message. The default setting is 0.2, corresponding to approx. ",How is the P 601[0] - ENC_CH1_Period parameter utilized in TTL encoder configurations?,A2,"This parameter controls the TTL interface's response to inactivity, with a value >0 enabling speed reset after the specified ms of no activity.",1.9140625,2.03125,3.515625,1.65625,0.447265625
12,msd_servo_drive.txt,20,02f242a213dfa4411d028ce46dfba16a3f97395fa25788fcbaea1715e779d934,"), consult with your project supervisor or the Helpline provided by Moog before using any special SSI protocol modes.

# 6.5.2 EnDat (cyclical) X7

Ch1: ENDAT(4) - Cyclical EnDat (2.1 or 2.2) EnDat is a digital encoder interface developed by HEIDENHAIN. For more details, please visit www.heidenhain.de and go to ►Documentation ►Fundamentals ►Interfaces ►EnDat 2.2.

The software versions required to run the EnDat encoder interface are the standard software versions for the MSD Servo Drive and MSD Single-Axis Servo Drive Compact.

MOOG ID No.:CB40859-001 Date:11/2020

# 6 Encoder

NOTE

- Please note the limitations that apply when running EnDat and SSI encoders (see Section ""Limiting for EnDat and SSI"" on page 52).

When using linear encoders, P 554[0] - ENC_CH1_DigitalResolution is used instead of P 543[0] - ENC_CH1_MultiT and P 544[0] - ENC_CH1_SingleT (which are used for rotary encoders). The values will be read from the EnDat encoder and written to the aforementioned parameters.

- P 543[0] - ENC_CH1_MultiT
- The number ""n"" of multiturn bits defines the measuring range in 2n increments per encoder shaft revolution; maximum travel until overflow; maximum travel within which the absolute value initialization can be unambiguous. In the case of single-turn encoders, MultiT = 0.
- P 544[0] - ENC_CH1_SingleT
- The number ""n"" of single-turn bits corresponds to the encoder’s digital resolution in 2n increments per encoder shaft revolution.
- P 554[0] - ENC_CH1_DigitalResolution
- This is the length of an increment, in nanometres, of the encoder’s digitally transmitted position value. This value is read from the EnDat linear head.

In the case of linear encoders, the number n of transmitted position bits from the encoder will be found in SingleT only! 2n * DigitalResolution yields the maximum travel in nanometres (for the encoder head).

P 640 - ENC_ENDAT is intended for additional information, but is normally not needed. This parameter does not have a Ch1 or Ch3 prefix for the encoder channel in the name, as it applies to both encoder channels. Although usually not needed, the parameter is helpful or required in the following cases:

1. Special EnDat encoder with diagnostics for evaluation
In this case, the valuation numbers from the encoder are read cyclically via additional information. Only the valuation numbers that the encoder supports.

# 6 Encoder

MOOG ID No.:CB40859-001 Date:11/2020

will be read. During the initialization process, the system will read the encoder to determine which valuation numbers it supports. When P 640[0] - ENDAT_Select = 1, the function will be enabled in the controller and the internal diagnostics in the EnDaT encoder will be enabled as well. The EnDat encoder will keep this setting even after being powered off. To explicitly disable the internal diagnostics in the EnDat encoder, set P 640[0] - ENDAT_Select to 2.

# 2. Evaluation of internal warnings

In this scenario, certain internal warnings from the encoder will be read from the encoder via additional information. Only the warnings that both the encoder and the Servo Drive’s software support will be read. During the initialization process, the system will read the encoder to determine which warnings it supports. When P 640[0] - ENDAT_Select = 3, the function will be enabled in the controller.

**Table 6.7: Channel 1 encoder configuration (X7) - EnDat parameters**
|ID|Index Name|Unit|Description|
|---|---|---|---|
|505|0 ENC_CH1_Sel|= ENDAT(4)| |
|543|0 ENC_CH1_MultiT|Number of MultiTurn bits (absolute encoder)| |
|544|0 ENC_CH1_SingleT|Number of SingleTurn bits (absolute encoder)| |
|547|0 ENC_CH1_MTBase|Definition of point of discontinuity in multi-turn range| |
|548|0 ENC_CH1_MTEnable|1: Use Multi-turn encoder as a single-turn encoder| |
|616|0 ENC_CH1_CycleCount|Position encoder sampling cycle (n x 125 μsec)| |
|598|0 ENC_CH1_Position|inc|Position encoder channel 1|
|554|0 ENC_CH1_|nm|Length of one increment (linear absolute encoder)|
|640|ENC_ENDAT| |EnDat additional (additional information)|
|640|0 ENDAT_Select|0=off|EnDat function selection, 1/2=diagnosis on/off, 3=warnings, FF=lock|
|640|1 ENDAT_DiagCount|u16|count new diagnosis block header|
|640|2 ENDAT_BWZ_1|lowbyte|vn1: incremental track|
|640|3 ENDAT_BWZ_3|lowbyte|vn3: absolute track|
|640|4 ENDAT_BWZ_4|lowbyte|vn4: position value formation|
|640|5 ENDAT_Status| |EnDat additional status output|
|640|6 ENDAT_Z1_Sel| |EnDat additional information 1 type selection|

**Table 6.7: Overwrite Channel 1 encoder configuration (X7) - EnDat parameters (continue)**
|ID|Index Name|Unit|Description|
|---|---|---|---|
|640|7 ENDAT_Z1_1| |Z1 info: dword 1|
|640|8 ENDAT_Z1_2| |Z1 info: dword 2|
|640|9 ENDAT_Z1_3| |Z1 info: dword 3|
|640|10 ENDAT_Z1_4| |Z1 info: dword 4|
|640|11 ENDAT_Z2_Sel| |EnDat additional information 2 type selection|
|640|12 ENDAT_Z2_1| |Z2 info: dword 1|
|640|13 ENDAT_Z2_2| |Z2 info: dword 2|
|640|14 ENDAT_Z2_3| |Z2 info: dword 3|
|640|15 ENDAT_Z2_4| |Z2 info: dword 4|
|640|16 ENDAT_Mode1|0=off|EnDat additional mode 1 selection|
|640|17 ENDAT_Mode2| |EnDat additional mode 2 selection|
|640|18 ENDAT_Mode3| |EnDat additional mode 3 selection|
|640|19 ENDAT_Mode4| |EnDat additional mode 4 selection|
|640|20 ENDAT_res1| |reserved 1|
|640|21 ENDAT_res2| |reserved 2|
|640|22 ENDAT_res3| |reserved 3|
|640|23 ENDAT_HwSyncStop|0=SyncOn|EnDat cyclic hw sync, stop/start 1/0|
|640|24 ENDAT_CyclCount| |call counter of cyclic function|
|640|25 ENDAT_BWZ_Supported| |vn supported (bit3=vn4, bit2=vn3, bit0=vn1)|
|640|26 ENDAT_BWZ1_| |vn1: bits[7..0] threshold level, bits[31..16]|
|640|27 ThresholdLevel| |how often number|
|640|28 ENDAT_BWZ3_| |vn3: bits[7..0] threshold level, bits[31..16]|
|640|29 ThresholdLevel| |how often number|
|640|30 ENDAT_BWZ4_| |vn4: bits[7..0] threshold level, bits[31..16]|
|640|31 ThresholdLevel| |how often number|
|640|32 ENDAT_BWZ_TEST_| |vn: bits[15..12] 'F', bits[11..8] vn.no., bits [7..0] vn overwrite value|

# 6.5.3 Hall sensor X7

Ch1: HALL(5) - Digital hall signals

Ch1: HALL_TTL(7) - Digital hall signals

NOTE

l The operation and configuration of Hall effect sensors is reserved for special applications. Consult with Moog if needed.

# 6.5.4 Sin/Cos / TTL X7

# 6.5.4.1 TTL encoder

Ch1: TTL(3) - TTL signals

TTL encoders are ...

- a. ... ... usually pure incremental encoders without an absolute value interface.
- b. In this case, P 540[0] - ENC_CH1_Abs must be set to OFF(0). ... ... in a few exceptional cases, incremental encoders with an SSI absolute value interface. In this case, P 540[0] - ENC_CH1_Abs must be accordingly set to SSI(1) (SSI_CONT(4) in special cases), so that it will be possible to read the absolute encoder position for the absolute value initialization routine once during the initialization phase.

# 6.5.4.1.1 Pure TTL incremental encoder

Set P 505[0] - ENC_CH1_Sel to TTL(3) and P 540[0] - ENC_CH1_Abs to OFF(0) when using pure TTL encoders, i.e. encoders without an absolute value interface but with a TTL zero pulse.

Linear TTL encoders are run as rotary encoders. For linear motor operation, P 542 [0] - ENC_CH1_Lines and the encoder gearing (see the “Encoder gearing” section) are used to establish the ratio for the linear motor’s pole pair subdivision (North-North) for commutation. 1 x North-North corresponds to one revolution from Lines. In this case, the motor pole pair number must be set to 1. Moreover, P 553[0] - ENC_CH1_PeriodLen is not used in this case.

The TTL interface accepts various TTL signal types, which can be selected using P 558[0] - ENC_CH1_TTL_SignalType:

- (0)AF_B - A/B tracks (forward counting, X4 encoding) - AB
- (1)AR_B - A/B tracks (reverse counting, X4 encoding) - AB_inv
- (2)ABDFN - A: Clock (falling edge), B: Direction (1 = positive) - PulseDir
- (3)ABDRP - A: Clock (rising edge), B: Direction (1 = negative) - PulseDir_inv
- (4)reserved

A maximum interpolation period, in ms (milliseconds), can be configured for the TTL interface using P 601[0] - ENC_CH1_Period. Within this context, Period is the maximum time of “no activity” since the last TTL counter event:

- Period = 0: Function disabled (default)
- Period > 0 (=n ms): If no counter event is registered in n ms, the speed will be set to 0.

# Zero pulse

There is no parameter for activating the zero pulse evaluation here, as this evaluation is controlled exclusively based on the homing mode (see Section ""Homing"" on page 249). However, setting P 541[0] - ENC_CH1_NpTest to 1 provides a test mode that can be used during commissioning in order to be able to activate the zero pulse evaluation even without homing. Scope signals 1014 and 1016 can be used to view a received zero pulse within this context. This test mode must be disabled during normal operation (P 541[0] = 0).

# Commutation

Motor operation with pure incremental encoders needs for the auto commutation function to be enabled without fail. For details see Section ""Synchronous motor auto commutation"" on page 156.

# 6.5.4.1.2 TTL incremental encoder with SSI absolute value interface

See Section ""Sin/Cos incremental encoders with absolute value interface"" on page 65 and in special Section ""SSI absolute value interface"" on page 67.

MSD ServoDrive - DeviceHelp

# 6 Encoder

MOOG ID No.:CB40859-001 Date:11/2020 MSD ServoDrive - DeviceHelp 64

|ID|Index Name|Unit|Description|
|---|---|---|---|
|505|0|ENC_CH1_Sel = 3|Encoder selection set to TTL(3)|
|510|0|ENC_CH1_Num|Encoder gearing: Numerator Ch1: SINCOS(1) - Sin/Cos signals|
|511|0|ENC_CH1_Denom|Encoder gearing: Denominator|
|540|0|ENC_CH1_Abs|Selection of absolute value interface Sin/Cos encoders can ...|
|541|0|ENC_CH1_NpTest|ENC CH1, TEST-MODE: Index pulse signal(s) to Scope|
|542|0|ENC_CH1_lines|Number of lines (Sin/Cos / TTL encoders) a. Be pure incremental encoders without an absolute value interface. In this|
|558|0|ENC_CH1_TTL_SignalType|Channel 1: TTL signal selection case, P 540[0] - ENC_CH1_Abs must be set to OFF(0).|
|601|0|ENC_CH1_Period|Maximum period of interpolation (TTL encoder)|
|616|0|ENC_CH1_CycleCount|Sampling cycle in: n x 125 μ (microseconds) b. Be incremental encoders with an absolute value interface. In this case,|

Table 6.8: Parameters for Channel 1 (X7) - TTL encoder

ENC_CH1_Abs must be accordingly set to SSI(1), EnDat(2), HIPER(3) or, in special cases, SSI_CONT(4) so that it will be possible to read the absolute encoder position for the absolute value initialization routine once during the initialization phase.

# 6.5.4.2.1 Purely Sin/Cos incremental encoders

To run these encoders as purely incremental encoders with a zero pulse on encoder channel Ch1 (without an absolute value interface), the approach is basically the same as for purely TTL operation (see Section ""TTL encoder"" on page 63). The same parameters apply.

However, there are the following differences:

- a. There are no different signal types for the Sin/Cos signal (always 1 Vss for cosine and sine).
- b. The zero pulse is the analog zero pulse typical of Sin/Cos encoders (see the “Connection for high-resolution encoders” section in the operation manual MSD Servo Drive Single-Axis System, for example).

# 6.5.4.2.2 Linear Sin/Cos

|ID|Index Name|Unit|Description|
|---|---|---|---|
|542|ENC_CH1_lines| |Number of Lines (Sin/Cos / TTL encoders)|
|543|ENC_CH1_MultiT| |Number of MultiTurn bits (absolute encoder)|
|544|ENC_CH1_SingleT| |Number of SingleTurn bits (absolute encoder)|
|545|ENC_CH1_Code| |Code selection (SSI encoder) (binary, gray)|
|546|ENC_CH1_Mode| |Mode selection (SSI encoder)|
|547|ENC_CH1_MTBase| |Definition of point of discontinuity in multi-turn range|
|548|ENC_CH1_MTEnable| |Enable MultiTurn use (negative logic, 1=MToff)|
|549|ENC_CH1_Corr| |Signal correction type|
|550|ENC_CH1_CorrVal|0-4|Signal correction values|
|551|ENC_CH1_EncObsMin| |Encoder monitoring minimum, sqrt(a^2+b^2)|
|552|ENC_CH1_AbsEncStatus| |Error and status codes (absolute encoder)|

# 6.5.4.2.3 Signal correction (GPOC)

|ID|Index Name|Unit|Description|
|---|---|---|---|
|553|ENC_CH1_PeriodLen|nm|Length of signal period (Sin/Cos linear encoder)|
|554|ENC_CH1_DigitalResolution|nm|Length of one increment (linear absolute encoder)|
|555|ENC_CH1_Info| |Encoder information|
|616|ENC_CH1_CycleCount| |Sampling cycle in: n x 125 μ (microseconds)|
|610|ENC_CH1_NominalIncrementA| |Sign. Nominal increment A (distance coded abs. per. encoder)|
|611|ENC_CH1_NominalIncrementB| |Sign. Nominal increment B (distance coded abs. per. encoder)|
|1900|ENC_ETS| |ETS mode, electronic nameplate|

# 6.5.4.2.4 Sin/Cos incremental encoders with absolute value interface

The following table lists the parameters for cyclical Sin/Cos operation on encoder channel Ch 1 with one-time reading of the absolute encoder position via the absolute value interface, i.e. without a zero pulse:

|ID|Index Name|Unit|Description|
|---|---|---|---|
|505|ENC_CH1_Sel|1|Encoder selection set to SINCOS(1)|
|510|ENC_CH1_Num| |Encoder gearing: Numerator|
|511|ENC_CH1_Denom| |Encoder gearing: Denominator|
|540|ENC_CH1_Abs| |Absolute value interface selection (one-time reading)|

Table 6.9: Parameters for channel 1 (X7) - Sin/Cos encoder

The Sel, Num, Denom, Abs, Lines, MultiT, SingleT and CorrVal parameters are self-explanatory.

The Code and Mode parameters are described in Section ""SSI (cyclical) X7"" on page 69.

P 547[0] - ENC_CH1_MTBase = Minimum MultiTurn position

The MTBase parameter is used to set a position in the multi-turn encoder’s travel path that defines the point of discontinuity (overflow/underflow) for the absolute value initialization (that is, the “multi-turn basis”). Assuming a bipolar encoder measuring range, all position values that fall below MTBase will be shifted “up” (the whole MT range will be added to them once).

MOOG ID No.:CB40859-001 Date:11/2020

MSD ServoDrive - DeviceHelp

# 6 Encoder

MOOG ID No.:CB40859-001 Date:11/2020

method makes it possible to place the point of discontinuity at any point within the encoder’s entire measuring range. By default, MTBase will be set to the lowest possible value for the parameter, i.e. reliably outside of the encoder’s value range: In this case, the full bipolar range will remain unaffected, as values will never fall below this MTBase threshold (see Section ""Channel 1: Interface X7"" on page 59).

- P 548[0] - ENC_CH1_MTEnable = MultiTurn as SingleTurn
- The MTEnable parameter makes it possible to use multi-turn encoders as single-turn encoders for test purposes. Negative logic: Default MTEnable = 0 means ""MultiTurn-Enable ON"".

P 549[0] - ENC_CH1_Corr = Signal correction type
- The GPOC routine used for track signal correction purposes for sine/cosine signals is used to compensate for systematic errors. The routine is controlled with the Corr and CorrVal parameters (see Section ""Signal correction GPOC (Gain Phase Offset Correction)"" on page 74).

P 551[0] - ENC_CH1_EncObsMin = Encoder monitoring minimum, sqrt (a^2+b^2)
- The parameter EncObsMin is used to scale the Sin/Cos wire break monitoring and represents the “downwards threshold” for an error message. The default setting is 0.2, corresponding to approx. ",How is the P 601[0] - ENC_CH1_Period parameter utilized in TTL encoder configurations?,A3,"It specifies the maximum duration of no counter events before the system assumes zero speed, enhancing TTL encoder reliability.",1.875,1.7265625,3.4375,1.5546875,0.58984375
13,msd_servo_drive.txt,20,02f242a213dfa4411d028ce46dfba16a3f97395fa25788fcbaea1715e779d934,"), consult with your project supervisor or the Helpline provided by Moog before using any special SSI protocol modes.

# 6.5.2 EnDat (cyclical) X7

Ch1: ENDAT(4) - Cyclical EnDat (2.1 or 2.2) EnDat is a digital encoder interface developed by HEIDENHAIN. For more details, please visit www.heidenhain.de and go to ►Documentation ►Fundamentals ►Interfaces ►EnDat 2.2.

The software versions required to run the EnDat encoder interface are the standard software versions for the MSD Servo Drive and MSD Single-Axis Servo Drive Compact.

MOOG ID No.:CB40859-001 Date:11/2020

# 6 Encoder

NOTE

- Please note the limitations that apply when running EnDat and SSI encoders (see Section ""Limiting for EnDat and SSI"" on page 52).

When using linear encoders, P 554[0] - ENC_CH1_DigitalResolution is used instead of P 543[0] - ENC_CH1_MultiT and P 544[0] - ENC_CH1_SingleT (which are used for rotary encoders). The values will be read from the EnDat encoder and written to the aforementioned parameters.

- P 543[0] - ENC_CH1_MultiT
- The number ""n"" of multiturn bits defines the measuring range in 2n increments per encoder shaft revolution; maximum travel until overflow; maximum travel within which the absolute value initialization can be unambiguous. In the case of single-turn encoders, MultiT = 0.
- P 544[0] - ENC_CH1_SingleT
- The number ""n"" of single-turn bits corresponds to the encoder’s digital resolution in 2n increments per encoder shaft revolution.
- P 554[0] - ENC_CH1_DigitalResolution
- This is the length of an increment, in nanometres, of the encoder’s digitally transmitted position value. This value is read from the EnDat linear head.

In the case of linear encoders, the number n of transmitted position bits from the encoder will be found in SingleT only! 2n * DigitalResolution yields the maximum travel in nanometres (for the encoder head).

P 640 - ENC_ENDAT is intended for additional information, but is normally not needed. This parameter does not have a Ch1 or Ch3 prefix for the encoder channel in the name, as it applies to both encoder channels. Although usually not needed, the parameter is helpful or required in the following cases:

1. Special EnDat encoder with diagnostics for evaluation
In this case, the valuation numbers from the encoder are read cyclically via additional information. Only the valuation numbers that the encoder supports.

# 6 Encoder

MOOG ID No.:CB40859-001 Date:11/2020

will be read. During the initialization process, the system will read the encoder to determine which valuation numbers it supports. When P 640[0] - ENDAT_Select = 1, the function will be enabled in the controller and the internal diagnostics in the EnDaT encoder will be enabled as well. The EnDat encoder will keep this setting even after being powered off. To explicitly disable the internal diagnostics in the EnDat encoder, set P 640[0] - ENDAT_Select to 2.

# 2. Evaluation of internal warnings

In this scenario, certain internal warnings from the encoder will be read from the encoder via additional information. Only the warnings that both the encoder and the Servo Drive’s software support will be read. During the initialization process, the system will read the encoder to determine which warnings it supports. When P 640[0] - ENDAT_Select = 3, the function will be enabled in the controller.

**Table 6.7: Channel 1 encoder configuration (X7) - EnDat parameters**
|ID|Index Name|Unit|Description|
|---|---|---|---|
|505|0 ENC_CH1_Sel|= ENDAT(4)| |
|543|0 ENC_CH1_MultiT|Number of MultiTurn bits (absolute encoder)| |
|544|0 ENC_CH1_SingleT|Number of SingleTurn bits (absolute encoder)| |
|547|0 ENC_CH1_MTBase|Definition of point of discontinuity in multi-turn range| |
|548|0 ENC_CH1_MTEnable|1: Use Multi-turn encoder as a single-turn encoder| |
|616|0 ENC_CH1_CycleCount|Position encoder sampling cycle (n x 125 μsec)| |
|598|0 ENC_CH1_Position|inc|Position encoder channel 1|
|554|0 ENC_CH1_|nm|Length of one increment (linear absolute encoder)|
|640|ENC_ENDAT| |EnDat additional (additional information)|
|640|0 ENDAT_Select|0=off|EnDat function selection, 1/2=diagnosis on/off, 3=warnings, FF=lock|
|640|1 ENDAT_DiagCount|u16|count new diagnosis block header|
|640|2 ENDAT_BWZ_1|lowbyte|vn1: incremental track|
|640|3 ENDAT_BWZ_3|lowbyte|vn3: absolute track|
|640|4 ENDAT_BWZ_4|lowbyte|vn4: position value formation|
|640|5 ENDAT_Status| |EnDat additional status output|
|640|6 ENDAT_Z1_Sel| |EnDat additional information 1 type selection|

**Table 6.7: Overwrite Channel 1 encoder configuration (X7) - EnDat parameters (continue)**
|ID|Index Name|Unit|Description|
|---|---|---|---|
|640|7 ENDAT_Z1_1| |Z1 info: dword 1|
|640|8 ENDAT_Z1_2| |Z1 info: dword 2|
|640|9 ENDAT_Z1_3| |Z1 info: dword 3|
|640|10 ENDAT_Z1_4| |Z1 info: dword 4|
|640|11 ENDAT_Z2_Sel| |EnDat additional information 2 type selection|
|640|12 ENDAT_Z2_1| |Z2 info: dword 1|
|640|13 ENDAT_Z2_2| |Z2 info: dword 2|
|640|14 ENDAT_Z2_3| |Z2 info: dword 3|
|640|15 ENDAT_Z2_4| |Z2 info: dword 4|
|640|16 ENDAT_Mode1|0=off|EnDat additional mode 1 selection|
|640|17 ENDAT_Mode2| |EnDat additional mode 2 selection|
|640|18 ENDAT_Mode3| |EnDat additional mode 3 selection|
|640|19 ENDAT_Mode4| |EnDat additional mode 4 selection|
|640|20 ENDAT_res1| |reserved 1|
|640|21 ENDAT_res2| |reserved 2|
|640|22 ENDAT_res3| |reserved 3|
|640|23 ENDAT_HwSyncStop|0=SyncOn|EnDat cyclic hw sync, stop/start 1/0|
|640|24 ENDAT_CyclCount| |call counter of cyclic function|
|640|25 ENDAT_BWZ_Supported| |vn supported (bit3=vn4, bit2=vn3, bit0=vn1)|
|640|26 ENDAT_BWZ1_| |vn1: bits[7..0] threshold level, bits[31..16]|
|640|27 ThresholdLevel| |how often number|
|640|28 ENDAT_BWZ3_| |vn3: bits[7..0] threshold level, bits[31..16]|
|640|29 ThresholdLevel| |how often number|
|640|30 ENDAT_BWZ4_| |vn4: bits[7..0] threshold level, bits[31..16]|
|640|31 ThresholdLevel| |how often number|
|640|32 ENDAT_BWZ_TEST_| |vn: bits[15..12] 'F', bits[11..8] vn.no., bits [7..0] vn overwrite value|

# 6.5.3 Hall sensor X7

Ch1: HALL(5) - Digital hall signals

Ch1: HALL_TTL(7) - Digital hall signals

NOTE

l The operation and configuration of Hall effect sensors is reserved for special applications. Consult with Moog if needed.

# 6.5.4 Sin/Cos / TTL X7

# 6.5.4.1 TTL encoder

Ch1: TTL(3) - TTL signals

TTL encoders are ...

- a. ... ... usually pure incremental encoders without an absolute value interface.
- b. In this case, P 540[0] - ENC_CH1_Abs must be set to OFF(0). ... ... in a few exceptional cases, incremental encoders with an SSI absolute value interface. In this case, P 540[0] - ENC_CH1_Abs must be accordingly set to SSI(1) (SSI_CONT(4) in special cases), so that it will be possible to read the absolute encoder position for the absolute value initialization routine once during the initialization phase.

# 6.5.4.1.1 Pure TTL incremental encoder

Set P 505[0] - ENC_CH1_Sel to TTL(3) and P 540[0] - ENC_CH1_Abs to OFF(0) when using pure TTL encoders, i.e. encoders without an absolute value interface but with a TTL zero pulse.

Linear TTL encoders are run as rotary encoders. For linear motor operation, P 542 [0] - ENC_CH1_Lines and the encoder gearing (see the “Encoder gearing” section) are used to establish the ratio for the linear motor’s pole pair subdivision (North-North) for commutation. 1 x North-North corresponds to one revolution from Lines. In this case, the motor pole pair number must be set to 1. Moreover, P 553[0] - ENC_CH1_PeriodLen is not used in this case.

The TTL interface accepts various TTL signal types, which can be selected using P 558[0] - ENC_CH1_TTL_SignalType:

- (0)AF_B - A/B tracks (forward counting, X4 encoding) - AB
- (1)AR_B - A/B tracks (reverse counting, X4 encoding) - AB_inv
- (2)ABDFN - A: Clock (falling edge), B: Direction (1 = positive) - PulseDir
- (3)ABDRP - A: Clock (rising edge), B: Direction (1 = negative) - PulseDir_inv
- (4)reserved

A maximum interpolation period, in ms (milliseconds), can be configured for the TTL interface using P 601[0] - ENC_CH1_Period. Within this context, Period is the maximum time of “no activity” since the last TTL counter event:

- Period = 0: Function disabled (default)
- Period > 0 (=n ms): If no counter event is registered in n ms, the speed will be set to 0.

# Zero pulse

There is no parameter for activating the zero pulse evaluation here, as this evaluation is controlled exclusively based on the homing mode (see Section ""Homing"" on page 249). However, setting P 541[0] - ENC_CH1_NpTest to 1 provides a test mode that can be used during commissioning in order to be able to activate the zero pulse evaluation even without homing. Scope signals 1014 and 1016 can be used to view a received zero pulse within this context. This test mode must be disabled during normal operation (P 541[0] = 0).

# Commutation

Motor operation with pure incremental encoders needs for the auto commutation function to be enabled without fail. For details see Section ""Synchronous motor auto commutation"" on page 156.

# 6.5.4.1.2 TTL incremental encoder with SSI absolute value interface

See Section ""Sin/Cos incremental encoders with absolute value interface"" on page 65 and in special Section ""SSI absolute value interface"" on page 67.

MSD ServoDrive - DeviceHelp

# 6 Encoder

MOOG ID No.:CB40859-001 Date:11/2020 MSD ServoDrive - DeviceHelp 64

|ID|Index Name|Unit|Description|
|---|---|---|---|
|505|0|ENC_CH1_Sel = 3|Encoder selection set to TTL(3)|
|510|0|ENC_CH1_Num|Encoder gearing: Numerator Ch1: SINCOS(1) - Sin/Cos signals|
|511|0|ENC_CH1_Denom|Encoder gearing: Denominator|
|540|0|ENC_CH1_Abs|Selection of absolute value interface Sin/Cos encoders can ...|
|541|0|ENC_CH1_NpTest|ENC CH1, TEST-MODE: Index pulse signal(s) to Scope|
|542|0|ENC_CH1_lines|Number of lines (Sin/Cos / TTL encoders) a. Be pure incremental encoders without an absolute value interface. In this|
|558|0|ENC_CH1_TTL_SignalType|Channel 1: TTL signal selection case, P 540[0] - ENC_CH1_Abs must be set to OFF(0).|
|601|0|ENC_CH1_Period|Maximum period of interpolation (TTL encoder)|
|616|0|ENC_CH1_CycleCount|Sampling cycle in: n x 125 μ (microseconds) b. Be incremental encoders with an absolute value interface. In this case,|

Table 6.8: Parameters for Channel 1 (X7) - TTL encoder

ENC_CH1_Abs must be accordingly set to SSI(1), EnDat(2), HIPER(3) or, in special cases, SSI_CONT(4) so that it will be possible to read the absolute encoder position for the absolute value initialization routine once during the initialization phase.

# 6.5.4.2.1 Purely Sin/Cos incremental encoders

To run these encoders as purely incremental encoders with a zero pulse on encoder channel Ch1 (without an absolute value interface), the approach is basically the same as for purely TTL operation (see Section ""TTL encoder"" on page 63). The same parameters apply.

However, there are the following differences:

- a. There are no different signal types for the Sin/Cos signal (always 1 Vss for cosine and sine).
- b. The zero pulse is the analog zero pulse typical of Sin/Cos encoders (see the “Connection for high-resolution encoders” section in the operation manual MSD Servo Drive Single-Axis System, for example).

# 6.5.4.2.2 Linear Sin/Cos

|ID|Index Name|Unit|Description|
|---|---|---|---|
|542|ENC_CH1_lines| |Number of Lines (Sin/Cos / TTL encoders)|
|543|ENC_CH1_MultiT| |Number of MultiTurn bits (absolute encoder)|
|544|ENC_CH1_SingleT| |Number of SingleTurn bits (absolute encoder)|
|545|ENC_CH1_Code| |Code selection (SSI encoder) (binary, gray)|
|546|ENC_CH1_Mode| |Mode selection (SSI encoder)|
|547|ENC_CH1_MTBase| |Definition of point of discontinuity in multi-turn range|
|548|ENC_CH1_MTEnable| |Enable MultiTurn use (negative logic, 1=MToff)|
|549|ENC_CH1_Corr| |Signal correction type|
|550|ENC_CH1_CorrVal|0-4|Signal correction values|
|551|ENC_CH1_EncObsMin| |Encoder monitoring minimum, sqrt(a^2+b^2)|
|552|ENC_CH1_AbsEncStatus| |Error and status codes (absolute encoder)|

# 6.5.4.2.3 Signal correction (GPOC)

|ID|Index Name|Unit|Description|
|---|---|---|---|
|553|ENC_CH1_PeriodLen|nm|Length of signal period (Sin/Cos linear encoder)|
|554|ENC_CH1_DigitalResolution|nm|Length of one increment (linear absolute encoder)|
|555|ENC_CH1_Info| |Encoder information|
|616|ENC_CH1_CycleCount| |Sampling cycle in: n x 125 μ (microseconds)|
|610|ENC_CH1_NominalIncrementA| |Sign. Nominal increment A (distance coded abs. per. encoder)|
|611|ENC_CH1_NominalIncrementB| |Sign. Nominal increment B (distance coded abs. per. encoder)|
|1900|ENC_ETS| |ETS mode, electronic nameplate|

# 6.5.4.2.4 Sin/Cos incremental encoders with absolute value interface

The following table lists the parameters for cyclical Sin/Cos operation on encoder channel Ch 1 with one-time reading of the absolute encoder position via the absolute value interface, i.e. without a zero pulse:

|ID|Index Name|Unit|Description|
|---|---|---|---|
|505|ENC_CH1_Sel|1|Encoder selection set to SINCOS(1)|
|510|ENC_CH1_Num| |Encoder gearing: Numerator|
|511|ENC_CH1_Denom| |Encoder gearing: Denominator|
|540|ENC_CH1_Abs| |Absolute value interface selection (one-time reading)|

Table 6.9: Parameters for channel 1 (X7) - Sin/Cos encoder

The Sel, Num, Denom, Abs, Lines, MultiT, SingleT and CorrVal parameters are self-explanatory.

The Code and Mode parameters are described in Section ""SSI (cyclical) X7"" on page 69.

P 547[0] - ENC_CH1_MTBase = Minimum MultiTurn position

The MTBase parameter is used to set a position in the multi-turn encoder’s travel path that defines the point of discontinuity (overflow/underflow) for the absolute value initialization (that is, the “multi-turn basis”). Assuming a bipolar encoder measuring range, all position values that fall below MTBase will be shifted “up” (the whole MT range will be added to them once).

MOOG ID No.:CB40859-001 Date:11/2020

MSD ServoDrive - DeviceHelp

# 6 Encoder

MOOG ID No.:CB40859-001 Date:11/2020

method makes it possible to place the point of discontinuity at any point within the encoder’s entire measuring range. By default, MTBase will be set to the lowest possible value for the parameter, i.e. reliably outside of the encoder’s value range: In this case, the full bipolar range will remain unaffected, as values will never fall below this MTBase threshold (see Section ""Channel 1: Interface X7"" on page 59).

- P 548[0] - ENC_CH1_MTEnable = MultiTurn as SingleTurn
- The MTEnable parameter makes it possible to use multi-turn encoders as single-turn encoders for test purposes. Negative logic: Default MTEnable = 0 means ""MultiTurn-Enable ON"".

P 549[0] - ENC_CH1_Corr = Signal correction type
- The GPOC routine used for track signal correction purposes for sine/cosine signals is used to compensate for systematic errors. The routine is controlled with the Corr and CorrVal parameters (see Section ""Signal correction GPOC (Gain Phase Offset Correction)"" on page 74).

P 551[0] - ENC_CH1_EncObsMin = Encoder monitoring minimum, sqrt (a^2+b^2)
- The parameter EncObsMin is used to scale the Sin/Cos wire break monitoring and represents the “downwards threshold” for an error message. The default setting is 0.2, corresponding to approx. ",How is the P 601[0] - ENC_CH1_Period parameter utilized in TTL encoder configurations?,A4,"For TTL encoders, P 601[0] ensures operational integrity by resetting speed to zero after prolonged inactivity, as defined in milliseconds.",2.25,2.453125,3.640625,1.8984375,0.59765625
14,msd_servo_drive.txt,20,02f242a213dfa4411d028ce46dfba16a3f97395fa25788fcbaea1715e779d934,"), consult with your project supervisor or the Helpline provided by Moog before using any special SSI protocol modes.

# 6.5.2 EnDat (cyclical) X7

Ch1: ENDAT(4) - Cyclical EnDat (2.1 or 2.2) EnDat is a digital encoder interface developed by HEIDENHAIN. For more details, please visit www.heidenhain.de and go to ►Documentation ►Fundamentals ►Interfaces ►EnDat 2.2.

The software versions required to run the EnDat encoder interface are the standard software versions for the MSD Servo Drive and MSD Single-Axis Servo Drive Compact.

MOOG ID No.:CB40859-001 Date:11/2020

# 6 Encoder

NOTE

- Please note the limitations that apply when running EnDat and SSI encoders (see Section ""Limiting for EnDat and SSI"" on page 52).

When using linear encoders, P 554[0] - ENC_CH1_DigitalResolution is used instead of P 543[0] - ENC_CH1_MultiT and P 544[0] - ENC_CH1_SingleT (which are used for rotary encoders). The values will be read from the EnDat encoder and written to the aforementioned parameters.

- P 543[0] - ENC_CH1_MultiT
- The number ""n"" of multiturn bits defines the measuring range in 2n increments per encoder shaft revolution; maximum travel until overflow; maximum travel within which the absolute value initialization can be unambiguous. In the case of single-turn encoders, MultiT = 0.
- P 544[0] - ENC_CH1_SingleT
- The number ""n"" of single-turn bits corresponds to the encoder’s digital resolution in 2n increments per encoder shaft revolution.
- P 554[0] - ENC_CH1_DigitalResolution
- This is the length of an increment, in nanometres, of the encoder’s digitally transmitted position value. This value is read from the EnDat linear head.

In the case of linear encoders, the number n of transmitted position bits from the encoder will be found in SingleT only! 2n * DigitalResolution yields the maximum travel in nanometres (for the encoder head).

P 640 - ENC_ENDAT is intended for additional information, but is normally not needed. This parameter does not have a Ch1 or Ch3 prefix for the encoder channel in the name, as it applies to both encoder channels. Although usually not needed, the parameter is helpful or required in the following cases:

1. Special EnDat encoder with diagnostics for evaluation
In this case, the valuation numbers from the encoder are read cyclically via additional information. Only the valuation numbers that the encoder supports.

# 6 Encoder

MOOG ID No.:CB40859-001 Date:11/2020

will be read. During the initialization process, the system will read the encoder to determine which valuation numbers it supports. When P 640[0] - ENDAT_Select = 1, the function will be enabled in the controller and the internal diagnostics in the EnDaT encoder will be enabled as well. The EnDat encoder will keep this setting even after being powered off. To explicitly disable the internal diagnostics in the EnDat encoder, set P 640[0] - ENDAT_Select to 2.

# 2. Evaluation of internal warnings

In this scenario, certain internal warnings from the encoder will be read from the encoder via additional information. Only the warnings that both the encoder and the Servo Drive’s software support will be read. During the initialization process, the system will read the encoder to determine which warnings it supports. When P 640[0] - ENDAT_Select = 3, the function will be enabled in the controller.

**Table 6.7: Channel 1 encoder configuration (X7) - EnDat parameters**
|ID|Index Name|Unit|Description|
|---|---|---|---|
|505|0 ENC_CH1_Sel|= ENDAT(4)| |
|543|0 ENC_CH1_MultiT|Number of MultiTurn bits (absolute encoder)| |
|544|0 ENC_CH1_SingleT|Number of SingleTurn bits (absolute encoder)| |
|547|0 ENC_CH1_MTBase|Definition of point of discontinuity in multi-turn range| |
|548|0 ENC_CH1_MTEnable|1: Use Multi-turn encoder as a single-turn encoder| |
|616|0 ENC_CH1_CycleCount|Position encoder sampling cycle (n x 125 μsec)| |
|598|0 ENC_CH1_Position|inc|Position encoder channel 1|
|554|0 ENC_CH1_|nm|Length of one increment (linear absolute encoder)|
|640|ENC_ENDAT| |EnDat additional (additional information)|
|640|0 ENDAT_Select|0=off|EnDat function selection, 1/2=diagnosis on/off, 3=warnings, FF=lock|
|640|1 ENDAT_DiagCount|u16|count new diagnosis block header|
|640|2 ENDAT_BWZ_1|lowbyte|vn1: incremental track|
|640|3 ENDAT_BWZ_3|lowbyte|vn3: absolute track|
|640|4 ENDAT_BWZ_4|lowbyte|vn4: position value formation|
|640|5 ENDAT_Status| |EnDat additional status output|
|640|6 ENDAT_Z1_Sel| |EnDat additional information 1 type selection|

**Table 6.7: Overwrite Channel 1 encoder configuration (X7) - EnDat parameters (continue)**
|ID|Index Name|Unit|Description|
|---|---|---|---|
|640|7 ENDAT_Z1_1| |Z1 info: dword 1|
|640|8 ENDAT_Z1_2| |Z1 info: dword 2|
|640|9 ENDAT_Z1_3| |Z1 info: dword 3|
|640|10 ENDAT_Z1_4| |Z1 info: dword 4|
|640|11 ENDAT_Z2_Sel| |EnDat additional information 2 type selection|
|640|12 ENDAT_Z2_1| |Z2 info: dword 1|
|640|13 ENDAT_Z2_2| |Z2 info: dword 2|
|640|14 ENDAT_Z2_3| |Z2 info: dword 3|
|640|15 ENDAT_Z2_4| |Z2 info: dword 4|
|640|16 ENDAT_Mode1|0=off|EnDat additional mode 1 selection|
|640|17 ENDAT_Mode2| |EnDat additional mode 2 selection|
|640|18 ENDAT_Mode3| |EnDat additional mode 3 selection|
|640|19 ENDAT_Mode4| |EnDat additional mode 4 selection|
|640|20 ENDAT_res1| |reserved 1|
|640|21 ENDAT_res2| |reserved 2|
|640|22 ENDAT_res3| |reserved 3|
|640|23 ENDAT_HwSyncStop|0=SyncOn|EnDat cyclic hw sync, stop/start 1/0|
|640|24 ENDAT_CyclCount| |call counter of cyclic function|
|640|25 ENDAT_BWZ_Supported| |vn supported (bit3=vn4, bit2=vn3, bit0=vn1)|
|640|26 ENDAT_BWZ1_| |vn1: bits[7..0] threshold level, bits[31..16]|
|640|27 ThresholdLevel| |how often number|
|640|28 ENDAT_BWZ3_| |vn3: bits[7..0] threshold level, bits[31..16]|
|640|29 ThresholdLevel| |how often number|
|640|30 ENDAT_BWZ4_| |vn4: bits[7..0] threshold level, bits[31..16]|
|640|31 ThresholdLevel| |how often number|
|640|32 ENDAT_BWZ_TEST_| |vn: bits[15..12] 'F', bits[11..8] vn.no., bits [7..0] vn overwrite value|

# 6.5.3 Hall sensor X7

Ch1: HALL(5) - Digital hall signals

Ch1: HALL_TTL(7) - Digital hall signals

NOTE

l The operation and configuration of Hall effect sensors is reserved for special applications. Consult with Moog if needed.

# 6.5.4 Sin/Cos / TTL X7

# 6.5.4.1 TTL encoder

Ch1: TTL(3) - TTL signals

TTL encoders are ...

- a. ... ... usually pure incremental encoders without an absolute value interface.
- b. In this case, P 540[0] - ENC_CH1_Abs must be set to OFF(0). ... ... in a few exceptional cases, incremental encoders with an SSI absolute value interface. In this case, P 540[0] - ENC_CH1_Abs must be accordingly set to SSI(1) (SSI_CONT(4) in special cases), so that it will be possible to read the absolute encoder position for the absolute value initialization routine once during the initialization phase.

# 6.5.4.1.1 Pure TTL incremental encoder

Set P 505[0] - ENC_CH1_Sel to TTL(3) and P 540[0] - ENC_CH1_Abs to OFF(0) when using pure TTL encoders, i.e. encoders without an absolute value interface but with a TTL zero pulse.

Linear TTL encoders are run as rotary encoders. For linear motor operation, P 542 [0] - ENC_CH1_Lines and the encoder gearing (see the “Encoder gearing” section) are used to establish the ratio for the linear motor’s pole pair subdivision (North-North) for commutation. 1 x North-North corresponds to one revolution from Lines. In this case, the motor pole pair number must be set to 1. Moreover, P 553[0] - ENC_CH1_PeriodLen is not used in this case.

The TTL interface accepts various TTL signal types, which can be selected using P 558[0] - ENC_CH1_TTL_SignalType:

- (0)AF_B - A/B tracks (forward counting, X4 encoding) - AB
- (1)AR_B - A/B tracks (reverse counting, X4 encoding) - AB_inv
- (2)ABDFN - A: Clock (falling edge), B: Direction (1 = positive) - PulseDir
- (3)ABDRP - A: Clock (rising edge), B: Direction (1 = negative) - PulseDir_inv
- (4)reserved

A maximum interpolation period, in ms (milliseconds), can be configured for the TTL interface using P 601[0] - ENC_CH1_Period. Within this context, Period is the maximum time of “no activity” since the last TTL counter event:

- Period = 0: Function disabled (default)
- Period > 0 (=n ms): If no counter event is registered in n ms, the speed will be set to 0.

# Zero pulse

There is no parameter for activating the zero pulse evaluation here, as this evaluation is controlled exclusively based on the homing mode (see Section ""Homing"" on page 249). However, setting P 541[0] - ENC_CH1_NpTest to 1 provides a test mode that can be used during commissioning in order to be able to activate the zero pulse evaluation even without homing. Scope signals 1014 and 1016 can be used to view a received zero pulse within this context. This test mode must be disabled during normal operation (P 541[0] = 0).

# Commutation

Motor operation with pure incremental encoders needs for the auto commutation function to be enabled without fail. For details see Section ""Synchronous motor auto commutation"" on page 156.

# 6.5.4.1.2 TTL incremental encoder with SSI absolute value interface

See Section ""Sin/Cos incremental encoders with absolute value interface"" on page 65 and in special Section ""SSI absolute value interface"" on page 67.

MSD ServoDrive - DeviceHelp

# 6 Encoder

MOOG ID No.:CB40859-001 Date:11/2020 MSD ServoDrive - DeviceHelp 64

|ID|Index Name|Unit|Description|
|---|---|---|---|
|505|0|ENC_CH1_Sel = 3|Encoder selection set to TTL(3)|
|510|0|ENC_CH1_Num|Encoder gearing: Numerator Ch1: SINCOS(1) - Sin/Cos signals|
|511|0|ENC_CH1_Denom|Encoder gearing: Denominator|
|540|0|ENC_CH1_Abs|Selection of absolute value interface Sin/Cos encoders can ...|
|541|0|ENC_CH1_NpTest|ENC CH1, TEST-MODE: Index pulse signal(s) to Scope|
|542|0|ENC_CH1_lines|Number of lines (Sin/Cos / TTL encoders) a. Be pure incremental encoders without an absolute value interface. In this|
|558|0|ENC_CH1_TTL_SignalType|Channel 1: TTL signal selection case, P 540[0] - ENC_CH1_Abs must be set to OFF(0).|
|601|0|ENC_CH1_Period|Maximum period of interpolation (TTL encoder)|
|616|0|ENC_CH1_CycleCount|Sampling cycle in: n x 125 μ (microseconds) b. Be incremental encoders with an absolute value interface. In this case,|

Table 6.8: Parameters for Channel 1 (X7) - TTL encoder

ENC_CH1_Abs must be accordingly set to SSI(1), EnDat(2), HIPER(3) or, in special cases, SSI_CONT(4) so that it will be possible to read the absolute encoder position for the absolute value initialization routine once during the initialization phase.

# 6.5.4.2.1 Purely Sin/Cos incremental encoders

To run these encoders as purely incremental encoders with a zero pulse on encoder channel Ch1 (without an absolute value interface), the approach is basically the same as for purely TTL operation (see Section ""TTL encoder"" on page 63). The same parameters apply.

However, there are the following differences:

- a. There are no different signal types for the Sin/Cos signal (always 1 Vss for cosine and sine).
- b. The zero pulse is the analog zero pulse typical of Sin/Cos encoders (see the “Connection for high-resolution encoders” section in the operation manual MSD Servo Drive Single-Axis System, for example).

# 6.5.4.2.2 Linear Sin/Cos

|ID|Index Name|Unit|Description|
|---|---|---|---|
|542|ENC_CH1_lines| |Number of Lines (Sin/Cos / TTL encoders)|
|543|ENC_CH1_MultiT| |Number of MultiTurn bits (absolute encoder)|
|544|ENC_CH1_SingleT| |Number of SingleTurn bits (absolute encoder)|
|545|ENC_CH1_Code| |Code selection (SSI encoder) (binary, gray)|
|546|ENC_CH1_Mode| |Mode selection (SSI encoder)|
|547|ENC_CH1_MTBase| |Definition of point of discontinuity in multi-turn range|
|548|ENC_CH1_MTEnable| |Enable MultiTurn use (negative logic, 1=MToff)|
|549|ENC_CH1_Corr| |Signal correction type|
|550|ENC_CH1_CorrVal|0-4|Signal correction values|
|551|ENC_CH1_EncObsMin| |Encoder monitoring minimum, sqrt(a^2+b^2)|
|552|ENC_CH1_AbsEncStatus| |Error and status codes (absolute encoder)|

# 6.5.4.2.3 Signal correction (GPOC)

|ID|Index Name|Unit|Description|
|---|---|---|---|
|553|ENC_CH1_PeriodLen|nm|Length of signal period (Sin/Cos linear encoder)|
|554|ENC_CH1_DigitalResolution|nm|Length of one increment (linear absolute encoder)|
|555|ENC_CH1_Info| |Encoder information|
|616|ENC_CH1_CycleCount| |Sampling cycle in: n x 125 μ (microseconds)|
|610|ENC_CH1_NominalIncrementA| |Sign. Nominal increment A (distance coded abs. per. encoder)|
|611|ENC_CH1_NominalIncrementB| |Sign. Nominal increment B (distance coded abs. per. encoder)|
|1900|ENC_ETS| |ETS mode, electronic nameplate|

# 6.5.4.2.4 Sin/Cos incremental encoders with absolute value interface

The following table lists the parameters for cyclical Sin/Cos operation on encoder channel Ch 1 with one-time reading of the absolute encoder position via the absolute value interface, i.e. without a zero pulse:

|ID|Index Name|Unit|Description|
|---|---|---|---|
|505|ENC_CH1_Sel|1|Encoder selection set to SINCOS(1)|
|510|ENC_CH1_Num| |Encoder gearing: Numerator|
|511|ENC_CH1_Denom| |Encoder gearing: Denominator|
|540|ENC_CH1_Abs| |Absolute value interface selection (one-time reading)|

Table 6.9: Parameters for channel 1 (X7) - Sin/Cos encoder

The Sel, Num, Denom, Abs, Lines, MultiT, SingleT and CorrVal parameters are self-explanatory.

The Code and Mode parameters are described in Section ""SSI (cyclical) X7"" on page 69.

P 547[0] - ENC_CH1_MTBase = Minimum MultiTurn position

The MTBase parameter is used to set a position in the multi-turn encoder’s travel path that defines the point of discontinuity (overflow/underflow) for the absolute value initialization (that is, the “multi-turn basis”). Assuming a bipolar encoder measuring range, all position values that fall below MTBase will be shifted “up” (the whole MT range will be added to them once).

MOOG ID No.:CB40859-001 Date:11/2020

MSD ServoDrive - DeviceHelp

# 6 Encoder

MOOG ID No.:CB40859-001 Date:11/2020

method makes it possible to place the point of discontinuity at any point within the encoder’s entire measuring range. By default, MTBase will be set to the lowest possible value for the parameter, i.e. reliably outside of the encoder’s value range: In this case, the full bipolar range will remain unaffected, as values will never fall below this MTBase threshold (see Section ""Channel 1: Interface X7"" on page 59).

- P 548[0] - ENC_CH1_MTEnable = MultiTurn as SingleTurn
- The MTEnable parameter makes it possible to use multi-turn encoders as single-turn encoders for test purposes. Negative logic: Default MTEnable = 0 means ""MultiTurn-Enable ON"".

P 549[0] - ENC_CH1_Corr = Signal correction type
- The GPOC routine used for track signal correction purposes for sine/cosine signals is used to compensate for systematic errors. The routine is controlled with the Corr and CorrVal parameters (see Section ""Signal correction GPOC (Gain Phase Offset Correction)"" on page 74).

P 551[0] - ENC_CH1_EncObsMin = Encoder monitoring minimum, sqrt (a^2+b^2)
- The parameter EncObsMin is used to scale the Sin/Cos wire break monitoring and represents the “downwards threshold” for an error message. The default setting is 0.2, corresponding to approx. ",How is the P 601[0] - ENC_CH1_Period parameter utilized in TTL encoder configurations?,A5,The parameter safeguards against stale data by enforcing a speed reset if no TTL counter events are detected within the set period.,2.21875,2.21875,3.4375,1.4765625,0.57421875
15,msd_servo_drive.txt,20,02f242a213dfa4411d028ce46dfba16a3f97395fa25788fcbaea1715e779d934,"), consult with your project supervisor or the Helpline provided by Moog before using any special SSI protocol modes.

# 6.5.2 EnDat (cyclical) X7

Ch1: ENDAT(4) - Cyclical EnDat (2.1 or 2.2) EnDat is a digital encoder interface developed by HEIDENHAIN. For more details, please visit www.heidenhain.de and go to ►Documentation ►Fundamentals ►Interfaces ►EnDat 2.2.

The software versions required to run the EnDat encoder interface are the standard software versions for the MSD Servo Drive and MSD Single-Axis Servo Drive Compact.

MOOG ID No.:CB40859-001 Date:11/2020

# 6 Encoder

NOTE

- Please note the limitations that apply when running EnDat and SSI encoders (see Section ""Limiting for EnDat and SSI"" on page 52).

When using linear encoders, P 554[0] - ENC_CH1_DigitalResolution is used instead of P 543[0] - ENC_CH1_MultiT and P 544[0] - ENC_CH1_SingleT (which are used for rotary encoders). The values will be read from the EnDat encoder and written to the aforementioned parameters.

- P 543[0] - ENC_CH1_MultiT
- The number ""n"" of multiturn bits defines the measuring range in 2n increments per encoder shaft revolution; maximum travel until overflow; maximum travel within which the absolute value initialization can be unambiguous. In the case of single-turn encoders, MultiT = 0.
- P 544[0] - ENC_CH1_SingleT
- The number ""n"" of single-turn bits corresponds to the encoder’s digital resolution in 2n increments per encoder shaft revolution.
- P 554[0] - ENC_CH1_DigitalResolution
- This is the length of an increment, in nanometres, of the encoder’s digitally transmitted position value. This value is read from the EnDat linear head.

In the case of linear encoders, the number n of transmitted position bits from the encoder will be found in SingleT only! 2n * DigitalResolution yields the maximum travel in nanometres (for the encoder head).

P 640 - ENC_ENDAT is intended for additional information, but is normally not needed. This parameter does not have a Ch1 or Ch3 prefix for the encoder channel in the name, as it applies to both encoder channels. Although usually not needed, the parameter is helpful or required in the following cases:

1. Special EnDat encoder with diagnostics for evaluation
In this case, the valuation numbers from the encoder are read cyclically via additional information. Only the valuation numbers that the encoder supports.

# 6 Encoder

MOOG ID No.:CB40859-001 Date:11/2020

will be read. During the initialization process, the system will read the encoder to determine which valuation numbers it supports. When P 640[0] - ENDAT_Select = 1, the function will be enabled in the controller and the internal diagnostics in the EnDaT encoder will be enabled as well. The EnDat encoder will keep this setting even after being powered off. To explicitly disable the internal diagnostics in the EnDat encoder, set P 640[0] - ENDAT_Select to 2.

# 2. Evaluation of internal warnings

In this scenario, certain internal warnings from the encoder will be read from the encoder via additional information. Only the warnings that both the encoder and the Servo Drive’s software support will be read. During the initialization process, the system will read the encoder to determine which warnings it supports. When P 640[0] - ENDAT_Select = 3, the function will be enabled in the controller.

**Table 6.7: Channel 1 encoder configuration (X7) - EnDat parameters**
|ID|Index Name|Unit|Description|
|---|---|---|---|
|505|0 ENC_CH1_Sel|= ENDAT(4)| |
|543|0 ENC_CH1_MultiT|Number of MultiTurn bits (absolute encoder)| |
|544|0 ENC_CH1_SingleT|Number of SingleTurn bits (absolute encoder)| |
|547|0 ENC_CH1_MTBase|Definition of point of discontinuity in multi-turn range| |
|548|0 ENC_CH1_MTEnable|1: Use Multi-turn encoder as a single-turn encoder| |
|616|0 ENC_CH1_CycleCount|Position encoder sampling cycle (n x 125 μsec)| |
|598|0 ENC_CH1_Position|inc|Position encoder channel 1|
|554|0 ENC_CH1_|nm|Length of one increment (linear absolute encoder)|
|640|ENC_ENDAT| |EnDat additional (additional information)|
|640|0 ENDAT_Select|0=off|EnDat function selection, 1/2=diagnosis on/off, 3=warnings, FF=lock|
|640|1 ENDAT_DiagCount|u16|count new diagnosis block header|
|640|2 ENDAT_BWZ_1|lowbyte|vn1: incremental track|
|640|3 ENDAT_BWZ_3|lowbyte|vn3: absolute track|
|640|4 ENDAT_BWZ_4|lowbyte|vn4: position value formation|
|640|5 ENDAT_Status| |EnDat additional status output|
|640|6 ENDAT_Z1_Sel| |EnDat additional information 1 type selection|

**Table 6.7: Overwrite Channel 1 encoder configuration (X7) - EnDat parameters (continue)**
|ID|Index Name|Unit|Description|
|---|---|---|---|
|640|7 ENDAT_Z1_1| |Z1 info: dword 1|
|640|8 ENDAT_Z1_2| |Z1 info: dword 2|
|640|9 ENDAT_Z1_3| |Z1 info: dword 3|
|640|10 ENDAT_Z1_4| |Z1 info: dword 4|
|640|11 ENDAT_Z2_Sel| |EnDat additional information 2 type selection|
|640|12 ENDAT_Z2_1| |Z2 info: dword 1|
|640|13 ENDAT_Z2_2| |Z2 info: dword 2|
|640|14 ENDAT_Z2_3| |Z2 info: dword 3|
|640|15 ENDAT_Z2_4| |Z2 info: dword 4|
|640|16 ENDAT_Mode1|0=off|EnDat additional mode 1 selection|
|640|17 ENDAT_Mode2| |EnDat additional mode 2 selection|
|640|18 ENDAT_Mode3| |EnDat additional mode 3 selection|
|640|19 ENDAT_Mode4| |EnDat additional mode 4 selection|
|640|20 ENDAT_res1| |reserved 1|
|640|21 ENDAT_res2| |reserved 2|
|640|22 ENDAT_res3| |reserved 3|
|640|23 ENDAT_HwSyncStop|0=SyncOn|EnDat cyclic hw sync, stop/start 1/0|
|640|24 ENDAT_CyclCount| |call counter of cyclic function|
|640|25 ENDAT_BWZ_Supported| |vn supported (bit3=vn4, bit2=vn3, bit0=vn1)|
|640|26 ENDAT_BWZ1_| |vn1: bits[7..0] threshold level, bits[31..16]|
|640|27 ThresholdLevel| |how often number|
|640|28 ENDAT_BWZ3_| |vn3: bits[7..0] threshold level, bits[31..16]|
|640|29 ThresholdLevel| |how often number|
|640|30 ENDAT_BWZ4_| |vn4: bits[7..0] threshold level, bits[31..16]|
|640|31 ThresholdLevel| |how often number|
|640|32 ENDAT_BWZ_TEST_| |vn: bits[15..12] 'F', bits[11..8] vn.no., bits [7..0] vn overwrite value|

# 6.5.3 Hall sensor X7

Ch1: HALL(5) - Digital hall signals

Ch1: HALL_TTL(7) - Digital hall signals

NOTE

l The operation and configuration of Hall effect sensors is reserved for special applications. Consult with Moog if needed.

# 6.5.4 Sin/Cos / TTL X7

# 6.5.4.1 TTL encoder

Ch1: TTL(3) - TTL signals

TTL encoders are ...

- a. ... ... usually pure incremental encoders without an absolute value interface.
- b. In this case, P 540[0] - ENC_CH1_Abs must be set to OFF(0). ... ... in a few exceptional cases, incremental encoders with an SSI absolute value interface. In this case, P 540[0] - ENC_CH1_Abs must be accordingly set to SSI(1) (SSI_CONT(4) in special cases), so that it will be possible to read the absolute encoder position for the absolute value initialization routine once during the initialization phase.

# 6.5.4.1.1 Pure TTL incremental encoder

Set P 505[0] - ENC_CH1_Sel to TTL(3) and P 540[0] - ENC_CH1_Abs to OFF(0) when using pure TTL encoders, i.e. encoders without an absolute value interface but with a TTL zero pulse.

Linear TTL encoders are run as rotary encoders. For linear motor operation, P 542 [0] - ENC_CH1_Lines and the encoder gearing (see the “Encoder gearing” section) are used to establish the ratio for the linear motor’s pole pair subdivision (North-North) for commutation. 1 x North-North corresponds to one revolution from Lines. In this case, the motor pole pair number must be set to 1. Moreover, P 553[0] - ENC_CH1_PeriodLen is not used in this case.

The TTL interface accepts various TTL signal types, which can be selected using P 558[0] - ENC_CH1_TTL_SignalType:

- (0)AF_B - A/B tracks (forward counting, X4 encoding) - AB
- (1)AR_B - A/B tracks (reverse counting, X4 encoding) - AB_inv
- (2)ABDFN - A: Clock (falling edge), B: Direction (1 = positive) - PulseDir
- (3)ABDRP - A: Clock (rising edge), B: Direction (1 = negative) - PulseDir_inv
- (4)reserved

A maximum interpolation period, in ms (milliseconds), can be configured for the TTL interface using P 601[0] - ENC_CH1_Period. Within this context, Period is the maximum time of “no activity” since the last TTL counter event:

- Period = 0: Function disabled (default)
- Period > 0 (=n ms): If no counter event is registered in n ms, the speed will be set to 0.

# Zero pulse

There is no parameter for activating the zero pulse evaluation here, as this evaluation is controlled exclusively based on the homing mode (see Section ""Homing"" on page 249). However, setting P 541[0] - ENC_CH1_NpTest to 1 provides a test mode that can be used during commissioning in order to be able to activate the zero pulse evaluation even without homing. Scope signals 1014 and 1016 can be used to view a received zero pulse within this context. This test mode must be disabled during normal operation (P 541[0] = 0).

# Commutation

Motor operation with pure incremental encoders needs for the auto commutation function to be enabled without fail. For details see Section ""Synchronous motor auto commutation"" on page 156.

# 6.5.4.1.2 TTL incremental encoder with SSI absolute value interface

See Section ""Sin/Cos incremental encoders with absolute value interface"" on page 65 and in special Section ""SSI absolute value interface"" on page 67.

MSD ServoDrive - DeviceHelp

# 6 Encoder

MOOG ID No.:CB40859-001 Date:11/2020 MSD ServoDrive - DeviceHelp 64

|ID|Index Name|Unit|Description|
|---|---|---|---|
|505|0|ENC_CH1_Sel = 3|Encoder selection set to TTL(3)|
|510|0|ENC_CH1_Num|Encoder gearing: Numerator Ch1: SINCOS(1) - Sin/Cos signals|
|511|0|ENC_CH1_Denom|Encoder gearing: Denominator|
|540|0|ENC_CH1_Abs|Selection of absolute value interface Sin/Cos encoders can ...|
|541|0|ENC_CH1_NpTest|ENC CH1, TEST-MODE: Index pulse signal(s) to Scope|
|542|0|ENC_CH1_lines|Number of lines (Sin/Cos / TTL encoders) a. Be pure incremental encoders without an absolute value interface. In this|
|558|0|ENC_CH1_TTL_SignalType|Channel 1: TTL signal selection case, P 540[0] - ENC_CH1_Abs must be set to OFF(0).|
|601|0|ENC_CH1_Period|Maximum period of interpolation (TTL encoder)|
|616|0|ENC_CH1_CycleCount|Sampling cycle in: n x 125 μ (microseconds) b. Be incremental encoders with an absolute value interface. In this case,|

Table 6.8: Parameters for Channel 1 (X7) - TTL encoder

ENC_CH1_Abs must be accordingly set to SSI(1), EnDat(2), HIPER(3) or, in special cases, SSI_CONT(4) so that it will be possible to read the absolute encoder position for the absolute value initialization routine once during the initialization phase.

# 6.5.4.2.1 Purely Sin/Cos incremental encoders

To run these encoders as purely incremental encoders with a zero pulse on encoder channel Ch1 (without an absolute value interface), the approach is basically the same as for purely TTL operation (see Section ""TTL encoder"" on page 63). The same parameters apply.

However, there are the following differences:

- a. There are no different signal types for the Sin/Cos signal (always 1 Vss for cosine and sine).
- b. The zero pulse is the analog zero pulse typical of Sin/Cos encoders (see the “Connection for high-resolution encoders” section in the operation manual MSD Servo Drive Single-Axis System, for example).

# 6.5.4.2.2 Linear Sin/Cos

|ID|Index Name|Unit|Description|
|---|---|---|---|
|542|ENC_CH1_lines| |Number of Lines (Sin/Cos / TTL encoders)|
|543|ENC_CH1_MultiT| |Number of MultiTurn bits (absolute encoder)|
|544|ENC_CH1_SingleT| |Number of SingleTurn bits (absolute encoder)|
|545|ENC_CH1_Code| |Code selection (SSI encoder) (binary, gray)|
|546|ENC_CH1_Mode| |Mode selection (SSI encoder)|
|547|ENC_CH1_MTBase| |Definition of point of discontinuity in multi-turn range|
|548|ENC_CH1_MTEnable| |Enable MultiTurn use (negative logic, 1=MToff)|
|549|ENC_CH1_Corr| |Signal correction type|
|550|ENC_CH1_CorrVal|0-4|Signal correction values|
|551|ENC_CH1_EncObsMin| |Encoder monitoring minimum, sqrt(a^2+b^2)|
|552|ENC_CH1_AbsEncStatus| |Error and status codes (absolute encoder)|

# 6.5.4.2.3 Signal correction (GPOC)

|ID|Index Name|Unit|Description|
|---|---|---|---|
|553|ENC_CH1_PeriodLen|nm|Length of signal period (Sin/Cos linear encoder)|
|554|ENC_CH1_DigitalResolution|nm|Length of one increment (linear absolute encoder)|
|555|ENC_CH1_Info| |Encoder information|
|616|ENC_CH1_CycleCount| |Sampling cycle in: n x 125 μ (microseconds)|
|610|ENC_CH1_NominalIncrementA| |Sign. Nominal increment A (distance coded abs. per. encoder)|
|611|ENC_CH1_NominalIncrementB| |Sign. Nominal increment B (distance coded abs. per. encoder)|
|1900|ENC_ETS| |ETS mode, electronic nameplate|

# 6.5.4.2.4 Sin/Cos incremental encoders with absolute value interface

The following table lists the parameters for cyclical Sin/Cos operation on encoder channel Ch 1 with one-time reading of the absolute encoder position via the absolute value interface, i.e. without a zero pulse:

|ID|Index Name|Unit|Description|
|---|---|---|---|
|505|ENC_CH1_Sel|1|Encoder selection set to SINCOS(1)|
|510|ENC_CH1_Num| |Encoder gearing: Numerator|
|511|ENC_CH1_Denom| |Encoder gearing: Denominator|
|540|ENC_CH1_Abs| |Absolute value interface selection (one-time reading)|

Table 6.9: Parameters for channel 1 (X7) - Sin/Cos encoder

The Sel, Num, Denom, Abs, Lines, MultiT, SingleT and CorrVal parameters are self-explanatory.

The Code and Mode parameters are described in Section ""SSI (cyclical) X7"" on page 69.

P 547[0] - ENC_CH1_MTBase = Minimum MultiTurn position

The MTBase parameter is used to set a position in the multi-turn encoder’s travel path that defines the point of discontinuity (overflow/underflow) for the absolute value initialization (that is, the “multi-turn basis”). Assuming a bipolar encoder measuring range, all position values that fall below MTBase will be shifted “up” (the whole MT range will be added to them once).

MOOG ID No.:CB40859-001 Date:11/2020

MSD ServoDrive - DeviceHelp

# 6 Encoder

MOOG ID No.:CB40859-001 Date:11/2020

method makes it possible to place the point of discontinuity at any point within the encoder’s entire measuring range. By default, MTBase will be set to the lowest possible value for the parameter, i.e. reliably outside of the encoder’s value range: In this case, the full bipolar range will remain unaffected, as values will never fall below this MTBase threshold (see Section ""Channel 1: Interface X7"" on page 59).

- P 548[0] - ENC_CH1_MTEnable = MultiTurn as SingleTurn
- The MTEnable parameter makes it possible to use multi-turn encoders as single-turn encoders for test purposes. Negative logic: Default MTEnable = 0 means ""MultiTurn-Enable ON"".

P 549[0] - ENC_CH1_Corr = Signal correction type
- The GPOC routine used for track signal correction purposes for sine/cosine signals is used to compensate for systematic errors. The routine is controlled with the Corr and CorrVal parameters (see Section ""Signal correction GPOC (Gain Phase Offset Correction)"" on page 74).

P 551[0] - ENC_CH1_EncObsMin = Encoder monitoring minimum, sqrt (a^2+b^2)
- The parameter EncObsMin is used to scale the Sin/Cos wire break monitoring and represents the “downwards threshold” for an error message. The default setting is 0.2, corresponding to approx. ",What are the differences between P 543[0] - ENC_CH1_MultiT and P 544[0] - ENC_CH1_SingleT parameters?,A1,"P 543[0] defines the multiturn bits for the measuring range in 2n increments per revolution, while P 544[0] specifies the single-turn bits for digital resolution per revolution.",2.296875,2.421875,3.46875,1.8671875,0.625
16,msd_servo_drive.txt,20,02f242a213dfa4411d028ce46dfba16a3f97395fa25788fcbaea1715e779d934,"), consult with your project supervisor or the Helpline provided by Moog before using any special SSI protocol modes.

# 6.5.2 EnDat (cyclical) X7

Ch1: ENDAT(4) - Cyclical EnDat (2.1 or 2.2) EnDat is a digital encoder interface developed by HEIDENHAIN. For more details, please visit www.heidenhain.de and go to ►Documentation ►Fundamentals ►Interfaces ►EnDat 2.2.

The software versions required to run the EnDat encoder interface are the standard software versions for the MSD Servo Drive and MSD Single-Axis Servo Drive Compact.

MOOG ID No.:CB40859-001 Date:11/2020

# 6 Encoder

NOTE

- Please note the limitations that apply when running EnDat and SSI encoders (see Section ""Limiting for EnDat and SSI"" on page 52).

When using linear encoders, P 554[0] - ENC_CH1_DigitalResolution is used instead of P 543[0] - ENC_CH1_MultiT and P 544[0] - ENC_CH1_SingleT (which are used for rotary encoders). The values will be read from the EnDat encoder and written to the aforementioned parameters.

- P 543[0] - ENC_CH1_MultiT
- The number ""n"" of multiturn bits defines the measuring range in 2n increments per encoder shaft revolution; maximum travel until overflow; maximum travel within which the absolute value initialization can be unambiguous. In the case of single-turn encoders, MultiT = 0.
- P 544[0] - ENC_CH1_SingleT
- The number ""n"" of single-turn bits corresponds to the encoder’s digital resolution in 2n increments per encoder shaft revolution.
- P 554[0] - ENC_CH1_DigitalResolution
- This is the length of an increment, in nanometres, of the encoder’s digitally transmitted position value. This value is read from the EnDat linear head.

In the case of linear encoders, the number n of transmitted position bits from the encoder will be found in SingleT only! 2n * DigitalResolution yields the maximum travel in nanometres (for the encoder head).

P 640 - ENC_ENDAT is intended for additional information, but is normally not needed. This parameter does not have a Ch1 or Ch3 prefix for the encoder channel in the name, as it applies to both encoder channels. Although usually not needed, the parameter is helpful or required in the following cases:

1. Special EnDat encoder with diagnostics for evaluation
In this case, the valuation numbers from the encoder are read cyclically via additional information. Only the valuation numbers that the encoder supports.

# 6 Encoder

MOOG ID No.:CB40859-001 Date:11/2020

will be read. During the initialization process, the system will read the encoder to determine which valuation numbers it supports. When P 640[0] - ENDAT_Select = 1, the function will be enabled in the controller and the internal diagnostics in the EnDaT encoder will be enabled as well. The EnDat encoder will keep this setting even after being powered off. To explicitly disable the internal diagnostics in the EnDat encoder, set P 640[0] - ENDAT_Select to 2.

# 2. Evaluation of internal warnings

In this scenario, certain internal warnings from the encoder will be read from the encoder via additional information. Only the warnings that both the encoder and the Servo Drive’s software support will be read. During the initialization process, the system will read the encoder to determine which warnings it supports. When P 640[0] - ENDAT_Select = 3, the function will be enabled in the controller.

**Table 6.7: Channel 1 encoder configuration (X7) - EnDat parameters**
|ID|Index Name|Unit|Description|
|---|---|---|---|
|505|0 ENC_CH1_Sel|= ENDAT(4)| |
|543|0 ENC_CH1_MultiT|Number of MultiTurn bits (absolute encoder)| |
|544|0 ENC_CH1_SingleT|Number of SingleTurn bits (absolute encoder)| |
|547|0 ENC_CH1_MTBase|Definition of point of discontinuity in multi-turn range| |
|548|0 ENC_CH1_MTEnable|1: Use Multi-turn encoder as a single-turn encoder| |
|616|0 ENC_CH1_CycleCount|Position encoder sampling cycle (n x 125 μsec)| |
|598|0 ENC_CH1_Position|inc|Position encoder channel 1|
|554|0 ENC_CH1_|nm|Length of one increment (linear absolute encoder)|
|640|ENC_ENDAT| |EnDat additional (additional information)|
|640|0 ENDAT_Select|0=off|EnDat function selection, 1/2=diagnosis on/off, 3=warnings, FF=lock|
|640|1 ENDAT_DiagCount|u16|count new diagnosis block header|
|640|2 ENDAT_BWZ_1|lowbyte|vn1: incremental track|
|640|3 ENDAT_BWZ_3|lowbyte|vn3: absolute track|
|640|4 ENDAT_BWZ_4|lowbyte|vn4: position value formation|
|640|5 ENDAT_Status| |EnDat additional status output|
|640|6 ENDAT_Z1_Sel| |EnDat additional information 1 type selection|

**Table 6.7: Overwrite Channel 1 encoder configuration (X7) - EnDat parameters (continue)**
|ID|Index Name|Unit|Description|
|---|---|---|---|
|640|7 ENDAT_Z1_1| |Z1 info: dword 1|
|640|8 ENDAT_Z1_2| |Z1 info: dword 2|
|640|9 ENDAT_Z1_3| |Z1 info: dword 3|
|640|10 ENDAT_Z1_4| |Z1 info: dword 4|
|640|11 ENDAT_Z2_Sel| |EnDat additional information 2 type selection|
|640|12 ENDAT_Z2_1| |Z2 info: dword 1|
|640|13 ENDAT_Z2_2| |Z2 info: dword 2|
|640|14 ENDAT_Z2_3| |Z2 info: dword 3|
|640|15 ENDAT_Z2_4| |Z2 info: dword 4|
|640|16 ENDAT_Mode1|0=off|EnDat additional mode 1 selection|
|640|17 ENDAT_Mode2| |EnDat additional mode 2 selection|
|640|18 ENDAT_Mode3| |EnDat additional mode 3 selection|
|640|19 ENDAT_Mode4| |EnDat additional mode 4 selection|
|640|20 ENDAT_res1| |reserved 1|
|640|21 ENDAT_res2| |reserved 2|
|640|22 ENDAT_res3| |reserved 3|
|640|23 ENDAT_HwSyncStop|0=SyncOn|EnDat cyclic hw sync, stop/start 1/0|
|640|24 ENDAT_CyclCount| |call counter of cyclic function|
|640|25 ENDAT_BWZ_Supported| |vn supported (bit3=vn4, bit2=vn3, bit0=vn1)|
|640|26 ENDAT_BWZ1_| |vn1: bits[7..0] threshold level, bits[31..16]|
|640|27 ThresholdLevel| |how often number|
|640|28 ENDAT_BWZ3_| |vn3: bits[7..0] threshold level, bits[31..16]|
|640|29 ThresholdLevel| |how often number|
|640|30 ENDAT_BWZ4_| |vn4: bits[7..0] threshold level, bits[31..16]|
|640|31 ThresholdLevel| |how often number|
|640|32 ENDAT_BWZ_TEST_| |vn: bits[15..12] 'F', bits[11..8] vn.no., bits [7..0] vn overwrite value|

# 6.5.3 Hall sensor X7

Ch1: HALL(5) - Digital hall signals

Ch1: HALL_TTL(7) - Digital hall signals

NOTE

l The operation and configuration of Hall effect sensors is reserved for special applications. Consult with Moog if needed.

# 6.5.4 Sin/Cos / TTL X7

# 6.5.4.1 TTL encoder

Ch1: TTL(3) - TTL signals

TTL encoders are ...

- a. ... ... usually pure incremental encoders without an absolute value interface.
- b. In this case, P 540[0] - ENC_CH1_Abs must be set to OFF(0). ... ... in a few exceptional cases, incremental encoders with an SSI absolute value interface. In this case, P 540[0] - ENC_CH1_Abs must be accordingly set to SSI(1) (SSI_CONT(4) in special cases), so that it will be possible to read the absolute encoder position for the absolute value initialization routine once during the initialization phase.

# 6.5.4.1.1 Pure TTL incremental encoder

Set P 505[0] - ENC_CH1_Sel to TTL(3) and P 540[0] - ENC_CH1_Abs to OFF(0) when using pure TTL encoders, i.e. encoders without an absolute value interface but with a TTL zero pulse.

Linear TTL encoders are run as rotary encoders. For linear motor operation, P 542 [0] - ENC_CH1_Lines and the encoder gearing (see the “Encoder gearing” section) are used to establish the ratio for the linear motor’s pole pair subdivision (North-North) for commutation. 1 x North-North corresponds to one revolution from Lines. In this case, the motor pole pair number must be set to 1. Moreover, P 553[0] - ENC_CH1_PeriodLen is not used in this case.

The TTL interface accepts various TTL signal types, which can be selected using P 558[0] - ENC_CH1_TTL_SignalType:

- (0)AF_B - A/B tracks (forward counting, X4 encoding) - AB
- (1)AR_B - A/B tracks (reverse counting, X4 encoding) - AB_inv
- (2)ABDFN - A: Clock (falling edge), B: Direction (1 = positive) - PulseDir
- (3)ABDRP - A: Clock (rising edge), B: Direction (1 = negative) - PulseDir_inv
- (4)reserved

A maximum interpolation period, in ms (milliseconds), can be configured for the TTL interface using P 601[0] - ENC_CH1_Period. Within this context, Period is the maximum time of “no activity” since the last TTL counter event:

- Period = 0: Function disabled (default)
- Period > 0 (=n ms): If no counter event is registered in n ms, the speed will be set to 0.

# Zero pulse

There is no parameter for activating the zero pulse evaluation here, as this evaluation is controlled exclusively based on the homing mode (see Section ""Homing"" on page 249). However, setting P 541[0] - ENC_CH1_NpTest to 1 provides a test mode that can be used during commissioning in order to be able to activate the zero pulse evaluation even without homing. Scope signals 1014 and 1016 can be used to view a received zero pulse within this context. This test mode must be disabled during normal operation (P 541[0] = 0).

# Commutation

Motor operation with pure incremental encoders needs for the auto commutation function to be enabled without fail. For details see Section ""Synchronous motor auto commutation"" on page 156.

# 6.5.4.1.2 TTL incremental encoder with SSI absolute value interface

See Section ""Sin/Cos incremental encoders with absolute value interface"" on page 65 and in special Section ""SSI absolute value interface"" on page 67.

MSD ServoDrive - DeviceHelp

# 6 Encoder

MOOG ID No.:CB40859-001 Date:11/2020 MSD ServoDrive - DeviceHelp 64

|ID|Index Name|Unit|Description|
|---|---|---|---|
|505|0|ENC_CH1_Sel = 3|Encoder selection set to TTL(3)|
|510|0|ENC_CH1_Num|Encoder gearing: Numerator Ch1: SINCOS(1) - Sin/Cos signals|
|511|0|ENC_CH1_Denom|Encoder gearing: Denominator|
|540|0|ENC_CH1_Abs|Selection of absolute value interface Sin/Cos encoders can ...|
|541|0|ENC_CH1_NpTest|ENC CH1, TEST-MODE: Index pulse signal(s) to Scope|
|542|0|ENC_CH1_lines|Number of lines (Sin/Cos / TTL encoders) a. Be pure incremental encoders without an absolute value interface. In this|
|558|0|ENC_CH1_TTL_SignalType|Channel 1: TTL signal selection case, P 540[0] - ENC_CH1_Abs must be set to OFF(0).|
|601|0|ENC_CH1_Period|Maximum period of interpolation (TTL encoder)|
|616|0|ENC_CH1_CycleCount|Sampling cycle in: n x 125 μ (microseconds) b. Be incremental encoders with an absolute value interface. In this case,|

Table 6.8: Parameters for Channel 1 (X7) - TTL encoder

ENC_CH1_Abs must be accordingly set to SSI(1), EnDat(2), HIPER(3) or, in special cases, SSI_CONT(4) so that it will be possible to read the absolute encoder position for the absolute value initialization routine once during the initialization phase.

# 6.5.4.2.1 Purely Sin/Cos incremental encoders

To run these encoders as purely incremental encoders with a zero pulse on encoder channel Ch1 (without an absolute value interface), the approach is basically the same as for purely TTL operation (see Section ""TTL encoder"" on page 63). The same parameters apply.

However, there are the following differences:

- a. There are no different signal types for the Sin/Cos signal (always 1 Vss for cosine and sine).
- b. The zero pulse is the analog zero pulse typical of Sin/Cos encoders (see the “Connection for high-resolution encoders” section in the operation manual MSD Servo Drive Single-Axis System, for example).

# 6.5.4.2.2 Linear Sin/Cos

|ID|Index Name|Unit|Description|
|---|---|---|---|
|542|ENC_CH1_lines| |Number of Lines (Sin/Cos / TTL encoders)|
|543|ENC_CH1_MultiT| |Number of MultiTurn bits (absolute encoder)|
|544|ENC_CH1_SingleT| |Number of SingleTurn bits (absolute encoder)|
|545|ENC_CH1_Code| |Code selection (SSI encoder) (binary, gray)|
|546|ENC_CH1_Mode| |Mode selection (SSI encoder)|
|547|ENC_CH1_MTBase| |Definition of point of discontinuity in multi-turn range|
|548|ENC_CH1_MTEnable| |Enable MultiTurn use (negative logic, 1=MToff)|
|549|ENC_CH1_Corr| |Signal correction type|
|550|ENC_CH1_CorrVal|0-4|Signal correction values|
|551|ENC_CH1_EncObsMin| |Encoder monitoring minimum, sqrt(a^2+b^2)|
|552|ENC_CH1_AbsEncStatus| |Error and status codes (absolute encoder)|

# 6.5.4.2.3 Signal correction (GPOC)

|ID|Index Name|Unit|Description|
|---|---|---|---|
|553|ENC_CH1_PeriodLen|nm|Length of signal period (Sin/Cos linear encoder)|
|554|ENC_CH1_DigitalResolution|nm|Length of one increment (linear absolute encoder)|
|555|ENC_CH1_Info| |Encoder information|
|616|ENC_CH1_CycleCount| |Sampling cycle in: n x 125 μ (microseconds)|
|610|ENC_CH1_NominalIncrementA| |Sign. Nominal increment A (distance coded abs. per. encoder)|
|611|ENC_CH1_NominalIncrementB| |Sign. Nominal increment B (distance coded abs. per. encoder)|
|1900|ENC_ETS| |ETS mode, electronic nameplate|

# 6.5.4.2.4 Sin/Cos incremental encoders with absolute value interface

The following table lists the parameters for cyclical Sin/Cos operation on encoder channel Ch 1 with one-time reading of the absolute encoder position via the absolute value interface, i.e. without a zero pulse:

|ID|Index Name|Unit|Description|
|---|---|---|---|
|505|ENC_CH1_Sel|1|Encoder selection set to SINCOS(1)|
|510|ENC_CH1_Num| |Encoder gearing: Numerator|
|511|ENC_CH1_Denom| |Encoder gearing: Denominator|
|540|ENC_CH1_Abs| |Absolute value interface selection (one-time reading)|

Table 6.9: Parameters for channel 1 (X7) - Sin/Cos encoder

The Sel, Num, Denom, Abs, Lines, MultiT, SingleT and CorrVal parameters are self-explanatory.

The Code and Mode parameters are described in Section ""SSI (cyclical) X7"" on page 69.

P 547[0] - ENC_CH1_MTBase = Minimum MultiTurn position

The MTBase parameter is used to set a position in the multi-turn encoder’s travel path that defines the point of discontinuity (overflow/underflow) for the absolute value initialization (that is, the “multi-turn basis”). Assuming a bipolar encoder measuring range, all position values that fall below MTBase will be shifted “up” (the whole MT range will be added to them once).

MOOG ID No.:CB40859-001 Date:11/2020

MSD ServoDrive - DeviceHelp

# 6 Encoder

MOOG ID No.:CB40859-001 Date:11/2020

method makes it possible to place the point of discontinuity at any point within the encoder’s entire measuring range. By default, MTBase will be set to the lowest possible value for the parameter, i.e. reliably outside of the encoder’s value range: In this case, the full bipolar range will remain unaffected, as values will never fall below this MTBase threshold (see Section ""Channel 1: Interface X7"" on page 59).

- P 548[0] - ENC_CH1_MTEnable = MultiTurn as SingleTurn
- The MTEnable parameter makes it possible to use multi-turn encoders as single-turn encoders for test purposes. Negative logic: Default MTEnable = 0 means ""MultiTurn-Enable ON"".

P 549[0] - ENC_CH1_Corr = Signal correction type
- The GPOC routine used for track signal correction purposes for sine/cosine signals is used to compensate for systematic errors. The routine is controlled with the Corr and CorrVal parameters (see Section ""Signal correction GPOC (Gain Phase Offset Correction)"" on page 74).

P 551[0] - ENC_CH1_EncObsMin = Encoder monitoring minimum, sqrt (a^2+b^2)
- The parameter EncObsMin is used to scale the Sin/Cos wire break monitoring and represents the “downwards threshold” for an error message. The default setting is 0.2, corresponding to approx. ",What are the differences between P 543[0] - ENC_CH1_MultiT and P 544[0] - ENC_CH1_SingleT parameters?,A2,"MultiT sets the encoder's measuring range across multiple turns, and SingleT determines the resolution within a single turn.",2.421875,2.46875,3.5625,1.5703125,0.494140625
17,msd_servo_drive.txt,20,02f242a213dfa4411d028ce46dfba16a3f97395fa25788fcbaea1715e779d934,"), consult with your project supervisor or the Helpline provided by Moog before using any special SSI protocol modes.

# 6.5.2 EnDat (cyclical) X7

Ch1: ENDAT(4) - Cyclical EnDat (2.1 or 2.2) EnDat is a digital encoder interface developed by HEIDENHAIN. For more details, please visit www.heidenhain.de and go to ►Documentation ►Fundamentals ►Interfaces ►EnDat 2.2.

The software versions required to run the EnDat encoder interface are the standard software versions for the MSD Servo Drive and MSD Single-Axis Servo Drive Compact.

MOOG ID No.:CB40859-001 Date:11/2020

# 6 Encoder

NOTE

- Please note the limitations that apply when running EnDat and SSI encoders (see Section ""Limiting for EnDat and SSI"" on page 52).

When using linear encoders, P 554[0] - ENC_CH1_DigitalResolution is used instead of P 543[0] - ENC_CH1_MultiT and P 544[0] - ENC_CH1_SingleT (which are used for rotary encoders). The values will be read from the EnDat encoder and written to the aforementioned parameters.

- P 543[0] - ENC_CH1_MultiT
- The number ""n"" of multiturn bits defines the measuring range in 2n increments per encoder shaft revolution; maximum travel until overflow; maximum travel within which the absolute value initialization can be unambiguous. In the case of single-turn encoders, MultiT = 0.
- P 544[0] - ENC_CH1_SingleT
- The number ""n"" of single-turn bits corresponds to the encoder’s digital resolution in 2n increments per encoder shaft revolution.
- P 554[0] - ENC_CH1_DigitalResolution
- This is the length of an increment, in nanometres, of the encoder’s digitally transmitted position value. This value is read from the EnDat linear head.

In the case of linear encoders, the number n of transmitted position bits from the encoder will be found in SingleT only! 2n * DigitalResolution yields the maximum travel in nanometres (for the encoder head).

P 640 - ENC_ENDAT is intended for additional information, but is normally not needed. This parameter does not have a Ch1 or Ch3 prefix for the encoder channel in the name, as it applies to both encoder channels. Although usually not needed, the parameter is helpful or required in the following cases:

1. Special EnDat encoder with diagnostics for evaluation
In this case, the valuation numbers from the encoder are read cyclically via additional information. Only the valuation numbers that the encoder supports.

# 6 Encoder

MOOG ID No.:CB40859-001 Date:11/2020

will be read. During the initialization process, the system will read the encoder to determine which valuation numbers it supports. When P 640[0] - ENDAT_Select = 1, the function will be enabled in the controller and the internal diagnostics in the EnDaT encoder will be enabled as well. The EnDat encoder will keep this setting even after being powered off. To explicitly disable the internal diagnostics in the EnDat encoder, set P 640[0] - ENDAT_Select to 2.

# 2. Evaluation of internal warnings

In this scenario, certain internal warnings from the encoder will be read from the encoder via additional information. Only the warnings that both the encoder and the Servo Drive’s software support will be read. During the initialization process, the system will read the encoder to determine which warnings it supports. When P 640[0] - ENDAT_Select = 3, the function will be enabled in the controller.

**Table 6.7: Channel 1 encoder configuration (X7) - EnDat parameters**
|ID|Index Name|Unit|Description|
|---|---|---|---|
|505|0 ENC_CH1_Sel|= ENDAT(4)| |
|543|0 ENC_CH1_MultiT|Number of MultiTurn bits (absolute encoder)| |
|544|0 ENC_CH1_SingleT|Number of SingleTurn bits (absolute encoder)| |
|547|0 ENC_CH1_MTBase|Definition of point of discontinuity in multi-turn range| |
|548|0 ENC_CH1_MTEnable|1: Use Multi-turn encoder as a single-turn encoder| |
|616|0 ENC_CH1_CycleCount|Position encoder sampling cycle (n x 125 μsec)| |
|598|0 ENC_CH1_Position|inc|Position encoder channel 1|
|554|0 ENC_CH1_|nm|Length of one increment (linear absolute encoder)|
|640|ENC_ENDAT| |EnDat additional (additional information)|
|640|0 ENDAT_Select|0=off|EnDat function selection, 1/2=diagnosis on/off, 3=warnings, FF=lock|
|640|1 ENDAT_DiagCount|u16|count new diagnosis block header|
|640|2 ENDAT_BWZ_1|lowbyte|vn1: incremental track|
|640|3 ENDAT_BWZ_3|lowbyte|vn3: absolute track|
|640|4 ENDAT_BWZ_4|lowbyte|vn4: position value formation|
|640|5 ENDAT_Status| |EnDat additional status output|
|640|6 ENDAT_Z1_Sel| |EnDat additional information 1 type selection|

**Table 6.7: Overwrite Channel 1 encoder configuration (X7) - EnDat parameters (continue)**
|ID|Index Name|Unit|Description|
|---|---|---|---|
|640|7 ENDAT_Z1_1| |Z1 info: dword 1|
|640|8 ENDAT_Z1_2| |Z1 info: dword 2|
|640|9 ENDAT_Z1_3| |Z1 info: dword 3|
|640|10 ENDAT_Z1_4| |Z1 info: dword 4|
|640|11 ENDAT_Z2_Sel| |EnDat additional information 2 type selection|
|640|12 ENDAT_Z2_1| |Z2 info: dword 1|
|640|13 ENDAT_Z2_2| |Z2 info: dword 2|
|640|14 ENDAT_Z2_3| |Z2 info: dword 3|
|640|15 ENDAT_Z2_4| |Z2 info: dword 4|
|640|16 ENDAT_Mode1|0=off|EnDat additional mode 1 selection|
|640|17 ENDAT_Mode2| |EnDat additional mode 2 selection|
|640|18 ENDAT_Mode3| |EnDat additional mode 3 selection|
|640|19 ENDAT_Mode4| |EnDat additional mode 4 selection|
|640|20 ENDAT_res1| |reserved 1|
|640|21 ENDAT_res2| |reserved 2|
|640|22 ENDAT_res3| |reserved 3|
|640|23 ENDAT_HwSyncStop|0=SyncOn|EnDat cyclic hw sync, stop/start 1/0|
|640|24 ENDAT_CyclCount| |call counter of cyclic function|
|640|25 ENDAT_BWZ_Supported| |vn supported (bit3=vn4, bit2=vn3, bit0=vn1)|
|640|26 ENDAT_BWZ1_| |vn1: bits[7..0] threshold level, bits[31..16]|
|640|27 ThresholdLevel| |how often number|
|640|28 ENDAT_BWZ3_| |vn3: bits[7..0] threshold level, bits[31..16]|
|640|29 ThresholdLevel| |how often number|
|640|30 ENDAT_BWZ4_| |vn4: bits[7..0] threshold level, bits[31..16]|
|640|31 ThresholdLevel| |how often number|
|640|32 ENDAT_BWZ_TEST_| |vn: bits[15..12] 'F', bits[11..8] vn.no., bits [7..0] vn overwrite value|

# 6.5.3 Hall sensor X7

Ch1: HALL(5) - Digital hall signals

Ch1: HALL_TTL(7) - Digital hall signals

NOTE

l The operation and configuration of Hall effect sensors is reserved for special applications. Consult with Moog if needed.

# 6.5.4 Sin/Cos / TTL X7

# 6.5.4.1 TTL encoder

Ch1: TTL(3) - TTL signals

TTL encoders are ...

- a. ... ... usually pure incremental encoders without an absolute value interface.
- b. In this case, P 540[0] - ENC_CH1_Abs must be set to OFF(0). ... ... in a few exceptional cases, incremental encoders with an SSI absolute value interface. In this case, P 540[0] - ENC_CH1_Abs must be accordingly set to SSI(1) (SSI_CONT(4) in special cases), so that it will be possible to read the absolute encoder position for the absolute value initialization routine once during the initialization phase.

# 6.5.4.1.1 Pure TTL incremental encoder

Set P 505[0] - ENC_CH1_Sel to TTL(3) and P 540[0] - ENC_CH1_Abs to OFF(0) when using pure TTL encoders, i.e. encoders without an absolute value interface but with a TTL zero pulse.

Linear TTL encoders are run as rotary encoders. For linear motor operation, P 542 [0] - ENC_CH1_Lines and the encoder gearing (see the “Encoder gearing” section) are used to establish the ratio for the linear motor’s pole pair subdivision (North-North) for commutation. 1 x North-North corresponds to one revolution from Lines. In this case, the motor pole pair number must be set to 1. Moreover, P 553[0] - ENC_CH1_PeriodLen is not used in this case.

The TTL interface accepts various TTL signal types, which can be selected using P 558[0] - ENC_CH1_TTL_SignalType:

- (0)AF_B - A/B tracks (forward counting, X4 encoding) - AB
- (1)AR_B - A/B tracks (reverse counting, X4 encoding) - AB_inv
- (2)ABDFN - A: Clock (falling edge), B: Direction (1 = positive) - PulseDir
- (3)ABDRP - A: Clock (rising edge), B: Direction (1 = negative) - PulseDir_inv
- (4)reserved

A maximum interpolation period, in ms (milliseconds), can be configured for the TTL interface using P 601[0] - ENC_CH1_Period. Within this context, Period is the maximum time of “no activity” since the last TTL counter event:

- Period = 0: Function disabled (default)
- Period > 0 (=n ms): If no counter event is registered in n ms, the speed will be set to 0.

# Zero pulse

There is no parameter for activating the zero pulse evaluation here, as this evaluation is controlled exclusively based on the homing mode (see Section ""Homing"" on page 249). However, setting P 541[0] - ENC_CH1_NpTest to 1 provides a test mode that can be used during commissioning in order to be able to activate the zero pulse evaluation even without homing. Scope signals 1014 and 1016 can be used to view a received zero pulse within this context. This test mode must be disabled during normal operation (P 541[0] = 0).

# Commutation

Motor operation with pure incremental encoders needs for the auto commutation function to be enabled without fail. For details see Section ""Synchronous motor auto commutation"" on page 156.

# 6.5.4.1.2 TTL incremental encoder with SSI absolute value interface

See Section ""Sin/Cos incremental encoders with absolute value interface"" on page 65 and in special Section ""SSI absolute value interface"" on page 67.

MSD ServoDrive - DeviceHelp

# 6 Encoder

MOOG ID No.:CB40859-001 Date:11/2020 MSD ServoDrive - DeviceHelp 64

|ID|Index Name|Unit|Description|
|---|---|---|---|
|505|0|ENC_CH1_Sel = 3|Encoder selection set to TTL(3)|
|510|0|ENC_CH1_Num|Encoder gearing: Numerator Ch1: SINCOS(1) - Sin/Cos signals|
|511|0|ENC_CH1_Denom|Encoder gearing: Denominator|
|540|0|ENC_CH1_Abs|Selection of absolute value interface Sin/Cos encoders can ...|
|541|0|ENC_CH1_NpTest|ENC CH1, TEST-MODE: Index pulse signal(s) to Scope|
|542|0|ENC_CH1_lines|Number of lines (Sin/Cos / TTL encoders) a. Be pure incremental encoders without an absolute value interface. In this|
|558|0|ENC_CH1_TTL_SignalType|Channel 1: TTL signal selection case, P 540[0] - ENC_CH1_Abs must be set to OFF(0).|
|601|0|ENC_CH1_Period|Maximum period of interpolation (TTL encoder)|
|616|0|ENC_CH1_CycleCount|Sampling cycle in: n x 125 μ (microseconds) b. Be incremental encoders with an absolute value interface. In this case,|

Table 6.8: Parameters for Channel 1 (X7) - TTL encoder

ENC_CH1_Abs must be accordingly set to SSI(1), EnDat(2), HIPER(3) or, in special cases, SSI_CONT(4) so that it will be possible to read the absolute encoder position for the absolute value initialization routine once during the initialization phase.

# 6.5.4.2.1 Purely Sin/Cos incremental encoders

To run these encoders as purely incremental encoders with a zero pulse on encoder channel Ch1 (without an absolute value interface), the approach is basically the same as for purely TTL operation (see Section ""TTL encoder"" on page 63). The same parameters apply.

However, there are the following differences:

- a. There are no different signal types for the Sin/Cos signal (always 1 Vss for cosine and sine).
- b. The zero pulse is the analog zero pulse typical of Sin/Cos encoders (see the “Connection for high-resolution encoders” section in the operation manual MSD Servo Drive Single-Axis System, for example).

# 6.5.4.2.2 Linear Sin/Cos

|ID|Index Name|Unit|Description|
|---|---|---|---|
|542|ENC_CH1_lines| |Number of Lines (Sin/Cos / TTL encoders)|
|543|ENC_CH1_MultiT| |Number of MultiTurn bits (absolute encoder)|
|544|ENC_CH1_SingleT| |Number of SingleTurn bits (absolute encoder)|
|545|ENC_CH1_Code| |Code selection (SSI encoder) (binary, gray)|
|546|ENC_CH1_Mode| |Mode selection (SSI encoder)|
|547|ENC_CH1_MTBase| |Definition of point of discontinuity in multi-turn range|
|548|ENC_CH1_MTEnable| |Enable MultiTurn use (negative logic, 1=MToff)|
|549|ENC_CH1_Corr| |Signal correction type|
|550|ENC_CH1_CorrVal|0-4|Signal correction values|
|551|ENC_CH1_EncObsMin| |Encoder monitoring minimum, sqrt(a^2+b^2)|
|552|ENC_CH1_AbsEncStatus| |Error and status codes (absolute encoder)|

# 6.5.4.2.3 Signal correction (GPOC)

|ID|Index Name|Unit|Description|
|---|---|---|---|
|553|ENC_CH1_PeriodLen|nm|Length of signal period (Sin/Cos linear encoder)|
|554|ENC_CH1_DigitalResolution|nm|Length of one increment (linear absolute encoder)|
|555|ENC_CH1_Info| |Encoder information|
|616|ENC_CH1_CycleCount| |Sampling cycle in: n x 125 μ (microseconds)|
|610|ENC_CH1_NominalIncrementA| |Sign. Nominal increment A (distance coded abs. per. encoder)|
|611|ENC_CH1_NominalIncrementB| |Sign. Nominal increment B (distance coded abs. per. encoder)|
|1900|ENC_ETS| |ETS mode, electronic nameplate|

# 6.5.4.2.4 Sin/Cos incremental encoders with absolute value interface

The following table lists the parameters for cyclical Sin/Cos operation on encoder channel Ch 1 with one-time reading of the absolute encoder position via the absolute value interface, i.e. without a zero pulse:

|ID|Index Name|Unit|Description|
|---|---|---|---|
|505|ENC_CH1_Sel|1|Encoder selection set to SINCOS(1)|
|510|ENC_CH1_Num| |Encoder gearing: Numerator|
|511|ENC_CH1_Denom| |Encoder gearing: Denominator|
|540|ENC_CH1_Abs| |Absolute value interface selection (one-time reading)|

Table 6.9: Parameters for channel 1 (X7) - Sin/Cos encoder

The Sel, Num, Denom, Abs, Lines, MultiT, SingleT and CorrVal parameters are self-explanatory.

The Code and Mode parameters are described in Section ""SSI (cyclical) X7"" on page 69.

P 547[0] - ENC_CH1_MTBase = Minimum MultiTurn position

The MTBase parameter is used to set a position in the multi-turn encoder’s travel path that defines the point of discontinuity (overflow/underflow) for the absolute value initialization (that is, the “multi-turn basis”). Assuming a bipolar encoder measuring range, all position values that fall below MTBase will be shifted “up” (the whole MT range will be added to them once).

MOOG ID No.:CB40859-001 Date:11/2020

MSD ServoDrive - DeviceHelp

# 6 Encoder

MOOG ID No.:CB40859-001 Date:11/2020

method makes it possible to place the point of discontinuity at any point within the encoder’s entire measuring range. By default, MTBase will be set to the lowest possible value for the parameter, i.e. reliably outside of the encoder’s value range: In this case, the full bipolar range will remain unaffected, as values will never fall below this MTBase threshold (see Section ""Channel 1: Interface X7"" on page 59).

- P 548[0] - ENC_CH1_MTEnable = MultiTurn as SingleTurn
- The MTEnable parameter makes it possible to use multi-turn encoders as single-turn encoders for test purposes. Negative logic: Default MTEnable = 0 means ""MultiTurn-Enable ON"".

P 549[0] - ENC_CH1_Corr = Signal correction type
- The GPOC routine used for track signal correction purposes for sine/cosine signals is used to compensate for systematic errors. The routine is controlled with the Corr and CorrVal parameters (see Section ""Signal correction GPOC (Gain Phase Offset Correction)"" on page 74).

P 551[0] - ENC_CH1_EncObsMin = Encoder monitoring minimum, sqrt (a^2+b^2)
- The parameter EncObsMin is used to scale the Sin/Cos wire break monitoring and represents the “downwards threshold” for an error message. The default setting is 0.2, corresponding to approx. ",What are the differences between P 543[0] - ENC_CH1_MultiT and P 544[0] - ENC_CH1_SingleT parameters?,A3,"P 543[0] is for multiturn range definition, and P 544[0] is for single-turn resolution, both critical for absolute encoder configuration.",2.28125,2.421875,3.453125,1.6328125,0.6640625
18,msd_servo_drive.txt,20,02f242a213dfa4411d028ce46dfba16a3f97395fa25788fcbaea1715e779d934,"), consult with your project supervisor or the Helpline provided by Moog before using any special SSI protocol modes.

# 6.5.2 EnDat (cyclical) X7

Ch1: ENDAT(4) - Cyclical EnDat (2.1 or 2.2) EnDat is a digital encoder interface developed by HEIDENHAIN. For more details, please visit www.heidenhain.de and go to ►Documentation ►Fundamentals ►Interfaces ►EnDat 2.2.

The software versions required to run the EnDat encoder interface are the standard software versions for the MSD Servo Drive and MSD Single-Axis Servo Drive Compact.

MOOG ID No.:CB40859-001 Date:11/2020

# 6 Encoder

NOTE

- Please note the limitations that apply when running EnDat and SSI encoders (see Section ""Limiting for EnDat and SSI"" on page 52).

When using linear encoders, P 554[0] - ENC_CH1_DigitalResolution is used instead of P 543[0] - ENC_CH1_MultiT and P 544[0] - ENC_CH1_SingleT (which are used for rotary encoders). The values will be read from the EnDat encoder and written to the aforementioned parameters.

- P 543[0] - ENC_CH1_MultiT
- The number ""n"" of multiturn bits defines the measuring range in 2n increments per encoder shaft revolution; maximum travel until overflow; maximum travel within which the absolute value initialization can be unambiguous. In the case of single-turn encoders, MultiT = 0.
- P 544[0] - ENC_CH1_SingleT
- The number ""n"" of single-turn bits corresponds to the encoder’s digital resolution in 2n increments per encoder shaft revolution.
- P 554[0] - ENC_CH1_DigitalResolution
- This is the length of an increment, in nanometres, of the encoder’s digitally transmitted position value. This value is read from the EnDat linear head.

In the case of linear encoders, the number n of transmitted position bits from the encoder will be found in SingleT only! 2n * DigitalResolution yields the maximum travel in nanometres (for the encoder head).

P 640 - ENC_ENDAT is intended for additional information, but is normally not needed. This parameter does not have a Ch1 or Ch3 prefix for the encoder channel in the name, as it applies to both encoder channels. Although usually not needed, the parameter is helpful or required in the following cases:

1. Special EnDat encoder with diagnostics for evaluation
In this case, the valuation numbers from the encoder are read cyclically via additional information. Only the valuation numbers that the encoder supports.

# 6 Encoder

MOOG ID No.:CB40859-001 Date:11/2020

will be read. During the initialization process, the system will read the encoder to determine which valuation numbers it supports. When P 640[0] - ENDAT_Select = 1, the function will be enabled in the controller and the internal diagnostics in the EnDaT encoder will be enabled as well. The EnDat encoder will keep this setting even after being powered off. To explicitly disable the internal diagnostics in the EnDat encoder, set P 640[0] - ENDAT_Select to 2.

# 2. Evaluation of internal warnings

In this scenario, certain internal warnings from the encoder will be read from the encoder via additional information. Only the warnings that both the encoder and the Servo Drive’s software support will be read. During the initialization process, the system will read the encoder to determine which warnings it supports. When P 640[0] - ENDAT_Select = 3, the function will be enabled in the controller.

**Table 6.7: Channel 1 encoder configuration (X7) - EnDat parameters**
|ID|Index Name|Unit|Description|
|---|---|---|---|
|505|0 ENC_CH1_Sel|= ENDAT(4)| |
|543|0 ENC_CH1_MultiT|Number of MultiTurn bits (absolute encoder)| |
|544|0 ENC_CH1_SingleT|Number of SingleTurn bits (absolute encoder)| |
|547|0 ENC_CH1_MTBase|Definition of point of discontinuity in multi-turn range| |
|548|0 ENC_CH1_MTEnable|1: Use Multi-turn encoder as a single-turn encoder| |
|616|0 ENC_CH1_CycleCount|Position encoder sampling cycle (n x 125 μsec)| |
|598|0 ENC_CH1_Position|inc|Position encoder channel 1|
|554|0 ENC_CH1_|nm|Length of one increment (linear absolute encoder)|
|640|ENC_ENDAT| |EnDat additional (additional information)|
|640|0 ENDAT_Select|0=off|EnDat function selection, 1/2=diagnosis on/off, 3=warnings, FF=lock|
|640|1 ENDAT_DiagCount|u16|count new diagnosis block header|
|640|2 ENDAT_BWZ_1|lowbyte|vn1: incremental track|
|640|3 ENDAT_BWZ_3|lowbyte|vn3: absolute track|
|640|4 ENDAT_BWZ_4|lowbyte|vn4: position value formation|
|640|5 ENDAT_Status| |EnDat additional status output|
|640|6 ENDAT_Z1_Sel| |EnDat additional information 1 type selection|

**Table 6.7: Overwrite Channel 1 encoder configuration (X7) - EnDat parameters (continue)**
|ID|Index Name|Unit|Description|
|---|---|---|---|
|640|7 ENDAT_Z1_1| |Z1 info: dword 1|
|640|8 ENDAT_Z1_2| |Z1 info: dword 2|
|640|9 ENDAT_Z1_3| |Z1 info: dword 3|
|640|10 ENDAT_Z1_4| |Z1 info: dword 4|
|640|11 ENDAT_Z2_Sel| |EnDat additional information 2 type selection|
|640|12 ENDAT_Z2_1| |Z2 info: dword 1|
|640|13 ENDAT_Z2_2| |Z2 info: dword 2|
|640|14 ENDAT_Z2_3| |Z2 info: dword 3|
|640|15 ENDAT_Z2_4| |Z2 info: dword 4|
|640|16 ENDAT_Mode1|0=off|EnDat additional mode 1 selection|
|640|17 ENDAT_Mode2| |EnDat additional mode 2 selection|
|640|18 ENDAT_Mode3| |EnDat additional mode 3 selection|
|640|19 ENDAT_Mode4| |EnDat additional mode 4 selection|
|640|20 ENDAT_res1| |reserved 1|
|640|21 ENDAT_res2| |reserved 2|
|640|22 ENDAT_res3| |reserved 3|
|640|23 ENDAT_HwSyncStop|0=SyncOn|EnDat cyclic hw sync, stop/start 1/0|
|640|24 ENDAT_CyclCount| |call counter of cyclic function|
|640|25 ENDAT_BWZ_Supported| |vn supported (bit3=vn4, bit2=vn3, bit0=vn1)|
|640|26 ENDAT_BWZ1_| |vn1: bits[7..0] threshold level, bits[31..16]|
|640|27 ThresholdLevel| |how often number|
|640|28 ENDAT_BWZ3_| |vn3: bits[7..0] threshold level, bits[31..16]|
|640|29 ThresholdLevel| |how often number|
|640|30 ENDAT_BWZ4_| |vn4: bits[7..0] threshold level, bits[31..16]|
|640|31 ThresholdLevel| |how often number|
|640|32 ENDAT_BWZ_TEST_| |vn: bits[15..12] 'F', bits[11..8] vn.no., bits [7..0] vn overwrite value|

# 6.5.3 Hall sensor X7

Ch1: HALL(5) - Digital hall signals

Ch1: HALL_TTL(7) - Digital hall signals

NOTE

l The operation and configuration of Hall effect sensors is reserved for special applications. Consult with Moog if needed.

# 6.5.4 Sin/Cos / TTL X7

# 6.5.4.1 TTL encoder

Ch1: TTL(3) - TTL signals

TTL encoders are ...

- a. ... ... usually pure incremental encoders without an absolute value interface.
- b. In this case, P 540[0] - ENC_CH1_Abs must be set to OFF(0). ... ... in a few exceptional cases, incremental encoders with an SSI absolute value interface. In this case, P 540[0] - ENC_CH1_Abs must be accordingly set to SSI(1) (SSI_CONT(4) in special cases), so that it will be possible to read the absolute encoder position for the absolute value initialization routine once during the initialization phase.

# 6.5.4.1.1 Pure TTL incremental encoder

Set P 505[0] - ENC_CH1_Sel to TTL(3) and P 540[0] - ENC_CH1_Abs to OFF(0) when using pure TTL encoders, i.e. encoders without an absolute value interface but with a TTL zero pulse.

Linear TTL encoders are run as rotary encoders. For linear motor operation, P 542 [0] - ENC_CH1_Lines and the encoder gearing (see the “Encoder gearing” section) are used to establish the ratio for the linear motor’s pole pair subdivision (North-North) for commutation. 1 x North-North corresponds to one revolution from Lines. In this case, the motor pole pair number must be set to 1. Moreover, P 553[0] - ENC_CH1_PeriodLen is not used in this case.

The TTL interface accepts various TTL signal types, which can be selected using P 558[0] - ENC_CH1_TTL_SignalType:

- (0)AF_B - A/B tracks (forward counting, X4 encoding) - AB
- (1)AR_B - A/B tracks (reverse counting, X4 encoding) - AB_inv
- (2)ABDFN - A: Clock (falling edge), B: Direction (1 = positive) - PulseDir
- (3)ABDRP - A: Clock (rising edge), B: Direction (1 = negative) - PulseDir_inv
- (4)reserved

A maximum interpolation period, in ms (milliseconds), can be configured for the TTL interface using P 601[0] - ENC_CH1_Period. Within this context, Period is the maximum time of “no activity” since the last TTL counter event:

- Period = 0: Function disabled (default)
- Period > 0 (=n ms): If no counter event is registered in n ms, the speed will be set to 0.

# Zero pulse

There is no parameter for activating the zero pulse evaluation here, as this evaluation is controlled exclusively based on the homing mode (see Section ""Homing"" on page 249). However, setting P 541[0] - ENC_CH1_NpTest to 1 provides a test mode that can be used during commissioning in order to be able to activate the zero pulse evaluation even without homing. Scope signals 1014 and 1016 can be used to view a received zero pulse within this context. This test mode must be disabled during normal operation (P 541[0] = 0).

# Commutation

Motor operation with pure incremental encoders needs for the auto commutation function to be enabled without fail. For details see Section ""Synchronous motor auto commutation"" on page 156.

# 6.5.4.1.2 TTL incremental encoder with SSI absolute value interface

See Section ""Sin/Cos incremental encoders with absolute value interface"" on page 65 and in special Section ""SSI absolute value interface"" on page 67.

MSD ServoDrive - DeviceHelp

# 6 Encoder

MOOG ID No.:CB40859-001 Date:11/2020 MSD ServoDrive - DeviceHelp 64

|ID|Index Name|Unit|Description|
|---|---|---|---|
|505|0|ENC_CH1_Sel = 3|Encoder selection set to TTL(3)|
|510|0|ENC_CH1_Num|Encoder gearing: Numerator Ch1: SINCOS(1) - Sin/Cos signals|
|511|0|ENC_CH1_Denom|Encoder gearing: Denominator|
|540|0|ENC_CH1_Abs|Selection of absolute value interface Sin/Cos encoders can ...|
|541|0|ENC_CH1_NpTest|ENC CH1, TEST-MODE: Index pulse signal(s) to Scope|
|542|0|ENC_CH1_lines|Number of lines (Sin/Cos / TTL encoders) a. Be pure incremental encoders without an absolute value interface. In this|
|558|0|ENC_CH1_TTL_SignalType|Channel 1: TTL signal selection case, P 540[0] - ENC_CH1_Abs must be set to OFF(0).|
|601|0|ENC_CH1_Period|Maximum period of interpolation (TTL encoder)|
|616|0|ENC_CH1_CycleCount|Sampling cycle in: n x 125 μ (microseconds) b. Be incremental encoders with an absolute value interface. In this case,|

Table 6.8: Parameters for Channel 1 (X7) - TTL encoder

ENC_CH1_Abs must be accordingly set to SSI(1), EnDat(2), HIPER(3) or, in special cases, SSI_CONT(4) so that it will be possible to read the absolute encoder position for the absolute value initialization routine once during the initialization phase.

# 6.5.4.2.1 Purely Sin/Cos incremental encoders

To run these encoders as purely incremental encoders with a zero pulse on encoder channel Ch1 (without an absolute value interface), the approach is basically the same as for purely TTL operation (see Section ""TTL encoder"" on page 63). The same parameters apply.

However, there are the following differences:

- a. There are no different signal types for the Sin/Cos signal (always 1 Vss for cosine and sine).
- b. The zero pulse is the analog zero pulse typical of Sin/Cos encoders (see the “Connection for high-resolution encoders” section in the operation manual MSD Servo Drive Single-Axis System, for example).

# 6.5.4.2.2 Linear Sin/Cos

|ID|Index Name|Unit|Description|
|---|---|---|---|
|542|ENC_CH1_lines| |Number of Lines (Sin/Cos / TTL encoders)|
|543|ENC_CH1_MultiT| |Number of MultiTurn bits (absolute encoder)|
|544|ENC_CH1_SingleT| |Number of SingleTurn bits (absolute encoder)|
|545|ENC_CH1_Code| |Code selection (SSI encoder) (binary, gray)|
|546|ENC_CH1_Mode| |Mode selection (SSI encoder)|
|547|ENC_CH1_MTBase| |Definition of point of discontinuity in multi-turn range|
|548|ENC_CH1_MTEnable| |Enable MultiTurn use (negative logic, 1=MToff)|
|549|ENC_CH1_Corr| |Signal correction type|
|550|ENC_CH1_CorrVal|0-4|Signal correction values|
|551|ENC_CH1_EncObsMin| |Encoder monitoring minimum, sqrt(a^2+b^2)|
|552|ENC_CH1_AbsEncStatus| |Error and status codes (absolute encoder)|

# 6.5.4.2.3 Signal correction (GPOC)

|ID|Index Name|Unit|Description|
|---|---|---|---|
|553|ENC_CH1_PeriodLen|nm|Length of signal period (Sin/Cos linear encoder)|
|554|ENC_CH1_DigitalResolution|nm|Length of one increment (linear absolute encoder)|
|555|ENC_CH1_Info| |Encoder information|
|616|ENC_CH1_CycleCount| |Sampling cycle in: n x 125 μ (microseconds)|
|610|ENC_CH1_NominalIncrementA| |Sign. Nominal increment A (distance coded abs. per. encoder)|
|611|ENC_CH1_NominalIncrementB| |Sign. Nominal increment B (distance coded abs. per. encoder)|
|1900|ENC_ETS| |ETS mode, electronic nameplate|

# 6.5.4.2.4 Sin/Cos incremental encoders with absolute value interface

The following table lists the parameters for cyclical Sin/Cos operation on encoder channel Ch 1 with one-time reading of the absolute encoder position via the absolute value interface, i.e. without a zero pulse:

|ID|Index Name|Unit|Description|
|---|---|---|---|
|505|ENC_CH1_Sel|1|Encoder selection set to SINCOS(1)|
|510|ENC_CH1_Num| |Encoder gearing: Numerator|
|511|ENC_CH1_Denom| |Encoder gearing: Denominator|
|540|ENC_CH1_Abs| |Absolute value interface selection (one-time reading)|

Table 6.9: Parameters for channel 1 (X7) - Sin/Cos encoder

The Sel, Num, Denom, Abs, Lines, MultiT, SingleT and CorrVal parameters are self-explanatory.

The Code and Mode parameters are described in Section ""SSI (cyclical) X7"" on page 69.

P 547[0] - ENC_CH1_MTBase = Minimum MultiTurn position

The MTBase parameter is used to set a position in the multi-turn encoder’s travel path that defines the point of discontinuity (overflow/underflow) for the absolute value initialization (that is, the “multi-turn basis”). Assuming a bipolar encoder measuring range, all position values that fall below MTBase will be shifted “up” (the whole MT range will be added to them once).

MOOG ID No.:CB40859-001 Date:11/2020

MSD ServoDrive - DeviceHelp

# 6 Encoder

MOOG ID No.:CB40859-001 Date:11/2020

method makes it possible to place the point of discontinuity at any point within the encoder’s entire measuring range. By default, MTBase will be set to the lowest possible value for the parameter, i.e. reliably outside of the encoder’s value range: In this case, the full bipolar range will remain unaffected, as values will never fall below this MTBase threshold (see Section ""Channel 1: Interface X7"" on page 59).

- P 548[0] - ENC_CH1_MTEnable = MultiTurn as SingleTurn
- The MTEnable parameter makes it possible to use multi-turn encoders as single-turn encoders for test purposes. Negative logic: Default MTEnable = 0 means ""MultiTurn-Enable ON"".

P 549[0] - ENC_CH1_Corr = Signal correction type
- The GPOC routine used for track signal correction purposes for sine/cosine signals is used to compensate for systematic errors. The routine is controlled with the Corr and CorrVal parameters (see Section ""Signal correction GPOC (Gain Phase Offset Correction)"" on page 74).

P 551[0] - ENC_CH1_EncObsMin = Encoder monitoring minimum, sqrt (a^2+b^2)
- The parameter EncObsMin is used to scale the Sin/Cos wire break monitoring and represents the “downwards threshold” for an error message. The default setting is 0.2, corresponding to approx. ",What are the differences between P 543[0] - ENC_CH1_MultiT and P 544[0] - ENC_CH1_SingleT parameters?,A4,"The MultiT parameter covers the encoder's entire travel range, whereas SingleT focuses on the resolution per single revolution.",2.078125,2.1875,3.5,1.546875,0.486328125
19,msd_servo_drive.txt,20,02f242a213dfa4411d028ce46dfba16a3f97395fa25788fcbaea1715e779d934,"), consult with your project supervisor or the Helpline provided by Moog before using any special SSI protocol modes.

# 6.5.2 EnDat (cyclical) X7

Ch1: ENDAT(4) - Cyclical EnDat (2.1 or 2.2) EnDat is a digital encoder interface developed by HEIDENHAIN. For more details, please visit www.heidenhain.de and go to ►Documentation ►Fundamentals ►Interfaces ►EnDat 2.2.

The software versions required to run the EnDat encoder interface are the standard software versions for the MSD Servo Drive and MSD Single-Axis Servo Drive Compact.

MOOG ID No.:CB40859-001 Date:11/2020

# 6 Encoder

NOTE

- Please note the limitations that apply when running EnDat and SSI encoders (see Section ""Limiting for EnDat and SSI"" on page 52).

When using linear encoders, P 554[0] - ENC_CH1_DigitalResolution is used instead of P 543[0] - ENC_CH1_MultiT and P 544[0] - ENC_CH1_SingleT (which are used for rotary encoders). The values will be read from the EnDat encoder and written to the aforementioned parameters.

- P 543[0] - ENC_CH1_MultiT
- The number ""n"" of multiturn bits defines the measuring range in 2n increments per encoder shaft revolution; maximum travel until overflow; maximum travel within which the absolute value initialization can be unambiguous. In the case of single-turn encoders, MultiT = 0.
- P 544[0] - ENC_CH1_SingleT
- The number ""n"" of single-turn bits corresponds to the encoder’s digital resolution in 2n increments per encoder shaft revolution.
- P 554[0] - ENC_CH1_DigitalResolution
- This is the length of an increment, in nanometres, of the encoder’s digitally transmitted position value. This value is read from the EnDat linear head.

In the case of linear encoders, the number n of transmitted position bits from the encoder will be found in SingleT only! 2n * DigitalResolution yields the maximum travel in nanometres (for the encoder head).

P 640 - ENC_ENDAT is intended for additional information, but is normally not needed. This parameter does not have a Ch1 or Ch3 prefix for the encoder channel in the name, as it applies to both encoder channels. Although usually not needed, the parameter is helpful or required in the following cases:

1. Special EnDat encoder with diagnostics for evaluation
In this case, the valuation numbers from the encoder are read cyclically via additional information. Only the valuation numbers that the encoder supports.

# 6 Encoder

MOOG ID No.:CB40859-001 Date:11/2020

will be read. During the initialization process, the system will read the encoder to determine which valuation numbers it supports. When P 640[0] - ENDAT_Select = 1, the function will be enabled in the controller and the internal diagnostics in the EnDaT encoder will be enabled as well. The EnDat encoder will keep this setting even after being powered off. To explicitly disable the internal diagnostics in the EnDat encoder, set P 640[0] - ENDAT_Select to 2.

# 2. Evaluation of internal warnings

In this scenario, certain internal warnings from the encoder will be read from the encoder via additional information. Only the warnings that both the encoder and the Servo Drive’s software support will be read. During the initialization process, the system will read the encoder to determine which warnings it supports. When P 640[0] - ENDAT_Select = 3, the function will be enabled in the controller.

**Table 6.7: Channel 1 encoder configuration (X7) - EnDat parameters**
|ID|Index Name|Unit|Description|
|---|---|---|---|
|505|0 ENC_CH1_Sel|= ENDAT(4)| |
|543|0 ENC_CH1_MultiT|Number of MultiTurn bits (absolute encoder)| |
|544|0 ENC_CH1_SingleT|Number of SingleTurn bits (absolute encoder)| |
|547|0 ENC_CH1_MTBase|Definition of point of discontinuity in multi-turn range| |
|548|0 ENC_CH1_MTEnable|1: Use Multi-turn encoder as a single-turn encoder| |
|616|0 ENC_CH1_CycleCount|Position encoder sampling cycle (n x 125 μsec)| |
|598|0 ENC_CH1_Position|inc|Position encoder channel 1|
|554|0 ENC_CH1_|nm|Length of one increment (linear absolute encoder)|
|640|ENC_ENDAT| |EnDat additional (additional information)|
|640|0 ENDAT_Select|0=off|EnDat function selection, 1/2=diagnosis on/off, 3=warnings, FF=lock|
|640|1 ENDAT_DiagCount|u16|count new diagnosis block header|
|640|2 ENDAT_BWZ_1|lowbyte|vn1: incremental track|
|640|3 ENDAT_BWZ_3|lowbyte|vn3: absolute track|
|640|4 ENDAT_BWZ_4|lowbyte|vn4: position value formation|
|640|5 ENDAT_Status| |EnDat additional status output|
|640|6 ENDAT_Z1_Sel| |EnDat additional information 1 type selection|

**Table 6.7: Overwrite Channel 1 encoder configuration (X7) - EnDat parameters (continue)**
|ID|Index Name|Unit|Description|
|---|---|---|---|
|640|7 ENDAT_Z1_1| |Z1 info: dword 1|
|640|8 ENDAT_Z1_2| |Z1 info: dword 2|
|640|9 ENDAT_Z1_3| |Z1 info: dword 3|
|640|10 ENDAT_Z1_4| |Z1 info: dword 4|
|640|11 ENDAT_Z2_Sel| |EnDat additional information 2 type selection|
|640|12 ENDAT_Z2_1| |Z2 info: dword 1|
|640|13 ENDAT_Z2_2| |Z2 info: dword 2|
|640|14 ENDAT_Z2_3| |Z2 info: dword 3|
|640|15 ENDAT_Z2_4| |Z2 info: dword 4|
|640|16 ENDAT_Mode1|0=off|EnDat additional mode 1 selection|
|640|17 ENDAT_Mode2| |EnDat additional mode 2 selection|
|640|18 ENDAT_Mode3| |EnDat additional mode 3 selection|
|640|19 ENDAT_Mode4| |EnDat additional mode 4 selection|
|640|20 ENDAT_res1| |reserved 1|
|640|21 ENDAT_res2| |reserved 2|
|640|22 ENDAT_res3| |reserved 3|
|640|23 ENDAT_HwSyncStop|0=SyncOn|EnDat cyclic hw sync, stop/start 1/0|
|640|24 ENDAT_CyclCount| |call counter of cyclic function|
|640|25 ENDAT_BWZ_Supported| |vn supported (bit3=vn4, bit2=vn3, bit0=vn1)|
|640|26 ENDAT_BWZ1_| |vn1: bits[7..0] threshold level, bits[31..16]|
|640|27 ThresholdLevel| |how often number|
|640|28 ENDAT_BWZ3_| |vn3: bits[7..0] threshold level, bits[31..16]|
|640|29 ThresholdLevel| |how often number|
|640|30 ENDAT_BWZ4_| |vn4: bits[7..0] threshold level, bits[31..16]|
|640|31 ThresholdLevel| |how often number|
|640|32 ENDAT_BWZ_TEST_| |vn: bits[15..12] 'F', bits[11..8] vn.no., bits [7..0] vn overwrite value|

# 6.5.3 Hall sensor X7

Ch1: HALL(5) - Digital hall signals

Ch1: HALL_TTL(7) - Digital hall signals

NOTE

l The operation and configuration of Hall effect sensors is reserved for special applications. Consult with Moog if needed.

# 6.5.4 Sin/Cos / TTL X7

# 6.5.4.1 TTL encoder

Ch1: TTL(3) - TTL signals

TTL encoders are ...

- a. ... ... usually pure incremental encoders without an absolute value interface.
- b. In this case, P 540[0] - ENC_CH1_Abs must be set to OFF(0). ... ... in a few exceptional cases, incremental encoders with an SSI absolute value interface. In this case, P 540[0] - ENC_CH1_Abs must be accordingly set to SSI(1) (SSI_CONT(4) in special cases), so that it will be possible to read the absolute encoder position for the absolute value initialization routine once during the initialization phase.

# 6.5.4.1.1 Pure TTL incremental encoder

Set P 505[0] - ENC_CH1_Sel to TTL(3) and P 540[0] - ENC_CH1_Abs to OFF(0) when using pure TTL encoders, i.e. encoders without an absolute value interface but with a TTL zero pulse.

Linear TTL encoders are run as rotary encoders. For linear motor operation, P 542 [0] - ENC_CH1_Lines and the encoder gearing (see the “Encoder gearing” section) are used to establish the ratio for the linear motor’s pole pair subdivision (North-North) for commutation. 1 x North-North corresponds to one revolution from Lines. In this case, the motor pole pair number must be set to 1. Moreover, P 553[0] - ENC_CH1_PeriodLen is not used in this case.

The TTL interface accepts various TTL signal types, which can be selected using P 558[0] - ENC_CH1_TTL_SignalType:

- (0)AF_B - A/B tracks (forward counting, X4 encoding) - AB
- (1)AR_B - A/B tracks (reverse counting, X4 encoding) - AB_inv
- (2)ABDFN - A: Clock (falling edge), B: Direction (1 = positive) - PulseDir
- (3)ABDRP - A: Clock (rising edge), B: Direction (1 = negative) - PulseDir_inv
- (4)reserved

A maximum interpolation period, in ms (milliseconds), can be configured for the TTL interface using P 601[0] - ENC_CH1_Period. Within this context, Period is the maximum time of “no activity” since the last TTL counter event:

- Period = 0: Function disabled (default)
- Period > 0 (=n ms): If no counter event is registered in n ms, the speed will be set to 0.

# Zero pulse

There is no parameter for activating the zero pulse evaluation here, as this evaluation is controlled exclusively based on the homing mode (see Section ""Homing"" on page 249). However, setting P 541[0] - ENC_CH1_NpTest to 1 provides a test mode that can be used during commissioning in order to be able to activate the zero pulse evaluation even without homing. Scope signals 1014 and 1016 can be used to view a received zero pulse within this context. This test mode must be disabled during normal operation (P 541[0] = 0).

# Commutation

Motor operation with pure incremental encoders needs for the auto commutation function to be enabled without fail. For details see Section ""Synchronous motor auto commutation"" on page 156.

# 6.5.4.1.2 TTL incremental encoder with SSI absolute value interface

See Section ""Sin/Cos incremental encoders with absolute value interface"" on page 65 and in special Section ""SSI absolute value interface"" on page 67.

MSD ServoDrive - DeviceHelp

# 6 Encoder

MOOG ID No.:CB40859-001 Date:11/2020 MSD ServoDrive - DeviceHelp 64

|ID|Index Name|Unit|Description|
|---|---|---|---|
|505|0|ENC_CH1_Sel = 3|Encoder selection set to TTL(3)|
|510|0|ENC_CH1_Num|Encoder gearing: Numerator Ch1: SINCOS(1) - Sin/Cos signals|
|511|0|ENC_CH1_Denom|Encoder gearing: Denominator|
|540|0|ENC_CH1_Abs|Selection of absolute value interface Sin/Cos encoders can ...|
|541|0|ENC_CH1_NpTest|ENC CH1, TEST-MODE: Index pulse signal(s) to Scope|
|542|0|ENC_CH1_lines|Number of lines (Sin/Cos / TTL encoders) a. Be pure incremental encoders without an absolute value interface. In this|
|558|0|ENC_CH1_TTL_SignalType|Channel 1: TTL signal selection case, P 540[0] - ENC_CH1_Abs must be set to OFF(0).|
|601|0|ENC_CH1_Period|Maximum period of interpolation (TTL encoder)|
|616|0|ENC_CH1_CycleCount|Sampling cycle in: n x 125 μ (microseconds) b. Be incremental encoders with an absolute value interface. In this case,|

Table 6.8: Parameters for Channel 1 (X7) - TTL encoder

ENC_CH1_Abs must be accordingly set to SSI(1), EnDat(2), HIPER(3) or, in special cases, SSI_CONT(4) so that it will be possible to read the absolute encoder position for the absolute value initialization routine once during the initialization phase.

# 6.5.4.2.1 Purely Sin/Cos incremental encoders

To run these encoders as purely incremental encoders with a zero pulse on encoder channel Ch1 (without an absolute value interface), the approach is basically the same as for purely TTL operation (see Section ""TTL encoder"" on page 63). The same parameters apply.

However, there are the following differences:

- a. There are no different signal types for the Sin/Cos signal (always 1 Vss for cosine and sine).
- b. The zero pulse is the analog zero pulse typical of Sin/Cos encoders (see the “Connection for high-resolution encoders” section in the operation manual MSD Servo Drive Single-Axis System, for example).

# 6.5.4.2.2 Linear Sin/Cos

|ID|Index Name|Unit|Description|
|---|---|---|---|
|542|ENC_CH1_lines| |Number of Lines (Sin/Cos / TTL encoders)|
|543|ENC_CH1_MultiT| |Number of MultiTurn bits (absolute encoder)|
|544|ENC_CH1_SingleT| |Number of SingleTurn bits (absolute encoder)|
|545|ENC_CH1_Code| |Code selection (SSI encoder) (binary, gray)|
|546|ENC_CH1_Mode| |Mode selection (SSI encoder)|
|547|ENC_CH1_MTBase| |Definition of point of discontinuity in multi-turn range|
|548|ENC_CH1_MTEnable| |Enable MultiTurn use (negative logic, 1=MToff)|
|549|ENC_CH1_Corr| |Signal correction type|
|550|ENC_CH1_CorrVal|0-4|Signal correction values|
|551|ENC_CH1_EncObsMin| |Encoder monitoring minimum, sqrt(a^2+b^2)|
|552|ENC_CH1_AbsEncStatus| |Error and status codes (absolute encoder)|

# 6.5.4.2.3 Signal correction (GPOC)

|ID|Index Name|Unit|Description|
|---|---|---|---|
|553|ENC_CH1_PeriodLen|nm|Length of signal period (Sin/Cos linear encoder)|
|554|ENC_CH1_DigitalResolution|nm|Length of one increment (linear absolute encoder)|
|555|ENC_CH1_Info| |Encoder information|
|616|ENC_CH1_CycleCount| |Sampling cycle in: n x 125 μ (microseconds)|
|610|ENC_CH1_NominalIncrementA| |Sign. Nominal increment A (distance coded abs. per. encoder)|
|611|ENC_CH1_NominalIncrementB| |Sign. Nominal increment B (distance coded abs. per. encoder)|
|1900|ENC_ETS| |ETS mode, electronic nameplate|

# 6.5.4.2.4 Sin/Cos incremental encoders with absolute value interface

The following table lists the parameters for cyclical Sin/Cos operation on encoder channel Ch 1 with one-time reading of the absolute encoder position via the absolute value interface, i.e. without a zero pulse:

|ID|Index Name|Unit|Description|
|---|---|---|---|
|505|ENC_CH1_Sel|1|Encoder selection set to SINCOS(1)|
|510|ENC_CH1_Num| |Encoder gearing: Numerator|
|511|ENC_CH1_Denom| |Encoder gearing: Denominator|
|540|ENC_CH1_Abs| |Absolute value interface selection (one-time reading)|

Table 6.9: Parameters for channel 1 (X7) - Sin/Cos encoder

The Sel, Num, Denom, Abs, Lines, MultiT, SingleT and CorrVal parameters are self-explanatory.

The Code and Mode parameters are described in Section ""SSI (cyclical) X7"" on page 69.

P 547[0] - ENC_CH1_MTBase = Minimum MultiTurn position

The MTBase parameter is used to set a position in the multi-turn encoder’s travel path that defines the point of discontinuity (overflow/underflow) for the absolute value initialization (that is, the “multi-turn basis”). Assuming a bipolar encoder measuring range, all position values that fall below MTBase will be shifted “up” (the whole MT range will be added to them once).

MOOG ID No.:CB40859-001 Date:11/2020

MSD ServoDrive - DeviceHelp

# 6 Encoder

MOOG ID No.:CB40859-001 Date:11/2020

method makes it possible to place the point of discontinuity at any point within the encoder’s entire measuring range. By default, MTBase will be set to the lowest possible value for the parameter, i.e. reliably outside of the encoder’s value range: In this case, the full bipolar range will remain unaffected, as values will never fall below this MTBase threshold (see Section ""Channel 1: Interface X7"" on page 59).

- P 548[0] - ENC_CH1_MTEnable = MultiTurn as SingleTurn
- The MTEnable parameter makes it possible to use multi-turn encoders as single-turn encoders for test purposes. Negative logic: Default MTEnable = 0 means ""MultiTurn-Enable ON"".

P 549[0] - ENC_CH1_Corr = Signal correction type
- The GPOC routine used for track signal correction purposes for sine/cosine signals is used to compensate for systematic errors. The routine is controlled with the Corr and CorrVal parameters (see Section ""Signal correction GPOC (Gain Phase Offset Correction)"" on page 74).

P 551[0] - ENC_CH1_EncObsMin = Encoder monitoring minimum, sqrt (a^2+b^2)
- The parameter EncObsMin is used to scale the Sin/Cos wire break monitoring and represents the “downwards threshold” for an error message. The default setting is 0.2, corresponding to approx. ",What are the differences between P 543[0] - ENC_CH1_MultiT and P 544[0] - ENC_CH1_SingleT parameters?,A5,"MultiT and SingleT parameters respectively manage the encoder's multi-revolution range and per-revolution resolution, essential for accurate positioning.",1.1875,1.2734375,2.984375,1.4921875,0.3515625
20,msd_servo_drive.txt,20,02f242a213dfa4411d028ce46dfba16a3f97395fa25788fcbaea1715e779d934,"), consult with your project supervisor or the Helpline provided by Moog before using any special SSI protocol modes.

# 6.5.2 EnDat (cyclical) X7

Ch1: ENDAT(4) - Cyclical EnDat (2.1 or 2.2) EnDat is a digital encoder interface developed by HEIDENHAIN. For more details, please visit www.heidenhain.de and go to ►Documentation ►Fundamentals ►Interfaces ►EnDat 2.2.

The software versions required to run the EnDat encoder interface are the standard software versions for the MSD Servo Drive and MSD Single-Axis Servo Drive Compact.

MOOG ID No.:CB40859-001 Date:11/2020

# 6 Encoder

NOTE

- Please note the limitations that apply when running EnDat and SSI encoders (see Section ""Limiting for EnDat and SSI"" on page 52).

When using linear encoders, P 554[0] - ENC_CH1_DigitalResolution is used instead of P 543[0] - ENC_CH1_MultiT and P 544[0] - ENC_CH1_SingleT (which are used for rotary encoders). The values will be read from the EnDat encoder and written to the aforementioned parameters.

- P 543[0] - ENC_CH1_MultiT
- The number ""n"" of multiturn bits defines the measuring range in 2n increments per encoder shaft revolution; maximum travel until overflow; maximum travel within which the absolute value initialization can be unambiguous. In the case of single-turn encoders, MultiT = 0.
- P 544[0] - ENC_CH1_SingleT
- The number ""n"" of single-turn bits corresponds to the encoder’s digital resolution in 2n increments per encoder shaft revolution.
- P 554[0] - ENC_CH1_DigitalResolution
- This is the length of an increment, in nanometres, of the encoder’s digitally transmitted position value. This value is read from the EnDat linear head.

In the case of linear encoders, the number n of transmitted position bits from the encoder will be found in SingleT only! 2n * DigitalResolution yields the maximum travel in nanometres (for the encoder head).

P 640 - ENC_ENDAT is intended for additional information, but is normally not needed. This parameter does not have a Ch1 or Ch3 prefix for the encoder channel in the name, as it applies to both encoder channels. Although usually not needed, the parameter is helpful or required in the following cases:

1. Special EnDat encoder with diagnostics for evaluation
In this case, the valuation numbers from the encoder are read cyclically via additional information. Only the valuation numbers that the encoder supports.

# 6 Encoder

MOOG ID No.:CB40859-001 Date:11/2020

will be read. During the initialization process, the system will read the encoder to determine which valuation numbers it supports. When P 640[0] - ENDAT_Select = 1, the function will be enabled in the controller and the internal diagnostics in the EnDaT encoder will be enabled as well. The EnDat encoder will keep this setting even after being powered off. To explicitly disable the internal diagnostics in the EnDat encoder, set P 640[0] - ENDAT_Select to 2.

# 2. Evaluation of internal warnings

In this scenario, certain internal warnings from the encoder will be read from the encoder via additional information. Only the warnings that both the encoder and the Servo Drive’s software support will be read. During the initialization process, the system will read the encoder to determine which warnings it supports. When P 640[0] - ENDAT_Select = 3, the function will be enabled in the controller.

**Table 6.7: Channel 1 encoder configuration (X7) - EnDat parameters**
|ID|Index Name|Unit|Description|
|---|---|---|---|
|505|0 ENC_CH1_Sel|= ENDAT(4)| |
|543|0 ENC_CH1_MultiT|Number of MultiTurn bits (absolute encoder)| |
|544|0 ENC_CH1_SingleT|Number of SingleTurn bits (absolute encoder)| |
|547|0 ENC_CH1_MTBase|Definition of point of discontinuity in multi-turn range| |
|548|0 ENC_CH1_MTEnable|1: Use Multi-turn encoder as a single-turn encoder| |
|616|0 ENC_CH1_CycleCount|Position encoder sampling cycle (n x 125 μsec)| |
|598|0 ENC_CH1_Position|inc|Position encoder channel 1|
|554|0 ENC_CH1_|nm|Length of one increment (linear absolute encoder)|
|640|ENC_ENDAT| |EnDat additional (additional information)|
|640|0 ENDAT_Select|0=off|EnDat function selection, 1/2=diagnosis on/off, 3=warnings, FF=lock|
|640|1 ENDAT_DiagCount|u16|count new diagnosis block header|
|640|2 ENDAT_BWZ_1|lowbyte|vn1: incremental track|
|640|3 ENDAT_BWZ_3|lowbyte|vn3: absolute track|
|640|4 ENDAT_BWZ_4|lowbyte|vn4: position value formation|
|640|5 ENDAT_Status| |EnDat additional status output|
|640|6 ENDAT_Z1_Sel| |EnDat additional information 1 type selection|

**Table 6.7: Overwrite Channel 1 encoder configuration (X7) - EnDat parameters (continue)**
|ID|Index Name|Unit|Description|
|---|---|---|---|
|640|7 ENDAT_Z1_1| |Z1 info: dword 1|
|640|8 ENDAT_Z1_2| |Z1 info: dword 2|
|640|9 ENDAT_Z1_3| |Z1 info: dword 3|
|640|10 ENDAT_Z1_4| |Z1 info: dword 4|
|640|11 ENDAT_Z2_Sel| |EnDat additional information 2 type selection|
|640|12 ENDAT_Z2_1| |Z2 info: dword 1|
|640|13 ENDAT_Z2_2| |Z2 info: dword 2|
|640|14 ENDAT_Z2_3| |Z2 info: dword 3|
|640|15 ENDAT_Z2_4| |Z2 info: dword 4|
|640|16 ENDAT_Mode1|0=off|EnDat additional mode 1 selection|
|640|17 ENDAT_Mode2| |EnDat additional mode 2 selection|
|640|18 ENDAT_Mode3| |EnDat additional mode 3 selection|
|640|19 ENDAT_Mode4| |EnDat additional mode 4 selection|
|640|20 ENDAT_res1| |reserved 1|
|640|21 ENDAT_res2| |reserved 2|
|640|22 ENDAT_res3| |reserved 3|
|640|23 ENDAT_HwSyncStop|0=SyncOn|EnDat cyclic hw sync, stop/start 1/0|
|640|24 ENDAT_CyclCount| |call counter of cyclic function|
|640|25 ENDAT_BWZ_Supported| |vn supported (bit3=vn4, bit2=vn3, bit0=vn1)|
|640|26 ENDAT_BWZ1_| |vn1: bits[7..0] threshold level, bits[31..16]|
|640|27 ThresholdLevel| |how often number|
|640|28 ENDAT_BWZ3_| |vn3: bits[7..0] threshold level, bits[31..16]|
|640|29 ThresholdLevel| |how often number|
|640|30 ENDAT_BWZ4_| |vn4: bits[7..0] threshold level, bits[31..16]|
|640|31 ThresholdLevel| |how often number|
|640|32 ENDAT_BWZ_TEST_| |vn: bits[15..12] 'F', bits[11..8] vn.no., bits [7..0] vn overwrite value|

# 6.5.3 Hall sensor X7

Ch1: HALL(5) - Digital hall signals

Ch1: HALL_TTL(7) - Digital hall signals

NOTE

l The operation and configuration of Hall effect sensors is reserved for special applications. Consult with Moog if needed.

# 6.5.4 Sin/Cos / TTL X7

# 6.5.4.1 TTL encoder

Ch1: TTL(3) - TTL signals

TTL encoders are ...

- a. ... ... usually pure incremental encoders without an absolute value interface.
- b. In this case, P 540[0] - ENC_CH1_Abs must be set to OFF(0). ... ... in a few exceptional cases, incremental encoders with an SSI absolute value interface. In this case, P 540[0] - ENC_CH1_Abs must be accordingly set to SSI(1) (SSI_CONT(4) in special cases), so that it will be possible to read the absolute encoder position for the absolute value initialization routine once during the initialization phase.

# 6.5.4.1.1 Pure TTL incremental encoder

Set P 505[0] - ENC_CH1_Sel to TTL(3) and P 540[0] - ENC_CH1_Abs to OFF(0) when using pure TTL encoders, i.e. encoders without an absolute value interface but with a TTL zero pulse.

Linear TTL encoders are run as rotary encoders. For linear motor operation, P 542 [0] - ENC_CH1_Lines and the encoder gearing (see the “Encoder gearing” section) are used to establish the ratio for the linear motor’s pole pair subdivision (North-North) for commutation. 1 x North-North corresponds to one revolution from Lines. In this case, the motor pole pair number must be set to 1. Moreover, P 553[0] - ENC_CH1_PeriodLen is not used in this case.

The TTL interface accepts various TTL signal types, which can be selected using P 558[0] - ENC_CH1_TTL_SignalType:

- (0)AF_B - A/B tracks (forward counting, X4 encoding) - AB
- (1)AR_B - A/B tracks (reverse counting, X4 encoding) - AB_inv
- (2)ABDFN - A: Clock (falling edge), B: Direction (1 = positive) - PulseDir
- (3)ABDRP - A: Clock (rising edge), B: Direction (1 = negative) - PulseDir_inv
- (4)reserved

A maximum interpolation period, in ms (milliseconds), can be configured for the TTL interface using P 601[0] - ENC_CH1_Period. Within this context, Period is the maximum time of “no activity” since the last TTL counter event:

- Period = 0: Function disabled (default)
- Period > 0 (=n ms): If no counter event is registered in n ms, the speed will be set to 0.

# Zero pulse

There is no parameter for activating the zero pulse evaluation here, as this evaluation is controlled exclusively based on the homing mode (see Section ""Homing"" on page 249). However, setting P 541[0] - ENC_CH1_NpTest to 1 provides a test mode that can be used during commissioning in order to be able to activate the zero pulse evaluation even without homing. Scope signals 1014 and 1016 can be used to view a received zero pulse within this context. This test mode must be disabled during normal operation (P 541[0] = 0).

# Commutation

Motor operation with pure incremental encoders needs for the auto commutation function to be enabled without fail. For details see Section ""Synchronous motor auto commutation"" on page 156.

# 6.5.4.1.2 TTL incremental encoder with SSI absolute value interface

See Section ""Sin/Cos incremental encoders with absolute value interface"" on page 65 and in special Section ""SSI absolute value interface"" on page 67.

MSD ServoDrive - DeviceHelp

# 6 Encoder

MOOG ID No.:CB40859-001 Date:11/2020 MSD ServoDrive - DeviceHelp 64

|ID|Index Name|Unit|Description|
|---|---|---|---|
|505|0|ENC_CH1_Sel = 3|Encoder selection set to TTL(3)|
|510|0|ENC_CH1_Num|Encoder gearing: Numerator Ch1: SINCOS(1) - Sin/Cos signals|
|511|0|ENC_CH1_Denom|Encoder gearing: Denominator|
|540|0|ENC_CH1_Abs|Selection of absolute value interface Sin/Cos encoders can ...|
|541|0|ENC_CH1_NpTest|ENC CH1, TEST-MODE: Index pulse signal(s) to Scope|
|542|0|ENC_CH1_lines|Number of lines (Sin/Cos / TTL encoders) a. Be pure incremental encoders without an absolute value interface. In this|
|558|0|ENC_CH1_TTL_SignalType|Channel 1: TTL signal selection case, P 540[0] - ENC_CH1_Abs must be set to OFF(0).|
|601|0|ENC_CH1_Period|Maximum period of interpolation (TTL encoder)|
|616|0|ENC_CH1_CycleCount|Sampling cycle in: n x 125 μ (microseconds) b. Be incremental encoders with an absolute value interface. In this case,|

Table 6.8: Parameters for Channel 1 (X7) - TTL encoder

ENC_CH1_Abs must be accordingly set to SSI(1), EnDat(2), HIPER(3) or, in special cases, SSI_CONT(4) so that it will be possible to read the absolute encoder position for the absolute value initialization routine once during the initialization phase.

# 6.5.4.2.1 Purely Sin/Cos incremental encoders

To run these encoders as purely incremental encoders with a zero pulse on encoder channel Ch1 (without an absolute value interface), the approach is basically the same as for purely TTL operation (see Section ""TTL encoder"" on page 63). The same parameters apply.

However, there are the following differences:

- a. There are no different signal types for the Sin/Cos signal (always 1 Vss for cosine and sine).
- b. The zero pulse is the analog zero pulse typical of Sin/Cos encoders (see the “Connection for high-resolution encoders” section in the operation manual MSD Servo Drive Single-Axis System, for example).

# 6.5.4.2.2 Linear Sin/Cos

|ID|Index Name|Unit|Description|
|---|---|---|---|
|542|ENC_CH1_lines| |Number of Lines (Sin/Cos / TTL encoders)|
|543|ENC_CH1_MultiT| |Number of MultiTurn bits (absolute encoder)|
|544|ENC_CH1_SingleT| |Number of SingleTurn bits (absolute encoder)|
|545|ENC_CH1_Code| |Code selection (SSI encoder) (binary, gray)|
|546|ENC_CH1_Mode| |Mode selection (SSI encoder)|
|547|ENC_CH1_MTBase| |Definition of point of discontinuity in multi-turn range|
|548|ENC_CH1_MTEnable| |Enable MultiTurn use (negative logic, 1=MToff)|
|549|ENC_CH1_Corr| |Signal correction type|
|550|ENC_CH1_CorrVal|0-4|Signal correction values|
|551|ENC_CH1_EncObsMin| |Encoder monitoring minimum, sqrt(a^2+b^2)|
|552|ENC_CH1_AbsEncStatus| |Error and status codes (absolute encoder)|

# 6.5.4.2.3 Signal correction (GPOC)

|ID|Index Name|Unit|Description|
|---|---|---|---|
|553|ENC_CH1_PeriodLen|nm|Length of signal period (Sin/Cos linear encoder)|
|554|ENC_CH1_DigitalResolution|nm|Length of one increment (linear absolute encoder)|
|555|ENC_CH1_Info| |Encoder information|
|616|ENC_CH1_CycleCount| |Sampling cycle in: n x 125 μ (microseconds)|
|610|ENC_CH1_NominalIncrementA| |Sign. Nominal increment A (distance coded abs. per. encoder)|
|611|ENC_CH1_NominalIncrementB| |Sign. Nominal increment B (distance coded abs. per. encoder)|
|1900|ENC_ETS| |ETS mode, electronic nameplate|

# 6.5.4.2.4 Sin/Cos incremental encoders with absolute value interface

The following table lists the parameters for cyclical Sin/Cos operation on encoder channel Ch 1 with one-time reading of the absolute encoder position via the absolute value interface, i.e. without a zero pulse:

|ID|Index Name|Unit|Description|
|---|---|---|---|
|505|ENC_CH1_Sel|1|Encoder selection set to SINCOS(1)|
|510|ENC_CH1_Num| |Encoder gearing: Numerator|
|511|ENC_CH1_Denom| |Encoder gearing: Denominator|
|540|ENC_CH1_Abs| |Absolute value interface selection (one-time reading)|

Table 6.9: Parameters for channel 1 (X7) - Sin/Cos encoder

The Sel, Num, Denom, Abs, Lines, MultiT, SingleT and CorrVal parameters are self-explanatory.

The Code and Mode parameters are described in Section ""SSI (cyclical) X7"" on page 69.

P 547[0] - ENC_CH1_MTBase = Minimum MultiTurn position

The MTBase parameter is used to set a position in the multi-turn encoder’s travel path that defines the point of discontinuity (overflow/underflow) for the absolute value initialization (that is, the “multi-turn basis”). Assuming a bipolar encoder measuring range, all position values that fall below MTBase will be shifted “up” (the whole MT range will be added to them once).

MOOG ID No.:CB40859-001 Date:11/2020

MSD ServoDrive - DeviceHelp

# 6 Encoder

MOOG ID No.:CB40859-001 Date:11/2020

method makes it possible to place the point of discontinuity at any point within the encoder’s entire measuring range. By default, MTBase will be set to the lowest possible value for the parameter, i.e. reliably outside of the encoder’s value range: In this case, the full bipolar range will remain unaffected, as values will never fall below this MTBase threshold (see Section ""Channel 1: Interface X7"" on page 59).

- P 548[0] - ENC_CH1_MTEnable = MultiTurn as SingleTurn
- The MTEnable parameter makes it possible to use multi-turn encoders as single-turn encoders for test purposes. Negative logic: Default MTEnable = 0 means ""MultiTurn-Enable ON"".

P 549[0] - ENC_CH1_Corr = Signal correction type
- The GPOC routine used for track signal correction purposes for sine/cosine signals is used to compensate for systematic errors. The routine is controlled with the Corr and CorrVal parameters (see Section ""Signal correction GPOC (Gain Phase Offset Correction)"" on page 74).

P 551[0] - ENC_CH1_EncObsMin = Encoder monitoring minimum, sqrt (a^2+b^2)
- The parameter EncObsMin is used to scale the Sin/Cos wire break monitoring and represents the “downwards threshold” for an error message. The default setting is 0.2, corresponding to approx. ",What are the key considerations when configuring P 558[0] - ENC_CH1_TTL_SignalType for TTL encoders?,A1,"P 558[0] selects the TTL signal type, with options like A/B tracks for forward/reverse counting and PulseDir for clock/direction encoding.",2.0625,2.046875,3.421875,1.671875,0.40625
21,msd_servo_drive.txt,20,02f242a213dfa4411d028ce46dfba16a3f97395fa25788fcbaea1715e779d934,"), consult with your project supervisor or the Helpline provided by Moog before using any special SSI protocol modes.

# 6.5.2 EnDat (cyclical) X7

Ch1: ENDAT(4) - Cyclical EnDat (2.1 or 2.2) EnDat is a digital encoder interface developed by HEIDENHAIN. For more details, please visit www.heidenhain.de and go to ►Documentation ►Fundamentals ►Interfaces ►EnDat 2.2.

The software versions required to run the EnDat encoder interface are the standard software versions for the MSD Servo Drive and MSD Single-Axis Servo Drive Compact.

MOOG ID No.:CB40859-001 Date:11/2020

# 6 Encoder

NOTE

- Please note the limitations that apply when running EnDat and SSI encoders (see Section ""Limiting for EnDat and SSI"" on page 52).

When using linear encoders, P 554[0] - ENC_CH1_DigitalResolution is used instead of P 543[0] - ENC_CH1_MultiT and P 544[0] - ENC_CH1_SingleT (which are used for rotary encoders). The values will be read from the EnDat encoder and written to the aforementioned parameters.

- P 543[0] - ENC_CH1_MultiT
- The number ""n"" of multiturn bits defines the measuring range in 2n increments per encoder shaft revolution; maximum travel until overflow; maximum travel within which the absolute value initialization can be unambiguous. In the case of single-turn encoders, MultiT = 0.
- P 544[0] - ENC_CH1_SingleT
- The number ""n"" of single-turn bits corresponds to the encoder’s digital resolution in 2n increments per encoder shaft revolution.
- P 554[0] - ENC_CH1_DigitalResolution
- This is the length of an increment, in nanometres, of the encoder’s digitally transmitted position value. This value is read from the EnDat linear head.

In the case of linear encoders, the number n of transmitted position bits from the encoder will be found in SingleT only! 2n * DigitalResolution yields the maximum travel in nanometres (for the encoder head).

P 640 - ENC_ENDAT is intended for additional information, but is normally not needed. This parameter does not have a Ch1 or Ch3 prefix for the encoder channel in the name, as it applies to both encoder channels. Although usually not needed, the parameter is helpful or required in the following cases:

1. Special EnDat encoder with diagnostics for evaluation
In this case, the valuation numbers from the encoder are read cyclically via additional information. Only the valuation numbers that the encoder supports.

# 6 Encoder

MOOG ID No.:CB40859-001 Date:11/2020

will be read. During the initialization process, the system will read the encoder to determine which valuation numbers it supports. When P 640[0] - ENDAT_Select = 1, the function will be enabled in the controller and the internal diagnostics in the EnDaT encoder will be enabled as well. The EnDat encoder will keep this setting even after being powered off. To explicitly disable the internal diagnostics in the EnDat encoder, set P 640[0] - ENDAT_Select to 2.

# 2. Evaluation of internal warnings

In this scenario, certain internal warnings from the encoder will be read from the encoder via additional information. Only the warnings that both the encoder and the Servo Drive’s software support will be read. During the initialization process, the system will read the encoder to determine which warnings it supports. When P 640[0] - ENDAT_Select = 3, the function will be enabled in the controller.

**Table 6.7: Channel 1 encoder configuration (X7) - EnDat parameters**
|ID|Index Name|Unit|Description|
|---|---|---|---|
|505|0 ENC_CH1_Sel|= ENDAT(4)| |
|543|0 ENC_CH1_MultiT|Number of MultiTurn bits (absolute encoder)| |
|544|0 ENC_CH1_SingleT|Number of SingleTurn bits (absolute encoder)| |
|547|0 ENC_CH1_MTBase|Definition of point of discontinuity in multi-turn range| |
|548|0 ENC_CH1_MTEnable|1: Use Multi-turn encoder as a single-turn encoder| |
|616|0 ENC_CH1_CycleCount|Position encoder sampling cycle (n x 125 μsec)| |
|598|0 ENC_CH1_Position|inc|Position encoder channel 1|
|554|0 ENC_CH1_|nm|Length of one increment (linear absolute encoder)|
|640|ENC_ENDAT| |EnDat additional (additional information)|
|640|0 ENDAT_Select|0=off|EnDat function selection, 1/2=diagnosis on/off, 3=warnings, FF=lock|
|640|1 ENDAT_DiagCount|u16|count new diagnosis block header|
|640|2 ENDAT_BWZ_1|lowbyte|vn1: incremental track|
|640|3 ENDAT_BWZ_3|lowbyte|vn3: absolute track|
|640|4 ENDAT_BWZ_4|lowbyte|vn4: position value formation|
|640|5 ENDAT_Status| |EnDat additional status output|
|640|6 ENDAT_Z1_Sel| |EnDat additional information 1 type selection|

**Table 6.7: Overwrite Channel 1 encoder configuration (X7) - EnDat parameters (continue)**
|ID|Index Name|Unit|Description|
|---|---|---|---|
|640|7 ENDAT_Z1_1| |Z1 info: dword 1|
|640|8 ENDAT_Z1_2| |Z1 info: dword 2|
|640|9 ENDAT_Z1_3| |Z1 info: dword 3|
|640|10 ENDAT_Z1_4| |Z1 info: dword 4|
|640|11 ENDAT_Z2_Sel| |EnDat additional information 2 type selection|
|640|12 ENDAT_Z2_1| |Z2 info: dword 1|
|640|13 ENDAT_Z2_2| |Z2 info: dword 2|
|640|14 ENDAT_Z2_3| |Z2 info: dword 3|
|640|15 ENDAT_Z2_4| |Z2 info: dword 4|
|640|16 ENDAT_Mode1|0=off|EnDat additional mode 1 selection|
|640|17 ENDAT_Mode2| |EnDat additional mode 2 selection|
|640|18 ENDAT_Mode3| |EnDat additional mode 3 selection|
|640|19 ENDAT_Mode4| |EnDat additional mode 4 selection|
|640|20 ENDAT_res1| |reserved 1|
|640|21 ENDAT_res2| |reserved 2|
|640|22 ENDAT_res3| |reserved 3|
|640|23 ENDAT_HwSyncStop|0=SyncOn|EnDat cyclic hw sync, stop/start 1/0|
|640|24 ENDAT_CyclCount| |call counter of cyclic function|
|640|25 ENDAT_BWZ_Supported| |vn supported (bit3=vn4, bit2=vn3, bit0=vn1)|
|640|26 ENDAT_BWZ1_| |vn1: bits[7..0] threshold level, bits[31..16]|
|640|27 ThresholdLevel| |how often number|
|640|28 ENDAT_BWZ3_| |vn3: bits[7..0] threshold level, bits[31..16]|
|640|29 ThresholdLevel| |how often number|
|640|30 ENDAT_BWZ4_| |vn4: bits[7..0] threshold level, bits[31..16]|
|640|31 ThresholdLevel| |how often number|
|640|32 ENDAT_BWZ_TEST_| |vn: bits[15..12] 'F', bits[11..8] vn.no., bits [7..0] vn overwrite value|

# 6.5.3 Hall sensor X7

Ch1: HALL(5) - Digital hall signals

Ch1: HALL_TTL(7) - Digital hall signals

NOTE

l The operation and configuration of Hall effect sensors is reserved for special applications. Consult with Moog if needed.

# 6.5.4 Sin/Cos / TTL X7

# 6.5.4.1 TTL encoder

Ch1: TTL(3) - TTL signals

TTL encoders are ...

- a. ... ... usually pure incremental encoders without an absolute value interface.
- b. In this case, P 540[0] - ENC_CH1_Abs must be set to OFF(0). ... ... in a few exceptional cases, incremental encoders with an SSI absolute value interface. In this case, P 540[0] - ENC_CH1_Abs must be accordingly set to SSI(1) (SSI_CONT(4) in special cases), so that it will be possible to read the absolute encoder position for the absolute value initialization routine once during the initialization phase.

# 6.5.4.1.1 Pure TTL incremental encoder

Set P 505[0] - ENC_CH1_Sel to TTL(3) and P 540[0] - ENC_CH1_Abs to OFF(0) when using pure TTL encoders, i.e. encoders without an absolute value interface but with a TTL zero pulse.

Linear TTL encoders are run as rotary encoders. For linear motor operation, P 542 [0] - ENC_CH1_Lines and the encoder gearing (see the “Encoder gearing” section) are used to establish the ratio for the linear motor’s pole pair subdivision (North-North) for commutation. 1 x North-North corresponds to one revolution from Lines. In this case, the motor pole pair number must be set to 1. Moreover, P 553[0] - ENC_CH1_PeriodLen is not used in this case.

The TTL interface accepts various TTL signal types, which can be selected using P 558[0] - ENC_CH1_TTL_SignalType:

- (0)AF_B - A/B tracks (forward counting, X4 encoding) - AB
- (1)AR_B - A/B tracks (reverse counting, X4 encoding) - AB_inv
- (2)ABDFN - A: Clock (falling edge), B: Direction (1 = positive) - PulseDir
- (3)ABDRP - A: Clock (rising edge), B: Direction (1 = negative) - PulseDir_inv
- (4)reserved

A maximum interpolation period, in ms (milliseconds), can be configured for the TTL interface using P 601[0] - ENC_CH1_Period. Within this context, Period is the maximum time of “no activity” since the last TTL counter event:

- Period = 0: Function disabled (default)
- Period > 0 (=n ms): If no counter event is registered in n ms, the speed will be set to 0.

# Zero pulse

There is no parameter for activating the zero pulse evaluation here, as this evaluation is controlled exclusively based on the homing mode (see Section ""Homing"" on page 249). However, setting P 541[0] - ENC_CH1_NpTest to 1 provides a test mode that can be used during commissioning in order to be able to activate the zero pulse evaluation even without homing. Scope signals 1014 and 1016 can be used to view a received zero pulse within this context. This test mode must be disabled during normal operation (P 541[0] = 0).

# Commutation

Motor operation with pure incremental encoders needs for the auto commutation function to be enabled without fail. For details see Section ""Synchronous motor auto commutation"" on page 156.

# 6.5.4.1.2 TTL incremental encoder with SSI absolute value interface

See Section ""Sin/Cos incremental encoders with absolute value interface"" on page 65 and in special Section ""SSI absolute value interface"" on page 67.

MSD ServoDrive - DeviceHelp

# 6 Encoder

MOOG ID No.:CB40859-001 Date:11/2020 MSD ServoDrive - DeviceHelp 64

|ID|Index Name|Unit|Description|
|---|---|---|---|
|505|0|ENC_CH1_Sel = 3|Encoder selection set to TTL(3)|
|510|0|ENC_CH1_Num|Encoder gearing: Numerator Ch1: SINCOS(1) - Sin/Cos signals|
|511|0|ENC_CH1_Denom|Encoder gearing: Denominator|
|540|0|ENC_CH1_Abs|Selection of absolute value interface Sin/Cos encoders can ...|
|541|0|ENC_CH1_NpTest|ENC CH1, TEST-MODE: Index pulse signal(s) to Scope|
|542|0|ENC_CH1_lines|Number of lines (Sin/Cos / TTL encoders) a. Be pure incremental encoders without an absolute value interface. In this|
|558|0|ENC_CH1_TTL_SignalType|Channel 1: TTL signal selection case, P 540[0] - ENC_CH1_Abs must be set to OFF(0).|
|601|0|ENC_CH1_Period|Maximum period of interpolation (TTL encoder)|
|616|0|ENC_CH1_CycleCount|Sampling cycle in: n x 125 μ (microseconds) b. Be incremental encoders with an absolute value interface. In this case,|

Table 6.8: Parameters for Channel 1 (X7) - TTL encoder

ENC_CH1_Abs must be accordingly set to SSI(1), EnDat(2), HIPER(3) or, in special cases, SSI_CONT(4) so that it will be possible to read the absolute encoder position for the absolute value initialization routine once during the initialization phase.

# 6.5.4.2.1 Purely Sin/Cos incremental encoders

To run these encoders as purely incremental encoders with a zero pulse on encoder channel Ch1 (without an absolute value interface), the approach is basically the same as for purely TTL operation (see Section ""TTL encoder"" on page 63). The same parameters apply.

However, there are the following differences:

- a. There are no different signal types for the Sin/Cos signal (always 1 Vss for cosine and sine).
- b. The zero pulse is the analog zero pulse typical of Sin/Cos encoders (see the “Connection for high-resolution encoders” section in the operation manual MSD Servo Drive Single-Axis System, for example).

# 6.5.4.2.2 Linear Sin/Cos

|ID|Index Name|Unit|Description|
|---|---|---|---|
|542|ENC_CH1_lines| |Number of Lines (Sin/Cos / TTL encoders)|
|543|ENC_CH1_MultiT| |Number of MultiTurn bits (absolute encoder)|
|544|ENC_CH1_SingleT| |Number of SingleTurn bits (absolute encoder)|
|545|ENC_CH1_Code| |Code selection (SSI encoder) (binary, gray)|
|546|ENC_CH1_Mode| |Mode selection (SSI encoder)|
|547|ENC_CH1_MTBase| |Definition of point of discontinuity in multi-turn range|
|548|ENC_CH1_MTEnable| |Enable MultiTurn use (negative logic, 1=MToff)|
|549|ENC_CH1_Corr| |Signal correction type|
|550|ENC_CH1_CorrVal|0-4|Signal correction values|
|551|ENC_CH1_EncObsMin| |Encoder monitoring minimum, sqrt(a^2+b^2)|
|552|ENC_CH1_AbsEncStatus| |Error and status codes (absolute encoder)|

# 6.5.4.2.3 Signal correction (GPOC)

|ID|Index Name|Unit|Description|
|---|---|---|---|
|553|ENC_CH1_PeriodLen|nm|Length of signal period (Sin/Cos linear encoder)|
|554|ENC_CH1_DigitalResolution|nm|Length of one increment (linear absolute encoder)|
|555|ENC_CH1_Info| |Encoder information|
|616|ENC_CH1_CycleCount| |Sampling cycle in: n x 125 μ (microseconds)|
|610|ENC_CH1_NominalIncrementA| |Sign. Nominal increment A (distance coded abs. per. encoder)|
|611|ENC_CH1_NominalIncrementB| |Sign. Nominal increment B (distance coded abs. per. encoder)|
|1900|ENC_ETS| |ETS mode, electronic nameplate|

# 6.5.4.2.4 Sin/Cos incremental encoders with absolute value interface

The following table lists the parameters for cyclical Sin/Cos operation on encoder channel Ch 1 with one-time reading of the absolute encoder position via the absolute value interface, i.e. without a zero pulse:

|ID|Index Name|Unit|Description|
|---|---|---|---|
|505|ENC_CH1_Sel|1|Encoder selection set to SINCOS(1)|
|510|ENC_CH1_Num| |Encoder gearing: Numerator|
|511|ENC_CH1_Denom| |Encoder gearing: Denominator|
|540|ENC_CH1_Abs| |Absolute value interface selection (one-time reading)|

Table 6.9: Parameters for channel 1 (X7) - Sin/Cos encoder

The Sel, Num, Denom, Abs, Lines, MultiT, SingleT and CorrVal parameters are self-explanatory.

The Code and Mode parameters are described in Section ""SSI (cyclical) X7"" on page 69.

P 547[0] - ENC_CH1_MTBase = Minimum MultiTurn position

The MTBase parameter is used to set a position in the multi-turn encoder’s travel path that defines the point of discontinuity (overflow/underflow) for the absolute value initialization (that is, the “multi-turn basis”). Assuming a bipolar encoder measuring range, all position values that fall below MTBase will be shifted “up” (the whole MT range will be added to them once).

MOOG ID No.:CB40859-001 Date:11/2020

MSD ServoDrive - DeviceHelp

# 6 Encoder

MOOG ID No.:CB40859-001 Date:11/2020

method makes it possible to place the point of discontinuity at any point within the encoder’s entire measuring range. By default, MTBase will be set to the lowest possible value for the parameter, i.e. reliably outside of the encoder’s value range: In this case, the full bipolar range will remain unaffected, as values will never fall below this MTBase threshold (see Section ""Channel 1: Interface X7"" on page 59).

- P 548[0] - ENC_CH1_MTEnable = MultiTurn as SingleTurn
- The MTEnable parameter makes it possible to use multi-turn encoders as single-turn encoders for test purposes. Negative logic: Default MTEnable = 0 means ""MultiTurn-Enable ON"".

P 549[0] - ENC_CH1_Corr = Signal correction type
- The GPOC routine used for track signal correction purposes for sine/cosine signals is used to compensate for systematic errors. The routine is controlled with the Corr and CorrVal parameters (see Section ""Signal correction GPOC (Gain Phase Offset Correction)"" on page 74).

P 551[0] - ENC_CH1_EncObsMin = Encoder monitoring minimum, sqrt (a^2+b^2)
- The parameter EncObsMin is used to scale the Sin/Cos wire break monitoring and represents the “downwards threshold” for an error message. The default setting is 0.2, corresponding to approx. ",What are the key considerations when configuring P 558[0] - ENC_CH1_TTL_SignalType for TTL encoders?,A2,"This parameter determines the encoder's signal interpretation method, including direction and counting mode, critical for accurate positioning.",1.71875,1.8046875,3.4375,1.6328125,0.380859375
22,msd_servo_drive.txt,20,02f242a213dfa4411d028ce46dfba16a3f97395fa25788fcbaea1715e779d934,"), consult with your project supervisor or the Helpline provided by Moog before using any special SSI protocol modes.

# 6.5.2 EnDat (cyclical) X7

Ch1: ENDAT(4) - Cyclical EnDat (2.1 or 2.2) EnDat is a digital encoder interface developed by HEIDENHAIN. For more details, please visit www.heidenhain.de and go to ►Documentation ►Fundamentals ►Interfaces ►EnDat 2.2.

The software versions required to run the EnDat encoder interface are the standard software versions for the MSD Servo Drive and MSD Single-Axis Servo Drive Compact.

MOOG ID No.:CB40859-001 Date:11/2020

# 6 Encoder

NOTE

- Please note the limitations that apply when running EnDat and SSI encoders (see Section ""Limiting for EnDat and SSI"" on page 52).

When using linear encoders, P 554[0] - ENC_CH1_DigitalResolution is used instead of P 543[0] - ENC_CH1_MultiT and P 544[0] - ENC_CH1_SingleT (which are used for rotary encoders). The values will be read from the EnDat encoder and written to the aforementioned parameters.

- P 543[0] - ENC_CH1_MultiT
- The number ""n"" of multiturn bits defines the measuring range in 2n increments per encoder shaft revolution; maximum travel until overflow; maximum travel within which the absolute value initialization can be unambiguous. In the case of single-turn encoders, MultiT = 0.
- P 544[0] - ENC_CH1_SingleT
- The number ""n"" of single-turn bits corresponds to the encoder’s digital resolution in 2n increments per encoder shaft revolution.
- P 554[0] - ENC_CH1_DigitalResolution
- This is the length of an increment, in nanometres, of the encoder’s digitally transmitted position value. This value is read from the EnDat linear head.

In the case of linear encoders, the number n of transmitted position bits from the encoder will be found in SingleT only! 2n * DigitalResolution yields the maximum travel in nanometres (for the encoder head).

P 640 - ENC_ENDAT is intended for additional information, but is normally not needed. This parameter does not have a Ch1 or Ch3 prefix for the encoder channel in the name, as it applies to both encoder channels. Although usually not needed, the parameter is helpful or required in the following cases:

1. Special EnDat encoder with diagnostics for evaluation
In this case, the valuation numbers from the encoder are read cyclically via additional information. Only the valuation numbers that the encoder supports.

# 6 Encoder

MOOG ID No.:CB40859-001 Date:11/2020

will be read. During the initialization process, the system will read the encoder to determine which valuation numbers it supports. When P 640[0] - ENDAT_Select = 1, the function will be enabled in the controller and the internal diagnostics in the EnDaT encoder will be enabled as well. The EnDat encoder will keep this setting even after being powered off. To explicitly disable the internal diagnostics in the EnDat encoder, set P 640[0] - ENDAT_Select to 2.

# 2. Evaluation of internal warnings

In this scenario, certain internal warnings from the encoder will be read from the encoder via additional information. Only the warnings that both the encoder and the Servo Drive’s software support will be read. During the initialization process, the system will read the encoder to determine which warnings it supports. When P 640[0] - ENDAT_Select = 3, the function will be enabled in the controller.

**Table 6.7: Channel 1 encoder configuration (X7) - EnDat parameters**
|ID|Index Name|Unit|Description|
|---|---|---|---|
|505|0 ENC_CH1_Sel|= ENDAT(4)| |
|543|0 ENC_CH1_MultiT|Number of MultiTurn bits (absolute encoder)| |
|544|0 ENC_CH1_SingleT|Number of SingleTurn bits (absolute encoder)| |
|547|0 ENC_CH1_MTBase|Definition of point of discontinuity in multi-turn range| |
|548|0 ENC_CH1_MTEnable|1: Use Multi-turn encoder as a single-turn encoder| |
|616|0 ENC_CH1_CycleCount|Position encoder sampling cycle (n x 125 μsec)| |
|598|0 ENC_CH1_Position|inc|Position encoder channel 1|
|554|0 ENC_CH1_|nm|Length of one increment (linear absolute encoder)|
|640|ENC_ENDAT| |EnDat additional (additional information)|
|640|0 ENDAT_Select|0=off|EnDat function selection, 1/2=diagnosis on/off, 3=warnings, FF=lock|
|640|1 ENDAT_DiagCount|u16|count new diagnosis block header|
|640|2 ENDAT_BWZ_1|lowbyte|vn1: incremental track|
|640|3 ENDAT_BWZ_3|lowbyte|vn3: absolute track|
|640|4 ENDAT_BWZ_4|lowbyte|vn4: position value formation|
|640|5 ENDAT_Status| |EnDat additional status output|
|640|6 ENDAT_Z1_Sel| |EnDat additional information 1 type selection|

**Table 6.7: Overwrite Channel 1 encoder configuration (X7) - EnDat parameters (continue)**
|ID|Index Name|Unit|Description|
|---|---|---|---|
|640|7 ENDAT_Z1_1| |Z1 info: dword 1|
|640|8 ENDAT_Z1_2| |Z1 info: dword 2|
|640|9 ENDAT_Z1_3| |Z1 info: dword 3|
|640|10 ENDAT_Z1_4| |Z1 info: dword 4|
|640|11 ENDAT_Z2_Sel| |EnDat additional information 2 type selection|
|640|12 ENDAT_Z2_1| |Z2 info: dword 1|
|640|13 ENDAT_Z2_2| |Z2 info: dword 2|
|640|14 ENDAT_Z2_3| |Z2 info: dword 3|
|640|15 ENDAT_Z2_4| |Z2 info: dword 4|
|640|16 ENDAT_Mode1|0=off|EnDat additional mode 1 selection|
|640|17 ENDAT_Mode2| |EnDat additional mode 2 selection|
|640|18 ENDAT_Mode3| |EnDat additional mode 3 selection|
|640|19 ENDAT_Mode4| |EnDat additional mode 4 selection|
|640|20 ENDAT_res1| |reserved 1|
|640|21 ENDAT_res2| |reserved 2|
|640|22 ENDAT_res3| |reserved 3|
|640|23 ENDAT_HwSyncStop|0=SyncOn|EnDat cyclic hw sync, stop/start 1/0|
|640|24 ENDAT_CyclCount| |call counter of cyclic function|
|640|25 ENDAT_BWZ_Supported| |vn supported (bit3=vn4, bit2=vn3, bit0=vn1)|
|640|26 ENDAT_BWZ1_| |vn1: bits[7..0] threshold level, bits[31..16]|
|640|27 ThresholdLevel| |how often number|
|640|28 ENDAT_BWZ3_| |vn3: bits[7..0] threshold level, bits[31..16]|
|640|29 ThresholdLevel| |how often number|
|640|30 ENDAT_BWZ4_| |vn4: bits[7..0] threshold level, bits[31..16]|
|640|31 ThresholdLevel| |how often number|
|640|32 ENDAT_BWZ_TEST_| |vn: bits[15..12] 'F', bits[11..8] vn.no., bits [7..0] vn overwrite value|

# 6.5.3 Hall sensor X7

Ch1: HALL(5) - Digital hall signals

Ch1: HALL_TTL(7) - Digital hall signals

NOTE

l The operation and configuration of Hall effect sensors is reserved for special applications. Consult with Moog if needed.

# 6.5.4 Sin/Cos / TTL X7

# 6.5.4.1 TTL encoder

Ch1: TTL(3) - TTL signals

TTL encoders are ...

- a. ... ... usually pure incremental encoders without an absolute value interface.
- b. In this case, P 540[0] - ENC_CH1_Abs must be set to OFF(0). ... ... in a few exceptional cases, incremental encoders with an SSI absolute value interface. In this case, P 540[0] - ENC_CH1_Abs must be accordingly set to SSI(1) (SSI_CONT(4) in special cases), so that it will be possible to read the absolute encoder position for the absolute value initialization routine once during the initialization phase.

# 6.5.4.1.1 Pure TTL incremental encoder

Set P 505[0] - ENC_CH1_Sel to TTL(3) and P 540[0] - ENC_CH1_Abs to OFF(0) when using pure TTL encoders, i.e. encoders without an absolute value interface but with a TTL zero pulse.

Linear TTL encoders are run as rotary encoders. For linear motor operation, P 542 [0] - ENC_CH1_Lines and the encoder gearing (see the “Encoder gearing” section) are used to establish the ratio for the linear motor’s pole pair subdivision (North-North) for commutation. 1 x North-North corresponds to one revolution from Lines. In this case, the motor pole pair number must be set to 1. Moreover, P 553[0] - ENC_CH1_PeriodLen is not used in this case.

The TTL interface accepts various TTL signal types, which can be selected using P 558[0] - ENC_CH1_TTL_SignalType:

- (0)AF_B - A/B tracks (forward counting, X4 encoding) - AB
- (1)AR_B - A/B tracks (reverse counting, X4 encoding) - AB_inv
- (2)ABDFN - A: Clock (falling edge), B: Direction (1 = positive) - PulseDir
- (3)ABDRP - A: Clock (rising edge), B: Direction (1 = negative) - PulseDir_inv
- (4)reserved

A maximum interpolation period, in ms (milliseconds), can be configured for the TTL interface using P 601[0] - ENC_CH1_Period. Within this context, Period is the maximum time of “no activity” since the last TTL counter event:

- Period = 0: Function disabled (default)
- Period > 0 (=n ms): If no counter event is registered in n ms, the speed will be set to 0.

# Zero pulse

There is no parameter for activating the zero pulse evaluation here, as this evaluation is controlled exclusively based on the homing mode (see Section ""Homing"" on page 249). However, setting P 541[0] - ENC_CH1_NpTest to 1 provides a test mode that can be used during commissioning in order to be able to activate the zero pulse evaluation even without homing. Scope signals 1014 and 1016 can be used to view a received zero pulse within this context. This test mode must be disabled during normal operation (P 541[0] = 0).

# Commutation

Motor operation with pure incremental encoders needs for the auto commutation function to be enabled without fail. For details see Section ""Synchronous motor auto commutation"" on page 156.

# 6.5.4.1.2 TTL incremental encoder with SSI absolute value interface

See Section ""Sin/Cos incremental encoders with absolute value interface"" on page 65 and in special Section ""SSI absolute value interface"" on page 67.

MSD ServoDrive - DeviceHelp

# 6 Encoder

MOOG ID No.:CB40859-001 Date:11/2020 MSD ServoDrive - DeviceHelp 64

|ID|Index Name|Unit|Description|
|---|---|---|---|
|505|0|ENC_CH1_Sel = 3|Encoder selection set to TTL(3)|
|510|0|ENC_CH1_Num|Encoder gearing: Numerator Ch1: SINCOS(1) - Sin/Cos signals|
|511|0|ENC_CH1_Denom|Encoder gearing: Denominator|
|540|0|ENC_CH1_Abs|Selection of absolute value interface Sin/Cos encoders can ...|
|541|0|ENC_CH1_NpTest|ENC CH1, TEST-MODE: Index pulse signal(s) to Scope|
|542|0|ENC_CH1_lines|Number of lines (Sin/Cos / TTL encoders) a. Be pure incremental encoders without an absolute value interface. In this|
|558|0|ENC_CH1_TTL_SignalType|Channel 1: TTL signal selection case, P 540[0] - ENC_CH1_Abs must be set to OFF(0).|
|601|0|ENC_CH1_Period|Maximum period of interpolation (TTL encoder)|
|616|0|ENC_CH1_CycleCount|Sampling cycle in: n x 125 μ (microseconds) b. Be incremental encoders with an absolute value interface. In this case,|

Table 6.8: Parameters for Channel 1 (X7) - TTL encoder

ENC_CH1_Abs must be accordingly set to SSI(1), EnDat(2), HIPER(3) or, in special cases, SSI_CONT(4) so that it will be possible to read the absolute encoder position for the absolute value initialization routine once during the initialization phase.

# 6.5.4.2.1 Purely Sin/Cos incremental encoders

To run these encoders as purely incremental encoders with a zero pulse on encoder channel Ch1 (without an absolute value interface), the approach is basically the same as for purely TTL operation (see Section ""TTL encoder"" on page 63). The same parameters apply.

However, there are the following differences:

- a. There are no different signal types for the Sin/Cos signal (always 1 Vss for cosine and sine).
- b. The zero pulse is the analog zero pulse typical of Sin/Cos encoders (see the “Connection for high-resolution encoders” section in the operation manual MSD Servo Drive Single-Axis System, for example).

# 6.5.4.2.2 Linear Sin/Cos

|ID|Index Name|Unit|Description|
|---|---|---|---|
|542|ENC_CH1_lines| |Number of Lines (Sin/Cos / TTL encoders)|
|543|ENC_CH1_MultiT| |Number of MultiTurn bits (absolute encoder)|
|544|ENC_CH1_SingleT| |Number of SingleTurn bits (absolute encoder)|
|545|ENC_CH1_Code| |Code selection (SSI encoder) (binary, gray)|
|546|ENC_CH1_Mode| |Mode selection (SSI encoder)|
|547|ENC_CH1_MTBase| |Definition of point of discontinuity in multi-turn range|
|548|ENC_CH1_MTEnable| |Enable MultiTurn use (negative logic, 1=MToff)|
|549|ENC_CH1_Corr| |Signal correction type|
|550|ENC_CH1_CorrVal|0-4|Signal correction values|
|551|ENC_CH1_EncObsMin| |Encoder monitoring minimum, sqrt(a^2+b^2)|
|552|ENC_CH1_AbsEncStatus| |Error and status codes (absolute encoder)|

# 6.5.4.2.3 Signal correction (GPOC)

|ID|Index Name|Unit|Description|
|---|---|---|---|
|553|ENC_CH1_PeriodLen|nm|Length of signal period (Sin/Cos linear encoder)|
|554|ENC_CH1_DigitalResolution|nm|Length of one increment (linear absolute encoder)|
|555|ENC_CH1_Info| |Encoder information|
|616|ENC_CH1_CycleCount| |Sampling cycle in: n x 125 μ (microseconds)|
|610|ENC_CH1_NominalIncrementA| |Sign. Nominal increment A (distance coded abs. per. encoder)|
|611|ENC_CH1_NominalIncrementB| |Sign. Nominal increment B (distance coded abs. per. encoder)|
|1900|ENC_ETS| |ETS mode, electronic nameplate|

# 6.5.4.2.4 Sin/Cos incremental encoders with absolute value interface

The following table lists the parameters for cyclical Sin/Cos operation on encoder channel Ch 1 with one-time reading of the absolute encoder position via the absolute value interface, i.e. without a zero pulse:

|ID|Index Name|Unit|Description|
|---|---|---|---|
|505|ENC_CH1_Sel|1|Encoder selection set to SINCOS(1)|
|510|ENC_CH1_Num| |Encoder gearing: Numerator|
|511|ENC_CH1_Denom| |Encoder gearing: Denominator|
|540|ENC_CH1_Abs| |Absolute value interface selection (one-time reading)|

Table 6.9: Parameters for channel 1 (X7) - Sin/Cos encoder

The Sel, Num, Denom, Abs, Lines, MultiT, SingleT and CorrVal parameters are self-explanatory.

The Code and Mode parameters are described in Section ""SSI (cyclical) X7"" on page 69.

P 547[0] - ENC_CH1_MTBase = Minimum MultiTurn position

The MTBase parameter is used to set a position in the multi-turn encoder’s travel path that defines the point of discontinuity (overflow/underflow) for the absolute value initialization (that is, the “multi-turn basis”). Assuming a bipolar encoder measuring range, all position values that fall below MTBase will be shifted “up” (the whole MT range will be added to them once).

MOOG ID No.:CB40859-001 Date:11/2020

MSD ServoDrive - DeviceHelp

# 6 Encoder

MOOG ID No.:CB40859-001 Date:11/2020

method makes it possible to place the point of discontinuity at any point within the encoder’s entire measuring range. By default, MTBase will be set to the lowest possible value for the parameter, i.e. reliably outside of the encoder’s value range: In this case, the full bipolar range will remain unaffected, as values will never fall below this MTBase threshold (see Section ""Channel 1: Interface X7"" on page 59).

- P 548[0] - ENC_CH1_MTEnable = MultiTurn as SingleTurn
- The MTEnable parameter makes it possible to use multi-turn encoders as single-turn encoders for test purposes. Negative logic: Default MTEnable = 0 means ""MultiTurn-Enable ON"".

P 549[0] - ENC_CH1_Corr = Signal correction type
- The GPOC routine used for track signal correction purposes for sine/cosine signals is used to compensate for systematic errors. The routine is controlled with the Corr and CorrVal parameters (see Section ""Signal correction GPOC (Gain Phase Offset Correction)"" on page 74).

P 551[0] - ENC_CH1_EncObsMin = Encoder monitoring minimum, sqrt (a^2+b^2)
- The parameter EncObsMin is used to scale the Sin/Cos wire break monitoring and represents the “downwards threshold” for an error message. The default setting is 0.2, corresponding to approx. ",What are the key considerations when configuring P 558[0] - ENC_CH1_TTL_SignalType for TTL encoders?,A3,"It configures how the TTL interface processes encoder signals, with choices affecting counting direction and edge sensitivity.",1.703125,1.828125,3.328125,1.640625,0.3671875
23,msd_servo_drive.txt,20,02f242a213dfa4411d028ce46dfba16a3f97395fa25788fcbaea1715e779d934,"), consult with your project supervisor or the Helpline provided by Moog before using any special SSI protocol modes.

# 6.5.2 EnDat (cyclical) X7

Ch1: ENDAT(4) - Cyclical EnDat (2.1 or 2.2) EnDat is a digital encoder interface developed by HEIDENHAIN. For more details, please visit www.heidenhain.de and go to ►Documentation ►Fundamentals ►Interfaces ►EnDat 2.2.

The software versions required to run the EnDat encoder interface are the standard software versions for the MSD Servo Drive and MSD Single-Axis Servo Drive Compact.

MOOG ID No.:CB40859-001 Date:11/2020

# 6 Encoder

NOTE

- Please note the limitations that apply when running EnDat and SSI encoders (see Section ""Limiting for EnDat and SSI"" on page 52).

When using linear encoders, P 554[0] - ENC_CH1_DigitalResolution is used instead of P 543[0] - ENC_CH1_MultiT and P 544[0] - ENC_CH1_SingleT (which are used for rotary encoders). The values will be read from the EnDat encoder and written to the aforementioned parameters.

- P 543[0] - ENC_CH1_MultiT
- The number ""n"" of multiturn bits defines the measuring range in 2n increments per encoder shaft revolution; maximum travel until overflow; maximum travel within which the absolute value initialization can be unambiguous. In the case of single-turn encoders, MultiT = 0.
- P 544[0] - ENC_CH1_SingleT
- The number ""n"" of single-turn bits corresponds to the encoder’s digital resolution in 2n increments per encoder shaft revolution.
- P 554[0] - ENC_CH1_DigitalResolution
- This is the length of an increment, in nanometres, of the encoder’s digitally transmitted position value. This value is read from the EnDat linear head.

In the case of linear encoders, the number n of transmitted position bits from the encoder will be found in SingleT only! 2n * DigitalResolution yields the maximum travel in nanometres (for the encoder head).

P 640 - ENC_ENDAT is intended for additional information, but is normally not needed. This parameter does not have a Ch1 or Ch3 prefix for the encoder channel in the name, as it applies to both encoder channels. Although usually not needed, the parameter is helpful or required in the following cases:

1. Special EnDat encoder with diagnostics for evaluation
In this case, the valuation numbers from the encoder are read cyclically via additional information. Only the valuation numbers that the encoder supports.

# 6 Encoder

MOOG ID No.:CB40859-001 Date:11/2020

will be read. During the initialization process, the system will read the encoder to determine which valuation numbers it supports. When P 640[0] - ENDAT_Select = 1, the function will be enabled in the controller and the internal diagnostics in the EnDaT encoder will be enabled as well. The EnDat encoder will keep this setting even after being powered off. To explicitly disable the internal diagnostics in the EnDat encoder, set P 640[0] - ENDAT_Select to 2.

# 2. Evaluation of internal warnings

In this scenario, certain internal warnings from the encoder will be read from the encoder via additional information. Only the warnings that both the encoder and the Servo Drive’s software support will be read. During the initialization process, the system will read the encoder to determine which warnings it supports. When P 640[0] - ENDAT_Select = 3, the function will be enabled in the controller.

**Table 6.7: Channel 1 encoder configuration (X7) - EnDat parameters**
|ID|Index Name|Unit|Description|
|---|---|---|---|
|505|0 ENC_CH1_Sel|= ENDAT(4)| |
|543|0 ENC_CH1_MultiT|Number of MultiTurn bits (absolute encoder)| |
|544|0 ENC_CH1_SingleT|Number of SingleTurn bits (absolute encoder)| |
|547|0 ENC_CH1_MTBase|Definition of point of discontinuity in multi-turn range| |
|548|0 ENC_CH1_MTEnable|1: Use Multi-turn encoder as a single-turn encoder| |
|616|0 ENC_CH1_CycleCount|Position encoder sampling cycle (n x 125 μsec)| |
|598|0 ENC_CH1_Position|inc|Position encoder channel 1|
|554|0 ENC_CH1_|nm|Length of one increment (linear absolute encoder)|
|640|ENC_ENDAT| |EnDat additional (additional information)|
|640|0 ENDAT_Select|0=off|EnDat function selection, 1/2=diagnosis on/off, 3=warnings, FF=lock|
|640|1 ENDAT_DiagCount|u16|count new diagnosis block header|
|640|2 ENDAT_BWZ_1|lowbyte|vn1: incremental track|
|640|3 ENDAT_BWZ_3|lowbyte|vn3: absolute track|
|640|4 ENDAT_BWZ_4|lowbyte|vn4: position value formation|
|640|5 ENDAT_Status| |EnDat additional status output|
|640|6 ENDAT_Z1_Sel| |EnDat additional information 1 type selection|

**Table 6.7: Overwrite Channel 1 encoder configuration (X7) - EnDat parameters (continue)**
|ID|Index Name|Unit|Description|
|---|---|---|---|
|640|7 ENDAT_Z1_1| |Z1 info: dword 1|
|640|8 ENDAT_Z1_2| |Z1 info: dword 2|
|640|9 ENDAT_Z1_3| |Z1 info: dword 3|
|640|10 ENDAT_Z1_4| |Z1 info: dword 4|
|640|11 ENDAT_Z2_Sel| |EnDat additional information 2 type selection|
|640|12 ENDAT_Z2_1| |Z2 info: dword 1|
|640|13 ENDAT_Z2_2| |Z2 info: dword 2|
|640|14 ENDAT_Z2_3| |Z2 info: dword 3|
|640|15 ENDAT_Z2_4| |Z2 info: dword 4|
|640|16 ENDAT_Mode1|0=off|EnDat additional mode 1 selection|
|640|17 ENDAT_Mode2| |EnDat additional mode 2 selection|
|640|18 ENDAT_Mode3| |EnDat additional mode 3 selection|
|640|19 ENDAT_Mode4| |EnDat additional mode 4 selection|
|640|20 ENDAT_res1| |reserved 1|
|640|21 ENDAT_res2| |reserved 2|
|640|22 ENDAT_res3| |reserved 3|
|640|23 ENDAT_HwSyncStop|0=SyncOn|EnDat cyclic hw sync, stop/start 1/0|
|640|24 ENDAT_CyclCount| |call counter of cyclic function|
|640|25 ENDAT_BWZ_Supported| |vn supported (bit3=vn4, bit2=vn3, bit0=vn1)|
|640|26 ENDAT_BWZ1_| |vn1: bits[7..0] threshold level, bits[31..16]|
|640|27 ThresholdLevel| |how often number|
|640|28 ENDAT_BWZ3_| |vn3: bits[7..0] threshold level, bits[31..16]|
|640|29 ThresholdLevel| |how often number|
|640|30 ENDAT_BWZ4_| |vn4: bits[7..0] threshold level, bits[31..16]|
|640|31 ThresholdLevel| |how often number|
|640|32 ENDAT_BWZ_TEST_| |vn: bits[15..12] 'F', bits[11..8] vn.no., bits [7..0] vn overwrite value|

# 6.5.3 Hall sensor X7

Ch1: HALL(5) - Digital hall signals

Ch1: HALL_TTL(7) - Digital hall signals

NOTE

l The operation and configuration of Hall effect sensors is reserved for special applications. Consult with Moog if needed.

# 6.5.4 Sin/Cos / TTL X7

# 6.5.4.1 TTL encoder

Ch1: TTL(3) - TTL signals

TTL encoders are ...

- a. ... ... usually pure incremental encoders without an absolute value interface.
- b. In this case, P 540[0] - ENC_CH1_Abs must be set to OFF(0). ... ... in a few exceptional cases, incremental encoders with an SSI absolute value interface. In this case, P 540[0] - ENC_CH1_Abs must be accordingly set to SSI(1) (SSI_CONT(4) in special cases), so that it will be possible to read the absolute encoder position for the absolute value initialization routine once during the initialization phase.

# 6.5.4.1.1 Pure TTL incremental encoder

Set P 505[0] - ENC_CH1_Sel to TTL(3) and P 540[0] - ENC_CH1_Abs to OFF(0) when using pure TTL encoders, i.e. encoders without an absolute value interface but with a TTL zero pulse.

Linear TTL encoders are run as rotary encoders. For linear motor operation, P 542 [0] - ENC_CH1_Lines and the encoder gearing (see the “Encoder gearing” section) are used to establish the ratio for the linear motor’s pole pair subdivision (North-North) for commutation. 1 x North-North corresponds to one revolution from Lines. In this case, the motor pole pair number must be set to 1. Moreover, P 553[0] - ENC_CH1_PeriodLen is not used in this case.

The TTL interface accepts various TTL signal types, which can be selected using P 558[0] - ENC_CH1_TTL_SignalType:

- (0)AF_B - A/B tracks (forward counting, X4 encoding) - AB
- (1)AR_B - A/B tracks (reverse counting, X4 encoding) - AB_inv
- (2)ABDFN - A: Clock (falling edge), B: Direction (1 = positive) - PulseDir
- (3)ABDRP - A: Clock (rising edge), B: Direction (1 = negative) - PulseDir_inv
- (4)reserved

A maximum interpolation period, in ms (milliseconds), can be configured for the TTL interface using P 601[0] - ENC_CH1_Period. Within this context, Period is the maximum time of “no activity” since the last TTL counter event:

- Period = 0: Function disabled (default)
- Period > 0 (=n ms): If no counter event is registered in n ms, the speed will be set to 0.

# Zero pulse

There is no parameter for activating the zero pulse evaluation here, as this evaluation is controlled exclusively based on the homing mode (see Section ""Homing"" on page 249). However, setting P 541[0] - ENC_CH1_NpTest to 1 provides a test mode that can be used during commissioning in order to be able to activate the zero pulse evaluation even without homing. Scope signals 1014 and 1016 can be used to view a received zero pulse within this context. This test mode must be disabled during normal operation (P 541[0] = 0).

# Commutation

Motor operation with pure incremental encoders needs for the auto commutation function to be enabled without fail. For details see Section ""Synchronous motor auto commutation"" on page 156.

# 6.5.4.1.2 TTL incremental encoder with SSI absolute value interface

See Section ""Sin/Cos incremental encoders with absolute value interface"" on page 65 and in special Section ""SSI absolute value interface"" on page 67.

MSD ServoDrive - DeviceHelp

# 6 Encoder

MOOG ID No.:CB40859-001 Date:11/2020 MSD ServoDrive - DeviceHelp 64

|ID|Index Name|Unit|Description|
|---|---|---|---|
|505|0|ENC_CH1_Sel = 3|Encoder selection set to TTL(3)|
|510|0|ENC_CH1_Num|Encoder gearing: Numerator Ch1: SINCOS(1) - Sin/Cos signals|
|511|0|ENC_CH1_Denom|Encoder gearing: Denominator|
|540|0|ENC_CH1_Abs|Selection of absolute value interface Sin/Cos encoders can ...|
|541|0|ENC_CH1_NpTest|ENC CH1, TEST-MODE: Index pulse signal(s) to Scope|
|542|0|ENC_CH1_lines|Number of lines (Sin/Cos / TTL encoders) a. Be pure incremental encoders without an absolute value interface. In this|
|558|0|ENC_CH1_TTL_SignalType|Channel 1: TTL signal selection case, P 540[0] - ENC_CH1_Abs must be set to OFF(0).|
|601|0|ENC_CH1_Period|Maximum period of interpolation (TTL encoder)|
|616|0|ENC_CH1_CycleCount|Sampling cycle in: n x 125 μ (microseconds) b. Be incremental encoders with an absolute value interface. In this case,|

Table 6.8: Parameters for Channel 1 (X7) - TTL encoder

ENC_CH1_Abs must be accordingly set to SSI(1), EnDat(2), HIPER(3) or, in special cases, SSI_CONT(4) so that it will be possible to read the absolute encoder position for the absolute value initialization routine once during the initialization phase.

# 6.5.4.2.1 Purely Sin/Cos incremental encoders

To run these encoders as purely incremental encoders with a zero pulse on encoder channel Ch1 (without an absolute value interface), the approach is basically the same as for purely TTL operation (see Section ""TTL encoder"" on page 63). The same parameters apply.

However, there are the following differences:

- a. There are no different signal types for the Sin/Cos signal (always 1 Vss for cosine and sine).
- b. The zero pulse is the analog zero pulse typical of Sin/Cos encoders (see the “Connection for high-resolution encoders” section in the operation manual MSD Servo Drive Single-Axis System, for example).

# 6.5.4.2.2 Linear Sin/Cos

|ID|Index Name|Unit|Description|
|---|---|---|---|
|542|ENC_CH1_lines| |Number of Lines (Sin/Cos / TTL encoders)|
|543|ENC_CH1_MultiT| |Number of MultiTurn bits (absolute encoder)|
|544|ENC_CH1_SingleT| |Number of SingleTurn bits (absolute encoder)|
|545|ENC_CH1_Code| |Code selection (SSI encoder) (binary, gray)|
|546|ENC_CH1_Mode| |Mode selection (SSI encoder)|
|547|ENC_CH1_MTBase| |Definition of point of discontinuity in multi-turn range|
|548|ENC_CH1_MTEnable| |Enable MultiTurn use (negative logic, 1=MToff)|
|549|ENC_CH1_Corr| |Signal correction type|
|550|ENC_CH1_CorrVal|0-4|Signal correction values|
|551|ENC_CH1_EncObsMin| |Encoder monitoring minimum, sqrt(a^2+b^2)|
|552|ENC_CH1_AbsEncStatus| |Error and status codes (absolute encoder)|

# 6.5.4.2.3 Signal correction (GPOC)

|ID|Index Name|Unit|Description|
|---|---|---|---|
|553|ENC_CH1_PeriodLen|nm|Length of signal period (Sin/Cos linear encoder)|
|554|ENC_CH1_DigitalResolution|nm|Length of one increment (linear absolute encoder)|
|555|ENC_CH1_Info| |Encoder information|
|616|ENC_CH1_CycleCount| |Sampling cycle in: n x 125 μ (microseconds)|
|610|ENC_CH1_NominalIncrementA| |Sign. Nominal increment A (distance coded abs. per. encoder)|
|611|ENC_CH1_NominalIncrementB| |Sign. Nominal increment B (distance coded abs. per. encoder)|
|1900|ENC_ETS| |ETS mode, electronic nameplate|

# 6.5.4.2.4 Sin/Cos incremental encoders with absolute value interface

The following table lists the parameters for cyclical Sin/Cos operation on encoder channel Ch 1 with one-time reading of the absolute encoder position via the absolute value interface, i.e. without a zero pulse:

|ID|Index Name|Unit|Description|
|---|---|---|---|
|505|ENC_CH1_Sel|1|Encoder selection set to SINCOS(1)|
|510|ENC_CH1_Num| |Encoder gearing: Numerator|
|511|ENC_CH1_Denom| |Encoder gearing: Denominator|
|540|ENC_CH1_Abs| |Absolute value interface selection (one-time reading)|

Table 6.9: Parameters for channel 1 (X7) - Sin/Cos encoder

The Sel, Num, Denom, Abs, Lines, MultiT, SingleT and CorrVal parameters are self-explanatory.

The Code and Mode parameters are described in Section ""SSI (cyclical) X7"" on page 69.

P 547[0] - ENC_CH1_MTBase = Minimum MultiTurn position

The MTBase parameter is used to set a position in the multi-turn encoder’s travel path that defines the point of discontinuity (overflow/underflow) for the absolute value initialization (that is, the “multi-turn basis”). Assuming a bipolar encoder measuring range, all position values that fall below MTBase will be shifted “up” (the whole MT range will be added to them once).

MOOG ID No.:CB40859-001 Date:11/2020

MSD ServoDrive - DeviceHelp

# 6 Encoder

MOOG ID No.:CB40859-001 Date:11/2020

method makes it possible to place the point of discontinuity at any point within the encoder’s entire measuring range. By default, MTBase will be set to the lowest possible value for the parameter, i.e. reliably outside of the encoder’s value range: In this case, the full bipolar range will remain unaffected, as values will never fall below this MTBase threshold (see Section ""Channel 1: Interface X7"" on page 59).

- P 548[0] - ENC_CH1_MTEnable = MultiTurn as SingleTurn
- The MTEnable parameter makes it possible to use multi-turn encoders as single-turn encoders for test purposes. Negative logic: Default MTEnable = 0 means ""MultiTurn-Enable ON"".

P 549[0] - ENC_CH1_Corr = Signal correction type
- The GPOC routine used for track signal correction purposes for sine/cosine signals is used to compensate for systematic errors. The routine is controlled with the Corr and CorrVal parameters (see Section ""Signal correction GPOC (Gain Phase Offset Correction)"" on page 74).

P 551[0] - ENC_CH1_EncObsMin = Encoder monitoring minimum, sqrt (a^2+b^2)
- The parameter EncObsMin is used to scale the Sin/Cos wire break monitoring and represents the “downwards threshold” for an error message. The default setting is 0.2, corresponding to approx. ",What are the key considerations when configuring P 558[0] - ENC_CH1_TTL_SignalType for TTL encoders?,A4,"Users must select the appropriate signal type (e.g., AB, PulseDir) to match the encoder's output characteristics for reliable operation.",2.265625,2.21875,3.5,1.671875,0.53515625
24,msd_servo_drive.txt,20,02f242a213dfa4411d028ce46dfba16a3f97395fa25788fcbaea1715e779d934,"), consult with your project supervisor or the Helpline provided by Moog before using any special SSI protocol modes.

# 6.5.2 EnDat (cyclical) X7

Ch1: ENDAT(4) - Cyclical EnDat (2.1 or 2.2) EnDat is a digital encoder interface developed by HEIDENHAIN. For more details, please visit www.heidenhain.de and go to ►Documentation ►Fundamentals ►Interfaces ►EnDat 2.2.

The software versions required to run the EnDat encoder interface are the standard software versions for the MSD Servo Drive and MSD Single-Axis Servo Drive Compact.

MOOG ID No.:CB40859-001 Date:11/2020

# 6 Encoder

NOTE

- Please note the limitations that apply when running EnDat and SSI encoders (see Section ""Limiting for EnDat and SSI"" on page 52).

When using linear encoders, P 554[0] - ENC_CH1_DigitalResolution is used instead of P 543[0] - ENC_CH1_MultiT and P 544[0] - ENC_CH1_SingleT (which are used for rotary encoders). The values will be read from the EnDat encoder and written to the aforementioned parameters.

- P 543[0] - ENC_CH1_MultiT
- The number ""n"" of multiturn bits defines the measuring range in 2n increments per encoder shaft revolution; maximum travel until overflow; maximum travel within which the absolute value initialization can be unambiguous. In the case of single-turn encoders, MultiT = 0.
- P 544[0] - ENC_CH1_SingleT
- The number ""n"" of single-turn bits corresponds to the encoder’s digital resolution in 2n increments per encoder shaft revolution.
- P 554[0] - ENC_CH1_DigitalResolution
- This is the length of an increment, in nanometres, of the encoder’s digitally transmitted position value. This value is read from the EnDat linear head.

In the case of linear encoders, the number n of transmitted position bits from the encoder will be found in SingleT only! 2n * DigitalResolution yields the maximum travel in nanometres (for the encoder head).

P 640 - ENC_ENDAT is intended for additional information, but is normally not needed. This parameter does not have a Ch1 or Ch3 prefix for the encoder channel in the name, as it applies to both encoder channels. Although usually not needed, the parameter is helpful or required in the following cases:

1. Special EnDat encoder with diagnostics for evaluation
In this case, the valuation numbers from the encoder are read cyclically via additional information. Only the valuation numbers that the encoder supports.

# 6 Encoder

MOOG ID No.:CB40859-001 Date:11/2020

will be read. During the initialization process, the system will read the encoder to determine which valuation numbers it supports. When P 640[0] - ENDAT_Select = 1, the function will be enabled in the controller and the internal diagnostics in the EnDaT encoder will be enabled as well. The EnDat encoder will keep this setting even after being powered off. To explicitly disable the internal diagnostics in the EnDat encoder, set P 640[0] - ENDAT_Select to 2.

# 2. Evaluation of internal warnings

In this scenario, certain internal warnings from the encoder will be read from the encoder via additional information. Only the warnings that both the encoder and the Servo Drive’s software support will be read. During the initialization process, the system will read the encoder to determine which warnings it supports. When P 640[0] - ENDAT_Select = 3, the function will be enabled in the controller.

**Table 6.7: Channel 1 encoder configuration (X7) - EnDat parameters**
|ID|Index Name|Unit|Description|
|---|---|---|---|
|505|0 ENC_CH1_Sel|= ENDAT(4)| |
|543|0 ENC_CH1_MultiT|Number of MultiTurn bits (absolute encoder)| |
|544|0 ENC_CH1_SingleT|Number of SingleTurn bits (absolute encoder)| |
|547|0 ENC_CH1_MTBase|Definition of point of discontinuity in multi-turn range| |
|548|0 ENC_CH1_MTEnable|1: Use Multi-turn encoder as a single-turn encoder| |
|616|0 ENC_CH1_CycleCount|Position encoder sampling cycle (n x 125 μsec)| |
|598|0 ENC_CH1_Position|inc|Position encoder channel 1|
|554|0 ENC_CH1_|nm|Length of one increment (linear absolute encoder)|
|640|ENC_ENDAT| |EnDat additional (additional information)|
|640|0 ENDAT_Select|0=off|EnDat function selection, 1/2=diagnosis on/off, 3=warnings, FF=lock|
|640|1 ENDAT_DiagCount|u16|count new diagnosis block header|
|640|2 ENDAT_BWZ_1|lowbyte|vn1: incremental track|
|640|3 ENDAT_BWZ_3|lowbyte|vn3: absolute track|
|640|4 ENDAT_BWZ_4|lowbyte|vn4: position value formation|
|640|5 ENDAT_Status| |EnDat additional status output|
|640|6 ENDAT_Z1_Sel| |EnDat additional information 1 type selection|

**Table 6.7: Overwrite Channel 1 encoder configuration (X7) - EnDat parameters (continue)**
|ID|Index Name|Unit|Description|
|---|---|---|---|
|640|7 ENDAT_Z1_1| |Z1 info: dword 1|
|640|8 ENDAT_Z1_2| |Z1 info: dword 2|
|640|9 ENDAT_Z1_3| |Z1 info: dword 3|
|640|10 ENDAT_Z1_4| |Z1 info: dword 4|
|640|11 ENDAT_Z2_Sel| |EnDat additional information 2 type selection|
|640|12 ENDAT_Z2_1| |Z2 info: dword 1|
|640|13 ENDAT_Z2_2| |Z2 info: dword 2|
|640|14 ENDAT_Z2_3| |Z2 info: dword 3|
|640|15 ENDAT_Z2_4| |Z2 info: dword 4|
|640|16 ENDAT_Mode1|0=off|EnDat additional mode 1 selection|
|640|17 ENDAT_Mode2| |EnDat additional mode 2 selection|
|640|18 ENDAT_Mode3| |EnDat additional mode 3 selection|
|640|19 ENDAT_Mode4| |EnDat additional mode 4 selection|
|640|20 ENDAT_res1| |reserved 1|
|640|21 ENDAT_res2| |reserved 2|
|640|22 ENDAT_res3| |reserved 3|
|640|23 ENDAT_HwSyncStop|0=SyncOn|EnDat cyclic hw sync, stop/start 1/0|
|640|24 ENDAT_CyclCount| |call counter of cyclic function|
|640|25 ENDAT_BWZ_Supported| |vn supported (bit3=vn4, bit2=vn3, bit0=vn1)|
|640|26 ENDAT_BWZ1_| |vn1: bits[7..0] threshold level, bits[31..16]|
|640|27 ThresholdLevel| |how often number|
|640|28 ENDAT_BWZ3_| |vn3: bits[7..0] threshold level, bits[31..16]|
|640|29 ThresholdLevel| |how often number|
|640|30 ENDAT_BWZ4_| |vn4: bits[7..0] threshold level, bits[31..16]|
|640|31 ThresholdLevel| |how often number|
|640|32 ENDAT_BWZ_TEST_| |vn: bits[15..12] 'F', bits[11..8] vn.no., bits [7..0] vn overwrite value|

# 6.5.3 Hall sensor X7

Ch1: HALL(5) - Digital hall signals

Ch1: HALL_TTL(7) - Digital hall signals

NOTE

l The operation and configuration of Hall effect sensors is reserved for special applications. Consult with Moog if needed.

# 6.5.4 Sin/Cos / TTL X7

# 6.5.4.1 TTL encoder

Ch1: TTL(3) - TTL signals

TTL encoders are ...

- a. ... ... usually pure incremental encoders without an absolute value interface.
- b. In this case, P 540[0] - ENC_CH1_Abs must be set to OFF(0). ... ... in a few exceptional cases, incremental encoders with an SSI absolute value interface. In this case, P 540[0] - ENC_CH1_Abs must be accordingly set to SSI(1) (SSI_CONT(4) in special cases), so that it will be possible to read the absolute encoder position for the absolute value initialization routine once during the initialization phase.

# 6.5.4.1.1 Pure TTL incremental encoder

Set P 505[0] - ENC_CH1_Sel to TTL(3) and P 540[0] - ENC_CH1_Abs to OFF(0) when using pure TTL encoders, i.e. encoders without an absolute value interface but with a TTL zero pulse.

Linear TTL encoders are run as rotary encoders. For linear motor operation, P 542 [0] - ENC_CH1_Lines and the encoder gearing (see the “Encoder gearing” section) are used to establish the ratio for the linear motor’s pole pair subdivision (North-North) for commutation. 1 x North-North corresponds to one revolution from Lines. In this case, the motor pole pair number must be set to 1. Moreover, P 553[0] - ENC_CH1_PeriodLen is not used in this case.

The TTL interface accepts various TTL signal types, which can be selected using P 558[0] - ENC_CH1_TTL_SignalType:

- (0)AF_B - A/B tracks (forward counting, X4 encoding) - AB
- (1)AR_B - A/B tracks (reverse counting, X4 encoding) - AB_inv
- (2)ABDFN - A: Clock (falling edge), B: Direction (1 = positive) - PulseDir
- (3)ABDRP - A: Clock (rising edge), B: Direction (1 = negative) - PulseDir_inv
- (4)reserved

A maximum interpolation period, in ms (milliseconds), can be configured for the TTL interface using P 601[0] - ENC_CH1_Period. Within this context, Period is the maximum time of “no activity” since the last TTL counter event:

- Period = 0: Function disabled (default)
- Period > 0 (=n ms): If no counter event is registered in n ms, the speed will be set to 0.

# Zero pulse

There is no parameter for activating the zero pulse evaluation here, as this evaluation is controlled exclusively based on the homing mode (see Section ""Homing"" on page 249). However, setting P 541[0] - ENC_CH1_NpTest to 1 provides a test mode that can be used during commissioning in order to be able to activate the zero pulse evaluation even without homing. Scope signals 1014 and 1016 can be used to view a received zero pulse within this context. This test mode must be disabled during normal operation (P 541[0] = 0).

# Commutation

Motor operation with pure incremental encoders needs for the auto commutation function to be enabled without fail. For details see Section ""Synchronous motor auto commutation"" on page 156.

# 6.5.4.1.2 TTL incremental encoder with SSI absolute value interface

See Section ""Sin/Cos incremental encoders with absolute value interface"" on page 65 and in special Section ""SSI absolute value interface"" on page 67.

MSD ServoDrive - DeviceHelp

# 6 Encoder

MOOG ID No.:CB40859-001 Date:11/2020 MSD ServoDrive - DeviceHelp 64

|ID|Index Name|Unit|Description|
|---|---|---|---|
|505|0|ENC_CH1_Sel = 3|Encoder selection set to TTL(3)|
|510|0|ENC_CH1_Num|Encoder gearing: Numerator Ch1: SINCOS(1) - Sin/Cos signals|
|511|0|ENC_CH1_Denom|Encoder gearing: Denominator|
|540|0|ENC_CH1_Abs|Selection of absolute value interface Sin/Cos encoders can ...|
|541|0|ENC_CH1_NpTest|ENC CH1, TEST-MODE: Index pulse signal(s) to Scope|
|542|0|ENC_CH1_lines|Number of lines (Sin/Cos / TTL encoders) a. Be pure incremental encoders without an absolute value interface. In this|
|558|0|ENC_CH1_TTL_SignalType|Channel 1: TTL signal selection case, P 540[0] - ENC_CH1_Abs must be set to OFF(0).|
|601|0|ENC_CH1_Period|Maximum period of interpolation (TTL encoder)|
|616|0|ENC_CH1_CycleCount|Sampling cycle in: n x 125 μ (microseconds) b. Be incremental encoders with an absolute value interface. In this case,|

Table 6.8: Parameters for Channel 1 (X7) - TTL encoder

ENC_CH1_Abs must be accordingly set to SSI(1), EnDat(2), HIPER(3) or, in special cases, SSI_CONT(4) so that it will be possible to read the absolute encoder position for the absolute value initialization routine once during the initialization phase.

# 6.5.4.2.1 Purely Sin/Cos incremental encoders

To run these encoders as purely incremental encoders with a zero pulse on encoder channel Ch1 (without an absolute value interface), the approach is basically the same as for purely TTL operation (see Section ""TTL encoder"" on page 63). The same parameters apply.

However, there are the following differences:

- a. There are no different signal types for the Sin/Cos signal (always 1 Vss for cosine and sine).
- b. The zero pulse is the analog zero pulse typical of Sin/Cos encoders (see the “Connection for high-resolution encoders” section in the operation manual MSD Servo Drive Single-Axis System, for example).

# 6.5.4.2.2 Linear Sin/Cos

|ID|Index Name|Unit|Description|
|---|---|---|---|
|542|ENC_CH1_lines| |Number of Lines (Sin/Cos / TTL encoders)|
|543|ENC_CH1_MultiT| |Number of MultiTurn bits (absolute encoder)|
|544|ENC_CH1_SingleT| |Number of SingleTurn bits (absolute encoder)|
|545|ENC_CH1_Code| |Code selection (SSI encoder) (binary, gray)|
|546|ENC_CH1_Mode| |Mode selection (SSI encoder)|
|547|ENC_CH1_MTBase| |Definition of point of discontinuity in multi-turn range|
|548|ENC_CH1_MTEnable| |Enable MultiTurn use (negative logic, 1=MToff)|
|549|ENC_CH1_Corr| |Signal correction type|
|550|ENC_CH1_CorrVal|0-4|Signal correction values|
|551|ENC_CH1_EncObsMin| |Encoder monitoring minimum, sqrt(a^2+b^2)|
|552|ENC_CH1_AbsEncStatus| |Error and status codes (absolute encoder)|

# 6.5.4.2.3 Signal correction (GPOC)

|ID|Index Name|Unit|Description|
|---|---|---|---|
|553|ENC_CH1_PeriodLen|nm|Length of signal period (Sin/Cos linear encoder)|
|554|ENC_CH1_DigitalResolution|nm|Length of one increment (linear absolute encoder)|
|555|ENC_CH1_Info| |Encoder information|
|616|ENC_CH1_CycleCount| |Sampling cycle in: n x 125 μ (microseconds)|
|610|ENC_CH1_NominalIncrementA| |Sign. Nominal increment A (distance coded abs. per. encoder)|
|611|ENC_CH1_NominalIncrementB| |Sign. Nominal increment B (distance coded abs. per. encoder)|
|1900|ENC_ETS| |ETS mode, electronic nameplate|

# 6.5.4.2.4 Sin/Cos incremental encoders with absolute value interface

The following table lists the parameters for cyclical Sin/Cos operation on encoder channel Ch 1 with one-time reading of the absolute encoder position via the absolute value interface, i.e. without a zero pulse:

|ID|Index Name|Unit|Description|
|---|---|---|---|
|505|ENC_CH1_Sel|1|Encoder selection set to SINCOS(1)|
|510|ENC_CH1_Num| |Encoder gearing: Numerator|
|511|ENC_CH1_Denom| |Encoder gearing: Denominator|
|540|ENC_CH1_Abs| |Absolute value interface selection (one-time reading)|

Table 6.9: Parameters for channel 1 (X7) - Sin/Cos encoder

The Sel, Num, Denom, Abs, Lines, MultiT, SingleT and CorrVal parameters are self-explanatory.

The Code and Mode parameters are described in Section ""SSI (cyclical) X7"" on page 69.

P 547[0] - ENC_CH1_MTBase = Minimum MultiTurn position

The MTBase parameter is used to set a position in the multi-turn encoder’s travel path that defines the point of discontinuity (overflow/underflow) for the absolute value initialization (that is, the “multi-turn basis”). Assuming a bipolar encoder measuring range, all position values that fall below MTBase will be shifted “up” (the whole MT range will be added to them once).

MOOG ID No.:CB40859-001 Date:11/2020

MSD ServoDrive - DeviceHelp

# 6 Encoder

MOOG ID No.:CB40859-001 Date:11/2020

method makes it possible to place the point of discontinuity at any point within the encoder’s entire measuring range. By default, MTBase will be set to the lowest possible value for the parameter, i.e. reliably outside of the encoder’s value range: In this case, the full bipolar range will remain unaffected, as values will never fall below this MTBase threshold (see Section ""Channel 1: Interface X7"" on page 59).

- P 548[0] - ENC_CH1_MTEnable = MultiTurn as SingleTurn
- The MTEnable parameter makes it possible to use multi-turn encoders as single-turn encoders for test purposes. Negative logic: Default MTEnable = 0 means ""MultiTurn-Enable ON"".

P 549[0] - ENC_CH1_Corr = Signal correction type
- The GPOC routine used for track signal correction purposes for sine/cosine signals is used to compensate for systematic errors. The routine is controlled with the Corr and CorrVal parameters (see Section ""Signal correction GPOC (Gain Phase Offset Correction)"" on page 74).

P 551[0] - ENC_CH1_EncObsMin = Encoder monitoring minimum, sqrt (a^2+b^2)
- The parameter EncObsMin is used to scale the Sin/Cos wire break monitoring and represents the “downwards threshold” for an error message. The default setting is 0.2, corresponding to approx. ",What are the key considerations when configuring P 558[0] - ENC_CH1_TTL_SignalType for TTL encoders?,A5,"Correctly setting P 558[0] ensures the TTL encoder's signals are interpreted as intended, whether for direction, counting, or pulse encoding.",1.7421875,1.8671875,3.140625,1.578125,0.412109375
25,msd_servo_drive.txt,20,02f242a213dfa4411d028ce46dfba16a3f97395fa25788fcbaea1715e779d934,"), consult with your project supervisor or the Helpline provided by Moog before using any special SSI protocol modes.

# 6.5.2 EnDat (cyclical) X7

Ch1: ENDAT(4) - Cyclical EnDat (2.1 or 2.2) EnDat is a digital encoder interface developed by HEIDENHAIN. For more details, please visit www.heidenhain.de and go to ►Documentation ►Fundamentals ►Interfaces ►EnDat 2.2.

The software versions required to run the EnDat encoder interface are the standard software versions for the MSD Servo Drive and MSD Single-Axis Servo Drive Compact.

MOOG ID No.:CB40859-001 Date:11/2020

# 6 Encoder

NOTE

- Please note the limitations that apply when running EnDat and SSI encoders (see Section ""Limiting for EnDat and SSI"" on page 52).

When using linear encoders, P 554[0] - ENC_CH1_DigitalResolution is used instead of P 543[0] - ENC_CH1_MultiT and P 544[0] - ENC_CH1_SingleT (which are used for rotary encoders). The values will be read from the EnDat encoder and written to the aforementioned parameters.

- P 543[0] - ENC_CH1_MultiT
- The number ""n"" of multiturn bits defines the measuring range in 2n increments per encoder shaft revolution; maximum travel until overflow; maximum travel within which the absolute value initialization can be unambiguous. In the case of single-turn encoders, MultiT = 0.
- P 544[0] - ENC_CH1_SingleT
- The number ""n"" of single-turn bits corresponds to the encoder’s digital resolution in 2n increments per encoder shaft revolution.
- P 554[0] - ENC_CH1_DigitalResolution
- This is the length of an increment, in nanometres, of the encoder’s digitally transmitted position value. This value is read from the EnDat linear head.

In the case of linear encoders, the number n of transmitted position bits from the encoder will be found in SingleT only! 2n * DigitalResolution yields the maximum travel in nanometres (for the encoder head).

P 640 - ENC_ENDAT is intended for additional information, but is normally not needed. This parameter does not have a Ch1 or Ch3 prefix for the encoder channel in the name, as it applies to both encoder channels. Although usually not needed, the parameter is helpful or required in the following cases:

1. Special EnDat encoder with diagnostics for evaluation
In this case, the valuation numbers from the encoder are read cyclically via additional information. Only the valuation numbers that the encoder supports.

# 6 Encoder

MOOG ID No.:CB40859-001 Date:11/2020

will be read. During the initialization process, the system will read the encoder to determine which valuation numbers it supports. When P 640[0] - ENDAT_Select = 1, the function will be enabled in the controller and the internal diagnostics in the EnDaT encoder will be enabled as well. The EnDat encoder will keep this setting even after being powered off. To explicitly disable the internal diagnostics in the EnDat encoder, set P 640[0] - ENDAT_Select to 2.

# 2. Evaluation of internal warnings

In this scenario, certain internal warnings from the encoder will be read from the encoder via additional information. Only the warnings that both the encoder and the Servo Drive’s software support will be read. During the initialization process, the system will read the encoder to determine which warnings it supports. When P 640[0] - ENDAT_Select = 3, the function will be enabled in the controller.

**Table 6.7: Channel 1 encoder configuration (X7) - EnDat parameters**
|ID|Index Name|Unit|Description|
|---|---|---|---|
|505|0 ENC_CH1_Sel|= ENDAT(4)| |
|543|0 ENC_CH1_MultiT|Number of MultiTurn bits (absolute encoder)| |
|544|0 ENC_CH1_SingleT|Number of SingleTurn bits (absolute encoder)| |
|547|0 ENC_CH1_MTBase|Definition of point of discontinuity in multi-turn range| |
|548|0 ENC_CH1_MTEnable|1: Use Multi-turn encoder as a single-turn encoder| |
|616|0 ENC_CH1_CycleCount|Position encoder sampling cycle (n x 125 μsec)| |
|598|0 ENC_CH1_Position|inc|Position encoder channel 1|
|554|0 ENC_CH1_|nm|Length of one increment (linear absolute encoder)|
|640|ENC_ENDAT| |EnDat additional (additional information)|
|640|0 ENDAT_Select|0=off|EnDat function selection, 1/2=diagnosis on/off, 3=warnings, FF=lock|
|640|1 ENDAT_DiagCount|u16|count new diagnosis block header|
|640|2 ENDAT_BWZ_1|lowbyte|vn1: incremental track|
|640|3 ENDAT_BWZ_3|lowbyte|vn3: absolute track|
|640|4 ENDAT_BWZ_4|lowbyte|vn4: position value formation|
|640|5 ENDAT_Status| |EnDat additional status output|
|640|6 ENDAT_Z1_Sel| |EnDat additional information 1 type selection|

**Table 6.7: Overwrite Channel 1 encoder configuration (X7) - EnDat parameters (continue)**
|ID|Index Name|Unit|Description|
|---|---|---|---|
|640|7 ENDAT_Z1_1| |Z1 info: dword 1|
|640|8 ENDAT_Z1_2| |Z1 info: dword 2|
|640|9 ENDAT_Z1_3| |Z1 info: dword 3|
|640|10 ENDAT_Z1_4| |Z1 info: dword 4|
|640|11 ENDAT_Z2_Sel| |EnDat additional information 2 type selection|
|640|12 ENDAT_Z2_1| |Z2 info: dword 1|
|640|13 ENDAT_Z2_2| |Z2 info: dword 2|
|640|14 ENDAT_Z2_3| |Z2 info: dword 3|
|640|15 ENDAT_Z2_4| |Z2 info: dword 4|
|640|16 ENDAT_Mode1|0=off|EnDat additional mode 1 selection|
|640|17 ENDAT_Mode2| |EnDat additional mode 2 selection|
|640|18 ENDAT_Mode3| |EnDat additional mode 3 selection|
|640|19 ENDAT_Mode4| |EnDat additional mode 4 selection|
|640|20 ENDAT_res1| |reserved 1|
|640|21 ENDAT_res2| |reserved 2|
|640|22 ENDAT_res3| |reserved 3|
|640|23 ENDAT_HwSyncStop|0=SyncOn|EnDat cyclic hw sync, stop/start 1/0|
|640|24 ENDAT_CyclCount| |call counter of cyclic function|
|640|25 ENDAT_BWZ_Supported| |vn supported (bit3=vn4, bit2=vn3, bit0=vn1)|
|640|26 ENDAT_BWZ1_| |vn1: bits[7..0] threshold level, bits[31..16]|
|640|27 ThresholdLevel| |how often number|
|640|28 ENDAT_BWZ3_| |vn3: bits[7..0] threshold level, bits[31..16]|
|640|29 ThresholdLevel| |how often number|
|640|30 ENDAT_BWZ4_| |vn4: bits[7..0] threshold level, bits[31..16]|
|640|31 ThresholdLevel| |how often number|
|640|32 ENDAT_BWZ_TEST_| |vn: bits[15..12] 'F', bits[11..8] vn.no., bits [7..0] vn overwrite value|

# 6.5.3 Hall sensor X7

Ch1: HALL(5) - Digital hall signals

Ch1: HALL_TTL(7) - Digital hall signals

NOTE

l The operation and configuration of Hall effect sensors is reserved for special applications. Consult with Moog if needed.

# 6.5.4 Sin/Cos / TTL X7

# 6.5.4.1 TTL encoder

Ch1: TTL(3) - TTL signals

TTL encoders are ...

- a. ... ... usually pure incremental encoders without an absolute value interface.
- b. In this case, P 540[0] - ENC_CH1_Abs must be set to OFF(0). ... ... in a few exceptional cases, incremental encoders with an SSI absolute value interface. In this case, P 540[0] - ENC_CH1_Abs must be accordingly set to SSI(1) (SSI_CONT(4) in special cases), so that it will be possible to read the absolute encoder position for the absolute value initialization routine once during the initialization phase.

# 6.5.4.1.1 Pure TTL incremental encoder

Set P 505[0] - ENC_CH1_Sel to TTL(3) and P 540[0] - ENC_CH1_Abs to OFF(0) when using pure TTL encoders, i.e. encoders without an absolute value interface but with a TTL zero pulse.

Linear TTL encoders are run as rotary encoders. For linear motor operation, P 542 [0] - ENC_CH1_Lines and the encoder gearing (see the “Encoder gearing” section) are used to establish the ratio for the linear motor’s pole pair subdivision (North-North) for commutation. 1 x North-North corresponds to one revolution from Lines. In this case, the motor pole pair number must be set to 1. Moreover, P 553[0] - ENC_CH1_PeriodLen is not used in this case.

The TTL interface accepts various TTL signal types, which can be selected using P 558[0] - ENC_CH1_TTL_SignalType:

- (0)AF_B - A/B tracks (forward counting, X4 encoding) - AB
- (1)AR_B - A/B tracks (reverse counting, X4 encoding) - AB_inv
- (2)ABDFN - A: Clock (falling edge), B: Direction (1 = positive) - PulseDir
- (3)ABDRP - A: Clock (rising edge), B: Direction (1 = negative) - PulseDir_inv
- (4)reserved

A maximum interpolation period, in ms (milliseconds), can be configured for the TTL interface using P 601[0] - ENC_CH1_Period. Within this context, Period is the maximum time of “no activity” since the last TTL counter event:

- Period = 0: Function disabled (default)
- Period > 0 (=n ms): If no counter event is registered in n ms, the speed will be set to 0.

# Zero pulse

There is no parameter for activating the zero pulse evaluation here, as this evaluation is controlled exclusively based on the homing mode (see Section ""Homing"" on page 249). However, setting P 541[0] - ENC_CH1_NpTest to 1 provides a test mode that can be used during commissioning in order to be able to activate the zero pulse evaluation even without homing. Scope signals 1014 and 1016 can be used to view a received zero pulse within this context. This test mode must be disabled during normal operation (P 541[0] = 0).

# Commutation

Motor operation with pure incremental encoders needs for the auto commutation function to be enabled without fail. For details see Section ""Synchronous motor auto commutation"" on page 156.

# 6.5.4.1.2 TTL incremental encoder with SSI absolute value interface

See Section ""Sin/Cos incremental encoders with absolute value interface"" on page 65 and in special Section ""SSI absolute value interface"" on page 67.

MSD ServoDrive - DeviceHelp

# 6 Encoder

MOOG ID No.:CB40859-001 Date:11/2020 MSD ServoDrive - DeviceHelp 64

|ID|Index Name|Unit|Description|
|---|---|---|---|
|505|0|ENC_CH1_Sel = 3|Encoder selection set to TTL(3)|
|510|0|ENC_CH1_Num|Encoder gearing: Numerator Ch1: SINCOS(1) - Sin/Cos signals|
|511|0|ENC_CH1_Denom|Encoder gearing: Denominator|
|540|0|ENC_CH1_Abs|Selection of absolute value interface Sin/Cos encoders can ...|
|541|0|ENC_CH1_NpTest|ENC CH1, TEST-MODE: Index pulse signal(s) to Scope|
|542|0|ENC_CH1_lines|Number of lines (Sin/Cos / TTL encoders) a. Be pure incremental encoders without an absolute value interface. In this|
|558|0|ENC_CH1_TTL_SignalType|Channel 1: TTL signal selection case, P 540[0] - ENC_CH1_Abs must be set to OFF(0).|
|601|0|ENC_CH1_Period|Maximum period of interpolation (TTL encoder)|
|616|0|ENC_CH1_CycleCount|Sampling cycle in: n x 125 μ (microseconds) b. Be incremental encoders with an absolute value interface. In this case,|

Table 6.8: Parameters for Channel 1 (X7) - TTL encoder

ENC_CH1_Abs must be accordingly set to SSI(1), EnDat(2), HIPER(3) or, in special cases, SSI_CONT(4) so that it will be possible to read the absolute encoder position for the absolute value initialization routine once during the initialization phase.

# 6.5.4.2.1 Purely Sin/Cos incremental encoders

To run these encoders as purely incremental encoders with a zero pulse on encoder channel Ch1 (without an absolute value interface), the approach is basically the same as for purely TTL operation (see Section ""TTL encoder"" on page 63). The same parameters apply.

However, there are the following differences:

- a. There are no different signal types for the Sin/Cos signal (always 1 Vss for cosine and sine).
- b. The zero pulse is the analog zero pulse typical of Sin/Cos encoders (see the “Connection for high-resolution encoders” section in the operation manual MSD Servo Drive Single-Axis System, for example).

# 6.5.4.2.2 Linear Sin/Cos

|ID|Index Name|Unit|Description|
|---|---|---|---|
|542|ENC_CH1_lines| |Number of Lines (Sin/Cos / TTL encoders)|
|543|ENC_CH1_MultiT| |Number of MultiTurn bits (absolute encoder)|
|544|ENC_CH1_SingleT| |Number of SingleTurn bits (absolute encoder)|
|545|ENC_CH1_Code| |Code selection (SSI encoder) (binary, gray)|
|546|ENC_CH1_Mode| |Mode selection (SSI encoder)|
|547|ENC_CH1_MTBase| |Definition of point of discontinuity in multi-turn range|
|548|ENC_CH1_MTEnable| |Enable MultiTurn use (negative logic, 1=MToff)|
|549|ENC_CH1_Corr| |Signal correction type|
|550|ENC_CH1_CorrVal|0-4|Signal correction values|
|551|ENC_CH1_EncObsMin| |Encoder monitoring minimum, sqrt(a^2+b^2)|
|552|ENC_CH1_AbsEncStatus| |Error and status codes (absolute encoder)|

# 6.5.4.2.3 Signal correction (GPOC)

|ID|Index Name|Unit|Description|
|---|---|---|---|
|553|ENC_CH1_PeriodLen|nm|Length of signal period (Sin/Cos linear encoder)|
|554|ENC_CH1_DigitalResolution|nm|Length of one increment (linear absolute encoder)|
|555|ENC_CH1_Info| |Encoder information|
|616|ENC_CH1_CycleCount| |Sampling cycle in: n x 125 μ (microseconds)|
|610|ENC_CH1_NominalIncrementA| |Sign. Nominal increment A (distance coded abs. per. encoder)|
|611|ENC_CH1_NominalIncrementB| |Sign. Nominal increment B (distance coded abs. per. encoder)|
|1900|ENC_ETS| |ETS mode, electronic nameplate|

# 6.5.4.2.4 Sin/Cos incremental encoders with absolute value interface

The following table lists the parameters for cyclical Sin/Cos operation on encoder channel Ch 1 with one-time reading of the absolute encoder position via the absolute value interface, i.e. without a zero pulse:

|ID|Index Name|Unit|Description|
|---|---|---|---|
|505|ENC_CH1_Sel|1|Encoder selection set to SINCOS(1)|
|510|ENC_CH1_Num| |Encoder gearing: Numerator|
|511|ENC_CH1_Denom| |Encoder gearing: Denominator|
|540|ENC_CH1_Abs| |Absolute value interface selection (one-time reading)|

Table 6.9: Parameters for channel 1 (X7) - Sin/Cos encoder

The Sel, Num, Denom, Abs, Lines, MultiT, SingleT and CorrVal parameters are self-explanatory.

The Code and Mode parameters are described in Section ""SSI (cyclical) X7"" on page 69.

P 547[0] - ENC_CH1_MTBase = Minimum MultiTurn position

The MTBase parameter is used to set a position in the multi-turn encoder’s travel path that defines the point of discontinuity (overflow/underflow) for the absolute value initialization (that is, the “multi-turn basis”). Assuming a bipolar encoder measuring range, all position values that fall below MTBase will be shifted “up” (the whole MT range will be added to them once).

MOOG ID No.:CB40859-001 Date:11/2020

MSD ServoDrive - DeviceHelp

# 6 Encoder

MOOG ID No.:CB40859-001 Date:11/2020

method makes it possible to place the point of discontinuity at any point within the encoder’s entire measuring range. By default, MTBase will be set to the lowest possible value for the parameter, i.e. reliably outside of the encoder’s value range: In this case, the full bipolar range will remain unaffected, as values will never fall below this MTBase threshold (see Section ""Channel 1: Interface X7"" on page 59).

- P 548[0] - ENC_CH1_MTEnable = MultiTurn as SingleTurn
- The MTEnable parameter makes it possible to use multi-turn encoders as single-turn encoders for test purposes. Negative logic: Default MTEnable = 0 means ""MultiTurn-Enable ON"".

P 549[0] - ENC_CH1_Corr = Signal correction type
- The GPOC routine used for track signal correction purposes for sine/cosine signals is used to compensate for systematic errors. The routine is controlled with the Corr and CorrVal parameters (see Section ""Signal correction GPOC (Gain Phase Offset Correction)"" on page 74).

P 551[0] - ENC_CH1_EncObsMin = Encoder monitoring minimum, sqrt (a^2+b^2)
- The parameter EncObsMin is used to scale the Sin/Cos wire break monitoring and represents the “downwards threshold” for an error message. The default setting is 0.2, corresponding to approx. ",What distinguishes the P 549[0] - ENC_CH1_Corr parameter in Sin/Cos encoder setups?,A1,"P 549[0] selects the signal correction type for Sin/Cos encoders, compensating for systematic errors in track signals.",1.828125,1.765625,3.3125,1.7109375,0.337890625
26,msd_servo_drive.txt,20,02f242a213dfa4411d028ce46dfba16a3f97395fa25788fcbaea1715e779d934,"), consult with your project supervisor or the Helpline provided by Moog before using any special SSI protocol modes.

# 6.5.2 EnDat (cyclical) X7

Ch1: ENDAT(4) - Cyclical EnDat (2.1 or 2.2) EnDat is a digital encoder interface developed by HEIDENHAIN. For more details, please visit www.heidenhain.de and go to ►Documentation ►Fundamentals ►Interfaces ►EnDat 2.2.

The software versions required to run the EnDat encoder interface are the standard software versions for the MSD Servo Drive and MSD Single-Axis Servo Drive Compact.

MOOG ID No.:CB40859-001 Date:11/2020

# 6 Encoder

NOTE

- Please note the limitations that apply when running EnDat and SSI encoders (see Section ""Limiting for EnDat and SSI"" on page 52).

When using linear encoders, P 554[0] - ENC_CH1_DigitalResolution is used instead of P 543[0] - ENC_CH1_MultiT and P 544[0] - ENC_CH1_SingleT (which are used for rotary encoders). The values will be read from the EnDat encoder and written to the aforementioned parameters.

- P 543[0] - ENC_CH1_MultiT
- The number ""n"" of multiturn bits defines the measuring range in 2n increments per encoder shaft revolution; maximum travel until overflow; maximum travel within which the absolute value initialization can be unambiguous. In the case of single-turn encoders, MultiT = 0.
- P 544[0] - ENC_CH1_SingleT
- The number ""n"" of single-turn bits corresponds to the encoder’s digital resolution in 2n increments per encoder shaft revolution.
- P 554[0] - ENC_CH1_DigitalResolution
- This is the length of an increment, in nanometres, of the encoder’s digitally transmitted position value. This value is read from the EnDat linear head.

In the case of linear encoders, the number n of transmitted position bits from the encoder will be found in SingleT only! 2n * DigitalResolution yields the maximum travel in nanometres (for the encoder head).

P 640 - ENC_ENDAT is intended for additional information, but is normally not needed. This parameter does not have a Ch1 or Ch3 prefix for the encoder channel in the name, as it applies to both encoder channels. Although usually not needed, the parameter is helpful or required in the following cases:

1. Special EnDat encoder with diagnostics for evaluation
In this case, the valuation numbers from the encoder are read cyclically via additional information. Only the valuation numbers that the encoder supports.

# 6 Encoder

MOOG ID No.:CB40859-001 Date:11/2020

will be read. During the initialization process, the system will read the encoder to determine which valuation numbers it supports. When P 640[0] - ENDAT_Select = 1, the function will be enabled in the controller and the internal diagnostics in the EnDaT encoder will be enabled as well. The EnDat encoder will keep this setting even after being powered off. To explicitly disable the internal diagnostics in the EnDat encoder, set P 640[0] - ENDAT_Select to 2.

# 2. Evaluation of internal warnings

In this scenario, certain internal warnings from the encoder will be read from the encoder via additional information. Only the warnings that both the encoder and the Servo Drive’s software support will be read. During the initialization process, the system will read the encoder to determine which warnings it supports. When P 640[0] - ENDAT_Select = 3, the function will be enabled in the controller.

**Table 6.7: Channel 1 encoder configuration (X7) - EnDat parameters**
|ID|Index Name|Unit|Description|
|---|---|---|---|
|505|0 ENC_CH1_Sel|= ENDAT(4)| |
|543|0 ENC_CH1_MultiT|Number of MultiTurn bits (absolute encoder)| |
|544|0 ENC_CH1_SingleT|Number of SingleTurn bits (absolute encoder)| |
|547|0 ENC_CH1_MTBase|Definition of point of discontinuity in multi-turn range| |
|548|0 ENC_CH1_MTEnable|1: Use Multi-turn encoder as a single-turn encoder| |
|616|0 ENC_CH1_CycleCount|Position encoder sampling cycle (n x 125 μsec)| |
|598|0 ENC_CH1_Position|inc|Position encoder channel 1|
|554|0 ENC_CH1_|nm|Length of one increment (linear absolute encoder)|
|640|ENC_ENDAT| |EnDat additional (additional information)|
|640|0 ENDAT_Select|0=off|EnDat function selection, 1/2=diagnosis on/off, 3=warnings, FF=lock|
|640|1 ENDAT_DiagCount|u16|count new diagnosis block header|
|640|2 ENDAT_BWZ_1|lowbyte|vn1: incremental track|
|640|3 ENDAT_BWZ_3|lowbyte|vn3: absolute track|
|640|4 ENDAT_BWZ_4|lowbyte|vn4: position value formation|
|640|5 ENDAT_Status| |EnDat additional status output|
|640|6 ENDAT_Z1_Sel| |EnDat additional information 1 type selection|

**Table 6.7: Overwrite Channel 1 encoder configuration (X7) - EnDat parameters (continue)**
|ID|Index Name|Unit|Description|
|---|---|---|---|
|640|7 ENDAT_Z1_1| |Z1 info: dword 1|
|640|8 ENDAT_Z1_2| |Z1 info: dword 2|
|640|9 ENDAT_Z1_3| |Z1 info: dword 3|
|640|10 ENDAT_Z1_4| |Z1 info: dword 4|
|640|11 ENDAT_Z2_Sel| |EnDat additional information 2 type selection|
|640|12 ENDAT_Z2_1| |Z2 info: dword 1|
|640|13 ENDAT_Z2_2| |Z2 info: dword 2|
|640|14 ENDAT_Z2_3| |Z2 info: dword 3|
|640|15 ENDAT_Z2_4| |Z2 info: dword 4|
|640|16 ENDAT_Mode1|0=off|EnDat additional mode 1 selection|
|640|17 ENDAT_Mode2| |EnDat additional mode 2 selection|
|640|18 ENDAT_Mode3| |EnDat additional mode 3 selection|
|640|19 ENDAT_Mode4| |EnDat additional mode 4 selection|
|640|20 ENDAT_res1| |reserved 1|
|640|21 ENDAT_res2| |reserved 2|
|640|22 ENDAT_res3| |reserved 3|
|640|23 ENDAT_HwSyncStop|0=SyncOn|EnDat cyclic hw sync, stop/start 1/0|
|640|24 ENDAT_CyclCount| |call counter of cyclic function|
|640|25 ENDAT_BWZ_Supported| |vn supported (bit3=vn4, bit2=vn3, bit0=vn1)|
|640|26 ENDAT_BWZ1_| |vn1: bits[7..0] threshold level, bits[31..16]|
|640|27 ThresholdLevel| |how often number|
|640|28 ENDAT_BWZ3_| |vn3: bits[7..0] threshold level, bits[31..16]|
|640|29 ThresholdLevel| |how often number|
|640|30 ENDAT_BWZ4_| |vn4: bits[7..0] threshold level, bits[31..16]|
|640|31 ThresholdLevel| |how often number|
|640|32 ENDAT_BWZ_TEST_| |vn: bits[15..12] 'F', bits[11..8] vn.no., bits [7..0] vn overwrite value|

# 6.5.3 Hall sensor X7

Ch1: HALL(5) - Digital hall signals

Ch1: HALL_TTL(7) - Digital hall signals

NOTE

l The operation and configuration of Hall effect sensors is reserved for special applications. Consult with Moog if needed.

# 6.5.4 Sin/Cos / TTL X7

# 6.5.4.1 TTL encoder

Ch1: TTL(3) - TTL signals

TTL encoders are ...

- a. ... ... usually pure incremental encoders without an absolute value interface.
- b. In this case, P 540[0] - ENC_CH1_Abs must be set to OFF(0). ... ... in a few exceptional cases, incremental encoders with an SSI absolute value interface. In this case, P 540[0] - ENC_CH1_Abs must be accordingly set to SSI(1) (SSI_CONT(4) in special cases), so that it will be possible to read the absolute encoder position for the absolute value initialization routine once during the initialization phase.

# 6.5.4.1.1 Pure TTL incremental encoder

Set P 505[0] - ENC_CH1_Sel to TTL(3) and P 540[0] - ENC_CH1_Abs to OFF(0) when using pure TTL encoders, i.e. encoders without an absolute value interface but with a TTL zero pulse.

Linear TTL encoders are run as rotary encoders. For linear motor operation, P 542 [0] - ENC_CH1_Lines and the encoder gearing (see the “Encoder gearing” section) are used to establish the ratio for the linear motor’s pole pair subdivision (North-North) for commutation. 1 x North-North corresponds to one revolution from Lines. In this case, the motor pole pair number must be set to 1. Moreover, P 553[0] - ENC_CH1_PeriodLen is not used in this case.

The TTL interface accepts various TTL signal types, which can be selected using P 558[0] - ENC_CH1_TTL_SignalType:

- (0)AF_B - A/B tracks (forward counting, X4 encoding) - AB
- (1)AR_B - A/B tracks (reverse counting, X4 encoding) - AB_inv
- (2)ABDFN - A: Clock (falling edge), B: Direction (1 = positive) - PulseDir
- (3)ABDRP - A: Clock (rising edge), B: Direction (1 = negative) - PulseDir_inv
- (4)reserved

A maximum interpolation period, in ms (milliseconds), can be configured for the TTL interface using P 601[0] - ENC_CH1_Period. Within this context, Period is the maximum time of “no activity” since the last TTL counter event:

- Period = 0: Function disabled (default)
- Period > 0 (=n ms): If no counter event is registered in n ms, the speed will be set to 0.

# Zero pulse

There is no parameter for activating the zero pulse evaluation here, as this evaluation is controlled exclusively based on the homing mode (see Section ""Homing"" on page 249). However, setting P 541[0] - ENC_CH1_NpTest to 1 provides a test mode that can be used during commissioning in order to be able to activate the zero pulse evaluation even without homing. Scope signals 1014 and 1016 can be used to view a received zero pulse within this context. This test mode must be disabled during normal operation (P 541[0] = 0).

# Commutation

Motor operation with pure incremental encoders needs for the auto commutation function to be enabled without fail. For details see Section ""Synchronous motor auto commutation"" on page 156.

# 6.5.4.1.2 TTL incremental encoder with SSI absolute value interface

See Section ""Sin/Cos incremental encoders with absolute value interface"" on page 65 and in special Section ""SSI absolute value interface"" on page 67.

MSD ServoDrive - DeviceHelp

# 6 Encoder

MOOG ID No.:CB40859-001 Date:11/2020 MSD ServoDrive - DeviceHelp 64

|ID|Index Name|Unit|Description|
|---|---|---|---|
|505|0|ENC_CH1_Sel = 3|Encoder selection set to TTL(3)|
|510|0|ENC_CH1_Num|Encoder gearing: Numerator Ch1: SINCOS(1) - Sin/Cos signals|
|511|0|ENC_CH1_Denom|Encoder gearing: Denominator|
|540|0|ENC_CH1_Abs|Selection of absolute value interface Sin/Cos encoders can ...|
|541|0|ENC_CH1_NpTest|ENC CH1, TEST-MODE: Index pulse signal(s) to Scope|
|542|0|ENC_CH1_lines|Number of lines (Sin/Cos / TTL encoders) a. Be pure incremental encoders without an absolute value interface. In this|
|558|0|ENC_CH1_TTL_SignalType|Channel 1: TTL signal selection case, P 540[0] - ENC_CH1_Abs must be set to OFF(0).|
|601|0|ENC_CH1_Period|Maximum period of interpolation (TTL encoder)|
|616|0|ENC_CH1_CycleCount|Sampling cycle in: n x 125 μ (microseconds) b. Be incremental encoders with an absolute value interface. In this case,|

Table 6.8: Parameters for Channel 1 (X7) - TTL encoder

ENC_CH1_Abs must be accordingly set to SSI(1), EnDat(2), HIPER(3) or, in special cases, SSI_CONT(4) so that it will be possible to read the absolute encoder position for the absolute value initialization routine once during the initialization phase.

# 6.5.4.2.1 Purely Sin/Cos incremental encoders

To run these encoders as purely incremental encoders with a zero pulse on encoder channel Ch1 (without an absolute value interface), the approach is basically the same as for purely TTL operation (see Section ""TTL encoder"" on page 63). The same parameters apply.

However, there are the following differences:

- a. There are no different signal types for the Sin/Cos signal (always 1 Vss for cosine and sine).
- b. The zero pulse is the analog zero pulse typical of Sin/Cos encoders (see the “Connection for high-resolution encoders” section in the operation manual MSD Servo Drive Single-Axis System, for example).

# 6.5.4.2.2 Linear Sin/Cos

|ID|Index Name|Unit|Description|
|---|---|---|---|
|542|ENC_CH1_lines| |Number of Lines (Sin/Cos / TTL encoders)|
|543|ENC_CH1_MultiT| |Number of MultiTurn bits (absolute encoder)|
|544|ENC_CH1_SingleT| |Number of SingleTurn bits (absolute encoder)|
|545|ENC_CH1_Code| |Code selection (SSI encoder) (binary, gray)|
|546|ENC_CH1_Mode| |Mode selection (SSI encoder)|
|547|ENC_CH1_MTBase| |Definition of point of discontinuity in multi-turn range|
|548|ENC_CH1_MTEnable| |Enable MultiTurn use (negative logic, 1=MToff)|
|549|ENC_CH1_Corr| |Signal correction type|
|550|ENC_CH1_CorrVal|0-4|Signal correction values|
|551|ENC_CH1_EncObsMin| |Encoder monitoring minimum, sqrt(a^2+b^2)|
|552|ENC_CH1_AbsEncStatus| |Error and status codes (absolute encoder)|

# 6.5.4.2.3 Signal correction (GPOC)

|ID|Index Name|Unit|Description|
|---|---|---|---|
|553|ENC_CH1_PeriodLen|nm|Length of signal period (Sin/Cos linear encoder)|
|554|ENC_CH1_DigitalResolution|nm|Length of one increment (linear absolute encoder)|
|555|ENC_CH1_Info| |Encoder information|
|616|ENC_CH1_CycleCount| |Sampling cycle in: n x 125 μ (microseconds)|
|610|ENC_CH1_NominalIncrementA| |Sign. Nominal increment A (distance coded abs. per. encoder)|
|611|ENC_CH1_NominalIncrementB| |Sign. Nominal increment B (distance coded abs. per. encoder)|
|1900|ENC_ETS| |ETS mode, electronic nameplate|

# 6.5.4.2.4 Sin/Cos incremental encoders with absolute value interface

The following table lists the parameters for cyclical Sin/Cos operation on encoder channel Ch 1 with one-time reading of the absolute encoder position via the absolute value interface, i.e. without a zero pulse:

|ID|Index Name|Unit|Description|
|---|---|---|---|
|505|ENC_CH1_Sel|1|Encoder selection set to SINCOS(1)|
|510|ENC_CH1_Num| |Encoder gearing: Numerator|
|511|ENC_CH1_Denom| |Encoder gearing: Denominator|
|540|ENC_CH1_Abs| |Absolute value interface selection (one-time reading)|

Table 6.9: Parameters for channel 1 (X7) - Sin/Cos encoder

The Sel, Num, Denom, Abs, Lines, MultiT, SingleT and CorrVal parameters are self-explanatory.

The Code and Mode parameters are described in Section ""SSI (cyclical) X7"" on page 69.

P 547[0] - ENC_CH1_MTBase = Minimum MultiTurn position

The MTBase parameter is used to set a position in the multi-turn encoder’s travel path that defines the point of discontinuity (overflow/underflow) for the absolute value initialization (that is, the “multi-turn basis”). Assuming a bipolar encoder measuring range, all position values that fall below MTBase will be shifted “up” (the whole MT range will be added to them once).

MOOG ID No.:CB40859-001 Date:11/2020

MSD ServoDrive - DeviceHelp

# 6 Encoder

MOOG ID No.:CB40859-001 Date:11/2020

method makes it possible to place the point of discontinuity at any point within the encoder’s entire measuring range. By default, MTBase will be set to the lowest possible value for the parameter, i.e. reliably outside of the encoder’s value range: In this case, the full bipolar range will remain unaffected, as values will never fall below this MTBase threshold (see Section ""Channel 1: Interface X7"" on page 59).

- P 548[0] - ENC_CH1_MTEnable = MultiTurn as SingleTurn
- The MTEnable parameter makes it possible to use multi-turn encoders as single-turn encoders for test purposes. Negative logic: Default MTEnable = 0 means ""MultiTurn-Enable ON"".

P 549[0] - ENC_CH1_Corr = Signal correction type
- The GPOC routine used for track signal correction purposes for sine/cosine signals is used to compensate for systematic errors. The routine is controlled with the Corr and CorrVal parameters (see Section ""Signal correction GPOC (Gain Phase Offset Correction)"" on page 74).

P 551[0] - ENC_CH1_EncObsMin = Encoder monitoring minimum, sqrt (a^2+b^2)
- The parameter EncObsMin is used to scale the Sin/Cos wire break monitoring and represents the “downwards threshold” for an error message. The default setting is 0.2, corresponding to approx. ",What distinguishes the P 549[0] - ENC_CH1_Corr parameter in Sin/Cos encoder setups?,A2,"This parameter controls the GPOC routine, which corrects gain, phase, and offset errors in sine/cosine encoder signals.",1.609375,1.6875,3.328125,1.796875,0.31640625
27,msd_servo_drive.txt,20,02f242a213dfa4411d028ce46dfba16a3f97395fa25788fcbaea1715e779d934,"), consult with your project supervisor or the Helpline provided by Moog before using any special SSI protocol modes.

# 6.5.2 EnDat (cyclical) X7

Ch1: ENDAT(4) - Cyclical EnDat (2.1 or 2.2) EnDat is a digital encoder interface developed by HEIDENHAIN. For more details, please visit www.heidenhain.de and go to ►Documentation ►Fundamentals ►Interfaces ►EnDat 2.2.

The software versions required to run the EnDat encoder interface are the standard software versions for the MSD Servo Drive and MSD Single-Axis Servo Drive Compact.

MOOG ID No.:CB40859-001 Date:11/2020

# 6 Encoder

NOTE

- Please note the limitations that apply when running EnDat and SSI encoders (see Section ""Limiting for EnDat and SSI"" on page 52).

When using linear encoders, P 554[0] - ENC_CH1_DigitalResolution is used instead of P 543[0] - ENC_CH1_MultiT and P 544[0] - ENC_CH1_SingleT (which are used for rotary encoders). The values will be read from the EnDat encoder and written to the aforementioned parameters.

- P 543[0] - ENC_CH1_MultiT
- The number ""n"" of multiturn bits defines the measuring range in 2n increments per encoder shaft revolution; maximum travel until overflow; maximum travel within which the absolute value initialization can be unambiguous. In the case of single-turn encoders, MultiT = 0.
- P 544[0] - ENC_CH1_SingleT
- The number ""n"" of single-turn bits corresponds to the encoder’s digital resolution in 2n increments per encoder shaft revolution.
- P 554[0] - ENC_CH1_DigitalResolution
- This is the length of an increment, in nanometres, of the encoder’s digitally transmitted position value. This value is read from the EnDat linear head.

In the case of linear encoders, the number n of transmitted position bits from the encoder will be found in SingleT only! 2n * DigitalResolution yields the maximum travel in nanometres (for the encoder head).

P 640 - ENC_ENDAT is intended for additional information, but is normally not needed. This parameter does not have a Ch1 or Ch3 prefix for the encoder channel in the name, as it applies to both encoder channels. Although usually not needed, the parameter is helpful or required in the following cases:

1. Special EnDat encoder with diagnostics for evaluation
In this case, the valuation numbers from the encoder are read cyclically via additional information. Only the valuation numbers that the encoder supports.

# 6 Encoder

MOOG ID No.:CB40859-001 Date:11/2020

will be read. During the initialization process, the system will read the encoder to determine which valuation numbers it supports. When P 640[0] - ENDAT_Select = 1, the function will be enabled in the controller and the internal diagnostics in the EnDaT encoder will be enabled as well. The EnDat encoder will keep this setting even after being powered off. To explicitly disable the internal diagnostics in the EnDat encoder, set P 640[0] - ENDAT_Select to 2.

# 2. Evaluation of internal warnings

In this scenario, certain internal warnings from the encoder will be read from the encoder via additional information. Only the warnings that both the encoder and the Servo Drive’s software support will be read. During the initialization process, the system will read the encoder to determine which warnings it supports. When P 640[0] - ENDAT_Select = 3, the function will be enabled in the controller.

**Table 6.7: Channel 1 encoder configuration (X7) - EnDat parameters**
|ID|Index Name|Unit|Description|
|---|---|---|---|
|505|0 ENC_CH1_Sel|= ENDAT(4)| |
|543|0 ENC_CH1_MultiT|Number of MultiTurn bits (absolute encoder)| |
|544|0 ENC_CH1_SingleT|Number of SingleTurn bits (absolute encoder)| |
|547|0 ENC_CH1_MTBase|Definition of point of discontinuity in multi-turn range| |
|548|0 ENC_CH1_MTEnable|1: Use Multi-turn encoder as a single-turn encoder| |
|616|0 ENC_CH1_CycleCount|Position encoder sampling cycle (n x 125 μsec)| |
|598|0 ENC_CH1_Position|inc|Position encoder channel 1|
|554|0 ENC_CH1_|nm|Length of one increment (linear absolute encoder)|
|640|ENC_ENDAT| |EnDat additional (additional information)|
|640|0 ENDAT_Select|0=off|EnDat function selection, 1/2=diagnosis on/off, 3=warnings, FF=lock|
|640|1 ENDAT_DiagCount|u16|count new diagnosis block header|
|640|2 ENDAT_BWZ_1|lowbyte|vn1: incremental track|
|640|3 ENDAT_BWZ_3|lowbyte|vn3: absolute track|
|640|4 ENDAT_BWZ_4|lowbyte|vn4: position value formation|
|640|5 ENDAT_Status| |EnDat additional status output|
|640|6 ENDAT_Z1_Sel| |EnDat additional information 1 type selection|

**Table 6.7: Overwrite Channel 1 encoder configuration (X7) - EnDat parameters (continue)**
|ID|Index Name|Unit|Description|
|---|---|---|---|
|640|7 ENDAT_Z1_1| |Z1 info: dword 1|
|640|8 ENDAT_Z1_2| |Z1 info: dword 2|
|640|9 ENDAT_Z1_3| |Z1 info: dword 3|
|640|10 ENDAT_Z1_4| |Z1 info: dword 4|
|640|11 ENDAT_Z2_Sel| |EnDat additional information 2 type selection|
|640|12 ENDAT_Z2_1| |Z2 info: dword 1|
|640|13 ENDAT_Z2_2| |Z2 info: dword 2|
|640|14 ENDAT_Z2_3| |Z2 info: dword 3|
|640|15 ENDAT_Z2_4| |Z2 info: dword 4|
|640|16 ENDAT_Mode1|0=off|EnDat additional mode 1 selection|
|640|17 ENDAT_Mode2| |EnDat additional mode 2 selection|
|640|18 ENDAT_Mode3| |EnDat additional mode 3 selection|
|640|19 ENDAT_Mode4| |EnDat additional mode 4 selection|
|640|20 ENDAT_res1| |reserved 1|
|640|21 ENDAT_res2| |reserved 2|
|640|22 ENDAT_res3| |reserved 3|
|640|23 ENDAT_HwSyncStop|0=SyncOn|EnDat cyclic hw sync, stop/start 1/0|
|640|24 ENDAT_CyclCount| |call counter of cyclic function|
|640|25 ENDAT_BWZ_Supported| |vn supported (bit3=vn4, bit2=vn3, bit0=vn1)|
|640|26 ENDAT_BWZ1_| |vn1: bits[7..0] threshold level, bits[31..16]|
|640|27 ThresholdLevel| |how often number|
|640|28 ENDAT_BWZ3_| |vn3: bits[7..0] threshold level, bits[31..16]|
|640|29 ThresholdLevel| |how often number|
|640|30 ENDAT_BWZ4_| |vn4: bits[7..0] threshold level, bits[31..16]|
|640|31 ThresholdLevel| |how often number|
|640|32 ENDAT_BWZ_TEST_| |vn: bits[15..12] 'F', bits[11..8] vn.no., bits [7..0] vn overwrite value|

# 6.5.3 Hall sensor X7

Ch1: HALL(5) - Digital hall signals

Ch1: HALL_TTL(7) - Digital hall signals

NOTE

l The operation and configuration of Hall effect sensors is reserved for special applications. Consult with Moog if needed.

# 6.5.4 Sin/Cos / TTL X7

# 6.5.4.1 TTL encoder

Ch1: TTL(3) - TTL signals

TTL encoders are ...

- a. ... ... usually pure incremental encoders without an absolute value interface.
- b. In this case, P 540[0] - ENC_CH1_Abs must be set to OFF(0). ... ... in a few exceptional cases, incremental encoders with an SSI absolute value interface. In this case, P 540[0] - ENC_CH1_Abs must be accordingly set to SSI(1) (SSI_CONT(4) in special cases), so that it will be possible to read the absolute encoder position for the absolute value initialization routine once during the initialization phase.

# 6.5.4.1.1 Pure TTL incremental encoder

Set P 505[0] - ENC_CH1_Sel to TTL(3) and P 540[0] - ENC_CH1_Abs to OFF(0) when using pure TTL encoders, i.e. encoders without an absolute value interface but with a TTL zero pulse.

Linear TTL encoders are run as rotary encoders. For linear motor operation, P 542 [0] - ENC_CH1_Lines and the encoder gearing (see the “Encoder gearing” section) are used to establish the ratio for the linear motor’s pole pair subdivision (North-North) for commutation. 1 x North-North corresponds to one revolution from Lines. In this case, the motor pole pair number must be set to 1. Moreover, P 553[0] - ENC_CH1_PeriodLen is not used in this case.

The TTL interface accepts various TTL signal types, which can be selected using P 558[0] - ENC_CH1_TTL_SignalType:

- (0)AF_B - A/B tracks (forward counting, X4 encoding) - AB
- (1)AR_B - A/B tracks (reverse counting, X4 encoding) - AB_inv
- (2)ABDFN - A: Clock (falling edge), B: Direction (1 = positive) - PulseDir
- (3)ABDRP - A: Clock (rising edge), B: Direction (1 = negative) - PulseDir_inv
- (4)reserved

A maximum interpolation period, in ms (milliseconds), can be configured for the TTL interface using P 601[0] - ENC_CH1_Period. Within this context, Period is the maximum time of “no activity” since the last TTL counter event:

- Period = 0: Function disabled (default)
- Period > 0 (=n ms): If no counter event is registered in n ms, the speed will be set to 0.

# Zero pulse

There is no parameter for activating the zero pulse evaluation here, as this evaluation is controlled exclusively based on the homing mode (see Section ""Homing"" on page 249). However, setting P 541[0] - ENC_CH1_NpTest to 1 provides a test mode that can be used during commissioning in order to be able to activate the zero pulse evaluation even without homing. Scope signals 1014 and 1016 can be used to view a received zero pulse within this context. This test mode must be disabled during normal operation (P 541[0] = 0).

# Commutation

Motor operation with pure incremental encoders needs for the auto commutation function to be enabled without fail. For details see Section ""Synchronous motor auto commutation"" on page 156.

# 6.5.4.1.2 TTL incremental encoder with SSI absolute value interface

See Section ""Sin/Cos incremental encoders with absolute value interface"" on page 65 and in special Section ""SSI absolute value interface"" on page 67.

MSD ServoDrive - DeviceHelp

# 6 Encoder

MOOG ID No.:CB40859-001 Date:11/2020 MSD ServoDrive - DeviceHelp 64

|ID|Index Name|Unit|Description|
|---|---|---|---|
|505|0|ENC_CH1_Sel = 3|Encoder selection set to TTL(3)|
|510|0|ENC_CH1_Num|Encoder gearing: Numerator Ch1: SINCOS(1) - Sin/Cos signals|
|511|0|ENC_CH1_Denom|Encoder gearing: Denominator|
|540|0|ENC_CH1_Abs|Selection of absolute value interface Sin/Cos encoders can ...|
|541|0|ENC_CH1_NpTest|ENC CH1, TEST-MODE: Index pulse signal(s) to Scope|
|542|0|ENC_CH1_lines|Number of lines (Sin/Cos / TTL encoders) a. Be pure incremental encoders without an absolute value interface. In this|
|558|0|ENC_CH1_TTL_SignalType|Channel 1: TTL signal selection case, P 540[0] - ENC_CH1_Abs must be set to OFF(0).|
|601|0|ENC_CH1_Period|Maximum period of interpolation (TTL encoder)|
|616|0|ENC_CH1_CycleCount|Sampling cycle in: n x 125 μ (microseconds) b. Be incremental encoders with an absolute value interface. In this case,|

Table 6.8: Parameters for Channel 1 (X7) - TTL encoder

ENC_CH1_Abs must be accordingly set to SSI(1), EnDat(2), HIPER(3) or, in special cases, SSI_CONT(4) so that it will be possible to read the absolute encoder position for the absolute value initialization routine once during the initialization phase.

# 6.5.4.2.1 Purely Sin/Cos incremental encoders

To run these encoders as purely incremental encoders with a zero pulse on encoder channel Ch1 (without an absolute value interface), the approach is basically the same as for purely TTL operation (see Section ""TTL encoder"" on page 63). The same parameters apply.

However, there are the following differences:

- a. There are no different signal types for the Sin/Cos signal (always 1 Vss for cosine and sine).
- b. The zero pulse is the analog zero pulse typical of Sin/Cos encoders (see the “Connection for high-resolution encoders” section in the operation manual MSD Servo Drive Single-Axis System, for example).

# 6.5.4.2.2 Linear Sin/Cos

|ID|Index Name|Unit|Description|
|---|---|---|---|
|542|ENC_CH1_lines| |Number of Lines (Sin/Cos / TTL encoders)|
|543|ENC_CH1_MultiT| |Number of MultiTurn bits (absolute encoder)|
|544|ENC_CH1_SingleT| |Number of SingleTurn bits (absolute encoder)|
|545|ENC_CH1_Code| |Code selection (SSI encoder) (binary, gray)|
|546|ENC_CH1_Mode| |Mode selection (SSI encoder)|
|547|ENC_CH1_MTBase| |Definition of point of discontinuity in multi-turn range|
|548|ENC_CH1_MTEnable| |Enable MultiTurn use (negative logic, 1=MToff)|
|549|ENC_CH1_Corr| |Signal correction type|
|550|ENC_CH1_CorrVal|0-4|Signal correction values|
|551|ENC_CH1_EncObsMin| |Encoder monitoring minimum, sqrt(a^2+b^2)|
|552|ENC_CH1_AbsEncStatus| |Error and status codes (absolute encoder)|

# 6.5.4.2.3 Signal correction (GPOC)

|ID|Index Name|Unit|Description|
|---|---|---|---|
|553|ENC_CH1_PeriodLen|nm|Length of signal period (Sin/Cos linear encoder)|
|554|ENC_CH1_DigitalResolution|nm|Length of one increment (linear absolute encoder)|
|555|ENC_CH1_Info| |Encoder information|
|616|ENC_CH1_CycleCount| |Sampling cycle in: n x 125 μ (microseconds)|
|610|ENC_CH1_NominalIncrementA| |Sign. Nominal increment A (distance coded abs. per. encoder)|
|611|ENC_CH1_NominalIncrementB| |Sign. Nominal increment B (distance coded abs. per. encoder)|
|1900|ENC_ETS| |ETS mode, electronic nameplate|

# 6.5.4.2.4 Sin/Cos incremental encoders with absolute value interface

The following table lists the parameters for cyclical Sin/Cos operation on encoder channel Ch 1 with one-time reading of the absolute encoder position via the absolute value interface, i.e. without a zero pulse:

|ID|Index Name|Unit|Description|
|---|---|---|---|
|505|ENC_CH1_Sel|1|Encoder selection set to SINCOS(1)|
|510|ENC_CH1_Num| |Encoder gearing: Numerator|
|511|ENC_CH1_Denom| |Encoder gearing: Denominator|
|540|ENC_CH1_Abs| |Absolute value interface selection (one-time reading)|

Table 6.9: Parameters for channel 1 (X7) - Sin/Cos encoder

The Sel, Num, Denom, Abs, Lines, MultiT, SingleT and CorrVal parameters are self-explanatory.

The Code and Mode parameters are described in Section ""SSI (cyclical) X7"" on page 69.

P 547[0] - ENC_CH1_MTBase = Minimum MultiTurn position

The MTBase parameter is used to set a position in the multi-turn encoder’s travel path that defines the point of discontinuity (overflow/underflow) for the absolute value initialization (that is, the “multi-turn basis”). Assuming a bipolar encoder measuring range, all position values that fall below MTBase will be shifted “up” (the whole MT range will be added to them once).

MOOG ID No.:CB40859-001 Date:11/2020

MSD ServoDrive - DeviceHelp

# 6 Encoder

MOOG ID No.:CB40859-001 Date:11/2020

method makes it possible to place the point of discontinuity at any point within the encoder’s entire measuring range. By default, MTBase will be set to the lowest possible value for the parameter, i.e. reliably outside of the encoder’s value range: In this case, the full bipolar range will remain unaffected, as values will never fall below this MTBase threshold (see Section ""Channel 1: Interface X7"" on page 59).

- P 548[0] - ENC_CH1_MTEnable = MultiTurn as SingleTurn
- The MTEnable parameter makes it possible to use multi-turn encoders as single-turn encoders for test purposes. Negative logic: Default MTEnable = 0 means ""MultiTurn-Enable ON"".

P 549[0] - ENC_CH1_Corr = Signal correction type
- The GPOC routine used for track signal correction purposes for sine/cosine signals is used to compensate for systematic errors. The routine is controlled with the Corr and CorrVal parameters (see Section ""Signal correction GPOC (Gain Phase Offset Correction)"" on page 74).

P 551[0] - ENC_CH1_EncObsMin = Encoder monitoring minimum, sqrt (a^2+b^2)
- The parameter EncObsMin is used to scale the Sin/Cos wire break monitoring and represents the “downwards threshold” for an error message. The default setting is 0.2, corresponding to approx. ",What distinguishes the P 549[0] - ENC_CH1_Corr parameter in Sin/Cos encoder setups?,A3,"It determines the method used to adjust Sin/Cos signals, enhancing accuracy by addressing common signal imperfections.",1.734375,1.7734375,3.390625,1.65625,0.3046875
28,msd_servo_drive.txt,20,02f242a213dfa4411d028ce46dfba16a3f97395fa25788fcbaea1715e779d934,"), consult with your project supervisor or the Helpline provided by Moog before using any special SSI protocol modes.

# 6.5.2 EnDat (cyclical) X7

Ch1: ENDAT(4) - Cyclical EnDat (2.1 or 2.2) EnDat is a digital encoder interface developed by HEIDENHAIN. For more details, please visit www.heidenhain.de and go to ►Documentation ►Fundamentals ►Interfaces ►EnDat 2.2.

The software versions required to run the EnDat encoder interface are the standard software versions for the MSD Servo Drive and MSD Single-Axis Servo Drive Compact.

MOOG ID No.:CB40859-001 Date:11/2020

# 6 Encoder

NOTE

- Please note the limitations that apply when running EnDat and SSI encoders (see Section ""Limiting for EnDat and SSI"" on page 52).

When using linear encoders, P 554[0] - ENC_CH1_DigitalResolution is used instead of P 543[0] - ENC_CH1_MultiT and P 544[0] - ENC_CH1_SingleT (which are used for rotary encoders). The values will be read from the EnDat encoder and written to the aforementioned parameters.

- P 543[0] - ENC_CH1_MultiT
- The number ""n"" of multiturn bits defines the measuring range in 2n increments per encoder shaft revolution; maximum travel until overflow; maximum travel within which the absolute value initialization can be unambiguous. In the case of single-turn encoders, MultiT = 0.
- P 544[0] - ENC_CH1_SingleT
- The number ""n"" of single-turn bits corresponds to the encoder’s digital resolution in 2n increments per encoder shaft revolution.
- P 554[0] - ENC_CH1_DigitalResolution
- This is the length of an increment, in nanometres, of the encoder’s digitally transmitted position value. This value is read from the EnDat linear head.

In the case of linear encoders, the number n of transmitted position bits from the encoder will be found in SingleT only! 2n * DigitalResolution yields the maximum travel in nanometres (for the encoder head).

P 640 - ENC_ENDAT is intended for additional information, but is normally not needed. This parameter does not have a Ch1 or Ch3 prefix for the encoder channel in the name, as it applies to both encoder channels. Although usually not needed, the parameter is helpful or required in the following cases:

1. Special EnDat encoder with diagnostics for evaluation
In this case, the valuation numbers from the encoder are read cyclically via additional information. Only the valuation numbers that the encoder supports.

# 6 Encoder

MOOG ID No.:CB40859-001 Date:11/2020

will be read. During the initialization process, the system will read the encoder to determine which valuation numbers it supports. When P 640[0] - ENDAT_Select = 1, the function will be enabled in the controller and the internal diagnostics in the EnDaT encoder will be enabled as well. The EnDat encoder will keep this setting even after being powered off. To explicitly disable the internal diagnostics in the EnDat encoder, set P 640[0] - ENDAT_Select to 2.

# 2. Evaluation of internal warnings

In this scenario, certain internal warnings from the encoder will be read from the encoder via additional information. Only the warnings that both the encoder and the Servo Drive’s software support will be read. During the initialization process, the system will read the encoder to determine which warnings it supports. When P 640[0] - ENDAT_Select = 3, the function will be enabled in the controller.

**Table 6.7: Channel 1 encoder configuration (X7) - EnDat parameters**
|ID|Index Name|Unit|Description|
|---|---|---|---|
|505|0 ENC_CH1_Sel|= ENDAT(4)| |
|543|0 ENC_CH1_MultiT|Number of MultiTurn bits (absolute encoder)| |
|544|0 ENC_CH1_SingleT|Number of SingleTurn bits (absolute encoder)| |
|547|0 ENC_CH1_MTBase|Definition of point of discontinuity in multi-turn range| |
|548|0 ENC_CH1_MTEnable|1: Use Multi-turn encoder as a single-turn encoder| |
|616|0 ENC_CH1_CycleCount|Position encoder sampling cycle (n x 125 μsec)| |
|598|0 ENC_CH1_Position|inc|Position encoder channel 1|
|554|0 ENC_CH1_|nm|Length of one increment (linear absolute encoder)|
|640|ENC_ENDAT| |EnDat additional (additional information)|
|640|0 ENDAT_Select|0=off|EnDat function selection, 1/2=diagnosis on/off, 3=warnings, FF=lock|
|640|1 ENDAT_DiagCount|u16|count new diagnosis block header|
|640|2 ENDAT_BWZ_1|lowbyte|vn1: incremental track|
|640|3 ENDAT_BWZ_3|lowbyte|vn3: absolute track|
|640|4 ENDAT_BWZ_4|lowbyte|vn4: position value formation|
|640|5 ENDAT_Status| |EnDat additional status output|
|640|6 ENDAT_Z1_Sel| |EnDat additional information 1 type selection|

**Table 6.7: Overwrite Channel 1 encoder configuration (X7) - EnDat parameters (continue)**
|ID|Index Name|Unit|Description|
|---|---|---|---|
|640|7 ENDAT_Z1_1| |Z1 info: dword 1|
|640|8 ENDAT_Z1_2| |Z1 info: dword 2|
|640|9 ENDAT_Z1_3| |Z1 info: dword 3|
|640|10 ENDAT_Z1_4| |Z1 info: dword 4|
|640|11 ENDAT_Z2_Sel| |EnDat additional information 2 type selection|
|640|12 ENDAT_Z2_1| |Z2 info: dword 1|
|640|13 ENDAT_Z2_2| |Z2 info: dword 2|
|640|14 ENDAT_Z2_3| |Z2 info: dword 3|
|640|15 ENDAT_Z2_4| |Z2 info: dword 4|
|640|16 ENDAT_Mode1|0=off|EnDat additional mode 1 selection|
|640|17 ENDAT_Mode2| |EnDat additional mode 2 selection|
|640|18 ENDAT_Mode3| |EnDat additional mode 3 selection|
|640|19 ENDAT_Mode4| |EnDat additional mode 4 selection|
|640|20 ENDAT_res1| |reserved 1|
|640|21 ENDAT_res2| |reserved 2|
|640|22 ENDAT_res3| |reserved 3|
|640|23 ENDAT_HwSyncStop|0=SyncOn|EnDat cyclic hw sync, stop/start 1/0|
|640|24 ENDAT_CyclCount| |call counter of cyclic function|
|640|25 ENDAT_BWZ_Supported| |vn supported (bit3=vn4, bit2=vn3, bit0=vn1)|
|640|26 ENDAT_BWZ1_| |vn1: bits[7..0] threshold level, bits[31..16]|
|640|27 ThresholdLevel| |how often number|
|640|28 ENDAT_BWZ3_| |vn3: bits[7..0] threshold level, bits[31..16]|
|640|29 ThresholdLevel| |how often number|
|640|30 ENDAT_BWZ4_| |vn4: bits[7..0] threshold level, bits[31..16]|
|640|31 ThresholdLevel| |how often number|
|640|32 ENDAT_BWZ_TEST_| |vn: bits[15..12] 'F', bits[11..8] vn.no., bits [7..0] vn overwrite value|

# 6.5.3 Hall sensor X7

Ch1: HALL(5) - Digital hall signals

Ch1: HALL_TTL(7) - Digital hall signals

NOTE

l The operation and configuration of Hall effect sensors is reserved for special applications. Consult with Moog if needed.

# 6.5.4 Sin/Cos / TTL X7

# 6.5.4.1 TTL encoder

Ch1: TTL(3) - TTL signals

TTL encoders are ...

- a. ... ... usually pure incremental encoders without an absolute value interface.
- b. In this case, P 540[0] - ENC_CH1_Abs must be set to OFF(0). ... ... in a few exceptional cases, incremental encoders with an SSI absolute value interface. In this case, P 540[0] - ENC_CH1_Abs must be accordingly set to SSI(1) (SSI_CONT(4) in special cases), so that it will be possible to read the absolute encoder position for the absolute value initialization routine once during the initialization phase.

# 6.5.4.1.1 Pure TTL incremental encoder

Set P 505[0] - ENC_CH1_Sel to TTL(3) and P 540[0] - ENC_CH1_Abs to OFF(0) when using pure TTL encoders, i.e. encoders without an absolute value interface but with a TTL zero pulse.

Linear TTL encoders are run as rotary encoders. For linear motor operation, P 542 [0] - ENC_CH1_Lines and the encoder gearing (see the “Encoder gearing” section) are used to establish the ratio for the linear motor’s pole pair subdivision (North-North) for commutation. 1 x North-North corresponds to one revolution from Lines. In this case, the motor pole pair number must be set to 1. Moreover, P 553[0] - ENC_CH1_PeriodLen is not used in this case.

The TTL interface accepts various TTL signal types, which can be selected using P 558[0] - ENC_CH1_TTL_SignalType:

- (0)AF_B - A/B tracks (forward counting, X4 encoding) - AB
- (1)AR_B - A/B tracks (reverse counting, X4 encoding) - AB_inv
- (2)ABDFN - A: Clock (falling edge), B: Direction (1 = positive) - PulseDir
- (3)ABDRP - A: Clock (rising edge), B: Direction (1 = negative) - PulseDir_inv
- (4)reserved

A maximum interpolation period, in ms (milliseconds), can be configured for the TTL interface using P 601[0] - ENC_CH1_Period. Within this context, Period is the maximum time of “no activity” since the last TTL counter event:

- Period = 0: Function disabled (default)
- Period > 0 (=n ms): If no counter event is registered in n ms, the speed will be set to 0.

# Zero pulse

There is no parameter for activating the zero pulse evaluation here, as this evaluation is controlled exclusively based on the homing mode (see Section ""Homing"" on page 249). However, setting P 541[0] - ENC_CH1_NpTest to 1 provides a test mode that can be used during commissioning in order to be able to activate the zero pulse evaluation even without homing. Scope signals 1014 and 1016 can be used to view a received zero pulse within this context. This test mode must be disabled during normal operation (P 541[0] = 0).

# Commutation

Motor operation with pure incremental encoders needs for the auto commutation function to be enabled without fail. For details see Section ""Synchronous motor auto commutation"" on page 156.

# 6.5.4.1.2 TTL incremental encoder with SSI absolute value interface

See Section ""Sin/Cos incremental encoders with absolute value interface"" on page 65 and in special Section ""SSI absolute value interface"" on page 67.

MSD ServoDrive - DeviceHelp

# 6 Encoder

MOOG ID No.:CB40859-001 Date:11/2020 MSD ServoDrive - DeviceHelp 64

|ID|Index Name|Unit|Description|
|---|---|---|---|
|505|0|ENC_CH1_Sel = 3|Encoder selection set to TTL(3)|
|510|0|ENC_CH1_Num|Encoder gearing: Numerator Ch1: SINCOS(1) - Sin/Cos signals|
|511|0|ENC_CH1_Denom|Encoder gearing: Denominator|
|540|0|ENC_CH1_Abs|Selection of absolute value interface Sin/Cos encoders can ...|
|541|0|ENC_CH1_NpTest|ENC CH1, TEST-MODE: Index pulse signal(s) to Scope|
|542|0|ENC_CH1_lines|Number of lines (Sin/Cos / TTL encoders) a. Be pure incremental encoders without an absolute value interface. In this|
|558|0|ENC_CH1_TTL_SignalType|Channel 1: TTL signal selection case, P 540[0] - ENC_CH1_Abs must be set to OFF(0).|
|601|0|ENC_CH1_Period|Maximum period of interpolation (TTL encoder)|
|616|0|ENC_CH1_CycleCount|Sampling cycle in: n x 125 μ (microseconds) b. Be incremental encoders with an absolute value interface. In this case,|

Table 6.8: Parameters for Channel 1 (X7) - TTL encoder

ENC_CH1_Abs must be accordingly set to SSI(1), EnDat(2), HIPER(3) or, in special cases, SSI_CONT(4) so that it will be possible to read the absolute encoder position for the absolute value initialization routine once during the initialization phase.

# 6.5.4.2.1 Purely Sin/Cos incremental encoders

To run these encoders as purely incremental encoders with a zero pulse on encoder channel Ch1 (without an absolute value interface), the approach is basically the same as for purely TTL operation (see Section ""TTL encoder"" on page 63). The same parameters apply.

However, there are the following differences:

- a. There are no different signal types for the Sin/Cos signal (always 1 Vss for cosine and sine).
- b. The zero pulse is the analog zero pulse typical of Sin/Cos encoders (see the “Connection for high-resolution encoders” section in the operation manual MSD Servo Drive Single-Axis System, for example).

# 6.5.4.2.2 Linear Sin/Cos

|ID|Index Name|Unit|Description|
|---|---|---|---|
|542|ENC_CH1_lines| |Number of Lines (Sin/Cos / TTL encoders)|
|543|ENC_CH1_MultiT| |Number of MultiTurn bits (absolute encoder)|
|544|ENC_CH1_SingleT| |Number of SingleTurn bits (absolute encoder)|
|545|ENC_CH1_Code| |Code selection (SSI encoder) (binary, gray)|
|546|ENC_CH1_Mode| |Mode selection (SSI encoder)|
|547|ENC_CH1_MTBase| |Definition of point of discontinuity in multi-turn range|
|548|ENC_CH1_MTEnable| |Enable MultiTurn use (negative logic, 1=MToff)|
|549|ENC_CH1_Corr| |Signal correction type|
|550|ENC_CH1_CorrVal|0-4|Signal correction values|
|551|ENC_CH1_EncObsMin| |Encoder monitoring minimum, sqrt(a^2+b^2)|
|552|ENC_CH1_AbsEncStatus| |Error and status codes (absolute encoder)|

# 6.5.4.2.3 Signal correction (GPOC)

|ID|Index Name|Unit|Description|
|---|---|---|---|
|553|ENC_CH1_PeriodLen|nm|Length of signal period (Sin/Cos linear encoder)|
|554|ENC_CH1_DigitalResolution|nm|Length of one increment (linear absolute encoder)|
|555|ENC_CH1_Info| |Encoder information|
|616|ENC_CH1_CycleCount| |Sampling cycle in: n x 125 μ (microseconds)|
|610|ENC_CH1_NominalIncrementA| |Sign. Nominal increment A (distance coded abs. per. encoder)|
|611|ENC_CH1_NominalIncrementB| |Sign. Nominal increment B (distance coded abs. per. encoder)|
|1900|ENC_ETS| |ETS mode, electronic nameplate|

# 6.5.4.2.4 Sin/Cos incremental encoders with absolute value interface

The following table lists the parameters for cyclical Sin/Cos operation on encoder channel Ch 1 with one-time reading of the absolute encoder position via the absolute value interface, i.e. without a zero pulse:

|ID|Index Name|Unit|Description|
|---|---|---|---|
|505|ENC_CH1_Sel|1|Encoder selection set to SINCOS(1)|
|510|ENC_CH1_Num| |Encoder gearing: Numerator|
|511|ENC_CH1_Denom| |Encoder gearing: Denominator|
|540|ENC_CH1_Abs| |Absolute value interface selection (one-time reading)|

Table 6.9: Parameters for channel 1 (X7) - Sin/Cos encoder

The Sel, Num, Denom, Abs, Lines, MultiT, SingleT and CorrVal parameters are self-explanatory.

The Code and Mode parameters are described in Section ""SSI (cyclical) X7"" on page 69.

P 547[0] - ENC_CH1_MTBase = Minimum MultiTurn position

The MTBase parameter is used to set a position in the multi-turn encoder’s travel path that defines the point of discontinuity (overflow/underflow) for the absolute value initialization (that is, the “multi-turn basis”). Assuming a bipolar encoder measuring range, all position values that fall below MTBase will be shifted “up” (the whole MT range will be added to them once).

MOOG ID No.:CB40859-001 Date:11/2020

MSD ServoDrive - DeviceHelp

# 6 Encoder

MOOG ID No.:CB40859-001 Date:11/2020

method makes it possible to place the point of discontinuity at any point within the encoder’s entire measuring range. By default, MTBase will be set to the lowest possible value for the parameter, i.e. reliably outside of the encoder’s value range: In this case, the full bipolar range will remain unaffected, as values will never fall below this MTBase threshold (see Section ""Channel 1: Interface X7"" on page 59).

- P 548[0] - ENC_CH1_MTEnable = MultiTurn as SingleTurn
- The MTEnable parameter makes it possible to use multi-turn encoders as single-turn encoders for test purposes. Negative logic: Default MTEnable = 0 means ""MultiTurn-Enable ON"".

P 549[0] - ENC_CH1_Corr = Signal correction type
- The GPOC routine used for track signal correction purposes for sine/cosine signals is used to compensate for systematic errors. The routine is controlled with the Corr and CorrVal parameters (see Section ""Signal correction GPOC (Gain Phase Offset Correction)"" on page 74).

P 551[0] - ENC_CH1_EncObsMin = Encoder monitoring minimum, sqrt (a^2+b^2)
- The parameter EncObsMin is used to scale the Sin/Cos wire break monitoring and represents the “downwards threshold” for an error message. The default setting is 0.2, corresponding to approx. ",What distinguishes the P 549[0] - ENC_CH1_Corr parameter in Sin/Cos encoder setups?,A4,"By configuring P 549[0], users can apply specific corrections to improve the fidelity of encoder position readings.",1.6171875,1.703125,3.328125,1.6015625,0.2734375
29,msd_servo_drive.txt,20,02f242a213dfa4411d028ce46dfba16a3f97395fa25788fcbaea1715e779d934,"), consult with your project supervisor or the Helpline provided by Moog before using any special SSI protocol modes.

# 6.5.2 EnDat (cyclical) X7

Ch1: ENDAT(4) - Cyclical EnDat (2.1 or 2.2) EnDat is a digital encoder interface developed by HEIDENHAIN. For more details, please visit www.heidenhain.de and go to ►Documentation ►Fundamentals ►Interfaces ►EnDat 2.2.

The software versions required to run the EnDat encoder interface are the standard software versions for the MSD Servo Drive and MSD Single-Axis Servo Drive Compact.

MOOG ID No.:CB40859-001 Date:11/2020

# 6 Encoder

NOTE

- Please note the limitations that apply when running EnDat and SSI encoders (see Section ""Limiting for EnDat and SSI"" on page 52).

When using linear encoders, P 554[0] - ENC_CH1_DigitalResolution is used instead of P 543[0] - ENC_CH1_MultiT and P 544[0] - ENC_CH1_SingleT (which are used for rotary encoders). The values will be read from the EnDat encoder and written to the aforementioned parameters.

- P 543[0] - ENC_CH1_MultiT
- The number ""n"" of multiturn bits defines the measuring range in 2n increments per encoder shaft revolution; maximum travel until overflow; maximum travel within which the absolute value initialization can be unambiguous. In the case of single-turn encoders, MultiT = 0.
- P 544[0] - ENC_CH1_SingleT
- The number ""n"" of single-turn bits corresponds to the encoder’s digital resolution in 2n increments per encoder shaft revolution.
- P 554[0] - ENC_CH1_DigitalResolution
- This is the length of an increment, in nanometres, of the encoder’s digitally transmitted position value. This value is read from the EnDat linear head.

In the case of linear encoders, the number n of transmitted position bits from the encoder will be found in SingleT only! 2n * DigitalResolution yields the maximum travel in nanometres (for the encoder head).

P 640 - ENC_ENDAT is intended for additional information, but is normally not needed. This parameter does not have a Ch1 or Ch3 prefix for the encoder channel in the name, as it applies to both encoder channels. Although usually not needed, the parameter is helpful or required in the following cases:

1. Special EnDat encoder with diagnostics for evaluation
In this case, the valuation numbers from the encoder are read cyclically via additional information. Only the valuation numbers that the encoder supports.

# 6 Encoder

MOOG ID No.:CB40859-001 Date:11/2020

will be read. During the initialization process, the system will read the encoder to determine which valuation numbers it supports. When P 640[0] - ENDAT_Select = 1, the function will be enabled in the controller and the internal diagnostics in the EnDaT encoder will be enabled as well. The EnDat encoder will keep this setting even after being powered off. To explicitly disable the internal diagnostics in the EnDat encoder, set P 640[0] - ENDAT_Select to 2.

# 2. Evaluation of internal warnings

In this scenario, certain internal warnings from the encoder will be read from the encoder via additional information. Only the warnings that both the encoder and the Servo Drive’s software support will be read. During the initialization process, the system will read the encoder to determine which warnings it supports. When P 640[0] - ENDAT_Select = 3, the function will be enabled in the controller.

**Table 6.7: Channel 1 encoder configuration (X7) - EnDat parameters**
|ID|Index Name|Unit|Description|
|---|---|---|---|
|505|0 ENC_CH1_Sel|= ENDAT(4)| |
|543|0 ENC_CH1_MultiT|Number of MultiTurn bits (absolute encoder)| |
|544|0 ENC_CH1_SingleT|Number of SingleTurn bits (absolute encoder)| |
|547|0 ENC_CH1_MTBase|Definition of point of discontinuity in multi-turn range| |
|548|0 ENC_CH1_MTEnable|1: Use Multi-turn encoder as a single-turn encoder| |
|616|0 ENC_CH1_CycleCount|Position encoder sampling cycle (n x 125 μsec)| |
|598|0 ENC_CH1_Position|inc|Position encoder channel 1|
|554|0 ENC_CH1_|nm|Length of one increment (linear absolute encoder)|
|640|ENC_ENDAT| |EnDat additional (additional information)|
|640|0 ENDAT_Select|0=off|EnDat function selection, 1/2=diagnosis on/off, 3=warnings, FF=lock|
|640|1 ENDAT_DiagCount|u16|count new diagnosis block header|
|640|2 ENDAT_BWZ_1|lowbyte|vn1: incremental track|
|640|3 ENDAT_BWZ_3|lowbyte|vn3: absolute track|
|640|4 ENDAT_BWZ_4|lowbyte|vn4: position value formation|
|640|5 ENDAT_Status| |EnDat additional status output|
|640|6 ENDAT_Z1_Sel| |EnDat additional information 1 type selection|

**Table 6.7: Overwrite Channel 1 encoder configuration (X7) - EnDat parameters (continue)**
|ID|Index Name|Unit|Description|
|---|---|---|---|
|640|7 ENDAT_Z1_1| |Z1 info: dword 1|
|640|8 ENDAT_Z1_2| |Z1 info: dword 2|
|640|9 ENDAT_Z1_3| |Z1 info: dword 3|
|640|10 ENDAT_Z1_4| |Z1 info: dword 4|
|640|11 ENDAT_Z2_Sel| |EnDat additional information 2 type selection|
|640|12 ENDAT_Z2_1| |Z2 info: dword 1|
|640|13 ENDAT_Z2_2| |Z2 info: dword 2|
|640|14 ENDAT_Z2_3| |Z2 info: dword 3|
|640|15 ENDAT_Z2_4| |Z2 info: dword 4|
|640|16 ENDAT_Mode1|0=off|EnDat additional mode 1 selection|
|640|17 ENDAT_Mode2| |EnDat additional mode 2 selection|
|640|18 ENDAT_Mode3| |EnDat additional mode 3 selection|
|640|19 ENDAT_Mode4| |EnDat additional mode 4 selection|
|640|20 ENDAT_res1| |reserved 1|
|640|21 ENDAT_res2| |reserved 2|
|640|22 ENDAT_res3| |reserved 3|
|640|23 ENDAT_HwSyncStop|0=SyncOn|EnDat cyclic hw sync, stop/start 1/0|
|640|24 ENDAT_CyclCount| |call counter of cyclic function|
|640|25 ENDAT_BWZ_Supported| |vn supported (bit3=vn4, bit2=vn3, bit0=vn1)|
|640|26 ENDAT_BWZ1_| |vn1: bits[7..0] threshold level, bits[31..16]|
|640|27 ThresholdLevel| |how often number|
|640|28 ENDAT_BWZ3_| |vn3: bits[7..0] threshold level, bits[31..16]|
|640|29 ThresholdLevel| |how often number|
|640|30 ENDAT_BWZ4_| |vn4: bits[7..0] threshold level, bits[31..16]|
|640|31 ThresholdLevel| |how often number|
|640|32 ENDAT_BWZ_TEST_| |vn: bits[15..12] 'F', bits[11..8] vn.no., bits [7..0] vn overwrite value|

# 6.5.3 Hall sensor X7

Ch1: HALL(5) - Digital hall signals

Ch1: HALL_TTL(7) - Digital hall signals

NOTE

l The operation and configuration of Hall effect sensors is reserved for special applications. Consult with Moog if needed.

# 6.5.4 Sin/Cos / TTL X7

# 6.5.4.1 TTL encoder

Ch1: TTL(3) - TTL signals

TTL encoders are ...

- a. ... ... usually pure incremental encoders without an absolute value interface.
- b. In this case, P 540[0] - ENC_CH1_Abs must be set to OFF(0). ... ... in a few exceptional cases, incremental encoders with an SSI absolute value interface. In this case, P 540[0] - ENC_CH1_Abs must be accordingly set to SSI(1) (SSI_CONT(4) in special cases), so that it will be possible to read the absolute encoder position for the absolute value initialization routine once during the initialization phase.

# 6.5.4.1.1 Pure TTL incremental encoder

Set P 505[0] - ENC_CH1_Sel to TTL(3) and P 540[0] - ENC_CH1_Abs to OFF(0) when using pure TTL encoders, i.e. encoders without an absolute value interface but with a TTL zero pulse.

Linear TTL encoders are run as rotary encoders. For linear motor operation, P 542 [0] - ENC_CH1_Lines and the encoder gearing (see the “Encoder gearing” section) are used to establish the ratio for the linear motor’s pole pair subdivision (North-North) for commutation. 1 x North-North corresponds to one revolution from Lines. In this case, the motor pole pair number must be set to 1. Moreover, P 553[0] - ENC_CH1_PeriodLen is not used in this case.

The TTL interface accepts various TTL signal types, which can be selected using P 558[0] - ENC_CH1_TTL_SignalType:

- (0)AF_B - A/B tracks (forward counting, X4 encoding) - AB
- (1)AR_B - A/B tracks (reverse counting, X4 encoding) - AB_inv
- (2)ABDFN - A: Clock (falling edge), B: Direction (1 = positive) - PulseDir
- (3)ABDRP - A: Clock (rising edge), B: Direction (1 = negative) - PulseDir_inv
- (4)reserved

A maximum interpolation period, in ms (milliseconds), can be configured for the TTL interface using P 601[0] - ENC_CH1_Period. Within this context, Period is the maximum time of “no activity” since the last TTL counter event:

- Period = 0: Function disabled (default)
- Period > 0 (=n ms): If no counter event is registered in n ms, the speed will be set to 0.

# Zero pulse

There is no parameter for activating the zero pulse evaluation here, as this evaluation is controlled exclusively based on the homing mode (see Section ""Homing"" on page 249). However, setting P 541[0] - ENC_CH1_NpTest to 1 provides a test mode that can be used during commissioning in order to be able to activate the zero pulse evaluation even without homing. Scope signals 1014 and 1016 can be used to view a received zero pulse within this context. This test mode must be disabled during normal operation (P 541[0] = 0).

# Commutation

Motor operation with pure incremental encoders needs for the auto commutation function to be enabled without fail. For details see Section ""Synchronous motor auto commutation"" on page 156.

# 6.5.4.1.2 TTL incremental encoder with SSI absolute value interface

See Section ""Sin/Cos incremental encoders with absolute value interface"" on page 65 and in special Section ""SSI absolute value interface"" on page 67.

MSD ServoDrive - DeviceHelp

# 6 Encoder

MOOG ID No.:CB40859-001 Date:11/2020 MSD ServoDrive - DeviceHelp 64

|ID|Index Name|Unit|Description|
|---|---|---|---|
|505|0|ENC_CH1_Sel = 3|Encoder selection set to TTL(3)|
|510|0|ENC_CH1_Num|Encoder gearing: Numerator Ch1: SINCOS(1) - Sin/Cos signals|
|511|0|ENC_CH1_Denom|Encoder gearing: Denominator|
|540|0|ENC_CH1_Abs|Selection of absolute value interface Sin/Cos encoders can ...|
|541|0|ENC_CH1_NpTest|ENC CH1, TEST-MODE: Index pulse signal(s) to Scope|
|542|0|ENC_CH1_lines|Number of lines (Sin/Cos / TTL encoders) a. Be pure incremental encoders without an absolute value interface. In this|
|558|0|ENC_CH1_TTL_SignalType|Channel 1: TTL signal selection case, P 540[0] - ENC_CH1_Abs must be set to OFF(0).|
|601|0|ENC_CH1_Period|Maximum period of interpolation (TTL encoder)|
|616|0|ENC_CH1_CycleCount|Sampling cycle in: n x 125 μ (microseconds) b. Be incremental encoders with an absolute value interface. In this case,|

Table 6.8: Parameters for Channel 1 (X7) - TTL encoder

ENC_CH1_Abs must be accordingly set to SSI(1), EnDat(2), HIPER(3) or, in special cases, SSI_CONT(4) so that it will be possible to read the absolute encoder position for the absolute value initialization routine once during the initialization phase.

# 6.5.4.2.1 Purely Sin/Cos incremental encoders

To run these encoders as purely incremental encoders with a zero pulse on encoder channel Ch1 (without an absolute value interface), the approach is basically the same as for purely TTL operation (see Section ""TTL encoder"" on page 63). The same parameters apply.

However, there are the following differences:

- a. There are no different signal types for the Sin/Cos signal (always 1 Vss for cosine and sine).
- b. The zero pulse is the analog zero pulse typical of Sin/Cos encoders (see the “Connection for high-resolution encoders” section in the operation manual MSD Servo Drive Single-Axis System, for example).

# 6.5.4.2.2 Linear Sin/Cos

|ID|Index Name|Unit|Description|
|---|---|---|---|
|542|ENC_CH1_lines| |Number of Lines (Sin/Cos / TTL encoders)|
|543|ENC_CH1_MultiT| |Number of MultiTurn bits (absolute encoder)|
|544|ENC_CH1_SingleT| |Number of SingleTurn bits (absolute encoder)|
|545|ENC_CH1_Code| |Code selection (SSI encoder) (binary, gray)|
|546|ENC_CH1_Mode| |Mode selection (SSI encoder)|
|547|ENC_CH1_MTBase| |Definition of point of discontinuity in multi-turn range|
|548|ENC_CH1_MTEnable| |Enable MultiTurn use (negative logic, 1=MToff)|
|549|ENC_CH1_Corr| |Signal correction type|
|550|ENC_CH1_CorrVal|0-4|Signal correction values|
|551|ENC_CH1_EncObsMin| |Encoder monitoring minimum, sqrt(a^2+b^2)|
|552|ENC_CH1_AbsEncStatus| |Error and status codes (absolute encoder)|

# 6.5.4.2.3 Signal correction (GPOC)

|ID|Index Name|Unit|Description|
|---|---|---|---|
|553|ENC_CH1_PeriodLen|nm|Length of signal period (Sin/Cos linear encoder)|
|554|ENC_CH1_DigitalResolution|nm|Length of one increment (linear absolute encoder)|
|555|ENC_CH1_Info| |Encoder information|
|616|ENC_CH1_CycleCount| |Sampling cycle in: n x 125 μ (microseconds)|
|610|ENC_CH1_NominalIncrementA| |Sign. Nominal increment A (distance coded abs. per. encoder)|
|611|ENC_CH1_NominalIncrementB| |Sign. Nominal increment B (distance coded abs. per. encoder)|
|1900|ENC_ETS| |ETS mode, electronic nameplate|

# 6.5.4.2.4 Sin/Cos incremental encoders with absolute value interface

The following table lists the parameters for cyclical Sin/Cos operation on encoder channel Ch 1 with one-time reading of the absolute encoder position via the absolute value interface, i.e. without a zero pulse:

|ID|Index Name|Unit|Description|
|---|---|---|---|
|505|ENC_CH1_Sel|1|Encoder selection set to SINCOS(1)|
|510|ENC_CH1_Num| |Encoder gearing: Numerator|
|511|ENC_CH1_Denom| |Encoder gearing: Denominator|
|540|ENC_CH1_Abs| |Absolute value interface selection (one-time reading)|

Table 6.9: Parameters for channel 1 (X7) - Sin/Cos encoder

The Sel, Num, Denom, Abs, Lines, MultiT, SingleT and CorrVal parameters are self-explanatory.

The Code and Mode parameters are described in Section ""SSI (cyclical) X7"" on page 69.

P 547[0] - ENC_CH1_MTBase = Minimum MultiTurn position

The MTBase parameter is used to set a position in the multi-turn encoder’s travel path that defines the point of discontinuity (overflow/underflow) for the absolute value initialization (that is, the “multi-turn basis”). Assuming a bipolar encoder measuring range, all position values that fall below MTBase will be shifted “up” (the whole MT range will be added to them once).

MOOG ID No.:CB40859-001 Date:11/2020

MSD ServoDrive - DeviceHelp

# 6 Encoder

MOOG ID No.:CB40859-001 Date:11/2020

method makes it possible to place the point of discontinuity at any point within the encoder’s entire measuring range. By default, MTBase will be set to the lowest possible value for the parameter, i.e. reliably outside of the encoder’s value range: In this case, the full bipolar range will remain unaffected, as values will never fall below this MTBase threshold (see Section ""Channel 1: Interface X7"" on page 59).

- P 548[0] - ENC_CH1_MTEnable = MultiTurn as SingleTurn
- The MTEnable parameter makes it possible to use multi-turn encoders as single-turn encoders for test purposes. Negative logic: Default MTEnable = 0 means ""MultiTurn-Enable ON"".

P 549[0] - ENC_CH1_Corr = Signal correction type
- The GPOC routine used for track signal correction purposes for sine/cosine signals is used to compensate for systematic errors. The routine is controlled with the Corr and CorrVal parameters (see Section ""Signal correction GPOC (Gain Phase Offset Correction)"" on page 74).

P 551[0] - ENC_CH1_EncObsMin = Encoder monitoring minimum, sqrt (a^2+b^2)
- The parameter EncObsMin is used to scale the Sin/Cos wire break monitoring and represents the “downwards threshold” for an error message. The default setting is 0.2, corresponding to approx. ",What distinguishes the P 549[0] - ENC_CH1_Corr parameter in Sin/Cos encoder setups?,A5,The parameter is essential for optimizing Sin/Cos encoder performance through targeted signal error correction.,1.6171875,1.5390625,3.25,1.46875,0.1484375
30,msd_servo_drive.txt,20,02f242a213dfa4411d028ce46dfba16a3f97395fa25788fcbaea1715e779d934,"), consult with your project supervisor or the Helpline provided by Moog before using any special SSI protocol modes.

# 6.5.2 EnDat (cyclical) X7

Ch1: ENDAT(4) - Cyclical EnDat (2.1 or 2.2) EnDat is a digital encoder interface developed by HEIDENHAIN. For more details, please visit www.heidenhain.de and go to ►Documentation ►Fundamentals ►Interfaces ►EnDat 2.2.

The software versions required to run the EnDat encoder interface are the standard software versions for the MSD Servo Drive and MSD Single-Axis Servo Drive Compact.

MOOG ID No.:CB40859-001 Date:11/2020

# 6 Encoder

NOTE

- Please note the limitations that apply when running EnDat and SSI encoders (see Section ""Limiting for EnDat and SSI"" on page 52).

When using linear encoders, P 554[0] - ENC_CH1_DigitalResolution is used instead of P 543[0] - ENC_CH1_MultiT and P 544[0] - ENC_CH1_SingleT (which are used for rotary encoders). The values will be read from the EnDat encoder and written to the aforementioned parameters.

- P 543[0] - ENC_CH1_MultiT
- The number ""n"" of multiturn bits defines the measuring range in 2n increments per encoder shaft revolution; maximum travel until overflow; maximum travel within which the absolute value initialization can be unambiguous. In the case of single-turn encoders, MultiT = 0.
- P 544[0] - ENC_CH1_SingleT
- The number ""n"" of single-turn bits corresponds to the encoder’s digital resolution in 2n increments per encoder shaft revolution.
- P 554[0] - ENC_CH1_DigitalResolution
- This is the length of an increment, in nanometres, of the encoder’s digitally transmitted position value. This value is read from the EnDat linear head.

In the case of linear encoders, the number n of transmitted position bits from the encoder will be found in SingleT only! 2n * DigitalResolution yields the maximum travel in nanometres (for the encoder head).

P 640 - ENC_ENDAT is intended for additional information, but is normally not needed. This parameter does not have a Ch1 or Ch3 prefix for the encoder channel in the name, as it applies to both encoder channels. Although usually not needed, the parameter is helpful or required in the following cases:

1. Special EnDat encoder with diagnostics for evaluation
In this case, the valuation numbers from the encoder are read cyclically via additional information. Only the valuation numbers that the encoder supports.

# 6 Encoder

MOOG ID No.:CB40859-001 Date:11/2020

will be read. During the initialization process, the system will read the encoder to determine which valuation numbers it supports. When P 640[0] - ENDAT_Select = 1, the function will be enabled in the controller and the internal diagnostics in the EnDaT encoder will be enabled as well. The EnDat encoder will keep this setting even after being powered off. To explicitly disable the internal diagnostics in the EnDat encoder, set P 640[0] - ENDAT_Select to 2.

# 2. Evaluation of internal warnings

In this scenario, certain internal warnings from the encoder will be read from the encoder via additional information. Only the warnings that both the encoder and the Servo Drive’s software support will be read. During the initialization process, the system will read the encoder to determine which warnings it supports. When P 640[0] - ENDAT_Select = 3, the function will be enabled in the controller.

**Table 6.7: Channel 1 encoder configuration (X7) - EnDat parameters**
|ID|Index Name|Unit|Description|
|---|---|---|---|
|505|0 ENC_CH1_Sel|= ENDAT(4)| |
|543|0 ENC_CH1_MultiT|Number of MultiTurn bits (absolute encoder)| |
|544|0 ENC_CH1_SingleT|Number of SingleTurn bits (absolute encoder)| |
|547|0 ENC_CH1_MTBase|Definition of point of discontinuity in multi-turn range| |
|548|0 ENC_CH1_MTEnable|1: Use Multi-turn encoder as a single-turn encoder| |
|616|0 ENC_CH1_CycleCount|Position encoder sampling cycle (n x 125 μsec)| |
|598|0 ENC_CH1_Position|inc|Position encoder channel 1|
|554|0 ENC_CH1_|nm|Length of one increment (linear absolute encoder)|
|640|ENC_ENDAT| |EnDat additional (additional information)|
|640|0 ENDAT_Select|0=off|EnDat function selection, 1/2=diagnosis on/off, 3=warnings, FF=lock|
|640|1 ENDAT_DiagCount|u16|count new diagnosis block header|
|640|2 ENDAT_BWZ_1|lowbyte|vn1: incremental track|
|640|3 ENDAT_BWZ_3|lowbyte|vn3: absolute track|
|640|4 ENDAT_BWZ_4|lowbyte|vn4: position value formation|
|640|5 ENDAT_Status| |EnDat additional status output|
|640|6 ENDAT_Z1_Sel| |EnDat additional information 1 type selection|

**Table 6.7: Overwrite Channel 1 encoder configuration (X7) - EnDat parameters (continue)**
|ID|Index Name|Unit|Description|
|---|---|---|---|
|640|7 ENDAT_Z1_1| |Z1 info: dword 1|
|640|8 ENDAT_Z1_2| |Z1 info: dword 2|
|640|9 ENDAT_Z1_3| |Z1 info: dword 3|
|640|10 ENDAT_Z1_4| |Z1 info: dword 4|
|640|11 ENDAT_Z2_Sel| |EnDat additional information 2 type selection|
|640|12 ENDAT_Z2_1| |Z2 info: dword 1|
|640|13 ENDAT_Z2_2| |Z2 info: dword 2|
|640|14 ENDAT_Z2_3| |Z2 info: dword 3|
|640|15 ENDAT_Z2_4| |Z2 info: dword 4|
|640|16 ENDAT_Mode1|0=off|EnDat additional mode 1 selection|
|640|17 ENDAT_Mode2| |EnDat additional mode 2 selection|
|640|18 ENDAT_Mode3| |EnDat additional mode 3 selection|
|640|19 ENDAT_Mode4| |EnDat additional mode 4 selection|
|640|20 ENDAT_res1| |reserved 1|
|640|21 ENDAT_res2| |reserved 2|
|640|22 ENDAT_res3| |reserved 3|
|640|23 ENDAT_HwSyncStop|0=SyncOn|EnDat cyclic hw sync, stop/start 1/0|
|640|24 ENDAT_CyclCount| |call counter of cyclic function|
|640|25 ENDAT_BWZ_Supported| |vn supported (bit3=vn4, bit2=vn3, bit0=vn1)|
|640|26 ENDAT_BWZ1_| |vn1: bits[7..0] threshold level, bits[31..16]|
|640|27 ThresholdLevel| |how often number|
|640|28 ENDAT_BWZ3_| |vn3: bits[7..0] threshold level, bits[31..16]|
|640|29 ThresholdLevel| |how often number|
|640|30 ENDAT_BWZ4_| |vn4: bits[7..0] threshold level, bits[31..16]|
|640|31 ThresholdLevel| |how often number|
|640|32 ENDAT_BWZ_TEST_| |vn: bits[15..12] 'F', bits[11..8] vn.no., bits [7..0] vn overwrite value|

# 6.5.3 Hall sensor X7

Ch1: HALL(5) - Digital hall signals

Ch1: HALL_TTL(7) - Digital hall signals

NOTE

l The operation and configuration of Hall effect sensors is reserved for special applications. Consult with Moog if needed.

# 6.5.4 Sin/Cos / TTL X7

# 6.5.4.1 TTL encoder

Ch1: TTL(3) - TTL signals

TTL encoders are ...

- a. ... ... usually pure incremental encoders without an absolute value interface.
- b. In this case, P 540[0] - ENC_CH1_Abs must be set to OFF(0). ... ... in a few exceptional cases, incremental encoders with an SSI absolute value interface. In this case, P 540[0] - ENC_CH1_Abs must be accordingly set to SSI(1) (SSI_CONT(4) in special cases), so that it will be possible to read the absolute encoder position for the absolute value initialization routine once during the initialization phase.

# 6.5.4.1.1 Pure TTL incremental encoder

Set P 505[0] - ENC_CH1_Sel to TTL(3) and P 540[0] - ENC_CH1_Abs to OFF(0) when using pure TTL encoders, i.e. encoders without an absolute value interface but with a TTL zero pulse.

Linear TTL encoders are run as rotary encoders. For linear motor operation, P 542 [0] - ENC_CH1_Lines and the encoder gearing (see the “Encoder gearing” section) are used to establish the ratio for the linear motor’s pole pair subdivision (North-North) for commutation. 1 x North-North corresponds to one revolution from Lines. In this case, the motor pole pair number must be set to 1. Moreover, P 553[0] - ENC_CH1_PeriodLen is not used in this case.

The TTL interface accepts various TTL signal types, which can be selected using P 558[0] - ENC_CH1_TTL_SignalType:

- (0)AF_B - A/B tracks (forward counting, X4 encoding) - AB
- (1)AR_B - A/B tracks (reverse counting, X4 encoding) - AB_inv
- (2)ABDFN - A: Clock (falling edge), B: Direction (1 = positive) - PulseDir
- (3)ABDRP - A: Clock (rising edge), B: Direction (1 = negative) - PulseDir_inv
- (4)reserved

A maximum interpolation period, in ms (milliseconds), can be configured for the TTL interface using P 601[0] - ENC_CH1_Period. Within this context, Period is the maximum time of “no activity” since the last TTL counter event:

- Period = 0: Function disabled (default)
- Period > 0 (=n ms): If no counter event is registered in n ms, the speed will be set to 0.

# Zero pulse

There is no parameter for activating the zero pulse evaluation here, as this evaluation is controlled exclusively based on the homing mode (see Section ""Homing"" on page 249). However, setting P 541[0] - ENC_CH1_NpTest to 1 provides a test mode that can be used during commissioning in order to be able to activate the zero pulse evaluation even without homing. Scope signals 1014 and 1016 can be used to view a received zero pulse within this context. This test mode must be disabled during normal operation (P 541[0] = 0).

# Commutation

Motor operation with pure incremental encoders needs for the auto commutation function to be enabled without fail. For details see Section ""Synchronous motor auto commutation"" on page 156.

# 6.5.4.1.2 TTL incremental encoder with SSI absolute value interface

See Section ""Sin/Cos incremental encoders with absolute value interface"" on page 65 and in special Section ""SSI absolute value interface"" on page 67.

MSD ServoDrive - DeviceHelp

# 6 Encoder

MOOG ID No.:CB40859-001 Date:11/2020 MSD ServoDrive - DeviceHelp 64

|ID|Index Name|Unit|Description|
|---|---|---|---|
|505|0|ENC_CH1_Sel = 3|Encoder selection set to TTL(3)|
|510|0|ENC_CH1_Num|Encoder gearing: Numerator Ch1: SINCOS(1) - Sin/Cos signals|
|511|0|ENC_CH1_Denom|Encoder gearing: Denominator|
|540|0|ENC_CH1_Abs|Selection of absolute value interface Sin/Cos encoders can ...|
|541|0|ENC_CH1_NpTest|ENC CH1, TEST-MODE: Index pulse signal(s) to Scope|
|542|0|ENC_CH1_lines|Number of lines (Sin/Cos / TTL encoders) a. Be pure incremental encoders without an absolute value interface. In this|
|558|0|ENC_CH1_TTL_SignalType|Channel 1: TTL signal selection case, P 540[0] - ENC_CH1_Abs must be set to OFF(0).|
|601|0|ENC_CH1_Period|Maximum period of interpolation (TTL encoder)|
|616|0|ENC_CH1_CycleCount|Sampling cycle in: n x 125 μ (microseconds) b. Be incremental encoders with an absolute value interface. In this case,|

Table 6.8: Parameters for Channel 1 (X7) - TTL encoder

ENC_CH1_Abs must be accordingly set to SSI(1), EnDat(2), HIPER(3) or, in special cases, SSI_CONT(4) so that it will be possible to read the absolute encoder position for the absolute value initialization routine once during the initialization phase.

# 6.5.4.2.1 Purely Sin/Cos incremental encoders

To run these encoders as purely incremental encoders with a zero pulse on encoder channel Ch1 (without an absolute value interface), the approach is basically the same as for purely TTL operation (see Section ""TTL encoder"" on page 63). The same parameters apply.

However, there are the following differences:

- a. There are no different signal types for the Sin/Cos signal (always 1 Vss for cosine and sine).
- b. The zero pulse is the analog zero pulse typical of Sin/Cos encoders (see the “Connection for high-resolution encoders” section in the operation manual MSD Servo Drive Single-Axis System, for example).

# 6.5.4.2.2 Linear Sin/Cos

|ID|Index Name|Unit|Description|
|---|---|---|---|
|542|ENC_CH1_lines| |Number of Lines (Sin/Cos / TTL encoders)|
|543|ENC_CH1_MultiT| |Number of MultiTurn bits (absolute encoder)|
|544|ENC_CH1_SingleT| |Number of SingleTurn bits (absolute encoder)|
|545|ENC_CH1_Code| |Code selection (SSI encoder) (binary, gray)|
|546|ENC_CH1_Mode| |Mode selection (SSI encoder)|
|547|ENC_CH1_MTBase| |Definition of point of discontinuity in multi-turn range|
|548|ENC_CH1_MTEnable| |Enable MultiTurn use (negative logic, 1=MToff)|
|549|ENC_CH1_Corr| |Signal correction type|
|550|ENC_CH1_CorrVal|0-4|Signal correction values|
|551|ENC_CH1_EncObsMin| |Encoder monitoring minimum, sqrt(a^2+b^2)|
|552|ENC_CH1_AbsEncStatus| |Error and status codes (absolute encoder)|

# 6.5.4.2.3 Signal correction (GPOC)

|ID|Index Name|Unit|Description|
|---|---|---|---|
|553|ENC_CH1_PeriodLen|nm|Length of signal period (Sin/Cos linear encoder)|
|554|ENC_CH1_DigitalResolution|nm|Length of one increment (linear absolute encoder)|
|555|ENC_CH1_Info| |Encoder information|
|616|ENC_CH1_CycleCount| |Sampling cycle in: n x 125 μ (microseconds)|
|610|ENC_CH1_NominalIncrementA| |Sign. Nominal increment A (distance coded abs. per. encoder)|
|611|ENC_CH1_NominalIncrementB| |Sign. Nominal increment B (distance coded abs. per. encoder)|
|1900|ENC_ETS| |ETS mode, electronic nameplate|

# 6.5.4.2.4 Sin/Cos incremental encoders with absolute value interface

The following table lists the parameters for cyclical Sin/Cos operation on encoder channel Ch 1 with one-time reading of the absolute encoder position via the absolute value interface, i.e. without a zero pulse:

|ID|Index Name|Unit|Description|
|---|---|---|---|
|505|ENC_CH1_Sel|1|Encoder selection set to SINCOS(1)|
|510|ENC_CH1_Num| |Encoder gearing: Numerator|
|511|ENC_CH1_Denom| |Encoder gearing: Denominator|
|540|ENC_CH1_Abs| |Absolute value interface selection (one-time reading)|

Table 6.9: Parameters for channel 1 (X7) - Sin/Cos encoder

The Sel, Num, Denom, Abs, Lines, MultiT, SingleT and CorrVal parameters are self-explanatory.

The Code and Mode parameters are described in Section ""SSI (cyclical) X7"" on page 69.

P 547[0] - ENC_CH1_MTBase = Minimum MultiTurn position

The MTBase parameter is used to set a position in the multi-turn encoder’s travel path that defines the point of discontinuity (overflow/underflow) for the absolute value initialization (that is, the “multi-turn basis”). Assuming a bipolar encoder measuring range, all position values that fall below MTBase will be shifted “up” (the whole MT range will be added to them once).

MOOG ID No.:CB40859-001 Date:11/2020

MSD ServoDrive - DeviceHelp

# 6 Encoder

MOOG ID No.:CB40859-001 Date:11/2020

method makes it possible to place the point of discontinuity at any point within the encoder’s entire measuring range. By default, MTBase will be set to the lowest possible value for the parameter, i.e. reliably outside of the encoder’s value range: In this case, the full bipolar range will remain unaffected, as values will never fall below this MTBase threshold (see Section ""Channel 1: Interface X7"" on page 59).

- P 548[0] - ENC_CH1_MTEnable = MultiTurn as SingleTurn
- The MTEnable parameter makes it possible to use multi-turn encoders as single-turn encoders for test purposes. Negative logic: Default MTEnable = 0 means ""MultiTurn-Enable ON"".

P 549[0] - ENC_CH1_Corr = Signal correction type
- The GPOC routine used for track signal correction purposes for sine/cosine signals is used to compensate for systematic errors. The routine is controlled with the Corr and CorrVal parameters (see Section ""Signal correction GPOC (Gain Phase Offset Correction)"" on page 74).

P 551[0] - ENC_CH1_EncObsMin = Encoder monitoring minimum, sqrt (a^2+b^2)
- The parameter EncObsMin is used to scale the Sin/Cos wire break monitoring and represents the “downwards threshold” for an error message. The default setting is 0.2, corresponding to approx. ",What is the function of the P 547[0] - ENC_CH1_MTBase parameter in encoder configuration?,A1,"P 547[0] defines the point of discontinuity in the multi-turn encoder's travel path, adjusting how overflow/underflow positions are handled.",1.8828125,1.875,3.265625,1.765625,0.61328125
31,msd_servo_drive.txt,20,02f242a213dfa4411d028ce46dfba16a3f97395fa25788fcbaea1715e779d934,"), consult with your project supervisor or the Helpline provided by Moog before using any special SSI protocol modes.

# 6.5.2 EnDat (cyclical) X7

Ch1: ENDAT(4) - Cyclical EnDat (2.1 or 2.2) EnDat is a digital encoder interface developed by HEIDENHAIN. For more details, please visit www.heidenhain.de and go to ►Documentation ►Fundamentals ►Interfaces ►EnDat 2.2.

The software versions required to run the EnDat encoder interface are the standard software versions for the MSD Servo Drive and MSD Single-Axis Servo Drive Compact.

MOOG ID No.:CB40859-001 Date:11/2020

# 6 Encoder

NOTE

- Please note the limitations that apply when running EnDat and SSI encoders (see Section ""Limiting for EnDat and SSI"" on page 52).

When using linear encoders, P 554[0] - ENC_CH1_DigitalResolution is used instead of P 543[0] - ENC_CH1_MultiT and P 544[0] - ENC_CH1_SingleT (which are used for rotary encoders). The values will be read from the EnDat encoder and written to the aforementioned parameters.

- P 543[0] - ENC_CH1_MultiT
- The number ""n"" of multiturn bits defines the measuring range in 2n increments per encoder shaft revolution; maximum travel until overflow; maximum travel within which the absolute value initialization can be unambiguous. In the case of single-turn encoders, MultiT = 0.
- P 544[0] - ENC_CH1_SingleT
- The number ""n"" of single-turn bits corresponds to the encoder’s digital resolution in 2n increments per encoder shaft revolution.
- P 554[0] - ENC_CH1_DigitalResolution
- This is the length of an increment, in nanometres, of the encoder’s digitally transmitted position value. This value is read from the EnDat linear head.

In the case of linear encoders, the number n of transmitted position bits from the encoder will be found in SingleT only! 2n * DigitalResolution yields the maximum travel in nanometres (for the encoder head).

P 640 - ENC_ENDAT is intended for additional information, but is normally not needed. This parameter does not have a Ch1 or Ch3 prefix for the encoder channel in the name, as it applies to both encoder channels. Although usually not needed, the parameter is helpful or required in the following cases:

1. Special EnDat encoder with diagnostics for evaluation
In this case, the valuation numbers from the encoder are read cyclically via additional information. Only the valuation numbers that the encoder supports.

# 6 Encoder

MOOG ID No.:CB40859-001 Date:11/2020

will be read. During the initialization process, the system will read the encoder to determine which valuation numbers it supports. When P 640[0] - ENDAT_Select = 1, the function will be enabled in the controller and the internal diagnostics in the EnDaT encoder will be enabled as well. The EnDat encoder will keep this setting even after being powered off. To explicitly disable the internal diagnostics in the EnDat encoder, set P 640[0] - ENDAT_Select to 2.

# 2. Evaluation of internal warnings

In this scenario, certain internal warnings from the encoder will be read from the encoder via additional information. Only the warnings that both the encoder and the Servo Drive’s software support will be read. During the initialization process, the system will read the encoder to determine which warnings it supports. When P 640[0] - ENDAT_Select = 3, the function will be enabled in the controller.

**Table 6.7: Channel 1 encoder configuration (X7) - EnDat parameters**
|ID|Index Name|Unit|Description|
|---|---|---|---|
|505|0 ENC_CH1_Sel|= ENDAT(4)| |
|543|0 ENC_CH1_MultiT|Number of MultiTurn bits (absolute encoder)| |
|544|0 ENC_CH1_SingleT|Number of SingleTurn bits (absolute encoder)| |
|547|0 ENC_CH1_MTBase|Definition of point of discontinuity in multi-turn range| |
|548|0 ENC_CH1_MTEnable|1: Use Multi-turn encoder as a single-turn encoder| |
|616|0 ENC_CH1_CycleCount|Position encoder sampling cycle (n x 125 μsec)| |
|598|0 ENC_CH1_Position|inc|Position encoder channel 1|
|554|0 ENC_CH1_|nm|Length of one increment (linear absolute encoder)|
|640|ENC_ENDAT| |EnDat additional (additional information)|
|640|0 ENDAT_Select|0=off|EnDat function selection, 1/2=diagnosis on/off, 3=warnings, FF=lock|
|640|1 ENDAT_DiagCount|u16|count new diagnosis block header|
|640|2 ENDAT_BWZ_1|lowbyte|vn1: incremental track|
|640|3 ENDAT_BWZ_3|lowbyte|vn3: absolute track|
|640|4 ENDAT_BWZ_4|lowbyte|vn4: position value formation|
|640|5 ENDAT_Status| |EnDat additional status output|
|640|6 ENDAT_Z1_Sel| |EnDat additional information 1 type selection|

**Table 6.7: Overwrite Channel 1 encoder configuration (X7) - EnDat parameters (continue)**
|ID|Index Name|Unit|Description|
|---|---|---|---|
|640|7 ENDAT_Z1_1| |Z1 info: dword 1|
|640|8 ENDAT_Z1_2| |Z1 info: dword 2|
|640|9 ENDAT_Z1_3| |Z1 info: dword 3|
|640|10 ENDAT_Z1_4| |Z1 info: dword 4|
|640|11 ENDAT_Z2_Sel| |EnDat additional information 2 type selection|
|640|12 ENDAT_Z2_1| |Z2 info: dword 1|
|640|13 ENDAT_Z2_2| |Z2 info: dword 2|
|640|14 ENDAT_Z2_3| |Z2 info: dword 3|
|640|15 ENDAT_Z2_4| |Z2 info: dword 4|
|640|16 ENDAT_Mode1|0=off|EnDat additional mode 1 selection|
|640|17 ENDAT_Mode2| |EnDat additional mode 2 selection|
|640|18 ENDAT_Mode3| |EnDat additional mode 3 selection|
|640|19 ENDAT_Mode4| |EnDat additional mode 4 selection|
|640|20 ENDAT_res1| |reserved 1|
|640|21 ENDAT_res2| |reserved 2|
|640|22 ENDAT_res3| |reserved 3|
|640|23 ENDAT_HwSyncStop|0=SyncOn|EnDat cyclic hw sync, stop/start 1/0|
|640|24 ENDAT_CyclCount| |call counter of cyclic function|
|640|25 ENDAT_BWZ_Supported| |vn supported (bit3=vn4, bit2=vn3, bit0=vn1)|
|640|26 ENDAT_BWZ1_| |vn1: bits[7..0] threshold level, bits[31..16]|
|640|27 ThresholdLevel| |how often number|
|640|28 ENDAT_BWZ3_| |vn3: bits[7..0] threshold level, bits[31..16]|
|640|29 ThresholdLevel| |how often number|
|640|30 ENDAT_BWZ4_| |vn4: bits[7..0] threshold level, bits[31..16]|
|640|31 ThresholdLevel| |how often number|
|640|32 ENDAT_BWZ_TEST_| |vn: bits[15..12] 'F', bits[11..8] vn.no., bits [7..0] vn overwrite value|

# 6.5.3 Hall sensor X7

Ch1: HALL(5) - Digital hall signals

Ch1: HALL_TTL(7) - Digital hall signals

NOTE

l The operation and configuration of Hall effect sensors is reserved for special applications. Consult with Moog if needed.

# 6.5.4 Sin/Cos / TTL X7

# 6.5.4.1 TTL encoder

Ch1: TTL(3) - TTL signals

TTL encoders are ...

- a. ... ... usually pure incremental encoders without an absolute value interface.
- b. In this case, P 540[0] - ENC_CH1_Abs must be set to OFF(0). ... ... in a few exceptional cases, incremental encoders with an SSI absolute value interface. In this case, P 540[0] - ENC_CH1_Abs must be accordingly set to SSI(1) (SSI_CONT(4) in special cases), so that it will be possible to read the absolute encoder position for the absolute value initialization routine once during the initialization phase.

# 6.5.4.1.1 Pure TTL incremental encoder

Set P 505[0] - ENC_CH1_Sel to TTL(3) and P 540[0] - ENC_CH1_Abs to OFF(0) when using pure TTL encoders, i.e. encoders without an absolute value interface but with a TTL zero pulse.

Linear TTL encoders are run as rotary encoders. For linear motor operation, P 542 [0] - ENC_CH1_Lines and the encoder gearing (see the “Encoder gearing” section) are used to establish the ratio for the linear motor’s pole pair subdivision (North-North) for commutation. 1 x North-North corresponds to one revolution from Lines. In this case, the motor pole pair number must be set to 1. Moreover, P 553[0] - ENC_CH1_PeriodLen is not used in this case.

The TTL interface accepts various TTL signal types, which can be selected using P 558[0] - ENC_CH1_TTL_SignalType:

- (0)AF_B - A/B tracks (forward counting, X4 encoding) - AB
- (1)AR_B - A/B tracks (reverse counting, X4 encoding) - AB_inv
- (2)ABDFN - A: Clock (falling edge), B: Direction (1 = positive) - PulseDir
- (3)ABDRP - A: Clock (rising edge), B: Direction (1 = negative) - PulseDir_inv
- (4)reserved

A maximum interpolation period, in ms (milliseconds), can be configured for the TTL interface using P 601[0] - ENC_CH1_Period. Within this context, Period is the maximum time of “no activity” since the last TTL counter event:

- Period = 0: Function disabled (default)
- Period > 0 (=n ms): If no counter event is registered in n ms, the speed will be set to 0.

# Zero pulse

There is no parameter for activating the zero pulse evaluation here, as this evaluation is controlled exclusively based on the homing mode (see Section ""Homing"" on page 249). However, setting P 541[0] - ENC_CH1_NpTest to 1 provides a test mode that can be used during commissioning in order to be able to activate the zero pulse evaluation even without homing. Scope signals 1014 and 1016 can be used to view a received zero pulse within this context. This test mode must be disabled during normal operation (P 541[0] = 0).

# Commutation

Motor operation with pure incremental encoders needs for the auto commutation function to be enabled without fail. For details see Section ""Synchronous motor auto commutation"" on page 156.

# 6.5.4.1.2 TTL incremental encoder with SSI absolute value interface

See Section ""Sin/Cos incremental encoders with absolute value interface"" on page 65 and in special Section ""SSI absolute value interface"" on page 67.

MSD ServoDrive - DeviceHelp

# 6 Encoder

MOOG ID No.:CB40859-001 Date:11/2020 MSD ServoDrive - DeviceHelp 64

|ID|Index Name|Unit|Description|
|---|---|---|---|
|505|0|ENC_CH1_Sel = 3|Encoder selection set to TTL(3)|
|510|0|ENC_CH1_Num|Encoder gearing: Numerator Ch1: SINCOS(1) - Sin/Cos signals|
|511|0|ENC_CH1_Denom|Encoder gearing: Denominator|
|540|0|ENC_CH1_Abs|Selection of absolute value interface Sin/Cos encoders can ...|
|541|0|ENC_CH1_NpTest|ENC CH1, TEST-MODE: Index pulse signal(s) to Scope|
|542|0|ENC_CH1_lines|Number of lines (Sin/Cos / TTL encoders) a. Be pure incremental encoders without an absolute value interface. In this|
|558|0|ENC_CH1_TTL_SignalType|Channel 1: TTL signal selection case, P 540[0] - ENC_CH1_Abs must be set to OFF(0).|
|601|0|ENC_CH1_Period|Maximum period of interpolation (TTL encoder)|
|616|0|ENC_CH1_CycleCount|Sampling cycle in: n x 125 μ (microseconds) b. Be incremental encoders with an absolute value interface. In this case,|

Table 6.8: Parameters for Channel 1 (X7) - TTL encoder

ENC_CH1_Abs must be accordingly set to SSI(1), EnDat(2), HIPER(3) or, in special cases, SSI_CONT(4) so that it will be possible to read the absolute encoder position for the absolute value initialization routine once during the initialization phase.

# 6.5.4.2.1 Purely Sin/Cos incremental encoders

To run these encoders as purely incremental encoders with a zero pulse on encoder channel Ch1 (without an absolute value interface), the approach is basically the same as for purely TTL operation (see Section ""TTL encoder"" on page 63). The same parameters apply.

However, there are the following differences:

- a. There are no different signal types for the Sin/Cos signal (always 1 Vss for cosine and sine).
- b. The zero pulse is the analog zero pulse typical of Sin/Cos encoders (see the “Connection for high-resolution encoders” section in the operation manual MSD Servo Drive Single-Axis System, for example).

# 6.5.4.2.2 Linear Sin/Cos

|ID|Index Name|Unit|Description|
|---|---|---|---|
|542|ENC_CH1_lines| |Number of Lines (Sin/Cos / TTL encoders)|
|543|ENC_CH1_MultiT| |Number of MultiTurn bits (absolute encoder)|
|544|ENC_CH1_SingleT| |Number of SingleTurn bits (absolute encoder)|
|545|ENC_CH1_Code| |Code selection (SSI encoder) (binary, gray)|
|546|ENC_CH1_Mode| |Mode selection (SSI encoder)|
|547|ENC_CH1_MTBase| |Definition of point of discontinuity in multi-turn range|
|548|ENC_CH1_MTEnable| |Enable MultiTurn use (negative logic, 1=MToff)|
|549|ENC_CH1_Corr| |Signal correction type|
|550|ENC_CH1_CorrVal|0-4|Signal correction values|
|551|ENC_CH1_EncObsMin| |Encoder monitoring minimum, sqrt(a^2+b^2)|
|552|ENC_CH1_AbsEncStatus| |Error and status codes (absolute encoder)|

# 6.5.4.2.3 Signal correction (GPOC)

|ID|Index Name|Unit|Description|
|---|---|---|---|
|553|ENC_CH1_PeriodLen|nm|Length of signal period (Sin/Cos linear encoder)|
|554|ENC_CH1_DigitalResolution|nm|Length of one increment (linear absolute encoder)|
|555|ENC_CH1_Info| |Encoder information|
|616|ENC_CH1_CycleCount| |Sampling cycle in: n x 125 μ (microseconds)|
|610|ENC_CH1_NominalIncrementA| |Sign. Nominal increment A (distance coded abs. per. encoder)|
|611|ENC_CH1_NominalIncrementB| |Sign. Nominal increment B (distance coded abs. per. encoder)|
|1900|ENC_ETS| |ETS mode, electronic nameplate|

# 6.5.4.2.4 Sin/Cos incremental encoders with absolute value interface

The following table lists the parameters for cyclical Sin/Cos operation on encoder channel Ch 1 with one-time reading of the absolute encoder position via the absolute value interface, i.e. without a zero pulse:

|ID|Index Name|Unit|Description|
|---|---|---|---|
|505|ENC_CH1_Sel|1|Encoder selection set to SINCOS(1)|
|510|ENC_CH1_Num| |Encoder gearing: Numerator|
|511|ENC_CH1_Denom| |Encoder gearing: Denominator|
|540|ENC_CH1_Abs| |Absolute value interface selection (one-time reading)|

Table 6.9: Parameters for channel 1 (X7) - Sin/Cos encoder

The Sel, Num, Denom, Abs, Lines, MultiT, SingleT and CorrVal parameters are self-explanatory.

The Code and Mode parameters are described in Section ""SSI (cyclical) X7"" on page 69.

P 547[0] - ENC_CH1_MTBase = Minimum MultiTurn position

The MTBase parameter is used to set a position in the multi-turn encoder’s travel path that defines the point of discontinuity (overflow/underflow) for the absolute value initialization (that is, the “multi-turn basis”). Assuming a bipolar encoder measuring range, all position values that fall below MTBase will be shifted “up” (the whole MT range will be added to them once).

MOOG ID No.:CB40859-001 Date:11/2020

MSD ServoDrive - DeviceHelp

# 6 Encoder

MOOG ID No.:CB40859-001 Date:11/2020

method makes it possible to place the point of discontinuity at any point within the encoder’s entire measuring range. By default, MTBase will be set to the lowest possible value for the parameter, i.e. reliably outside of the encoder’s value range: In this case, the full bipolar range will remain unaffected, as values will never fall below this MTBase threshold (see Section ""Channel 1: Interface X7"" on page 59).

- P 548[0] - ENC_CH1_MTEnable = MultiTurn as SingleTurn
- The MTEnable parameter makes it possible to use multi-turn encoders as single-turn encoders for test purposes. Negative logic: Default MTEnable = 0 means ""MultiTurn-Enable ON"".

P 549[0] - ENC_CH1_Corr = Signal correction type
- The GPOC routine used for track signal correction purposes for sine/cosine signals is used to compensate for systematic errors. The routine is controlled with the Corr and CorrVal parameters (see Section ""Signal correction GPOC (Gain Phase Offset Correction)"" on page 74).

P 551[0] - ENC_CH1_EncObsMin = Encoder monitoring minimum, sqrt (a^2+b^2)
- The parameter EncObsMin is used to scale the Sin/Cos wire break monitoring and represents the “downwards threshold” for an error message. The default setting is 0.2, corresponding to approx. ",What is the function of the P 547[0] - ENC_CH1_MTBase parameter in encoder configuration?,A2,"This parameter sets the multi-turn basis, shifting values below MTBase up to maintain a continuous position range across the encoder's travel.",2.09375,2.0625,3.453125,1.6953125,0.609375
32,msd_servo_drive.txt,20,02f242a213dfa4411d028ce46dfba16a3f97395fa25788fcbaea1715e779d934,"), consult with your project supervisor or the Helpline provided by Moog before using any special SSI protocol modes.

# 6.5.2 EnDat (cyclical) X7

Ch1: ENDAT(4) - Cyclical EnDat (2.1 or 2.2) EnDat is a digital encoder interface developed by HEIDENHAIN. For more details, please visit www.heidenhain.de and go to ►Documentation ►Fundamentals ►Interfaces ►EnDat 2.2.

The software versions required to run the EnDat encoder interface are the standard software versions for the MSD Servo Drive and MSD Single-Axis Servo Drive Compact.

MOOG ID No.:CB40859-001 Date:11/2020

# 6 Encoder

NOTE

- Please note the limitations that apply when running EnDat and SSI encoders (see Section ""Limiting for EnDat and SSI"" on page 52).

When using linear encoders, P 554[0] - ENC_CH1_DigitalResolution is used instead of P 543[0] - ENC_CH1_MultiT and P 544[0] - ENC_CH1_SingleT (which are used for rotary encoders). The values will be read from the EnDat encoder and written to the aforementioned parameters.

- P 543[0] - ENC_CH1_MultiT
- The number ""n"" of multiturn bits defines the measuring range in 2n increments per encoder shaft revolution; maximum travel until overflow; maximum travel within which the absolute value initialization can be unambiguous. In the case of single-turn encoders, MultiT = 0.
- P 544[0] - ENC_CH1_SingleT
- The number ""n"" of single-turn bits corresponds to the encoder’s digital resolution in 2n increments per encoder shaft revolution.
- P 554[0] - ENC_CH1_DigitalResolution
- This is the length of an increment, in nanometres, of the encoder’s digitally transmitted position value. This value is read from the EnDat linear head.

In the case of linear encoders, the number n of transmitted position bits from the encoder will be found in SingleT only! 2n * DigitalResolution yields the maximum travel in nanometres (for the encoder head).

P 640 - ENC_ENDAT is intended for additional information, but is normally not needed. This parameter does not have a Ch1 or Ch3 prefix for the encoder channel in the name, as it applies to both encoder channels. Although usually not needed, the parameter is helpful or required in the following cases:

1. Special EnDat encoder with diagnostics for evaluation
In this case, the valuation numbers from the encoder are read cyclically via additional information. Only the valuation numbers that the encoder supports.

# 6 Encoder

MOOG ID No.:CB40859-001 Date:11/2020

will be read. During the initialization process, the system will read the encoder to determine which valuation numbers it supports. When P 640[0] - ENDAT_Select = 1, the function will be enabled in the controller and the internal diagnostics in the EnDaT encoder will be enabled as well. The EnDat encoder will keep this setting even after being powered off. To explicitly disable the internal diagnostics in the EnDat encoder, set P 640[0] - ENDAT_Select to 2.

# 2. Evaluation of internal warnings

In this scenario, certain internal warnings from the encoder will be read from the encoder via additional information. Only the warnings that both the encoder and the Servo Drive’s software support will be read. During the initialization process, the system will read the encoder to determine which warnings it supports. When P 640[0] - ENDAT_Select = 3, the function will be enabled in the controller.

**Table 6.7: Channel 1 encoder configuration (X7) - EnDat parameters**
|ID|Index Name|Unit|Description|
|---|---|---|---|
|505|0 ENC_CH1_Sel|= ENDAT(4)| |
|543|0 ENC_CH1_MultiT|Number of MultiTurn bits (absolute encoder)| |
|544|0 ENC_CH1_SingleT|Number of SingleTurn bits (absolute encoder)| |
|547|0 ENC_CH1_MTBase|Definition of point of discontinuity in multi-turn range| |
|548|0 ENC_CH1_MTEnable|1: Use Multi-turn encoder as a single-turn encoder| |
|616|0 ENC_CH1_CycleCount|Position encoder sampling cycle (n x 125 μsec)| |
|598|0 ENC_CH1_Position|inc|Position encoder channel 1|
|554|0 ENC_CH1_|nm|Length of one increment (linear absolute encoder)|
|640|ENC_ENDAT| |EnDat additional (additional information)|
|640|0 ENDAT_Select|0=off|EnDat function selection, 1/2=diagnosis on/off, 3=warnings, FF=lock|
|640|1 ENDAT_DiagCount|u16|count new diagnosis block header|
|640|2 ENDAT_BWZ_1|lowbyte|vn1: incremental track|
|640|3 ENDAT_BWZ_3|lowbyte|vn3: absolute track|
|640|4 ENDAT_BWZ_4|lowbyte|vn4: position value formation|
|640|5 ENDAT_Status| |EnDat additional status output|
|640|6 ENDAT_Z1_Sel| |EnDat additional information 1 type selection|

**Table 6.7: Overwrite Channel 1 encoder configuration (X7) - EnDat parameters (continue)**
|ID|Index Name|Unit|Description|
|---|---|---|---|
|640|7 ENDAT_Z1_1| |Z1 info: dword 1|
|640|8 ENDAT_Z1_2| |Z1 info: dword 2|
|640|9 ENDAT_Z1_3| |Z1 info: dword 3|
|640|10 ENDAT_Z1_4| |Z1 info: dword 4|
|640|11 ENDAT_Z2_Sel| |EnDat additional information 2 type selection|
|640|12 ENDAT_Z2_1| |Z2 info: dword 1|
|640|13 ENDAT_Z2_2| |Z2 info: dword 2|
|640|14 ENDAT_Z2_3| |Z2 info: dword 3|
|640|15 ENDAT_Z2_4| |Z2 info: dword 4|
|640|16 ENDAT_Mode1|0=off|EnDat additional mode 1 selection|
|640|17 ENDAT_Mode2| |EnDat additional mode 2 selection|
|640|18 ENDAT_Mode3| |EnDat additional mode 3 selection|
|640|19 ENDAT_Mode4| |EnDat additional mode 4 selection|
|640|20 ENDAT_res1| |reserved 1|
|640|21 ENDAT_res2| |reserved 2|
|640|22 ENDAT_res3| |reserved 3|
|640|23 ENDAT_HwSyncStop|0=SyncOn|EnDat cyclic hw sync, stop/start 1/0|
|640|24 ENDAT_CyclCount| |call counter of cyclic function|
|640|25 ENDAT_BWZ_Supported| |vn supported (bit3=vn4, bit2=vn3, bit0=vn1)|
|640|26 ENDAT_BWZ1_| |vn1: bits[7..0] threshold level, bits[31..16]|
|640|27 ThresholdLevel| |how often number|
|640|28 ENDAT_BWZ3_| |vn3: bits[7..0] threshold level, bits[31..16]|
|640|29 ThresholdLevel| |how often number|
|640|30 ENDAT_BWZ4_| |vn4: bits[7..0] threshold level, bits[31..16]|
|640|31 ThresholdLevel| |how often number|
|640|32 ENDAT_BWZ_TEST_| |vn: bits[15..12] 'F', bits[11..8] vn.no., bits [7..0] vn overwrite value|

# 6.5.3 Hall sensor X7

Ch1: HALL(5) - Digital hall signals

Ch1: HALL_TTL(7) - Digital hall signals

NOTE

l The operation and configuration of Hall effect sensors is reserved for special applications. Consult with Moog if needed.

# 6.5.4 Sin/Cos / TTL X7

# 6.5.4.1 TTL encoder

Ch1: TTL(3) - TTL signals

TTL encoders are ...

- a. ... ... usually pure incremental encoders without an absolute value interface.
- b. In this case, P 540[0] - ENC_CH1_Abs must be set to OFF(0). ... ... in a few exceptional cases, incremental encoders with an SSI absolute value interface. In this case, P 540[0] - ENC_CH1_Abs must be accordingly set to SSI(1) (SSI_CONT(4) in special cases), so that it will be possible to read the absolute encoder position for the absolute value initialization routine once during the initialization phase.

# 6.5.4.1.1 Pure TTL incremental encoder

Set P 505[0] - ENC_CH1_Sel to TTL(3) and P 540[0] - ENC_CH1_Abs to OFF(0) when using pure TTL encoders, i.e. encoders without an absolute value interface but with a TTL zero pulse.

Linear TTL encoders are run as rotary encoders. For linear motor operation, P 542 [0] - ENC_CH1_Lines and the encoder gearing (see the “Encoder gearing” section) are used to establish the ratio for the linear motor’s pole pair subdivision (North-North) for commutation. 1 x North-North corresponds to one revolution from Lines. In this case, the motor pole pair number must be set to 1. Moreover, P 553[0] - ENC_CH1_PeriodLen is not used in this case.

The TTL interface accepts various TTL signal types, which can be selected using P 558[0] - ENC_CH1_TTL_SignalType:

- (0)AF_B - A/B tracks (forward counting, X4 encoding) - AB
- (1)AR_B - A/B tracks (reverse counting, X4 encoding) - AB_inv
- (2)ABDFN - A: Clock (falling edge), B: Direction (1 = positive) - PulseDir
- (3)ABDRP - A: Clock (rising edge), B: Direction (1 = negative) - PulseDir_inv
- (4)reserved

A maximum interpolation period, in ms (milliseconds), can be configured for the TTL interface using P 601[0] - ENC_CH1_Period. Within this context, Period is the maximum time of “no activity” since the last TTL counter event:

- Period = 0: Function disabled (default)
- Period > 0 (=n ms): If no counter event is registered in n ms, the speed will be set to 0.

# Zero pulse

There is no parameter for activating the zero pulse evaluation here, as this evaluation is controlled exclusively based on the homing mode (see Section ""Homing"" on page 249). However, setting P 541[0] - ENC_CH1_NpTest to 1 provides a test mode that can be used during commissioning in order to be able to activate the zero pulse evaluation even without homing. Scope signals 1014 and 1016 can be used to view a received zero pulse within this context. This test mode must be disabled during normal operation (P 541[0] = 0).

# Commutation

Motor operation with pure incremental encoders needs for the auto commutation function to be enabled without fail. For details see Section ""Synchronous motor auto commutation"" on page 156.

# 6.5.4.1.2 TTL incremental encoder with SSI absolute value interface

See Section ""Sin/Cos incremental encoders with absolute value interface"" on page 65 and in special Section ""SSI absolute value interface"" on page 67.

MSD ServoDrive - DeviceHelp

# 6 Encoder

MOOG ID No.:CB40859-001 Date:11/2020 MSD ServoDrive - DeviceHelp 64

|ID|Index Name|Unit|Description|
|---|---|---|---|
|505|0|ENC_CH1_Sel = 3|Encoder selection set to TTL(3)|
|510|0|ENC_CH1_Num|Encoder gearing: Numerator Ch1: SINCOS(1) - Sin/Cos signals|
|511|0|ENC_CH1_Denom|Encoder gearing: Denominator|
|540|0|ENC_CH1_Abs|Selection of absolute value interface Sin/Cos encoders can ...|
|541|0|ENC_CH1_NpTest|ENC CH1, TEST-MODE: Index pulse signal(s) to Scope|
|542|0|ENC_CH1_lines|Number of lines (Sin/Cos / TTL encoders) a. Be pure incremental encoders without an absolute value interface. In this|
|558|0|ENC_CH1_TTL_SignalType|Channel 1: TTL signal selection case, P 540[0] - ENC_CH1_Abs must be set to OFF(0).|
|601|0|ENC_CH1_Period|Maximum period of interpolation (TTL encoder)|
|616|0|ENC_CH1_CycleCount|Sampling cycle in: n x 125 μ (microseconds) b. Be incremental encoders with an absolute value interface. In this case,|

Table 6.8: Parameters for Channel 1 (X7) - TTL encoder

ENC_CH1_Abs must be accordingly set to SSI(1), EnDat(2), HIPER(3) or, in special cases, SSI_CONT(4) so that it will be possible to read the absolute encoder position for the absolute value initialization routine once during the initialization phase.

# 6.5.4.2.1 Purely Sin/Cos incremental encoders

To run these encoders as purely incremental encoders with a zero pulse on encoder channel Ch1 (without an absolute value interface), the approach is basically the same as for purely TTL operation (see Section ""TTL encoder"" on page 63). The same parameters apply.

However, there are the following differences:

- a. There are no different signal types for the Sin/Cos signal (always 1 Vss for cosine and sine).
- b. The zero pulse is the analog zero pulse typical of Sin/Cos encoders (see the “Connection for high-resolution encoders” section in the operation manual MSD Servo Drive Single-Axis System, for example).

# 6.5.4.2.2 Linear Sin/Cos

|ID|Index Name|Unit|Description|
|---|---|---|---|
|542|ENC_CH1_lines| |Number of Lines (Sin/Cos / TTL encoders)|
|543|ENC_CH1_MultiT| |Number of MultiTurn bits (absolute encoder)|
|544|ENC_CH1_SingleT| |Number of SingleTurn bits (absolute encoder)|
|545|ENC_CH1_Code| |Code selection (SSI encoder) (binary, gray)|
|546|ENC_CH1_Mode| |Mode selection (SSI encoder)|
|547|ENC_CH1_MTBase| |Definition of point of discontinuity in multi-turn range|
|548|ENC_CH1_MTEnable| |Enable MultiTurn use (negative logic, 1=MToff)|
|549|ENC_CH1_Corr| |Signal correction type|
|550|ENC_CH1_CorrVal|0-4|Signal correction values|
|551|ENC_CH1_EncObsMin| |Encoder monitoring minimum, sqrt(a^2+b^2)|
|552|ENC_CH1_AbsEncStatus| |Error and status codes (absolute encoder)|

# 6.5.4.2.3 Signal correction (GPOC)

|ID|Index Name|Unit|Description|
|---|---|---|---|
|553|ENC_CH1_PeriodLen|nm|Length of signal period (Sin/Cos linear encoder)|
|554|ENC_CH1_DigitalResolution|nm|Length of one increment (linear absolute encoder)|
|555|ENC_CH1_Info| |Encoder information|
|616|ENC_CH1_CycleCount| |Sampling cycle in: n x 125 μ (microseconds)|
|610|ENC_CH1_NominalIncrementA| |Sign. Nominal increment A (distance coded abs. per. encoder)|
|611|ENC_CH1_NominalIncrementB| |Sign. Nominal increment B (distance coded abs. per. encoder)|
|1900|ENC_ETS| |ETS mode, electronic nameplate|

# 6.5.4.2.4 Sin/Cos incremental encoders with absolute value interface

The following table lists the parameters for cyclical Sin/Cos operation on encoder channel Ch 1 with one-time reading of the absolute encoder position via the absolute value interface, i.e. without a zero pulse:

|ID|Index Name|Unit|Description|
|---|---|---|---|
|505|ENC_CH1_Sel|1|Encoder selection set to SINCOS(1)|
|510|ENC_CH1_Num| |Encoder gearing: Numerator|
|511|ENC_CH1_Denom| |Encoder gearing: Denominator|
|540|ENC_CH1_Abs| |Absolute value interface selection (one-time reading)|

Table 6.9: Parameters for channel 1 (X7) - Sin/Cos encoder

The Sel, Num, Denom, Abs, Lines, MultiT, SingleT and CorrVal parameters are self-explanatory.

The Code and Mode parameters are described in Section ""SSI (cyclical) X7"" on page 69.

P 547[0] - ENC_CH1_MTBase = Minimum MultiTurn position

The MTBase parameter is used to set a position in the multi-turn encoder’s travel path that defines the point of discontinuity (overflow/underflow) for the absolute value initialization (that is, the “multi-turn basis”). Assuming a bipolar encoder measuring range, all position values that fall below MTBase will be shifted “up” (the whole MT range will be added to them once).

MOOG ID No.:CB40859-001 Date:11/2020

MSD ServoDrive - DeviceHelp

# 6 Encoder

MOOG ID No.:CB40859-001 Date:11/2020

method makes it possible to place the point of discontinuity at any point within the encoder’s entire measuring range. By default, MTBase will be set to the lowest possible value for the parameter, i.e. reliably outside of the encoder’s value range: In this case, the full bipolar range will remain unaffected, as values will never fall below this MTBase threshold (see Section ""Channel 1: Interface X7"" on page 59).

- P 548[0] - ENC_CH1_MTEnable = MultiTurn as SingleTurn
- The MTEnable parameter makes it possible to use multi-turn encoders as single-turn encoders for test purposes. Negative logic: Default MTEnable = 0 means ""MultiTurn-Enable ON"".

P 549[0] - ENC_CH1_Corr = Signal correction type
- The GPOC routine used for track signal correction purposes for sine/cosine signals is used to compensate for systematic errors. The routine is controlled with the Corr and CorrVal parameters (see Section ""Signal correction GPOC (Gain Phase Offset Correction)"" on page 74).

P 551[0] - ENC_CH1_EncObsMin = Encoder monitoring minimum, sqrt (a^2+b^2)
- The parameter EncObsMin is used to scale the Sin/Cos wire break monitoring and represents the “downwards threshold” for an error message. The default setting is 0.2, corresponding to approx. ",What is the function of the P 547[0] - ENC_CH1_MTBase parameter in encoder configuration?,A3,"It allows customization of the overflow point within the encoder's measuring range, ensuring seamless position tracking.",2.265625,2.203125,3.4375,1.7421875,0.625
33,msd_servo_drive.txt,20,02f242a213dfa4411d028ce46dfba16a3f97395fa25788fcbaea1715e779d934,"), consult with your project supervisor or the Helpline provided by Moog before using any special SSI protocol modes.

# 6.5.2 EnDat (cyclical) X7

Ch1: ENDAT(4) - Cyclical EnDat (2.1 or 2.2) EnDat is a digital encoder interface developed by HEIDENHAIN. For more details, please visit www.heidenhain.de and go to ►Documentation ►Fundamentals ►Interfaces ►EnDat 2.2.

The software versions required to run the EnDat encoder interface are the standard software versions for the MSD Servo Drive and MSD Single-Axis Servo Drive Compact.

MOOG ID No.:CB40859-001 Date:11/2020

# 6 Encoder

NOTE

- Please note the limitations that apply when running EnDat and SSI encoders (see Section ""Limiting for EnDat and SSI"" on page 52).

When using linear encoders, P 554[0] - ENC_CH1_DigitalResolution is used instead of P 543[0] - ENC_CH1_MultiT and P 544[0] - ENC_CH1_SingleT (which are used for rotary encoders). The values will be read from the EnDat encoder and written to the aforementioned parameters.

- P 543[0] - ENC_CH1_MultiT
- The number ""n"" of multiturn bits defines the measuring range in 2n increments per encoder shaft revolution; maximum travel until overflow; maximum travel within which the absolute value initialization can be unambiguous. In the case of single-turn encoders, MultiT = 0.
- P 544[0] - ENC_CH1_SingleT
- The number ""n"" of single-turn bits corresponds to the encoder’s digital resolution in 2n increments per encoder shaft revolution.
- P 554[0] - ENC_CH1_DigitalResolution
- This is the length of an increment, in nanometres, of the encoder’s digitally transmitted position value. This value is read from the EnDat linear head.

In the case of linear encoders, the number n of transmitted position bits from the encoder will be found in SingleT only! 2n * DigitalResolution yields the maximum travel in nanometres (for the encoder head).

P 640 - ENC_ENDAT is intended for additional information, but is normally not needed. This parameter does not have a Ch1 or Ch3 prefix for the encoder channel in the name, as it applies to both encoder channels. Although usually not needed, the parameter is helpful or required in the following cases:

1. Special EnDat encoder with diagnostics for evaluation
In this case, the valuation numbers from the encoder are read cyclically via additional information. Only the valuation numbers that the encoder supports.

# 6 Encoder

MOOG ID No.:CB40859-001 Date:11/2020

will be read. During the initialization process, the system will read the encoder to determine which valuation numbers it supports. When P 640[0] - ENDAT_Select = 1, the function will be enabled in the controller and the internal diagnostics in the EnDaT encoder will be enabled as well. The EnDat encoder will keep this setting even after being powered off. To explicitly disable the internal diagnostics in the EnDat encoder, set P 640[0] - ENDAT_Select to 2.

# 2. Evaluation of internal warnings

In this scenario, certain internal warnings from the encoder will be read from the encoder via additional information. Only the warnings that both the encoder and the Servo Drive’s software support will be read. During the initialization process, the system will read the encoder to determine which warnings it supports. When P 640[0] - ENDAT_Select = 3, the function will be enabled in the controller.

**Table 6.7: Channel 1 encoder configuration (X7) - EnDat parameters**
|ID|Index Name|Unit|Description|
|---|---|---|---|
|505|0 ENC_CH1_Sel|= ENDAT(4)| |
|543|0 ENC_CH1_MultiT|Number of MultiTurn bits (absolute encoder)| |
|544|0 ENC_CH1_SingleT|Number of SingleTurn bits (absolute encoder)| |
|547|0 ENC_CH1_MTBase|Definition of point of discontinuity in multi-turn range| |
|548|0 ENC_CH1_MTEnable|1: Use Multi-turn encoder as a single-turn encoder| |
|616|0 ENC_CH1_CycleCount|Position encoder sampling cycle (n x 125 μsec)| |
|598|0 ENC_CH1_Position|inc|Position encoder channel 1|
|554|0 ENC_CH1_|nm|Length of one increment (linear absolute encoder)|
|640|ENC_ENDAT| |EnDat additional (additional information)|
|640|0 ENDAT_Select|0=off|EnDat function selection, 1/2=diagnosis on/off, 3=warnings, FF=lock|
|640|1 ENDAT_DiagCount|u16|count new diagnosis block header|
|640|2 ENDAT_BWZ_1|lowbyte|vn1: incremental track|
|640|3 ENDAT_BWZ_3|lowbyte|vn3: absolute track|
|640|4 ENDAT_BWZ_4|lowbyte|vn4: position value formation|
|640|5 ENDAT_Status| |EnDat additional status output|
|640|6 ENDAT_Z1_Sel| |EnDat additional information 1 type selection|

**Table 6.7: Overwrite Channel 1 encoder configuration (X7) - EnDat parameters (continue)**
|ID|Index Name|Unit|Description|
|---|---|---|---|
|640|7 ENDAT_Z1_1| |Z1 info: dword 1|
|640|8 ENDAT_Z1_2| |Z1 info: dword 2|
|640|9 ENDAT_Z1_3| |Z1 info: dword 3|
|640|10 ENDAT_Z1_4| |Z1 info: dword 4|
|640|11 ENDAT_Z2_Sel| |EnDat additional information 2 type selection|
|640|12 ENDAT_Z2_1| |Z2 info: dword 1|
|640|13 ENDAT_Z2_2| |Z2 info: dword 2|
|640|14 ENDAT_Z2_3| |Z2 info: dword 3|
|640|15 ENDAT_Z2_4| |Z2 info: dword 4|
|640|16 ENDAT_Mode1|0=off|EnDat additional mode 1 selection|
|640|17 ENDAT_Mode2| |EnDat additional mode 2 selection|
|640|18 ENDAT_Mode3| |EnDat additional mode 3 selection|
|640|19 ENDAT_Mode4| |EnDat additional mode 4 selection|
|640|20 ENDAT_res1| |reserved 1|
|640|21 ENDAT_res2| |reserved 2|
|640|22 ENDAT_res3| |reserved 3|
|640|23 ENDAT_HwSyncStop|0=SyncOn|EnDat cyclic hw sync, stop/start 1/0|
|640|24 ENDAT_CyclCount| |call counter of cyclic function|
|640|25 ENDAT_BWZ_Supported| |vn supported (bit3=vn4, bit2=vn3, bit0=vn1)|
|640|26 ENDAT_BWZ1_| |vn1: bits[7..0] threshold level, bits[31..16]|
|640|27 ThresholdLevel| |how often number|
|640|28 ENDAT_BWZ3_| |vn3: bits[7..0] threshold level, bits[31..16]|
|640|29 ThresholdLevel| |how often number|
|640|30 ENDAT_BWZ4_| |vn4: bits[7..0] threshold level, bits[31..16]|
|640|31 ThresholdLevel| |how often number|
|640|32 ENDAT_BWZ_TEST_| |vn: bits[15..12] 'F', bits[11..8] vn.no., bits [7..0] vn overwrite value|

# 6.5.3 Hall sensor X7

Ch1: HALL(5) - Digital hall signals

Ch1: HALL_TTL(7) - Digital hall signals

NOTE

l The operation and configuration of Hall effect sensors is reserved for special applications. Consult with Moog if needed.

# 6.5.4 Sin/Cos / TTL X7

# 6.5.4.1 TTL encoder

Ch1: TTL(3) - TTL signals

TTL encoders are ...

- a. ... ... usually pure incremental encoders without an absolute value interface.
- b. In this case, P 540[0] - ENC_CH1_Abs must be set to OFF(0). ... ... in a few exceptional cases, incremental encoders with an SSI absolute value interface. In this case, P 540[0] - ENC_CH1_Abs must be accordingly set to SSI(1) (SSI_CONT(4) in special cases), so that it will be possible to read the absolute encoder position for the absolute value initialization routine once during the initialization phase.

# 6.5.4.1.1 Pure TTL incremental encoder

Set P 505[0] - ENC_CH1_Sel to TTL(3) and P 540[0] - ENC_CH1_Abs to OFF(0) when using pure TTL encoders, i.e. encoders without an absolute value interface but with a TTL zero pulse.

Linear TTL encoders are run as rotary encoders. For linear motor operation, P 542 [0] - ENC_CH1_Lines and the encoder gearing (see the “Encoder gearing” section) are used to establish the ratio for the linear motor’s pole pair subdivision (North-North) for commutation. 1 x North-North corresponds to one revolution from Lines. In this case, the motor pole pair number must be set to 1. Moreover, P 553[0] - ENC_CH1_PeriodLen is not used in this case.

The TTL interface accepts various TTL signal types, which can be selected using P 558[0] - ENC_CH1_TTL_SignalType:

- (0)AF_B - A/B tracks (forward counting, X4 encoding) - AB
- (1)AR_B - A/B tracks (reverse counting, X4 encoding) - AB_inv
- (2)ABDFN - A: Clock (falling edge), B: Direction (1 = positive) - PulseDir
- (3)ABDRP - A: Clock (rising edge), B: Direction (1 = negative) - PulseDir_inv
- (4)reserved

A maximum interpolation period, in ms (milliseconds), can be configured for the TTL interface using P 601[0] - ENC_CH1_Period. Within this context, Period is the maximum time of “no activity” since the last TTL counter event:

- Period = 0: Function disabled (default)
- Period > 0 (=n ms): If no counter event is registered in n ms, the speed will be set to 0.

# Zero pulse

There is no parameter for activating the zero pulse evaluation here, as this evaluation is controlled exclusively based on the homing mode (see Section ""Homing"" on page 249). However, setting P 541[0] - ENC_CH1_NpTest to 1 provides a test mode that can be used during commissioning in order to be able to activate the zero pulse evaluation even without homing. Scope signals 1014 and 1016 can be used to view a received zero pulse within this context. This test mode must be disabled during normal operation (P 541[0] = 0).

# Commutation

Motor operation with pure incremental encoders needs for the auto commutation function to be enabled without fail. For details see Section ""Synchronous motor auto commutation"" on page 156.

# 6.5.4.1.2 TTL incremental encoder with SSI absolute value interface

See Section ""Sin/Cos incremental encoders with absolute value interface"" on page 65 and in special Section ""SSI absolute value interface"" on page 67.

MSD ServoDrive - DeviceHelp

# 6 Encoder

MOOG ID No.:CB40859-001 Date:11/2020 MSD ServoDrive - DeviceHelp 64

|ID|Index Name|Unit|Description|
|---|---|---|---|
|505|0|ENC_CH1_Sel = 3|Encoder selection set to TTL(3)|
|510|0|ENC_CH1_Num|Encoder gearing: Numerator Ch1: SINCOS(1) - Sin/Cos signals|
|511|0|ENC_CH1_Denom|Encoder gearing: Denominator|
|540|0|ENC_CH1_Abs|Selection of absolute value interface Sin/Cos encoders can ...|
|541|0|ENC_CH1_NpTest|ENC CH1, TEST-MODE: Index pulse signal(s) to Scope|
|542|0|ENC_CH1_lines|Number of lines (Sin/Cos / TTL encoders) a. Be pure incremental encoders without an absolute value interface. In this|
|558|0|ENC_CH1_TTL_SignalType|Channel 1: TTL signal selection case, P 540[0] - ENC_CH1_Abs must be set to OFF(0).|
|601|0|ENC_CH1_Period|Maximum period of interpolation (TTL encoder)|
|616|0|ENC_CH1_CycleCount|Sampling cycle in: n x 125 μ (microseconds) b. Be incremental encoders with an absolute value interface. In this case,|

Table 6.8: Parameters for Channel 1 (X7) - TTL encoder

ENC_CH1_Abs must be accordingly set to SSI(1), EnDat(2), HIPER(3) or, in special cases, SSI_CONT(4) so that it will be possible to read the absolute encoder position for the absolute value initialization routine once during the initialization phase.

# 6.5.4.2.1 Purely Sin/Cos incremental encoders

To run these encoders as purely incremental encoders with a zero pulse on encoder channel Ch1 (without an absolute value interface), the approach is basically the same as for purely TTL operation (see Section ""TTL encoder"" on page 63). The same parameters apply.

However, there are the following differences:

- a. There are no different signal types for the Sin/Cos signal (always 1 Vss for cosine and sine).
- b. The zero pulse is the analog zero pulse typical of Sin/Cos encoders (see the “Connection for high-resolution encoders” section in the operation manual MSD Servo Drive Single-Axis System, for example).

# 6.5.4.2.2 Linear Sin/Cos

|ID|Index Name|Unit|Description|
|---|---|---|---|
|542|ENC_CH1_lines| |Number of Lines (Sin/Cos / TTL encoders)|
|543|ENC_CH1_MultiT| |Number of MultiTurn bits (absolute encoder)|
|544|ENC_CH1_SingleT| |Number of SingleTurn bits (absolute encoder)|
|545|ENC_CH1_Code| |Code selection (SSI encoder) (binary, gray)|
|546|ENC_CH1_Mode| |Mode selection (SSI encoder)|
|547|ENC_CH1_MTBase| |Definition of point of discontinuity in multi-turn range|
|548|ENC_CH1_MTEnable| |Enable MultiTurn use (negative logic, 1=MToff)|
|549|ENC_CH1_Corr| |Signal correction type|
|550|ENC_CH1_CorrVal|0-4|Signal correction values|
|551|ENC_CH1_EncObsMin| |Encoder monitoring minimum, sqrt(a^2+b^2)|
|552|ENC_CH1_AbsEncStatus| |Error and status codes (absolute encoder)|

# 6.5.4.2.3 Signal correction (GPOC)

|ID|Index Name|Unit|Description|
|---|---|---|---|
|553|ENC_CH1_PeriodLen|nm|Length of signal period (Sin/Cos linear encoder)|
|554|ENC_CH1_DigitalResolution|nm|Length of one increment (linear absolute encoder)|
|555|ENC_CH1_Info| |Encoder information|
|616|ENC_CH1_CycleCount| |Sampling cycle in: n x 125 μ (microseconds)|
|610|ENC_CH1_NominalIncrementA| |Sign. Nominal increment A (distance coded abs. per. encoder)|
|611|ENC_CH1_NominalIncrementB| |Sign. Nominal increment B (distance coded abs. per. encoder)|
|1900|ENC_ETS| |ETS mode, electronic nameplate|

# 6.5.4.2.4 Sin/Cos incremental encoders with absolute value interface

The following table lists the parameters for cyclical Sin/Cos operation on encoder channel Ch 1 with one-time reading of the absolute encoder position via the absolute value interface, i.e. without a zero pulse:

|ID|Index Name|Unit|Description|
|---|---|---|---|
|505|ENC_CH1_Sel|1|Encoder selection set to SINCOS(1)|
|510|ENC_CH1_Num| |Encoder gearing: Numerator|
|511|ENC_CH1_Denom| |Encoder gearing: Denominator|
|540|ENC_CH1_Abs| |Absolute value interface selection (one-time reading)|

Table 6.9: Parameters for channel 1 (X7) - Sin/Cos encoder

The Sel, Num, Denom, Abs, Lines, MultiT, SingleT and CorrVal parameters are self-explanatory.

The Code and Mode parameters are described in Section ""SSI (cyclical) X7"" on page 69.

P 547[0] - ENC_CH1_MTBase = Minimum MultiTurn position

The MTBase parameter is used to set a position in the multi-turn encoder’s travel path that defines the point of discontinuity (overflow/underflow) for the absolute value initialization (that is, the “multi-turn basis”). Assuming a bipolar encoder measuring range, all position values that fall below MTBase will be shifted “up” (the whole MT range will be added to them once).

MOOG ID No.:CB40859-001 Date:11/2020

MSD ServoDrive - DeviceHelp

# 6 Encoder

MOOG ID No.:CB40859-001 Date:11/2020

method makes it possible to place the point of discontinuity at any point within the encoder’s entire measuring range. By default, MTBase will be set to the lowest possible value for the parameter, i.e. reliably outside of the encoder’s value range: In this case, the full bipolar range will remain unaffected, as values will never fall below this MTBase threshold (see Section ""Channel 1: Interface X7"" on page 59).

- P 548[0] - ENC_CH1_MTEnable = MultiTurn as SingleTurn
- The MTEnable parameter makes it possible to use multi-turn encoders as single-turn encoders for test purposes. Negative logic: Default MTEnable = 0 means ""MultiTurn-Enable ON"".

P 549[0] - ENC_CH1_Corr = Signal correction type
- The GPOC routine used for track signal correction purposes for sine/cosine signals is used to compensate for systematic errors. The routine is controlled with the Corr and CorrVal parameters (see Section ""Signal correction GPOC (Gain Phase Offset Correction)"" on page 74).

P 551[0] - ENC_CH1_EncObsMin = Encoder monitoring minimum, sqrt (a^2+b^2)
- The parameter EncObsMin is used to scale the Sin/Cos wire break monitoring and represents the “downwards threshold” for an error message. The default setting is 0.2, corresponding to approx. ",What is the function of the P 547[0] - ENC_CH1_MTBase parameter in encoder configuration?,A4,"By adjusting P 547[0], users can control where the encoder's position values wrap around, optimizing for specific application needs.",1.984375,1.84375,3.421875,1.640625,0.80078125
34,msd_servo_drive.txt,20,02f242a213dfa4411d028ce46dfba16a3f97395fa25788fcbaea1715e779d934,"), consult with your project supervisor or the Helpline provided by Moog before using any special SSI protocol modes.

# 6.5.2 EnDat (cyclical) X7

Ch1: ENDAT(4) - Cyclical EnDat (2.1 or 2.2) EnDat is a digital encoder interface developed by HEIDENHAIN. For more details, please visit www.heidenhain.de and go to ►Documentation ►Fundamentals ►Interfaces ►EnDat 2.2.

The software versions required to run the EnDat encoder interface are the standard software versions for the MSD Servo Drive and MSD Single-Axis Servo Drive Compact.

MOOG ID No.:CB40859-001 Date:11/2020

# 6 Encoder

NOTE

- Please note the limitations that apply when running EnDat and SSI encoders (see Section ""Limiting for EnDat and SSI"" on page 52).

When using linear encoders, P 554[0] - ENC_CH1_DigitalResolution is used instead of P 543[0] - ENC_CH1_MultiT and P 544[0] - ENC_CH1_SingleT (which are used for rotary encoders). The values will be read from the EnDat encoder and written to the aforementioned parameters.

- P 543[0] - ENC_CH1_MultiT
- The number ""n"" of multiturn bits defines the measuring range in 2n increments per encoder shaft revolution; maximum travel until overflow; maximum travel within which the absolute value initialization can be unambiguous. In the case of single-turn encoders, MultiT = 0.
- P 544[0] - ENC_CH1_SingleT
- The number ""n"" of single-turn bits corresponds to the encoder’s digital resolution in 2n increments per encoder shaft revolution.
- P 554[0] - ENC_CH1_DigitalResolution
- This is the length of an increment, in nanometres, of the encoder’s digitally transmitted position value. This value is read from the EnDat linear head.

In the case of linear encoders, the number n of transmitted position bits from the encoder will be found in SingleT only! 2n * DigitalResolution yields the maximum travel in nanometres (for the encoder head).

P 640 - ENC_ENDAT is intended for additional information, but is normally not needed. This parameter does not have a Ch1 or Ch3 prefix for the encoder channel in the name, as it applies to both encoder channels. Although usually not needed, the parameter is helpful or required in the following cases:

1. Special EnDat encoder with diagnostics for evaluation
In this case, the valuation numbers from the encoder are read cyclically via additional information. Only the valuation numbers that the encoder supports.

# 6 Encoder

MOOG ID No.:CB40859-001 Date:11/2020

will be read. During the initialization process, the system will read the encoder to determine which valuation numbers it supports. When P 640[0] - ENDAT_Select = 1, the function will be enabled in the controller and the internal diagnostics in the EnDaT encoder will be enabled as well. The EnDat encoder will keep this setting even after being powered off. To explicitly disable the internal diagnostics in the EnDat encoder, set P 640[0] - ENDAT_Select to 2.

# 2. Evaluation of internal warnings

In this scenario, certain internal warnings from the encoder will be read from the encoder via additional information. Only the warnings that both the encoder and the Servo Drive’s software support will be read. During the initialization process, the system will read the encoder to determine which warnings it supports. When P 640[0] - ENDAT_Select = 3, the function will be enabled in the controller.

**Table 6.7: Channel 1 encoder configuration (X7) - EnDat parameters**
|ID|Index Name|Unit|Description|
|---|---|---|---|
|505|0 ENC_CH1_Sel|= ENDAT(4)| |
|543|0 ENC_CH1_MultiT|Number of MultiTurn bits (absolute encoder)| |
|544|0 ENC_CH1_SingleT|Number of SingleTurn bits (absolute encoder)| |
|547|0 ENC_CH1_MTBase|Definition of point of discontinuity in multi-turn range| |
|548|0 ENC_CH1_MTEnable|1: Use Multi-turn encoder as a single-turn encoder| |
|616|0 ENC_CH1_CycleCount|Position encoder sampling cycle (n x 125 μsec)| |
|598|0 ENC_CH1_Position|inc|Position encoder channel 1|
|554|0 ENC_CH1_|nm|Length of one increment (linear absolute encoder)|
|640|ENC_ENDAT| |EnDat additional (additional information)|
|640|0 ENDAT_Select|0=off|EnDat function selection, 1/2=diagnosis on/off, 3=warnings, FF=lock|
|640|1 ENDAT_DiagCount|u16|count new diagnosis block header|
|640|2 ENDAT_BWZ_1|lowbyte|vn1: incremental track|
|640|3 ENDAT_BWZ_3|lowbyte|vn3: absolute track|
|640|4 ENDAT_BWZ_4|lowbyte|vn4: position value formation|
|640|5 ENDAT_Status| |EnDat additional status output|
|640|6 ENDAT_Z1_Sel| |EnDat additional information 1 type selection|

**Table 6.7: Overwrite Channel 1 encoder configuration (X7) - EnDat parameters (continue)**
|ID|Index Name|Unit|Description|
|---|---|---|---|
|640|7 ENDAT_Z1_1| |Z1 info: dword 1|
|640|8 ENDAT_Z1_2| |Z1 info: dword 2|
|640|9 ENDAT_Z1_3| |Z1 info: dword 3|
|640|10 ENDAT_Z1_4| |Z1 info: dword 4|
|640|11 ENDAT_Z2_Sel| |EnDat additional information 2 type selection|
|640|12 ENDAT_Z2_1| |Z2 info: dword 1|
|640|13 ENDAT_Z2_2| |Z2 info: dword 2|
|640|14 ENDAT_Z2_3| |Z2 info: dword 3|
|640|15 ENDAT_Z2_4| |Z2 info: dword 4|
|640|16 ENDAT_Mode1|0=off|EnDat additional mode 1 selection|
|640|17 ENDAT_Mode2| |EnDat additional mode 2 selection|
|640|18 ENDAT_Mode3| |EnDat additional mode 3 selection|
|640|19 ENDAT_Mode4| |EnDat additional mode 4 selection|
|640|20 ENDAT_res1| |reserved 1|
|640|21 ENDAT_res2| |reserved 2|
|640|22 ENDAT_res3| |reserved 3|
|640|23 ENDAT_HwSyncStop|0=SyncOn|EnDat cyclic hw sync, stop/start 1/0|
|640|24 ENDAT_CyclCount| |call counter of cyclic function|
|640|25 ENDAT_BWZ_Supported| |vn supported (bit3=vn4, bit2=vn3, bit0=vn1)|
|640|26 ENDAT_BWZ1_| |vn1: bits[7..0] threshold level, bits[31..16]|
|640|27 ThresholdLevel| |how often number|
|640|28 ENDAT_BWZ3_| |vn3: bits[7..0] threshold level, bits[31..16]|
|640|29 ThresholdLevel| |how often number|
|640|30 ENDAT_BWZ4_| |vn4: bits[7..0] threshold level, bits[31..16]|
|640|31 ThresholdLevel| |how often number|
|640|32 ENDAT_BWZ_TEST_| |vn: bits[15..12] 'F', bits[11..8] vn.no., bits [7..0] vn overwrite value|

# 6.5.3 Hall sensor X7

Ch1: HALL(5) - Digital hall signals

Ch1: HALL_TTL(7) - Digital hall signals

NOTE

l The operation and configuration of Hall effect sensors is reserved for special applications. Consult with Moog if needed.

# 6.5.4 Sin/Cos / TTL X7

# 6.5.4.1 TTL encoder

Ch1: TTL(3) - TTL signals

TTL encoders are ...

- a. ... ... usually pure incremental encoders without an absolute value interface.
- b. In this case, P 540[0] - ENC_CH1_Abs must be set to OFF(0). ... ... in a few exceptional cases, incremental encoders with an SSI absolute value interface. In this case, P 540[0] - ENC_CH1_Abs must be accordingly set to SSI(1) (SSI_CONT(4) in special cases), so that it will be possible to read the absolute encoder position for the absolute value initialization routine once during the initialization phase.

# 6.5.4.1.1 Pure TTL incremental encoder

Set P 505[0] - ENC_CH1_Sel to TTL(3) and P 540[0] - ENC_CH1_Abs to OFF(0) when using pure TTL encoders, i.e. encoders without an absolute value interface but with a TTL zero pulse.

Linear TTL encoders are run as rotary encoders. For linear motor operation, P 542 [0] - ENC_CH1_Lines and the encoder gearing (see the “Encoder gearing” section) are used to establish the ratio for the linear motor’s pole pair subdivision (North-North) for commutation. 1 x North-North corresponds to one revolution from Lines. In this case, the motor pole pair number must be set to 1. Moreover, P 553[0] - ENC_CH1_PeriodLen is not used in this case.

The TTL interface accepts various TTL signal types, which can be selected using P 558[0] - ENC_CH1_TTL_SignalType:

- (0)AF_B - A/B tracks (forward counting, X4 encoding) - AB
- (1)AR_B - A/B tracks (reverse counting, X4 encoding) - AB_inv
- (2)ABDFN - A: Clock (falling edge), B: Direction (1 = positive) - PulseDir
- (3)ABDRP - A: Clock (rising edge), B: Direction (1 = negative) - PulseDir_inv
- (4)reserved

A maximum interpolation period, in ms (milliseconds), can be configured for the TTL interface using P 601[0] - ENC_CH1_Period. Within this context, Period is the maximum time of “no activity” since the last TTL counter event:

- Period = 0: Function disabled (default)
- Period > 0 (=n ms): If no counter event is registered in n ms, the speed will be set to 0.

# Zero pulse

There is no parameter for activating the zero pulse evaluation here, as this evaluation is controlled exclusively based on the homing mode (see Section ""Homing"" on page 249). However, setting P 541[0] - ENC_CH1_NpTest to 1 provides a test mode that can be used during commissioning in order to be able to activate the zero pulse evaluation even without homing. Scope signals 1014 and 1016 can be used to view a received zero pulse within this context. This test mode must be disabled during normal operation (P 541[0] = 0).

# Commutation

Motor operation with pure incremental encoders needs for the auto commutation function to be enabled without fail. For details see Section ""Synchronous motor auto commutation"" on page 156.

# 6.5.4.1.2 TTL incremental encoder with SSI absolute value interface

See Section ""Sin/Cos incremental encoders with absolute value interface"" on page 65 and in special Section ""SSI absolute value interface"" on page 67.

MSD ServoDrive - DeviceHelp

# 6 Encoder

MOOG ID No.:CB40859-001 Date:11/2020 MSD ServoDrive - DeviceHelp 64

|ID|Index Name|Unit|Description|
|---|---|---|---|
|505|0|ENC_CH1_Sel = 3|Encoder selection set to TTL(3)|
|510|0|ENC_CH1_Num|Encoder gearing: Numerator Ch1: SINCOS(1) - Sin/Cos signals|
|511|0|ENC_CH1_Denom|Encoder gearing: Denominator|
|540|0|ENC_CH1_Abs|Selection of absolute value interface Sin/Cos encoders can ...|
|541|0|ENC_CH1_NpTest|ENC CH1, TEST-MODE: Index pulse signal(s) to Scope|
|542|0|ENC_CH1_lines|Number of lines (Sin/Cos / TTL encoders) a. Be pure incremental encoders without an absolute value interface. In this|
|558|0|ENC_CH1_TTL_SignalType|Channel 1: TTL signal selection case, P 540[0] - ENC_CH1_Abs must be set to OFF(0).|
|601|0|ENC_CH1_Period|Maximum period of interpolation (TTL encoder)|
|616|0|ENC_CH1_CycleCount|Sampling cycle in: n x 125 μ (microseconds) b. Be incremental encoders with an absolute value interface. In this case,|

Table 6.8: Parameters for Channel 1 (X7) - TTL encoder

ENC_CH1_Abs must be accordingly set to SSI(1), EnDat(2), HIPER(3) or, in special cases, SSI_CONT(4) so that it will be possible to read the absolute encoder position for the absolute value initialization routine once during the initialization phase.

# 6.5.4.2.1 Purely Sin/Cos incremental encoders

To run these encoders as purely incremental encoders with a zero pulse on encoder channel Ch1 (without an absolute value interface), the approach is basically the same as for purely TTL operation (see Section ""TTL encoder"" on page 63). The same parameters apply.

However, there are the following differences:

- a. There are no different signal types for the Sin/Cos signal (always 1 Vss for cosine and sine).
- b. The zero pulse is the analog zero pulse typical of Sin/Cos encoders (see the “Connection for high-resolution encoders” section in the operation manual MSD Servo Drive Single-Axis System, for example).

# 6.5.4.2.2 Linear Sin/Cos

|ID|Index Name|Unit|Description|
|---|---|---|---|
|542|ENC_CH1_lines| |Number of Lines (Sin/Cos / TTL encoders)|
|543|ENC_CH1_MultiT| |Number of MultiTurn bits (absolute encoder)|
|544|ENC_CH1_SingleT| |Number of SingleTurn bits (absolute encoder)|
|545|ENC_CH1_Code| |Code selection (SSI encoder) (binary, gray)|
|546|ENC_CH1_Mode| |Mode selection (SSI encoder)|
|547|ENC_CH1_MTBase| |Definition of point of discontinuity in multi-turn range|
|548|ENC_CH1_MTEnable| |Enable MultiTurn use (negative logic, 1=MToff)|
|549|ENC_CH1_Corr| |Signal correction type|
|550|ENC_CH1_CorrVal|0-4|Signal correction values|
|551|ENC_CH1_EncObsMin| |Encoder monitoring minimum, sqrt(a^2+b^2)|
|552|ENC_CH1_AbsEncStatus| |Error and status codes (absolute encoder)|

# 6.5.4.2.3 Signal correction (GPOC)

|ID|Index Name|Unit|Description|
|---|---|---|---|
|553|ENC_CH1_PeriodLen|nm|Length of signal period (Sin/Cos linear encoder)|
|554|ENC_CH1_DigitalResolution|nm|Length of one increment (linear absolute encoder)|
|555|ENC_CH1_Info| |Encoder information|
|616|ENC_CH1_CycleCount| |Sampling cycle in: n x 125 μ (microseconds)|
|610|ENC_CH1_NominalIncrementA| |Sign. Nominal increment A (distance coded abs. per. encoder)|
|611|ENC_CH1_NominalIncrementB| |Sign. Nominal increment B (distance coded abs. per. encoder)|
|1900|ENC_ETS| |ETS mode, electronic nameplate|

# 6.5.4.2.4 Sin/Cos incremental encoders with absolute value interface

The following table lists the parameters for cyclical Sin/Cos operation on encoder channel Ch 1 with one-time reading of the absolute encoder position via the absolute value interface, i.e. without a zero pulse:

|ID|Index Name|Unit|Description|
|---|---|---|---|
|505|ENC_CH1_Sel|1|Encoder selection set to SINCOS(1)|
|510|ENC_CH1_Num| |Encoder gearing: Numerator|
|511|ENC_CH1_Denom| |Encoder gearing: Denominator|
|540|ENC_CH1_Abs| |Absolute value interface selection (one-time reading)|

Table 6.9: Parameters for channel 1 (X7) - Sin/Cos encoder

The Sel, Num, Denom, Abs, Lines, MultiT, SingleT and CorrVal parameters are self-explanatory.

The Code and Mode parameters are described in Section ""SSI (cyclical) X7"" on page 69.

P 547[0] - ENC_CH1_MTBase = Minimum MultiTurn position

The MTBase parameter is used to set a position in the multi-turn encoder’s travel path that defines the point of discontinuity (overflow/underflow) for the absolute value initialization (that is, the “multi-turn basis”). Assuming a bipolar encoder measuring range, all position values that fall below MTBase will be shifted “up” (the whole MT range will be added to them once).

MOOG ID No.:CB40859-001 Date:11/2020

MSD ServoDrive - DeviceHelp

# 6 Encoder

MOOG ID No.:CB40859-001 Date:11/2020

method makes it possible to place the point of discontinuity at any point within the encoder’s entire measuring range. By default, MTBase will be set to the lowest possible value for the parameter, i.e. reliably outside of the encoder’s value range: In this case, the full bipolar range will remain unaffected, as values will never fall below this MTBase threshold (see Section ""Channel 1: Interface X7"" on page 59).

- P 548[0] - ENC_CH1_MTEnable = MultiTurn as SingleTurn
- The MTEnable parameter makes it possible to use multi-turn encoders as single-turn encoders for test purposes. Negative logic: Default MTEnable = 0 means ""MultiTurn-Enable ON"".

P 549[0] - ENC_CH1_Corr = Signal correction type
- The GPOC routine used for track signal correction purposes for sine/cosine signals is used to compensate for systematic errors. The routine is controlled with the Corr and CorrVal parameters (see Section ""Signal correction GPOC (Gain Phase Offset Correction)"" on page 74).

P 551[0] - ENC_CH1_EncObsMin = Encoder monitoring minimum, sqrt (a^2+b^2)
- The parameter EncObsMin is used to scale the Sin/Cos wire break monitoring and represents the “downwards threshold” for an error message. The default setting is 0.2, corresponding to approx. ",What is the function of the P 547[0] - ENC_CH1_MTBase parameter in encoder configuration?,A5,"The parameter is key for managing the encoder's position continuity, especially in applications requiring precise multi-turn tracking.",2.1875,2.09375,3.5,1.6953125,0.6171875
35,msd_servo_drive.txt,20,02f242a213dfa4411d028ce46dfba16a3f97395fa25788fcbaea1715e779d934,"), consult with your project supervisor or the Helpline provided by Moog before using any special SSI protocol modes.

# 6.5.2 EnDat (cyclical) X7

Ch1: ENDAT(4) - Cyclical EnDat (2.1 or 2.2) EnDat is a digital encoder interface developed by HEIDENHAIN. For more details, please visit www.heidenhain.de and go to ►Documentation ►Fundamentals ►Interfaces ►EnDat 2.2.

The software versions required to run the EnDat encoder interface are the standard software versions for the MSD Servo Drive and MSD Single-Axis Servo Drive Compact.

MOOG ID No.:CB40859-001 Date:11/2020

# 6 Encoder

NOTE

- Please note the limitations that apply when running EnDat and SSI encoders (see Section ""Limiting for EnDat and SSI"" on page 52).

When using linear encoders, P 554[0] - ENC_CH1_DigitalResolution is used instead of P 543[0] - ENC_CH1_MultiT and P 544[0] - ENC_CH1_SingleT (which are used for rotary encoders). The values will be read from the EnDat encoder and written to the aforementioned parameters.

- P 543[0] - ENC_CH1_MultiT
- The number ""n"" of multiturn bits defines the measuring range in 2n increments per encoder shaft revolution; maximum travel until overflow; maximum travel within which the absolute value initialization can be unambiguous. In the case of single-turn encoders, MultiT = 0.
- P 544[0] - ENC_CH1_SingleT
- The number ""n"" of single-turn bits corresponds to the encoder’s digital resolution in 2n increments per encoder shaft revolution.
- P 554[0] - ENC_CH1_DigitalResolution
- This is the length of an increment, in nanometres, of the encoder’s digitally transmitted position value. This value is read from the EnDat linear head.

In the case of linear encoders, the number n of transmitted position bits from the encoder will be found in SingleT only! 2n * DigitalResolution yields the maximum travel in nanometres (for the encoder head).

P 640 - ENC_ENDAT is intended for additional information, but is normally not needed. This parameter does not have a Ch1 or Ch3 prefix for the encoder channel in the name, as it applies to both encoder channels. Although usually not needed, the parameter is helpful or required in the following cases:

1. Special EnDat encoder with diagnostics for evaluation
In this case, the valuation numbers from the encoder are read cyclically via additional information. Only the valuation numbers that the encoder supports.

# 6 Encoder

MOOG ID No.:CB40859-001 Date:11/2020

will be read. During the initialization process, the system will read the encoder to determine which valuation numbers it supports. When P 640[0] - ENDAT_Select = 1, the function will be enabled in the controller and the internal diagnostics in the EnDaT encoder will be enabled as well. The EnDat encoder will keep this setting even after being powered off. To explicitly disable the internal diagnostics in the EnDat encoder, set P 640[0] - ENDAT_Select to 2.

# 2. Evaluation of internal warnings

In this scenario, certain internal warnings from the encoder will be read from the encoder via additional information. Only the warnings that both the encoder and the Servo Drive’s software support will be read. During the initialization process, the system will read the encoder to determine which warnings it supports. When P 640[0] - ENDAT_Select = 3, the function will be enabled in the controller.

**Table 6.7: Channel 1 encoder configuration (X7) - EnDat parameters**
|ID|Index Name|Unit|Description|
|---|---|---|---|
|505|0 ENC_CH1_Sel|= ENDAT(4)| |
|543|0 ENC_CH1_MultiT|Number of MultiTurn bits (absolute encoder)| |
|544|0 ENC_CH1_SingleT|Number of SingleTurn bits (absolute encoder)| |
|547|0 ENC_CH1_MTBase|Definition of point of discontinuity in multi-turn range| |
|548|0 ENC_CH1_MTEnable|1: Use Multi-turn encoder as a single-turn encoder| |
|616|0 ENC_CH1_CycleCount|Position encoder sampling cycle (n x 125 μsec)| |
|598|0 ENC_CH1_Position|inc|Position encoder channel 1|
|554|0 ENC_CH1_|nm|Length of one increment (linear absolute encoder)|
|640|ENC_ENDAT| |EnDat additional (additional information)|
|640|0 ENDAT_Select|0=off|EnDat function selection, 1/2=diagnosis on/off, 3=warnings, FF=lock|
|640|1 ENDAT_DiagCount|u16|count new diagnosis block header|
|640|2 ENDAT_BWZ_1|lowbyte|vn1: incremental track|
|640|3 ENDAT_BWZ_3|lowbyte|vn3: absolute track|
|640|4 ENDAT_BWZ_4|lowbyte|vn4: position value formation|
|640|5 ENDAT_Status| |EnDat additional status output|
|640|6 ENDAT_Z1_Sel| |EnDat additional information 1 type selection|

**Table 6.7: Overwrite Channel 1 encoder configuration (X7) - EnDat parameters (continue)**
|ID|Index Name|Unit|Description|
|---|---|---|---|
|640|7 ENDAT_Z1_1| |Z1 info: dword 1|
|640|8 ENDAT_Z1_2| |Z1 info: dword 2|
|640|9 ENDAT_Z1_3| |Z1 info: dword 3|
|640|10 ENDAT_Z1_4| |Z1 info: dword 4|
|640|11 ENDAT_Z2_Sel| |EnDat additional information 2 type selection|
|640|12 ENDAT_Z2_1| |Z2 info: dword 1|
|640|13 ENDAT_Z2_2| |Z2 info: dword 2|
|640|14 ENDAT_Z2_3| |Z2 info: dword 3|
|640|15 ENDAT_Z2_4| |Z2 info: dword 4|
|640|16 ENDAT_Mode1|0=off|EnDat additional mode 1 selection|
|640|17 ENDAT_Mode2| |EnDat additional mode 2 selection|
|640|18 ENDAT_Mode3| |EnDat additional mode 3 selection|
|640|19 ENDAT_Mode4| |EnDat additional mode 4 selection|
|640|20 ENDAT_res1| |reserved 1|
|640|21 ENDAT_res2| |reserved 2|
|640|22 ENDAT_res3| |reserved 3|
|640|23 ENDAT_HwSyncStop|0=SyncOn|EnDat cyclic hw sync, stop/start 1/0|
|640|24 ENDAT_CyclCount| |call counter of cyclic function|
|640|25 ENDAT_BWZ_Supported| |vn supported (bit3=vn4, bit2=vn3, bit0=vn1)|
|640|26 ENDAT_BWZ1_| |vn1: bits[7..0] threshold level, bits[31..16]|
|640|27 ThresholdLevel| |how often number|
|640|28 ENDAT_BWZ3_| |vn3: bits[7..0] threshold level, bits[31..16]|
|640|29 ThresholdLevel| |how often number|
|640|30 ENDAT_BWZ4_| |vn4: bits[7..0] threshold level, bits[31..16]|
|640|31 ThresholdLevel| |how often number|
|640|32 ENDAT_BWZ_TEST_| |vn: bits[15..12] 'F', bits[11..8] vn.no., bits [7..0] vn overwrite value|

# 6.5.3 Hall sensor X7

Ch1: HALL(5) - Digital hall signals

Ch1: HALL_TTL(7) - Digital hall signals

NOTE

l The operation and configuration of Hall effect sensors is reserved for special applications. Consult with Moog if needed.

# 6.5.4 Sin/Cos / TTL X7

# 6.5.4.1 TTL encoder

Ch1: TTL(3) - TTL signals

TTL encoders are ...

- a. ... ... usually pure incremental encoders without an absolute value interface.
- b. In this case, P 540[0] - ENC_CH1_Abs must be set to OFF(0). ... ... in a few exceptional cases, incremental encoders with an SSI absolute value interface. In this case, P 540[0] - ENC_CH1_Abs must be accordingly set to SSI(1) (SSI_CONT(4) in special cases), so that it will be possible to read the absolute encoder position for the absolute value initialization routine once during the initialization phase.

# 6.5.4.1.1 Pure TTL incremental encoder

Set P 505[0] - ENC_CH1_Sel to TTL(3) and P 540[0] - ENC_CH1_Abs to OFF(0) when using pure TTL encoders, i.e. encoders without an absolute value interface but with a TTL zero pulse.

Linear TTL encoders are run as rotary encoders. For linear motor operation, P 542 [0] - ENC_CH1_Lines and the encoder gearing (see the “Encoder gearing” section) are used to establish the ratio for the linear motor’s pole pair subdivision (North-North) for commutation. 1 x North-North corresponds to one revolution from Lines. In this case, the motor pole pair number must be set to 1. Moreover, P 553[0] - ENC_CH1_PeriodLen is not used in this case.

The TTL interface accepts various TTL signal types, which can be selected using P 558[0] - ENC_CH1_TTL_SignalType:

- (0)AF_B - A/B tracks (forward counting, X4 encoding) - AB
- (1)AR_B - A/B tracks (reverse counting, X4 encoding) - AB_inv
- (2)ABDFN - A: Clock (falling edge), B: Direction (1 = positive) - PulseDir
- (3)ABDRP - A: Clock (rising edge), B: Direction (1 = negative) - PulseDir_inv
- (4)reserved

A maximum interpolation period, in ms (milliseconds), can be configured for the TTL interface using P 601[0] - ENC_CH1_Period. Within this context, Period is the maximum time of “no activity” since the last TTL counter event:

- Period = 0: Function disabled (default)
- Period > 0 (=n ms): If no counter event is registered in n ms, the speed will be set to 0.

# Zero pulse

There is no parameter for activating the zero pulse evaluation here, as this evaluation is controlled exclusively based on the homing mode (see Section ""Homing"" on page 249). However, setting P 541[0] - ENC_CH1_NpTest to 1 provides a test mode that can be used during commissioning in order to be able to activate the zero pulse evaluation even without homing. Scope signals 1014 and 1016 can be used to view a received zero pulse within this context. This test mode must be disabled during normal operation (P 541[0] = 0).

# Commutation

Motor operation with pure incremental encoders needs for the auto commutation function to be enabled without fail. For details see Section ""Synchronous motor auto commutation"" on page 156.

# 6.5.4.1.2 TTL incremental encoder with SSI absolute value interface

See Section ""Sin/Cos incremental encoders with absolute value interface"" on page 65 and in special Section ""SSI absolute value interface"" on page 67.

MSD ServoDrive - DeviceHelp

# 6 Encoder

MOOG ID No.:CB40859-001 Date:11/2020 MSD ServoDrive - DeviceHelp 64

|ID|Index Name|Unit|Description|
|---|---|---|---|
|505|0|ENC_CH1_Sel = 3|Encoder selection set to TTL(3)|
|510|0|ENC_CH1_Num|Encoder gearing: Numerator Ch1: SINCOS(1) - Sin/Cos signals|
|511|0|ENC_CH1_Denom|Encoder gearing: Denominator|
|540|0|ENC_CH1_Abs|Selection of absolute value interface Sin/Cos encoders can ...|
|541|0|ENC_CH1_NpTest|ENC CH1, TEST-MODE: Index pulse signal(s) to Scope|
|542|0|ENC_CH1_lines|Number of lines (Sin/Cos / TTL encoders) a. Be pure incremental encoders without an absolute value interface. In this|
|558|0|ENC_CH1_TTL_SignalType|Channel 1: TTL signal selection case, P 540[0] - ENC_CH1_Abs must be set to OFF(0).|
|601|0|ENC_CH1_Period|Maximum period of interpolation (TTL encoder)|
|616|0|ENC_CH1_CycleCount|Sampling cycle in: n x 125 μ (microseconds) b. Be incremental encoders with an absolute value interface. In this case,|

Table 6.8: Parameters for Channel 1 (X7) - TTL encoder

ENC_CH1_Abs must be accordingly set to SSI(1), EnDat(2), HIPER(3) or, in special cases, SSI_CONT(4) so that it will be possible to read the absolute encoder position for the absolute value initialization routine once during the initialization phase.

# 6.5.4.2.1 Purely Sin/Cos incremental encoders

To run these encoders as purely incremental encoders with a zero pulse on encoder channel Ch1 (without an absolute value interface), the approach is basically the same as for purely TTL operation (see Section ""TTL encoder"" on page 63). The same parameters apply.

However, there are the following differences:

- a. There are no different signal types for the Sin/Cos signal (always 1 Vss for cosine and sine).
- b. The zero pulse is the analog zero pulse typical of Sin/Cos encoders (see the “Connection for high-resolution encoders” section in the operation manual MSD Servo Drive Single-Axis System, for example).

# 6.5.4.2.2 Linear Sin/Cos

|ID|Index Name|Unit|Description|
|---|---|---|---|
|542|ENC_CH1_lines| |Number of Lines (Sin/Cos / TTL encoders)|
|543|ENC_CH1_MultiT| |Number of MultiTurn bits (absolute encoder)|
|544|ENC_CH1_SingleT| |Number of SingleTurn bits (absolute encoder)|
|545|ENC_CH1_Code| |Code selection (SSI encoder) (binary, gray)|
|546|ENC_CH1_Mode| |Mode selection (SSI encoder)|
|547|ENC_CH1_MTBase| |Definition of point of discontinuity in multi-turn range|
|548|ENC_CH1_MTEnable| |Enable MultiTurn use (negative logic, 1=MToff)|
|549|ENC_CH1_Corr| |Signal correction type|
|550|ENC_CH1_CorrVal|0-4|Signal correction values|
|551|ENC_CH1_EncObsMin| |Encoder monitoring minimum, sqrt(a^2+b^2)|
|552|ENC_CH1_AbsEncStatus| |Error and status codes (absolute encoder)|

# 6.5.4.2.3 Signal correction (GPOC)

|ID|Index Name|Unit|Description|
|---|---|---|---|
|553|ENC_CH1_PeriodLen|nm|Length of signal period (Sin/Cos linear encoder)|
|554|ENC_CH1_DigitalResolution|nm|Length of one increment (linear absolute encoder)|
|555|ENC_CH1_Info| |Encoder information|
|616|ENC_CH1_CycleCount| |Sampling cycle in: n x 125 μ (microseconds)|
|610|ENC_CH1_NominalIncrementA| |Sign. Nominal increment A (distance coded abs. per. encoder)|
|611|ENC_CH1_NominalIncrementB| |Sign. Nominal increment B (distance coded abs. per. encoder)|
|1900|ENC_ETS| |ETS mode, electronic nameplate|

# 6.5.4.2.4 Sin/Cos incremental encoders with absolute value interface

The following table lists the parameters for cyclical Sin/Cos operation on encoder channel Ch 1 with one-time reading of the absolute encoder position via the absolute value interface, i.e. without a zero pulse:

|ID|Index Name|Unit|Description|
|---|---|---|---|
|505|ENC_CH1_Sel|1|Encoder selection set to SINCOS(1)|
|510|ENC_CH1_Num| |Encoder gearing: Numerator|
|511|ENC_CH1_Denom| |Encoder gearing: Denominator|
|540|ENC_CH1_Abs| |Absolute value interface selection (one-time reading)|

Table 6.9: Parameters for channel 1 (X7) - Sin/Cos encoder

The Sel, Num, Denom, Abs, Lines, MultiT, SingleT and CorrVal parameters are self-explanatory.

The Code and Mode parameters are described in Section ""SSI (cyclical) X7"" on page 69.

P 547[0] - ENC_CH1_MTBase = Minimum MultiTurn position

The MTBase parameter is used to set a position in the multi-turn encoder’s travel path that defines the point of discontinuity (overflow/underflow) for the absolute value initialization (that is, the “multi-turn basis”). Assuming a bipolar encoder measuring range, all position values that fall below MTBase will be shifted “up” (the whole MT range will be added to them once).

MOOG ID No.:CB40859-001 Date:11/2020

MSD ServoDrive - DeviceHelp

# 6 Encoder

MOOG ID No.:CB40859-001 Date:11/2020

method makes it possible to place the point of discontinuity at any point within the encoder’s entire measuring range. By default, MTBase will be set to the lowest possible value for the parameter, i.e. reliably outside of the encoder’s value range: In this case, the full bipolar range will remain unaffected, as values will never fall below this MTBase threshold (see Section ""Channel 1: Interface X7"" on page 59).

- P 548[0] - ENC_CH1_MTEnable = MultiTurn as SingleTurn
- The MTEnable parameter makes it possible to use multi-turn encoders as single-turn encoders for test purposes. Negative logic: Default MTEnable = 0 means ""MultiTurn-Enable ON"".

P 549[0] - ENC_CH1_Corr = Signal correction type
- The GPOC routine used for track signal correction purposes for sine/cosine signals is used to compensate for systematic errors. The routine is controlled with the Corr and CorrVal parameters (see Section ""Signal correction GPOC (Gain Phase Offset Correction)"" on page 74).

P 551[0] - ENC_CH1_EncObsMin = Encoder monitoring minimum, sqrt (a^2+b^2)
- The parameter EncObsMin is used to scale the Sin/Cos wire break monitoring and represents the “downwards threshold” for an error message. The default setting is 0.2, corresponding to approx. ",What is the purpose of the P 640[0] - ENDAT_Select parameter in the EnDat encoder interface?,A1,"The P 640[0] - ENDAT_Select parameter is used to enable or disable specific functions in the EnDat encoder, such as diagnostics (1/2 for on/off) and warnings (3).",2.25,2.28125,3.65625,1.75,0.890625
36,msd_servo_drive.txt,20,02f242a213dfa4411d028ce46dfba16a3f97395fa25788fcbaea1715e779d934,"), consult with your project supervisor or the Helpline provided by Moog before using any special SSI protocol modes.

# 6.5.2 EnDat (cyclical) X7

Ch1: ENDAT(4) - Cyclical EnDat (2.1 or 2.2) EnDat is a digital encoder interface developed by HEIDENHAIN. For more details, please visit www.heidenhain.de and go to ►Documentation ►Fundamentals ►Interfaces ►EnDat 2.2.

The software versions required to run the EnDat encoder interface are the standard software versions for the MSD Servo Drive and MSD Single-Axis Servo Drive Compact.

MOOG ID No.:CB40859-001 Date:11/2020

# 6 Encoder

NOTE

- Please note the limitations that apply when running EnDat and SSI encoders (see Section ""Limiting for EnDat and SSI"" on page 52).

When using linear encoders, P 554[0] - ENC_CH1_DigitalResolution is used instead of P 543[0] - ENC_CH1_MultiT and P 544[0] - ENC_CH1_SingleT (which are used for rotary encoders). The values will be read from the EnDat encoder and written to the aforementioned parameters.

- P 543[0] - ENC_CH1_MultiT
- The number ""n"" of multiturn bits defines the measuring range in 2n increments per encoder shaft revolution; maximum travel until overflow; maximum travel within which the absolute value initialization can be unambiguous. In the case of single-turn encoders, MultiT = 0.
- P 544[0] - ENC_CH1_SingleT
- The number ""n"" of single-turn bits corresponds to the encoder’s digital resolution in 2n increments per encoder shaft revolution.
- P 554[0] - ENC_CH1_DigitalResolution
- This is the length of an increment, in nanometres, of the encoder’s digitally transmitted position value. This value is read from the EnDat linear head.

In the case of linear encoders, the number n of transmitted position bits from the encoder will be found in SingleT only! 2n * DigitalResolution yields the maximum travel in nanometres (for the encoder head).

P 640 - ENC_ENDAT is intended for additional information, but is normally not needed. This parameter does not have a Ch1 or Ch3 prefix for the encoder channel in the name, as it applies to both encoder channels. Although usually not needed, the parameter is helpful or required in the following cases:

1. Special EnDat encoder with diagnostics for evaluation
In this case, the valuation numbers from the encoder are read cyclically via additional information. Only the valuation numbers that the encoder supports.

# 6 Encoder

MOOG ID No.:CB40859-001 Date:11/2020

will be read. During the initialization process, the system will read the encoder to determine which valuation numbers it supports. When P 640[0] - ENDAT_Select = 1, the function will be enabled in the controller and the internal diagnostics in the EnDaT encoder will be enabled as well. The EnDat encoder will keep this setting even after being powered off. To explicitly disable the internal diagnostics in the EnDat encoder, set P 640[0] - ENDAT_Select to 2.

# 2. Evaluation of internal warnings

In this scenario, certain internal warnings from the encoder will be read from the encoder via additional information. Only the warnings that both the encoder and the Servo Drive’s software support will be read. During the initialization process, the system will read the encoder to determine which warnings it supports. When P 640[0] - ENDAT_Select = 3, the function will be enabled in the controller.

**Table 6.7: Channel 1 encoder configuration (X7) - EnDat parameters**
|ID|Index Name|Unit|Description|
|---|---|---|---|
|505|0 ENC_CH1_Sel|= ENDAT(4)| |
|543|0 ENC_CH1_MultiT|Number of MultiTurn bits (absolute encoder)| |
|544|0 ENC_CH1_SingleT|Number of SingleTurn bits (absolute encoder)| |
|547|0 ENC_CH1_MTBase|Definition of point of discontinuity in multi-turn range| |
|548|0 ENC_CH1_MTEnable|1: Use Multi-turn encoder as a single-turn encoder| |
|616|0 ENC_CH1_CycleCount|Position encoder sampling cycle (n x 125 μsec)| |
|598|0 ENC_CH1_Position|inc|Position encoder channel 1|
|554|0 ENC_CH1_|nm|Length of one increment (linear absolute encoder)|
|640|ENC_ENDAT| |EnDat additional (additional information)|
|640|0 ENDAT_Select|0=off|EnDat function selection, 1/2=diagnosis on/off, 3=warnings, FF=lock|
|640|1 ENDAT_DiagCount|u16|count new diagnosis block header|
|640|2 ENDAT_BWZ_1|lowbyte|vn1: incremental track|
|640|3 ENDAT_BWZ_3|lowbyte|vn3: absolute track|
|640|4 ENDAT_BWZ_4|lowbyte|vn4: position value formation|
|640|5 ENDAT_Status| |EnDat additional status output|
|640|6 ENDAT_Z1_Sel| |EnDat additional information 1 type selection|

**Table 6.7: Overwrite Channel 1 encoder configuration (X7) - EnDat parameters (continue)**
|ID|Index Name|Unit|Description|
|---|---|---|---|
|640|7 ENDAT_Z1_1| |Z1 info: dword 1|
|640|8 ENDAT_Z1_2| |Z1 info: dword 2|
|640|9 ENDAT_Z1_3| |Z1 info: dword 3|
|640|10 ENDAT_Z1_4| |Z1 info: dword 4|
|640|11 ENDAT_Z2_Sel| |EnDat additional information 2 type selection|
|640|12 ENDAT_Z2_1| |Z2 info: dword 1|
|640|13 ENDAT_Z2_2| |Z2 info: dword 2|
|640|14 ENDAT_Z2_3| |Z2 info: dword 3|
|640|15 ENDAT_Z2_4| |Z2 info: dword 4|
|640|16 ENDAT_Mode1|0=off|EnDat additional mode 1 selection|
|640|17 ENDAT_Mode2| |EnDat additional mode 2 selection|
|640|18 ENDAT_Mode3| |EnDat additional mode 3 selection|
|640|19 ENDAT_Mode4| |EnDat additional mode 4 selection|
|640|20 ENDAT_res1| |reserved 1|
|640|21 ENDAT_res2| |reserved 2|
|640|22 ENDAT_res3| |reserved 3|
|640|23 ENDAT_HwSyncStop|0=SyncOn|EnDat cyclic hw sync, stop/start 1/0|
|640|24 ENDAT_CyclCount| |call counter of cyclic function|
|640|25 ENDAT_BWZ_Supported| |vn supported (bit3=vn4, bit2=vn3, bit0=vn1)|
|640|26 ENDAT_BWZ1_| |vn1: bits[7..0] threshold level, bits[31..16]|
|640|27 ThresholdLevel| |how often number|
|640|28 ENDAT_BWZ3_| |vn3: bits[7..0] threshold level, bits[31..16]|
|640|29 ThresholdLevel| |how often number|
|640|30 ENDAT_BWZ4_| |vn4: bits[7..0] threshold level, bits[31..16]|
|640|31 ThresholdLevel| |how often number|
|640|32 ENDAT_BWZ_TEST_| |vn: bits[15..12] 'F', bits[11..8] vn.no., bits [7..0] vn overwrite value|

# 6.5.3 Hall sensor X7

Ch1: HALL(5) - Digital hall signals

Ch1: HALL_TTL(7) - Digital hall signals

NOTE

l The operation and configuration of Hall effect sensors is reserved for special applications. Consult with Moog if needed.

# 6.5.4 Sin/Cos / TTL X7

# 6.5.4.1 TTL encoder

Ch1: TTL(3) - TTL signals

TTL encoders are ...

- a. ... ... usually pure incremental encoders without an absolute value interface.
- b. In this case, P 540[0] - ENC_CH1_Abs must be set to OFF(0). ... ... in a few exceptional cases, incremental encoders with an SSI absolute value interface. In this case, P 540[0] - ENC_CH1_Abs must be accordingly set to SSI(1) (SSI_CONT(4) in special cases), so that it will be possible to read the absolute encoder position for the absolute value initialization routine once during the initialization phase.

# 6.5.4.1.1 Pure TTL incremental encoder

Set P 505[0] - ENC_CH1_Sel to TTL(3) and P 540[0] - ENC_CH1_Abs to OFF(0) when using pure TTL encoders, i.e. encoders without an absolute value interface but with a TTL zero pulse.

Linear TTL encoders are run as rotary encoders. For linear motor operation, P 542 [0] - ENC_CH1_Lines and the encoder gearing (see the “Encoder gearing” section) are used to establish the ratio for the linear motor’s pole pair subdivision (North-North) for commutation. 1 x North-North corresponds to one revolution from Lines. In this case, the motor pole pair number must be set to 1. Moreover, P 553[0] - ENC_CH1_PeriodLen is not used in this case.

The TTL interface accepts various TTL signal types, which can be selected using P 558[0] - ENC_CH1_TTL_SignalType:

- (0)AF_B - A/B tracks (forward counting, X4 encoding) - AB
- (1)AR_B - A/B tracks (reverse counting, X4 encoding) - AB_inv
- (2)ABDFN - A: Clock (falling edge), B: Direction (1 = positive) - PulseDir
- (3)ABDRP - A: Clock (rising edge), B: Direction (1 = negative) - PulseDir_inv
- (4)reserved

A maximum interpolation period, in ms (milliseconds), can be configured for the TTL interface using P 601[0] - ENC_CH1_Period. Within this context, Period is the maximum time of “no activity” since the last TTL counter event:

- Period = 0: Function disabled (default)
- Period > 0 (=n ms): If no counter event is registered in n ms, the speed will be set to 0.

# Zero pulse

There is no parameter for activating the zero pulse evaluation here, as this evaluation is controlled exclusively based on the homing mode (see Section ""Homing"" on page 249). However, setting P 541[0] - ENC_CH1_NpTest to 1 provides a test mode that can be used during commissioning in order to be able to activate the zero pulse evaluation even without homing. Scope signals 1014 and 1016 can be used to view a received zero pulse within this context. This test mode must be disabled during normal operation (P 541[0] = 0).

# Commutation

Motor operation with pure incremental encoders needs for the auto commutation function to be enabled without fail. For details see Section ""Synchronous motor auto commutation"" on page 156.

# 6.5.4.1.2 TTL incremental encoder with SSI absolute value interface

See Section ""Sin/Cos incremental encoders with absolute value interface"" on page 65 and in special Section ""SSI absolute value interface"" on page 67.

MSD ServoDrive - DeviceHelp

# 6 Encoder

MOOG ID No.:CB40859-001 Date:11/2020 MSD ServoDrive - DeviceHelp 64

|ID|Index Name|Unit|Description|
|---|---|---|---|
|505|0|ENC_CH1_Sel = 3|Encoder selection set to TTL(3)|
|510|0|ENC_CH1_Num|Encoder gearing: Numerator Ch1: SINCOS(1) - Sin/Cos signals|
|511|0|ENC_CH1_Denom|Encoder gearing: Denominator|
|540|0|ENC_CH1_Abs|Selection of absolute value interface Sin/Cos encoders can ...|
|541|0|ENC_CH1_NpTest|ENC CH1, TEST-MODE: Index pulse signal(s) to Scope|
|542|0|ENC_CH1_lines|Number of lines (Sin/Cos / TTL encoders) a. Be pure incremental encoders without an absolute value interface. In this|
|558|0|ENC_CH1_TTL_SignalType|Channel 1: TTL signal selection case, P 540[0] - ENC_CH1_Abs must be set to OFF(0).|
|601|0|ENC_CH1_Period|Maximum period of interpolation (TTL encoder)|
|616|0|ENC_CH1_CycleCount|Sampling cycle in: n x 125 μ (microseconds) b. Be incremental encoders with an absolute value interface. In this case,|

Table 6.8: Parameters for Channel 1 (X7) - TTL encoder

ENC_CH1_Abs must be accordingly set to SSI(1), EnDat(2), HIPER(3) or, in special cases, SSI_CONT(4) so that it will be possible to read the absolute encoder position for the absolute value initialization routine once during the initialization phase.

# 6.5.4.2.1 Purely Sin/Cos incremental encoders

To run these encoders as purely incremental encoders with a zero pulse on encoder channel Ch1 (without an absolute value interface), the approach is basically the same as for purely TTL operation (see Section ""TTL encoder"" on page 63). The same parameters apply.

However, there are the following differences:

- a. There are no different signal types for the Sin/Cos signal (always 1 Vss for cosine and sine).
- b. The zero pulse is the analog zero pulse typical of Sin/Cos encoders (see the “Connection for high-resolution encoders” section in the operation manual MSD Servo Drive Single-Axis System, for example).

# 6.5.4.2.2 Linear Sin/Cos

|ID|Index Name|Unit|Description|
|---|---|---|---|
|542|ENC_CH1_lines| |Number of Lines (Sin/Cos / TTL encoders)|
|543|ENC_CH1_MultiT| |Number of MultiTurn bits (absolute encoder)|
|544|ENC_CH1_SingleT| |Number of SingleTurn bits (absolute encoder)|
|545|ENC_CH1_Code| |Code selection (SSI encoder) (binary, gray)|
|546|ENC_CH1_Mode| |Mode selection (SSI encoder)|
|547|ENC_CH1_MTBase| |Definition of point of discontinuity in multi-turn range|
|548|ENC_CH1_MTEnable| |Enable MultiTurn use (negative logic, 1=MToff)|
|549|ENC_CH1_Corr| |Signal correction type|
|550|ENC_CH1_CorrVal|0-4|Signal correction values|
|551|ENC_CH1_EncObsMin| |Encoder monitoring minimum, sqrt(a^2+b^2)|
|552|ENC_CH1_AbsEncStatus| |Error and status codes (absolute encoder)|

# 6.5.4.2.3 Signal correction (GPOC)

|ID|Index Name|Unit|Description|
|---|---|---|---|
|553|ENC_CH1_PeriodLen|nm|Length of signal period (Sin/Cos linear encoder)|
|554|ENC_CH1_DigitalResolution|nm|Length of one increment (linear absolute encoder)|
|555|ENC_CH1_Info| |Encoder information|
|616|ENC_CH1_CycleCount| |Sampling cycle in: n x 125 μ (microseconds)|
|610|ENC_CH1_NominalIncrementA| |Sign. Nominal increment A (distance coded abs. per. encoder)|
|611|ENC_CH1_NominalIncrementB| |Sign. Nominal increment B (distance coded abs. per. encoder)|
|1900|ENC_ETS| |ETS mode, electronic nameplate|

# 6.5.4.2.4 Sin/Cos incremental encoders with absolute value interface

The following table lists the parameters for cyclical Sin/Cos operation on encoder channel Ch 1 with one-time reading of the absolute encoder position via the absolute value interface, i.e. without a zero pulse:

|ID|Index Name|Unit|Description|
|---|---|---|---|
|505|ENC_CH1_Sel|1|Encoder selection set to SINCOS(1)|
|510|ENC_CH1_Num| |Encoder gearing: Numerator|
|511|ENC_CH1_Denom| |Encoder gearing: Denominator|
|540|ENC_CH1_Abs| |Absolute value interface selection (one-time reading)|

Table 6.9: Parameters for channel 1 (X7) - Sin/Cos encoder

The Sel, Num, Denom, Abs, Lines, MultiT, SingleT and CorrVal parameters are self-explanatory.

The Code and Mode parameters are described in Section ""SSI (cyclical) X7"" on page 69.

P 547[0] - ENC_CH1_MTBase = Minimum MultiTurn position

The MTBase parameter is used to set a position in the multi-turn encoder’s travel path that defines the point of discontinuity (overflow/underflow) for the absolute value initialization (that is, the “multi-turn basis”). Assuming a bipolar encoder measuring range, all position values that fall below MTBase will be shifted “up” (the whole MT range will be added to them once).

MOOG ID No.:CB40859-001 Date:11/2020

MSD ServoDrive - DeviceHelp

# 6 Encoder

MOOG ID No.:CB40859-001 Date:11/2020

method makes it possible to place the point of discontinuity at any point within the encoder’s entire measuring range. By default, MTBase will be set to the lowest possible value for the parameter, i.e. reliably outside of the encoder’s value range: In this case, the full bipolar range will remain unaffected, as values will never fall below this MTBase threshold (see Section ""Channel 1: Interface X7"" on page 59).

- P 548[0] - ENC_CH1_MTEnable = MultiTurn as SingleTurn
- The MTEnable parameter makes it possible to use multi-turn encoders as single-turn encoders for test purposes. Negative logic: Default MTEnable = 0 means ""MultiTurn-Enable ON"".

P 549[0] - ENC_CH1_Corr = Signal correction type
- The GPOC routine used for track signal correction purposes for sine/cosine signals is used to compensate for systematic errors. The routine is controlled with the Corr and CorrVal parameters (see Section ""Signal correction GPOC (Gain Phase Offset Correction)"" on page 74).

P 551[0] - ENC_CH1_EncObsMin = Encoder monitoring minimum, sqrt (a^2+b^2)
- The parameter EncObsMin is used to scale the Sin/Cos wire break monitoring and represents the “downwards threshold” for an error message. The default setting is 0.2, corresponding to approx. ",What is the purpose of the P 640[0] - ENDAT_Select parameter in the EnDat encoder interface?,A2,"It controls the EnDat function selection, allowing users to enable diagnostics (set to 1), disable diagnostics (set to 2), or enable warnings (set to 3).",2.0,2.03125,3.53125,1.65625,0.69140625
37,msd_servo_drive.txt,20,02f242a213dfa4411d028ce46dfba16a3f97395fa25788fcbaea1715e779d934,"), consult with your project supervisor or the Helpline provided by Moog before using any special SSI protocol modes.

# 6.5.2 EnDat (cyclical) X7

Ch1: ENDAT(4) - Cyclical EnDat (2.1 or 2.2) EnDat is a digital encoder interface developed by HEIDENHAIN. For more details, please visit www.heidenhain.de and go to ►Documentation ►Fundamentals ►Interfaces ►EnDat 2.2.

The software versions required to run the EnDat encoder interface are the standard software versions for the MSD Servo Drive and MSD Single-Axis Servo Drive Compact.

MOOG ID No.:CB40859-001 Date:11/2020

# 6 Encoder

NOTE

- Please note the limitations that apply when running EnDat and SSI encoders (see Section ""Limiting for EnDat and SSI"" on page 52).

When using linear encoders, P 554[0] - ENC_CH1_DigitalResolution is used instead of P 543[0] - ENC_CH1_MultiT and P 544[0] - ENC_CH1_SingleT (which are used for rotary encoders). The values will be read from the EnDat encoder and written to the aforementioned parameters.

- P 543[0] - ENC_CH1_MultiT
- The number ""n"" of multiturn bits defines the measuring range in 2n increments per encoder shaft revolution; maximum travel until overflow; maximum travel within which the absolute value initialization can be unambiguous. In the case of single-turn encoders, MultiT = 0.
- P 544[0] - ENC_CH1_SingleT
- The number ""n"" of single-turn bits corresponds to the encoder’s digital resolution in 2n increments per encoder shaft revolution.
- P 554[0] - ENC_CH1_DigitalResolution
- This is the length of an increment, in nanometres, of the encoder’s digitally transmitted position value. This value is read from the EnDat linear head.

In the case of linear encoders, the number n of transmitted position bits from the encoder will be found in SingleT only! 2n * DigitalResolution yields the maximum travel in nanometres (for the encoder head).

P 640 - ENC_ENDAT is intended for additional information, but is normally not needed. This parameter does not have a Ch1 or Ch3 prefix for the encoder channel in the name, as it applies to both encoder channels. Although usually not needed, the parameter is helpful or required in the following cases:

1. Special EnDat encoder with diagnostics for evaluation
In this case, the valuation numbers from the encoder are read cyclically via additional information. Only the valuation numbers that the encoder supports.

# 6 Encoder

MOOG ID No.:CB40859-001 Date:11/2020

will be read. During the initialization process, the system will read the encoder to determine which valuation numbers it supports. When P 640[0] - ENDAT_Select = 1, the function will be enabled in the controller and the internal diagnostics in the EnDaT encoder will be enabled as well. The EnDat encoder will keep this setting even after being powered off. To explicitly disable the internal diagnostics in the EnDat encoder, set P 640[0] - ENDAT_Select to 2.

# 2. Evaluation of internal warnings

In this scenario, certain internal warnings from the encoder will be read from the encoder via additional information. Only the warnings that both the encoder and the Servo Drive’s software support will be read. During the initialization process, the system will read the encoder to determine which warnings it supports. When P 640[0] - ENDAT_Select = 3, the function will be enabled in the controller.

**Table 6.7: Channel 1 encoder configuration (X7) - EnDat parameters**
|ID|Index Name|Unit|Description|
|---|---|---|---|
|505|0 ENC_CH1_Sel|= ENDAT(4)| |
|543|0 ENC_CH1_MultiT|Number of MultiTurn bits (absolute encoder)| |
|544|0 ENC_CH1_SingleT|Number of SingleTurn bits (absolute encoder)| |
|547|0 ENC_CH1_MTBase|Definition of point of discontinuity in multi-turn range| |
|548|0 ENC_CH1_MTEnable|1: Use Multi-turn encoder as a single-turn encoder| |
|616|0 ENC_CH1_CycleCount|Position encoder sampling cycle (n x 125 μsec)| |
|598|0 ENC_CH1_Position|inc|Position encoder channel 1|
|554|0 ENC_CH1_|nm|Length of one increment (linear absolute encoder)|
|640|ENC_ENDAT| |EnDat additional (additional information)|
|640|0 ENDAT_Select|0=off|EnDat function selection, 1/2=diagnosis on/off, 3=warnings, FF=lock|
|640|1 ENDAT_DiagCount|u16|count new diagnosis block header|
|640|2 ENDAT_BWZ_1|lowbyte|vn1: incremental track|
|640|3 ENDAT_BWZ_3|lowbyte|vn3: absolute track|
|640|4 ENDAT_BWZ_4|lowbyte|vn4: position value formation|
|640|5 ENDAT_Status| |EnDat additional status output|
|640|6 ENDAT_Z1_Sel| |EnDat additional information 1 type selection|

**Table 6.7: Overwrite Channel 1 encoder configuration (X7) - EnDat parameters (continue)**
|ID|Index Name|Unit|Description|
|---|---|---|---|
|640|7 ENDAT_Z1_1| |Z1 info: dword 1|
|640|8 ENDAT_Z1_2| |Z1 info: dword 2|
|640|9 ENDAT_Z1_3| |Z1 info: dword 3|
|640|10 ENDAT_Z1_4| |Z1 info: dword 4|
|640|11 ENDAT_Z2_Sel| |EnDat additional information 2 type selection|
|640|12 ENDAT_Z2_1| |Z2 info: dword 1|
|640|13 ENDAT_Z2_2| |Z2 info: dword 2|
|640|14 ENDAT_Z2_3| |Z2 info: dword 3|
|640|15 ENDAT_Z2_4| |Z2 info: dword 4|
|640|16 ENDAT_Mode1|0=off|EnDat additional mode 1 selection|
|640|17 ENDAT_Mode2| |EnDat additional mode 2 selection|
|640|18 ENDAT_Mode3| |EnDat additional mode 3 selection|
|640|19 ENDAT_Mode4| |EnDat additional mode 4 selection|
|640|20 ENDAT_res1| |reserved 1|
|640|21 ENDAT_res2| |reserved 2|
|640|22 ENDAT_res3| |reserved 3|
|640|23 ENDAT_HwSyncStop|0=SyncOn|EnDat cyclic hw sync, stop/start 1/0|
|640|24 ENDAT_CyclCount| |call counter of cyclic function|
|640|25 ENDAT_BWZ_Supported| |vn supported (bit3=vn4, bit2=vn3, bit0=vn1)|
|640|26 ENDAT_BWZ1_| |vn1: bits[7..0] threshold level, bits[31..16]|
|640|27 ThresholdLevel| |how often number|
|640|28 ENDAT_BWZ3_| |vn3: bits[7..0] threshold level, bits[31..16]|
|640|29 ThresholdLevel| |how often number|
|640|30 ENDAT_BWZ4_| |vn4: bits[7..0] threshold level, bits[31..16]|
|640|31 ThresholdLevel| |how often number|
|640|32 ENDAT_BWZ_TEST_| |vn: bits[15..12] 'F', bits[11..8] vn.no., bits [7..0] vn overwrite value|

# 6.5.3 Hall sensor X7

Ch1: HALL(5) - Digital hall signals

Ch1: HALL_TTL(7) - Digital hall signals

NOTE

l The operation and configuration of Hall effect sensors is reserved for special applications. Consult with Moog if needed.

# 6.5.4 Sin/Cos / TTL X7

# 6.5.4.1 TTL encoder

Ch1: TTL(3) - TTL signals

TTL encoders are ...

- a. ... ... usually pure incremental encoders without an absolute value interface.
- b. In this case, P 540[0] - ENC_CH1_Abs must be set to OFF(0). ... ... in a few exceptional cases, incremental encoders with an SSI absolute value interface. In this case, P 540[0] - ENC_CH1_Abs must be accordingly set to SSI(1) (SSI_CONT(4) in special cases), so that it will be possible to read the absolute encoder position for the absolute value initialization routine once during the initialization phase.

# 6.5.4.1.1 Pure TTL incremental encoder

Set P 505[0] - ENC_CH1_Sel to TTL(3) and P 540[0] - ENC_CH1_Abs to OFF(0) when using pure TTL encoders, i.e. encoders without an absolute value interface but with a TTL zero pulse.

Linear TTL encoders are run as rotary encoders. For linear motor operation, P 542 [0] - ENC_CH1_Lines and the encoder gearing (see the “Encoder gearing” section) are used to establish the ratio for the linear motor’s pole pair subdivision (North-North) for commutation. 1 x North-North corresponds to one revolution from Lines. In this case, the motor pole pair number must be set to 1. Moreover, P 553[0] - ENC_CH1_PeriodLen is not used in this case.

The TTL interface accepts various TTL signal types, which can be selected using P 558[0] - ENC_CH1_TTL_SignalType:

- (0)AF_B - A/B tracks (forward counting, X4 encoding) - AB
- (1)AR_B - A/B tracks (reverse counting, X4 encoding) - AB_inv
- (2)ABDFN - A: Clock (falling edge), B: Direction (1 = positive) - PulseDir
- (3)ABDRP - A: Clock (rising edge), B: Direction (1 = negative) - PulseDir_inv
- (4)reserved

A maximum interpolation period, in ms (milliseconds), can be configured for the TTL interface using P 601[0] - ENC_CH1_Period. Within this context, Period is the maximum time of “no activity” since the last TTL counter event:

- Period = 0: Function disabled (default)
- Period > 0 (=n ms): If no counter event is registered in n ms, the speed will be set to 0.

# Zero pulse

There is no parameter for activating the zero pulse evaluation here, as this evaluation is controlled exclusively based on the homing mode (see Section ""Homing"" on page 249). However, setting P 541[0] - ENC_CH1_NpTest to 1 provides a test mode that can be used during commissioning in order to be able to activate the zero pulse evaluation even without homing. Scope signals 1014 and 1016 can be used to view a received zero pulse within this context. This test mode must be disabled during normal operation (P 541[0] = 0).

# Commutation

Motor operation with pure incremental encoders needs for the auto commutation function to be enabled without fail. For details see Section ""Synchronous motor auto commutation"" on page 156.

# 6.5.4.1.2 TTL incremental encoder with SSI absolute value interface

See Section ""Sin/Cos incremental encoders with absolute value interface"" on page 65 and in special Section ""SSI absolute value interface"" on page 67.

MSD ServoDrive - DeviceHelp

# 6 Encoder

MOOG ID No.:CB40859-001 Date:11/2020 MSD ServoDrive - DeviceHelp 64

|ID|Index Name|Unit|Description|
|---|---|---|---|
|505|0|ENC_CH1_Sel = 3|Encoder selection set to TTL(3)|
|510|0|ENC_CH1_Num|Encoder gearing: Numerator Ch1: SINCOS(1) - Sin/Cos signals|
|511|0|ENC_CH1_Denom|Encoder gearing: Denominator|
|540|0|ENC_CH1_Abs|Selection of absolute value interface Sin/Cos encoders can ...|
|541|0|ENC_CH1_NpTest|ENC CH1, TEST-MODE: Index pulse signal(s) to Scope|
|542|0|ENC_CH1_lines|Number of lines (Sin/Cos / TTL encoders) a. Be pure incremental encoders without an absolute value interface. In this|
|558|0|ENC_CH1_TTL_SignalType|Channel 1: TTL signal selection case, P 540[0] - ENC_CH1_Abs must be set to OFF(0).|
|601|0|ENC_CH1_Period|Maximum period of interpolation (TTL encoder)|
|616|0|ENC_CH1_CycleCount|Sampling cycle in: n x 125 μ (microseconds) b. Be incremental encoders with an absolute value interface. In this case,|

Table 6.8: Parameters for Channel 1 (X7) - TTL encoder

ENC_CH1_Abs must be accordingly set to SSI(1), EnDat(2), HIPER(3) or, in special cases, SSI_CONT(4) so that it will be possible to read the absolute encoder position for the absolute value initialization routine once during the initialization phase.

# 6.5.4.2.1 Purely Sin/Cos incremental encoders

To run these encoders as purely incremental encoders with a zero pulse on encoder channel Ch1 (without an absolute value interface), the approach is basically the same as for purely TTL operation (see Section ""TTL encoder"" on page 63). The same parameters apply.

However, there are the following differences:

- a. There are no different signal types for the Sin/Cos signal (always 1 Vss for cosine and sine).
- b. The zero pulse is the analog zero pulse typical of Sin/Cos encoders (see the “Connection for high-resolution encoders” section in the operation manual MSD Servo Drive Single-Axis System, for example).

# 6.5.4.2.2 Linear Sin/Cos

|ID|Index Name|Unit|Description|
|---|---|---|---|
|542|ENC_CH1_lines| |Number of Lines (Sin/Cos / TTL encoders)|
|543|ENC_CH1_MultiT| |Number of MultiTurn bits (absolute encoder)|
|544|ENC_CH1_SingleT| |Number of SingleTurn bits (absolute encoder)|
|545|ENC_CH1_Code| |Code selection (SSI encoder) (binary, gray)|
|546|ENC_CH1_Mode| |Mode selection (SSI encoder)|
|547|ENC_CH1_MTBase| |Definition of point of discontinuity in multi-turn range|
|548|ENC_CH1_MTEnable| |Enable MultiTurn use (negative logic, 1=MToff)|
|549|ENC_CH1_Corr| |Signal correction type|
|550|ENC_CH1_CorrVal|0-4|Signal correction values|
|551|ENC_CH1_EncObsMin| |Encoder monitoring minimum, sqrt(a^2+b^2)|
|552|ENC_CH1_AbsEncStatus| |Error and status codes (absolute encoder)|

# 6.5.4.2.3 Signal correction (GPOC)

|ID|Index Name|Unit|Description|
|---|---|---|---|
|553|ENC_CH1_PeriodLen|nm|Length of signal period (Sin/Cos linear encoder)|
|554|ENC_CH1_DigitalResolution|nm|Length of one increment (linear absolute encoder)|
|555|ENC_CH1_Info| |Encoder information|
|616|ENC_CH1_CycleCount| |Sampling cycle in: n x 125 μ (microseconds)|
|610|ENC_CH1_NominalIncrementA| |Sign. Nominal increment A (distance coded abs. per. encoder)|
|611|ENC_CH1_NominalIncrementB| |Sign. Nominal increment B (distance coded abs. per. encoder)|
|1900|ENC_ETS| |ETS mode, electronic nameplate|

# 6.5.4.2.4 Sin/Cos incremental encoders with absolute value interface

The following table lists the parameters for cyclical Sin/Cos operation on encoder channel Ch 1 with one-time reading of the absolute encoder position via the absolute value interface, i.e. without a zero pulse:

|ID|Index Name|Unit|Description|
|---|---|---|---|
|505|ENC_CH1_Sel|1|Encoder selection set to SINCOS(1)|
|510|ENC_CH1_Num| |Encoder gearing: Numerator|
|511|ENC_CH1_Denom| |Encoder gearing: Denominator|
|540|ENC_CH1_Abs| |Absolute value interface selection (one-time reading)|

Table 6.9: Parameters for channel 1 (X7) - Sin/Cos encoder

The Sel, Num, Denom, Abs, Lines, MultiT, SingleT and CorrVal parameters are self-explanatory.

The Code and Mode parameters are described in Section ""SSI (cyclical) X7"" on page 69.

P 547[0] - ENC_CH1_MTBase = Minimum MultiTurn position

The MTBase parameter is used to set a position in the multi-turn encoder’s travel path that defines the point of discontinuity (overflow/underflow) for the absolute value initialization (that is, the “multi-turn basis”). Assuming a bipolar encoder measuring range, all position values that fall below MTBase will be shifted “up” (the whole MT range will be added to them once).

MOOG ID No.:CB40859-001 Date:11/2020

MSD ServoDrive - DeviceHelp

# 6 Encoder

MOOG ID No.:CB40859-001 Date:11/2020

method makes it possible to place the point of discontinuity at any point within the encoder’s entire measuring range. By default, MTBase will be set to the lowest possible value for the parameter, i.e. reliably outside of the encoder’s value range: In this case, the full bipolar range will remain unaffected, as values will never fall below this MTBase threshold (see Section ""Channel 1: Interface X7"" on page 59).

- P 548[0] - ENC_CH1_MTEnable = MultiTurn as SingleTurn
- The MTEnable parameter makes it possible to use multi-turn encoders as single-turn encoders for test purposes. Negative logic: Default MTEnable = 0 means ""MultiTurn-Enable ON"".

P 549[0] - ENC_CH1_Corr = Signal correction type
- The GPOC routine used for track signal correction purposes for sine/cosine signals is used to compensate for systematic errors. The routine is controlled with the Corr and CorrVal parameters (see Section ""Signal correction GPOC (Gain Phase Offset Correction)"" on page 74).

P 551[0] - ENC_CH1_EncObsMin = Encoder monitoring minimum, sqrt (a^2+b^2)
- The parameter EncObsMin is used to scale the Sin/Cos wire break monitoring and represents the “downwards threshold” for an error message. The default setting is 0.2, corresponding to approx. ",What is the purpose of the P 640[0] - ENDAT_Select parameter in the EnDat encoder interface?,A3,"This parameter is crucial for configuring the EnDat encoder's additional functions, including turning on/off internal diagnostics and activating warning evaluations.",2.203125,2.140625,3.453125,1.6640625,0.68359375
38,msd_servo_drive.txt,20,02f242a213dfa4411d028ce46dfba16a3f97395fa25788fcbaea1715e779d934,"), consult with your project supervisor or the Helpline provided by Moog before using any special SSI protocol modes.

# 6.5.2 EnDat (cyclical) X7

Ch1: ENDAT(4) - Cyclical EnDat (2.1 or 2.2) EnDat is a digital encoder interface developed by HEIDENHAIN. For more details, please visit www.heidenhain.de and go to ►Documentation ►Fundamentals ►Interfaces ►EnDat 2.2.

The software versions required to run the EnDat encoder interface are the standard software versions for the MSD Servo Drive and MSD Single-Axis Servo Drive Compact.

MOOG ID No.:CB40859-001 Date:11/2020

# 6 Encoder

NOTE

- Please note the limitations that apply when running EnDat and SSI encoders (see Section ""Limiting for EnDat and SSI"" on page 52).

When using linear encoders, P 554[0] - ENC_CH1_DigitalResolution is used instead of P 543[0] - ENC_CH1_MultiT and P 544[0] - ENC_CH1_SingleT (which are used for rotary encoders). The values will be read from the EnDat encoder and written to the aforementioned parameters.

- P 543[0] - ENC_CH1_MultiT
- The number ""n"" of multiturn bits defines the measuring range in 2n increments per encoder shaft revolution; maximum travel until overflow; maximum travel within which the absolute value initialization can be unambiguous. In the case of single-turn encoders, MultiT = 0.
- P 544[0] - ENC_CH1_SingleT
- The number ""n"" of single-turn bits corresponds to the encoder’s digital resolution in 2n increments per encoder shaft revolution.
- P 554[0] - ENC_CH1_DigitalResolution
- This is the length of an increment, in nanometres, of the encoder’s digitally transmitted position value. This value is read from the EnDat linear head.

In the case of linear encoders, the number n of transmitted position bits from the encoder will be found in SingleT only! 2n * DigitalResolution yields the maximum travel in nanometres (for the encoder head).

P 640 - ENC_ENDAT is intended for additional information, but is normally not needed. This parameter does not have a Ch1 or Ch3 prefix for the encoder channel in the name, as it applies to both encoder channels. Although usually not needed, the parameter is helpful or required in the following cases:

1. Special EnDat encoder with diagnostics for evaluation
In this case, the valuation numbers from the encoder are read cyclically via additional information. Only the valuation numbers that the encoder supports.

# 6 Encoder

MOOG ID No.:CB40859-001 Date:11/2020

will be read. During the initialization process, the system will read the encoder to determine which valuation numbers it supports. When P 640[0] - ENDAT_Select = 1, the function will be enabled in the controller and the internal diagnostics in the EnDaT encoder will be enabled as well. The EnDat encoder will keep this setting even after being powered off. To explicitly disable the internal diagnostics in the EnDat encoder, set P 640[0] - ENDAT_Select to 2.

# 2. Evaluation of internal warnings

In this scenario, certain internal warnings from the encoder will be read from the encoder via additional information. Only the warnings that both the encoder and the Servo Drive’s software support will be read. During the initialization process, the system will read the encoder to determine which warnings it supports. When P 640[0] - ENDAT_Select = 3, the function will be enabled in the controller.

**Table 6.7: Channel 1 encoder configuration (X7) - EnDat parameters**
|ID|Index Name|Unit|Description|
|---|---|---|---|
|505|0 ENC_CH1_Sel|= ENDAT(4)| |
|543|0 ENC_CH1_MultiT|Number of MultiTurn bits (absolute encoder)| |
|544|0 ENC_CH1_SingleT|Number of SingleTurn bits (absolute encoder)| |
|547|0 ENC_CH1_MTBase|Definition of point of discontinuity in multi-turn range| |
|548|0 ENC_CH1_MTEnable|1: Use Multi-turn encoder as a single-turn encoder| |
|616|0 ENC_CH1_CycleCount|Position encoder sampling cycle (n x 125 μsec)| |
|598|0 ENC_CH1_Position|inc|Position encoder channel 1|
|554|0 ENC_CH1_|nm|Length of one increment (linear absolute encoder)|
|640|ENC_ENDAT| |EnDat additional (additional information)|
|640|0 ENDAT_Select|0=off|EnDat function selection, 1/2=diagnosis on/off, 3=warnings, FF=lock|
|640|1 ENDAT_DiagCount|u16|count new diagnosis block header|
|640|2 ENDAT_BWZ_1|lowbyte|vn1: incremental track|
|640|3 ENDAT_BWZ_3|lowbyte|vn3: absolute track|
|640|4 ENDAT_BWZ_4|lowbyte|vn4: position value formation|
|640|5 ENDAT_Status| |EnDat additional status output|
|640|6 ENDAT_Z1_Sel| |EnDat additional information 1 type selection|

**Table 6.7: Overwrite Channel 1 encoder configuration (X7) - EnDat parameters (continue)**
|ID|Index Name|Unit|Description|
|---|---|---|---|
|640|7 ENDAT_Z1_1| |Z1 info: dword 1|
|640|8 ENDAT_Z1_2| |Z1 info: dword 2|
|640|9 ENDAT_Z1_3| |Z1 info: dword 3|
|640|10 ENDAT_Z1_4| |Z1 info: dword 4|
|640|11 ENDAT_Z2_Sel| |EnDat additional information 2 type selection|
|640|12 ENDAT_Z2_1| |Z2 info: dword 1|
|640|13 ENDAT_Z2_2| |Z2 info: dword 2|
|640|14 ENDAT_Z2_3| |Z2 info: dword 3|
|640|15 ENDAT_Z2_4| |Z2 info: dword 4|
|640|16 ENDAT_Mode1|0=off|EnDat additional mode 1 selection|
|640|17 ENDAT_Mode2| |EnDat additional mode 2 selection|
|640|18 ENDAT_Mode3| |EnDat additional mode 3 selection|
|640|19 ENDAT_Mode4| |EnDat additional mode 4 selection|
|640|20 ENDAT_res1| |reserved 1|
|640|21 ENDAT_res2| |reserved 2|
|640|22 ENDAT_res3| |reserved 3|
|640|23 ENDAT_HwSyncStop|0=SyncOn|EnDat cyclic hw sync, stop/start 1/0|
|640|24 ENDAT_CyclCount| |call counter of cyclic function|
|640|25 ENDAT_BWZ_Supported| |vn supported (bit3=vn4, bit2=vn3, bit0=vn1)|
|640|26 ENDAT_BWZ1_| |vn1: bits[7..0] threshold level, bits[31..16]|
|640|27 ThresholdLevel| |how often number|
|640|28 ENDAT_BWZ3_| |vn3: bits[7..0] threshold level, bits[31..16]|
|640|29 ThresholdLevel| |how often number|
|640|30 ENDAT_BWZ4_| |vn4: bits[7..0] threshold level, bits[31..16]|
|640|31 ThresholdLevel| |how often number|
|640|32 ENDAT_BWZ_TEST_| |vn: bits[15..12] 'F', bits[11..8] vn.no., bits [7..0] vn overwrite value|

# 6.5.3 Hall sensor X7

Ch1: HALL(5) - Digital hall signals

Ch1: HALL_TTL(7) - Digital hall signals

NOTE

l The operation and configuration of Hall effect sensors is reserved for special applications. Consult with Moog if needed.

# 6.5.4 Sin/Cos / TTL X7

# 6.5.4.1 TTL encoder

Ch1: TTL(3) - TTL signals

TTL encoders are ...

- a. ... ... usually pure incremental encoders without an absolute value interface.
- b. In this case, P 540[0] - ENC_CH1_Abs must be set to OFF(0). ... ... in a few exceptional cases, incremental encoders with an SSI absolute value interface. In this case, P 540[0] - ENC_CH1_Abs must be accordingly set to SSI(1) (SSI_CONT(4) in special cases), so that it will be possible to read the absolute encoder position for the absolute value initialization routine once during the initialization phase.

# 6.5.4.1.1 Pure TTL incremental encoder

Set P 505[0] - ENC_CH1_Sel to TTL(3) and P 540[0] - ENC_CH1_Abs to OFF(0) when using pure TTL encoders, i.e. encoders without an absolute value interface but with a TTL zero pulse.

Linear TTL encoders are run as rotary encoders. For linear motor operation, P 542 [0] - ENC_CH1_Lines and the encoder gearing (see the “Encoder gearing” section) are used to establish the ratio for the linear motor’s pole pair subdivision (North-North) for commutation. 1 x North-North corresponds to one revolution from Lines. In this case, the motor pole pair number must be set to 1. Moreover, P 553[0] - ENC_CH1_PeriodLen is not used in this case.

The TTL interface accepts various TTL signal types, which can be selected using P 558[0] - ENC_CH1_TTL_SignalType:

- (0)AF_B - A/B tracks (forward counting, X4 encoding) - AB
- (1)AR_B - A/B tracks (reverse counting, X4 encoding) - AB_inv
- (2)ABDFN - A: Clock (falling edge), B: Direction (1 = positive) - PulseDir
- (3)ABDRP - A: Clock (rising edge), B: Direction (1 = negative) - PulseDir_inv
- (4)reserved

A maximum interpolation period, in ms (milliseconds), can be configured for the TTL interface using P 601[0] - ENC_CH1_Period. Within this context, Period is the maximum time of “no activity” since the last TTL counter event:

- Period = 0: Function disabled (default)
- Period > 0 (=n ms): If no counter event is registered in n ms, the speed will be set to 0.

# Zero pulse

There is no parameter for activating the zero pulse evaluation here, as this evaluation is controlled exclusively based on the homing mode (see Section ""Homing"" on page 249). However, setting P 541[0] - ENC_CH1_NpTest to 1 provides a test mode that can be used during commissioning in order to be able to activate the zero pulse evaluation even without homing. Scope signals 1014 and 1016 can be used to view a received zero pulse within this context. This test mode must be disabled during normal operation (P 541[0] = 0).

# Commutation

Motor operation with pure incremental encoders needs for the auto commutation function to be enabled without fail. For details see Section ""Synchronous motor auto commutation"" on page 156.

# 6.5.4.1.2 TTL incremental encoder with SSI absolute value interface

See Section ""Sin/Cos incremental encoders with absolute value interface"" on page 65 and in special Section ""SSI absolute value interface"" on page 67.

MSD ServoDrive - DeviceHelp

# 6 Encoder

MOOG ID No.:CB40859-001 Date:11/2020 MSD ServoDrive - DeviceHelp 64

|ID|Index Name|Unit|Description|
|---|---|---|---|
|505|0|ENC_CH1_Sel = 3|Encoder selection set to TTL(3)|
|510|0|ENC_CH1_Num|Encoder gearing: Numerator Ch1: SINCOS(1) - Sin/Cos signals|
|511|0|ENC_CH1_Denom|Encoder gearing: Denominator|
|540|0|ENC_CH1_Abs|Selection of absolute value interface Sin/Cos encoders can ...|
|541|0|ENC_CH1_NpTest|ENC CH1, TEST-MODE: Index pulse signal(s) to Scope|
|542|0|ENC_CH1_lines|Number of lines (Sin/Cos / TTL encoders) a. Be pure incremental encoders without an absolute value interface. In this|
|558|0|ENC_CH1_TTL_SignalType|Channel 1: TTL signal selection case, P 540[0] - ENC_CH1_Abs must be set to OFF(0).|
|601|0|ENC_CH1_Period|Maximum period of interpolation (TTL encoder)|
|616|0|ENC_CH1_CycleCount|Sampling cycle in: n x 125 μ (microseconds) b. Be incremental encoders with an absolute value interface. In this case,|

Table 6.8: Parameters for Channel 1 (X7) - TTL encoder

ENC_CH1_Abs must be accordingly set to SSI(1), EnDat(2), HIPER(3) or, in special cases, SSI_CONT(4) so that it will be possible to read the absolute encoder position for the absolute value initialization routine once during the initialization phase.

# 6.5.4.2.1 Purely Sin/Cos incremental encoders

To run these encoders as purely incremental encoders with a zero pulse on encoder channel Ch1 (without an absolute value interface), the approach is basically the same as for purely TTL operation (see Section ""TTL encoder"" on page 63). The same parameters apply.

However, there are the following differences:

- a. There are no different signal types for the Sin/Cos signal (always 1 Vss for cosine and sine).
- b. The zero pulse is the analog zero pulse typical of Sin/Cos encoders (see the “Connection for high-resolution encoders” section in the operation manual MSD Servo Drive Single-Axis System, for example).

# 6.5.4.2.2 Linear Sin/Cos

|ID|Index Name|Unit|Description|
|---|---|---|---|
|542|ENC_CH1_lines| |Number of Lines (Sin/Cos / TTL encoders)|
|543|ENC_CH1_MultiT| |Number of MultiTurn bits (absolute encoder)|
|544|ENC_CH1_SingleT| |Number of SingleTurn bits (absolute encoder)|
|545|ENC_CH1_Code| |Code selection (SSI encoder) (binary, gray)|
|546|ENC_CH1_Mode| |Mode selection (SSI encoder)|
|547|ENC_CH1_MTBase| |Definition of point of discontinuity in multi-turn range|
|548|ENC_CH1_MTEnable| |Enable MultiTurn use (negative logic, 1=MToff)|
|549|ENC_CH1_Corr| |Signal correction type|
|550|ENC_CH1_CorrVal|0-4|Signal correction values|
|551|ENC_CH1_EncObsMin| |Encoder monitoring minimum, sqrt(a^2+b^2)|
|552|ENC_CH1_AbsEncStatus| |Error and status codes (absolute encoder)|

# 6.5.4.2.3 Signal correction (GPOC)

|ID|Index Name|Unit|Description|
|---|---|---|---|
|553|ENC_CH1_PeriodLen|nm|Length of signal period (Sin/Cos linear encoder)|
|554|ENC_CH1_DigitalResolution|nm|Length of one increment (linear absolute encoder)|
|555|ENC_CH1_Info| |Encoder information|
|616|ENC_CH1_CycleCount| |Sampling cycle in: n x 125 μ (microseconds)|
|610|ENC_CH1_NominalIncrementA| |Sign. Nominal increment A (distance coded abs. per. encoder)|
|611|ENC_CH1_NominalIncrementB| |Sign. Nominal increment B (distance coded abs. per. encoder)|
|1900|ENC_ETS| |ETS mode, electronic nameplate|

# 6.5.4.2.4 Sin/Cos incremental encoders with absolute value interface

The following table lists the parameters for cyclical Sin/Cos operation on encoder channel Ch 1 with one-time reading of the absolute encoder position via the absolute value interface, i.e. without a zero pulse:

|ID|Index Name|Unit|Description|
|---|---|---|---|
|505|ENC_CH1_Sel|1|Encoder selection set to SINCOS(1)|
|510|ENC_CH1_Num| |Encoder gearing: Numerator|
|511|ENC_CH1_Denom| |Encoder gearing: Denominator|
|540|ENC_CH1_Abs| |Absolute value interface selection (one-time reading)|

Table 6.9: Parameters for channel 1 (X7) - Sin/Cos encoder

The Sel, Num, Denom, Abs, Lines, MultiT, SingleT and CorrVal parameters are self-explanatory.

The Code and Mode parameters are described in Section ""SSI (cyclical) X7"" on page 69.

P 547[0] - ENC_CH1_MTBase = Minimum MultiTurn position

The MTBase parameter is used to set a position in the multi-turn encoder’s travel path that defines the point of discontinuity (overflow/underflow) for the absolute value initialization (that is, the “multi-turn basis”). Assuming a bipolar encoder measuring range, all position values that fall below MTBase will be shifted “up” (the whole MT range will be added to them once).

MOOG ID No.:CB40859-001 Date:11/2020

MSD ServoDrive - DeviceHelp

# 6 Encoder

MOOG ID No.:CB40859-001 Date:11/2020

method makes it possible to place the point of discontinuity at any point within the encoder’s entire measuring range. By default, MTBase will be set to the lowest possible value for the parameter, i.e. reliably outside of the encoder’s value range: In this case, the full bipolar range will remain unaffected, as values will never fall below this MTBase threshold (see Section ""Channel 1: Interface X7"" on page 59).

- P 548[0] - ENC_CH1_MTEnable = MultiTurn as SingleTurn
- The MTEnable parameter makes it possible to use multi-turn encoders as single-turn encoders for test purposes. Negative logic: Default MTEnable = 0 means ""MultiTurn-Enable ON"".

P 549[0] - ENC_CH1_Corr = Signal correction type
- The GPOC routine used for track signal correction purposes for sine/cosine signals is used to compensate for systematic errors. The routine is controlled with the Corr and CorrVal parameters (see Section ""Signal correction GPOC (Gain Phase Offset Correction)"" on page 74).

P 551[0] - ENC_CH1_EncObsMin = Encoder monitoring minimum, sqrt (a^2+b^2)
- The parameter EncObsMin is used to scale the Sin/Cos wire break monitoring and represents the “downwards threshold” for an error message. The default setting is 0.2, corresponding to approx. ",What is the purpose of the P 640[0] - ENDAT_Select parameter in the EnDat encoder interface?,A4,"P 640[0] - ENDAT_Select serves to select EnDat functions, with options to manage diagnostics and warnings within the encoder system.",2.09375,2.21875,3.53125,1.671875,0.59765625
39,msd_servo_drive.txt,20,02f242a213dfa4411d028ce46dfba16a3f97395fa25788fcbaea1715e779d934,"), consult with your project supervisor or the Helpline provided by Moog before using any special SSI protocol modes.

# 6.5.2 EnDat (cyclical) X7

Ch1: ENDAT(4) - Cyclical EnDat (2.1 or 2.2) EnDat is a digital encoder interface developed by HEIDENHAIN. For more details, please visit www.heidenhain.de and go to ►Documentation ►Fundamentals ►Interfaces ►EnDat 2.2.

The software versions required to run the EnDat encoder interface are the standard software versions for the MSD Servo Drive and MSD Single-Axis Servo Drive Compact.

MOOG ID No.:CB40859-001 Date:11/2020

# 6 Encoder

NOTE

- Please note the limitations that apply when running EnDat and SSI encoders (see Section ""Limiting for EnDat and SSI"" on page 52).

When using linear encoders, P 554[0] - ENC_CH1_DigitalResolution is used instead of P 543[0] - ENC_CH1_MultiT and P 544[0] - ENC_CH1_SingleT (which are used for rotary encoders). The values will be read from the EnDat encoder and written to the aforementioned parameters.

- P 543[0] - ENC_CH1_MultiT
- The number ""n"" of multiturn bits defines the measuring range in 2n increments per encoder shaft revolution; maximum travel until overflow; maximum travel within which the absolute value initialization can be unambiguous. In the case of single-turn encoders, MultiT = 0.
- P 544[0] - ENC_CH1_SingleT
- The number ""n"" of single-turn bits corresponds to the encoder’s digital resolution in 2n increments per encoder shaft revolution.
- P 554[0] - ENC_CH1_DigitalResolution
- This is the length of an increment, in nanometres, of the encoder’s digitally transmitted position value. This value is read from the EnDat linear head.

In the case of linear encoders, the number n of transmitted position bits from the encoder will be found in SingleT only! 2n * DigitalResolution yields the maximum travel in nanometres (for the encoder head).

P 640 - ENC_ENDAT is intended for additional information, but is normally not needed. This parameter does not have a Ch1 or Ch3 prefix for the encoder channel in the name, as it applies to both encoder channels. Although usually not needed, the parameter is helpful or required in the following cases:

1. Special EnDat encoder with diagnostics for evaluation
In this case, the valuation numbers from the encoder are read cyclically via additional information. Only the valuation numbers that the encoder supports.

# 6 Encoder

MOOG ID No.:CB40859-001 Date:11/2020

will be read. During the initialization process, the system will read the encoder to determine which valuation numbers it supports. When P 640[0] - ENDAT_Select = 1, the function will be enabled in the controller and the internal diagnostics in the EnDaT encoder will be enabled as well. The EnDat encoder will keep this setting even after being powered off. To explicitly disable the internal diagnostics in the EnDat encoder, set P 640[0] - ENDAT_Select to 2.

# 2. Evaluation of internal warnings

In this scenario, certain internal warnings from the encoder will be read from the encoder via additional information. Only the warnings that both the encoder and the Servo Drive’s software support will be read. During the initialization process, the system will read the encoder to determine which warnings it supports. When P 640[0] - ENDAT_Select = 3, the function will be enabled in the controller.

**Table 6.7: Channel 1 encoder configuration (X7) - EnDat parameters**
|ID|Index Name|Unit|Description|
|---|---|---|---|
|505|0 ENC_CH1_Sel|= ENDAT(4)| |
|543|0 ENC_CH1_MultiT|Number of MultiTurn bits (absolute encoder)| |
|544|0 ENC_CH1_SingleT|Number of SingleTurn bits (absolute encoder)| |
|547|0 ENC_CH1_MTBase|Definition of point of discontinuity in multi-turn range| |
|548|0 ENC_CH1_MTEnable|1: Use Multi-turn encoder as a single-turn encoder| |
|616|0 ENC_CH1_CycleCount|Position encoder sampling cycle (n x 125 μsec)| |
|598|0 ENC_CH1_Position|inc|Position encoder channel 1|
|554|0 ENC_CH1_|nm|Length of one increment (linear absolute encoder)|
|640|ENC_ENDAT| |EnDat additional (additional information)|
|640|0 ENDAT_Select|0=off|EnDat function selection, 1/2=diagnosis on/off, 3=warnings, FF=lock|
|640|1 ENDAT_DiagCount|u16|count new diagnosis block header|
|640|2 ENDAT_BWZ_1|lowbyte|vn1: incremental track|
|640|3 ENDAT_BWZ_3|lowbyte|vn3: absolute track|
|640|4 ENDAT_BWZ_4|lowbyte|vn4: position value formation|
|640|5 ENDAT_Status| |EnDat additional status output|
|640|6 ENDAT_Z1_Sel| |EnDat additional information 1 type selection|

**Table 6.7: Overwrite Channel 1 encoder configuration (X7) - EnDat parameters (continue)**
|ID|Index Name|Unit|Description|
|---|---|---|---|
|640|7 ENDAT_Z1_1| |Z1 info: dword 1|
|640|8 ENDAT_Z1_2| |Z1 info: dword 2|
|640|9 ENDAT_Z1_3| |Z1 info: dword 3|
|640|10 ENDAT_Z1_4| |Z1 info: dword 4|
|640|11 ENDAT_Z2_Sel| |EnDat additional information 2 type selection|
|640|12 ENDAT_Z2_1| |Z2 info: dword 1|
|640|13 ENDAT_Z2_2| |Z2 info: dword 2|
|640|14 ENDAT_Z2_3| |Z2 info: dword 3|
|640|15 ENDAT_Z2_4| |Z2 info: dword 4|
|640|16 ENDAT_Mode1|0=off|EnDat additional mode 1 selection|
|640|17 ENDAT_Mode2| |EnDat additional mode 2 selection|
|640|18 ENDAT_Mode3| |EnDat additional mode 3 selection|
|640|19 ENDAT_Mode4| |EnDat additional mode 4 selection|
|640|20 ENDAT_res1| |reserved 1|
|640|21 ENDAT_res2| |reserved 2|
|640|22 ENDAT_res3| |reserved 3|
|640|23 ENDAT_HwSyncStop|0=SyncOn|EnDat cyclic hw sync, stop/start 1/0|
|640|24 ENDAT_CyclCount| |call counter of cyclic function|
|640|25 ENDAT_BWZ_Supported| |vn supported (bit3=vn4, bit2=vn3, bit0=vn1)|
|640|26 ENDAT_BWZ1_| |vn1: bits[7..0] threshold level, bits[31..16]|
|640|27 ThresholdLevel| |how often number|
|640|28 ENDAT_BWZ3_| |vn3: bits[7..0] threshold level, bits[31..16]|
|640|29 ThresholdLevel| |how often number|
|640|30 ENDAT_BWZ4_| |vn4: bits[7..0] threshold level, bits[31..16]|
|640|31 ThresholdLevel| |how often number|
|640|32 ENDAT_BWZ_TEST_| |vn: bits[15..12] 'F', bits[11..8] vn.no., bits [7..0] vn overwrite value|

# 6.5.3 Hall sensor X7

Ch1: HALL(5) - Digital hall signals

Ch1: HALL_TTL(7) - Digital hall signals

NOTE

l The operation and configuration of Hall effect sensors is reserved for special applications. Consult with Moog if needed.

# 6.5.4 Sin/Cos / TTL X7

# 6.5.4.1 TTL encoder

Ch1: TTL(3) - TTL signals

TTL encoders are ...

- a. ... ... usually pure incremental encoders without an absolute value interface.
- b. In this case, P 540[0] - ENC_CH1_Abs must be set to OFF(0). ... ... in a few exceptional cases, incremental encoders with an SSI absolute value interface. In this case, P 540[0] - ENC_CH1_Abs must be accordingly set to SSI(1) (SSI_CONT(4) in special cases), so that it will be possible to read the absolute encoder position for the absolute value initialization routine once during the initialization phase.

# 6.5.4.1.1 Pure TTL incremental encoder

Set P 505[0] - ENC_CH1_Sel to TTL(3) and P 540[0] - ENC_CH1_Abs to OFF(0) when using pure TTL encoders, i.e. encoders without an absolute value interface but with a TTL zero pulse.

Linear TTL encoders are run as rotary encoders. For linear motor operation, P 542 [0] - ENC_CH1_Lines and the encoder gearing (see the “Encoder gearing” section) are used to establish the ratio for the linear motor’s pole pair subdivision (North-North) for commutation. 1 x North-North corresponds to one revolution from Lines. In this case, the motor pole pair number must be set to 1. Moreover, P 553[0] - ENC_CH1_PeriodLen is not used in this case.

The TTL interface accepts various TTL signal types, which can be selected using P 558[0] - ENC_CH1_TTL_SignalType:

- (0)AF_B - A/B tracks (forward counting, X4 encoding) - AB
- (1)AR_B - A/B tracks (reverse counting, X4 encoding) - AB_inv
- (2)ABDFN - A: Clock (falling edge), B: Direction (1 = positive) - PulseDir
- (3)ABDRP - A: Clock (rising edge), B: Direction (1 = negative) - PulseDir_inv
- (4)reserved

A maximum interpolation period, in ms (milliseconds), can be configured for the TTL interface using P 601[0] - ENC_CH1_Period. Within this context, Period is the maximum time of “no activity” since the last TTL counter event:

- Period = 0: Function disabled (default)
- Period > 0 (=n ms): If no counter event is registered in n ms, the speed will be set to 0.

# Zero pulse

There is no parameter for activating the zero pulse evaluation here, as this evaluation is controlled exclusively based on the homing mode (see Section ""Homing"" on page 249). However, setting P 541[0] - ENC_CH1_NpTest to 1 provides a test mode that can be used during commissioning in order to be able to activate the zero pulse evaluation even without homing. Scope signals 1014 and 1016 can be used to view a received zero pulse within this context. This test mode must be disabled during normal operation (P 541[0] = 0).

# Commutation

Motor operation with pure incremental encoders needs for the auto commutation function to be enabled without fail. For details see Section ""Synchronous motor auto commutation"" on page 156.

# 6.5.4.1.2 TTL incremental encoder with SSI absolute value interface

See Section ""Sin/Cos incremental encoders with absolute value interface"" on page 65 and in special Section ""SSI absolute value interface"" on page 67.

MSD ServoDrive - DeviceHelp

# 6 Encoder

MOOG ID No.:CB40859-001 Date:11/2020 MSD ServoDrive - DeviceHelp 64

|ID|Index Name|Unit|Description|
|---|---|---|---|
|505|0|ENC_CH1_Sel = 3|Encoder selection set to TTL(3)|
|510|0|ENC_CH1_Num|Encoder gearing: Numerator Ch1: SINCOS(1) - Sin/Cos signals|
|511|0|ENC_CH1_Denom|Encoder gearing: Denominator|
|540|0|ENC_CH1_Abs|Selection of absolute value interface Sin/Cos encoders can ...|
|541|0|ENC_CH1_NpTest|ENC CH1, TEST-MODE: Index pulse signal(s) to Scope|
|542|0|ENC_CH1_lines|Number of lines (Sin/Cos / TTL encoders) a. Be pure incremental encoders without an absolute value interface. In this|
|558|0|ENC_CH1_TTL_SignalType|Channel 1: TTL signal selection case, P 540[0] - ENC_CH1_Abs must be set to OFF(0).|
|601|0|ENC_CH1_Period|Maximum period of interpolation (TTL encoder)|
|616|0|ENC_CH1_CycleCount|Sampling cycle in: n x 125 μ (microseconds) b. Be incremental encoders with an absolute value interface. In this case,|

Table 6.8: Parameters for Channel 1 (X7) - TTL encoder

ENC_CH1_Abs must be accordingly set to SSI(1), EnDat(2), HIPER(3) or, in special cases, SSI_CONT(4) so that it will be possible to read the absolute encoder position for the absolute value initialization routine once during the initialization phase.

# 6.5.4.2.1 Purely Sin/Cos incremental encoders

To run these encoders as purely incremental encoders with a zero pulse on encoder channel Ch1 (without an absolute value interface), the approach is basically the same as for purely TTL operation (see Section ""TTL encoder"" on page 63). The same parameters apply.

However, there are the following differences:

- a. There are no different signal types for the Sin/Cos signal (always 1 Vss for cosine and sine).
- b. The zero pulse is the analog zero pulse typical of Sin/Cos encoders (see the “Connection for high-resolution encoders” section in the operation manual MSD Servo Drive Single-Axis System, for example).

# 6.5.4.2.2 Linear Sin/Cos

|ID|Index Name|Unit|Description|
|---|---|---|---|
|542|ENC_CH1_lines| |Number of Lines (Sin/Cos / TTL encoders)|
|543|ENC_CH1_MultiT| |Number of MultiTurn bits (absolute encoder)|
|544|ENC_CH1_SingleT| |Number of SingleTurn bits (absolute encoder)|
|545|ENC_CH1_Code| |Code selection (SSI encoder) (binary, gray)|
|546|ENC_CH1_Mode| |Mode selection (SSI encoder)|
|547|ENC_CH1_MTBase| |Definition of point of discontinuity in multi-turn range|
|548|ENC_CH1_MTEnable| |Enable MultiTurn use (negative logic, 1=MToff)|
|549|ENC_CH1_Corr| |Signal correction type|
|550|ENC_CH1_CorrVal|0-4|Signal correction values|
|551|ENC_CH1_EncObsMin| |Encoder monitoring minimum, sqrt(a^2+b^2)|
|552|ENC_CH1_AbsEncStatus| |Error and status codes (absolute encoder)|

# 6.5.4.2.3 Signal correction (GPOC)

|ID|Index Name|Unit|Description|
|---|---|---|---|
|553|ENC_CH1_PeriodLen|nm|Length of signal period (Sin/Cos linear encoder)|
|554|ENC_CH1_DigitalResolution|nm|Length of one increment (linear absolute encoder)|
|555|ENC_CH1_Info| |Encoder information|
|616|ENC_CH1_CycleCount| |Sampling cycle in: n x 125 μ (microseconds)|
|610|ENC_CH1_NominalIncrementA| |Sign. Nominal increment A (distance coded abs. per. encoder)|
|611|ENC_CH1_NominalIncrementB| |Sign. Nominal increment B (distance coded abs. per. encoder)|
|1900|ENC_ETS| |ETS mode, electronic nameplate|

# 6.5.4.2.4 Sin/Cos incremental encoders with absolute value interface

The following table lists the parameters for cyclical Sin/Cos operation on encoder channel Ch 1 with one-time reading of the absolute encoder position via the absolute value interface, i.e. without a zero pulse:

|ID|Index Name|Unit|Description|
|---|---|---|---|
|505|ENC_CH1_Sel|1|Encoder selection set to SINCOS(1)|
|510|ENC_CH1_Num| |Encoder gearing: Numerator|
|511|ENC_CH1_Denom| |Encoder gearing: Denominator|
|540|ENC_CH1_Abs| |Absolute value interface selection (one-time reading)|

Table 6.9: Parameters for channel 1 (X7) - Sin/Cos encoder

The Sel, Num, Denom, Abs, Lines, MultiT, SingleT and CorrVal parameters are self-explanatory.

The Code and Mode parameters are described in Section ""SSI (cyclical) X7"" on page 69.

P 547[0] - ENC_CH1_MTBase = Minimum MultiTurn position

The MTBase parameter is used to set a position in the multi-turn encoder’s travel path that defines the point of discontinuity (overflow/underflow) for the absolute value initialization (that is, the “multi-turn basis”). Assuming a bipolar encoder measuring range, all position values that fall below MTBase will be shifted “up” (the whole MT range will be added to them once).

MOOG ID No.:CB40859-001 Date:11/2020

MSD ServoDrive - DeviceHelp

# 6 Encoder

MOOG ID No.:CB40859-001 Date:11/2020

method makes it possible to place the point of discontinuity at any point within the encoder’s entire measuring range. By default, MTBase will be set to the lowest possible value for the parameter, i.e. reliably outside of the encoder’s value range: In this case, the full bipolar range will remain unaffected, as values will never fall below this MTBase threshold (see Section ""Channel 1: Interface X7"" on page 59).

- P 548[0] - ENC_CH1_MTEnable = MultiTurn as SingleTurn
- The MTEnable parameter makes it possible to use multi-turn encoders as single-turn encoders for test purposes. Negative logic: Default MTEnable = 0 means ""MultiTurn-Enable ON"".

P 549[0] - ENC_CH1_Corr = Signal correction type
- The GPOC routine used for track signal correction purposes for sine/cosine signals is used to compensate for systematic errors. The routine is controlled with the Corr and CorrVal parameters (see Section ""Signal correction GPOC (Gain Phase Offset Correction)"" on page 74).

P 551[0] - ENC_CH1_EncObsMin = Encoder monitoring minimum, sqrt (a^2+b^2)
- The parameter EncObsMin is used to scale the Sin/Cos wire break monitoring and represents the “downwards threshold” for an error message. The default setting is 0.2, corresponding to approx. ",What is the purpose of the P 640[0] - ENDAT_Select parameter in the EnDat encoder interface?,A5,"In the EnDat encoder setup, P 640[0] - ENDAT_Select determines the activation of diagnostic features and warning systems, with specific values for each function.",1.15625,1.2265625,3.359375,1.6015625,0.54296875
40,msd_servo_drive.txt,20,02f242a213dfa4411d028ce46dfba16a3f97395fa25788fcbaea1715e779d934,"), consult with your project supervisor or the Helpline provided by Moog before using any special SSI protocol modes.

# 6.5.2 EnDat (cyclical) X7

Ch1: ENDAT(4) - Cyclical EnDat (2.1 or 2.2) EnDat is a digital encoder interface developed by HEIDENHAIN. For more details, please visit www.heidenhain.de and go to ►Documentation ►Fundamentals ►Interfaces ►EnDat 2.2.

The software versions required to run the EnDat encoder interface are the standard software versions for the MSD Servo Drive and MSD Single-Axis Servo Drive Compact.

MOOG ID No.:CB40859-001 Date:11/2020

# 6 Encoder

NOTE

- Please note the limitations that apply when running EnDat and SSI encoders (see Section ""Limiting for EnDat and SSI"" on page 52).

When using linear encoders, P 554[0] - ENC_CH1_DigitalResolution is used instead of P 543[0] - ENC_CH1_MultiT and P 544[0] - ENC_CH1_SingleT (which are used for rotary encoders). The values will be read from the EnDat encoder and written to the aforementioned parameters.

- P 543[0] - ENC_CH1_MultiT
- The number ""n"" of multiturn bits defines the measuring range in 2n increments per encoder shaft revolution; maximum travel until overflow; maximum travel within which the absolute value initialization can be unambiguous. In the case of single-turn encoders, MultiT = 0.
- P 544[0] - ENC_CH1_SingleT
- The number ""n"" of single-turn bits corresponds to the encoder’s digital resolution in 2n increments per encoder shaft revolution.
- P 554[0] - ENC_CH1_DigitalResolution
- This is the length of an increment, in nanometres, of the encoder’s digitally transmitted position value. This value is read from the EnDat linear head.

In the case of linear encoders, the number n of transmitted position bits from the encoder will be found in SingleT only! 2n * DigitalResolution yields the maximum travel in nanometres (for the encoder head).

P 640 - ENC_ENDAT is intended for additional information, but is normally not needed. This parameter does not have a Ch1 or Ch3 prefix for the encoder channel in the name, as it applies to both encoder channels. Although usually not needed, the parameter is helpful or required in the following cases:

1. Special EnDat encoder with diagnostics for evaluation
In this case, the valuation numbers from the encoder are read cyclically via additional information. Only the valuation numbers that the encoder supports.

# 6 Encoder

MOOG ID No.:CB40859-001 Date:11/2020

will be read. During the initialization process, the system will read the encoder to determine which valuation numbers it supports. When P 640[0] - ENDAT_Select = 1, the function will be enabled in the controller and the internal diagnostics in the EnDaT encoder will be enabled as well. The EnDat encoder will keep this setting even after being powered off. To explicitly disable the internal diagnostics in the EnDat encoder, set P 640[0] - ENDAT_Select to 2.

# 2. Evaluation of internal warnings

In this scenario, certain internal warnings from the encoder will be read from the encoder via additional information. Only the warnings that both the encoder and the Servo Drive’s software support will be read. During the initialization process, the system will read the encoder to determine which warnings it supports. When P 640[0] - ENDAT_Select = 3, the function will be enabled in the controller.

**Table 6.7: Channel 1 encoder configuration (X7) - EnDat parameters**
|ID|Index Name|Unit|Description|
|---|---|---|---|
|505|0 ENC_CH1_Sel|= ENDAT(4)| |
|543|0 ENC_CH1_MultiT|Number of MultiTurn bits (absolute encoder)| |
|544|0 ENC_CH1_SingleT|Number of SingleTurn bits (absolute encoder)| |
|547|0 ENC_CH1_MTBase|Definition of point of discontinuity in multi-turn range| |
|548|0 ENC_CH1_MTEnable|1: Use Multi-turn encoder as a single-turn encoder| |
|616|0 ENC_CH1_CycleCount|Position encoder sampling cycle (n x 125 μsec)| |
|598|0 ENC_CH1_Position|inc|Position encoder channel 1|
|554|0 ENC_CH1_|nm|Length of one increment (linear absolute encoder)|
|640|ENC_ENDAT| |EnDat additional (additional information)|
|640|0 ENDAT_Select|0=off|EnDat function selection, 1/2=diagnosis on/off, 3=warnings, FF=lock|
|640|1 ENDAT_DiagCount|u16|count new diagnosis block header|
|640|2 ENDAT_BWZ_1|lowbyte|vn1: incremental track|
|640|3 ENDAT_BWZ_3|lowbyte|vn3: absolute track|
|640|4 ENDAT_BWZ_4|lowbyte|vn4: position value formation|
|640|5 ENDAT_Status| |EnDat additional status output|
|640|6 ENDAT_Z1_Sel| |EnDat additional information 1 type selection|

**Table 6.7: Overwrite Channel 1 encoder configuration (X7) - EnDat parameters (continue)**
|ID|Index Name|Unit|Description|
|---|---|---|---|
|640|7 ENDAT_Z1_1| |Z1 info: dword 1|
|640|8 ENDAT_Z1_2| |Z1 info: dword 2|
|640|9 ENDAT_Z1_3| |Z1 info: dword 3|
|640|10 ENDAT_Z1_4| |Z1 info: dword 4|
|640|11 ENDAT_Z2_Sel| |EnDat additional information 2 type selection|
|640|12 ENDAT_Z2_1| |Z2 info: dword 1|
|640|13 ENDAT_Z2_2| |Z2 info: dword 2|
|640|14 ENDAT_Z2_3| |Z2 info: dword 3|
|640|15 ENDAT_Z2_4| |Z2 info: dword 4|
|640|16 ENDAT_Mode1|0=off|EnDat additional mode 1 selection|
|640|17 ENDAT_Mode2| |EnDat additional mode 2 selection|
|640|18 ENDAT_Mode3| |EnDat additional mode 3 selection|
|640|19 ENDAT_Mode4| |EnDat additional mode 4 selection|
|640|20 ENDAT_res1| |reserved 1|
|640|21 ENDAT_res2| |reserved 2|
|640|22 ENDAT_res3| |reserved 3|
|640|23 ENDAT_HwSyncStop|0=SyncOn|EnDat cyclic hw sync, stop/start 1/0|
|640|24 ENDAT_CyclCount| |call counter of cyclic function|
|640|25 ENDAT_BWZ_Supported| |vn supported (bit3=vn4, bit2=vn3, bit0=vn1)|
|640|26 ENDAT_BWZ1_| |vn1: bits[7..0] threshold level, bits[31..16]|
|640|27 ThresholdLevel| |how often number|
|640|28 ENDAT_BWZ3_| |vn3: bits[7..0] threshold level, bits[31..16]|
|640|29 ThresholdLevel| |how often number|
|640|30 ENDAT_BWZ4_| |vn4: bits[7..0] threshold level, bits[31..16]|
|640|31 ThresholdLevel| |how often number|
|640|32 ENDAT_BWZ_TEST_| |vn: bits[15..12] 'F', bits[11..8] vn.no., bits [7..0] vn overwrite value|

# 6.5.3 Hall sensor X7

Ch1: HALL(5) - Digital hall signals

Ch1: HALL_TTL(7) - Digital hall signals

NOTE

l The operation and configuration of Hall effect sensors is reserved for special applications. Consult with Moog if needed.

# 6.5.4 Sin/Cos / TTL X7

# 6.5.4.1 TTL encoder

Ch1: TTL(3) - TTL signals

TTL encoders are ...

- a. ... ... usually pure incremental encoders without an absolute value interface.
- b. In this case, P 540[0] - ENC_CH1_Abs must be set to OFF(0). ... ... in a few exceptional cases, incremental encoders with an SSI absolute value interface. In this case, P 540[0] - ENC_CH1_Abs must be accordingly set to SSI(1) (SSI_CONT(4) in special cases), so that it will be possible to read the absolute encoder position for the absolute value initialization routine once during the initialization phase.

# 6.5.4.1.1 Pure TTL incremental encoder

Set P 505[0] - ENC_CH1_Sel to TTL(3) and P 540[0] - ENC_CH1_Abs to OFF(0) when using pure TTL encoders, i.e. encoders without an absolute value interface but with a TTL zero pulse.

Linear TTL encoders are run as rotary encoders. For linear motor operation, P 542 [0] - ENC_CH1_Lines and the encoder gearing (see the “Encoder gearing” section) are used to establish the ratio for the linear motor’s pole pair subdivision (North-North) for commutation. 1 x North-North corresponds to one revolution from Lines. In this case, the motor pole pair number must be set to 1. Moreover, P 553[0] - ENC_CH1_PeriodLen is not used in this case.

The TTL interface accepts various TTL signal types, which can be selected using P 558[0] - ENC_CH1_TTL_SignalType:

- (0)AF_B - A/B tracks (forward counting, X4 encoding) - AB
- (1)AR_B - A/B tracks (reverse counting, X4 encoding) - AB_inv
- (2)ABDFN - A: Clock (falling edge), B: Direction (1 = positive) - PulseDir
- (3)ABDRP - A: Clock (rising edge), B: Direction (1 = negative) - PulseDir_inv
- (4)reserved

A maximum interpolation period, in ms (milliseconds), can be configured for the TTL interface using P 601[0] - ENC_CH1_Period. Within this context, Period is the maximum time of “no activity” since the last TTL counter event:

- Period = 0: Function disabled (default)
- Period > 0 (=n ms): If no counter event is registered in n ms, the speed will be set to 0.

# Zero pulse

There is no parameter for activating the zero pulse evaluation here, as this evaluation is controlled exclusively based on the homing mode (see Section ""Homing"" on page 249). However, setting P 541[0] - ENC_CH1_NpTest to 1 provides a test mode that can be used during commissioning in order to be able to activate the zero pulse evaluation even without homing. Scope signals 1014 and 1016 can be used to view a received zero pulse within this context. This test mode must be disabled during normal operation (P 541[0] = 0).

# Commutation

Motor operation with pure incremental encoders needs for the auto commutation function to be enabled without fail. For details see Section ""Synchronous motor auto commutation"" on page 156.

# 6.5.4.1.2 TTL incremental encoder with SSI absolute value interface

See Section ""Sin/Cos incremental encoders with absolute value interface"" on page 65 and in special Section ""SSI absolute value interface"" on page 67.

MSD ServoDrive - DeviceHelp

# 6 Encoder

MOOG ID No.:CB40859-001 Date:11/2020 MSD ServoDrive - DeviceHelp 64

|ID|Index Name|Unit|Description|
|---|---|---|---|
|505|0|ENC_CH1_Sel = 3|Encoder selection set to TTL(3)|
|510|0|ENC_CH1_Num|Encoder gearing: Numerator Ch1: SINCOS(1) - Sin/Cos signals|
|511|0|ENC_CH1_Denom|Encoder gearing: Denominator|
|540|0|ENC_CH1_Abs|Selection of absolute value interface Sin/Cos encoders can ...|
|541|0|ENC_CH1_NpTest|ENC CH1, TEST-MODE: Index pulse signal(s) to Scope|
|542|0|ENC_CH1_lines|Number of lines (Sin/Cos / TTL encoders) a. Be pure incremental encoders without an absolute value interface. In this|
|558|0|ENC_CH1_TTL_SignalType|Channel 1: TTL signal selection case, P 540[0] - ENC_CH1_Abs must be set to OFF(0).|
|601|0|ENC_CH1_Period|Maximum period of interpolation (TTL encoder)|
|616|0|ENC_CH1_CycleCount|Sampling cycle in: n x 125 μ (microseconds) b. Be incremental encoders with an absolute value interface. In this case,|

Table 6.8: Parameters for Channel 1 (X7) - TTL encoder

ENC_CH1_Abs must be accordingly set to SSI(1), EnDat(2), HIPER(3) or, in special cases, SSI_CONT(4) so that it will be possible to read the absolute encoder position for the absolute value initialization routine once during the initialization phase.

# 6.5.4.2.1 Purely Sin/Cos incremental encoders

To run these encoders as purely incremental encoders with a zero pulse on encoder channel Ch1 (without an absolute value interface), the approach is basically the same as for purely TTL operation (see Section ""TTL encoder"" on page 63). The same parameters apply.

However, there are the following differences:

- a. There are no different signal types for the Sin/Cos signal (always 1 Vss for cosine and sine).
- b. The zero pulse is the analog zero pulse typical of Sin/Cos encoders (see the “Connection for high-resolution encoders” section in the operation manual MSD Servo Drive Single-Axis System, for example).

# 6.5.4.2.2 Linear Sin/Cos

|ID|Index Name|Unit|Description|
|---|---|---|---|
|542|ENC_CH1_lines| |Number of Lines (Sin/Cos / TTL encoders)|
|543|ENC_CH1_MultiT| |Number of MultiTurn bits (absolute encoder)|
|544|ENC_CH1_SingleT| |Number of SingleTurn bits (absolute encoder)|
|545|ENC_CH1_Code| |Code selection (SSI encoder) (binary, gray)|
|546|ENC_CH1_Mode| |Mode selection (SSI encoder)|
|547|ENC_CH1_MTBase| |Definition of point of discontinuity in multi-turn range|
|548|ENC_CH1_MTEnable| |Enable MultiTurn use (negative logic, 1=MToff)|
|549|ENC_CH1_Corr| |Signal correction type|
|550|ENC_CH1_CorrVal|0-4|Signal correction values|
|551|ENC_CH1_EncObsMin| |Encoder monitoring minimum, sqrt(a^2+b^2)|
|552|ENC_CH1_AbsEncStatus| |Error and status codes (absolute encoder)|

# 6.5.4.2.3 Signal correction (GPOC)

|ID|Index Name|Unit|Description|
|---|---|---|---|
|553|ENC_CH1_PeriodLen|nm|Length of signal period (Sin/Cos linear encoder)|
|554|ENC_CH1_DigitalResolution|nm|Length of one increment (linear absolute encoder)|
|555|ENC_CH1_Info| |Encoder information|
|616|ENC_CH1_CycleCount| |Sampling cycle in: n x 125 μ (microseconds)|
|610|ENC_CH1_NominalIncrementA| |Sign. Nominal increment A (distance coded abs. per. encoder)|
|611|ENC_CH1_NominalIncrementB| |Sign. Nominal increment B (distance coded abs. per. encoder)|
|1900|ENC_ETS| |ETS mode, electronic nameplate|

# 6.5.4.2.4 Sin/Cos incremental encoders with absolute value interface

The following table lists the parameters for cyclical Sin/Cos operation on encoder channel Ch 1 with one-time reading of the absolute encoder position via the absolute value interface, i.e. without a zero pulse:

|ID|Index Name|Unit|Description|
|---|---|---|---|
|505|ENC_CH1_Sel|1|Encoder selection set to SINCOS(1)|
|510|ENC_CH1_Num| |Encoder gearing: Numerator|
|511|ENC_CH1_Denom| |Encoder gearing: Denominator|
|540|ENC_CH1_Abs| |Absolute value interface selection (one-time reading)|

Table 6.9: Parameters for channel 1 (X7) - Sin/Cos encoder

The Sel, Num, Denom, Abs, Lines, MultiT, SingleT and CorrVal parameters are self-explanatory.

The Code and Mode parameters are described in Section ""SSI (cyclical) X7"" on page 69.

P 547[0] - ENC_CH1_MTBase = Minimum MultiTurn position

The MTBase parameter is used to set a position in the multi-turn encoder’s travel path that defines the point of discontinuity (overflow/underflow) for the absolute value initialization (that is, the “multi-turn basis”). Assuming a bipolar encoder measuring range, all position values that fall below MTBase will be shifted “up” (the whole MT range will be added to them once).

MOOG ID No.:CB40859-001 Date:11/2020

MSD ServoDrive - DeviceHelp

# 6 Encoder

MOOG ID No.:CB40859-001 Date:11/2020

method makes it possible to place the point of discontinuity at any point within the encoder’s entire measuring range. By default, MTBase will be set to the lowest possible value for the parameter, i.e. reliably outside of the encoder’s value range: In this case, the full bipolar range will remain unaffected, as values will never fall below this MTBase threshold (see Section ""Channel 1: Interface X7"" on page 59).

- P 548[0] - ENC_CH1_MTEnable = MultiTurn as SingleTurn
- The MTEnable parameter makes it possible to use multi-turn encoders as single-turn encoders for test purposes. Negative logic: Default MTEnable = 0 means ""MultiTurn-Enable ON"".

P 549[0] - ENC_CH1_Corr = Signal correction type
- The GPOC routine used for track signal correction purposes for sine/cosine signals is used to compensate for systematic errors. The routine is controlled with the Corr and CorrVal parameters (see Section ""Signal correction GPOC (Gain Phase Offset Correction)"" on page 74).

P 551[0] - ENC_CH1_EncObsMin = Encoder monitoring minimum, sqrt (a^2+b^2)
- The parameter EncObsMin is used to scale the Sin/Cos wire break monitoring and represents the “downwards threshold” for an error message. The default setting is 0.2, corresponding to approx. ",What is the significance of the P 640[25] - ENDAT_BWZ_Supported parameter in the EnDat encoder interface?,A1,"P 640[25] indicates which valuation numbers (vn) the EnDat encoder supports, with specific bits representing different vn types.",1.4375,1.59375,3.328125,1.4921875,0.5234375
41,msd_servo_drive.txt,20,02f242a213dfa4411d028ce46dfba16a3f97395fa25788fcbaea1715e779d934,"), consult with your project supervisor or the Helpline provided by Moog before using any special SSI protocol modes.

# 6.5.2 EnDat (cyclical) X7

Ch1: ENDAT(4) - Cyclical EnDat (2.1 or 2.2) EnDat is a digital encoder interface developed by HEIDENHAIN. For more details, please visit www.heidenhain.de and go to ►Documentation ►Fundamentals ►Interfaces ►EnDat 2.2.

The software versions required to run the EnDat encoder interface are the standard software versions for the MSD Servo Drive and MSD Single-Axis Servo Drive Compact.

MOOG ID No.:CB40859-001 Date:11/2020

# 6 Encoder

NOTE

- Please note the limitations that apply when running EnDat and SSI encoders (see Section ""Limiting for EnDat and SSI"" on page 52).

When using linear encoders, P 554[0] - ENC_CH1_DigitalResolution is used instead of P 543[0] - ENC_CH1_MultiT and P 544[0] - ENC_CH1_SingleT (which are used for rotary encoders). The values will be read from the EnDat encoder and written to the aforementioned parameters.

- P 543[0] - ENC_CH1_MultiT
- The number ""n"" of multiturn bits defines the measuring range in 2n increments per encoder shaft revolution; maximum travel until overflow; maximum travel within which the absolute value initialization can be unambiguous. In the case of single-turn encoders, MultiT = 0.
- P 544[0] - ENC_CH1_SingleT
- The number ""n"" of single-turn bits corresponds to the encoder’s digital resolution in 2n increments per encoder shaft revolution.
- P 554[0] - ENC_CH1_DigitalResolution
- This is the length of an increment, in nanometres, of the encoder’s digitally transmitted position value. This value is read from the EnDat linear head.

In the case of linear encoders, the number n of transmitted position bits from the encoder will be found in SingleT only! 2n * DigitalResolution yields the maximum travel in nanometres (for the encoder head).

P 640 - ENC_ENDAT is intended for additional information, but is normally not needed. This parameter does not have a Ch1 or Ch3 prefix for the encoder channel in the name, as it applies to both encoder channels. Although usually not needed, the parameter is helpful or required in the following cases:

1. Special EnDat encoder with diagnostics for evaluation
In this case, the valuation numbers from the encoder are read cyclically via additional information. Only the valuation numbers that the encoder supports.

# 6 Encoder

MOOG ID No.:CB40859-001 Date:11/2020

will be read. During the initialization process, the system will read the encoder to determine which valuation numbers it supports. When P 640[0] - ENDAT_Select = 1, the function will be enabled in the controller and the internal diagnostics in the EnDaT encoder will be enabled as well. The EnDat encoder will keep this setting even after being powered off. To explicitly disable the internal diagnostics in the EnDat encoder, set P 640[0] - ENDAT_Select to 2.

# 2. Evaluation of internal warnings

In this scenario, certain internal warnings from the encoder will be read from the encoder via additional information. Only the warnings that both the encoder and the Servo Drive’s software support will be read. During the initialization process, the system will read the encoder to determine which warnings it supports. When P 640[0] - ENDAT_Select = 3, the function will be enabled in the controller.

**Table 6.7: Channel 1 encoder configuration (X7) - EnDat parameters**
|ID|Index Name|Unit|Description|
|---|---|---|---|
|505|0 ENC_CH1_Sel|= ENDAT(4)| |
|543|0 ENC_CH1_MultiT|Number of MultiTurn bits (absolute encoder)| |
|544|0 ENC_CH1_SingleT|Number of SingleTurn bits (absolute encoder)| |
|547|0 ENC_CH1_MTBase|Definition of point of discontinuity in multi-turn range| |
|548|0 ENC_CH1_MTEnable|1: Use Multi-turn encoder as a single-turn encoder| |
|616|0 ENC_CH1_CycleCount|Position encoder sampling cycle (n x 125 μsec)| |
|598|0 ENC_CH1_Position|inc|Position encoder channel 1|
|554|0 ENC_CH1_|nm|Length of one increment (linear absolute encoder)|
|640|ENC_ENDAT| |EnDat additional (additional information)|
|640|0 ENDAT_Select|0=off|EnDat function selection, 1/2=diagnosis on/off, 3=warnings, FF=lock|
|640|1 ENDAT_DiagCount|u16|count new diagnosis block header|
|640|2 ENDAT_BWZ_1|lowbyte|vn1: incremental track|
|640|3 ENDAT_BWZ_3|lowbyte|vn3: absolute track|
|640|4 ENDAT_BWZ_4|lowbyte|vn4: position value formation|
|640|5 ENDAT_Status| |EnDat additional status output|
|640|6 ENDAT_Z1_Sel| |EnDat additional information 1 type selection|

**Table 6.7: Overwrite Channel 1 encoder configuration (X7) - EnDat parameters (continue)**
|ID|Index Name|Unit|Description|
|---|---|---|---|
|640|7 ENDAT_Z1_1| |Z1 info: dword 1|
|640|8 ENDAT_Z1_2| |Z1 info: dword 2|
|640|9 ENDAT_Z1_3| |Z1 info: dword 3|
|640|10 ENDAT_Z1_4| |Z1 info: dword 4|
|640|11 ENDAT_Z2_Sel| |EnDat additional information 2 type selection|
|640|12 ENDAT_Z2_1| |Z2 info: dword 1|
|640|13 ENDAT_Z2_2| |Z2 info: dword 2|
|640|14 ENDAT_Z2_3| |Z2 info: dword 3|
|640|15 ENDAT_Z2_4| |Z2 info: dword 4|
|640|16 ENDAT_Mode1|0=off|EnDat additional mode 1 selection|
|640|17 ENDAT_Mode2| |EnDat additional mode 2 selection|
|640|18 ENDAT_Mode3| |EnDat additional mode 3 selection|
|640|19 ENDAT_Mode4| |EnDat additional mode 4 selection|
|640|20 ENDAT_res1| |reserved 1|
|640|21 ENDAT_res2| |reserved 2|
|640|22 ENDAT_res3| |reserved 3|
|640|23 ENDAT_HwSyncStop|0=SyncOn|EnDat cyclic hw sync, stop/start 1/0|
|640|24 ENDAT_CyclCount| |call counter of cyclic function|
|640|25 ENDAT_BWZ_Supported| |vn supported (bit3=vn4, bit2=vn3, bit0=vn1)|
|640|26 ENDAT_BWZ1_| |vn1: bits[7..0] threshold level, bits[31..16]|
|640|27 ThresholdLevel| |how often number|
|640|28 ENDAT_BWZ3_| |vn3: bits[7..0] threshold level, bits[31..16]|
|640|29 ThresholdLevel| |how often number|
|640|30 ENDAT_BWZ4_| |vn4: bits[7..0] threshold level, bits[31..16]|
|640|31 ThresholdLevel| |how often number|
|640|32 ENDAT_BWZ_TEST_| |vn: bits[15..12] 'F', bits[11..8] vn.no., bits [7..0] vn overwrite value|

# 6.5.3 Hall sensor X7

Ch1: HALL(5) - Digital hall signals

Ch1: HALL_TTL(7) - Digital hall signals

NOTE

l The operation and configuration of Hall effect sensors is reserved for special applications. Consult with Moog if needed.

# 6.5.4 Sin/Cos / TTL X7

# 6.5.4.1 TTL encoder

Ch1: TTL(3) - TTL signals

TTL encoders are ...

- a. ... ... usually pure incremental encoders without an absolute value interface.
- b. In this case, P 540[0] - ENC_CH1_Abs must be set to OFF(0). ... ... in a few exceptional cases, incremental encoders with an SSI absolute value interface. In this case, P 540[0] - ENC_CH1_Abs must be accordingly set to SSI(1) (SSI_CONT(4) in special cases), so that it will be possible to read the absolute encoder position for the absolute value initialization routine once during the initialization phase.

# 6.5.4.1.1 Pure TTL incremental encoder

Set P 505[0] - ENC_CH1_Sel to TTL(3) and P 540[0] - ENC_CH1_Abs to OFF(0) when using pure TTL encoders, i.e. encoders without an absolute value interface but with a TTL zero pulse.

Linear TTL encoders are run as rotary encoders. For linear motor operation, P 542 [0] - ENC_CH1_Lines and the encoder gearing (see the “Encoder gearing” section) are used to establish the ratio for the linear motor’s pole pair subdivision (North-North) for commutation. 1 x North-North corresponds to one revolution from Lines. In this case, the motor pole pair number must be set to 1. Moreover, P 553[0] - ENC_CH1_PeriodLen is not used in this case.

The TTL interface accepts various TTL signal types, which can be selected using P 558[0] - ENC_CH1_TTL_SignalType:

- (0)AF_B - A/B tracks (forward counting, X4 encoding) - AB
- (1)AR_B - A/B tracks (reverse counting, X4 encoding) - AB_inv
- (2)ABDFN - A: Clock (falling edge), B: Direction (1 = positive) - PulseDir
- (3)ABDRP - A: Clock (rising edge), B: Direction (1 = negative) - PulseDir_inv
- (4)reserved

A maximum interpolation period, in ms (milliseconds), can be configured for the TTL interface using P 601[0] - ENC_CH1_Period. Within this context, Period is the maximum time of “no activity” since the last TTL counter event:

- Period = 0: Function disabled (default)
- Period > 0 (=n ms): If no counter event is registered in n ms, the speed will be set to 0.

# Zero pulse

There is no parameter for activating the zero pulse evaluation here, as this evaluation is controlled exclusively based on the homing mode (see Section ""Homing"" on page 249). However, setting P 541[0] - ENC_CH1_NpTest to 1 provides a test mode that can be used during commissioning in order to be able to activate the zero pulse evaluation even without homing. Scope signals 1014 and 1016 can be used to view a received zero pulse within this context. This test mode must be disabled during normal operation (P 541[0] = 0).

# Commutation

Motor operation with pure incremental encoders needs for the auto commutation function to be enabled without fail. For details see Section ""Synchronous motor auto commutation"" on page 156.

# 6.5.4.1.2 TTL incremental encoder with SSI absolute value interface

See Section ""Sin/Cos incremental encoders with absolute value interface"" on page 65 and in special Section ""SSI absolute value interface"" on page 67.

MSD ServoDrive - DeviceHelp

# 6 Encoder

MOOG ID No.:CB40859-001 Date:11/2020 MSD ServoDrive - DeviceHelp 64

|ID|Index Name|Unit|Description|
|---|---|---|---|
|505|0|ENC_CH1_Sel = 3|Encoder selection set to TTL(3)|
|510|0|ENC_CH1_Num|Encoder gearing: Numerator Ch1: SINCOS(1) - Sin/Cos signals|
|511|0|ENC_CH1_Denom|Encoder gearing: Denominator|
|540|0|ENC_CH1_Abs|Selection of absolute value interface Sin/Cos encoders can ...|
|541|0|ENC_CH1_NpTest|ENC CH1, TEST-MODE: Index pulse signal(s) to Scope|
|542|0|ENC_CH1_lines|Number of lines (Sin/Cos / TTL encoders) a. Be pure incremental encoders without an absolute value interface. In this|
|558|0|ENC_CH1_TTL_SignalType|Channel 1: TTL signal selection case, P 540[0] - ENC_CH1_Abs must be set to OFF(0).|
|601|0|ENC_CH1_Period|Maximum period of interpolation (TTL encoder)|
|616|0|ENC_CH1_CycleCount|Sampling cycle in: n x 125 μ (microseconds) b. Be incremental encoders with an absolute value interface. In this case,|

Table 6.8: Parameters for Channel 1 (X7) - TTL encoder

ENC_CH1_Abs must be accordingly set to SSI(1), EnDat(2), HIPER(3) or, in special cases, SSI_CONT(4) so that it will be possible to read the absolute encoder position for the absolute value initialization routine once during the initialization phase.

# 6.5.4.2.1 Purely Sin/Cos incremental encoders

To run these encoders as purely incremental encoders with a zero pulse on encoder channel Ch1 (without an absolute value interface), the approach is basically the same as for purely TTL operation (see Section ""TTL encoder"" on page 63). The same parameters apply.

However, there are the following differences:

- a. There are no different signal types for the Sin/Cos signal (always 1 Vss for cosine and sine).
- b. The zero pulse is the analog zero pulse typical of Sin/Cos encoders (see the “Connection for high-resolution encoders” section in the operation manual MSD Servo Drive Single-Axis System, for example).

# 6.5.4.2.2 Linear Sin/Cos

|ID|Index Name|Unit|Description|
|---|---|---|---|
|542|ENC_CH1_lines| |Number of Lines (Sin/Cos / TTL encoders)|
|543|ENC_CH1_MultiT| |Number of MultiTurn bits (absolute encoder)|
|544|ENC_CH1_SingleT| |Number of SingleTurn bits (absolute encoder)|
|545|ENC_CH1_Code| |Code selection (SSI encoder) (binary, gray)|
|546|ENC_CH1_Mode| |Mode selection (SSI encoder)|
|547|ENC_CH1_MTBase| |Definition of point of discontinuity in multi-turn range|
|548|ENC_CH1_MTEnable| |Enable MultiTurn use (negative logic, 1=MToff)|
|549|ENC_CH1_Corr| |Signal correction type|
|550|ENC_CH1_CorrVal|0-4|Signal correction values|
|551|ENC_CH1_EncObsMin| |Encoder monitoring minimum, sqrt(a^2+b^2)|
|552|ENC_CH1_AbsEncStatus| |Error and status codes (absolute encoder)|

# 6.5.4.2.3 Signal correction (GPOC)

|ID|Index Name|Unit|Description|
|---|---|---|---|
|553|ENC_CH1_PeriodLen|nm|Length of signal period (Sin/Cos linear encoder)|
|554|ENC_CH1_DigitalResolution|nm|Length of one increment (linear absolute encoder)|
|555|ENC_CH1_Info| |Encoder information|
|616|ENC_CH1_CycleCount| |Sampling cycle in: n x 125 μ (microseconds)|
|610|ENC_CH1_NominalIncrementA| |Sign. Nominal increment A (distance coded abs. per. encoder)|
|611|ENC_CH1_NominalIncrementB| |Sign. Nominal increment B (distance coded abs. per. encoder)|
|1900|ENC_ETS| |ETS mode, electronic nameplate|

# 6.5.4.2.4 Sin/Cos incremental encoders with absolute value interface

The following table lists the parameters for cyclical Sin/Cos operation on encoder channel Ch 1 with one-time reading of the absolute encoder position via the absolute value interface, i.e. without a zero pulse:

|ID|Index Name|Unit|Description|
|---|---|---|---|
|505|ENC_CH1_Sel|1|Encoder selection set to SINCOS(1)|
|510|ENC_CH1_Num| |Encoder gearing: Numerator|
|511|ENC_CH1_Denom| |Encoder gearing: Denominator|
|540|ENC_CH1_Abs| |Absolute value interface selection (one-time reading)|

Table 6.9: Parameters for channel 1 (X7) - Sin/Cos encoder

The Sel, Num, Denom, Abs, Lines, MultiT, SingleT and CorrVal parameters are self-explanatory.

The Code and Mode parameters are described in Section ""SSI (cyclical) X7"" on page 69.

P 547[0] - ENC_CH1_MTBase = Minimum MultiTurn position

The MTBase parameter is used to set a position in the multi-turn encoder’s travel path that defines the point of discontinuity (overflow/underflow) for the absolute value initialization (that is, the “multi-turn basis”). Assuming a bipolar encoder measuring range, all position values that fall below MTBase will be shifted “up” (the whole MT range will be added to them once).

MOOG ID No.:CB40859-001 Date:11/2020

MSD ServoDrive - DeviceHelp

# 6 Encoder

MOOG ID No.:CB40859-001 Date:11/2020

method makes it possible to place the point of discontinuity at any point within the encoder’s entire measuring range. By default, MTBase will be set to the lowest possible value for the parameter, i.e. reliably outside of the encoder’s value range: In this case, the full bipolar range will remain unaffected, as values will never fall below this MTBase threshold (see Section ""Channel 1: Interface X7"" on page 59).

- P 548[0] - ENC_CH1_MTEnable = MultiTurn as SingleTurn
- The MTEnable parameter makes it possible to use multi-turn encoders as single-turn encoders for test purposes. Negative logic: Default MTEnable = 0 means ""MultiTurn-Enable ON"".

P 549[0] - ENC_CH1_Corr = Signal correction type
- The GPOC routine used for track signal correction purposes for sine/cosine signals is used to compensate for systematic errors. The routine is controlled with the Corr and CorrVal parameters (see Section ""Signal correction GPOC (Gain Phase Offset Correction)"" on page 74).

P 551[0] - ENC_CH1_EncObsMin = Encoder monitoring minimum, sqrt (a^2+b^2)
- The parameter EncObsMin is used to scale the Sin/Cos wire break monitoring and represents the “downwards threshold” for an error message. The default setting is 0.2, corresponding to approx. ",What is the significance of the P 640[25] - ENDAT_BWZ_Supported parameter in the EnDat encoder interface?,A2,"This parameter uses bit flags to show supported valuation numbers, such as bit3 for vn4 and bit2 for vn3, aiding in diagnostics and evaluations.",1.546875,1.46875,3.21875,1.515625,0.6875
42,msd_servo_drive.txt,20,02f242a213dfa4411d028ce46dfba16a3f97395fa25788fcbaea1715e779d934,"), consult with your project supervisor or the Helpline provided by Moog before using any special SSI protocol modes.

# 6.5.2 EnDat (cyclical) X7

Ch1: ENDAT(4) - Cyclical EnDat (2.1 or 2.2) EnDat is a digital encoder interface developed by HEIDENHAIN. For more details, please visit www.heidenhain.de and go to ►Documentation ►Fundamentals ►Interfaces ►EnDat 2.2.

The software versions required to run the EnDat encoder interface are the standard software versions for the MSD Servo Drive and MSD Single-Axis Servo Drive Compact.

MOOG ID No.:CB40859-001 Date:11/2020

# 6 Encoder

NOTE

- Please note the limitations that apply when running EnDat and SSI encoders (see Section ""Limiting for EnDat and SSI"" on page 52).

When using linear encoders, P 554[0] - ENC_CH1_DigitalResolution is used instead of P 543[0] - ENC_CH1_MultiT and P 544[0] - ENC_CH1_SingleT (which are used for rotary encoders). The values will be read from the EnDat encoder and written to the aforementioned parameters.

- P 543[0] - ENC_CH1_MultiT
- The number ""n"" of multiturn bits defines the measuring range in 2n increments per encoder shaft revolution; maximum travel until overflow; maximum travel within which the absolute value initialization can be unambiguous. In the case of single-turn encoders, MultiT = 0.
- P 544[0] - ENC_CH1_SingleT
- The number ""n"" of single-turn bits corresponds to the encoder’s digital resolution in 2n increments per encoder shaft revolution.
- P 554[0] - ENC_CH1_DigitalResolution
- This is the length of an increment, in nanometres, of the encoder’s digitally transmitted position value. This value is read from the EnDat linear head.

In the case of linear encoders, the number n of transmitted position bits from the encoder will be found in SingleT only! 2n * DigitalResolution yields the maximum travel in nanometres (for the encoder head).

P 640 - ENC_ENDAT is intended for additional information, but is normally not needed. This parameter does not have a Ch1 or Ch3 prefix for the encoder channel in the name, as it applies to both encoder channels. Although usually not needed, the parameter is helpful or required in the following cases:

1. Special EnDat encoder with diagnostics for evaluation
In this case, the valuation numbers from the encoder are read cyclically via additional information. Only the valuation numbers that the encoder supports.

# 6 Encoder

MOOG ID No.:CB40859-001 Date:11/2020

will be read. During the initialization process, the system will read the encoder to determine which valuation numbers it supports. When P 640[0] - ENDAT_Select = 1, the function will be enabled in the controller and the internal diagnostics in the EnDaT encoder will be enabled as well. The EnDat encoder will keep this setting even after being powered off. To explicitly disable the internal diagnostics in the EnDat encoder, set P 640[0] - ENDAT_Select to 2.

# 2. Evaluation of internal warnings

In this scenario, certain internal warnings from the encoder will be read from the encoder via additional information. Only the warnings that both the encoder and the Servo Drive’s software support will be read. During the initialization process, the system will read the encoder to determine which warnings it supports. When P 640[0] - ENDAT_Select = 3, the function will be enabled in the controller.

**Table 6.7: Channel 1 encoder configuration (X7) - EnDat parameters**
|ID|Index Name|Unit|Description|
|---|---|---|---|
|505|0 ENC_CH1_Sel|= ENDAT(4)| |
|543|0 ENC_CH1_MultiT|Number of MultiTurn bits (absolute encoder)| |
|544|0 ENC_CH1_SingleT|Number of SingleTurn bits (absolute encoder)| |
|547|0 ENC_CH1_MTBase|Definition of point of discontinuity in multi-turn range| |
|548|0 ENC_CH1_MTEnable|1: Use Multi-turn encoder as a single-turn encoder| |
|616|0 ENC_CH1_CycleCount|Position encoder sampling cycle (n x 125 μsec)| |
|598|0 ENC_CH1_Position|inc|Position encoder channel 1|
|554|0 ENC_CH1_|nm|Length of one increment (linear absolute encoder)|
|640|ENC_ENDAT| |EnDat additional (additional information)|
|640|0 ENDAT_Select|0=off|EnDat function selection, 1/2=diagnosis on/off, 3=warnings, FF=lock|
|640|1 ENDAT_DiagCount|u16|count new diagnosis block header|
|640|2 ENDAT_BWZ_1|lowbyte|vn1: incremental track|
|640|3 ENDAT_BWZ_3|lowbyte|vn3: absolute track|
|640|4 ENDAT_BWZ_4|lowbyte|vn4: position value formation|
|640|5 ENDAT_Status| |EnDat additional status output|
|640|6 ENDAT_Z1_Sel| |EnDat additional information 1 type selection|

**Table 6.7: Overwrite Channel 1 encoder configuration (X7) - EnDat parameters (continue)**
|ID|Index Name|Unit|Description|
|---|---|---|---|
|640|7 ENDAT_Z1_1| |Z1 info: dword 1|
|640|8 ENDAT_Z1_2| |Z1 info: dword 2|
|640|9 ENDAT_Z1_3| |Z1 info: dword 3|
|640|10 ENDAT_Z1_4| |Z1 info: dword 4|
|640|11 ENDAT_Z2_Sel| |EnDat additional information 2 type selection|
|640|12 ENDAT_Z2_1| |Z2 info: dword 1|
|640|13 ENDAT_Z2_2| |Z2 info: dword 2|
|640|14 ENDAT_Z2_3| |Z2 info: dword 3|
|640|15 ENDAT_Z2_4| |Z2 info: dword 4|
|640|16 ENDAT_Mode1|0=off|EnDat additional mode 1 selection|
|640|17 ENDAT_Mode2| |EnDat additional mode 2 selection|
|640|18 ENDAT_Mode3| |EnDat additional mode 3 selection|
|640|19 ENDAT_Mode4| |EnDat additional mode 4 selection|
|640|20 ENDAT_res1| |reserved 1|
|640|21 ENDAT_res2| |reserved 2|
|640|22 ENDAT_res3| |reserved 3|
|640|23 ENDAT_HwSyncStop|0=SyncOn|EnDat cyclic hw sync, stop/start 1/0|
|640|24 ENDAT_CyclCount| |call counter of cyclic function|
|640|25 ENDAT_BWZ_Supported| |vn supported (bit3=vn4, bit2=vn3, bit0=vn1)|
|640|26 ENDAT_BWZ1_| |vn1: bits[7..0] threshold level, bits[31..16]|
|640|27 ThresholdLevel| |how often number|
|640|28 ENDAT_BWZ3_| |vn3: bits[7..0] threshold level, bits[31..16]|
|640|29 ThresholdLevel| |how often number|
|640|30 ENDAT_BWZ4_| |vn4: bits[7..0] threshold level, bits[31..16]|
|640|31 ThresholdLevel| |how often number|
|640|32 ENDAT_BWZ_TEST_| |vn: bits[15..12] 'F', bits[11..8] vn.no., bits [7..0] vn overwrite value|

# 6.5.3 Hall sensor X7

Ch1: HALL(5) - Digital hall signals

Ch1: HALL_TTL(7) - Digital hall signals

NOTE

l The operation and configuration of Hall effect sensors is reserved for special applications. Consult with Moog if needed.

# 6.5.4 Sin/Cos / TTL X7

# 6.5.4.1 TTL encoder

Ch1: TTL(3) - TTL signals

TTL encoders are ...

- a. ... ... usually pure incremental encoders without an absolute value interface.
- b. In this case, P 540[0] - ENC_CH1_Abs must be set to OFF(0). ... ... in a few exceptional cases, incremental encoders with an SSI absolute value interface. In this case, P 540[0] - ENC_CH1_Abs must be accordingly set to SSI(1) (SSI_CONT(4) in special cases), so that it will be possible to read the absolute encoder position for the absolute value initialization routine once during the initialization phase.

# 6.5.4.1.1 Pure TTL incremental encoder

Set P 505[0] - ENC_CH1_Sel to TTL(3) and P 540[0] - ENC_CH1_Abs to OFF(0) when using pure TTL encoders, i.e. encoders without an absolute value interface but with a TTL zero pulse.

Linear TTL encoders are run as rotary encoders. For linear motor operation, P 542 [0] - ENC_CH1_Lines and the encoder gearing (see the “Encoder gearing” section) are used to establish the ratio for the linear motor’s pole pair subdivision (North-North) for commutation. 1 x North-North corresponds to one revolution from Lines. In this case, the motor pole pair number must be set to 1. Moreover, P 553[0] - ENC_CH1_PeriodLen is not used in this case.

The TTL interface accepts various TTL signal types, which can be selected using P 558[0] - ENC_CH1_TTL_SignalType:

- (0)AF_B - A/B tracks (forward counting, X4 encoding) - AB
- (1)AR_B - A/B tracks (reverse counting, X4 encoding) - AB_inv
- (2)ABDFN - A: Clock (falling edge), B: Direction (1 = positive) - PulseDir
- (3)ABDRP - A: Clock (rising edge), B: Direction (1 = negative) - PulseDir_inv
- (4)reserved

A maximum interpolation period, in ms (milliseconds), can be configured for the TTL interface using P 601[0] - ENC_CH1_Period. Within this context, Period is the maximum time of “no activity” since the last TTL counter event:

- Period = 0: Function disabled (default)
- Period > 0 (=n ms): If no counter event is registered in n ms, the speed will be set to 0.

# Zero pulse

There is no parameter for activating the zero pulse evaluation here, as this evaluation is controlled exclusively based on the homing mode (see Section ""Homing"" on page 249). However, setting P 541[0] - ENC_CH1_NpTest to 1 provides a test mode that can be used during commissioning in order to be able to activate the zero pulse evaluation even without homing. Scope signals 1014 and 1016 can be used to view a received zero pulse within this context. This test mode must be disabled during normal operation (P 541[0] = 0).

# Commutation

Motor operation with pure incremental encoders needs for the auto commutation function to be enabled without fail. For details see Section ""Synchronous motor auto commutation"" on page 156.

# 6.5.4.1.2 TTL incremental encoder with SSI absolute value interface

See Section ""Sin/Cos incremental encoders with absolute value interface"" on page 65 and in special Section ""SSI absolute value interface"" on page 67.

MSD ServoDrive - DeviceHelp

# 6 Encoder

MOOG ID No.:CB40859-001 Date:11/2020 MSD ServoDrive - DeviceHelp 64

|ID|Index Name|Unit|Description|
|---|---|---|---|
|505|0|ENC_CH1_Sel = 3|Encoder selection set to TTL(3)|
|510|0|ENC_CH1_Num|Encoder gearing: Numerator Ch1: SINCOS(1) - Sin/Cos signals|
|511|0|ENC_CH1_Denom|Encoder gearing: Denominator|
|540|0|ENC_CH1_Abs|Selection of absolute value interface Sin/Cos encoders can ...|
|541|0|ENC_CH1_NpTest|ENC CH1, TEST-MODE: Index pulse signal(s) to Scope|
|542|0|ENC_CH1_lines|Number of lines (Sin/Cos / TTL encoders) a. Be pure incremental encoders without an absolute value interface. In this|
|558|0|ENC_CH1_TTL_SignalType|Channel 1: TTL signal selection case, P 540[0] - ENC_CH1_Abs must be set to OFF(0).|
|601|0|ENC_CH1_Period|Maximum period of interpolation (TTL encoder)|
|616|0|ENC_CH1_CycleCount|Sampling cycle in: n x 125 μ (microseconds) b. Be incremental encoders with an absolute value interface. In this case,|

Table 6.8: Parameters for Channel 1 (X7) - TTL encoder

ENC_CH1_Abs must be accordingly set to SSI(1), EnDat(2), HIPER(3) or, in special cases, SSI_CONT(4) so that it will be possible to read the absolute encoder position for the absolute value initialization routine once during the initialization phase.

# 6.5.4.2.1 Purely Sin/Cos incremental encoders

To run these encoders as purely incremental encoders with a zero pulse on encoder channel Ch1 (without an absolute value interface), the approach is basically the same as for purely TTL operation (see Section ""TTL encoder"" on page 63). The same parameters apply.

However, there are the following differences:

- a. There are no different signal types for the Sin/Cos signal (always 1 Vss for cosine and sine).
- b. The zero pulse is the analog zero pulse typical of Sin/Cos encoders (see the “Connection for high-resolution encoders” section in the operation manual MSD Servo Drive Single-Axis System, for example).

# 6.5.4.2.2 Linear Sin/Cos

|ID|Index Name|Unit|Description|
|---|---|---|---|
|542|ENC_CH1_lines| |Number of Lines (Sin/Cos / TTL encoders)|
|543|ENC_CH1_MultiT| |Number of MultiTurn bits (absolute encoder)|
|544|ENC_CH1_SingleT| |Number of SingleTurn bits (absolute encoder)|
|545|ENC_CH1_Code| |Code selection (SSI encoder) (binary, gray)|
|546|ENC_CH1_Mode| |Mode selection (SSI encoder)|
|547|ENC_CH1_MTBase| |Definition of point of discontinuity in multi-turn range|
|548|ENC_CH1_MTEnable| |Enable MultiTurn use (negative logic, 1=MToff)|
|549|ENC_CH1_Corr| |Signal correction type|
|550|ENC_CH1_CorrVal|0-4|Signal correction values|
|551|ENC_CH1_EncObsMin| |Encoder monitoring minimum, sqrt(a^2+b^2)|
|552|ENC_CH1_AbsEncStatus| |Error and status codes (absolute encoder)|

# 6.5.4.2.3 Signal correction (GPOC)

|ID|Index Name|Unit|Description|
|---|---|---|---|
|553|ENC_CH1_PeriodLen|nm|Length of signal period (Sin/Cos linear encoder)|
|554|ENC_CH1_DigitalResolution|nm|Length of one increment (linear absolute encoder)|
|555|ENC_CH1_Info| |Encoder information|
|616|ENC_CH1_CycleCount| |Sampling cycle in: n x 125 μ (microseconds)|
|610|ENC_CH1_NominalIncrementA| |Sign. Nominal increment A (distance coded abs. per. encoder)|
|611|ENC_CH1_NominalIncrementB| |Sign. Nominal increment B (distance coded abs. per. encoder)|
|1900|ENC_ETS| |ETS mode, electronic nameplate|

# 6.5.4.2.4 Sin/Cos incremental encoders with absolute value interface

The following table lists the parameters for cyclical Sin/Cos operation on encoder channel Ch 1 with one-time reading of the absolute encoder position via the absolute value interface, i.e. without a zero pulse:

|ID|Index Name|Unit|Description|
|---|---|---|---|
|505|ENC_CH1_Sel|1|Encoder selection set to SINCOS(1)|
|510|ENC_CH1_Num| |Encoder gearing: Numerator|
|511|ENC_CH1_Denom| |Encoder gearing: Denominator|
|540|ENC_CH1_Abs| |Absolute value interface selection (one-time reading)|

Table 6.9: Parameters for channel 1 (X7) - Sin/Cos encoder

The Sel, Num, Denom, Abs, Lines, MultiT, SingleT and CorrVal parameters are self-explanatory.

The Code and Mode parameters are described in Section ""SSI (cyclical) X7"" on page 69.

P 547[0] - ENC_CH1_MTBase = Minimum MultiTurn position

The MTBase parameter is used to set a position in the multi-turn encoder’s travel path that defines the point of discontinuity (overflow/underflow) for the absolute value initialization (that is, the “multi-turn basis”). Assuming a bipolar encoder measuring range, all position values that fall below MTBase will be shifted “up” (the whole MT range will be added to them once).

MOOG ID No.:CB40859-001 Date:11/2020

MSD ServoDrive - DeviceHelp

# 6 Encoder

MOOG ID No.:CB40859-001 Date:11/2020

method makes it possible to place the point of discontinuity at any point within the encoder’s entire measuring range. By default, MTBase will be set to the lowest possible value for the parameter, i.e. reliably outside of the encoder’s value range: In this case, the full bipolar range will remain unaffected, as values will never fall below this MTBase threshold (see Section ""Channel 1: Interface X7"" on page 59).

- P 548[0] - ENC_CH1_MTEnable = MultiTurn as SingleTurn
- The MTEnable parameter makes it possible to use multi-turn encoders as single-turn encoders for test purposes. Negative logic: Default MTEnable = 0 means ""MultiTurn-Enable ON"".

P 549[0] - ENC_CH1_Corr = Signal correction type
- The GPOC routine used for track signal correction purposes for sine/cosine signals is used to compensate for systematic errors. The routine is controlled with the Corr and CorrVal parameters (see Section ""Signal correction GPOC (Gain Phase Offset Correction)"" on page 74).

P 551[0] - ENC_CH1_EncObsMin = Encoder monitoring minimum, sqrt (a^2+b^2)
- The parameter EncObsMin is used to scale the Sin/Cos wire break monitoring and represents the “downwards threshold” for an error message. The default setting is 0.2, corresponding to approx. ",What is the significance of the P 640[25] - ENDAT_BWZ_Supported parameter in the EnDat encoder interface?,A3,"It reveals the encoder's supported valuation numbers through bitwise representation, crucial for enabling specific diagnostic features.",1.7421875,1.9765625,3.546875,1.5703125,0.478515625
43,msd_servo_drive.txt,20,02f242a213dfa4411d028ce46dfba16a3f97395fa25788fcbaea1715e779d934,"), consult with your project supervisor or the Helpline provided by Moog before using any special SSI protocol modes.

# 6.5.2 EnDat (cyclical) X7

Ch1: ENDAT(4) - Cyclical EnDat (2.1 or 2.2) EnDat is a digital encoder interface developed by HEIDENHAIN. For more details, please visit www.heidenhain.de and go to ►Documentation ►Fundamentals ►Interfaces ►EnDat 2.2.

The software versions required to run the EnDat encoder interface are the standard software versions for the MSD Servo Drive and MSD Single-Axis Servo Drive Compact.

MOOG ID No.:CB40859-001 Date:11/2020

# 6 Encoder

NOTE

- Please note the limitations that apply when running EnDat and SSI encoders (see Section ""Limiting for EnDat and SSI"" on page 52).

When using linear encoders, P 554[0] - ENC_CH1_DigitalResolution is used instead of P 543[0] - ENC_CH1_MultiT and P 544[0] - ENC_CH1_SingleT (which are used for rotary encoders). The values will be read from the EnDat encoder and written to the aforementioned parameters.

- P 543[0] - ENC_CH1_MultiT
- The number ""n"" of multiturn bits defines the measuring range in 2n increments per encoder shaft revolution; maximum travel until overflow; maximum travel within which the absolute value initialization can be unambiguous. In the case of single-turn encoders, MultiT = 0.
- P 544[0] - ENC_CH1_SingleT
- The number ""n"" of single-turn bits corresponds to the encoder’s digital resolution in 2n increments per encoder shaft revolution.
- P 554[0] - ENC_CH1_DigitalResolution
- This is the length of an increment, in nanometres, of the encoder’s digitally transmitted position value. This value is read from the EnDat linear head.

In the case of linear encoders, the number n of transmitted position bits from the encoder will be found in SingleT only! 2n * DigitalResolution yields the maximum travel in nanometres (for the encoder head).

P 640 - ENC_ENDAT is intended for additional information, but is normally not needed. This parameter does not have a Ch1 or Ch3 prefix for the encoder channel in the name, as it applies to both encoder channels. Although usually not needed, the parameter is helpful or required in the following cases:

1. Special EnDat encoder with diagnostics for evaluation
In this case, the valuation numbers from the encoder are read cyclically via additional information. Only the valuation numbers that the encoder supports.

# 6 Encoder

MOOG ID No.:CB40859-001 Date:11/2020

will be read. During the initialization process, the system will read the encoder to determine which valuation numbers it supports. When P 640[0] - ENDAT_Select = 1, the function will be enabled in the controller and the internal diagnostics in the EnDaT encoder will be enabled as well. The EnDat encoder will keep this setting even after being powered off. To explicitly disable the internal diagnostics in the EnDat encoder, set P 640[0] - ENDAT_Select to 2.

# 2. Evaluation of internal warnings

In this scenario, certain internal warnings from the encoder will be read from the encoder via additional information. Only the warnings that both the encoder and the Servo Drive’s software support will be read. During the initialization process, the system will read the encoder to determine which warnings it supports. When P 640[0] - ENDAT_Select = 3, the function will be enabled in the controller.

**Table 6.7: Channel 1 encoder configuration (X7) - EnDat parameters**
|ID|Index Name|Unit|Description|
|---|---|---|---|
|505|0 ENC_CH1_Sel|= ENDAT(4)| |
|543|0 ENC_CH1_MultiT|Number of MultiTurn bits (absolute encoder)| |
|544|0 ENC_CH1_SingleT|Number of SingleTurn bits (absolute encoder)| |
|547|0 ENC_CH1_MTBase|Definition of point of discontinuity in multi-turn range| |
|548|0 ENC_CH1_MTEnable|1: Use Multi-turn encoder as a single-turn encoder| |
|616|0 ENC_CH1_CycleCount|Position encoder sampling cycle (n x 125 μsec)| |
|598|0 ENC_CH1_Position|inc|Position encoder channel 1|
|554|0 ENC_CH1_|nm|Length of one increment (linear absolute encoder)|
|640|ENC_ENDAT| |EnDat additional (additional information)|
|640|0 ENDAT_Select|0=off|EnDat function selection, 1/2=diagnosis on/off, 3=warnings, FF=lock|
|640|1 ENDAT_DiagCount|u16|count new diagnosis block header|
|640|2 ENDAT_BWZ_1|lowbyte|vn1: incremental track|
|640|3 ENDAT_BWZ_3|lowbyte|vn3: absolute track|
|640|4 ENDAT_BWZ_4|lowbyte|vn4: position value formation|
|640|5 ENDAT_Status| |EnDat additional status output|
|640|6 ENDAT_Z1_Sel| |EnDat additional information 1 type selection|

**Table 6.7: Overwrite Channel 1 encoder configuration (X7) - EnDat parameters (continue)**
|ID|Index Name|Unit|Description|
|---|---|---|---|
|640|7 ENDAT_Z1_1| |Z1 info: dword 1|
|640|8 ENDAT_Z1_2| |Z1 info: dword 2|
|640|9 ENDAT_Z1_3| |Z1 info: dword 3|
|640|10 ENDAT_Z1_4| |Z1 info: dword 4|
|640|11 ENDAT_Z2_Sel| |EnDat additional information 2 type selection|
|640|12 ENDAT_Z2_1| |Z2 info: dword 1|
|640|13 ENDAT_Z2_2| |Z2 info: dword 2|
|640|14 ENDAT_Z2_3| |Z2 info: dword 3|
|640|15 ENDAT_Z2_4| |Z2 info: dword 4|
|640|16 ENDAT_Mode1|0=off|EnDat additional mode 1 selection|
|640|17 ENDAT_Mode2| |EnDat additional mode 2 selection|
|640|18 ENDAT_Mode3| |EnDat additional mode 3 selection|
|640|19 ENDAT_Mode4| |EnDat additional mode 4 selection|
|640|20 ENDAT_res1| |reserved 1|
|640|21 ENDAT_res2| |reserved 2|
|640|22 ENDAT_res3| |reserved 3|
|640|23 ENDAT_HwSyncStop|0=SyncOn|EnDat cyclic hw sync, stop/start 1/0|
|640|24 ENDAT_CyclCount| |call counter of cyclic function|
|640|25 ENDAT_BWZ_Supported| |vn supported (bit3=vn4, bit2=vn3, bit0=vn1)|
|640|26 ENDAT_BWZ1_| |vn1: bits[7..0] threshold level, bits[31..16]|
|640|27 ThresholdLevel| |how often number|
|640|28 ENDAT_BWZ3_| |vn3: bits[7..0] threshold level, bits[31..16]|
|640|29 ThresholdLevel| |how often number|
|640|30 ENDAT_BWZ4_| |vn4: bits[7..0] threshold level, bits[31..16]|
|640|31 ThresholdLevel| |how often number|
|640|32 ENDAT_BWZ_TEST_| |vn: bits[15..12] 'F', bits[11..8] vn.no., bits [7..0] vn overwrite value|

# 6.5.3 Hall sensor X7

Ch1: HALL(5) - Digital hall signals

Ch1: HALL_TTL(7) - Digital hall signals

NOTE

l The operation and configuration of Hall effect sensors is reserved for special applications. Consult with Moog if needed.

# 6.5.4 Sin/Cos / TTL X7

# 6.5.4.1 TTL encoder

Ch1: TTL(3) - TTL signals

TTL encoders are ...

- a. ... ... usually pure incremental encoders without an absolute value interface.
- b. In this case, P 540[0] - ENC_CH1_Abs must be set to OFF(0). ... ... in a few exceptional cases, incremental encoders with an SSI absolute value interface. In this case, P 540[0] - ENC_CH1_Abs must be accordingly set to SSI(1) (SSI_CONT(4) in special cases), so that it will be possible to read the absolute encoder position for the absolute value initialization routine once during the initialization phase.

# 6.5.4.1.1 Pure TTL incremental encoder

Set P 505[0] - ENC_CH1_Sel to TTL(3) and P 540[0] - ENC_CH1_Abs to OFF(0) when using pure TTL encoders, i.e. encoders without an absolute value interface but with a TTL zero pulse.

Linear TTL encoders are run as rotary encoders. For linear motor operation, P 542 [0] - ENC_CH1_Lines and the encoder gearing (see the “Encoder gearing” section) are used to establish the ratio for the linear motor’s pole pair subdivision (North-North) for commutation. 1 x North-North corresponds to one revolution from Lines. In this case, the motor pole pair number must be set to 1. Moreover, P 553[0] - ENC_CH1_PeriodLen is not used in this case.

The TTL interface accepts various TTL signal types, which can be selected using P 558[0] - ENC_CH1_TTL_SignalType:

- (0)AF_B - A/B tracks (forward counting, X4 encoding) - AB
- (1)AR_B - A/B tracks (reverse counting, X4 encoding) - AB_inv
- (2)ABDFN - A: Clock (falling edge), B: Direction (1 = positive) - PulseDir
- (3)ABDRP - A: Clock (rising edge), B: Direction (1 = negative) - PulseDir_inv
- (4)reserved

A maximum interpolation period, in ms (milliseconds), can be configured for the TTL interface using P 601[0] - ENC_CH1_Period. Within this context, Period is the maximum time of “no activity” since the last TTL counter event:

- Period = 0: Function disabled (default)
- Period > 0 (=n ms): If no counter event is registered in n ms, the speed will be set to 0.

# Zero pulse

There is no parameter for activating the zero pulse evaluation here, as this evaluation is controlled exclusively based on the homing mode (see Section ""Homing"" on page 249). However, setting P 541[0] - ENC_CH1_NpTest to 1 provides a test mode that can be used during commissioning in order to be able to activate the zero pulse evaluation even without homing. Scope signals 1014 and 1016 can be used to view a received zero pulse within this context. This test mode must be disabled during normal operation (P 541[0] = 0).

# Commutation

Motor operation with pure incremental encoders needs for the auto commutation function to be enabled without fail. For details see Section ""Synchronous motor auto commutation"" on page 156.

# 6.5.4.1.2 TTL incremental encoder with SSI absolute value interface

See Section ""Sin/Cos incremental encoders with absolute value interface"" on page 65 and in special Section ""SSI absolute value interface"" on page 67.

MSD ServoDrive - DeviceHelp

# 6 Encoder

MOOG ID No.:CB40859-001 Date:11/2020 MSD ServoDrive - DeviceHelp 64

|ID|Index Name|Unit|Description|
|---|---|---|---|
|505|0|ENC_CH1_Sel = 3|Encoder selection set to TTL(3)|
|510|0|ENC_CH1_Num|Encoder gearing: Numerator Ch1: SINCOS(1) - Sin/Cos signals|
|511|0|ENC_CH1_Denom|Encoder gearing: Denominator|
|540|0|ENC_CH1_Abs|Selection of absolute value interface Sin/Cos encoders can ...|
|541|0|ENC_CH1_NpTest|ENC CH1, TEST-MODE: Index pulse signal(s) to Scope|
|542|0|ENC_CH1_lines|Number of lines (Sin/Cos / TTL encoders) a. Be pure incremental encoders without an absolute value interface. In this|
|558|0|ENC_CH1_TTL_SignalType|Channel 1: TTL signal selection case, P 540[0] - ENC_CH1_Abs must be set to OFF(0).|
|601|0|ENC_CH1_Period|Maximum period of interpolation (TTL encoder)|
|616|0|ENC_CH1_CycleCount|Sampling cycle in: n x 125 μ (microseconds) b. Be incremental encoders with an absolute value interface. In this case,|

Table 6.8: Parameters for Channel 1 (X7) - TTL encoder

ENC_CH1_Abs must be accordingly set to SSI(1), EnDat(2), HIPER(3) or, in special cases, SSI_CONT(4) so that it will be possible to read the absolute encoder position for the absolute value initialization routine once during the initialization phase.

# 6.5.4.2.1 Purely Sin/Cos incremental encoders

To run these encoders as purely incremental encoders with a zero pulse on encoder channel Ch1 (without an absolute value interface), the approach is basically the same as for purely TTL operation (see Section ""TTL encoder"" on page 63). The same parameters apply.

However, there are the following differences:

- a. There are no different signal types for the Sin/Cos signal (always 1 Vss for cosine and sine).
- b. The zero pulse is the analog zero pulse typical of Sin/Cos encoders (see the “Connection for high-resolution encoders” section in the operation manual MSD Servo Drive Single-Axis System, for example).

# 6.5.4.2.2 Linear Sin/Cos

|ID|Index Name|Unit|Description|
|---|---|---|---|
|542|ENC_CH1_lines| |Number of Lines (Sin/Cos / TTL encoders)|
|543|ENC_CH1_MultiT| |Number of MultiTurn bits (absolute encoder)|
|544|ENC_CH1_SingleT| |Number of SingleTurn bits (absolute encoder)|
|545|ENC_CH1_Code| |Code selection (SSI encoder) (binary, gray)|
|546|ENC_CH1_Mode| |Mode selection (SSI encoder)|
|547|ENC_CH1_MTBase| |Definition of point of discontinuity in multi-turn range|
|548|ENC_CH1_MTEnable| |Enable MultiTurn use (negative logic, 1=MToff)|
|549|ENC_CH1_Corr| |Signal correction type|
|550|ENC_CH1_CorrVal|0-4|Signal correction values|
|551|ENC_CH1_EncObsMin| |Encoder monitoring minimum, sqrt(a^2+b^2)|
|552|ENC_CH1_AbsEncStatus| |Error and status codes (absolute encoder)|

# 6.5.4.2.3 Signal correction (GPOC)

|ID|Index Name|Unit|Description|
|---|---|---|---|
|553|ENC_CH1_PeriodLen|nm|Length of signal period (Sin/Cos linear encoder)|
|554|ENC_CH1_DigitalResolution|nm|Length of one increment (linear absolute encoder)|
|555|ENC_CH1_Info| |Encoder information|
|616|ENC_CH1_CycleCount| |Sampling cycle in: n x 125 μ (microseconds)|
|610|ENC_CH1_NominalIncrementA| |Sign. Nominal increment A (distance coded abs. per. encoder)|
|611|ENC_CH1_NominalIncrementB| |Sign. Nominal increment B (distance coded abs. per. encoder)|
|1900|ENC_ETS| |ETS mode, electronic nameplate|

# 6.5.4.2.4 Sin/Cos incremental encoders with absolute value interface

The following table lists the parameters for cyclical Sin/Cos operation on encoder channel Ch 1 with one-time reading of the absolute encoder position via the absolute value interface, i.e. without a zero pulse:

|ID|Index Name|Unit|Description|
|---|---|---|---|
|505|ENC_CH1_Sel|1|Encoder selection set to SINCOS(1)|
|510|ENC_CH1_Num| |Encoder gearing: Numerator|
|511|ENC_CH1_Denom| |Encoder gearing: Denominator|
|540|ENC_CH1_Abs| |Absolute value interface selection (one-time reading)|

Table 6.9: Parameters for channel 1 (X7) - Sin/Cos encoder

The Sel, Num, Denom, Abs, Lines, MultiT, SingleT and CorrVal parameters are self-explanatory.

The Code and Mode parameters are described in Section ""SSI (cyclical) X7"" on page 69.

P 547[0] - ENC_CH1_MTBase = Minimum MultiTurn position

The MTBase parameter is used to set a position in the multi-turn encoder’s travel path that defines the point of discontinuity (overflow/underflow) for the absolute value initialization (that is, the “multi-turn basis”). Assuming a bipolar encoder measuring range, all position values that fall below MTBase will be shifted “up” (the whole MT range will be added to them once).

MOOG ID No.:CB40859-001 Date:11/2020

MSD ServoDrive - DeviceHelp

# 6 Encoder

MOOG ID No.:CB40859-001 Date:11/2020

method makes it possible to place the point of discontinuity at any point within the encoder’s entire measuring range. By default, MTBase will be set to the lowest possible value for the parameter, i.e. reliably outside of the encoder’s value range: In this case, the full bipolar range will remain unaffected, as values will never fall below this MTBase threshold (see Section ""Channel 1: Interface X7"" on page 59).

- P 548[0] - ENC_CH1_MTEnable = MultiTurn as SingleTurn
- The MTEnable parameter makes it possible to use multi-turn encoders as single-turn encoders for test purposes. Negative logic: Default MTEnable = 0 means ""MultiTurn-Enable ON"".

P 549[0] - ENC_CH1_Corr = Signal correction type
- The GPOC routine used for track signal correction purposes for sine/cosine signals is used to compensate for systematic errors. The routine is controlled with the Corr and CorrVal parameters (see Section ""Signal correction GPOC (Gain Phase Offset Correction)"" on page 74).

P 551[0] - ENC_CH1_EncObsMin = Encoder monitoring minimum, sqrt (a^2+b^2)
- The parameter EncObsMin is used to scale the Sin/Cos wire break monitoring and represents the “downwards threshold” for an error message. The default setting is 0.2, corresponding to approx. ",What is the significance of the P 640[25] - ENDAT_BWZ_Supported parameter in the EnDat encoder interface?,A4,The parameter's value helps identify which valuation numbers are available for use in the encoder's diagnostic and evaluation processes.,1.6484375,1.609375,3.40625,1.5078125,0.43359375
44,msd_servo_drive.txt,20,02f242a213dfa4411d028ce46dfba16a3f97395fa25788fcbaea1715e779d934,"), consult with your project supervisor or the Helpline provided by Moog before using any special SSI protocol modes.

# 6.5.2 EnDat (cyclical) X7

Ch1: ENDAT(4) - Cyclical EnDat (2.1 or 2.2) EnDat is a digital encoder interface developed by HEIDENHAIN. For more details, please visit www.heidenhain.de and go to ►Documentation ►Fundamentals ►Interfaces ►EnDat 2.2.

The software versions required to run the EnDat encoder interface are the standard software versions for the MSD Servo Drive and MSD Single-Axis Servo Drive Compact.

MOOG ID No.:CB40859-001 Date:11/2020

# 6 Encoder

NOTE

- Please note the limitations that apply when running EnDat and SSI encoders (see Section ""Limiting for EnDat and SSI"" on page 52).

When using linear encoders, P 554[0] - ENC_CH1_DigitalResolution is used instead of P 543[0] - ENC_CH1_MultiT and P 544[0] - ENC_CH1_SingleT (which are used for rotary encoders). The values will be read from the EnDat encoder and written to the aforementioned parameters.

- P 543[0] - ENC_CH1_MultiT
- The number ""n"" of multiturn bits defines the measuring range in 2n increments per encoder shaft revolution; maximum travel until overflow; maximum travel within which the absolute value initialization can be unambiguous. In the case of single-turn encoders, MultiT = 0.
- P 544[0] - ENC_CH1_SingleT
- The number ""n"" of single-turn bits corresponds to the encoder’s digital resolution in 2n increments per encoder shaft revolution.
- P 554[0] - ENC_CH1_DigitalResolution
- This is the length of an increment, in nanometres, of the encoder’s digitally transmitted position value. This value is read from the EnDat linear head.

In the case of linear encoders, the number n of transmitted position bits from the encoder will be found in SingleT only! 2n * DigitalResolution yields the maximum travel in nanometres (for the encoder head).

P 640 - ENC_ENDAT is intended for additional information, but is normally not needed. This parameter does not have a Ch1 or Ch3 prefix for the encoder channel in the name, as it applies to both encoder channels. Although usually not needed, the parameter is helpful or required in the following cases:

1. Special EnDat encoder with diagnostics for evaluation
In this case, the valuation numbers from the encoder are read cyclically via additional information. Only the valuation numbers that the encoder supports.

# 6 Encoder

MOOG ID No.:CB40859-001 Date:11/2020

will be read. During the initialization process, the system will read the encoder to determine which valuation numbers it supports. When P 640[0] - ENDAT_Select = 1, the function will be enabled in the controller and the internal diagnostics in the EnDaT encoder will be enabled as well. The EnDat encoder will keep this setting even after being powered off. To explicitly disable the internal diagnostics in the EnDat encoder, set P 640[0] - ENDAT_Select to 2.

# 2. Evaluation of internal warnings

In this scenario, certain internal warnings from the encoder will be read from the encoder via additional information. Only the warnings that both the encoder and the Servo Drive’s software support will be read. During the initialization process, the system will read the encoder to determine which warnings it supports. When P 640[0] - ENDAT_Select = 3, the function will be enabled in the controller.

**Table 6.7: Channel 1 encoder configuration (X7) - EnDat parameters**
|ID|Index Name|Unit|Description|
|---|---|---|---|
|505|0 ENC_CH1_Sel|= ENDAT(4)| |
|543|0 ENC_CH1_MultiT|Number of MultiTurn bits (absolute encoder)| |
|544|0 ENC_CH1_SingleT|Number of SingleTurn bits (absolute encoder)| |
|547|0 ENC_CH1_MTBase|Definition of point of discontinuity in multi-turn range| |
|548|0 ENC_CH1_MTEnable|1: Use Multi-turn encoder as a single-turn encoder| |
|616|0 ENC_CH1_CycleCount|Position encoder sampling cycle (n x 125 μsec)| |
|598|0 ENC_CH1_Position|inc|Position encoder channel 1|
|554|0 ENC_CH1_|nm|Length of one increment (linear absolute encoder)|
|640|ENC_ENDAT| |EnDat additional (additional information)|
|640|0 ENDAT_Select|0=off|EnDat function selection, 1/2=diagnosis on/off, 3=warnings, FF=lock|
|640|1 ENDAT_DiagCount|u16|count new diagnosis block header|
|640|2 ENDAT_BWZ_1|lowbyte|vn1: incremental track|
|640|3 ENDAT_BWZ_3|lowbyte|vn3: absolute track|
|640|4 ENDAT_BWZ_4|lowbyte|vn4: position value formation|
|640|5 ENDAT_Status| |EnDat additional status output|
|640|6 ENDAT_Z1_Sel| |EnDat additional information 1 type selection|

**Table 6.7: Overwrite Channel 1 encoder configuration (X7) - EnDat parameters (continue)**
|ID|Index Name|Unit|Description|
|---|---|---|---|
|640|7 ENDAT_Z1_1| |Z1 info: dword 1|
|640|8 ENDAT_Z1_2| |Z1 info: dword 2|
|640|9 ENDAT_Z1_3| |Z1 info: dword 3|
|640|10 ENDAT_Z1_4| |Z1 info: dword 4|
|640|11 ENDAT_Z2_Sel| |EnDat additional information 2 type selection|
|640|12 ENDAT_Z2_1| |Z2 info: dword 1|
|640|13 ENDAT_Z2_2| |Z2 info: dword 2|
|640|14 ENDAT_Z2_3| |Z2 info: dword 3|
|640|15 ENDAT_Z2_4| |Z2 info: dword 4|
|640|16 ENDAT_Mode1|0=off|EnDat additional mode 1 selection|
|640|17 ENDAT_Mode2| |EnDat additional mode 2 selection|
|640|18 ENDAT_Mode3| |EnDat additional mode 3 selection|
|640|19 ENDAT_Mode4| |EnDat additional mode 4 selection|
|640|20 ENDAT_res1| |reserved 1|
|640|21 ENDAT_res2| |reserved 2|
|640|22 ENDAT_res3| |reserved 3|
|640|23 ENDAT_HwSyncStop|0=SyncOn|EnDat cyclic hw sync, stop/start 1/0|
|640|24 ENDAT_CyclCount| |call counter of cyclic function|
|640|25 ENDAT_BWZ_Supported| |vn supported (bit3=vn4, bit2=vn3, bit0=vn1)|
|640|26 ENDAT_BWZ1_| |vn1: bits[7..0] threshold level, bits[31..16]|
|640|27 ThresholdLevel| |how often number|
|640|28 ENDAT_BWZ3_| |vn3: bits[7..0] threshold level, bits[31..16]|
|640|29 ThresholdLevel| |how often number|
|640|30 ENDAT_BWZ4_| |vn4: bits[7..0] threshold level, bits[31..16]|
|640|31 ThresholdLevel| |how often number|
|640|32 ENDAT_BWZ_TEST_| |vn: bits[15..12] 'F', bits[11..8] vn.no., bits [7..0] vn overwrite value|

# 6.5.3 Hall sensor X7

Ch1: HALL(5) - Digital hall signals

Ch1: HALL_TTL(7) - Digital hall signals

NOTE

l The operation and configuration of Hall effect sensors is reserved for special applications. Consult with Moog if needed.

# 6.5.4 Sin/Cos / TTL X7

# 6.5.4.1 TTL encoder

Ch1: TTL(3) - TTL signals

TTL encoders are ...

- a. ... ... usually pure incremental encoders without an absolute value interface.
- b. In this case, P 540[0] - ENC_CH1_Abs must be set to OFF(0). ... ... in a few exceptional cases, incremental encoders with an SSI absolute value interface. In this case, P 540[0] - ENC_CH1_Abs must be accordingly set to SSI(1) (SSI_CONT(4) in special cases), so that it will be possible to read the absolute encoder position for the absolute value initialization routine once during the initialization phase.

# 6.5.4.1.1 Pure TTL incremental encoder

Set P 505[0] - ENC_CH1_Sel to TTL(3) and P 540[0] - ENC_CH1_Abs to OFF(0) when using pure TTL encoders, i.e. encoders without an absolute value interface but with a TTL zero pulse.

Linear TTL encoders are run as rotary encoders. For linear motor operation, P 542 [0] - ENC_CH1_Lines and the encoder gearing (see the “Encoder gearing” section) are used to establish the ratio for the linear motor’s pole pair subdivision (North-North) for commutation. 1 x North-North corresponds to one revolution from Lines. In this case, the motor pole pair number must be set to 1. Moreover, P 553[0] - ENC_CH1_PeriodLen is not used in this case.

The TTL interface accepts various TTL signal types, which can be selected using P 558[0] - ENC_CH1_TTL_SignalType:

- (0)AF_B - A/B tracks (forward counting, X4 encoding) - AB
- (1)AR_B - A/B tracks (reverse counting, X4 encoding) - AB_inv
- (2)ABDFN - A: Clock (falling edge), B: Direction (1 = positive) - PulseDir
- (3)ABDRP - A: Clock (rising edge), B: Direction (1 = negative) - PulseDir_inv
- (4)reserved

A maximum interpolation period, in ms (milliseconds), can be configured for the TTL interface using P 601[0] - ENC_CH1_Period. Within this context, Period is the maximum time of “no activity” since the last TTL counter event:

- Period = 0: Function disabled (default)
- Period > 0 (=n ms): If no counter event is registered in n ms, the speed will be set to 0.

# Zero pulse

There is no parameter for activating the zero pulse evaluation here, as this evaluation is controlled exclusively based on the homing mode (see Section ""Homing"" on page 249). However, setting P 541[0] - ENC_CH1_NpTest to 1 provides a test mode that can be used during commissioning in order to be able to activate the zero pulse evaluation even without homing. Scope signals 1014 and 1016 can be used to view a received zero pulse within this context. This test mode must be disabled during normal operation (P 541[0] = 0).

# Commutation

Motor operation with pure incremental encoders needs for the auto commutation function to be enabled without fail. For details see Section ""Synchronous motor auto commutation"" on page 156.

# 6.5.4.1.2 TTL incremental encoder with SSI absolute value interface

See Section ""Sin/Cos incremental encoders with absolute value interface"" on page 65 and in special Section ""SSI absolute value interface"" on page 67.

MSD ServoDrive - DeviceHelp

# 6 Encoder

MOOG ID No.:CB40859-001 Date:11/2020 MSD ServoDrive - DeviceHelp 64

|ID|Index Name|Unit|Description|
|---|---|---|---|
|505|0|ENC_CH1_Sel = 3|Encoder selection set to TTL(3)|
|510|0|ENC_CH1_Num|Encoder gearing: Numerator Ch1: SINCOS(1) - Sin/Cos signals|
|511|0|ENC_CH1_Denom|Encoder gearing: Denominator|
|540|0|ENC_CH1_Abs|Selection of absolute value interface Sin/Cos encoders can ...|
|541|0|ENC_CH1_NpTest|ENC CH1, TEST-MODE: Index pulse signal(s) to Scope|
|542|0|ENC_CH1_lines|Number of lines (Sin/Cos / TTL encoders) a. Be pure incremental encoders without an absolute value interface. In this|
|558|0|ENC_CH1_TTL_SignalType|Channel 1: TTL signal selection case, P 540[0] - ENC_CH1_Abs must be set to OFF(0).|
|601|0|ENC_CH1_Period|Maximum period of interpolation (TTL encoder)|
|616|0|ENC_CH1_CycleCount|Sampling cycle in: n x 125 μ (microseconds) b. Be incremental encoders with an absolute value interface. In this case,|

Table 6.8: Parameters for Channel 1 (X7) - TTL encoder

ENC_CH1_Abs must be accordingly set to SSI(1), EnDat(2), HIPER(3) or, in special cases, SSI_CONT(4) so that it will be possible to read the absolute encoder position for the absolute value initialization routine once during the initialization phase.

# 6.5.4.2.1 Purely Sin/Cos incremental encoders

To run these encoders as purely incremental encoders with a zero pulse on encoder channel Ch1 (without an absolute value interface), the approach is basically the same as for purely TTL operation (see Section ""TTL encoder"" on page 63). The same parameters apply.

However, there are the following differences:

- a. There are no different signal types for the Sin/Cos signal (always 1 Vss for cosine and sine).
- b. The zero pulse is the analog zero pulse typical of Sin/Cos encoders (see the “Connection for high-resolution encoders” section in the operation manual MSD Servo Drive Single-Axis System, for example).

# 6.5.4.2.2 Linear Sin/Cos

|ID|Index Name|Unit|Description|
|---|---|---|---|
|542|ENC_CH1_lines| |Number of Lines (Sin/Cos / TTL encoders)|
|543|ENC_CH1_MultiT| |Number of MultiTurn bits (absolute encoder)|
|544|ENC_CH1_SingleT| |Number of SingleTurn bits (absolute encoder)|
|545|ENC_CH1_Code| |Code selection (SSI encoder) (binary, gray)|
|546|ENC_CH1_Mode| |Mode selection (SSI encoder)|
|547|ENC_CH1_MTBase| |Definition of point of discontinuity in multi-turn range|
|548|ENC_CH1_MTEnable| |Enable MultiTurn use (negative logic, 1=MToff)|
|549|ENC_CH1_Corr| |Signal correction type|
|550|ENC_CH1_CorrVal|0-4|Signal correction values|
|551|ENC_CH1_EncObsMin| |Encoder monitoring minimum, sqrt(a^2+b^2)|
|552|ENC_CH1_AbsEncStatus| |Error and status codes (absolute encoder)|

# 6.5.4.2.3 Signal correction (GPOC)

|ID|Index Name|Unit|Description|
|---|---|---|---|
|553|ENC_CH1_PeriodLen|nm|Length of signal period (Sin/Cos linear encoder)|
|554|ENC_CH1_DigitalResolution|nm|Length of one increment (linear absolute encoder)|
|555|ENC_CH1_Info| |Encoder information|
|616|ENC_CH1_CycleCount| |Sampling cycle in: n x 125 μ (microseconds)|
|610|ENC_CH1_NominalIncrementA| |Sign. Nominal increment A (distance coded abs. per. encoder)|
|611|ENC_CH1_NominalIncrementB| |Sign. Nominal increment B (distance coded abs. per. encoder)|
|1900|ENC_ETS| |ETS mode, electronic nameplate|

# 6.5.4.2.4 Sin/Cos incremental encoders with absolute value interface

The following table lists the parameters for cyclical Sin/Cos operation on encoder channel Ch 1 with one-time reading of the absolute encoder position via the absolute value interface, i.e. without a zero pulse:

|ID|Index Name|Unit|Description|
|---|---|---|---|
|505|ENC_CH1_Sel|1|Encoder selection set to SINCOS(1)|
|510|ENC_CH1_Num| |Encoder gearing: Numerator|
|511|ENC_CH1_Denom| |Encoder gearing: Denominator|
|540|ENC_CH1_Abs| |Absolute value interface selection (one-time reading)|

Table 6.9: Parameters for channel 1 (X7) - Sin/Cos encoder

The Sel, Num, Denom, Abs, Lines, MultiT, SingleT and CorrVal parameters are self-explanatory.

The Code and Mode parameters are described in Section ""SSI (cyclical) X7"" on page 69.

P 547[0] - ENC_CH1_MTBase = Minimum MultiTurn position

The MTBase parameter is used to set a position in the multi-turn encoder’s travel path that defines the point of discontinuity (overflow/underflow) for the absolute value initialization (that is, the “multi-turn basis”). Assuming a bipolar encoder measuring range, all position values that fall below MTBase will be shifted “up” (the whole MT range will be added to them once).

MOOG ID No.:CB40859-001 Date:11/2020

MSD ServoDrive - DeviceHelp

# 6 Encoder

MOOG ID No.:CB40859-001 Date:11/2020

method makes it possible to place the point of discontinuity at any point within the encoder’s entire measuring range. By default, MTBase will be set to the lowest possible value for the parameter, i.e. reliably outside of the encoder’s value range: In this case, the full bipolar range will remain unaffected, as values will never fall below this MTBase threshold (see Section ""Channel 1: Interface X7"" on page 59).

- P 548[0] - ENC_CH1_MTEnable = MultiTurn as SingleTurn
- The MTEnable parameter makes it possible to use multi-turn encoders as single-turn encoders for test purposes. Negative logic: Default MTEnable = 0 means ""MultiTurn-Enable ON"".

P 549[0] - ENC_CH1_Corr = Signal correction type
- The GPOC routine used for track signal correction purposes for sine/cosine signals is used to compensate for systematic errors. The routine is controlled with the Corr and CorrVal parameters (see Section ""Signal correction GPOC (Gain Phase Offset Correction)"" on page 74).

P 551[0] - ENC_CH1_EncObsMin = Encoder monitoring minimum, sqrt (a^2+b^2)
- The parameter EncObsMin is used to scale the Sin/Cos wire break monitoring and represents the “downwards threshold” for an error message. The default setting is 0.2, corresponding to approx. ",What is the significance of the P 640[25] - ENDAT_BWZ_Supported parameter in the EnDat encoder interface?,A5,"By decoding P 640[25], users can determine the EnDat encoder's capability to support various valuation numbers for enhanced diagnostics.",2.078125,2.09375,3.390625,1.6484375,0.6640625
45,msd_servo_drive.txt,20,02f242a213dfa4411d028ce46dfba16a3f97395fa25788fcbaea1715e779d934,"), consult with your project supervisor or the Helpline provided by Moog before using any special SSI protocol modes.

# 6.5.2 EnDat (cyclical) X7

Ch1: ENDAT(4) - Cyclical EnDat (2.1 or 2.2) EnDat is a digital encoder interface developed by HEIDENHAIN. For more details, please visit www.heidenhain.de and go to ►Documentation ►Fundamentals ►Interfaces ►EnDat 2.2.

The software versions required to run the EnDat encoder interface are the standard software versions for the MSD Servo Drive and MSD Single-Axis Servo Drive Compact.

MOOG ID No.:CB40859-001 Date:11/2020

# 6 Encoder

NOTE

- Please note the limitations that apply when running EnDat and SSI encoders (see Section ""Limiting for EnDat and SSI"" on page 52).

When using linear encoders, P 554[0] - ENC_CH1_DigitalResolution is used instead of P 543[0] - ENC_CH1_MultiT and P 544[0] - ENC_CH1_SingleT (which are used for rotary encoders). The values will be read from the EnDat encoder and written to the aforementioned parameters.

- P 543[0] - ENC_CH1_MultiT
- The number ""n"" of multiturn bits defines the measuring range in 2n increments per encoder shaft revolution; maximum travel until overflow; maximum travel within which the absolute value initialization can be unambiguous. In the case of single-turn encoders, MultiT = 0.
- P 544[0] - ENC_CH1_SingleT
- The number ""n"" of single-turn bits corresponds to the encoder’s digital resolution in 2n increments per encoder shaft revolution.
- P 554[0] - ENC_CH1_DigitalResolution
- This is the length of an increment, in nanometres, of the encoder’s digitally transmitted position value. This value is read from the EnDat linear head.

In the case of linear encoders, the number n of transmitted position bits from the encoder will be found in SingleT only! 2n * DigitalResolution yields the maximum travel in nanometres (for the encoder head).

P 640 - ENC_ENDAT is intended for additional information, but is normally not needed. This parameter does not have a Ch1 or Ch3 prefix for the encoder channel in the name, as it applies to both encoder channels. Although usually not needed, the parameter is helpful or required in the following cases:

1. Special EnDat encoder with diagnostics for evaluation
In this case, the valuation numbers from the encoder are read cyclically via additional information. Only the valuation numbers that the encoder supports.

# 6 Encoder

MOOG ID No.:CB40859-001 Date:11/2020

will be read. During the initialization process, the system will read the encoder to determine which valuation numbers it supports. When P 640[0] - ENDAT_Select = 1, the function will be enabled in the controller and the internal diagnostics in the EnDaT encoder will be enabled as well. The EnDat encoder will keep this setting even after being powered off. To explicitly disable the internal diagnostics in the EnDat encoder, set P 640[0] - ENDAT_Select to 2.

# 2. Evaluation of internal warnings

In this scenario, certain internal warnings from the encoder will be read from the encoder via additional information. Only the warnings that both the encoder and the Servo Drive’s software support will be read. During the initialization process, the system will read the encoder to determine which warnings it supports. When P 640[0] - ENDAT_Select = 3, the function will be enabled in the controller.

**Table 6.7: Channel 1 encoder configuration (X7) - EnDat parameters**
|ID|Index Name|Unit|Description|
|---|---|---|---|
|505|0 ENC_CH1_Sel|= ENDAT(4)| |
|543|0 ENC_CH1_MultiT|Number of MultiTurn bits (absolute encoder)| |
|544|0 ENC_CH1_SingleT|Number of SingleTurn bits (absolute encoder)| |
|547|0 ENC_CH1_MTBase|Definition of point of discontinuity in multi-turn range| |
|548|0 ENC_CH1_MTEnable|1: Use Multi-turn encoder as a single-turn encoder| |
|616|0 ENC_CH1_CycleCount|Position encoder sampling cycle (n x 125 μsec)| |
|598|0 ENC_CH1_Position|inc|Position encoder channel 1|
|554|0 ENC_CH1_|nm|Length of one increment (linear absolute encoder)|
|640|ENC_ENDAT| |EnDat additional (additional information)|
|640|0 ENDAT_Select|0=off|EnDat function selection, 1/2=diagnosis on/off, 3=warnings, FF=lock|
|640|1 ENDAT_DiagCount|u16|count new diagnosis block header|
|640|2 ENDAT_BWZ_1|lowbyte|vn1: incremental track|
|640|3 ENDAT_BWZ_3|lowbyte|vn3: absolute track|
|640|4 ENDAT_BWZ_4|lowbyte|vn4: position value formation|
|640|5 ENDAT_Status| |EnDat additional status output|
|640|6 ENDAT_Z1_Sel| |EnDat additional information 1 type selection|

**Table 6.7: Overwrite Channel 1 encoder configuration (X7) - EnDat parameters (continue)**
|ID|Index Name|Unit|Description|
|---|---|---|---|
|640|7 ENDAT_Z1_1| |Z1 info: dword 1|
|640|8 ENDAT_Z1_2| |Z1 info: dword 2|
|640|9 ENDAT_Z1_3| |Z1 info: dword 3|
|640|10 ENDAT_Z1_4| |Z1 info: dword 4|
|640|11 ENDAT_Z2_Sel| |EnDat additional information 2 type selection|
|640|12 ENDAT_Z2_1| |Z2 info: dword 1|
|640|13 ENDAT_Z2_2| |Z2 info: dword 2|
|640|14 ENDAT_Z2_3| |Z2 info: dword 3|
|640|15 ENDAT_Z2_4| |Z2 info: dword 4|
|640|16 ENDAT_Mode1|0=off|EnDat additional mode 1 selection|
|640|17 ENDAT_Mode2| |EnDat additional mode 2 selection|
|640|18 ENDAT_Mode3| |EnDat additional mode 3 selection|
|640|19 ENDAT_Mode4| |EnDat additional mode 4 selection|
|640|20 ENDAT_res1| |reserved 1|
|640|21 ENDAT_res2| |reserved 2|
|640|22 ENDAT_res3| |reserved 3|
|640|23 ENDAT_HwSyncStop|0=SyncOn|EnDat cyclic hw sync, stop/start 1/0|
|640|24 ENDAT_CyclCount| |call counter of cyclic function|
|640|25 ENDAT_BWZ_Supported| |vn supported (bit3=vn4, bit2=vn3, bit0=vn1)|
|640|26 ENDAT_BWZ1_| |vn1: bits[7..0] threshold level, bits[31..16]|
|640|27 ThresholdLevel| |how often number|
|640|28 ENDAT_BWZ3_| |vn3: bits[7..0] threshold level, bits[31..16]|
|640|29 ThresholdLevel| |how often number|
|640|30 ENDAT_BWZ4_| |vn4: bits[7..0] threshold level, bits[31..16]|
|640|31 ThresholdLevel| |how often number|
|640|32 ENDAT_BWZ_TEST_| |vn: bits[15..12] 'F', bits[11..8] vn.no., bits [7..0] vn overwrite value|

# 6.5.3 Hall sensor X7

Ch1: HALL(5) - Digital hall signals

Ch1: HALL_TTL(7) - Digital hall signals

NOTE

l The operation and configuration of Hall effect sensors is reserved for special applications. Consult with Moog if needed.

# 6.5.4 Sin/Cos / TTL X7

# 6.5.4.1 TTL encoder

Ch1: TTL(3) - TTL signals

TTL encoders are ...

- a. ... ... usually pure incremental encoders without an absolute value interface.
- b. In this case, P 540[0] - ENC_CH1_Abs must be set to OFF(0). ... ... in a few exceptional cases, incremental encoders with an SSI absolute value interface. In this case, P 540[0] - ENC_CH1_Abs must be accordingly set to SSI(1) (SSI_CONT(4) in special cases), so that it will be possible to read the absolute encoder position for the absolute value initialization routine once during the initialization phase.

# 6.5.4.1.1 Pure TTL incremental encoder

Set P 505[0] - ENC_CH1_Sel to TTL(3) and P 540[0] - ENC_CH1_Abs to OFF(0) when using pure TTL encoders, i.e. encoders without an absolute value interface but with a TTL zero pulse.

Linear TTL encoders are run as rotary encoders. For linear motor operation, P 542 [0] - ENC_CH1_Lines and the encoder gearing (see the “Encoder gearing” section) are used to establish the ratio for the linear motor’s pole pair subdivision (North-North) for commutation. 1 x North-North corresponds to one revolution from Lines. In this case, the motor pole pair number must be set to 1. Moreover, P 553[0] - ENC_CH1_PeriodLen is not used in this case.

The TTL interface accepts various TTL signal types, which can be selected using P 558[0] - ENC_CH1_TTL_SignalType:

- (0)AF_B - A/B tracks (forward counting, X4 encoding) - AB
- (1)AR_B - A/B tracks (reverse counting, X4 encoding) - AB_inv
- (2)ABDFN - A: Clock (falling edge), B: Direction (1 = positive) - PulseDir
- (3)ABDRP - A: Clock (rising edge), B: Direction (1 = negative) - PulseDir_inv
- (4)reserved

A maximum interpolation period, in ms (milliseconds), can be configured for the TTL interface using P 601[0] - ENC_CH1_Period. Within this context, Period is the maximum time of “no activity” since the last TTL counter event:

- Period = 0: Function disabled (default)
- Period > 0 (=n ms): If no counter event is registered in n ms, the speed will be set to 0.

# Zero pulse

There is no parameter for activating the zero pulse evaluation here, as this evaluation is controlled exclusively based on the homing mode (see Section ""Homing"" on page 249). However, setting P 541[0] - ENC_CH1_NpTest to 1 provides a test mode that can be used during commissioning in order to be able to activate the zero pulse evaluation even without homing. Scope signals 1014 and 1016 can be used to view a received zero pulse within this context. This test mode must be disabled during normal operation (P 541[0] = 0).

# Commutation

Motor operation with pure incremental encoders needs for the auto commutation function to be enabled without fail. For details see Section ""Synchronous motor auto commutation"" on page 156.

# 6.5.4.1.2 TTL incremental encoder with SSI absolute value interface

See Section ""Sin/Cos incremental encoders with absolute value interface"" on page 65 and in special Section ""SSI absolute value interface"" on page 67.

MSD ServoDrive - DeviceHelp

# 6 Encoder

MOOG ID No.:CB40859-001 Date:11/2020 MSD ServoDrive - DeviceHelp 64

|ID|Index Name|Unit|Description|
|---|---|---|---|
|505|0|ENC_CH1_Sel = 3|Encoder selection set to TTL(3)|
|510|0|ENC_CH1_Num|Encoder gearing: Numerator Ch1: SINCOS(1) - Sin/Cos signals|
|511|0|ENC_CH1_Denom|Encoder gearing: Denominator|
|540|0|ENC_CH1_Abs|Selection of absolute value interface Sin/Cos encoders can ...|
|541|0|ENC_CH1_NpTest|ENC CH1, TEST-MODE: Index pulse signal(s) to Scope|
|542|0|ENC_CH1_lines|Number of lines (Sin/Cos / TTL encoders) a. Be pure incremental encoders without an absolute value interface. In this|
|558|0|ENC_CH1_TTL_SignalType|Channel 1: TTL signal selection case, P 540[0] - ENC_CH1_Abs must be set to OFF(0).|
|601|0|ENC_CH1_Period|Maximum period of interpolation (TTL encoder)|
|616|0|ENC_CH1_CycleCount|Sampling cycle in: n x 125 μ (microseconds) b. Be incremental encoders with an absolute value interface. In this case,|

Table 6.8: Parameters for Channel 1 (X7) - TTL encoder

ENC_CH1_Abs must be accordingly set to SSI(1), EnDat(2), HIPER(3) or, in special cases, SSI_CONT(4) so that it will be possible to read the absolute encoder position for the absolute value initialization routine once during the initialization phase.

# 6.5.4.2.1 Purely Sin/Cos incremental encoders

To run these encoders as purely incremental encoders with a zero pulse on encoder channel Ch1 (without an absolute value interface), the approach is basically the same as for purely TTL operation (see Section ""TTL encoder"" on page 63). The same parameters apply.

However, there are the following differences:

- a. There are no different signal types for the Sin/Cos signal (always 1 Vss for cosine and sine).
- b. The zero pulse is the analog zero pulse typical of Sin/Cos encoders (see the “Connection for high-resolution encoders” section in the operation manual MSD Servo Drive Single-Axis System, for example).

# 6.5.4.2.2 Linear Sin/Cos

|ID|Index Name|Unit|Description|
|---|---|---|---|
|542|ENC_CH1_lines| |Number of Lines (Sin/Cos / TTL encoders)|
|543|ENC_CH1_MultiT| |Number of MultiTurn bits (absolute encoder)|
|544|ENC_CH1_SingleT| |Number of SingleTurn bits (absolute encoder)|
|545|ENC_CH1_Code| |Code selection (SSI encoder) (binary, gray)|
|546|ENC_CH1_Mode| |Mode selection (SSI encoder)|
|547|ENC_CH1_MTBase| |Definition of point of discontinuity in multi-turn range|
|548|ENC_CH1_MTEnable| |Enable MultiTurn use (negative logic, 1=MToff)|
|549|ENC_CH1_Corr| |Signal correction type|
|550|ENC_CH1_CorrVal|0-4|Signal correction values|
|551|ENC_CH1_EncObsMin| |Encoder monitoring minimum, sqrt(a^2+b^2)|
|552|ENC_CH1_AbsEncStatus| |Error and status codes (absolute encoder)|

# 6.5.4.2.3 Signal correction (GPOC)

|ID|Index Name|Unit|Description|
|---|---|---|---|
|553|ENC_CH1_PeriodLen|nm|Length of signal period (Sin/Cos linear encoder)|
|554|ENC_CH1_DigitalResolution|nm|Length of one increment (linear absolute encoder)|
|555|ENC_CH1_Info| |Encoder information|
|616|ENC_CH1_CycleCount| |Sampling cycle in: n x 125 μ (microseconds)|
|610|ENC_CH1_NominalIncrementA| |Sign. Nominal increment A (distance coded abs. per. encoder)|
|611|ENC_CH1_NominalIncrementB| |Sign. Nominal increment B (distance coded abs. per. encoder)|
|1900|ENC_ETS| |ETS mode, electronic nameplate|

# 6.5.4.2.4 Sin/Cos incremental encoders with absolute value interface

The following table lists the parameters for cyclical Sin/Cos operation on encoder channel Ch 1 with one-time reading of the absolute encoder position via the absolute value interface, i.e. without a zero pulse:

|ID|Index Name|Unit|Description|
|---|---|---|---|
|505|ENC_CH1_Sel|1|Encoder selection set to SINCOS(1)|
|510|ENC_CH1_Num| |Encoder gearing: Numerator|
|511|ENC_CH1_Denom| |Encoder gearing: Denominator|
|540|ENC_CH1_Abs| |Absolute value interface selection (one-time reading)|

Table 6.9: Parameters for channel 1 (X7) - Sin/Cos encoder

The Sel, Num, Denom, Abs, Lines, MultiT, SingleT and CorrVal parameters are self-explanatory.

The Code and Mode parameters are described in Section ""SSI (cyclical) X7"" on page 69.

P 547[0] - ENC_CH1_MTBase = Minimum MultiTurn position

The MTBase parameter is used to set a position in the multi-turn encoder’s travel path that defines the point of discontinuity (overflow/underflow) for the absolute value initialization (that is, the “multi-turn basis”). Assuming a bipolar encoder measuring range, all position values that fall below MTBase will be shifted “up” (the whole MT range will be added to them once).

MOOG ID No.:CB40859-001 Date:11/2020

MSD ServoDrive - DeviceHelp

# 6 Encoder

MOOG ID No.:CB40859-001 Date:11/2020

method makes it possible to place the point of discontinuity at any point within the encoder’s entire measuring range. By default, MTBase will be set to the lowest possible value for the parameter, i.e. reliably outside of the encoder’s value range: In this case, the full bipolar range will remain unaffected, as values will never fall below this MTBase threshold (see Section ""Channel 1: Interface X7"" on page 59).

- P 548[0] - ENC_CH1_MTEnable = MultiTurn as SingleTurn
- The MTEnable parameter makes it possible to use multi-turn encoders as single-turn encoders for test purposes. Negative logic: Default MTEnable = 0 means ""MultiTurn-Enable ON"".

P 549[0] - ENC_CH1_Corr = Signal correction type
- The GPOC routine used for track signal correction purposes for sine/cosine signals is used to compensate for systematic errors. The routine is controlled with the Corr and CorrVal parameters (see Section ""Signal correction GPOC (Gain Phase Offset Correction)"" on page 74).

P 551[0] - ENC_CH1_EncObsMin = Encoder monitoring minimum, sqrt (a^2+b^2)
- The parameter EncObsMin is used to scale the Sin/Cos wire break monitoring and represents the “downwards threshold” for an error message. The default setting is 0.2, corresponding to approx. ",What role does the P 541[0] - ENC_CH1_NpTest parameter play in TTL encoder setups?,A1,"P 541[0] activates a test mode for zero pulse evaluation during TTL encoder commissioning, allowing zero pulse detection without homing.",2.46875,2.59375,3.640625,1.6796875,0.5234375
46,msd_servo_drive.txt,20,02f242a213dfa4411d028ce46dfba16a3f97395fa25788fcbaea1715e779d934,"), consult with your project supervisor or the Helpline provided by Moog before using any special SSI protocol modes.

# 6.5.2 EnDat (cyclical) X7

Ch1: ENDAT(4) - Cyclical EnDat (2.1 or 2.2) EnDat is a digital encoder interface developed by HEIDENHAIN. For more details, please visit www.heidenhain.de and go to ►Documentation ►Fundamentals ►Interfaces ►EnDat 2.2.

The software versions required to run the EnDat encoder interface are the standard software versions for the MSD Servo Drive and MSD Single-Axis Servo Drive Compact.

MOOG ID No.:CB40859-001 Date:11/2020

# 6 Encoder

NOTE

- Please note the limitations that apply when running EnDat and SSI encoders (see Section ""Limiting for EnDat and SSI"" on page 52).

When using linear encoders, P 554[0] - ENC_CH1_DigitalResolution is used instead of P 543[0] - ENC_CH1_MultiT and P 544[0] - ENC_CH1_SingleT (which are used for rotary encoders). The values will be read from the EnDat encoder and written to the aforementioned parameters.

- P 543[0] - ENC_CH1_MultiT
- The number ""n"" of multiturn bits defines the measuring range in 2n increments per encoder shaft revolution; maximum travel until overflow; maximum travel within which the absolute value initialization can be unambiguous. In the case of single-turn encoders, MultiT = 0.
- P 544[0] - ENC_CH1_SingleT
- The number ""n"" of single-turn bits corresponds to the encoder’s digital resolution in 2n increments per encoder shaft revolution.
- P 554[0] - ENC_CH1_DigitalResolution
- This is the length of an increment, in nanometres, of the encoder’s digitally transmitted position value. This value is read from the EnDat linear head.

In the case of linear encoders, the number n of transmitted position bits from the encoder will be found in SingleT only! 2n * DigitalResolution yields the maximum travel in nanometres (for the encoder head).

P 640 - ENC_ENDAT is intended for additional information, but is normally not needed. This parameter does not have a Ch1 or Ch3 prefix for the encoder channel in the name, as it applies to both encoder channels. Although usually not needed, the parameter is helpful or required in the following cases:

1. Special EnDat encoder with diagnostics for evaluation
In this case, the valuation numbers from the encoder are read cyclically via additional information. Only the valuation numbers that the encoder supports.

# 6 Encoder

MOOG ID No.:CB40859-001 Date:11/2020

will be read. During the initialization process, the system will read the encoder to determine which valuation numbers it supports. When P 640[0] - ENDAT_Select = 1, the function will be enabled in the controller and the internal diagnostics in the EnDaT encoder will be enabled as well. The EnDat encoder will keep this setting even after being powered off. To explicitly disable the internal diagnostics in the EnDat encoder, set P 640[0] - ENDAT_Select to 2.

# 2. Evaluation of internal warnings

In this scenario, certain internal warnings from the encoder will be read from the encoder via additional information. Only the warnings that both the encoder and the Servo Drive’s software support will be read. During the initialization process, the system will read the encoder to determine which warnings it supports. When P 640[0] - ENDAT_Select = 3, the function will be enabled in the controller.

**Table 6.7: Channel 1 encoder configuration (X7) - EnDat parameters**
|ID|Index Name|Unit|Description|
|---|---|---|---|
|505|0 ENC_CH1_Sel|= ENDAT(4)| |
|543|0 ENC_CH1_MultiT|Number of MultiTurn bits (absolute encoder)| |
|544|0 ENC_CH1_SingleT|Number of SingleTurn bits (absolute encoder)| |
|547|0 ENC_CH1_MTBase|Definition of point of discontinuity in multi-turn range| |
|548|0 ENC_CH1_MTEnable|1: Use Multi-turn encoder as a single-turn encoder| |
|616|0 ENC_CH1_CycleCount|Position encoder sampling cycle (n x 125 μsec)| |
|598|0 ENC_CH1_Position|inc|Position encoder channel 1|
|554|0 ENC_CH1_|nm|Length of one increment (linear absolute encoder)|
|640|ENC_ENDAT| |EnDat additional (additional information)|
|640|0 ENDAT_Select|0=off|EnDat function selection, 1/2=diagnosis on/off, 3=warnings, FF=lock|
|640|1 ENDAT_DiagCount|u16|count new diagnosis block header|
|640|2 ENDAT_BWZ_1|lowbyte|vn1: incremental track|
|640|3 ENDAT_BWZ_3|lowbyte|vn3: absolute track|
|640|4 ENDAT_BWZ_4|lowbyte|vn4: position value formation|
|640|5 ENDAT_Status| |EnDat additional status output|
|640|6 ENDAT_Z1_Sel| |EnDat additional information 1 type selection|

**Table 6.7: Overwrite Channel 1 encoder configuration (X7) - EnDat parameters (continue)**
|ID|Index Name|Unit|Description|
|---|---|---|---|
|640|7 ENDAT_Z1_1| |Z1 info: dword 1|
|640|8 ENDAT_Z1_2| |Z1 info: dword 2|
|640|9 ENDAT_Z1_3| |Z1 info: dword 3|
|640|10 ENDAT_Z1_4| |Z1 info: dword 4|
|640|11 ENDAT_Z2_Sel| |EnDat additional information 2 type selection|
|640|12 ENDAT_Z2_1| |Z2 info: dword 1|
|640|13 ENDAT_Z2_2| |Z2 info: dword 2|
|640|14 ENDAT_Z2_3| |Z2 info: dword 3|
|640|15 ENDAT_Z2_4| |Z2 info: dword 4|
|640|16 ENDAT_Mode1|0=off|EnDat additional mode 1 selection|
|640|17 ENDAT_Mode2| |EnDat additional mode 2 selection|
|640|18 ENDAT_Mode3| |EnDat additional mode 3 selection|
|640|19 ENDAT_Mode4| |EnDat additional mode 4 selection|
|640|20 ENDAT_res1| |reserved 1|
|640|21 ENDAT_res2| |reserved 2|
|640|22 ENDAT_res3| |reserved 3|
|640|23 ENDAT_HwSyncStop|0=SyncOn|EnDat cyclic hw sync, stop/start 1/0|
|640|24 ENDAT_CyclCount| |call counter of cyclic function|
|640|25 ENDAT_BWZ_Supported| |vn supported (bit3=vn4, bit2=vn3, bit0=vn1)|
|640|26 ENDAT_BWZ1_| |vn1: bits[7..0] threshold level, bits[31..16]|
|640|27 ThresholdLevel| |how often number|
|640|28 ENDAT_BWZ3_| |vn3: bits[7..0] threshold level, bits[31..16]|
|640|29 ThresholdLevel| |how often number|
|640|30 ENDAT_BWZ4_| |vn4: bits[7..0] threshold level, bits[31..16]|
|640|31 ThresholdLevel| |how often number|
|640|32 ENDAT_BWZ_TEST_| |vn: bits[15..12] 'F', bits[11..8] vn.no., bits [7..0] vn overwrite value|

# 6.5.3 Hall sensor X7

Ch1: HALL(5) - Digital hall signals

Ch1: HALL_TTL(7) - Digital hall signals

NOTE

l The operation and configuration of Hall effect sensors is reserved for special applications. Consult with Moog if needed.

# 6.5.4 Sin/Cos / TTL X7

# 6.5.4.1 TTL encoder

Ch1: TTL(3) - TTL signals

TTL encoders are ...

- a. ... ... usually pure incremental encoders without an absolute value interface.
- b. In this case, P 540[0] - ENC_CH1_Abs must be set to OFF(0). ... ... in a few exceptional cases, incremental encoders with an SSI absolute value interface. In this case, P 540[0] - ENC_CH1_Abs must be accordingly set to SSI(1) (SSI_CONT(4) in special cases), so that it will be possible to read the absolute encoder position for the absolute value initialization routine once during the initialization phase.

# 6.5.4.1.1 Pure TTL incremental encoder

Set P 505[0] - ENC_CH1_Sel to TTL(3) and P 540[0] - ENC_CH1_Abs to OFF(0) when using pure TTL encoders, i.e. encoders without an absolute value interface but with a TTL zero pulse.

Linear TTL encoders are run as rotary encoders. For linear motor operation, P 542 [0] - ENC_CH1_Lines and the encoder gearing (see the “Encoder gearing” section) are used to establish the ratio for the linear motor’s pole pair subdivision (North-North) for commutation. 1 x North-North corresponds to one revolution from Lines. In this case, the motor pole pair number must be set to 1. Moreover, P 553[0] - ENC_CH1_PeriodLen is not used in this case.

The TTL interface accepts various TTL signal types, which can be selected using P 558[0] - ENC_CH1_TTL_SignalType:

- (0)AF_B - A/B tracks (forward counting, X4 encoding) - AB
- (1)AR_B - A/B tracks (reverse counting, X4 encoding) - AB_inv
- (2)ABDFN - A: Clock (falling edge), B: Direction (1 = positive) - PulseDir
- (3)ABDRP - A: Clock (rising edge), B: Direction (1 = negative) - PulseDir_inv
- (4)reserved

A maximum interpolation period, in ms (milliseconds), can be configured for the TTL interface using P 601[0] - ENC_CH1_Period. Within this context, Period is the maximum time of “no activity” since the last TTL counter event:

- Period = 0: Function disabled (default)
- Period > 0 (=n ms): If no counter event is registered in n ms, the speed will be set to 0.

# Zero pulse

There is no parameter for activating the zero pulse evaluation here, as this evaluation is controlled exclusively based on the homing mode (see Section ""Homing"" on page 249). However, setting P 541[0] - ENC_CH1_NpTest to 1 provides a test mode that can be used during commissioning in order to be able to activate the zero pulse evaluation even without homing. Scope signals 1014 and 1016 can be used to view a received zero pulse within this context. This test mode must be disabled during normal operation (P 541[0] = 0).

# Commutation

Motor operation with pure incremental encoders needs for the auto commutation function to be enabled without fail. For details see Section ""Synchronous motor auto commutation"" on page 156.

# 6.5.4.1.2 TTL incremental encoder with SSI absolute value interface

See Section ""Sin/Cos incremental encoders with absolute value interface"" on page 65 and in special Section ""SSI absolute value interface"" on page 67.

MSD ServoDrive - DeviceHelp

# 6 Encoder

MOOG ID No.:CB40859-001 Date:11/2020 MSD ServoDrive - DeviceHelp 64

|ID|Index Name|Unit|Description|
|---|---|---|---|
|505|0|ENC_CH1_Sel = 3|Encoder selection set to TTL(3)|
|510|0|ENC_CH1_Num|Encoder gearing: Numerator Ch1: SINCOS(1) - Sin/Cos signals|
|511|0|ENC_CH1_Denom|Encoder gearing: Denominator|
|540|0|ENC_CH1_Abs|Selection of absolute value interface Sin/Cos encoders can ...|
|541|0|ENC_CH1_NpTest|ENC CH1, TEST-MODE: Index pulse signal(s) to Scope|
|542|0|ENC_CH1_lines|Number of lines (Sin/Cos / TTL encoders) a. Be pure incremental encoders without an absolute value interface. In this|
|558|0|ENC_CH1_TTL_SignalType|Channel 1: TTL signal selection case, P 540[0] - ENC_CH1_Abs must be set to OFF(0).|
|601|0|ENC_CH1_Period|Maximum period of interpolation (TTL encoder)|
|616|0|ENC_CH1_CycleCount|Sampling cycle in: n x 125 μ (microseconds) b. Be incremental encoders with an absolute value interface. In this case,|

Table 6.8: Parameters for Channel 1 (X7) - TTL encoder

ENC_CH1_Abs must be accordingly set to SSI(1), EnDat(2), HIPER(3) or, in special cases, SSI_CONT(4) so that it will be possible to read the absolute encoder position for the absolute value initialization routine once during the initialization phase.

# 6.5.4.2.1 Purely Sin/Cos incremental encoders

To run these encoders as purely incremental encoders with a zero pulse on encoder channel Ch1 (without an absolute value interface), the approach is basically the same as for purely TTL operation (see Section ""TTL encoder"" on page 63). The same parameters apply.

However, there are the following differences:

- a. There are no different signal types for the Sin/Cos signal (always 1 Vss for cosine and sine).
- b. The zero pulse is the analog zero pulse typical of Sin/Cos encoders (see the “Connection for high-resolution encoders” section in the operation manual MSD Servo Drive Single-Axis System, for example).

# 6.5.4.2.2 Linear Sin/Cos

|ID|Index Name|Unit|Description|
|---|---|---|---|
|542|ENC_CH1_lines| |Number of Lines (Sin/Cos / TTL encoders)|
|543|ENC_CH1_MultiT| |Number of MultiTurn bits (absolute encoder)|
|544|ENC_CH1_SingleT| |Number of SingleTurn bits (absolute encoder)|
|545|ENC_CH1_Code| |Code selection (SSI encoder) (binary, gray)|
|546|ENC_CH1_Mode| |Mode selection (SSI encoder)|
|547|ENC_CH1_MTBase| |Definition of point of discontinuity in multi-turn range|
|548|ENC_CH1_MTEnable| |Enable MultiTurn use (negative logic, 1=MToff)|
|549|ENC_CH1_Corr| |Signal correction type|
|550|ENC_CH1_CorrVal|0-4|Signal correction values|
|551|ENC_CH1_EncObsMin| |Encoder monitoring minimum, sqrt(a^2+b^2)|
|552|ENC_CH1_AbsEncStatus| |Error and status codes (absolute encoder)|

# 6.5.4.2.3 Signal correction (GPOC)

|ID|Index Name|Unit|Description|
|---|---|---|---|
|553|ENC_CH1_PeriodLen|nm|Length of signal period (Sin/Cos linear encoder)|
|554|ENC_CH1_DigitalResolution|nm|Length of one increment (linear absolute encoder)|
|555|ENC_CH1_Info| |Encoder information|
|616|ENC_CH1_CycleCount| |Sampling cycle in: n x 125 μ (microseconds)|
|610|ENC_CH1_NominalIncrementA| |Sign. Nominal increment A (distance coded abs. per. encoder)|
|611|ENC_CH1_NominalIncrementB| |Sign. Nominal increment B (distance coded abs. per. encoder)|
|1900|ENC_ETS| |ETS mode, electronic nameplate|

# 6.5.4.2.4 Sin/Cos incremental encoders with absolute value interface

The following table lists the parameters for cyclical Sin/Cos operation on encoder channel Ch 1 with one-time reading of the absolute encoder position via the absolute value interface, i.e. without a zero pulse:

|ID|Index Name|Unit|Description|
|---|---|---|---|
|505|ENC_CH1_Sel|1|Encoder selection set to SINCOS(1)|
|510|ENC_CH1_Num| |Encoder gearing: Numerator|
|511|ENC_CH1_Denom| |Encoder gearing: Denominator|
|540|ENC_CH1_Abs| |Absolute value interface selection (one-time reading)|

Table 6.9: Parameters for channel 1 (X7) - Sin/Cos encoder

The Sel, Num, Denom, Abs, Lines, MultiT, SingleT and CorrVal parameters are self-explanatory.

The Code and Mode parameters are described in Section ""SSI (cyclical) X7"" on page 69.

P 547[0] - ENC_CH1_MTBase = Minimum MultiTurn position

The MTBase parameter is used to set a position in the multi-turn encoder’s travel path that defines the point of discontinuity (overflow/underflow) for the absolute value initialization (that is, the “multi-turn basis”). Assuming a bipolar encoder measuring range, all position values that fall below MTBase will be shifted “up” (the whole MT range will be added to them once).

MOOG ID No.:CB40859-001 Date:11/2020

MSD ServoDrive - DeviceHelp

# 6 Encoder

MOOG ID No.:CB40859-001 Date:11/2020

method makes it possible to place the point of discontinuity at any point within the encoder’s entire measuring range. By default, MTBase will be set to the lowest possible value for the parameter, i.e. reliably outside of the encoder’s value range: In this case, the full bipolar range will remain unaffected, as values will never fall below this MTBase threshold (see Section ""Channel 1: Interface X7"" on page 59).

- P 548[0] - ENC_CH1_MTEnable = MultiTurn as SingleTurn
- The MTEnable parameter makes it possible to use multi-turn encoders as single-turn encoders for test purposes. Negative logic: Default MTEnable = 0 means ""MultiTurn-Enable ON"".

P 549[0] - ENC_CH1_Corr = Signal correction type
- The GPOC routine used for track signal correction purposes for sine/cosine signals is used to compensate for systematic errors. The routine is controlled with the Corr and CorrVal parameters (see Section ""Signal correction GPOC (Gain Phase Offset Correction)"" on page 74).

P 551[0] - ENC_CH1_EncObsMin = Encoder monitoring minimum, sqrt (a^2+b^2)
- The parameter EncObsMin is used to scale the Sin/Cos wire break monitoring and represents the “downwards threshold” for an error message. The default setting is 0.2, corresponding to approx. ",What role does the P 541[0] - ENC_CH1_NpTest parameter play in TTL encoder setups?,A2,"This parameter enables a commissioning test mode to verify zero pulse functionality, which must be disabled (set to 0) for normal operation.",2.859375,2.96875,3.71875,1.7109375,0.59765625
47,msd_servo_drive.txt,20,02f242a213dfa4411d028ce46dfba16a3f97395fa25788fcbaea1715e779d934,"), consult with your project supervisor or the Helpline provided by Moog before using any special SSI protocol modes.

# 6.5.2 EnDat (cyclical) X7

Ch1: ENDAT(4) - Cyclical EnDat (2.1 or 2.2) EnDat is a digital encoder interface developed by HEIDENHAIN. For more details, please visit www.heidenhain.de and go to ►Documentation ►Fundamentals ►Interfaces ►EnDat 2.2.

The software versions required to run the EnDat encoder interface are the standard software versions for the MSD Servo Drive and MSD Single-Axis Servo Drive Compact.

MOOG ID No.:CB40859-001 Date:11/2020

# 6 Encoder

NOTE

- Please note the limitations that apply when running EnDat and SSI encoders (see Section ""Limiting for EnDat and SSI"" on page 52).

When using linear encoders, P 554[0] - ENC_CH1_DigitalResolution is used instead of P 543[0] - ENC_CH1_MultiT and P 544[0] - ENC_CH1_SingleT (which are used for rotary encoders). The values will be read from the EnDat encoder and written to the aforementioned parameters.

- P 543[0] - ENC_CH1_MultiT
- The number ""n"" of multiturn bits defines the measuring range in 2n increments per encoder shaft revolution; maximum travel until overflow; maximum travel within which the absolute value initialization can be unambiguous. In the case of single-turn encoders, MultiT = 0.
- P 544[0] - ENC_CH1_SingleT
- The number ""n"" of single-turn bits corresponds to the encoder’s digital resolution in 2n increments per encoder shaft revolution.
- P 554[0] - ENC_CH1_DigitalResolution
- This is the length of an increment, in nanometres, of the encoder’s digitally transmitted position value. This value is read from the EnDat linear head.

In the case of linear encoders, the number n of transmitted position bits from the encoder will be found in SingleT only! 2n * DigitalResolution yields the maximum travel in nanometres (for the encoder head).

P 640 - ENC_ENDAT is intended for additional information, but is normally not needed. This parameter does not have a Ch1 or Ch3 prefix for the encoder channel in the name, as it applies to both encoder channels. Although usually not needed, the parameter is helpful or required in the following cases:

1. Special EnDat encoder with diagnostics for evaluation
In this case, the valuation numbers from the encoder are read cyclically via additional information. Only the valuation numbers that the encoder supports.

# 6 Encoder

MOOG ID No.:CB40859-001 Date:11/2020

will be read. During the initialization process, the system will read the encoder to determine which valuation numbers it supports. When P 640[0] - ENDAT_Select = 1, the function will be enabled in the controller and the internal diagnostics in the EnDaT encoder will be enabled as well. The EnDat encoder will keep this setting even after being powered off. To explicitly disable the internal diagnostics in the EnDat encoder, set P 640[0] - ENDAT_Select to 2.

# 2. Evaluation of internal warnings

In this scenario, certain internal warnings from the encoder will be read from the encoder via additional information. Only the warnings that both the encoder and the Servo Drive’s software support will be read. During the initialization process, the system will read the encoder to determine which warnings it supports. When P 640[0] - ENDAT_Select = 3, the function will be enabled in the controller.

**Table 6.7: Channel 1 encoder configuration (X7) - EnDat parameters**
|ID|Index Name|Unit|Description|
|---|---|---|---|
|505|0 ENC_CH1_Sel|= ENDAT(4)| |
|543|0 ENC_CH1_MultiT|Number of MultiTurn bits (absolute encoder)| |
|544|0 ENC_CH1_SingleT|Number of SingleTurn bits (absolute encoder)| |
|547|0 ENC_CH1_MTBase|Definition of point of discontinuity in multi-turn range| |
|548|0 ENC_CH1_MTEnable|1: Use Multi-turn encoder as a single-turn encoder| |
|616|0 ENC_CH1_CycleCount|Position encoder sampling cycle (n x 125 μsec)| |
|598|0 ENC_CH1_Position|inc|Position encoder channel 1|
|554|0 ENC_CH1_|nm|Length of one increment (linear absolute encoder)|
|640|ENC_ENDAT| |EnDat additional (additional information)|
|640|0 ENDAT_Select|0=off|EnDat function selection, 1/2=diagnosis on/off, 3=warnings, FF=lock|
|640|1 ENDAT_DiagCount|u16|count new diagnosis block header|
|640|2 ENDAT_BWZ_1|lowbyte|vn1: incremental track|
|640|3 ENDAT_BWZ_3|lowbyte|vn3: absolute track|
|640|4 ENDAT_BWZ_4|lowbyte|vn4: position value formation|
|640|5 ENDAT_Status| |EnDat additional status output|
|640|6 ENDAT_Z1_Sel| |EnDat additional information 1 type selection|

**Table 6.7: Overwrite Channel 1 encoder configuration (X7) - EnDat parameters (continue)**
|ID|Index Name|Unit|Description|
|---|---|---|---|
|640|7 ENDAT_Z1_1| |Z1 info: dword 1|
|640|8 ENDAT_Z1_2| |Z1 info: dword 2|
|640|9 ENDAT_Z1_3| |Z1 info: dword 3|
|640|10 ENDAT_Z1_4| |Z1 info: dword 4|
|640|11 ENDAT_Z2_Sel| |EnDat additional information 2 type selection|
|640|12 ENDAT_Z2_1| |Z2 info: dword 1|
|640|13 ENDAT_Z2_2| |Z2 info: dword 2|
|640|14 ENDAT_Z2_3| |Z2 info: dword 3|
|640|15 ENDAT_Z2_4| |Z2 info: dword 4|
|640|16 ENDAT_Mode1|0=off|EnDat additional mode 1 selection|
|640|17 ENDAT_Mode2| |EnDat additional mode 2 selection|
|640|18 ENDAT_Mode3| |EnDat additional mode 3 selection|
|640|19 ENDAT_Mode4| |EnDat additional mode 4 selection|
|640|20 ENDAT_res1| |reserved 1|
|640|21 ENDAT_res2| |reserved 2|
|640|22 ENDAT_res3| |reserved 3|
|640|23 ENDAT_HwSyncStop|0=SyncOn|EnDat cyclic hw sync, stop/start 1/0|
|640|24 ENDAT_CyclCount| |call counter of cyclic function|
|640|25 ENDAT_BWZ_Supported| |vn supported (bit3=vn4, bit2=vn3, bit0=vn1)|
|640|26 ENDAT_BWZ1_| |vn1: bits[7..0] threshold level, bits[31..16]|
|640|27 ThresholdLevel| |how often number|
|640|28 ENDAT_BWZ3_| |vn3: bits[7..0] threshold level, bits[31..16]|
|640|29 ThresholdLevel| |how often number|
|640|30 ENDAT_BWZ4_| |vn4: bits[7..0] threshold level, bits[31..16]|
|640|31 ThresholdLevel| |how often number|
|640|32 ENDAT_BWZ_TEST_| |vn: bits[15..12] 'F', bits[11..8] vn.no., bits [7..0] vn overwrite value|

# 6.5.3 Hall sensor X7

Ch1: HALL(5) - Digital hall signals

Ch1: HALL_TTL(7) - Digital hall signals

NOTE

l The operation and configuration of Hall effect sensors is reserved for special applications. Consult with Moog if needed.

# 6.5.4 Sin/Cos / TTL X7

# 6.5.4.1 TTL encoder

Ch1: TTL(3) - TTL signals

TTL encoders are ...

- a. ... ... usually pure incremental encoders without an absolute value interface.
- b. In this case, P 540[0] - ENC_CH1_Abs must be set to OFF(0). ... ... in a few exceptional cases, incremental encoders with an SSI absolute value interface. In this case, P 540[0] - ENC_CH1_Abs must be accordingly set to SSI(1) (SSI_CONT(4) in special cases), so that it will be possible to read the absolute encoder position for the absolute value initialization routine once during the initialization phase.

# 6.5.4.1.1 Pure TTL incremental encoder

Set P 505[0] - ENC_CH1_Sel to TTL(3) and P 540[0] - ENC_CH1_Abs to OFF(0) when using pure TTL encoders, i.e. encoders without an absolute value interface but with a TTL zero pulse.

Linear TTL encoders are run as rotary encoders. For linear motor operation, P 542 [0] - ENC_CH1_Lines and the encoder gearing (see the “Encoder gearing” section) are used to establish the ratio for the linear motor’s pole pair subdivision (North-North) for commutation. 1 x North-North corresponds to one revolution from Lines. In this case, the motor pole pair number must be set to 1. Moreover, P 553[0] - ENC_CH1_PeriodLen is not used in this case.

The TTL interface accepts various TTL signal types, which can be selected using P 558[0] - ENC_CH1_TTL_SignalType:

- (0)AF_B - A/B tracks (forward counting, X4 encoding) - AB
- (1)AR_B - A/B tracks (reverse counting, X4 encoding) - AB_inv
- (2)ABDFN - A: Clock (falling edge), B: Direction (1 = positive) - PulseDir
- (3)ABDRP - A: Clock (rising edge), B: Direction (1 = negative) - PulseDir_inv
- (4)reserved

A maximum interpolation period, in ms (milliseconds), can be configured for the TTL interface using P 601[0] - ENC_CH1_Period. Within this context, Period is the maximum time of “no activity” since the last TTL counter event:

- Period = 0: Function disabled (default)
- Period > 0 (=n ms): If no counter event is registered in n ms, the speed will be set to 0.

# Zero pulse

There is no parameter for activating the zero pulse evaluation here, as this evaluation is controlled exclusively based on the homing mode (see Section ""Homing"" on page 249). However, setting P 541[0] - ENC_CH1_NpTest to 1 provides a test mode that can be used during commissioning in order to be able to activate the zero pulse evaluation even without homing. Scope signals 1014 and 1016 can be used to view a received zero pulse within this context. This test mode must be disabled during normal operation (P 541[0] = 0).

# Commutation

Motor operation with pure incremental encoders needs for the auto commutation function to be enabled without fail. For details see Section ""Synchronous motor auto commutation"" on page 156.

# 6.5.4.1.2 TTL incremental encoder with SSI absolute value interface

See Section ""Sin/Cos incremental encoders with absolute value interface"" on page 65 and in special Section ""SSI absolute value interface"" on page 67.

MSD ServoDrive - DeviceHelp

# 6 Encoder

MOOG ID No.:CB40859-001 Date:11/2020 MSD ServoDrive - DeviceHelp 64

|ID|Index Name|Unit|Description|
|---|---|---|---|
|505|0|ENC_CH1_Sel = 3|Encoder selection set to TTL(3)|
|510|0|ENC_CH1_Num|Encoder gearing: Numerator Ch1: SINCOS(1) - Sin/Cos signals|
|511|0|ENC_CH1_Denom|Encoder gearing: Denominator|
|540|0|ENC_CH1_Abs|Selection of absolute value interface Sin/Cos encoders can ...|
|541|0|ENC_CH1_NpTest|ENC CH1, TEST-MODE: Index pulse signal(s) to Scope|
|542|0|ENC_CH1_lines|Number of lines (Sin/Cos / TTL encoders) a. Be pure incremental encoders without an absolute value interface. In this|
|558|0|ENC_CH1_TTL_SignalType|Channel 1: TTL signal selection case, P 540[0] - ENC_CH1_Abs must be set to OFF(0).|
|601|0|ENC_CH1_Period|Maximum period of interpolation (TTL encoder)|
|616|0|ENC_CH1_CycleCount|Sampling cycle in: n x 125 μ (microseconds) b. Be incremental encoders with an absolute value interface. In this case,|

Table 6.8: Parameters for Channel 1 (X7) - TTL encoder

ENC_CH1_Abs must be accordingly set to SSI(1), EnDat(2), HIPER(3) or, in special cases, SSI_CONT(4) so that it will be possible to read the absolute encoder position for the absolute value initialization routine once during the initialization phase.

# 6.5.4.2.1 Purely Sin/Cos incremental encoders

To run these encoders as purely incremental encoders with a zero pulse on encoder channel Ch1 (without an absolute value interface), the approach is basically the same as for purely TTL operation (see Section ""TTL encoder"" on page 63). The same parameters apply.

However, there are the following differences:

- a. There are no different signal types for the Sin/Cos signal (always 1 Vss for cosine and sine).
- b. The zero pulse is the analog zero pulse typical of Sin/Cos encoders (see the “Connection for high-resolution encoders” section in the operation manual MSD Servo Drive Single-Axis System, for example).

# 6.5.4.2.2 Linear Sin/Cos

|ID|Index Name|Unit|Description|
|---|---|---|---|
|542|ENC_CH1_lines| |Number of Lines (Sin/Cos / TTL encoders)|
|543|ENC_CH1_MultiT| |Number of MultiTurn bits (absolute encoder)|
|544|ENC_CH1_SingleT| |Number of SingleTurn bits (absolute encoder)|
|545|ENC_CH1_Code| |Code selection (SSI encoder) (binary, gray)|
|546|ENC_CH1_Mode| |Mode selection (SSI encoder)|
|547|ENC_CH1_MTBase| |Definition of point of discontinuity in multi-turn range|
|548|ENC_CH1_MTEnable| |Enable MultiTurn use (negative logic, 1=MToff)|
|549|ENC_CH1_Corr| |Signal correction type|
|550|ENC_CH1_CorrVal|0-4|Signal correction values|
|551|ENC_CH1_EncObsMin| |Encoder monitoring minimum, sqrt(a^2+b^2)|
|552|ENC_CH1_AbsEncStatus| |Error and status codes (absolute encoder)|

# 6.5.4.2.3 Signal correction (GPOC)

|ID|Index Name|Unit|Description|
|---|---|---|---|
|553|ENC_CH1_PeriodLen|nm|Length of signal period (Sin/Cos linear encoder)|
|554|ENC_CH1_DigitalResolution|nm|Length of one increment (linear absolute encoder)|
|555|ENC_CH1_Info| |Encoder information|
|616|ENC_CH1_CycleCount| |Sampling cycle in: n x 125 μ (microseconds)|
|610|ENC_CH1_NominalIncrementA| |Sign. Nominal increment A (distance coded abs. per. encoder)|
|611|ENC_CH1_NominalIncrementB| |Sign. Nominal increment B (distance coded abs. per. encoder)|
|1900|ENC_ETS| |ETS mode, electronic nameplate|

# 6.5.4.2.4 Sin/Cos incremental encoders with absolute value interface

The following table lists the parameters for cyclical Sin/Cos operation on encoder channel Ch 1 with one-time reading of the absolute encoder position via the absolute value interface, i.e. without a zero pulse:

|ID|Index Name|Unit|Description|
|---|---|---|---|
|505|ENC_CH1_Sel|1|Encoder selection set to SINCOS(1)|
|510|ENC_CH1_Num| |Encoder gearing: Numerator|
|511|ENC_CH1_Denom| |Encoder gearing: Denominator|
|540|ENC_CH1_Abs| |Absolute value interface selection (one-time reading)|

Table 6.9: Parameters for channel 1 (X7) - Sin/Cos encoder

The Sel, Num, Denom, Abs, Lines, MultiT, SingleT and CorrVal parameters are self-explanatory.

The Code and Mode parameters are described in Section ""SSI (cyclical) X7"" on page 69.

P 547[0] - ENC_CH1_MTBase = Minimum MultiTurn position

The MTBase parameter is used to set a position in the multi-turn encoder’s travel path that defines the point of discontinuity (overflow/underflow) for the absolute value initialization (that is, the “multi-turn basis”). Assuming a bipolar encoder measuring range, all position values that fall below MTBase will be shifted “up” (the whole MT range will be added to them once).

MOOG ID No.:CB40859-001 Date:11/2020

MSD ServoDrive - DeviceHelp

# 6 Encoder

MOOG ID No.:CB40859-001 Date:11/2020

method makes it possible to place the point of discontinuity at any point within the encoder’s entire measuring range. By default, MTBase will be set to the lowest possible value for the parameter, i.e. reliably outside of the encoder’s value range: In this case, the full bipolar range will remain unaffected, as values will never fall below this MTBase threshold (see Section ""Channel 1: Interface X7"" on page 59).

- P 548[0] - ENC_CH1_MTEnable = MultiTurn as SingleTurn
- The MTEnable parameter makes it possible to use multi-turn encoders as single-turn encoders for test purposes. Negative logic: Default MTEnable = 0 means ""MultiTurn-Enable ON"".

P 549[0] - ENC_CH1_Corr = Signal correction type
- The GPOC routine used for track signal correction purposes for sine/cosine signals is used to compensate for systematic errors. The routine is controlled with the Corr and CorrVal parameters (see Section ""Signal correction GPOC (Gain Phase Offset Correction)"" on page 74).

P 551[0] - ENC_CH1_EncObsMin = Encoder monitoring minimum, sqrt (a^2+b^2)
- The parameter EncObsMin is used to scale the Sin/Cos wire break monitoring and represents the “downwards threshold” for an error message. The default setting is 0.2, corresponding to approx. ",What role does the P 541[0] - ENC_CH1_NpTest parameter play in TTL encoder setups?,A3,"It provides a temporary mode for testing zero pulse reception, crucial for initial setup but not for regular use.",2.328125,2.390625,3.703125,1.5,0.609375
48,msd_servo_drive.txt,20,02f242a213dfa4411d028ce46dfba16a3f97395fa25788fcbaea1715e779d934,"), consult with your project supervisor or the Helpline provided by Moog before using any special SSI protocol modes.

# 6.5.2 EnDat (cyclical) X7

Ch1: ENDAT(4) - Cyclical EnDat (2.1 or 2.2) EnDat is a digital encoder interface developed by HEIDENHAIN. For more details, please visit www.heidenhain.de and go to ►Documentation ►Fundamentals ►Interfaces ►EnDat 2.2.

The software versions required to run the EnDat encoder interface are the standard software versions for the MSD Servo Drive and MSD Single-Axis Servo Drive Compact.

MOOG ID No.:CB40859-001 Date:11/2020

# 6 Encoder

NOTE

- Please note the limitations that apply when running EnDat and SSI encoders (see Section ""Limiting for EnDat and SSI"" on page 52).

When using linear encoders, P 554[0] - ENC_CH1_DigitalResolution is used instead of P 543[0] - ENC_CH1_MultiT and P 544[0] - ENC_CH1_SingleT (which are used for rotary encoders). The values will be read from the EnDat encoder and written to the aforementioned parameters.

- P 543[0] - ENC_CH1_MultiT
- The number ""n"" of multiturn bits defines the measuring range in 2n increments per encoder shaft revolution; maximum travel until overflow; maximum travel within which the absolute value initialization can be unambiguous. In the case of single-turn encoders, MultiT = 0.
- P 544[0] - ENC_CH1_SingleT
- The number ""n"" of single-turn bits corresponds to the encoder’s digital resolution in 2n increments per encoder shaft revolution.
- P 554[0] - ENC_CH1_DigitalResolution
- This is the length of an increment, in nanometres, of the encoder’s digitally transmitted position value. This value is read from the EnDat linear head.

In the case of linear encoders, the number n of transmitted position bits from the encoder will be found in SingleT only! 2n * DigitalResolution yields the maximum travel in nanometres (for the encoder head).

P 640 - ENC_ENDAT is intended for additional information, but is normally not needed. This parameter does not have a Ch1 or Ch3 prefix for the encoder channel in the name, as it applies to both encoder channels. Although usually not needed, the parameter is helpful or required in the following cases:

1. Special EnDat encoder with diagnostics for evaluation
In this case, the valuation numbers from the encoder are read cyclically via additional information. Only the valuation numbers that the encoder supports.

# 6 Encoder

MOOG ID No.:CB40859-001 Date:11/2020

will be read. During the initialization process, the system will read the encoder to determine which valuation numbers it supports. When P 640[0] - ENDAT_Select = 1, the function will be enabled in the controller and the internal diagnostics in the EnDaT encoder will be enabled as well. The EnDat encoder will keep this setting even after being powered off. To explicitly disable the internal diagnostics in the EnDat encoder, set P 640[0] - ENDAT_Select to 2.

# 2. Evaluation of internal warnings

In this scenario, certain internal warnings from the encoder will be read from the encoder via additional information. Only the warnings that both the encoder and the Servo Drive’s software support will be read. During the initialization process, the system will read the encoder to determine which warnings it supports. When P 640[0] - ENDAT_Select = 3, the function will be enabled in the controller.

**Table 6.7: Channel 1 encoder configuration (X7) - EnDat parameters**
|ID|Index Name|Unit|Description|
|---|---|---|---|
|505|0 ENC_CH1_Sel|= ENDAT(4)| |
|543|0 ENC_CH1_MultiT|Number of MultiTurn bits (absolute encoder)| |
|544|0 ENC_CH1_SingleT|Number of SingleTurn bits (absolute encoder)| |
|547|0 ENC_CH1_MTBase|Definition of point of discontinuity in multi-turn range| |
|548|0 ENC_CH1_MTEnable|1: Use Multi-turn encoder as a single-turn encoder| |
|616|0 ENC_CH1_CycleCount|Position encoder sampling cycle (n x 125 μsec)| |
|598|0 ENC_CH1_Position|inc|Position encoder channel 1|
|554|0 ENC_CH1_|nm|Length of one increment (linear absolute encoder)|
|640|ENC_ENDAT| |EnDat additional (additional information)|
|640|0 ENDAT_Select|0=off|EnDat function selection, 1/2=diagnosis on/off, 3=warnings, FF=lock|
|640|1 ENDAT_DiagCount|u16|count new diagnosis block header|
|640|2 ENDAT_BWZ_1|lowbyte|vn1: incremental track|
|640|3 ENDAT_BWZ_3|lowbyte|vn3: absolute track|
|640|4 ENDAT_BWZ_4|lowbyte|vn4: position value formation|
|640|5 ENDAT_Status| |EnDat additional status output|
|640|6 ENDAT_Z1_Sel| |EnDat additional information 1 type selection|

**Table 6.7: Overwrite Channel 1 encoder configuration (X7) - EnDat parameters (continue)**
|ID|Index Name|Unit|Description|
|---|---|---|---|
|640|7 ENDAT_Z1_1| |Z1 info: dword 1|
|640|8 ENDAT_Z1_2| |Z1 info: dword 2|
|640|9 ENDAT_Z1_3| |Z1 info: dword 3|
|640|10 ENDAT_Z1_4| |Z1 info: dword 4|
|640|11 ENDAT_Z2_Sel| |EnDat additional information 2 type selection|
|640|12 ENDAT_Z2_1| |Z2 info: dword 1|
|640|13 ENDAT_Z2_2| |Z2 info: dword 2|
|640|14 ENDAT_Z2_3| |Z2 info: dword 3|
|640|15 ENDAT_Z2_4| |Z2 info: dword 4|
|640|16 ENDAT_Mode1|0=off|EnDat additional mode 1 selection|
|640|17 ENDAT_Mode2| |EnDat additional mode 2 selection|
|640|18 ENDAT_Mode3| |EnDat additional mode 3 selection|
|640|19 ENDAT_Mode4| |EnDat additional mode 4 selection|
|640|20 ENDAT_res1| |reserved 1|
|640|21 ENDAT_res2| |reserved 2|
|640|22 ENDAT_res3| |reserved 3|
|640|23 ENDAT_HwSyncStop|0=SyncOn|EnDat cyclic hw sync, stop/start 1/0|
|640|24 ENDAT_CyclCount| |call counter of cyclic function|
|640|25 ENDAT_BWZ_Supported| |vn supported (bit3=vn4, bit2=vn3, bit0=vn1)|
|640|26 ENDAT_BWZ1_| |vn1: bits[7..0] threshold level, bits[31..16]|
|640|27 ThresholdLevel| |how often number|
|640|28 ENDAT_BWZ3_| |vn3: bits[7..0] threshold level, bits[31..16]|
|640|29 ThresholdLevel| |how often number|
|640|30 ENDAT_BWZ4_| |vn4: bits[7..0] threshold level, bits[31..16]|
|640|31 ThresholdLevel| |how often number|
|640|32 ENDAT_BWZ_TEST_| |vn: bits[15..12] 'F', bits[11..8] vn.no., bits [7..0] vn overwrite value|

# 6.5.3 Hall sensor X7

Ch1: HALL(5) - Digital hall signals

Ch1: HALL_TTL(7) - Digital hall signals

NOTE

l The operation and configuration of Hall effect sensors is reserved for special applications. Consult with Moog if needed.

# 6.5.4 Sin/Cos / TTL X7

# 6.5.4.1 TTL encoder

Ch1: TTL(3) - TTL signals

TTL encoders are ...

- a. ... ... usually pure incremental encoders without an absolute value interface.
- b. In this case, P 540[0] - ENC_CH1_Abs must be set to OFF(0). ... ... in a few exceptional cases, incremental encoders with an SSI absolute value interface. In this case, P 540[0] - ENC_CH1_Abs must be accordingly set to SSI(1) (SSI_CONT(4) in special cases), so that it will be possible to read the absolute encoder position for the absolute value initialization routine once during the initialization phase.

# 6.5.4.1.1 Pure TTL incremental encoder

Set P 505[0] - ENC_CH1_Sel to TTL(3) and P 540[0] - ENC_CH1_Abs to OFF(0) when using pure TTL encoders, i.e. encoders without an absolute value interface but with a TTL zero pulse.

Linear TTL encoders are run as rotary encoders. For linear motor operation, P 542 [0] - ENC_CH1_Lines and the encoder gearing (see the “Encoder gearing” section) are used to establish the ratio for the linear motor’s pole pair subdivision (North-North) for commutation. 1 x North-North corresponds to one revolution from Lines. In this case, the motor pole pair number must be set to 1. Moreover, P 553[0] - ENC_CH1_PeriodLen is not used in this case.

The TTL interface accepts various TTL signal types, which can be selected using P 558[0] - ENC_CH1_TTL_SignalType:

- (0)AF_B - A/B tracks (forward counting, X4 encoding) - AB
- (1)AR_B - A/B tracks (reverse counting, X4 encoding) - AB_inv
- (2)ABDFN - A: Clock (falling edge), B: Direction (1 = positive) - PulseDir
- (3)ABDRP - A: Clock (rising edge), B: Direction (1 = negative) - PulseDir_inv
- (4)reserved

A maximum interpolation period, in ms (milliseconds), can be configured for the TTL interface using P 601[0] - ENC_CH1_Period. Within this context, Period is the maximum time of “no activity” since the last TTL counter event:

- Period = 0: Function disabled (default)
- Period > 0 (=n ms): If no counter event is registered in n ms, the speed will be set to 0.

# Zero pulse

There is no parameter for activating the zero pulse evaluation here, as this evaluation is controlled exclusively based on the homing mode (see Section ""Homing"" on page 249). However, setting P 541[0] - ENC_CH1_NpTest to 1 provides a test mode that can be used during commissioning in order to be able to activate the zero pulse evaluation even without homing. Scope signals 1014 and 1016 can be used to view a received zero pulse within this context. This test mode must be disabled during normal operation (P 541[0] = 0).

# Commutation

Motor operation with pure incremental encoders needs for the auto commutation function to be enabled without fail. For details see Section ""Synchronous motor auto commutation"" on page 156.

# 6.5.4.1.2 TTL incremental encoder with SSI absolute value interface

See Section ""Sin/Cos incremental encoders with absolute value interface"" on page 65 and in special Section ""SSI absolute value interface"" on page 67.

MSD ServoDrive - DeviceHelp

# 6 Encoder

MOOG ID No.:CB40859-001 Date:11/2020 MSD ServoDrive - DeviceHelp 64

|ID|Index Name|Unit|Description|
|---|---|---|---|
|505|0|ENC_CH1_Sel = 3|Encoder selection set to TTL(3)|
|510|0|ENC_CH1_Num|Encoder gearing: Numerator Ch1: SINCOS(1) - Sin/Cos signals|
|511|0|ENC_CH1_Denom|Encoder gearing: Denominator|
|540|0|ENC_CH1_Abs|Selection of absolute value interface Sin/Cos encoders can ...|
|541|0|ENC_CH1_NpTest|ENC CH1, TEST-MODE: Index pulse signal(s) to Scope|
|542|0|ENC_CH1_lines|Number of lines (Sin/Cos / TTL encoders) a. Be pure incremental encoders without an absolute value interface. In this|
|558|0|ENC_CH1_TTL_SignalType|Channel 1: TTL signal selection case, P 540[0] - ENC_CH1_Abs must be set to OFF(0).|
|601|0|ENC_CH1_Period|Maximum period of interpolation (TTL encoder)|
|616|0|ENC_CH1_CycleCount|Sampling cycle in: n x 125 μ (microseconds) b. Be incremental encoders with an absolute value interface. In this case,|

Table 6.8: Parameters for Channel 1 (X7) - TTL encoder

ENC_CH1_Abs must be accordingly set to SSI(1), EnDat(2), HIPER(3) or, in special cases, SSI_CONT(4) so that it will be possible to read the absolute encoder position for the absolute value initialization routine once during the initialization phase.

# 6.5.4.2.1 Purely Sin/Cos incremental encoders

To run these encoders as purely incremental encoders with a zero pulse on encoder channel Ch1 (without an absolute value interface), the approach is basically the same as for purely TTL operation (see Section ""TTL encoder"" on page 63). The same parameters apply.

However, there are the following differences:

- a. There are no different signal types for the Sin/Cos signal (always 1 Vss for cosine and sine).
- b. The zero pulse is the analog zero pulse typical of Sin/Cos encoders (see the “Connection for high-resolution encoders” section in the operation manual MSD Servo Drive Single-Axis System, for example).

# 6.5.4.2.2 Linear Sin/Cos

|ID|Index Name|Unit|Description|
|---|---|---|---|
|542|ENC_CH1_lines| |Number of Lines (Sin/Cos / TTL encoders)|
|543|ENC_CH1_MultiT| |Number of MultiTurn bits (absolute encoder)|
|544|ENC_CH1_SingleT| |Number of SingleTurn bits (absolute encoder)|
|545|ENC_CH1_Code| |Code selection (SSI encoder) (binary, gray)|
|546|ENC_CH1_Mode| |Mode selection (SSI encoder)|
|547|ENC_CH1_MTBase| |Definition of point of discontinuity in multi-turn range|
|548|ENC_CH1_MTEnable| |Enable MultiTurn use (negative logic, 1=MToff)|
|549|ENC_CH1_Corr| |Signal correction type|
|550|ENC_CH1_CorrVal|0-4|Signal correction values|
|551|ENC_CH1_EncObsMin| |Encoder monitoring minimum, sqrt(a^2+b^2)|
|552|ENC_CH1_AbsEncStatus| |Error and status codes (absolute encoder)|

# 6.5.4.2.3 Signal correction (GPOC)

|ID|Index Name|Unit|Description|
|---|---|---|---|
|553|ENC_CH1_PeriodLen|nm|Length of signal period (Sin/Cos linear encoder)|
|554|ENC_CH1_DigitalResolution|nm|Length of one increment (linear absolute encoder)|
|555|ENC_CH1_Info| |Encoder information|
|616|ENC_CH1_CycleCount| |Sampling cycle in: n x 125 μ (microseconds)|
|610|ENC_CH1_NominalIncrementA| |Sign. Nominal increment A (distance coded abs. per. encoder)|
|611|ENC_CH1_NominalIncrementB| |Sign. Nominal increment B (distance coded abs. per. encoder)|
|1900|ENC_ETS| |ETS mode, electronic nameplate|

# 6.5.4.2.4 Sin/Cos incremental encoders with absolute value interface

The following table lists the parameters for cyclical Sin/Cos operation on encoder channel Ch 1 with one-time reading of the absolute encoder position via the absolute value interface, i.e. without a zero pulse:

|ID|Index Name|Unit|Description|
|---|---|---|---|
|505|ENC_CH1_Sel|1|Encoder selection set to SINCOS(1)|
|510|ENC_CH1_Num| |Encoder gearing: Numerator|
|511|ENC_CH1_Denom| |Encoder gearing: Denominator|
|540|ENC_CH1_Abs| |Absolute value interface selection (one-time reading)|

Table 6.9: Parameters for channel 1 (X7) - Sin/Cos encoder

The Sel, Num, Denom, Abs, Lines, MultiT, SingleT and CorrVal parameters are self-explanatory.

The Code and Mode parameters are described in Section ""SSI (cyclical) X7"" on page 69.

P 547[0] - ENC_CH1_MTBase = Minimum MultiTurn position

The MTBase parameter is used to set a position in the multi-turn encoder’s travel path that defines the point of discontinuity (overflow/underflow) for the absolute value initialization (that is, the “multi-turn basis”). Assuming a bipolar encoder measuring range, all position values that fall below MTBase will be shifted “up” (the whole MT range will be added to them once).

MOOG ID No.:CB40859-001 Date:11/2020

MSD ServoDrive - DeviceHelp

# 6 Encoder

MOOG ID No.:CB40859-001 Date:11/2020

method makes it possible to place the point of discontinuity at any point within the encoder’s entire measuring range. By default, MTBase will be set to the lowest possible value for the parameter, i.e. reliably outside of the encoder’s value range: In this case, the full bipolar range will remain unaffected, as values will never fall below this MTBase threshold (see Section ""Channel 1: Interface X7"" on page 59).

- P 548[0] - ENC_CH1_MTEnable = MultiTurn as SingleTurn
- The MTEnable parameter makes it possible to use multi-turn encoders as single-turn encoders for test purposes. Negative logic: Default MTEnable = 0 means ""MultiTurn-Enable ON"".

P 549[0] - ENC_CH1_Corr = Signal correction type
- The GPOC routine used for track signal correction purposes for sine/cosine signals is used to compensate for systematic errors. The routine is controlled with the Corr and CorrVal parameters (see Section ""Signal correction GPOC (Gain Phase Offset Correction)"" on page 74).

P 551[0] - ENC_CH1_EncObsMin = Encoder monitoring minimum, sqrt (a^2+b^2)
- The parameter EncObsMin is used to scale the Sin/Cos wire break monitoring and represents the “downwards threshold” for an error message. The default setting is 0.2, corresponding to approx. ",What role does the P 541[0] - ENC_CH1_NpTest parameter play in TTL encoder setups?,A4,"During setup, P 541[0] facilitates zero pulse testing via scope signals, ensuring correct encoder configuration before operation.",2.15625,2.078125,3.484375,1.6796875,0.65234375
49,msd_servo_drive.txt,20,02f242a213dfa4411d028ce46dfba16a3f97395fa25788fcbaea1715e779d934,"), consult with your project supervisor or the Helpline provided by Moog before using any special SSI protocol modes.

# 6.5.2 EnDat (cyclical) X7

Ch1: ENDAT(4) - Cyclical EnDat (2.1 or 2.2) EnDat is a digital encoder interface developed by HEIDENHAIN. For more details, please visit www.heidenhain.de and go to ►Documentation ►Fundamentals ►Interfaces ►EnDat 2.2.

The software versions required to run the EnDat encoder interface are the standard software versions for the MSD Servo Drive and MSD Single-Axis Servo Drive Compact.

MOOG ID No.:CB40859-001 Date:11/2020

# 6 Encoder

NOTE

- Please note the limitations that apply when running EnDat and SSI encoders (see Section ""Limiting for EnDat and SSI"" on page 52).

When using linear encoders, P 554[0] - ENC_CH1_DigitalResolution is used instead of P 543[0] - ENC_CH1_MultiT and P 544[0] - ENC_CH1_SingleT (which are used for rotary encoders). The values will be read from the EnDat encoder and written to the aforementioned parameters.

- P 543[0] - ENC_CH1_MultiT
- The number ""n"" of multiturn bits defines the measuring range in 2n increments per encoder shaft revolution; maximum travel until overflow; maximum travel within which the absolute value initialization can be unambiguous. In the case of single-turn encoders, MultiT = 0.
- P 544[0] - ENC_CH1_SingleT
- The number ""n"" of single-turn bits corresponds to the encoder’s digital resolution in 2n increments per encoder shaft revolution.
- P 554[0] - ENC_CH1_DigitalResolution
- This is the length of an increment, in nanometres, of the encoder’s digitally transmitted position value. This value is read from the EnDat linear head.

In the case of linear encoders, the number n of transmitted position bits from the encoder will be found in SingleT only! 2n * DigitalResolution yields the maximum travel in nanometres (for the encoder head).

P 640 - ENC_ENDAT is intended for additional information, but is normally not needed. This parameter does not have a Ch1 or Ch3 prefix for the encoder channel in the name, as it applies to both encoder channels. Although usually not needed, the parameter is helpful or required in the following cases:

1. Special EnDat encoder with diagnostics for evaluation
In this case, the valuation numbers from the encoder are read cyclically via additional information. Only the valuation numbers that the encoder supports.

# 6 Encoder

MOOG ID No.:CB40859-001 Date:11/2020

will be read. During the initialization process, the system will read the encoder to determine which valuation numbers it supports. When P 640[0] - ENDAT_Select = 1, the function will be enabled in the controller and the internal diagnostics in the EnDaT encoder will be enabled as well. The EnDat encoder will keep this setting even after being powered off. To explicitly disable the internal diagnostics in the EnDat encoder, set P 640[0] - ENDAT_Select to 2.

# 2. Evaluation of internal warnings

In this scenario, certain internal warnings from the encoder will be read from the encoder via additional information. Only the warnings that both the encoder and the Servo Drive’s software support will be read. During the initialization process, the system will read the encoder to determine which warnings it supports. When P 640[0] - ENDAT_Select = 3, the function will be enabled in the controller.

**Table 6.7: Channel 1 encoder configuration (X7) - EnDat parameters**
|ID|Index Name|Unit|Description|
|---|---|---|---|
|505|0 ENC_CH1_Sel|= ENDAT(4)| |
|543|0 ENC_CH1_MultiT|Number of MultiTurn bits (absolute encoder)| |
|544|0 ENC_CH1_SingleT|Number of SingleTurn bits (absolute encoder)| |
|547|0 ENC_CH1_MTBase|Definition of point of discontinuity in multi-turn range| |
|548|0 ENC_CH1_MTEnable|1: Use Multi-turn encoder as a single-turn encoder| |
|616|0 ENC_CH1_CycleCount|Position encoder sampling cycle (n x 125 μsec)| |
|598|0 ENC_CH1_Position|inc|Position encoder channel 1|
|554|0 ENC_CH1_|nm|Length of one increment (linear absolute encoder)|
|640|ENC_ENDAT| |EnDat additional (additional information)|
|640|0 ENDAT_Select|0=off|EnDat function selection, 1/2=diagnosis on/off, 3=warnings, FF=lock|
|640|1 ENDAT_DiagCount|u16|count new diagnosis block header|
|640|2 ENDAT_BWZ_1|lowbyte|vn1: incremental track|
|640|3 ENDAT_BWZ_3|lowbyte|vn3: absolute track|
|640|4 ENDAT_BWZ_4|lowbyte|vn4: position value formation|
|640|5 ENDAT_Status| |EnDat additional status output|
|640|6 ENDAT_Z1_Sel| |EnDat additional information 1 type selection|

**Table 6.7: Overwrite Channel 1 encoder configuration (X7) - EnDat parameters (continue)**
|ID|Index Name|Unit|Description|
|---|---|---|---|
|640|7 ENDAT_Z1_1| |Z1 info: dword 1|
|640|8 ENDAT_Z1_2| |Z1 info: dword 2|
|640|9 ENDAT_Z1_3| |Z1 info: dword 3|
|640|10 ENDAT_Z1_4| |Z1 info: dword 4|
|640|11 ENDAT_Z2_Sel| |EnDat additional information 2 type selection|
|640|12 ENDAT_Z2_1| |Z2 info: dword 1|
|640|13 ENDAT_Z2_2| |Z2 info: dword 2|
|640|14 ENDAT_Z2_3| |Z2 info: dword 3|
|640|15 ENDAT_Z2_4| |Z2 info: dword 4|
|640|16 ENDAT_Mode1|0=off|EnDat additional mode 1 selection|
|640|17 ENDAT_Mode2| |EnDat additional mode 2 selection|
|640|18 ENDAT_Mode3| |EnDat additional mode 3 selection|
|640|19 ENDAT_Mode4| |EnDat additional mode 4 selection|
|640|20 ENDAT_res1| |reserved 1|
|640|21 ENDAT_res2| |reserved 2|
|640|22 ENDAT_res3| |reserved 3|
|640|23 ENDAT_HwSyncStop|0=SyncOn|EnDat cyclic hw sync, stop/start 1/0|
|640|24 ENDAT_CyclCount| |call counter of cyclic function|
|640|25 ENDAT_BWZ_Supported| |vn supported (bit3=vn4, bit2=vn3, bit0=vn1)|
|640|26 ENDAT_BWZ1_| |vn1: bits[7..0] threshold level, bits[31..16]|
|640|27 ThresholdLevel| |how often number|
|640|28 ENDAT_BWZ3_| |vn3: bits[7..0] threshold level, bits[31..16]|
|640|29 ThresholdLevel| |how often number|
|640|30 ENDAT_BWZ4_| |vn4: bits[7..0] threshold level, bits[31..16]|
|640|31 ThresholdLevel| |how often number|
|640|32 ENDAT_BWZ_TEST_| |vn: bits[15..12] 'F', bits[11..8] vn.no., bits [7..0] vn overwrite value|

# 6.5.3 Hall sensor X7

Ch1: HALL(5) - Digital hall signals

Ch1: HALL_TTL(7) - Digital hall signals

NOTE

l The operation and configuration of Hall effect sensors is reserved for special applications. Consult with Moog if needed.

# 6.5.4 Sin/Cos / TTL X7

# 6.5.4.1 TTL encoder

Ch1: TTL(3) - TTL signals

TTL encoders are ...

- a. ... ... usually pure incremental encoders without an absolute value interface.
- b. In this case, P 540[0] - ENC_CH1_Abs must be set to OFF(0). ... ... in a few exceptional cases, incremental encoders with an SSI absolute value interface. In this case, P 540[0] - ENC_CH1_Abs must be accordingly set to SSI(1) (SSI_CONT(4) in special cases), so that it will be possible to read the absolute encoder position for the absolute value initialization routine once during the initialization phase.

# 6.5.4.1.1 Pure TTL incremental encoder

Set P 505[0] - ENC_CH1_Sel to TTL(3) and P 540[0] - ENC_CH1_Abs to OFF(0) when using pure TTL encoders, i.e. encoders without an absolute value interface but with a TTL zero pulse.

Linear TTL encoders are run as rotary encoders. For linear motor operation, P 542 [0] - ENC_CH1_Lines and the encoder gearing (see the “Encoder gearing” section) are used to establish the ratio for the linear motor’s pole pair subdivision (North-North) for commutation. 1 x North-North corresponds to one revolution from Lines. In this case, the motor pole pair number must be set to 1. Moreover, P 553[0] - ENC_CH1_PeriodLen is not used in this case.

The TTL interface accepts various TTL signal types, which can be selected using P 558[0] - ENC_CH1_TTL_SignalType:

- (0)AF_B - A/B tracks (forward counting, X4 encoding) - AB
- (1)AR_B - A/B tracks (reverse counting, X4 encoding) - AB_inv
- (2)ABDFN - A: Clock (falling edge), B: Direction (1 = positive) - PulseDir
- (3)ABDRP - A: Clock (rising edge), B: Direction (1 = negative) - PulseDir_inv
- (4)reserved

A maximum interpolation period, in ms (milliseconds), can be configured for the TTL interface using P 601[0] - ENC_CH1_Period. Within this context, Period is the maximum time of “no activity” since the last TTL counter event:

- Period = 0: Function disabled (default)
- Period > 0 (=n ms): If no counter event is registered in n ms, the speed will be set to 0.

# Zero pulse

There is no parameter for activating the zero pulse evaluation here, as this evaluation is controlled exclusively based on the homing mode (see Section ""Homing"" on page 249). However, setting P 541[0] - ENC_CH1_NpTest to 1 provides a test mode that can be used during commissioning in order to be able to activate the zero pulse evaluation even without homing. Scope signals 1014 and 1016 can be used to view a received zero pulse within this context. This test mode must be disabled during normal operation (P 541[0] = 0).

# Commutation

Motor operation with pure incremental encoders needs for the auto commutation function to be enabled without fail. For details see Section ""Synchronous motor auto commutation"" on page 156.

# 6.5.4.1.2 TTL incremental encoder with SSI absolute value interface

See Section ""Sin/Cos incremental encoders with absolute value interface"" on page 65 and in special Section ""SSI absolute value interface"" on page 67.

MSD ServoDrive - DeviceHelp

# 6 Encoder

MOOG ID No.:CB40859-001 Date:11/2020 MSD ServoDrive - DeviceHelp 64

|ID|Index Name|Unit|Description|
|---|---|---|---|
|505|0|ENC_CH1_Sel = 3|Encoder selection set to TTL(3)|
|510|0|ENC_CH1_Num|Encoder gearing: Numerator Ch1: SINCOS(1) - Sin/Cos signals|
|511|0|ENC_CH1_Denom|Encoder gearing: Denominator|
|540|0|ENC_CH1_Abs|Selection of absolute value interface Sin/Cos encoders can ...|
|541|0|ENC_CH1_NpTest|ENC CH1, TEST-MODE: Index pulse signal(s) to Scope|
|542|0|ENC_CH1_lines|Number of lines (Sin/Cos / TTL encoders) a. Be pure incremental encoders without an absolute value interface. In this|
|558|0|ENC_CH1_TTL_SignalType|Channel 1: TTL signal selection case, P 540[0] - ENC_CH1_Abs must be set to OFF(0).|
|601|0|ENC_CH1_Period|Maximum period of interpolation (TTL encoder)|
|616|0|ENC_CH1_CycleCount|Sampling cycle in: n x 125 μ (microseconds) b. Be incremental encoders with an absolute value interface. In this case,|

Table 6.8: Parameters for Channel 1 (X7) - TTL encoder

ENC_CH1_Abs must be accordingly set to SSI(1), EnDat(2), HIPER(3) or, in special cases, SSI_CONT(4) so that it will be possible to read the absolute encoder position for the absolute value initialization routine once during the initialization phase.

# 6.5.4.2.1 Purely Sin/Cos incremental encoders

To run these encoders as purely incremental encoders with a zero pulse on encoder channel Ch1 (without an absolute value interface), the approach is basically the same as for purely TTL operation (see Section ""TTL encoder"" on page 63). The same parameters apply.

However, there are the following differences:

- a. There are no different signal types for the Sin/Cos signal (always 1 Vss for cosine and sine).
- b. The zero pulse is the analog zero pulse typical of Sin/Cos encoders (see the “Connection for high-resolution encoders” section in the operation manual MSD Servo Drive Single-Axis System, for example).

# 6.5.4.2.2 Linear Sin/Cos

|ID|Index Name|Unit|Description|
|---|---|---|---|
|542|ENC_CH1_lines| |Number of Lines (Sin/Cos / TTL encoders)|
|543|ENC_CH1_MultiT| |Number of MultiTurn bits (absolute encoder)|
|544|ENC_CH1_SingleT| |Number of SingleTurn bits (absolute encoder)|
|545|ENC_CH1_Code| |Code selection (SSI encoder) (binary, gray)|
|546|ENC_CH1_Mode| |Mode selection (SSI encoder)|
|547|ENC_CH1_MTBase| |Definition of point of discontinuity in multi-turn range|
|548|ENC_CH1_MTEnable| |Enable MultiTurn use (negative logic, 1=MToff)|
|549|ENC_CH1_Corr| |Signal correction type|
|550|ENC_CH1_CorrVal|0-4|Signal correction values|
|551|ENC_CH1_EncObsMin| |Encoder monitoring minimum, sqrt(a^2+b^2)|
|552|ENC_CH1_AbsEncStatus| |Error and status codes (absolute encoder)|

# 6.5.4.2.3 Signal correction (GPOC)

|ID|Index Name|Unit|Description|
|---|---|---|---|
|553|ENC_CH1_PeriodLen|nm|Length of signal period (Sin/Cos linear encoder)|
|554|ENC_CH1_DigitalResolution|nm|Length of one increment (linear absolute encoder)|
|555|ENC_CH1_Info| |Encoder information|
|616|ENC_CH1_CycleCount| |Sampling cycle in: n x 125 μ (microseconds)|
|610|ENC_CH1_NominalIncrementA| |Sign. Nominal increment A (distance coded abs. per. encoder)|
|611|ENC_CH1_NominalIncrementB| |Sign. Nominal increment B (distance coded abs. per. encoder)|
|1900|ENC_ETS| |ETS mode, electronic nameplate|

# 6.5.4.2.4 Sin/Cos incremental encoders with absolute value interface

The following table lists the parameters for cyclical Sin/Cos operation on encoder channel Ch 1 with one-time reading of the absolute encoder position via the absolute value interface, i.e. without a zero pulse:

|ID|Index Name|Unit|Description|
|---|---|---|---|
|505|ENC_CH1_Sel|1|Encoder selection set to SINCOS(1)|
|510|ENC_CH1_Num| |Encoder gearing: Numerator|
|511|ENC_CH1_Denom| |Encoder gearing: Denominator|
|540|ENC_CH1_Abs| |Absolute value interface selection (one-time reading)|

Table 6.9: Parameters for channel 1 (X7) - Sin/Cos encoder

The Sel, Num, Denom, Abs, Lines, MultiT, SingleT and CorrVal parameters are self-explanatory.

The Code and Mode parameters are described in Section ""SSI (cyclical) X7"" on page 69.

P 547[0] - ENC_CH1_MTBase = Minimum MultiTurn position

The MTBase parameter is used to set a position in the multi-turn encoder’s travel path that defines the point of discontinuity (overflow/underflow) for the absolute value initialization (that is, the “multi-turn basis”). Assuming a bipolar encoder measuring range, all position values that fall below MTBase will be shifted “up” (the whole MT range will be added to them once).

MOOG ID No.:CB40859-001 Date:11/2020

MSD ServoDrive - DeviceHelp

# 6 Encoder

MOOG ID No.:CB40859-001 Date:11/2020

method makes it possible to place the point of discontinuity at any point within the encoder’s entire measuring range. By default, MTBase will be set to the lowest possible value for the parameter, i.e. reliably outside of the encoder’s value range: In this case, the full bipolar range will remain unaffected, as values will never fall below this MTBase threshold (see Section ""Channel 1: Interface X7"" on page 59).

- P 548[0] - ENC_CH1_MTEnable = MultiTurn as SingleTurn
- The MTEnable parameter makes it possible to use multi-turn encoders as single-turn encoders for test purposes. Negative logic: Default MTEnable = 0 means ""MultiTurn-Enable ON"".

P 549[0] - ENC_CH1_Corr = Signal correction type
- The GPOC routine used for track signal correction purposes for sine/cosine signals is used to compensate for systematic errors. The routine is controlled with the Corr and CorrVal parameters (see Section ""Signal correction GPOC (Gain Phase Offset Correction)"" on page 74).

P 551[0] - ENC_CH1_EncObsMin = Encoder monitoring minimum, sqrt (a^2+b^2)
- The parameter EncObsMin is used to scale the Sin/Cos wire break monitoring and represents the “downwards threshold” for an error message. The default setting is 0.2, corresponding to approx. ",What role does the P 541[0] - ENC_CH1_NpTest parameter play in TTL encoder setups?,A5,"The parameter is essential for commissioning, offering a way to test zero pulse evaluation outside of standard homing procedures.",2.265625,2.328125,3.546875,1.578125,0.62890625
