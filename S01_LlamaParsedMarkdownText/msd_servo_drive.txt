# MOOG

# MSD Servo Drive and MSD Single-Axis Servo Drive Compact Device Help

# Servo Drive 2 A to 450 A

# Single-Axis Systems and Multi-Axis System

# MOOG

ID No.: CB40859-001 Date: 11/2020

# MSD ServoDrive - DeviceHelp

# Description of the MSD Servo Drive software functionality (Single-Axis System and Multi-Axis System) as well as MSD Single-Axis Servo Drive Compact

ID No.: CB40859-001, Rev. 4.0

Information valid as of: 11/2020

Effective as of firmware version

- V124.30-xx (MSD Single-Axis Servo Drive Compact)
- V124.30-xx (MSD Servo Drive Single-Axis System and Multi-Axis System)
- V174.30-xx (if you need to use hydraulic parameters, see Section "Hydraulic control" on page 173 for details)

The structure of this help, as well as the screenshots used, were taken from Moog DRIVEADMINISTRATOR 5 Version 5.6.

The German version is the original version of this documentation.

# Legal information

Subject to technical change without notice.

This Operation Manual has been prepared based on DIN EN 82079-1. The content was compiled with the greatest care and attention and reflects the latest information available to us.

We should nevertheless point out that this document cannot always be updated in line with ongoing technical developments in our products.

Information and specifications may be subject to change at any time. For information on the latest version please visit drives-support@moog.com.

Copyright ©

The entire contents of this documentation, especially the texts, photos and graphics it contains, are protected by copyright. The copyright is owned by Moog unless specifically marked otherwise.

MOOG ID No.:CB40859-001 Date:11/2020

MSD ServoDrive - DeviceHelp 3

# Table of contents

MOOG
ID No.:CB40859-001
Date:11/2020
MSD ServoDrive - DeviceHelp
4
# Table of contents

|Legal information|3|
|---|---|
|1 General information|9|
|1.1 Target Group|9|
|1.2 Requirements|9|
|1.3 Pictograms|10|
|1.4 Exclusion of liability|11|
|1.5 Applicable documentation|12|
|1.6 Technical Helpline|14|
|2 Safety|15|
|2.1 Overview|15|
|2.2 For your own safety|15|
|2.3 Safety information and warnings|15|
|2.4 Responsibility|16|
|3 Initial commissioning|17|
|3.1 Initial Commissioning wizard|17|
|3.1.1 Hardware requirements|17|
|3.1.2 Prompt Initial commissioning|17|
|3.1.3 Initial commissioning|18|
|3.2 Automatic test|22|
|3.3 Motor|23|
|3.4 Encoder|24|
|3.5 Control|24|
|4 Power stage|25|
|4.1 Power stage settings|25|
|4.1.1 Voltage supply|26|
|4.1.2 Switching frequency|26|
|4.1.3 Online derating of switching frequency|26|
|4.1.4 Parameters|26|
|4.2 Power failure bridging|28|
|4.2.1 Detection of a voltage failure|28|
|4.2.2 Monitoring for single-phase failure|31|
|5 Motor|32|
|5.1 Motor configuration data|32|
|5.2 Synchronous motor|33|
|5.2.1 Synchronous motor electronic data|35|
|5.3 Linear synchronous motor|36|
|5.3.1 Linear synchronous motor electronic data|37|
|5.4 Asynchronous motor|38|
|5.4.1 Asynchronous motor electrical data|39|
|5.5 Motor protection|40|
|5.5.1 Temperature sensors|40|
|5.5.2 I²t monitoring synchronous motor|43|
|5.5.3 Asynchronous motor I²t monitoring|44|
|5.6 Motor identification|45|
|5.6.1 Synchronous motor identification (rotary and linear)|46|
|5.6.2 Asynchronous motor identification|46|
|5.7 Support for motor filters when using PMSM motors|47|
|5.7.1 General functional description|47|
|5.7.2 Configuration|48|
|5.7.3 Parameters|49|
|5.7.4 Scope signals|50|
|6 Encoder|51|
|6.1 Introduction|52|
|6.1.1 Limiting for EnDat and SSI|52|
|6.1.2 Encoder gearing|52|
|6.1.3 Actual values at the encoder channel outputs|52|
|6.2 Encoder selection|53|
|6.3 Encoder offset|55|
|6.4 Connections and pin assignations|55|

# Table of contents

# 6.4 Connector for resolver (X6)

# 6.4.1 Connector for resolver (X6)

56

# 6.4.2 Connector for high-resolution encoders (X7)

56

# 6.5 Channel 1: Interface X7

# 6.5.1 Main parameters for encoder channel Ch1

60

# 6.5.2 EnDat (cyclical) X7

61

# 6.5.3 Hall sensor X7

62

# 6.5.4 Sin/Cos / TTL X7

63

# 6.5.5 SSI (cyclical) X7

69

# 6.5.6 Encoder gearing

71

# 6.6 Channel 2: Interface X6

# 6.6.1 Compensation for long resolver cables

73

# 6.6.2 Signal correction GPOC (Gain Phase Offset Correction)

74

# 6.6.3 Encoder gearing X6

75

# 6.7 Channel 3: Interface X8 (optional)

# 6.7.1 Main parameters for encoder channel Ch3

80

# 6.7.2 Absolute value interfaces X8

82

# 6.7.3 EnDat (cyclical) X8

82

# 6.7.4 Hall sensor X8

82

# 6.7.5 Sin/Cos / TTL X8

82

# 6.7.6 SSI (cyclical) X8

87

# 6.7.7 Encoder gearing

89

# 6.8 Channel 4: Virtual encoder

# 6.8.1 Sensorless control synchronous motor

91

# 6.8.2 Sensorless asynchronous motor control

97

# 6.9 Redundant encoder

# 6.9.1 Redundant encoder

100

# 6.10 Axis correction

# 6.10.1 Axis correction

100

# 6.11 Oversampling

# 6.11.1 Oversampling

104

# 6.12 Multi-turn encoder as a single-turn encoder

# 6.12.1 Multi-turn encoder as a single-turn encoder

104

# 6.13 Increment-coded reference marks

# 6.13.1 Increment-coded reference marks

105

# 6.14 Overflow in multi-turn range

# 6.14.1 Overflow in multi-turn range

106

# 6.15 Zero pulse test

# 6.15.1 Zero pulse test

107

# 7 Control

# 7.1 Overview of control structure

108

# 7.1.1 Setting

109

# 7.2 Basic settings

110

# 7.2.1 Motor control basic settings

110

# 7.2.2 Automatic inertia detection

111

# 7.3 Torque controller

# 7.3.1 Current controller optimization

113

# 7.3.2 Creating the transfer function

114

# 7.3.3 Decoupling

115

# 7.3.4 Current actual value filter

115

# 7.3.5 Detent torque compensation

115

# 7.3.6 Advanced torque control

125

# 7.3.7 Torque control with defined bandwidth

129

# 7.3.8 Enhanced feed forward control of voltage

129

# 7.4 Speed controller

# 7.4.1 Advanced speed control

133

# 7.4.2 Digital filter

136

# 7.4.3 Analysis of Speed control

137

# 7.5 Position controller settings

# 7.5.1 Pre-control

140

# 7.5.2 Friction torque compensation (friction)

141

# 7.6 Asynchronous motor field weakening

# 7.6.1 Variant 1: Default

143

# 7.6.2 Variant 2: Modified characteristic

144

# 7.6.3 Voltage controller

144

# 7.6.4 Field-weakening of asynchronous motor voltage controller

145

# 7.7 Field weakening and LookUpTable (LUT), synchronous motor

# 7.7.1 Variant 1 (Table)

148

# 7.7.2 Variant 2 (Calc)

148

# 7.7.3 Variant 4 (TableMotGen)

149

# 7.7.4 Variant 5 (TABLE2)

149

# 7.7.5 Variants 3 and 6 (LUT)

150

# 7.7.6 Field-weakening of synchronous motor voltage controller

156

# 7.8 Synchronous motor auto commutation

# 7.8.1 IENCC(1) method

158

# 7.8.2 LHMES(2) method

159

# 7.8.3 IECON(4) method

160

# 7.8.4 Test signal generator

161

# 7.9 V/Hz mode

165

# 7.10 Process controller

166

MOOG ID No.:CB40859-001 Date:11/2020

MSD ServoDrive - DeviceHelp

# Table of contents

# MOOG

ID No.: CB40859-001 Date: 11/2020

# MSD ServoDrive - DeviceHelp

# 7.10 Features

166

# 7.10.1 Description of control structure

167

# 7.10.2 Rate Limiter

171

# 7.10.3 Parameters

172

# 7.10.4 Scope signals

173

# 7.11 Hydraulic control

173

# 7.11.1 Basic setting

173

# 7.11.2 Pump setting

174

# 7.11.3 Signal setting

179

# 7.11.4 Hydraulic Limitations

184

# 7.11.5 Cylinder configuration

188

# 7.11.6 Hydraulic Motion profile

190

# 7.11.7 Pressure control

196

# 7.11.8 Volumetric flow rate control

198

# 7.11.9 Speed control

201

# 7.11.10 Position control

203

# 7.11.11 Digital filter Hydraulics

207

# 7.11.12 Example: Pressure and pump speed control

208

# 7.11.13 Example: Hydraulic position control

214

# 8 Motion profile

221

# 8.1 Settings

222

# 8.2 Scaling / Units

223

# 8.2.1 Standard/CiA 402

224

# 8.2.2 SERCOS

229

# 8.2.3 User defined

238

# 8.3 Basic settings

241

# 8.3.1 PG mode with speed control

241

# 8.3.2 PG mode with position control

242

# 8.3.3 IP mode with speed control

243

# 8.3.4 IP mode with position control

244

# 8.3.5 Jerk limitation and speed offset

244

# 8.3.6 Interpolation

246

# 8.4 Stop ramps

248

# 8.5 Homing

249

# 8.5.1 Homing screen

249

# 8.5.2 Method (-13): Absolute encoder

251

# 8.5.3 Method (-12): Set absolute position (absolute measuring system)

252

# 8.5.4 Method (-10) and Method (-11): Move to block with zero pulse

252

# 8.5.5 Method (-8) and (-9): Move to block

253

# 8.5.6 Method (-7) to (0)

254

# 8.5.7 Method (1) and Method (2): limit switch and zero pulse

255

# 8.5.8 Method (3) and (4): Positive reference mark and zero pulse

256

# 8.5.9 Homing methods 5 and 6: Negative reference mark and zero pulse

257

# 8.5.10 Method (7) to (10)

258

# 8.5.11 Method (11) to (14): Reference mark, zero pulse and negative limit switch

259

# 8.5.12 Methods (15) and (16)

261

# 8.5.13 Method (17) to (30): Reference mark

261

# 8.5.14 Methods (31) and (32)

262

# 8.5.15 Method (33) and (34): with zero pulse

263

# 8.5.16 Method (35)

263

# 8.6 Jog mode

264

# 8.6.1 Configuration

264

# 8.6.2 Digital Inputs

264

# 8.6.3 Manual mode window, "Jog mode" tab

265

# 8.7 Reference table

265

# 8.8 Analog channel (ISA00 und ISA01)

270

# 8.8.1 Special characteristics of position control mode

271

# 8.8.2 Wire Break Monitoring

271

# 8.9 State machine

273

# 8.10 Touch probe

275

# 8.11 Synchronized motion

276

# 8.11.1 Electronic cam plate

277

# 8.11.2 Control word for synchronized motion

279

# 8.11.3 Status word for synchronized motion

279

# 8.11.4 Master configuration

280

# 8.11.5 Electronic gearing

283

# 8.11.6 Engagement

284

# 8.11.7 Disengagement

285

# 8.12 Virtual Master

286

# 8.13 Common master

287

# 8.14 Cam group (CAM switch)

288

# 8.15 Data handling

288

# Table of contents

# 9 Inputs/Outputs settings

289

# 9.1 Inputs/Outputs settings

289

# 9.2 Digital inputs

290

# 9.2.1 Digital standard inputs

291

# 9.2.2 Function selectors

292

# 9.2.3 Hardware enable – power stage

293

# 9.2.4 Digital virtual inputs

294

# 9.2.5 Status of the digital inputs

294

# 9.2.6 Control selector switching

294

# 9.2.7 Power-up sequence

295

# 9.2.8 Pulse direction

296

# 9.3 Digital Outputs

298

# 9.3.1 Standard digital outputs

298

# 9.3.2 Function selectors

298

# 9.3.3 Relay outputs

300

# 9.3.4 Digital input states

300

# 9.3.5 Reference reached REF(6)

301

# 9.3.6 Reference limitation LIMIT(14)

301

# 9.3.7 Switching with motor contactor

302

# 9.4 Analog Inputs

303

# 9.4.1 Standard analog inputs

303

# 9.4.2 Function selectors

304

# 9.4.3 Analog input scaling

305

# 9.4.4 Profile mode and analog inputs

306

# 9.4.5 Wire Break Monitoring

306

# 9.5 Analog outputs (option only for MSD Servo Drive)

307

# 9.5.1 Function selectors

307

# 9.6 Motor brake output

308

# 9.6.1 Motor brake details

309

# 10 Limitations / Thresholds

310

# 10.1 Settings

310

# 10.2 Torque- / force limits

311

# 10.3 Speed- / velocity limits

312

# 10.4 Position limitation

312

# 10.5 Power stage

313

# 11 Alarms & warnings

314

# 11.1 Warning status

314

# 11.2 Alarms and warnings (Details)

316

# 11.3 Warning thresholds

323

# 11.4 Error display

324

# 11.4.1 Servo Drive display

324

# 11.4.2 Display in the Moog DriveAdministrator 5

324

# 11.5 Error reactions

325

# 11.6 Error list

328

# 11.6.1 Error 0: Unknown error

328

# 11.6.2 Error 1: Runtime error

328

# 11.6.3 Error 2: Parameter list error

330

# 11.6.4 Error 3: Undervoltage error

334

# 11.6.5 Error 4: Overvoltage error

334

# 11.6.6 Error 5: Overcurrent error

335

# 11.6.7 Error 6: Motor temperature error

339

# 11.6.8 Error 7: Device heatsink temperature error

341

# 11.6.9 Error 8: Device inside temperature error

341

# 11.6.10 Error 9: I2t motor error

342

# 11.6.11 Error 10: I2t power amplifier error

342

# 11.6.12 Error 11: External digital input error

343

# 11.6.13 Error 12: CAN error

344

# 11.6.14 Error 13: SERCOS error

347

# 11.6.15 Error 14: EtherCAT error

352

# 11.6.16 Error 15: Parameter error

354

# 11.6.17 Error 16: Speed difference error

362

# 11.6.18 Error 17: Position difference error

363

# 11.6.19 Error 18: Motion control error

363

# 11.6.20 Error 19: Fatal error

366

# 11.6.21 Error 20: Hardware limit switch error

372

# 11.6.22 Error 21: Initialization, common error

373

# 11.6.23 Error 22: Encoder channel 1, initialization error

379

# 11.6.24 Error 23: Encoder channel 2, initialization error

389

# 11.6.25 Error 24: Encoder channel 3, initialization error

390

# 11.6.26 Error 25: Encoder cyclic process, common error

397

# 11.6.27 Error 26: Encoder channel 1, cyclic process error

398

MOOG ID No.:CB40859-001 Date:11/2020

MSD ServoDrive - DeviceHelp

# Table of contents

# MOOG

ID No.: CB40859-001 Date: 11/2020

# MSD ServoDrive - DeviceHelp

|11.6.28 Error 28: Encoder channel 3, cyclic process error|399|13 Technology options (X8)|443|
|---|---|---|---|
|11.6.29 Error 30: Control initialization error|400|13.1 Selection of modules|443|
|11.6.30 Error 31: PLC error|402|13.2 Second Sin/Cos encoder|444|
|11.6.31 Error 32: PROFIBUS/PROFINET error|403|13.3 Sin/Cos encoder|444|
|11.6.32 Error 33: Internal timing error|404|13.4 TTL with encoder simulation|445|
|11.6.33 Error 34: Powerfail funkction error|406|13.5 SSI encoder simulation|445|
|11.6.34 Error 35: Encoder monitoring error|407|13.5.1 Parameters|445|
|11.6.35 Error 37: Syncronization controller error|413|13.6 TwinSync|446|
|11.6.36 Error 38: Braking chopper error|413| | |
|11.6.37 Error 39: TWIN monitoring error|413|14 Device status|447|
|11.6.38 Error 40: Tech option error|416| | |
|11.6.39 Error 41: Fast discharge monitoring error (dc-link)|420|14.1 Device status|447|
|11.6.40 Error 43: Ethernet error|420|14.2 Status bits|448|
|11.6.41 Error 44: Wire break, common error|421|14.3 Load factor|448|
|11.6.42 Error 45: Lock violation error|421|15 Manual mode|449|
|11.6.43 Error 46: Position limit error|423| | |
|11.6.44 Error 47: Functional safety, common error|426|15.1 Manual mode window|449|
|11.6.45 Error 49: Safety system error|427|15.2 Manual mode control status|450|
|11.6.46 Error 51: Encoder status, common error|435|16 Drive description|451|
|11.6.47 Error 52: Analog inputs error|436|16.1 Electronic rating plate|451|
|11.6.48 Error 53: Motor failure error|436| | |
|11.6.49 Error 54: Power grid failure error|436| | |
|11.6.50 Error 55: Speed guarding error|437|17 Enhanced/additional functions|455|
|11.6.51 Error 57: reserved|437|17.1 Reloading individual parameters|455|
|11.6.52 Error 58: HYDRAULIC, common error|437|17.1.1 Parameters used|455|
|11.6.53 Error 60: Spindle clamping system monitoring error|437|17.1.2 Parameter list|456|
|11.6.54 Error 61: End damping error|438|17.1.3 Procedure|457|
|11.6.55 Error 62: Battery buffered encoder|438|17.2 Upload and download of parameter data sets|459|
|11.6.56 Error 63: Error brake monitoring|439|17.2.1 Write parameter data set to the file system|459|
|12 Fieldbus|440|17.2.2 Loading the parameter data set from the file system|460|
|12.1 CANopen / EtherCAT®|440|18 Index|461|
|12.2 SERCOS|441| | |
|12.3 PROFIBUS / PROFINET|441| | |
|12.4 Synchronization / Configuration|442| | |
|12.5 EDS file generator|442| | |

# General information

NOTE

This Device Help applies to the MSD Servo Drive and MSD Single-Axis Servo Drive Compact. These instructions are not meant as a replacement for the Operation Manuals for the MSD Servo Drive or MSD Single-Axis Servo Drive Compact.

The product CD from Moog contains the complete documentation for the respective product series. The documentation of a product series includes Operation Manual (hardware description), Device Help (software description) and other User Manuals (e.g. fieldbus description) and Specifications. These documents are available in PDF format, and some of them are available in .NET and HTML5 format as well.

# 1.1 Target Group

Dear user, the documentation is an integral part of the device and contains important information on operation and service. It is aimed at everyone who performs mounting, set-up, commissioning and service tasks on the product.

# 1.2 Requirements

Important points to be observed when handling the devices from Moog:

- The device documentation must be kept readable, always available, and throughout the product’s service life.
- Read and understand the documentation for your device.
- Qualification: To avoid bodily injury and property damage, only qualified personnel with electrical training may work with/on the device.
- Required skills and knowledge:
- national accident prevention rules (e.g. DGUV V3 in Germany)
- How to set up, install, commission and operate the device

Work related to other specialised areas, such as transportation, storage and disposal must be performed exclusively by appropriately trained personnel.

MOOG ID No.:CB40859-001 Date:11/2020

# 1 General information

MOOG ID No.: CB40859-001 Date: 11/2020

# MSD ServoDrive - DeviceHelp

10

# 1.3 Pictograms

The pictograms used in this Device Help have the following meaning for the user:

- NOTE
- Useful information or references to other documents.
- Reference to further applicable documents.

# Step Action

1. HANDLING INSTRUCTIONS

(Number) Operating step performed by either the user or the system.

For the pictograms for “safety information and warnings” used in this Device Help, see the Section "Safety information and warnings" on page 15.

# 1.4 Exclusion of liability

Compliance with the documentation for the devices from Moog is a prerequisite for:

- safe operation and
- attaining the performance characteristics and product characteristics described.

Moog accepts no liability for personal injury, material damage or financial losses arising from disregard of the documentation.

MOOG ID No.: CB40859-001 Date: 11/2020

MSD ServoDrive - DeviceHelp 11

# 1 General information

# General information

MOOG ID No.:CB40859-001 Date:11/2020

MSD ServoDrive - DeviceHelp 12

# 1.5 Applicable documentation

|No.|Document|Contents|ID No.|Format|
|---|---|---|---|---|
|1|MSD Single-Axis Servo Drive Compact - Operation Manual|Safety, device installation, setup, commissioning, diagnostics, specifications, certifications and applicable standards, technical data|CA97555-001|PDF|
|2|MSD Servo Drive Single-Axis System - Operation Manual|Safety, device installation, setup, commissioning, diagnostics, specifications, certifications and applicable standards, technical data|CA65642-001|PDF|
|3|MSD Servo Drive Multi-Axis System - Operation Manual|Safety, device installation, set-up, commissioning, diagnostics, STO, operation with Servo Drive as supply, planning, application example, specifications, certifications and applicable standards, technical data|CA97554-001|PDF|
|4|MSD Power Supply Unit - Operation Manual|Safety, device installation, setup, commissioning, diagnostics, specifications, certifications and applicable standards, technical data|CA97556-001|PDF|
|5|MSD Servo Drive Description of the STO safety function|Replacements for Operation Manuals MSD Servo Drive (no. 1 to 3): Hazard analysis and risk assessment, function description, wiring and commissioning, testing the STO function, safety parameters|CB19388|PDF|
|6|MSD Servo Drive functional safety Specification|Additions and changes to Operation Manuals MSD Servo Drive (Nos. 2 and 3)|CB38398-001|PDF|
|7|MSD Servo Drive - Specification second Sin/Cos encoder|Connection, configuration|CA79903-001|PDF|
|8|MSD Servo Drive - Specification Sin/Cos encoder|Connection, configuration|CB13516-001|PDF|
|9|MSD Servo Drive - Specification TTL encoder simulation / TTL master encoder|Connection, configuration|CB08758-001|PDF|

Table 1.1: Applicable documents

# MSD Servo Drive - Specification TTL

|No.|Document|Contents|ID No.|Format|
|---|---|---|---|---|
|10|encoder simulation / TTL master|Connection, configuration|CB32164-001|PDF|
|11|MSD Servo Drive - Specification SSI|Connection, configuration|CB08760-001|PDF|
|12|MSD Servo Drive - Specification TTL|Connection, configuration|CB32162-001|PDF|
|13|MSD Servo Drive - Specification for safe tech option (second safe Sin/Cos encoder + second safe SSI encoder + second safe axis monitoring (Sin/Cos))|Connection, configuration|CC23875-001|PDF|
|14|MSD Servo Drive|Quick installation manual|CC52008-001|PDF|
|15|MSD PLC Manual|Basic Functionality and Libraries|CB15237-001|(only available in EN)|

Table 1.1: Applicable documents (continue)

NOTE: For the latest versions of the aforementioned documents, please visit our website at http://www.moogsoftwaredownload.com/msd.html.

MOOG ID No.:CB40859-001 Date:11/2020

# 1 General information

# 1 General information

MOOG ID No.:CB40859-001 Date:11/2020

# 1.6 Technical Helpline

If you have any technical questions concerning the planning, configuration or commissioning for your device, our Technical Helpline staff will be more than happy to assist you quickly and effectively.

Address: Moog GmbH

Hanns-Klemm-Strasse 28

D-71034 Böblingen

Phone: +49 7031 622-0

Email: drives-support@moog.com

If you are looking for support in case of any necessary service, Moog specialists will be glad to help:

Service: Please contact us via

Phone: +49 7031 622-0

Email: info.germany@moog.com

NOTE

For detailed information on our services, please visit our website, www.moog.com/industrial.

# Safety

Pay attention to special safety and warning information which is provided here in the document directly before a specific action and warns the user of a specific danger!

# 2.1 Overview

Our devices are designed and built with the latest technology and comply with all recognized safety rules and standards. Nevertheless, there are potential hazards that may arise during their use. In this chapter:

- We provide information regarding the residual risks and hazards posed by our devices when they are used as intended.
- We warn you about foreseeable misuse of our devices.
- We point out that it is necessary to exercise due care and caution and go over measures designed to minimize risk.

# 2.2 For your own safety

Our devices may pose certain hazards. Accordingly, you must observe the following safety information and warnings.

NOTE

- The device must only be installed and commissioned in compliance with the documentation for the corresponding device family!

WARNING! Risk of injury posed by uncontrolled rotation!

Improper conduct can lead to serious injury or death.

- Before commissioning motors with feather key on the shaft end it must be secured to prevent it from being ejected, if this is not prevented by drive elements such as pulleys, couplings or similar.

NOTE

- Please also pay special attention to the safety and warning information in the respective valid operation manual when commissioning the drive!

MOOG ID No.:CB40859-001 Date:11/2020

MSD ServoDrive - DeviceHelp

# 2 Safety

MOOG ID No.:CB40859-001 Date:11/2020

MSD ServoDrive - DeviceHelp 16

# CAUTION!

Your system/motor may be damaged if put into operation in an uncontrolled or inappropriate manner.

Improper conduct can cause damage to your system/machine.

- For the risk assessment of the complete machine or system according to EN ISO 12100:2011 and EN ISO 13849-1.
- Observe the topic “Electrical equipment of machines” in EN 60204-1:2006 “Safety of machinery”. The safety requirements defined there to be met by electrical machinery are intended to ensure personal safety and the safety of machinery or systems.
- The emergency-stop function (to IEC/EN 60204) shuts down the power supply of a machine, which leads to uncontrolled rundown of the drives. In order to prevent hazards, check whether the following will be required:

# CAUTION!

Damage to the device as a result of incorrect operation!

Failure to exercise caution or follow proper working procedures may result in damage to the device.

- The mains voltage for the power supply must not be switched on until after the available mains voltage setting has been configured in the device firmware and the device is restarted (in the event that the mains voltage or the switching frequency has been changed).

# 2.4 Responsibility

Electronic devices are not fail-safe. The company setting up and/or operating a complete machine or system is responsible:

- For ensuring that the motor will be brought to a safe state if the device fails.
- For the safety of persons and machinery.
- For proper functional capability of the complete machine.

3    Initial commissioning

 Chapter overview
 Pictogram


 Navigation              ►Project tree ►Device setup ►Initial commissioning
 Brief description           l  The initial commissioning for the drive can be
                                carried out with the help of a wizard. The wizard
                                will take you through the process step-by-step,
                                ensuring that the available configuration options
                                are presented in a clear and manageable manner.
                             l  This chapter describes how the initial
                                commissioning wizard works. This wizard is used
                                to set up the initial configuration for the MSD Servo
                                Drive and make it possible to move the connected
 Contents                       motor.
                         3.1 Initial Commissioning wizard                     17
                         3.2 Automatic test                                   22
                         3.3 Motor                                            23
                         3.4 Encoder                                          24
                         3.5 Control                                          24
MOOG                       ID No.:CB40859-001 Date:11/2020
3    Initial commissioning
3.1     Initial Commissioning wizard
The wizard guides you through the subject areas that are relevant for the initial
commissioning. Correct setting of the parameters permits controlled movement of
the drive via the manual mode window (for details see Section "Manual mode" on
page 449). Further settings must be made to exactly adapt the drive system to an
application.
3.1.1 Hardware requirements

    l  Correct assembly and installation, in line with the intended use, as per the
       instructions in the applicable operation manual (see Section "Applicable
       documentation" on page 12).
    l  Voltage supplies
           o  24 V control voltage
           o  Mains voltage

    l  Hardware enable
           o  Safe Standstill (ISDSH)
           o  Enable Power (ENPO)

3.1.2 Prompt Initial commissioning
If the Moog DRIVEADMINISTRATOR 5 is opened without an existing project, a prompt to
undertake initial commissioning appears automatically.

                                             MSD ServoDrive - DeviceHelp    17

# 3 Initial commissioning

MOOG ID No.:CB40859-001 Date:11/2020

# 3.1.3 Initial commissioning

Image 3.1: Prompt to activate wizard

If this window does not open automatically, you can also start the wizard manually by double-clicking on the pictogram (see “Chapter overview” in Section "Initial commissioning" on page 17) or via ►Project tree ►Device setup ►Initial commissioning.

Image 3.2: Commissioning wizard

# Step

# Subject area

# Action

# Instruction

|1.|Set the switching frequency and the voltage supply of the power stage.|Matching the voltage supply to the clock frequency|Set the motor type (P 450[0]) to "PSM(1)|
|---|---|---|---|
|2.|Select the motor type (P 450[0])|Permanent magnet synchronous motor|Selection of motor type|
|3.|Set (P 490[0]) motor movement to “ROT (0) = rotating motor”|Set (P 490[0]) motor movement to “LIN (1) = linear motor”|Selection of motor system|
|4.|Identification:|- Measurement of electrical parameters (resistance, inductivity)
- Current controller tuning
- Calculation of nominal flux
|Identification or calculation of motor data set|
|5.|Data set calculation:|- Complete "Calculation of control settings" screen and start the calculation
- Set the I2xt monitor
| |
|6.|Select of temperature sensor|Motor protection| |
| |Characteristic setting| | |
| |Encoder selection|Encoder setting| |
| |Channel selection| | |

Table 3.1: Instructions for the commissioning wizard

MOOG ID No.:CB40859-001 Date:11/2020 MSD ServoDrive - DeviceHelp 19

# Initial commissioning

# 3 Initial commissioning

MOOG ID No.:CB40859-001 Date:11/2020 MSD ServoDrive - DeviceHelp 20

|Step|Subject area|Action|Instruction|
|---|---|---|---|
|7.|Rotary motor|- Motor phase test
- Determine encoder offset
- Determine mass inertia
|Open manual mode window|
|8.|Linear motor|- Control type V/Hz (open loop) operation
- Move motor at low speed
- Check direction
- Optimize current controller (test signal generator). When there is a motor data set the current of the test signal generator is set automatically.
- Optimizing the speed controller
|Motor test in manual mode without intervention of a higher-level PLC|
|9.| |- Determine mass inertia [J] (basic settings)
- Set speed filter: P 0351 CON_SCALC_TF = (0,6 ms)
- Recommendation, Sin/Cos encoder 0.2 ms - 0.6 ms
- Recommendation, resolver: 1 ms - 2 ms
- Adjust control parameters to suit the mechanism (set stiffness).
|- Current Controller
- Speed controller
- Position controller
|
|10.| |- Units
- Reference source
- Reference processing
- Stop ramps
- Homing method
|Motion profile setting|

Table 3.1: Instructions for the commissioning wizard (continue)

# Step

# Subject area

# Action

# Instruction

|11.|Torque|Define limits|Rotary motor|
|---|---|---|---|
| | |Linear motor| |
| | |Limits:| |
|12.|Speed|Set marginal conditions. For more information refer to the User Manuals for the individual bus systems.|CANopen|
| | |Position|PROFIBUS|
| | |SERCOS| |
|13.|13.|13.|Saving the settings and creating a commissioning file| | |
| | | |For more information on data handling refer to the Moog DRIVEADMINISTRATOR 5 help.| | |

Table 3.1: Instructions for the commissioning wizard (continue)

MOOG ID No.:CB40859-001 Date:11/2020 MSD ServoDrive - DeviceHelp 21

# 3 Initial commissioning

# 3 Initial commissioning

MOOG ID No.:CB40859-001 Date:11/2020

MSD ServoDrive - DeviceHelp 22

# 3.2 Automatic test

To be able to run the automatic tests, you will need to read and confirm the safety prompts. Once you are done doing so, you will be able to run the individual tests.

Image 3.4: “Initial Commissioning - Automatic tests” screen

# Motor phase test

A motor phase check has been implemented which permits monitoring of the motor wiring. It also checks whether the parameter setting of the pulses per revolution of the encoder and the number of pole pairs of the resolver match the number of pole pairs of the motor. When it has been successfully determined, a green tick (check-mark) is displayed. Disable motor brake during the motor phase test.

# Determining the encoder offset

Once the safety notice window has been confirmed, the wizard is activated to determine the encoder offset. When it has been successfully determined, a green tick (check-mark) is displayed.

Image 3.3: Safety information

# 3.3 Motor

Once the safety notice window has been confirmed, the wizard is activated to determine the mass inertia. When it has been successfully determined, a green tick (check-mark) is displayed.

See also Section "Automatic inertia detection" on page 111.

# Enhanced >>

When you click the “Enhanced >>" button, the wizard provides you with support in setting up the current, torque, speed and position controllers. If further optimization is required, the controller buttons route you to more detailed screens.

Image 3.5: “Initial Commissioning - Motor data and control settings” screen

- You can click on the "Select motor data set" to select a motor from Moog.
- If you want to use a different motor, you can configure it by clicking on the "Manual motor settings" button. For details see Section "Motor configuration data" on page 32.
- If you need to configure the temperature and current monitoring mechanism, click on the "Motor protection" button. For details see Section "Motor protection" on page 40.
- To configure a motor brake, click on the "Motor brake" button. For details see Section "Motor brake output" on page 308.

MOOG ID No.:CB40859-001 Date:11/2020

MSD ServoDrive - DeviceHelp 23

# 3 Initial commissioning

# 3 Initial commissioning

MOOG ID No.:CB40859-001 Date:11/2020

# 3.4 Encoder

Image 3.6: “Initial commissioning - Encoder selection” screen

- There is a database available for commissioning the encoder. This database can be used to select from a large number of standard models.
- If you are unable to find your encoder model or want to configure additional settings, click on the "Settings..." button. For details see Section "Encoder selection" on page 53.

# 3.5 Control

Image 3.7: “Initial Commissioning - Control” screen

- You can use this screen to select the control mode for the device.
- To determine the system’s inertia and configure position and speed control settings, click on the "Basic settings" button. For details see Section "Basic settings" on page 110.
- To access the “Control” screen, click on the "Advanced >>" button. For details see Section "Basic settings" on page 110.

# 4 Power stage

# Chapter overview

Pictogram

Navigation &nbsp;&nbsp;&nbsp;&nbsp; ►Project tree ►Device setup ►Power stage

Brief description &nbsp;&nbsp;&nbsp;&nbsp; This chapter describes the configuration options for the power stage (power supply, switching frequency, power failure bridging).

Contents

- 4.1 Power stage settings &nbsp;&nbsp;&nbsp;&nbsp; 25
- 4.2 Power failure bridging &nbsp;&nbsp;&nbsp;&nbsp; 28

Image 4.1: “Power stage settings” screen AC device

The power stages of the Servo Drive can be operated with different voltages and switching frequencies. The list boxes in the screen are used to adapt the power stage to the application conditions.

NOTE

- Any changes to parameters must be saved in the device.
- The setting is only applied on the device after a power off/on cycle.
- If the power stage parameters are changed, the rated currents, overload values and brake chopper thresholds may also change.

MOOG &nbsp;&nbsp;&nbsp;&nbsp; ID No.:CB40859-001 Date:11/2020 &nbsp;&nbsp;&nbsp;&nbsp; MSD ServoDrive - DeviceHelp &nbsp;&nbsp;&nbsp;&nbsp; 25

# 4 Power stage

MOOG ID No.:CB40859-001 Date:11/2020 MSD ServoDrive - DeviceHelp 26

# 4.1.1 Voltage supply

Step0: No reduction of the switching frequency (the operating switching frequency from P 302 is used).

P 307[0] - CON_VoltageSupply is used to configure the power supply. For single-axis applications only the settings (0) to (5) are allowed. All other settings should be used for multi-axis systems. Not all switching frequencies can be used on higher-powered devices. An excessively high switching frequency setting in conjunction with high powers may result in a power reduction.

# 4.1.2 Switching frequency

The switching frequency is set via P 302[0] - CON_SwitchFreq. It is advisable to initially operate the servo drive with the factory setting (8 kHz). Increasing the switching frequency can be useful to improve the control dynamism. However, it may under some circumstances result in a temperature-related loss of power. Switching frequency noises will decrease with increasing switching frequency (audible range < 12 kHz). For an overview of the currents dependent on the switching frequency refer to the Operation Manual (see Section "Applicable documentation" on page 12).

# 4.1.3 Online derating of switching frequency

When P 752[0] - MON_PWM_SwitchFreqSelect_Sel = “AUTO(1)", the switching frequency is switched in dependence on the current load conditions. If there is a high load, the operating switching frequency from parameter P 302 - CON_SwitchFreq is reduced stepwise and when the load is lower, it is subsequently raised once again via the same steps. Within this context, the system automatically switches to the next lower or higher possible switching frequency. The individual switching frequencies between which automatic switching to a lower or back to a higher frequency is possible depends on the device (!) and on the currently selected operating switching frequency from parameter P 302 - CON_SwitchFreq. The switching frequency can be reduced by a maximum of 2 “steps”. In other words, there are the following 3 levels for the switching frequency:

# 4.1.4 Parameters

|ID|Index Name / Setting|Unit|Description|
|---|---|---|---|
|302|CON_SwitchFreq| |Power stage switching frequency 2 kHz - 16 kHz (2 kHz only for BG7). It is advisable to operate the servo drive with the default setting. Increasing the switching frequency can be useful to improve the control dynamism. Temperature-related derating may occur. Switching frequency noise decreases as the switching frequency rises (audible range < 12 kHz).|
|309|CON_EnableWiretest| |Enable wire test|
|409|CON_ACT_VDC_TF|ms|Filter time constant for DC link voltage|
|752|MON_PWM_SwitchFreqSelect_Sel| |Switching frequency mode selector|
| |OFF (0)| |No function|
| |AUTO (1)| |Automatic switchover|
| |MAN(2)| |Manual switchover limited by P 758[0]|
| |CON_SwitchFreq_selMan| |Manually configurable power stage switching frequency|
| |(0)2 kHz| |2 kHz|
| |(1)4 kHz| |4 kHz|
|759|CON_|V|Overwrite default under voltage threshold level|

Table 4.1: “Power stage” parameters

# 4 Power stage

# Table 4.1: “Power stage” parameters (continue)

|ID|Index Name / Setting|Unit|Description|
|---|---|---|---|
|307|0 CON_VoltageSupply|Power supply mains voltage|(-1)1 /3x 110 V|
| | | |The device can be connected to the mains with one or three phases.|
| | | |(0)1x 230 V Single-phase device|
| | | |(1)3x 230 V Three-phase device|
| | | |(2)3x 400 V Three-phase device|
| | | |(3)3x 460 V Three-phase device|
| | | |(4)3x480 V Three-phase device|

# Table 4.2: “Power stage - AC servo drive” parameters

|ID|Index Name / Setting|Unit|Description|
|---|---|---|---|
|307|0 CON_VoltageSupply|Power supply mains voltage|(5)Safety low voltage 24-60 V|
|424|0 CON_VoltageMode|Device power supply mode| |
|425|0 CON_GridVoltageNom|V r.m.s|Mains voltage|
|426|0 CON_DCLinkVoltageNom|V|DC link voltage (DC low voltage)|

# Table 4.3: “Power stage - DC drives” parameters

|ID|Index Name|Unit|Description|
|---|---|---|---|
|308|0 CON_VoltageNom|V|Nominal voltage (DC low voltage)|

# Table 4.4: “Power stage - Low-voltage DC supply” parameters

|ID|Index Name|Unit|Description|
|---|---|---|---|
|MOOG|ID No.:CB40859-001|Date:11/2020| |

# Table 4.5: “Power stage - Mains voltage adaption” parameters

|ID|Index Name / Setting|Unit|Description|
|---|---|---|---|
|760|MON_VDC_Guard|Monitoring of DC link voltage| |
|760|0 Tfilt_av|ms|Filter time constant for average|
|760|1 Tfilt_var|ms|Filter time constant for variance|
|760|2 Max_var|V^2|Max allowed variance|
|760|3 Max_time|s|Max time with variance threshold exceeded|
|760|4 Check_time|s|Interval to check return of failed phase|
|1958|0 CON_FPGA_PWMScale|%|Phase voltage scaling of the fpga current controller (0 = no block modulation)|

# Table 4.6: “Power stage - Power failure bridging settings” parameters

|ID|Index Name|Unit|Description|
|---|---|---|---|
|2940|0 CON_PowerFail_Sel| |Power failure bridging: selector|
|2941|0 Kr|A/V|Power failure bridging: Gain|
|2941|1 Tn|ms|Voltage control integration time constant|
|2941|2 imax|A|Voltage control maximum (negative) q-current|
|2941|3 imax_pos|A|Voltage control maximum q-current|
|2941|4 n_min|rpm|Minimum speed (abs value) for voltage control|
|2942|0 POWF_VOn|V|Threshold voltage (offset) to start power fail control|
|2942|1 POWF_VRef|V|Reference voltage (offset) at power fail|
|2943|0 CON_POWF_RetTime|ms|uzk return time (65535 = infinite)|
|2944|0 CON_POWF_UdcOffSw|V|Shutdown threshold: Undervoltage|
|2945|0 CON_POWF_UbcOnSw|V|Switch-on threshold: Braking chopper|

# 4 Power stage

MOOG ID No.:CB40859-001 Date:11/2020

MSD ServoDrive - DeviceHelp 28

# 4.2 Power failure bridging

# 4.2.1 Functional description

# 4.2.1.1 Detection of a voltage failure

The P 2940 - CON_PowerFail_Sel selection parameter can be used to select the following operating modes:

|0= (OFF)|switched off|
|---|---|
|1= (Ret)|Power failure bridging with power return detection. The system will start up again if the power returns within a configurable period of time.|
|2= (NoRet)|Power failure bridging with power return detection. The system will not start up again.|
|3= (NoLim)|Fastest possible speed reduction without power return detection.|
|5= (RetAbs)|Same as 1=Ret, but with absolute voltage levels and without validation check.|
|6= (NotRetAbs)|Same as 2=NoRet, but with absolute voltage levels and without validation check.|
|7= (NoRetAbsPulse)|Same as 6=NoRetAbs, but with pulse operation.|

In the event of a power failure, the DC link voltage can be supported by using the motor’s rotational energy. To this end, the motor will be operated as a generator and decelerated in a controlled manner in the event of a power failure so that a configurable DC link voltage setpoint will be maintained. This function is especially useful when it comes to powering the electronics in drives with magnetic bearings, as this will prevent the assembly from crashing into the safety bearing in the event of a power failure all the way to the lowest possible speeds.

NOTE

Please note that the components which need bridging must be powered via the DC link (DC power supply). In particular, the power supply of the servo drive itself (24 V control voltage) must be ensured.

# 4.2.1.2 Parametrisation

P 2941 - CON_POWF_VCtrl is used to configure the voltage controller by adjusting the corresponding gain and reset time. Within this context, the specified gain refers to the motor’s rated speed. At lower speeds, the gain will be automatically increased in order to maintain a constant dynamic performance in the voltage control circuit.

P 2942 - CON_POWF_VLim is used to configure the threshold voltage for detecting power failures / power returns, as well as the voltage setpoint for the controller. The configured voltage values will not be absolute values, but will instead be added to specific DC link threshold values (based on the operating mode). The corresponding

Image 4.2: Power failure bridging settings screen

# 4.2.1.3 Modes

# Mode 1

Power failure bridging with power return detection. The system will start up again if the power returns within a configurable period of time.

The power failure detection limit is formed by adding together P 701[12] - u_zkoff (Software shut-off limit for detection of DC link undervoltage) and P 2942[0] - POWF_Von. It should be considerably higher than the shutdown limit (default setting = 40 V).

Likewise, the voltage setpoint is yielded by adding P 701[12] - u_zkoff and P 2942[1] - POWF_VRef. The voltage setpoint must be lower than the detection limit so that it will be possible to detect when the power returns. Moreover, it should be considerably higher than the shutdown limit (default setting = 20 V).

After a power failure is detected, the controller will control the voltage so that it reaches the configured setpoint. If a power return is detected within the time period set in P 2943[0] - CON_POWF_RetTime, the drive will return to its original control state. If power returns after the aforementioned time period has already elapsed, error 34-1 will be triggered. If P 2943[0] - CON_POWF_RetTime is set to 65535, there will be no time limit for the drive to return to its original control state after power returns.

# Mode 2

Power failure bridging with power return detection. The system will not start up again.

Same as mode 1, except the system will not start up again if the power returns. Error 34-1 will always be triggered once the power returns.

# Mode 3

Fastest possible speed reduction without power return detection.

In terms of configuring the power failure detection limits, the requirements listed for mode 1 apply here as well. The voltage setpoint is yielded by adding P 701[17] - u_bc_on (braking chopper threshold) and P 2942[1] - POWF_VRef. After a power failure is detected, the controller will control the voltage so that it reaches the configured setpoint. This setpoint will be considerably higher than the power failure detection limit, which will technically ensure that it will not be possible to detect the return of power. This mode is characterized by the fact that the DC link voltage is typically raised all the way over the braking chopper threshold, resulting in the braking energy being converted into braking resistance. Accordingly, the drive will decelerate as quickly as possible.

# Mode 4

Only with expanded VFC functionality.

MOOG ID No.:CB40859-001 Date:11/2020

# 4 Power stage

If the power does not return, the drive will theoretically decelerate all the way to a stop. Within this context, there will be a specific speed below which it will not be possible to maintain the DC link voltage any longer even with the maximum motor (brake) current. This will result in an undervoltage shutdown.

MSD ServoDrive - DeviceHelp 29

# Power stage

MOOG ID No.:CB40859-001 Date:11/2020

MSD ServoDrive - DeviceHelp 30

# Mode 5

Same as mode 1, but with absolute voltage levels and without a validation check.

# 4.2.1.4 Parameters

|P No.|Index|Name / Setting|Unit|Function|
|---|---|---|---|---|
|P 2942[0]|-|POWF_VOn|-|is used to define the power failure detection limit.|
|P 2942[1]|2940|CON_PowerFail|-|Power failure bridging: selector|
|-|-|Off (0)|-|Function disabled|
|-|-|RET(1)|-|Function enabled. Return of power allowed if it occurs within defined time; otherwise, trigger error upon return|
|-|-|NORET(2)|-|Function enabled. Return of power not allowed - > Trigger error upon return.|
|-|-|NOLIM(3)|-|Function enabled. Return of power cannot be detected.|
|-|-|RETABS(5)|-|Same as "RET(1)", bit with absolute voltages and without validation checks.|
|-|-|NORETABS(6)|-|Same as “NORET(2)", bit with absolute voltages and without validation checks.|
|-|-|NORETABSPULSE(7)|-|Same as "NORETABS(6)", but with pulse operation.|

# Mode 6

Same as mode 2, but with absolute voltage levels and without a validation check.

# Parameters

|P 2942[0]|-|POWF_VOn|-|is used to define the power failure detection limit.|
|---|---|---|---|---|
|P 2942[1]|-|POWF_VRef|-|is used to define the voltage setpoint. The configured values will not be checked to see if they are valid. The user themselves will be responsible for ensuring that the values entered make sense.|

# Mode 7

Same as mode 6, but with pulse operation.

# Parameters

|P 2942[0]|-|POWF_VOn|-|is used to define the power failure detection limit.|
|---|---|---|---|---|
|P 2942[1]|-|POWF_VRef|-|is used to define the voltage setpoint. The configured values will not be checked to see if they are valid. The user themselves will be responsible for ensuring that the values entered make sense.|

# Power failure bridging

|2941|0|CON_POWF_VCtrl|Power failure bridging: Gain| | |
|---|---|---|---|---|---|
|1|Tn|ms|Power failure bridging: Reset time| | |
|2|imax|A|Power failure bridging: Maximum (negative) current| | |
|3|imax_pos|A|Power failure bridging: Maximum q current| | |
|4|n_min|rpm|Power failure bridging: Minimum speed for voltage controller| | |
|2942|0|CON_POWF_VLim|Voltage limit for power failure| | |
| | |POWF_Von|V|Power failure detection limit| |
|1|POWF_VRef|V|Voltage reference value| | |
| |2943|0|CON_POWF_RetTime|ms|Setting of time window in which mains power can be restored|
|701|-|MON_ActValues|-|-| |
|12|u_zkoff|VDC|UZK undervoltage threshold| | |
|17|u_bc_on|VDC|Braking chopper threshold| | |

# Table 4.7: “Power failure bridging” parameters

# 4.2.2 Monitoring for single-phase failure

If the parameter is P 737[0] MON_MNCTL, bit 4 = 1, the PowerFail state of the control is initiated. This must therefore be configured. See chapter 4.2.1 Detection of a voltage failure. In this case, the error reaction should be set to "Ignore".

|P No.|Index|Name / Setting|Unit|Function|
|---|---|---|---|---|
|701|28|VDC_Variance|V²|DC voltage variance|
|737| |MON_MNCTL| |Monitoring control and status word|
|737|0|MON_MNCTL| |Monitoring control word|
|737|1|MON_MNSTAT| |Monitoring status word|
|760| |MON_VDC_Guard| |Monitoring of DC link voltage|
| |0|Tfilt_av|ms|Filter time constant for average|
| |1|Tfilt_var|ms|Filter time constant for variance|
| |2|Max_var|V²|Max allowed variance|
| |3|Max_time|s|Max time with variance threshold exceeded|
| |4|Check_time|s|Interval to check return of failed phase|

Table 4.8: Parameter - Single-phase failure of the device power supply

In the event of a single-phase failure of the device supply, e.g. a burned-out non-renewable fuse, the DC link voltage is maintained and the device continues to operate for the time being. However, the input rectifier can be damaged at a high output power.

The single-phase power failure detection is set with P 737[0] MON_MNCTL - bit 3 = 1.

The quadratic ripple (variance) of the DC link voltage is calculated. If it exceeds the threshold value P 760[2]-MON_VDC_Guard - MaxVar for the time P 760[3]-MON_VDC_Guard - Max_time, the monitoring is triggered.

The actual value is shown in P 701[28] - VDC Variance. Measure this value at maximum output power and proper operation, then use about 5-10 times that as the monitoring threshold.

The monitoring triggers error 54-1 (Emergency code 6100h). See chapter 11.6 Error list.

MOOG ID No.:CB40859-001 Date:11/2020

MSD ServoDrive - DeviceHelp

# 5 Motor

# Chapter overview

Pictogram

Navigation &nbsp;&nbsp;&nbsp;&nbsp; ►Project tree ►Device setup ►Motor

Brief description &nbsp;&nbsp;&nbsp;&nbsp; The following chapter describes the steps used to calculate parameters for, identify, and configure motors, as well as their protection mechanisms and brake.

# Contents

- 5.1 Motor configuration data &nbsp;&nbsp;&nbsp;&nbsp; 32
- 5.2 Synchronous motor &nbsp;&nbsp;&nbsp;&nbsp; 33
- 5.3 Linear synchronous motor &nbsp;&nbsp;&nbsp;&nbsp; 36
- 5.4 Asynchronous motor &nbsp;&nbsp;&nbsp;&nbsp; 38
- 5.5 Motor protection &nbsp;&nbsp;&nbsp;&nbsp; 40
- 5.6 Motor identification &nbsp;&nbsp;&nbsp;&nbsp; 45
- 5.7 Support for motor filters when using PMSM motors &nbsp;&nbsp;&nbsp;&nbsp; 47

Image 5.1: "Motor data and control settings" screen

Each motor can only be operated if its field model and the control parameters are correctly set. Using the standard motors and encoders from the Moog motors catalog, a system can be commissioned and put into operation very quickly and easily. Third-party motors can of course be used as well. As the field models of those motors are not known, the motor must be identified by type or calculated. The selection is made with the preceding “Motor data and control settings” screen.

MOOG &nbsp;&nbsp;&nbsp;&nbsp; ID No.:CB40859-001 Date:11/2020

MSD ServoDrive - DeviceHelp &nbsp;&nbsp;&nbsp;&nbsp; 32

# 5 Motor

# MOOG

ID No.: CB40859-001 Date: 11/2020

# MSD ServoDrive - DeviceHelp

Loading a motor data set

- Motor data and control settings screen
- Select data set
- Enter encoder settings
- Save data

# Commissioning a third-party motor

In the case of third-party motors, basic suitability for operation with Servo Drives from Moog must first be verified on the basis of the motor data and the data of any installed encoder. The values of the parameters for adaptation of the Servo Drive must be determined specifically for each motor by calculation or identification. The two methods differ in that when the motor data set is calculated, the impedances must be taken from the data sheet. The impedances are measured automatically during identification. Each motor can only be operated if its field model and the control parameters are correctly set.

On transfer of a standard motor data set the motor name, electrical data and motion mode are loaded. Preset parameters are overwritten. The motor data must then be saved in the device. The motor parameters specified by the manufacturer ensure that a motor can be subjected to load according to its operational characteristic, provided the corresponding power is supplied by the controller.

# Image 5.2: “Synchronous motor settings” screen

There are two ways to create a motor data set for the rotary synchronous motor.

- Variant 1: Motor calculation
- Variant 2: Motor identification (see Section "Motor identification" on page 45)

NOTE

- Each motor can only be operated if its field model and the control parameters are correctly set.

# Variant 1: Motor calculation

ID

|Index|Name|Unit|Description|
|---|---|---|---|
|451|MOT_Name| |Name of motor parameter set|
|455|MOT_FNom|Hz|Motor rated frequency|
|456|MOT_VNom|V|Motor rated voltage|
|457|MOT_CNom|A|Motor rated current|
|458|MOT_SNom|rpm|Motor rated speed|
|459|MOT_PNom|kW|Motor rated power|
|460|MOT_TNom|Nm|Motor rated torque|
|461|MOT_J|kg m*m|Motor inertia|
|1530|SCD_SetMotorControl| |Determination of default control settings|

The motor data relevant to the calculation must be entered manually from the data sheet.

Click on “Start calculation”.

If the moment of inertia of the motor P 461 - Mot_J is not known, a value roughly corresponding to the motor's moment of inertia must be applied.

The calculation process can be monitored in the Moog DRIVEADMINISTRATOR 5 via the menu, View, Messages.

Calculation of operating point: Flux P 462 - MOT_FLUXNom

Calculation of: current, speed and position control parameters

# NOTE

All existing motor parameters are overwritten.

# Calculated values

- Flux settings (including for torque constant)
- Control settings for current controller: the current controller is dimensioned based on the actual switching frequency set.
- Speed controller and position controller gain: here a moderately stiff mechanism and mass inertia matching from load to motor with a ratio of 1:1 is to be assumed.
- V/F characteristic

# NOTE

All existing control parameters are overwritten.

MOOG ID No.:CB40859-001 Date:11/2020

MSD ServoDrive - DeviceHelp 34

# 5 Motor

MOOG ID No.:CB40859-001 Date:11/2020

MSD ServoDrive - DeviceHelp 35

# 5.2.1 Synchronous motor electronic data

| |ID|Index Name|Unit|Description|
|---|---|---|---|---|
|462|0|MOT_FluxNom|Vs|Motor rated flux linkage|
|463|0|MOT_PolePairs| |Motor number of pole pairs|
|470|0|MOT_Rstat|Ohm|Motor stator resistance|
|471|0|MOT_Lsig|mH|Motor leakage inductance (ASM) / stator inductance (PSM)|
|472| |MOT_LsigDiff| |q-axis stator inductance variation (relative to MOT_Lsig)|
|472|0|Lsig_q@I0|%|Inductance @ CurrentI0|
|472|1|Lsig_q@I1|%|Inductance @ CurrentI1|
|472|2|Lsig_q@I2|%|Inductance @ CurrentI2|
|472|3|Lsig_q@I3|%|Inductance @ CurrentI3|
|472|4|CurrentI0|%|Current I0 relative to MOT_CNom|
|472|5|CurrentI1|%|Current I1 relative to MOT_CNom|
|472|6|CurrentI2|%|Current I2 relative to MOT_CNom|
|472|7|CurrentI3|%|Current I3 relative to MOT_CNom|
|479| |MOT_TorqueSat| |Inductor saturation: Motor torque as function of q-axis current (saturation)|
|479|0|Torque@I0|Nm|Torque @ current I0|
|479|1|Torque@I1|Nm|Torque @ current I1|
|479|2|Torque@I2|Nm|Torque @ current I2|
|479|3|Torque@I3|Nm|Torque @ current I3|
|479|4|Torque@IMax|Nm|Torque @ current I4|
|479|5|CurrentI0|A|Current I0|
|479|6|CurrentI1|A|Current I1|
|479|7|CurrentI2|A|Current I2|
|479|8|CurrentI3|A|Current I3|
|479|9|CurrentIMax|A|Current I4|
|480|0|MOT_Lsq|mH|Motor stator q-inductance (0=>Lq=MOT_Lsig*MOT_LsigDiff)|

Table 5.2: “Synchronous motor electronic data” parameters

Image 5.3: “Synchronous motor electronic data” screen

# 5.3 Linear synchronous motor

The calculation process can be monitored in the Moog DRIVEADMINISTRATOR via the menu, View, Messages.

- Calculation of operating point: Flux P 462 - MOT_FLUXNom
- Calculation of: current, speed and position control parameters

NOTE

- P 490 - MOT_ISLinRot = LIN(1): The parameter automatically sets the number of pole pairs for the motor to P 463 - Mot_PolePairs = 1. As a result, a North to North pole pitch corresponds to one virtual revolution (P 492 - Mot_MagnetPitch).

NOTE

- All existing motor parameters are overwritten.

# Calculated values

- Translation of the linear nominal quantities into virtual rotary nominal quantities
- Default values for auto commutation

There are two methods of creating a motor data set for the linear synchronous motor.

- Variant 1: Motor calculation
- Variant 2: Motor identification (see Section "Motor identification" on page 45)

# Variant 1: Motor calculation

- Enter the motor data
- The motor data relevant to the calculation must be entered from the data sheet.

Click on “Start calculation”.
- If the moment of inertia of the motor P 461 - Mot_J is not known, a value roughly corresponding to the motor's moment of inertia must be applied.

# MOOG

ID No.:CB40859-001 Date:11/2020

# MSD ServoDrive - DeviceHelp

36

# 5 Motor

# 5 Motor

MOOG ID No.:CB40859-001 Date:11/2020 MSD ServoDrive - DeviceHelp 37

# 5.3.1 Linear synchronous motor electronic data

|ID|Index|Name|Unit|Description|
|---|---|---|---|---|
|451|0|MOT_Name| |Name of motor parameter set|
|457|0|MOT_CNom|A|Motor rated current|
|491|0|MOT_CalcLin2Rot| |Calculate from linear to rotary motor data|
|492|0|MOT_MagnetPitch|mm|Width of one motor pole pair|
|493|0|MOT_SpeedMax|m/s|Motor rated speed|
|494|0|MOT_ForceNom|N|Motor rated force|
|496|0|MOT_MassMotor|kg|Mass of motor slide|
|497|0|MOT_MassSum|kg|Total mass, moved by the motor|
|498|0|MOT_EncoderPeriod|um|Period of line signals|

Table 5.3: “Linear synchronous motor” parameters

Image 5.5: “Linear synchronous motor electronic data” screen

# 5.4 Asynchronous motor

|ID|Index Name|Unit|Description| |
|---|---|---|---|---|
|462|0|MOT_FluxNom|Vs|Motor rated flux linkage|
|470|0|MOT_Rstat|Ohm|Motor stator resistance|
|471|0|MOT_Lsig|mH|Motor leakage inductance (ASM) / stator inductance (PSM)|
|472| |MOT_LsigDiff| |q-axis stator inductance variation (relative to MOT_Lsig)|
|472|0|Lsig_q@I0|%|Inductance @ CurrentI0|
|472|1|Lsig_q@I1|%|Inductance @ CurrentI1|
|472|2|Lsig_q@I2|%|Inductance @ CurrentI2|
|472|3|Lsig_q@I3|%|Inductance @ CurrentI3|
|472|4|CurrentI0|%|Current I0 relative to MOT_CNom|
|472|5|CurrentI1|%|Current I1 relative to MOT_CNom|
|472|6|CurrentI2|%|Current I2 relative to MOT_CNom|
|472|7|CurrentI3|%|Current I3 relative to MOT_CNom|
|479| |MOT_TorqueSat| |Inductor saturation: Motor torque as function of q-axis current (saturation)|
|479|0|Torque@I0|Nm|Torque @ current I0|
|479|1|Torque@I1|Nm|Torque @ current I1|
|479|2|Torque@I2|Nm|Torque @ current I2|
|479|3|Torque@I3|Nm|Torque @ current I3|
|479|4|Torque@IMax|Nm|Torque @ current I4|
|479|5|CurrentI0|A|Current I0|
|479|6|CurrentI1|A|Current I1|
|479|7|CurrentI2|A|Current I2|
|479|8|CurrentI3|A|Current I3|
|479|9|CurrentIMax|A|Current I4|

Table 5.4: “Linear synchronous motor electronic data” parameters

Image 5.6: “Asynchronous motor configuration” screen

There are two methods of creating a motor data set for the asynchronous motor.

- Variant 1: Motor calculation
- Variant 2: Motor identification (For details see Section "Motor identification" on page 45)

MOOG ID No.:CB40859-001 Date:11/2020

MSD ServoDrive - DeviceHelp 38

# 5 Motor

MOOG ID No.:CB40859-001 Date:11/2020 MSD ServoDrive - DeviceHelp 39

# Variant 1: Motor calculation

|l|Enter the motor data|451|0|MOT_Name|Name of motor parameter set|
|---|---|---|---|---|---|
| |The motor data relevant to the calculation must be entered from the data sheet.|452|0|MOT_CosPhi|Motor rated power factor|
| | |455|0|MOT_FNom|Hz Motor rated frequency|
| | |456|0|MOT_VNom|V Motor rated voltage|
| | |457|0|MOT_CNom|A Motor rated current|
| | |458|0|MOT_SNom|rpm Motor rated speed|
| | |459|0|MOT_PNom|kW Motor rated power|
| | |460|0|MOT_TNom|Nm Motor rated torque|
| | |461|0|MOT_J|kg m*m Motor inertia|
| | |1530|0|SCD_SetMotorControl|Determination of default control settings|

Table 5.5: “Asynchronous motor configuration” parameters

# 5.4.1 Asynchronous motor electrical data

- l Click on “Start calculation”.
- If the moment of inertia of the motor P 461 - Mot_J is not known, a value roughly corresponding to the motor's moment of inertia must be applied.
- The calculation process can be monitored in the Moog DRIVEADMINISTRATOR 5 via the menu, View, Messages.
- Calculation of operating point: Flux P 462 - MOT_FluxNom, P 340 - CON_FM_Imag.
- Calculation of: current, speed and position control parameters

NOTE

- All existing motor parameters are overwritten.

# Calculated values

- Flux settings (including for torque constant)
- Control settings for current controller: The current controller is dimensioned dependent on the switching frequency setting.
- Speed controller and position controller gain: In this, a moderately rigid mechanism and a 1:1 moment of inertia adjustment from the load to the motor are to be assumed.
- V/F characteristic

Image 5.7: “Asynchronous motor electrical data” screen

# 5.5 Motor protection

|ID|Index Name|Unit|Description| |
|---|---|---|---|---|
|340|0|CON_FM_Imag|A|Magnetizing current (RMS)|
|462|0|MOT_FluxNom|Vs|Motor rated flux linkage|
|463|0|MOT_PolePairs| |Motor number of pole pairs|
|470|0|MOT_Rstat|Ohm|Motor stator resistance|
|471|0|MOT_Lsig|mH|Motor leakage inductance (ASM) / stator inductance (PSM)|
|472| |MOT_LsigDiff| |q-axis stator inductance variation (relative to MOT_Lsig)|
|472|0|Lsig_q@I0|%|Inductance @ CurrentI0|
|472|1|Lsig_q@I1|%|Inductance @ CurrentI1|
|472|2|Lsig_q@I2|%|Inductance @ CurrentI2|
|472|3|Lsig_q@I3|%|Inductance @ CurrentI3|
|472|4|CurrentI0|%|Current I0 relative to MOT_CNom|
|472|5|CurrentI1|%|Current I1 relative to MOT_CNom|
|472|6|CurrentI2|%|Current I2 relative to MOT_CNom|
|472|7|CurrentI3|%|Current I3 relative to MOT_CNom|
|473| |MOT_LmagTab| |Main inductance as a function of isd|
|473|0|MOT_LmagTab|mH|(0.1*index*LmagIdMax)|
|473|1|MOT_LmagTab|mH| |
|473|2|MOT_LmagTab|mH| |
|473|3|MOT_LmagTab|mH| |
|473|4|MOT_LmagTab|mH| |
|473|5|MOT_LmagTab|mH| |
|473|6|MOT_LmagTab|mH| |
|473|7|MOT_LmagTab|mH| |
|473|8|MOT_LmagTab|mH| |
|473|9|MOT_LmagTab|mH| |
|473|10|MOT_LmagTab|mH| |
|474|0|MOT_LmagIdMax|A|Maximum magnetizing current (RMS)|
|475|0|MOT_LmagScale|%|Motor main inductance, scaling factor|
|476|0|MOT_Rrot|Ohm|Motor rotor resistance|
|477|0|MOT_RrotScale|%|Motor rotor resistance, scaling factor|
|478|0|MOT_LmagNom|mH|Main inductance at nominal magnetizing current|

# Table 5.6: “Asynchronous motor electrical data” parameters

| | | | |P No.|Index|P Name / Setting|Unit|Function|
|---|---|---|---|---|---|---|---|---|
| | | | |731| |MON_MotorTempMax| |Maximum motor temperature (switch-off value)|
| | | | | |0|TempMax X5|degC|Maximum sensor temperature X5|
| | | | | |1|TempMax X6|degC|Maximum sensor temperature X6|

# Table 5.7: “Temperature monitoring” parameters

MOOG ID No.:CB40859-001 Date:11/2020

MSD ServoDrive - DeviceHelp 40

# 5 Motor

MOOG                             ID No.:CB40859-001 Date:11/2020

|P No.|Index|P Name / Setting|Unit|Function|P No.|
|---|---|---|---|---|---|
|732|MON_MotorPTC|Selection of sensor type| | | |
| |0|Type| | | |
| | |Off (0)| |No motor temperature sensor| |
| | |KTY (1)| |KTY84-130 Sensor| |
| | |PTC (2)| |PTC sensor (three) with short circuit monitoring below 50 ohms or hardware detection| |
| | |TSS (3)| |Switch (Klixon)| |
| | |PTC1 (4)| |PTC sensor (one) without short circuit monitoring| |
| | |PT100 (5)| |PTC100 in line with DIN EN 60751| |
| | |NTC220 (6)| |NTC Sensor 220 kOhm type 2322 633 1)| |
| | |NTC1000 (7)| |NTC Sensor 1000 kOhm| |
| | |NTC_K227 (8)| |NTC Sensor K227 32 kOhm| |
| | |KTY83-110 (9)| |KTY83-110 Sensor| |
| | |NTC50 (10)| |NTC sensor 50 kOhm| |
| | |NTC10 (11)| |NTC Sensor 10 kOhm| |
| | |PTC2 (12)| |PTC sensor (simple) with short circuit monitoring under 5 ohms| |
| | |PT1000 (13)| |PT1000 Sensor| |
|2)| |PT1000-2 (14)| |PT1000-2 sensor, Rx value via internal table with measurement values (from the application)| |
| | |PT1000-3 (15)| |Rx values over calculated values (from circuit diagram) (no table)| |
| | |NTC220 (16)| |NTC Sensor 220 kOhm type 2381 640 (interpolation points)| |
| | |NTC220 (17)| |NTC Sensor 220 kOhm type 2381 640 (about formula)| |
| |1|Contact| |Termination variant| |
| | |X5(0)| |Connection of the sensor to terminal X5|733|
| | |X6/7(1)| |Sensor connection is routed in encoder cable| |
| | |X5_X6/7(2)| |Use of both inputs possible| |
| | |X8(3)| |X8 connector temperature sensor (tech opt module)| |
| | |X5_X8(4)| |X5 and X8 connector temperature sensor (tech opt module)| |

# Table 5.7: “Temperature monitoring” parameters (continue)

MSD ServoDrive     - DeviceHelp        41

# MON_MotorI2t

I2t characteristic setting

|0|INom|%|Rated current of the motor|
|---|---|---|---|
|1|I0|%|First current interpolation point of motor protection characteristic: Maximum|
|2|I1|%|Permissible standstill current Second current interpolation point of motor protection characteristic referred to maximum|

# MSD Single-Axis Servo

# Index

|P No.|Index|P Name / Setting|Unit|Function|
|---|---|---|---|---|
|3|F1|Hz|First frequency interpolation point of motor|Sensor Parameters|
|4|FNom|Hz|protection characteristic|type|
|5|IMax|%|Rated frequency|Maximum overload current in relation to the rated current of the motor|
|6|Time|s|Time for which the maximum current may be connected| |
|7|Ttherm|s|Set thermal time constant in seconds|Motor protection module. Selection of I2T monitoring method|
|735|0|MON_MotorI2tType| | |

# Protection Settings

Off(-1) Protection disabled

FREQU(0) Motor frequency-dependent evaluation i(f),

THERM(1) default setting

Evaluation with thermal time constant iTth. The thermal time constant is set via parameter P 733[7] in [s]. The shut-off threshold based on measurement tolerances is 110% of the nominal value.

# Table 5.7: “Temperature monitoring” parameters (continue)

NOTE

- With a MSD Single-Axis Servo Drive Compact the temperature sensor cable can be connected to both X6 and X7.
- 1) (MSD Single-Axis Servo Drive Compact and MSD Servo Drive Safety require an adapter) NTC adapter - 220 kOhm available)
- 2) With MSD Single-Axis Servo Drive Compact

# Overview of Selection Options

The following table provides an overview of the selection options for sensor types with P 732[0] as well as the connection options for the plug-in connectors X5, X6, X7 and X8 (Tech. option) for MSD Servo Drive and MSD Single-Axis Servo Drive Compact.

MOOG ID No.:CB40859-001 Date:11/2020

MSD ServoDrive - DeviceHelp 42

# 5 Motor

# MOOG

ID No.: CB40859-001 Date: 11/2020

# MSD ServoDrive - DeviceHelp

# 5.5.2 I²t monitoring synchronous motor

If the I2t type is set to "THERM(1) = Thermal time constant dependent", all settings apart from the thermal time constant are disabled.

A synchronous motor by design has lower loss than an asynchronous motor, because permanent magnets replace the magnetizing current. It is normally not internally cooled, but discharges its heat loss by internal convection. For that reason a synchronous motor has a different characteristic to an asynchronous motor. It is necessary to adapt the I2t characteristic because the factory setting mostly does not exactly map the present motor.

If the integrator exceeds its limit value, the error E-09-01 is triggered. The current value of the integrator is indicated in P 701[0] - Mon_ActValues.

NOTE

- The limits are specified in Servo Drive as percentages of the rated quantities (e.g. current, torque, speed,...) of the motor. The defaults relate to 100 % of the rated quantities.

Calculation of capacity utilization via exponential function with thermal time constant of motor:

Setting of I2t type:

- P 735[0] = “FREQ(0)=Output frequency-dependent": Moog-specific i(f) evaluation
- P 735[0] = “THERM(1)=Thermal time constant-dependent”: Evaluation based on thermal time constant i(Tth)
- Thermal time constant P 733[7] - Ttherm in [s]
- The shut-off threshold is 110% (reduction in current noise)

Image 5.9: “I²T monitoring” screen for a synchronous motor

# 5.5.3 Asynchronous motor I²t monitoring

If the I2t type is set to "THERM(1) = Thermal time constant dependent", all settings apart from the thermal time constant are disabled.

The following diagram shows a typical characteristic setting for an internally cooled asynchronous motor. For third-party motors the motor manufacturer's specifications apply. It is necessary to adapt the I2t characteristic because the factory setting mostly does not exactly map the present motor. For servomotors, it is advisable to set a constant characteristic. The switch-off point defines the permissible current/time area up to switching off 150 % x IN for 120 s. If the I2xt type is set to "THERM(1) = Thermal time constant dependent", all settings apart from the thermal time constant are disabled.

Calculation of capacity utilization via exponential function with thermal time constant of motor:

# Setting of I2t type:

- P 735[0] = “FREQ(0)=Output frequency-dependent": Moog-specific i(f) evaluation
- P 735[0] = “THERM(1)=Thermal time constant-dependent”: Evaluation based on thermal time constant i(Tth)
- Thermal time constant P 733[7] - Ttherm in [s]
- The shut-off threshold is 110% (reduction in current noise)

Image 5.10: “I²T monitoring” screen for an asynchronous motor

MOOG ID No.:CB40859-001 Date:11/2020

MSD ServoDrive - DeviceHelp 44

# 5 Motor

# 5 Motor

MOOG ID No.:CB40859-001 Date:11/2020

# 5.6 Motor identification

Image 5.12: “Motor identification" screen for a linear synchronous motor

Image 5.11: “Motor identification" screen for a rotary synchronous motor

# 5.6.1 Synchronous motor identification (rotary and linear)

- Enter the motor data.
- Click "Identification" button
- Current controller tuning: optimization of the current controller is done automatically.

# 5.6.2 Asynchronous motor identification

- Current controller tuning
- Measurement of:
- P 470[0] - MOT_Rstat: Stator resistance
- P 476[0] - MOT_Rrot: Rotor resistance
- P 471[0] - MOT_Lsig: Leakage inductance
- Maximum effective current Idmax P 474[0] - MOT_LmagIdNom
- Operating point calculation:
- P 462[0] - MOT_FluxNom: Nominal flux
- P 340[0] - CON_FM_Imag: Magnetizing current
- Calculation of: current, speed and position control parameters
- Click the "Start calculation" button to determine the rotor resistance P 476[0] - MOT_Rrot and leakage inductance P 471[0] - MOT_Lsig.
- Measurement of the saturation characteristic (table values of the stator inductance P 472 - MOT_LSigDiff);

Measurements are taken up to four times rated current, provided the power stage current permits it at standstill. If this is not the case, the measurement is made using a correspondingly smaller current.

When the Rating plate data have been entered in the screen, identification is started by clicking the "Start identification" button. A safety notice must be confirmed with a tick (check mark).

**Table 5.9: “Motor identification” parameters**
|ID|Index|Name|Unit|Description|
|---|---|---|---|---|
|1531|0|SCD_Action_Sel|Self-commissioning action selection| |

MOOG ID No.:CB40859-001 Date:11/2020

MSD ServoDrive - DeviceHelp 46

# 5 Motor

MOOG ID No.:CB40859-001 Date:11/2020 MSD ServoDrive - DeviceHelp 47

# 5.7 Support for motor filters when using PMSM motors

# 5.7.1 General functional description

In applications involving high-speed drives in particular, the use of filters between the inverter output and the motor is widespread as a measure designed to attenuate current harmonics. The following two are used for this purpose:

- Motor chokes
- LC filters, also referred to as “sine wave filters”

A motor choke basically increases the stator inductance and, in the case of current-controlled drives, simply results in a higher inductive voltage consumption. Accordingly, it is not necessary to take motor chokes into account separately when calculating current setpoints.

Meanwhile, as a result of the additional capacitor current (ic) resulting from their use, sine wave filters result in a change to the current vector between the inverter output (iinv) and the motor (is). Accordingly, these filters must be taken into account when calculating current setpoints in order to ensure that the motor will be run at the desired operating point (normally with q current operation) at all speeds.

Image 5.15: Phasor diagram for a sine wave filter

Image 5.14: Single-phase equivalent circuit diagram for a sine wave filter

Current

The inverter output current is equal to the sum of the motor current (is) and capacitor current (ic). Accordingly, (ic) needs to be taken into account when calculating current setpoints. Disregarding resistances, the following applies to the capacitor current components:

isd,Cf = -2 • π • fS • Cf • usq,mot

isq,Cf = 2 • π • fS • Cf • usd,mot

# Voltage

In this case, the motor voltage for the desired current setpoint vector (isd,ref, isq,ref) is calculated using specified motor parameters LS and Psi_P as a function of stator frequency (fS):

usd,mot = -2 • π • fS • LS • isq,ref

usq,mot = 2 • π • fS • (LS • isd,ref + Psi_P)

# Dynamic performance

In addition to the described effect of motor filters on the current phasor in steady-state operation, there is also an effect on the current control circuit’s dynamic performance. Among other things, the use of a sine wave filter will result in resonances.

In order to avoid exciting oscillations, the current control circuit’s decoupling network is always deactivated when configuring the motor filter support. In addition, the current controller’s gain may have to be significantly reduced in order to achieve stability. Because of this, the use of sine wave filters is not recommended for drives that require a high dynamic performance.

Filter support can be enabled by setting P 2900[0] - MOT_Filt_Sel to one of the following settings:

|MOT_Filt_Sel|(OFF)0|
|---|---|
|No filter compensation. The current controller decoupling network will be active.|No filter compensation. The current controller decoupling network will be active.|

MOOG ID No.:CB40859-001 Date:11/2020

MSD ServoDrive - DeviceHelp 48

# 5 Motor

# Motor

MOOG ID No.:CB40859-001 Date:11/2020 MSD ServoDrive - DeviceHelp 49

MOT_Filt_Sel = (MCHOKE)1 2πfs

Has no effect on the current setpoint calculation. Instead, it just deactivates the current controller decoupling network. If necessary, the calculated motor terminal voltage components (before the voltage drop caused by the motor choke) can be viewed using scope signals usdmot_SinFilt, usqmot_SinFilt. If there are no negative influences on the current control stability, it is recommended not to use this setting. Instead, you can select MOT_Filt_Sel = 0 and add the motor choke’s inductance to the value in MOT_Lsig.

MOT_Filt_Sel = (SINFILT)2

Ensures that the capacitor current components will be calculated based on the above equations and that they will be added to current setpoint components isdref, isqref. Moreover, the current controller decoupling network will be deactivated. The calculated values of the motor terminal voltage and capacitor current components can be viewed with scope signals usdmot_SinFilt, usqmot_SinFilt and isdpre_SinFilt, isqpre_SinFilt respectively.

Image 5.17: Diagram of additive current setpoint calculation for sine wave filters

# 5.7.3 Parameters

|ID|Index Name|Unit|Description|
|---|---|---|---|
|462|0|MOT_FluxNom|Vs|
|471|0|MOT_Lsig|mH|
|2900|0|MOT_Filt_Sel|Motor filter: selector|
|2901| |MOT_Filt_Para|Motor filter: Settings|
|2901|0|L_Filt|mH Motor filter: Choke or filter inductance|
|2901|1|C_Filt|nF Motor filter: Capacitance (delta configuration)|

Table 5.10: “Motor filter” parameters

# NOTE

Filter capacitance P 2901[1] - C_Filt is specified as the capacitance value of the capacitors when using a delta configuration! In order to calculate the capacitance per phase as per the circuit diagram above, the device will internally multiply the value by 3 (delta-wye transform). If the capacitors are connected in a wye configuration, or if the capacitance of the single-phase equivalent circuit is known, the corresponding capacitance value must first be divided by 3 and then entered into the parameter.

# 5.7.4 Scope signals

|ID|Index|Name|Unit|Description|
|---|---|---|---|---|
|2500|0|isdpre_SinFilt|A|Calculated filter capacitor current d components (isdCf in the formula above)|
|2501|0|isqpre_SinFilt|A|Calculated filter capacitor current q components (isqCf in the formula above)|
|2502|0|usdmot_SinFilt|V|Calculated motor terminal voltage d components|
|2503|0|usqmot_SinFilt|V|Calculated motor terminal voltage q components|

Table 5.11: “Motor filter” scope signals

MOOG ID No.:CB40859-001 Date:11/2020 MSD ServoDrive - DeviceHelp 50

# 5 Motor

# Chapter overview

# 6 Encoder

# 6.8 Channel 4: Virtual encoder

90

# 6.9 Redundant encoder

100

# 6.10 Axis correction

100

# 6.11 Oversampling

104

# 6.12 Multi-turn encoder as a single-turn encoder

104

# 6.13 Increment-coded reference marks

105

# 6.14 Overflow in multi-turn range

106

# 6.15 Zero pulse test

107

# Navigation

►Project tree ►Device setup ►Encoder

# Brief description

This chapter describes...

1. ... how to select an encoder channel for each of the following control levels (channel selection):
- MCON (commutation and torque control)
- SCON (Speed control)
- PCON (Position control).
2. ... the encoder selection options for individual encoder channels Ch1 – Ch4 (type selection).

# Contents

1. 6.1 Introduction - 52
2. 6.2 Encoder selection - 53
3. 6.3 Encoder offset - 55
4. 6.4 Connections and pin assignations - 55
5. 6.5 Channel 1: Interface X7 - 59
6. 6.6 Channel 2: Interface X6 - 72
7. 6.7 Channel 3: Interface X8 (optional) - 76

MOOG ID No.:CB40859-001 Date:11/2020

MSD ServoDrive - DeviceHelp 51

# 6 Encoder

MOOG ID No.:CB40859-001 Date:11/2020

MSD ServoDrive - DeviceHelp 52

# 6.1 Introduction

The MSD Servo Drive groups individual encoders (supported encoder interfaces) into what are referred to as “encoder channels”. Within each encoder channel, a maximum of one encoder can be active at any one time, meaning that the number of encoder channels also defines the maximum number of encoders that can be active simultaneously. The encoder channels are Ch1, Ch2, Ch3 and Ch4.

To select a specific encoder for a control level (e.g. for speed control), you must first select an encoder channel for that control level, after which you will be able to select a specific encoder for the selected channel.

The supported encoder interfaces are distributed among the four encoder channels as follows:

- Ch1: X7 (Sin/Cos, TTL, cyclical SSI, cyclical EnDAT, etc.) (see Section "Channel 1: Interface X7" on page 59)
- Ch2: X6 (resolver, low-frequency Sin/Cos input as well if applicable)
- Ch3: X8 (various option modules, including, but not limited to, various encoder modules) (see Section "Channel 3: Interface X8 (optional)" on page 76)
- Ch4: Virtual encoder

# 6.1.1 Limiting for EnDat and SSI

“Cyclical EnDat" means a cyclical, purely digital EnDat evaluation without Sin/Cos signal evaluation.

On the MSD Servo Drive, EnDat and SSI can be selected simultaneously only once. Even though there is an additional option for EnDat/SSI at X8, the following cannot be operated simultaneously on the MSD Servo Drive:

- two EnDat encoders
- or two SSI encoders

# 6.1.2 Encoder gearing

The encoder gearing is an integral part of the encoder evaluation system. Whenever, for example, the “Ch1 encoder position” is described below, it already includes the encoder gearing. The relevant encoder position is always delivered together with the encoder gearing ratio to the mechanisms in charge of further processing in the Servo Drive.

The encoder gearing can be used, for example, to make adjustments if the encoder is a motor encoder (commutation encoder) but is not directly on the motor shaft: In this case, it would be necessary to make an adjustment to the pure encoder position in line with the motor’s commutation (pole pair subdivision). In the case of linear motor drives, for instance, this adjustment is required without fail.

The encoder gearing can also be used, for instance, to perform initial scaling for the position as required for the actual application: For example, in cases in which the encoder is not the motor encoder (i.e. in which it is not needed as a commutation encoder), but just a field encoder (another encoder in the field).

For more details regarding the encoder gearing, see Section "Encoder gearing" on page 89.

# 6.1.3 Actual values at the encoder channel outputs

The relevant encoder positions will be delivered at the encoder channel outputs to the mechanisms in charge of further processing in the Servo Drive. At these points, the actual value will be passed to one parameter per encoder channel.

# 6.2 Encoder selection

Speaking, these actual encoder channel values are not actual position values (in terms of position control), these parameters are assigned to the “Encoder” screen and not the “Actual values” screen.

The parameters for the actual values at the encoder channel outputs are used for indication purposes only and are...

- P 500 - ENC_CH1_ActVal for Ch1
- P 501 - ENC_CH2_ActVal for Ch2
- P 502 - ENC_CH3_ActVal for Ch3
- P 503 - ENC_CH4_ActVal for Ch4

The parameters are field parameters with...

- Index 0 (single-turn component) and
- Index 1 (multi-turn component)

Image 6.1: Encoder channel selection screen

The MSD Servo Drive’s control is subdivided into three levels...

- MCON (Commutation and Torque control)
- SCON (Speed control)
- PCON (Position control).

This screen is used to select the encoder channel for each of the control levels.

MOOG ID No.:CB40859-001 Date:11/2020

MSD ServoDrive - DeviceHelp 53

# 6 Encoder

MOOG ID No.:CB40859-001 Date:11/2020

# MSD ServoDrive - DeviceHelp

To assign the encoder channel for...

- Commutation and torque control, use P 520[0] - ENC_MCon
- Speed control, use P 521[0] - ENC_SCon
- Position control, use P 522[0] - ENC_PCon

For the encoder for commutation and torque control, P 349[0] - CON_FM_MConOffset can be used to set an offset. For details see Section "Encoder offset" on page 55.

Once you select an encoder channel for a control level, you can click on the “Options...” button to access the encoder selection menu for that encoder channel. You can use the lines underneath each selection field to enter your own information for describing the respective encoder channels (maximum of 31 characters). This information will be stored in...

- P 555[0] - ENC_CH1_Info for commutation and torque control
- P 564[0] - ENC_CH2_Info for speed control
- P 580[0] - ENC_CH3_Info for position control

**Table 6.1: Encoder channel selection parameters**
|P No.|Index|Name|Unit|Description|
|---|---|---|---|---|
|520|0|ENC_MCon| |Selection of encoder channel for commutation angle|
|521|0|ENC_SCon| |Selection of encoder channel for speed control|
|522|0|ENC_PCon| |Selection of encoder channel for position control|
|555|0|ENC_CH1_Info| |Encoder information Channel 1|
|564|0|ENC_CH2_Info| |Encoder information Channel 2|
|580|0|ENC_CH3_Info| |Encoder information Channel 3|

NOTE

- When you select a specific encoder with the “Options..." button, wire break monitoring will be enabled if the encoder and the encoder interface support wire break monitoring.

# 6.3 Encoder offset

“Encoder offset” refers to the commutation offset. This offset is the angular offset between the motor’s electromechanical layout (U phase orientation) and the zero position of the commutation encoder (depends on the encoder’s position and alignment on the motor shaft) in “electrical degrees”. If the encoder’s zero position is aligned with the direction of the motor’s U phase, the commutation offset is 0 degrees.

The “Encoder selection” screen (see Section "Encoder selection" on page 53) will show the currently set commutation offset as the “encoder offset” based on the encoder used for the “commutation and torque control" (MCON) control level. To determine the offset value again, click on the “Detect” button. In order for this function to work correctly, the selected encoder for “commutation and torque control” must be the motor encoder (commutation encoder).

The process takes about 10 seconds. Then the current value of the offset is entered in the P 349[0] - CON_FM_MConOffset and the original parameter setting is restored. In order to store the commutation offset in the device in a non-volatile manner, the device setting must be stored in non-volatile memory.

It is not necessary to determine the commutation offset for standard Moog motors, as the encoders are aligned. In the case of third-party motors that are not aligned, the commutation offset needs to be determined with the help of a wizard. For the definition, the motor is run in "Current control" mode (at rated current). For a correct definition, it is necessary for the motor to be able to align itself freely. A connected brake is automatically vented, provided it is connected to the brake output and the output has been configured for use of a brake.

# 6.4 Connections and pin assignations

NOTE

- This section only lists the most important connectors and pinouts so as to make commissioning easier.
- For a full description of the encoder connectors (designation, position, pinout, function) for correctly installing the devices, see the “Encoder connection” chapter in the Operation Manual MSD Servo Drive Single-Axis System (ID No.: CA65642-001), Operation Manual MSD Servo Drive Multi-Axis System (ID No.: CA97554-001), Operation Manual MSD Single-Axis Servo Drive Compact (ID No.: CA97555-001), and the MSD Servo Drive Specification on functional safety in the case of Servo Drives with an “integrated safety control” design (ID No.: CB38398-001).
- Please note that the pinouts for evaluating the zero pulse for the MSD Servo Drive and MSD Single-Axis Servo Drive Compact are different from each other.
- If your Servo Drive comes with a technology option with an encoder function (X8 connector), see the corresponding Specification for a description of the encoder connections (see Section "Applicable documentation" on page 12).

NOTE

The current used to determine the encoder offset (commutation offset) is specified by P 457[0] - MOT_CNom. This value should be reduced if the acceleration has too much jerk.

MOOG ID No.:CB40859-001 Date:11/2020

MSD ServoDrive - DeviceHelp 55

# 6 Encoder

# MOOG

ID No.: CB40859-001 Date: 11/2020

# MSD ServoDrive - DeviceHelp

6.4.1 Connector for resolver (X6)

6.4.2 Connector for high-resolution encoders (X7)

CAUTION! Damage to the device as a result of incorrect motor winding insulation! Improper conduct can lead to damage to the motor/device.

Note:

- Please note that the pinouts for the MSD Servo Drive and MSD Single-Axis Servo Drive Compact are different from each other!

The motor temperature sensor must have basic insulation to the motor winding when connected to X5 and reinforced insulation to IEC/EN 61800-5-1 when connected to X6 or X7.

**Table 6.2: Pin assignment X6 (MSD Servo Drive and MSD Single-Axis Servo Drive Compact)**
|Pin|Function|
|---|---|
|1|Sin+ / (S2) analog differential input Track A|
|2|REFSIN / (S4) analog differential input Track A|
|3|Cos+ / (S1) analog differential input Track B|
|4|5–12 V supply voltage, internally connected to X7/3|
|5|ϑ+ (PTC, NTC, KTY, Klixon) 1)|
|6|Ref+ analog excitation|
|7|Ref- analog excitation (ground for pin 6 and pin 4)|
|8|REFCOS / (S3) analog differential input Track B|
|9|ϑ- (PTC, NTC, KTY, Klixon) 2) 3)|

1) Internally connected to X7/10 in MSD Single-Axis Servo Drive Compact.

2) Internally connected to X7/9 in MSD Single-Axis Servo Drive Compact.

3) NTC for MSD Single-Axis Servo Drive Compact with adapter only.

# Sin/Cos- Absolute

CAUTION! Damage to the device as a result of incorrect motor winding insulation! Improper conduct can lead to damage to the motor/device.

The motor temperature sensor must have basic insulation to the motor winding when connected to X5 and reinforced insulation to IEC/EN 61800-5-1 when connected to X6 or X7.

+5 VDC ±5%, IOUT max = 250 mA 7 to 12 V (150 mA for hardware versions 0–1), (typically 11 V) monitoring via sensor cable 1) maximum 100 mA 1)

|Abb.|Pin|Sin/Cos|Absolute encoder,|Absolute value|EnDat sender|TTL (digital)|HIPERFACE®|
|---|---|---|---|---|---|---|---|
|1|A-|SSI/EnDat| |A-|-|REFCOS| |
|2|A+| | |A+|-|+COS| |
|3| | | | |Data +|Data +| |
|4| | | | |Data -|Data -| |
|5|B -| | |-|REFSIN| | |
|6| | | |-|US - Switch 2)| | |
|7| | | |-|GND|GND|GND|
|8| | | |-|GND| | |
|9|R-| | |-| | | |
|10|R+| | |-| | | |
|11|B+|B+| |-|+SIN| | |
|12|Sense +|Sense +|Sense +| |US - Switch 2)| | |
|13|Sense -|Sense -|Sense -| | | | |
|14|-|CLK+|CLK+| | | | |
|15|-|CLK -|CLK -| | | | |

1) The total of the currents drawn at X7/3 and X6/4 must not exceed the specified value!

2) After connecting pin 7 to pin 12, a voltage of 11.8 V will appear at X7, pin 3!

Table 6.3: Pin assignment X7 (MSD Servo Drive)

MOOG ID No.:CB40859-001 Date:11/2020 MSD ServoDrive - DeviceHelp 57

# 6 Encoder

# 6 Encoder

MOOG ID No.:CB40859-001 Date:11/2020

# MSD ServoDrive - DeviceHelp

|Abb.|Pin|Sin/Cos and Absolute encoder, TTL sender (digital)|Absolute value|EnDat encoder, HIPERFACE®|
|---|---|---|---|---|
|1|A-|A-|-|REFCOS|
|2|A+|A+|-|+COS|
|3|+5 VDC ±5%, IOUT max = 250 mA|(150 mA for hardware versions 0–1), monitoring via sensor cable|1) The total of the currents drawn at X7/3 and X6/4 must not exceed the specified maximum value!|2) After connecting pin 7 to pin 12, a voltage of 11.8 V will appear at X7, pin 3!|
|4|R+|Data +|Data +|Data +|
|5|R-|Data -|Data -|Data -|
|6|B -|B -|-|REFSIN|
|7|-|-|-|U - Switch|
|8|GND|GND|GND|GND|
|9|ϑ- (PTC, KTY, Klixon), internally connected to X6/9|3)| | |
|10|ϑ+ (PTC, KTY, Klixon), internally connected to X6/5|3)| | |
|11|B+|B+|-|+SIN|
|12|Sense +|Sense +|Sense +|US - Switch|

Table 6.4: Pin assignment X7 (MSD Single-Axis Servo Drive Compact)

# 6.5 Channel 1: Interface X7

Select from database

Clicking on this button will open a menu that can be used to select encoders. The data sets for Moog encoders will already be available there by default.

# Encoder name

You can use this field to enter your own information for describing the encoder (maximum 31 characters) (P 555[0] - ENC_CH1_Info).

# Cyclic position via

This drop-down menu is used to select the “main interface” (P 505[0] - ENC_CH1_Sel).

# Pulses per revolution

Once SINCOS(1), TTL(3) or HALL(5) is selected as the “main interface,” this field will appear so that you can enter the number of analog Sin/Cos lines per revolution (TTL lines as well).

# Image 6.2: Encoder configuration Channel Ch1 (Interface X7) screen

# Absolute interface

This screen is used to select the encoder for channel Ch1. This channel uses the encoder’s “main interface” to measure position changes periodically and add them up cyclically – this is referred to as “cyclical evaluation”.

Encoders with a main interface that only makes it possible to measure the cyclical position incrementally often feature an additional absolute value interface referred to as an “auxiliary interface”. For this interface, the absolute position is measured once during the initialization phase and is then used for absolute value initialization purposes.

# NOTE

l Selecting an “auxiliary interface” is redundant if, for example, SSI (2) is selected as the “main interface” (corresponds to cyclical evaluation via SSI). In this case, the absolute value initialization will also be carried out via the SSI interface, regardless of the selected “auxiliary interface”.

# Gear ratio

These fields can be used to define a gear ratio for the encoder (in the output side). For details see Section "Encoder gearing" on page 89.

MOOG ID No.:CB40859-001 Date:11/2020

MSD ServoDrive - DeviceHelp 59

# 6 Encoder

# 6 Encoder

MOOG ID No.:CB40859-001 Date:11/2020

# Signal correction (GPOC)

GPOC is a special Moog online process for improving the quality of Sin/Cos signals before they are used to calculate a position. If “SINCOS(1)” is selected as the “main interface,” this process may be useful. For details see Section "Signal correction GPOC (Gain Phase Offset Correction)" on page 74.

|P No.|Index|Name / Settings|Unit|Description|
|---|---|---|---|---|
|505|0|ENC_CH1_Sel| |Encoder type selection|
| | |OFF (0)| |Function disabled|
| | |SINCOS(1)| |Sin/Cos encoder|
| | |SSI(2)| |Digital SSI encoder|
| | |TTL(3)| |TTL encoder|
| | |EnDat(4)| |Digital EnDat encoder (2.1 or 2.2)|
| | |HALL(5)| |Digital Hall sensor|
|540|0|ENC_CH1_Abs| |Absolute position interface selection|
| | |OFF (0)| |No additional absolute value interface|
| | |SSI(1)| |SSI interface|
| | |ENDAT(2)| |EnDat interface|
| | |HIPER(3)| |HIPERFACE® interface|
| | |SSI_CONT(4)| |SSI-interface with 1ms continuous clock|
|555|0|ENC_CH1_Info| |Encoder information|

# 6.5.1 Main parameters for encoder channel Ch1

The following table lists the most important parameters for the Ch1 encoder channel. These parameters are then described in the chapters for selecting a special encoder with P 505[0] - ENC_CH1_Sel and P 540[0] - ENC_CH1_Abs.

- Some of the parameters are self-explanatory, such as Lines, MultiT and SingleT.
- Code and Mode are used to set SSI modes. If Mode=1, wire break monitoring (if any) will be disabled, for example. If Mode = 0, it will be enabled instead (default).
- In the case of linear encoders, PeriodLen and DigitalResolution will be needed instead of MultiT and SingleT.

|P No.|Index|Name / Setting|Unit|Description|
|---|---|---|---|---|
|505|0|ENC_CH1_Sel| |Main selection on encoder channel Ch1|
|540|0|ENC_CH1_Abs| |Absolute value interface for one-time reading|
|542|0|ENC_CH1_lines| |Number of analog Sin/Cos lines per revolution|
|543|0|ENC_CH1_MultiT| |(TTL lines as well)|
|544|0|ENC_CH1_SingleT| |Number of multi-turn bits for the digital interface|
|545|0|ENC_CH1_Code| |Number of single-turn bits for the digital interface|
|546|0|ENC_CH1_Mode| |Code selection (for SSI encoders) (binary, Gray)|
|547|0|ENC_CH1_MTBase| |Mode selection (for SSI encoders) Definition of point of discontinuity in multi-turn|
|548|0|ENC_CH1_MTEnable| |Enable MultiTurn use (negative logic, 1=MToff)|
|551|0|ENC_CH1_EncObsMin| |Comparison value for Sin/Cos wire break monitoring|
|553|0|ENC_CH1_PeriodLen|nm|Linear encoders: Length of an analog Sin/Cos segment in nm (nanometres)|
|554|0|ENC_CH1_|nm|Linear encoders: Length of a digital increment in|
|616|0|DigitalResolution|nm|(nanometres)|
| | |ENC_CH1_CycleCount| |Sampling cycle in: n x 125 μ (microseconds)|

MTBase, when used with its default setting, will ensure that the absolute value initialization “starts up with plus-minus”: I.e. the encoder’s multiturn value range from 0 to max will be mapped to -1/2max to +1/2max; the second half of the measuring range will be initialized as negative; in this case, the point of discontinuity will be found at 1/2max. --- This can be changed with MTBase! --- When MTBase=0, the absolute value initialization will, for example, “start up with zero to max”: I.e. the

encoder’s multi-turn value range from 0 to max will be mapped to 0 to max; the second half of the measuring range will be initialized as positive; in this case, the point of discontinuity will be found at 0.

If you set MTEnable to 1, you can use an available multi-turn encoder as a single-turn encoder (this is only needed for testing purposes).

If you set EncObsMin to 0, Sin/Cos wire break monitoring will be disabled. The default value is 0.2 (20%) and stands for a calculated amplitude value (calculated using the two Sin/Cos signals) of x = sqrt(a2 + b2). If the Sin/Cos signals are equal to approx. 1 Vss when compared, approx. 0.8 will be calculated here (approx. 80% magnitude at the A-D converters; approx. 0.25 Vss Sin/Cos will yield approx. 0.2 here (20% magnitude at the A-D converter)). The error threshold can be set with EncObsMin within a broad range.

NOTE

- As there are various protocol modes available for SSI encoders (with/without wire break monitoring, with/without parity bit, etc.), consult with your project supervisor or the Helpline provided by Moog before using any special SSI protocol modes.

# 6.5.2 EnDat (cyclical) X7

Ch1: ENDAT(4) - Cyclical EnDat (2.1 or 2.2) EnDat is a digital encoder interface developed by HEIDENHAIN. For more details, please visit www.heidenhain.de and go to ►Documentation ►Fundamentals ►Interfaces ►EnDat 2.2.

The software versions required to run the EnDat encoder interface are the standard software versions for the MSD Servo Drive and MSD Single-Axis Servo Drive Compact.

MOOG ID No.:CB40859-001 Date:11/2020

# 6 Encoder

NOTE

- Please note the limitations that apply when running EnDat and SSI encoders (see Section "Limiting for EnDat and SSI" on page 52).

When using linear encoders, P 554[0] - ENC_CH1_DigitalResolution is used instead of P 543[0] - ENC_CH1_MultiT and P 544[0] - ENC_CH1_SingleT (which are used for rotary encoders). The values will be read from the EnDat encoder and written to the aforementioned parameters.

- P 543[0] - ENC_CH1_MultiT
- The number "n" of multiturn bits defines the measuring range in 2n increments per encoder shaft revolution; maximum travel until overflow; maximum travel within which the absolute value initialization can be unambiguous. In the case of single-turn encoders, MultiT = 0.
- P 544[0] - ENC_CH1_SingleT
- The number "n" of single-turn bits corresponds to the encoder’s digital resolution in 2n increments per encoder shaft revolution.
- P 554[0] - ENC_CH1_DigitalResolution
- This is the length of an increment, in nanometres, of the encoder’s digitally transmitted position value. This value is read from the EnDat linear head.

In the case of linear encoders, the number n of transmitted position bits from the encoder will be found in SingleT only! 2n * DigitalResolution yields the maximum travel in nanometres (for the encoder head).

P 640 - ENC_ENDAT is intended for additional information, but is normally not needed. This parameter does not have a Ch1 or Ch3 prefix for the encoder channel in the name, as it applies to both encoder channels. Although usually not needed, the parameter is helpful or required in the following cases:

1. Special EnDat encoder with diagnostics for evaluation
In this case, the valuation numbers from the encoder are read cyclically via additional information. Only the valuation numbers that the encoder supports.

# 6 Encoder

MOOG ID No.:CB40859-001 Date:11/2020

will be read. During the initialization process, the system will read the encoder to determine which valuation numbers it supports. When P 640[0] - ENDAT_Select = 1, the function will be enabled in the controller and the internal diagnostics in the EnDaT encoder will be enabled as well. The EnDat encoder will keep this setting even after being powered off. To explicitly disable the internal diagnostics in the EnDat encoder, set P 640[0] - ENDAT_Select to 2.

# 2. Evaluation of internal warnings

In this scenario, certain internal warnings from the encoder will be read from the encoder via additional information. Only the warnings that both the encoder and the Servo Drive’s software support will be read. During the initialization process, the system will read the encoder to determine which warnings it supports. When P 640[0] - ENDAT_Select = 3, the function will be enabled in the controller.

**Table 6.7: Channel 1 encoder configuration (X7) - EnDat parameters**
|ID|Index Name|Unit|Description|
|---|---|---|---|
|505|0 ENC_CH1_Sel|= ENDAT(4)| |
|543|0 ENC_CH1_MultiT|Number of MultiTurn bits (absolute encoder)| |
|544|0 ENC_CH1_SingleT|Number of SingleTurn bits (absolute encoder)| |
|547|0 ENC_CH1_MTBase|Definition of point of discontinuity in multi-turn range| |
|548|0 ENC_CH1_MTEnable|1: Use Multi-turn encoder as a single-turn encoder| |
|616|0 ENC_CH1_CycleCount|Position encoder sampling cycle (n x 125 μsec)| |
|598|0 ENC_CH1_Position|inc|Position encoder channel 1|
|554|0 ENC_CH1_|nm|Length of one increment (linear absolute encoder)|
|640|ENC_ENDAT| |EnDat additional (additional information)|
|640|0 ENDAT_Select|0=off|EnDat function selection, 1/2=diagnosis on/off, 3=warnings, FF=lock|
|640|1 ENDAT_DiagCount|u16|count new diagnosis block header|
|640|2 ENDAT_BWZ_1|lowbyte|vn1: incremental track|
|640|3 ENDAT_BWZ_3|lowbyte|vn3: absolute track|
|640|4 ENDAT_BWZ_4|lowbyte|vn4: position value formation|
|640|5 ENDAT_Status| |EnDat additional status output|
|640|6 ENDAT_Z1_Sel| |EnDat additional information 1 type selection|

**Table 6.7: Overwrite Channel 1 encoder configuration (X7) - EnDat parameters (continue)**
|ID|Index Name|Unit|Description|
|---|---|---|---|
|640|7 ENDAT_Z1_1| |Z1 info: dword 1|
|640|8 ENDAT_Z1_2| |Z1 info: dword 2|
|640|9 ENDAT_Z1_3| |Z1 info: dword 3|
|640|10 ENDAT_Z1_4| |Z1 info: dword 4|
|640|11 ENDAT_Z2_Sel| |EnDat additional information 2 type selection|
|640|12 ENDAT_Z2_1| |Z2 info: dword 1|
|640|13 ENDAT_Z2_2| |Z2 info: dword 2|
|640|14 ENDAT_Z2_3| |Z2 info: dword 3|
|640|15 ENDAT_Z2_4| |Z2 info: dword 4|
|640|16 ENDAT_Mode1|0=off|EnDat additional mode 1 selection|
|640|17 ENDAT_Mode2| |EnDat additional mode 2 selection|
|640|18 ENDAT_Mode3| |EnDat additional mode 3 selection|
|640|19 ENDAT_Mode4| |EnDat additional mode 4 selection|
|640|20 ENDAT_res1| |reserved 1|
|640|21 ENDAT_res2| |reserved 2|
|640|22 ENDAT_res3| |reserved 3|
|640|23 ENDAT_HwSyncStop|0=SyncOn|EnDat cyclic hw sync, stop/start 1/0|
|640|24 ENDAT_CyclCount| |call counter of cyclic function|
|640|25 ENDAT_BWZ_Supported| |vn supported (bit3=vn4, bit2=vn3, bit0=vn1)|
|640|26 ENDAT_BWZ1_| |vn1: bits[7..0] threshold level, bits[31..16]|
|640|27 ThresholdLevel| |how often number|
|640|28 ENDAT_BWZ3_| |vn3: bits[7..0] threshold level, bits[31..16]|
|640|29 ThresholdLevel| |how often number|
|640|30 ENDAT_BWZ4_| |vn4: bits[7..0] threshold level, bits[31..16]|
|640|31 ThresholdLevel| |how often number|
|640|32 ENDAT_BWZ_TEST_| |vn: bits[15..12] 'F', bits[11..8] vn.no., bits [7..0] vn overwrite value|

# 6.5.3 Hall sensor X7

Ch1: HALL(5) - Digital hall signals

Ch1: HALL_TTL(7) - Digital hall signals

NOTE

l The operation and configuration of Hall effect sensors is reserved for special applications. Consult with Moog if needed.

# 6.5.4 Sin/Cos / TTL X7

# 6.5.4.1 TTL encoder

Ch1: TTL(3) - TTL signals

TTL encoders are ...

- a. ... ... usually pure incremental encoders without an absolute value interface.
- b. In this case, P 540[0] - ENC_CH1_Abs must be set to OFF(0). ... ... in a few exceptional cases, incremental encoders with an SSI absolute value interface. In this case, P 540[0] - ENC_CH1_Abs must be accordingly set to SSI(1) (SSI_CONT(4) in special cases), so that it will be possible to read the absolute encoder position for the absolute value initialization routine once during the initialization phase.

# 6.5.4.1.1 Pure TTL incremental encoder

Set P 505[0] - ENC_CH1_Sel to TTL(3) and P 540[0] - ENC_CH1_Abs to OFF(0) when using pure TTL encoders, i.e. encoders without an absolute value interface but with a TTL zero pulse.

Linear TTL encoders are run as rotary encoders. For linear motor operation, P 542 [0] - ENC_CH1_Lines and the encoder gearing (see the “Encoder gearing” section) are used to establish the ratio for the linear motor’s pole pair subdivision (North-North) for commutation. 1 x North-North corresponds to one revolution from Lines. In this case, the motor pole pair number must be set to 1. Moreover, P 553[0] - ENC_CH1_PeriodLen is not used in this case.

The TTL interface accepts various TTL signal types, which can be selected using P 558[0] - ENC_CH1_TTL_SignalType:

- (0)AF_B - A/B tracks (forward counting, X4 encoding) - AB
- (1)AR_B - A/B tracks (reverse counting, X4 encoding) - AB_inv
- (2)ABDFN - A: Clock (falling edge), B: Direction (1 = positive) - PulseDir
- (3)ABDRP - A: Clock (rising edge), B: Direction (1 = negative) - PulseDir_inv
- (4)reserved

A maximum interpolation period, in ms (milliseconds), can be configured for the TTL interface using P 601[0] - ENC_CH1_Period. Within this context, Period is the maximum time of “no activity” since the last TTL counter event:

- Period = 0: Function disabled (default)
- Period > 0 (=n ms): If no counter event is registered in n ms, the speed will be set to 0.

# Zero pulse

There is no parameter for activating the zero pulse evaluation here, as this evaluation is controlled exclusively based on the homing mode (see Section "Homing" on page 249). However, setting P 541[0] - ENC_CH1_NpTest to 1 provides a test mode that can be used during commissioning in order to be able to activate the zero pulse evaluation even without homing. Scope signals 1014 and 1016 can be used to view a received zero pulse within this context. This test mode must be disabled during normal operation (P 541[0] = 0).

# Commutation

Motor operation with pure incremental encoders needs for the auto commutation function to be enabled without fail. For details see Section "Synchronous motor auto commutation" on page 156.

# 6.5.4.1.2 TTL incremental encoder with SSI absolute value interface

See Section "Sin/Cos incremental encoders with absolute value interface" on page 65 and in special Section "SSI absolute value interface" on page 67.

MSD ServoDrive - DeviceHelp

# 6 Encoder

MOOG ID No.:CB40859-001 Date:11/2020 MSD ServoDrive - DeviceHelp 64

|ID|Index Name|Unit|Description|
|---|---|---|---|
|505|0|ENC_CH1_Sel = 3|Encoder selection set to TTL(3)|
|510|0|ENC_CH1_Num|Encoder gearing: Numerator Ch1: SINCOS(1) - Sin/Cos signals|
|511|0|ENC_CH1_Denom|Encoder gearing: Denominator|
|540|0|ENC_CH1_Abs|Selection of absolute value interface Sin/Cos encoders can ...|
|541|0|ENC_CH1_NpTest|ENC CH1, TEST-MODE: Index pulse signal(s) to Scope|
|542|0|ENC_CH1_lines|Number of lines (Sin/Cos / TTL encoders) a. Be pure incremental encoders without an absolute value interface. In this|
|558|0|ENC_CH1_TTL_SignalType|Channel 1: TTL signal selection case, P 540[0] - ENC_CH1_Abs must be set to OFF(0).|
|601|0|ENC_CH1_Period|Maximum period of interpolation (TTL encoder)|
|616|0|ENC_CH1_CycleCount|Sampling cycle in: n x 125 μ (microseconds) b. Be incremental encoders with an absolute value interface. In this case,|

Table 6.8: Parameters for Channel 1 (X7) - TTL encoder

ENC_CH1_Abs must be accordingly set to SSI(1), EnDat(2), HIPER(3) or, in special cases, SSI_CONT(4) so that it will be possible to read the absolute encoder position for the absolute value initialization routine once during the initialization phase.

# 6.5.4.2.1 Purely Sin/Cos incremental encoders

To run these encoders as purely incremental encoders with a zero pulse on encoder channel Ch1 (without an absolute value interface), the approach is basically the same as for purely TTL operation (see Section "TTL encoder" on page 63). The same parameters apply.

However, there are the following differences:

- a. There are no different signal types for the Sin/Cos signal (always 1 Vss for cosine and sine).
- b. The zero pulse is the analog zero pulse typical of Sin/Cos encoders (see the “Connection for high-resolution encoders” section in the operation manual MSD Servo Drive Single-Axis System, for example).

# 6.5.4.2.2 Linear Sin/Cos

|ID|Index Name|Unit|Description|
|---|---|---|---|
|542|ENC_CH1_lines| |Number of Lines (Sin/Cos / TTL encoders)|
|543|ENC_CH1_MultiT| |Number of MultiTurn bits (absolute encoder)|
|544|ENC_CH1_SingleT| |Number of SingleTurn bits (absolute encoder)|
|545|ENC_CH1_Code| |Code selection (SSI encoder) (binary, gray)|
|546|ENC_CH1_Mode| |Mode selection (SSI encoder)|
|547|ENC_CH1_MTBase| |Definition of point of discontinuity in multi-turn range|
|548|ENC_CH1_MTEnable| |Enable MultiTurn use (negative logic, 1=MToff)|
|549|ENC_CH1_Corr| |Signal correction type|
|550|ENC_CH1_CorrVal|0-4|Signal correction values|
|551|ENC_CH1_EncObsMin| |Encoder monitoring minimum, sqrt(a^2+b^2)|
|552|ENC_CH1_AbsEncStatus| |Error and status codes (absolute encoder)|

# 6.5.4.2.3 Signal correction (GPOC)

|ID|Index Name|Unit|Description|
|---|---|---|---|
|553|ENC_CH1_PeriodLen|nm|Length of signal period (Sin/Cos linear encoder)|
|554|ENC_CH1_DigitalResolution|nm|Length of one increment (linear absolute encoder)|
|555|ENC_CH1_Info| |Encoder information|
|616|ENC_CH1_CycleCount| |Sampling cycle in: n x 125 μ (microseconds)|
|610|ENC_CH1_NominalIncrementA| |Sign. Nominal increment A (distance coded abs. per. encoder)|
|611|ENC_CH1_NominalIncrementB| |Sign. Nominal increment B (distance coded abs. per. encoder)|
|1900|ENC_ETS| |ETS mode, electronic nameplate|

# 6.5.4.2.4 Sin/Cos incremental encoders with absolute value interface

The following table lists the parameters for cyclical Sin/Cos operation on encoder channel Ch 1 with one-time reading of the absolute encoder position via the absolute value interface, i.e. without a zero pulse:

|ID|Index Name|Unit|Description|
|---|---|---|---|
|505|ENC_CH1_Sel|1|Encoder selection set to SINCOS(1)|
|510|ENC_CH1_Num| |Encoder gearing: Numerator|
|511|ENC_CH1_Denom| |Encoder gearing: Denominator|
|540|ENC_CH1_Abs| |Absolute value interface selection (one-time reading)|

Table 6.9: Parameters for channel 1 (X7) - Sin/Cos encoder

The Sel, Num, Denom, Abs, Lines, MultiT, SingleT and CorrVal parameters are self-explanatory.

The Code and Mode parameters are described in Section "SSI (cyclical) X7" on page 69.

P 547[0] - ENC_CH1_MTBase = Minimum MultiTurn position

The MTBase parameter is used to set a position in the multi-turn encoder’s travel path that defines the point of discontinuity (overflow/underflow) for the absolute value initialization (that is, the “multi-turn basis”). Assuming a bipolar encoder measuring range, all position values that fall below MTBase will be shifted “up” (the whole MT range will be added to them once).

MOOG ID No.:CB40859-001 Date:11/2020

MSD ServoDrive - DeviceHelp

# 6 Encoder

MOOG ID No.:CB40859-001 Date:11/2020

method makes it possible to place the point of discontinuity at any point within the encoder’s entire measuring range. By default, MTBase will be set to the lowest possible value for the parameter, i.e. reliably outside of the encoder’s value range: In this case, the full bipolar range will remain unaffected, as values will never fall below this MTBase threshold (see Section "Channel 1: Interface X7" on page 59).

- P 548[0] - ENC_CH1_MTEnable = MultiTurn as SingleTurn
- The MTEnable parameter makes it possible to use multi-turn encoders as single-turn encoders for test purposes. Negative logic: Default MTEnable = 0 means "MultiTurn-Enable ON".

P 549[0] - ENC_CH1_Corr = Signal correction type
- The GPOC routine used for track signal correction purposes for sine/cosine signals is used to compensate for systematic errors. The routine is controlled with the Corr and CorrVal parameters (see Section "Signal correction GPOC (Gain Phase Offset Correction)" on page 74).

P 551[0] - ENC_CH1_EncObsMin = Encoder monitoring minimum, sqrt (a^2+b^2)
- The parameter EncObsMin is used to scale the Sin/Cos wire break monitoring and represents the “downwards threshold” for an error message. The default setting is 0.2, corresponding to approx. 20% of the track signals’ amplitude (approx. 80% corresponds to approx. 1 Vss). If EncObsMin is set to 0, Sin/Cos wire break monitoring will be disabled (also see Section "Channel 1: Interface X7" on page 59).

P 552[0] - ENC_CH1_AbsEncStatus = Error and status codes (absolute encoder)
- The AbsEncStatus parameter is used to display status information for HIPERFACE encoders. In subindex [0], the read “TypeKey” for the HIPERFACE encoder will be indicated (one byte), for example.

P 553[0] - ENC_CH1_PeriodLen = Sin/Cos linear encoder
- P 554[0] - ENC_CH1_DigitalResolution - linear absolute encoder
- are the length of an analog Sin/Cos signal period in nanometres and the length of a digital increment of the position from the absolute value interface in nanometres. Both parameters are used for linear EnDat encoders and linear HIPERFACE encoders (instead of MultiT and SingleT bits (rotary)). In contrast, linear SSI encoders are treated as rotary SSI encoders (in this case, it is impossible to determine that the system is a linear encoder system based on the encoder head). Likewise, linear Sin/Cos encoders without an absolute value interface are treated as “rotary” encoders (if run as commutation encoders, the number of tracks, or lines (Lines) and the encoder gearing (Num, Denom) must be used to establish the relationship to the linear motor’s magn. pole pair subdivision). Only in the case of Sin/Cos encoders with distance-coded reference marks will the system determine, based on PeriodLen > 0, that the encoder system is linear and not rotary.

P 555[0] - ENC_CH1_Info = Encoder Information
- This parameter is available to the user so that they can enter a text of their choice (maximum of 31 characters). This text should be used to describe the encoder on channel Ch1.

P 616[0] - ENC_CH1_CycleCount = Sampling cycle in: n x 125 μs (microseconds)
- The CycleCount parameter can be used to slow down the timing for the cyclical SSI encoder evaluation. By default, CycleCount = 1, i.e. the default setting corresponds to 125 μs sampling and cycles for the encoder evaluation. Different settings must be viewed as special cases and accordingly must only be used when necessary. (see Section "SSI (cyclical) X7" on page 69).

P 610[0] - ENC_CH1_NominalIncrementA = distance coded absolute encoder
- P 611[0] - ENC_CH1_NominalIncrementB = distance coded absolute encoder
- The NominalIncrementA and NominalIncrementB parameters make it possible to run Sin/Cos incremental encoders (without an absolute value interface) with analog distance-coded reference marks. For example, if you were using the Heidenhain ROD280C with 18000 Sin/Cos tracks per revolution and 36 distance-coded reference marks, you would need to set NominalIncrementA to 1000 signal periods and NominalIncrementB to 1001 signal periods. This functionality is enabled if NominalIncrementA > 0. (see Section "Increment-coded reference marks" on page 105).

P 617[0] - ENC_CH1_AbsInitMode = Mode absolute value formation

# value initialization:

- DIG_ANA(0)- Standard:
Absolute value initialization using a mix of the digital and analog components (this is the default mode)
- DIG(1) - Digital:
Only the digital component will be used for the absolute value initialization.
- SEK_SEL37(2) - Automatic:
Digital if ST bits > (LineBits + 8); otherwise standard (criterion applies with HIPERFACE SEKL-37 encoders)
- SSI_180(3) - Same as Standard, except:
In the case of SSI, the quadrant alignment of the digital value relative to the analog Sin/Cos tracks is not the same as with EnDat, but is instead offset by 180 degrees relative to EnDat, i.e. in the “natural Q alignment” for the digital value relative to the tracks.

P 1900[0] - ENC_ETS = ETS mode, electronic nameplate

The parameter ENC_ETS supports what is referred to as the “Moog electronic rating plate” for HIPERFACE encoders. If this parameter is set to SCAN(0), the motor’s commutation offset will be read from the encoder’s OEM memory and copied to P 349 - CON_FM_MConOffset, but only if this offset can be unambiguously identified in the encoder (encoder memory scanning). If the parameter is set to NEVER(0) instead, this functionality will be disabled.

# 6.5.4.2.5 SSI absolute value interface

If P 540[0] - ENC_CH1_Abs = SSI(1), which is the normal setting, the absolute SSI encoder position will be read once during the initialization phase; after this, the cyclical encoder position will be acquired based on the Sin/Cos incremental component.

The parameters for the SSI interface are described in Section "SSI (cyclical) X7" on page 69, as are the differences in using the SSI interface with the “cyclical” method and “one-time reading” method.

MOOG ID No.:CB40859-001 Date:11/2020

# 6 Encoder

If P 540[0] - ENC_CH1_Abs = SSI_CONT(4), which is a special case, the absolute SSI encoder position will be read once during the initialization phase; after this, the cyclical encoder position will be acquired based on the Sin/Cos incremental component. The reason this is a special case is that the SSI clock will continue to be cyclically output on the SSI clock lines, in contrast to the SSI(1) setting. This means that the connected SSI encoder will continue to cyclically deliver position data on the SSI data lines. However, once the SSI data is read once, the controller will not evaluate any additional SSI data. This functionality can be used in the special case if the 485 system is implemented as a bus system on the encoder side so that a third 485 node (e.g. a controller) can “also listen in to” the SSI position data as an SSI clock slave.

# 6.5.4.2.6 EnDat absolute value interface

If P 540[0] - ENC_CH1_Abs = ENDAT(2), the absolute EnDat encoder position will be read once during the initialization phase; after this, the cyclical encoder position will be acquired based on the Sin/Cos incremental component.

The parameters for the EnDat interface are described in Section "EnDat (cyclical) X7" on page 61, as are the differences in using the EnDat interface with the “cyclical” method and “one-time reading” method.

# 6.5.4.2.7 HIPERFACE absolute value interface

If P 540[0] - ENC_CH1_Abs = HIPER(3), the absolute HIPERFACE encoder position will be read once during the initialization phase; after this, the cyclical encoder position will be acquired based on the Sin/Cos incremental component. The HIPERFACE interface will not be used as an alternative to cyclical encoder position acquisition.

HIPERFACE functionality: After an SW reset is carried out from the HIPERFACE encoder as the very first step, the ID byte, referred to as the “TypeKey”, will be read from the encoder and interpreted: If it is equal to FFh, the data for Lines, MultiT and

# 6 Encoder

MOOG ID No.:CB40859-001 Date:11/2020

MSD ServoDrive - DeviceHelp 68

SingleT will be read from the EN (HIPERFACE® electronic rating plate) on the encoder. If it is not equal to FFh, the data for Lines, MultiT and SingleT will be taken from a characteristic table in the controller firmware. In the case of linear encoder types, the corresponding parameters will be PeriodLen and DigitalResolution.

HIPERFACE encoders “unknown at the time of writing” (new: no entry in the firmware characteristic table) are generally not supported! In the case of known encoders, the Lines, MultiT, SingleT, PeriodLen and DigitalResolution parameters will be overwritten with the determined values. After this, the HIPERFACE encoder’s internal 4-byte error status memory will be read. Then, the position will be read once from the encoder. If any errors that result in new entries in the internal error memory occur at this point, the error memory will be read again and interpreted accordingly (error message if applicable).

# Table 6.10: Parameters for Channel 1 (X7) - Sin/Cos + HIPERFACE

| |ID|Index Name| |Unit|Description|
|---|---|---|---|---|---|
| |552|0|ENC_CH1_AbsEncStatus| |Error and status codes (absolute encoder)|
| |553|0|ENC_CH1_PeriodLen|nm|Length of signal period (Sin/Cos linear encoder)|
| |554|0|ENC_CH1_DigitalResolution|nm|Length of one increment (linear absolute encoder)|
| |555|0|ENC_CH1_Info|Encoder information| |
| |1900|0|ENC_ETS| |ETS mode, electronic nameplate|

l P552 - ENC_CH1_AbsEncStatus = Error and status codes (absolute encoder)

AbsEncStatus is used to display status information for HIPERFACE encoders. In index [0], the read “TypeKey” for the HIPERFACE encoder will be indicated (one byte). Bytes 1–4 of the HIPERFACE encoder’s internal 4-byte error status memory will be shown in indexes [5..8] (00h means “no error”). Index [9] will specify how many error status bytes were read in the last read operation.

NOTE

l Pay attention to the encoder initialization entries in the Moog DRIVEADMINISTRATOR 5 message window. In the event of an error, also check the entries in P 552 - ENC_CH1_AbsEncStatus.

With P 1900 - ENC_ETS, the HIPERFACE interface also supports what is referred to as the “Moog electronic rating plate.” If this parameter is set to SCAN(0), the motor’s commutation offset will be read from the encoder’s OEM memory and copied to P 349 - CON_FM_MConOffset, but only if this offset can be unambiguously identified in the encoder (encoder memory scanning). If the parameter is set to NEVER(0) instead, this functionality will be disabled.

# Table 6.11: Parameters for Channel 1 (X7) - HIPERFACE status

|ID|Index Name|Unit|Description|
|---|---|---|---|
|505|0|ENC_CH1_Sel|Encoder selection set to SINCOS(1)|
|540|0|ENC_CH1_Abs|HIPER(3)|
|542|0|ENC_CH1_lines|Number of Lines of Sin/Cos encoder|
|543|0|ENC_CH1_MultiT|Number of MultiTurn bits (absolute encoder)|
|544|0|ENC_CH1_SingleT|Number of SingleTurn bits (absolute encoder)|
|552|15|Bytes_of_last_protocol|highbyte: to encoder, lowbyte: from encoder|
|552|16|Bytes_of_last_protocol| |
|552|17...| | |

# SSI encoder basics and requirements

Starting from index [15], the byte sequences for the last command that was transmitted (request to encoder “left” + response from encoder “right”) will be shown completely.

# 6.5.4.2.8 SSI_CONT absolute value interface

P 540[0] - ENC_CH1_Abs = SSI_CONT(4)

See Section "SSI absolute value interface" on page 67.

# 6.5.5 SSI (cyclical) X7

Ch1: SSI(2) - Cyclical SSI

The software versions required to run the SSI encoder interface are the standard software versions for the MSD Servo Drive and MSD Single-Axis Servo Drive Compact.

# Criteria:

- Clock and data inactive level = HIGH
- The current position must be internally stored at the first falling clock edge
- No lengthened calculation time (in first cycle)
- With the first rising clock edge, the encoder must shift the data to the first position bit to be transmitted (MSB)
- 1 Mbps rate
- Data coding = Binary or Gray
- Reading data after the data bits end is permissible
- 125 μs cycle (i.e. internal position refresh rate ≪125 μs)
- Monoflop time ≥ 6 μs
- Data lines driven with logic 0 during monoflop time
- No parity bit
- No error bits or other status bits
- ≤14 MultiTurn bits

NOTE

- Please note the limitations that apply when running EnDat and SSI encoders (see Section "Limiting for EnDat and SSI" on page 52).

SSI (Synchronous Serial Interface) is a digital encoder interface that is supported by a large number of manufacturers. It is not standardized, meaning that manufacturers are free to support the interface as they like. The pseudo-standard described below has however been established for motor feedback interfaces. Moog supports this version first and foremost.

The following table lists the parameters for cyclical SSI operation on encoder channel Ch 1. It also points out possible differences between the use of the SSI interface with the “cyclical” method and “one-time reading” method when using Sin/Cos encoders with an SSI absolute value interface.

MOOG ID No.:CB40859-001 Date:11/2020

MSD ServoDrive - DeviceHelp

# 6 Encoder

MOOG ID No.:CB40859-001 Date:11/2020

# MSD ServoDrive - DeviceHelp

SSI wire break monitoring (bit monitoring during monoflop time) The Sel, Lines, MultiT and SingleT parameters are self-explanatory. If monitoring is enabled, the controller, as the SSI clock master, will read data for one more clock cycle after the data bits (reading data after the data bits end is permissible). The bit that the master reads in addition to the data bits this way comes from the SSI encoder’s monoflop time. At the time corresponding to this bit, the SSI encoder must drive the data lines with a logic 0. If the data lines on connector X7 are open, a logic 1 will be read here. The bit monitoring at this point makes it possible to determine whether the SSI data lines are being actively driven with a logic 0 at this point (no “wire break”) or are not (“wire break”). SSI wire break monitoring can be disabled by setting P 546[0] - ENC_CH1_Mode to 0001h.

# Mode parameters and CycleCount parameters

P 546[0] - ENC_CH1_Mode can be used to run a parity evaluation after the data. In addition, ENC_CH1_Mode makes it possible to run special SSI encoders that deliver one or more special bits after the data. In this case, the MSD Servo Drive will not evaluate these bits – this mode is meant to make it possible to work with SSI encoders that require for these bits to be sampled. P 616[0] - ENC_CH1_CycleCount makes it possible to run slower SSI encoders that cannot handle the required cycle of 125 μs. The control characteristics will deteriorate when using this type of SSI encoder, which is why doing so is not recommended.

|ID|Index Name|Unit|Description|
|---|---|---|---|
|505|0 ENC_CH1_Sel|=SSI(2)| |
|543|0 ENC_CH1_MultiT| |Number of MultiTurn bits (absolute encoder)|
|544|0 ENC_CH1_SingleT| |Number of SingleTurn bits (absolute encoder)|
|545|0 ENC_CH1_Code| |Code selection (SSI absolute encoder)|
|546|0 ENC_CH1_Mode| |Mode selection (SSI absolute encoder)|
|547|0 ENC_CH1_MTBase| |Minimum MultiTurn position (SSI absolute encoder)|
|548|0 ENC_CH1_MTEnable| |Channel 1: Multi-turn as single-turn|
|598|0 ENC_CH1_Position|inc|Position encoder channel 1|
|616|0 ENC_CH1_CycleCount| |Channel 1: Position encoder sampling cycle (n x 125 μsec)|

# NOTE

- Linear SSI encoders will be treated as rotary SSI encoders. In this case, it is impossible to determine that the system is a linear encoder system based on the encoder head.
- P 543[0] - ENC_CH1_MultiT = Number of multi-turn bits: 0..14 Due to the design of the cyclical SSI interface as a motor feedback interface, the number of multi-turn bits is limited to 14 (no limit to 14 bits in the case of a Sin/Cos interface with SSI one-time reading).
- P 545[0] - ENC_CH1_Code = SSI decoding: BINARY(0) or GRAY(1) Gray decoding will be selected by default. The other option is to use binary decoding.
- P 546[0] - ENC_CH1_Mode = Available SSI auxiliary settings This parameter has a 16-bit hex value. With the default setting (0000h), SSI wire break monitoring will be enabled. A value of 0001h will disable SSI wire break monitoring, meaning that one bit less will be read.

# Following is a list of what some of the terms in the table below stand for:

- Data = Sequence of all data bits
- EncObs = Wire break bit
- Nothing = No bit
- POdd = Odd parity bit
- PEven = Even parity bit
- Free = A free bit

# 6 Encoder

# 6.5.6 Encoder gearing

NOTE

- Please read the general information on encoder gearing found in Section "Introduction" on page 52 beforehand.

Encoder channels Ch1 to Ch3 each feature their own encoder gearing, while encoder channel Ch4 (virtual encoders) does not feature any encoder gearing. In the case of encoder channel Ch2, it is assumed that the resolver will always be used as a commutation encoder on the motor shaft. Because of this, the numerator adjustment range is limited to a value of (+1) or (-1), while the denominator is set at a fixed value of (+1), for the Ch2 encoder gearing ratio. This means that the only option available is to invert the encoder signal (direction reversal).

As a whole, the encoder gearing is a scaling factor in the encoder evaluation system and consists of numerator N (ENC_CHx_Num) for the motor side and denominator D (ENC_CHx_Denom) for the encoder side (output side).

The following are used to configure the encoder gearing...

- Ch1 with P 510[0] - ENC_CH1_Num and P 511[0] - ENC_CH1_Denom,
- Ch2 with P 512[0] - ENC_CH2_Num and P 513[0] - ENC_CH2_Denom,
- Ch3 with P 514[0] - ENC_CH3_Num and P 515[0] - ENC_CH3_Denom.

|P No.|Index|Name|Unit|Description|
|---|---|---|---|---|
|510|0|ENC_CH1_Num| |Denominator of channel 1|
|511|0|ENC_CH1_Denom| |Numerator of channel 1|
|512|0|ENC_CH2_Num| |Denominator of channel 2|
|513|0|ENC_CH2_Denom| |Numerator of channel 2|
|514|0|ENC_CH3_Num| |Denominator of channel 3|
|515|0|ENC_CH3_Denom| |Numerator of channel 3|

# Table 6.13: SSI mode parameters (all other values are reserved)

|ID|Value|Name|
|---|---|---|
|546| |ENC_CH1_Mode|
| |0000h|Data_EncObs|
| |0001h|Data_Nothing|
| |0002h|Data_POdd_EncObs|
| |0003h|Data_Free_POdd_EncObs|
| |0004h|Data_POdd|
| |0005h|Data_Free_POdd|
| |0006h|Data_Free_EncObs|
| |0007h|Data_Free_Free_EncObs|
| |000Ch|Data_PEven_EncObs|
| |000Dh|Data_Free_PEven_EncObs|
| |000Eh|Data_PEven|
| |000Fh|Data_Free_PEven|
| |001Fh|Data_Free|
| |0020h|Data_Free_Free|
| |0021h|Data_Free_Free_Free|
| |0022h|Data_Free_Free_Free_Free|

P 616[0] - ENC_CH1_CycleCount = Sampling cycle in: n x 125 μs (microseconds):

ENC_CH1_CycleCount can be used to slow down the timing for the cyclical SSI encoder evaluation. By default, ENC_CH1_CycleCount = 1, i.e. the default setting corresponds to 125 μs sampling and cycles for the encoder evaluation. Different settings must be viewed as special cases and must only be used when necessary.

Monitoring the position difference With SSI encoders, the position difference is monitored automatically. The limit value is based on the maximum speed with reference to one scanning step (125μs). The position difference between two scanning steps is restricted to this limit value. In the event of an EMC disturbance, this limits the (incorrectly detected) tracking error and the response of the controller.

MOOG ID No.:CB40859-001 Date:11/2020

# 6 Encoder

MOOG ID No.:CB40859-001 Date:11/2020

MSD ServoDrive - DeviceHelp 72

# Parameters

l P 500[0] - ENC_CH1_ActVal[0].SingleTurn and

l P 500[1] - ENC_CH1_ActVal[1].MultiTurn

are used, for example, to indicate the current position value at the output for encoder channel Ch1. These parameters can also be used for checking purposes during commissioning.

# NOTE

l This value at the encoder channel output...

- Already contains the encoder gearing ratio factor (N/D)
- Will be passed into the system in this way (incl. the encoder gearing ratio)
- I.e. is “the value” from the encoder evaluation system

The encoder gearing ratio has a multiplicative effect on the position progress, i.e. either “expanding” or “compressing”.

A distinction can be drawn between an encoder’s motor mode and field mode:

- Motor mode: The encoder is the motor commutation encoder
- Field encoder: The encoder is not the motor commutation encoder (instead, it is an additional encoder in the “field”, e.g. used for position control purposes)

This screen is used to select the encoder for channel Ch2. This channel is used to measure position changes periodically and add them up cyclically – this is referred to as “cyclical evaluation”. Encoder channel Ch2 does not feature an absolute value interface. In addition to evaluating resolvers, this channel can also be used to capture “simple” Sin/Cos signals (up to a max. of 1 kHz and with no zero pulse).

Resolvers must always be evaluated using encoder channel Ch2 (P 506 - ENC_CH2_Sel = RES(1)). The resolver pole pairs are set via P 560[0] - ENC_CH2_Lines.

# Resolver basics and requirements

The connected resolver must meet the following criteria:

- Ccw (positive signal progress corresponds to an anticlockwise direction when looking at the shaft from above)
- No transformation phase shift
- Transformation ratio of approx. 0.5

GPOC is a special Moog online process for improving the quality of Sin/Cos signals before they are used to calculate a position. If Sel = RES(1) or Sel = SINCOS (2), this process may come in handy. For details see Section "Signal correction GPOC (Gain Phase Offset Correction)" on page 74.

**Encoder configuration channel 2 (X6) parameters**
|P No.|Index|Name / Settings|Unit|Description|
|---|---|---|---|---|
|506|0|ENC_CH2_Sel| |OFF (0) No evaluation RES(1) Resolver evaluation SinCos(2) Resolver excitation shut-off; evaluation of a Sin/Cos encoder (max 1kHz) possible.|
|512|0|ENC_CH2_Num| |Numerator of encoder gearing [-1...+1]|
|513|0|ENC_CH2_Denom| |Denominator of encoder gearing [only +1]|
|560|0|ENC_CH2_Lines| |Number of pole pairs of resolver|
|561|0|ENC_CH2_Corr| |Encoder correction GPOC|
|562| |ENC_CH2_CorrVal| |0 Offset S2-S4 track 1 Offset S1-S3 track 2 Gain S2-S4 track 3 Gain S1-S3 track 4 Phase|
|563|0|ENC_CH2_EncObsMin| |Amplitude monitoring Minimum|
|564|0|ENC_CH2_Info| |Encoder name|
|565| |ENC_CH2_LineDelay|μs|Correction of phase shift for cable lengths > 50 m (only after consultation with Moog).|

MOOG ID No.:CB40859-001 Date:11/2020

# Encoder

**Encoder configuration channel 2 (X6) parameters (continue)**
|P No.|Index|Name / Settings|Unit|Description|
|---|---|---|---|---|
| |0|ResExc|us|Exciter signal phase shift|
| | |Delay|us|Compensation for commutation angle|
|566|0|ENC_CH2_Amplitude|±|Correction of amplitude for cable lengths > 50 m (only after consultation with Moog).|
|567|0|ENC_CH2_EncObsAct| |Amplitude of analog signal|

The Sel and Lines parameters are self-explanatory.

Other parameters, such as Num and Denom, are described elsewhere (see Section "Encoder gearing X6" on page 75).

- P 561[0] - ENC_CH2_Corr = Signal correction type
The GPOC routine used for track signal correction purposes for sine/cosine signals is used to compensate for systematic errors. The routine is controlled with the Corr and CorrVal parameters (see Section "Signal correction GPOC (Gain Phase Offset Correction)" on page 74).
- P 563[0] - ENC_CH2_EncObsMin = Encoder monitoring minimum, sqrt (a²+b²)
This parameter is used to scale the resolver and Sin/Cos wire break monitoring and represents the “downwards threshold” for an error message. The default setting is 0.2, corresponding to approx. 20% of the track signals’ amplitude (approx. 80% corresponds to approx. 1 Vss). If EncObsMin is set to 0, the resolver and Sin/Cos wire break monitoring will be disabled (see Section "Channel 1: Interface X7" on page 59 as well).

# 6.6.1 Compensation for long resolver cables

When using long resolver cables, there will be a phase shift between the controller’s exciter output signal and the controller’s track input signals (S1-S3 and S2-S4). This phase difference can be compensated for with P 565[0] - ResExc: ResExc is the time, in μs (microseconds), by which the resolver excitation will lead. Moreover, P 565[1] - Delay can be used to compensate for a commutation dead time, which

# 6 Encoder

MOOG ID No.:CB40859-001 Date:11/2020

MSD ServoDrive - DeviceHelp 74

can become important in the case of higher rotating field frequencies. When there is an absolute reduction in signal strengths (amplitudes) as a result of the long cables, P 566[0] - ENC_CH2_Amplitude can be used to subsequently increase these amplitudes (up to a max. of +10.5%) so that a drive signal level of 80–85% for the track signals is once again attained. This is achieved by adjusting the resolver excitation amplitude. Parameter P 567[0] - ENC_CH2_EncObsAct can be used to check the effects of adjusting the compensation settings. It returns the length of the phasor for the track signals (sqrt(a²+b²)) and is accordingly a measure of “the amplitude” of the track signals: If the phase shift is properly corrected at the end of the compensation adjustment process, you can save the settings.

NOTE

- This function is not available for the MSD Single-Axis Servo Drive Compact.
- Do not use cable lengths > 50 m without first consulting with Moog.

# 6.6.2 Signal correction GPOC (Gain Phase Offset Correction)

The resolver and Sin/Cos incremental encoder demonstrate systematic errors that are reflected in the measured position and in the speed calculated from this (gain and phase errors, offset components of the tracking signal). The GPOC method for track signal correction compensates systematic errors. GPOC is available for encoder channels 1 and 2.

Image 6.4: Track signals A and B with and without GPOC

# Procedure

|Step|Action|ID|Index Name|Unit Description|
|---|---|---|---|---|
|1.|Open the manual mode window and set speed-controlled mode. Motor operated at constant speed|550|2|GainA - Gain, track A - cosine|
| | |550|3|GainB - Gain, track B - sine|
|2.|- Resolver: 1000 rpm
- Sin/Cos incremental encoder: 1 to 5 rpm
|550|4|Phase difference|
|3.|Set P 549[0] - ENC_CH1_Corr to "ADAPT(2) = Auto correction". Wait about 1–3 minutes. During this time, the compensation algorithms will reach their steady state. Speed ripple should decrease after about 1 minute. This can be monitored with the actual speed value in the scope or with P 550 - ENC_CH1_CorrVal.| | | |
|4.|Set P 549[0] - ENC_CH1_Corr to "CORR(1) = Correction with saved values". Save in the device| | | |

# Table 6.16: Configuring and activating GPOC

See Section "Encoder gearing" on page 89. The encoder gearing for encoder channels Ch1, Ch2 and Ch3 is described there.

# NOTE

- In the case of encoder channel Ch2, it is assumed that the resolver will always be used as a commutation encoder on the motor shaft. Because of this, the numerator adjustment range is limited to a value of (+1) or (-1), while the denominator is set at a fixed value of (+1), for the Ch2 encoder gearing ratio. This means that the only option available is to invert the encoder signal (direction reversal).
- Encoder channel Ch4 (virtual encoders) does not feature any encoder gearing.

# Table 6.17: Signal correction (GPOC) parameters for channel 1 (X7)

|ID|Index Name|Unit Description|
|---|---|---|
|549|0|ENC_CH1_Corr - Signal correction type|
|550| |ENC_CH1_CorrVal - Signal correction values|
|550|0|OffsetA - Offset, track A - cosine|
|550|1|OffsetB - Offset, track B - sine|

MOOG ID No.:CB40859-001 Date:11/2020 MSD ServoDrive - DeviceHelp 75

# 6 Encoder

# 6 Encoder

MOOG ID No.:CB40859-001 Date:11/2020

# 6.7 Channel 3: Interface X8 (optional)

Interface X8 can optionally be equipped with a technology option (X8 option) at the factory (this option cannot be retrofitted). There are a variety of optional modules available:

|No.|Technology option name|Item designation|MSD Servo Drive|MSD Single-Axis Servo Drive|Documentation|
|---|---|---|---|---|---|
|1|Second Sin/Cos encoder|G392/3/4/5/7|X|X|Specification (ID No.: CA79903-001)|
|2|TTL encoder simulation / TTL master encoder|G392/3/5/7|not available| |Specification (ID No.: CB08758-001) HW version: Up to .1 SW version: 2.15 or higher|
|3|TTL encoder simulation / TTL master encoder|G392/3/4/5/7|HW version: .2 or higher|SW version: 1.10 or higher|Specification (ID No.: CB32164-001) SW version: All|
|4|SSI encoder simulation|G392/3/5/7|X|not available|Specification (ID No.: CB08760-001)|
|5|TTL encoder with commutation signals|G392/3/4/5/7|X|X|Specification (ID No.: CB32162-001)|
|6|Second safe Sin/Cos encoder|G392/3/5/7|X|not available| |
|7|Second safe SSI encoder|G392/3/5/7|X|Not available|Specification (ID No.: CC23875-001)|
|8|Second safe axis monitoring (Sin/Cos)|G392/3/5/7|X|Not available| |

Table 6.18: Options for interface X8

# 6 Encoder

The following X8 options can be used and selected with P 507[0] - ENC_CH3_Sel in order to evaluate encoders on encoder channel Ch3:

- No. 1: “Second Sin/Cos encoder”
- No. 3: “TTL encoder simulation / TTL master encoder”
- No. 4: “SSI encoder simulation”
- No. 5: “TTL encoder with commutation signals”

NOTE

- For information on the connector, pinout, technical data, configuration, and the encoder models (if any) that can be evaluated with the included technology option, please consult the Specification specified in the “Documentation” column.

The following table shows how the X8 options that can be used for encoder evaluation can be identified and selected.

|“No.” column|As per the table above.|
|---|---|
|“Hardware ID” column|The texts in this column can be viewed in the Moog DRIVEADMINISTRATOR 5 using P 53[0] - DV_HwOptionX12ID by going to ►Drive description ►Hardware version if the corresponding technology option is present.|
|“Selection” column|In certain cases, several different encoder types can be run on a technology option and selected with P 507 - ENC_CH3_Sel. Even if a technology option that does not match is equipped, most values can only be selected with P 507 - ENC_CH3_Sel. If an impermissible combination is selected, this will be indicated by means of error messages during the initialization phase.|

MOOG ID No.:CB40859-001 Date:11/2020

MSD ServoDrive - DeviceHelp 77

# 6 Encoder

MOOG ID No.:CB40859-001 Date:11/2020

# MSD ServoDrive - DeviceHelp

|No.|Technology option name|Hardware ID|Selection|
|---|---|---|---|
|0|No module|NONE(0) - No technology option|OFF (0)|
| | |SINCOS(1) - Sin/Cos cyclic *)| |
| | |- Without absolute value interface, Abs=OFF(0), with zero pulse| |
| | |- With SSI one-time reading, Abs=SSI(1)| |
|1|Second Sin/Cos encoder|SINCOS_V2(10) - 2nd Sin/Cos encoder (V2)|- With EnDat one-time reading, Abs=ENDAT(2)|
| | |SSI(2) - Cyclical SSI (without analog tracks)| |
| | |TTL(3) - TTL evaluation, with zero pulse| |
| | |ENDAT(4) - Cyclical EnDat (without analog tracks)| |
|3|TTL encoder simulation / TTL master encoder|TTL_ECSIM_V2(9) - TTL Encodersimulation (V2)|TTL(3)|
|4|SSI encoder simulation|SSI_ECSIM(3) - SSI encodersimulation|SSI(2) - Cyclical SSI (without analog tracks)|
|5|TTL encoder with commutation signals|TTL_COM(11) - TTL + Hall option|TTL(3)|
| | |TTL_COM(5)| |

Table 6.19: Options for X8 interface that can be used to evaluate encoders via encoder channel Ch3

*) SINCOS(1) is set via the P 507[0] - ENC_CH3_Sel main interface. The auxiliary interface, P 570[0] - ENC_CH3_Abs, can be optionally used to set the one-time reading for the absolute position during initialization.

# NOTE

- Only one encoder with a purely digital EnDat or SSI interface can be used on connector X8 or X7.
- If two EnDat encoders are used and one of them is purely digital, it is necessary to ensure that the purely digital encoder is connected to X8. This is important, as the EnDat encoder with Sin/Cos tracks must be initialized before the purely digital encoder.

# Encoder Configuration

To see which technology option your Servo Drive features (if any), go to Project Select from database tree ► Device setup ► Drive description in Moog DRIVEADMINISTRATOR 5 and check under “Technology option” in the “Hardware” section.

# Encoder Name

You can use this field to enter your own information for describing the encoder (maximum of 31 characters) (P 580[0] - ENC_CH3_Info).

# Cyclic Position Via

This drop-down menu is used to select the “main interface” (P 507[0] - ENC_CH3_Sel).

# Pulses Per Revolution

Once SINCOS(1), TTL(3) or TTL_COM(5) is selected as the “main interface,” this field will appear so that you can enter the number of analog Sin/Cos tracks per revolution (TTL tracks as well).

# Absolute Interface

This drop-down menu is used to select the “auxiliary interface” (P 570[0] - ENC_CH3_Abs).

# Image 6.5: Encoder Configuration Channel 3 (X8) Screen

This screen is used to select the encoder for channel Ch3. This channel uses the encoder’s “main interface” to measure position changes periodically and add them up cyclically – this is referred to as “cyclical evaluation.”

Encoders with a main interface that only makes it possible to measure the cyclical position incrementally often feature an additional absolute value interface referred to as an “auxiliary interface.” For this interface, the absolute position is measured once during the initialization phase and is then used for absolute value initialization purposes.

# Note

l Selecting an “auxiliary interface” is redundant if, for example, SSI (2) is selected as the “main interface” (corresponds to cyclical evaluation via SSI). In this case, the absolute value initialization will also be carried out via the SSI interface, regardless of the selected “auxiliary interface.”

# Gear Ratio

These fields can be used to define a gear ratio for the encoder (in the output side). For more details, see Section "Encoder gearing" on page 89.

MOOG ID No.:CB40859-001 Date:11/2020

MSD ServoDrive - DeviceHelp 79

# 6 Encoder

MOOG ID No.:CB40859-001 Date:11/2020

# MSD ServoDrive - DeviceHelp

Signal correction (GPOC) l P 577[0] - ENC_CH3_EncObsMin

If you set EncObsMin to 0, Sin/Cos wire break monitoring will be disabled.

GPOC is a special Moog online process for improving the quality of Sin/Cos signals before they are used to calculate a position. If “SINCOS(1)” is selected as the “main interface,” this process may be useful. For details see Section "Signal correction GPOC (Gain Phase Offset Correction)" on page 74.

The default value is 0.2 (20%) and stands for a calculated amplitude value (calculated using the two Sin/Cos signals) of x = sqrt(a² + b²). If the Sin/Cos signals are equal to approx. 1 Vss when compared, approx. 0.8 will be calculated here (approx. 80% magnitude at the A-D converters; approx. 0.25 Vss Sin/Cos will yield approx. 0.2 here (20% magnitude at the A-D converter)). The error threshold can be adjusted with EncObsMin.

# 6.7.1 Main parameters for encoder channel Ch3

The following table lists the most important parameters for the Ch3 encoder channel. These parameters are described in the chapters that go over selecting the various encoders with P 507[0] - ENC_CH3_Sel and P 570[0] - ENC_CH3_Abs.

When used with its default setting, this parameter will ensure that the absolute value initialization “starts up with plus-minus”. I.e. the encoder’s multi-turn value range from 0 to max will be mapped to -½ max to +½ max. The range from +½ max to max will be initialized as negative; in this case, the point of discontinuity will be found at ½ max. This can be changed with MTBase. When MTBase = 0, the absolute value initialization will, for example, “start up with zero to max”. I.e. the encoder’s multi-turn value range from 0 to max will be mapped to 0 to max. The range from +½ max to max will be initialized as positive; in this case, the point of discontinuity will be found at 0.

l P 585[0] - ENC_CH3_MTEnable

If you set MTEnable to 1, you can use an available multi-turn rotary encoder as a single-turn rotary encoder, which can come in handy for testing purposes.

|P No.|Index|Name / Setting|Unit|Description|
|---|---|---|---|---|
|507|0|ENC_CH3_Sel| |Main selection on encoder channel Ch3|
|570|0|ENC_CH3_Abs| |Absolute value interface for one-time reading|
|572|0|ENC_CH3_Lines| |Number of analog Sin/Cos lines per revolution (TTL lines as well)|
|573|0|ENC_CH3_MultiT| |Number of multi-turn bits for the digital interface|
|574|0|ENC_CH3_SingleT| |Number of single-turn bits for the digital interface|
|575|0|ENC_CH3_Code| |Code selection (for SSI encoders) (binary, Gray)|
|576|0|ENC_CH3_Mode| |Mode selection (for SSI encoders)|
|583|0|ENC_CH3_|nm|Linear encoders: Length of a digital increment in|
|584|0|DigitalResolution|nm (nanometres)| |
|585|0|ENC_CH3_MTBase| |Definition of point of discontinuity in multi-turn range|
|636|0|ENC_CH3_MTEnable| |Enable MultiTurn use (negative logic, 1=MToff)|
|636|0|ENC_CH3_CycleCount| |Sampling cycle in: n x 125 μ (microseconds)|

NOTE: As there are various protocol modes available for SSI encoders (with/without wire break monitoring, with/without parity bit, etc.), consult with your project supervisor or the Helpline provided by Moog before using any special SSI protocol modes.

As the functionality of the parameters for encoder channel Ch3 is predominantly identical to that of the parameters for encoder channel Ch1, it is recommended to read the description for the Ch1 encoder channel parameters.

Accordingly, the following table starts by listing all the parameters for the Ch3 encoder channel. If the functionality of a parameter is different from that of the corresponding parameter for encoder channel Ch1, the parameter will be described in the chapters that go over selecting a special encoder with (507) ENC_CH3_Sel and (570) ENC_CH3_Abs.

Parameters Lines, MultiT, SingleT, etc. are self-explanatory. Most of the following parameters are explained in the information for encoder channel Ch1 (see Section "Channel 1: Interface X7" on page 59).

# Table 6.21: Encoder configuration channel 3 (X8) parameters

|ID|Index|Name|Unit|Description|
|---|---|---|---|---|
|349|0|CON_FM_MConOffset| |Commutation offset|
|502|0..3|ENC_CH3_ActVal| |Current position value at encoder channel Ch3 output|
|507|0|ENC_CH3_Sel| |Main selection on encoder channel Ch3|
|514|0|ENC_CH3_Num| |Encoder gearing: Numerator|
|515|0|ENC_CH3_Denom| |Encoder gearing: Denominator|
|520|0|ENC_MCon| |=3, channel selection for motor commutation|
|521|0|ENC_SCon| |=3, channel selection for speed control|
|522|0|ENC_PCon| |=3, channel selection for position control|
|570|0|ENC_CH3_Abs| |Absolute value interface selection (one-time reading)|
|571|0|ENC_CH3_NpTest| |TEST-MODE: Index pulse signal(s) to Scope|
|572|0|ENC_CH3_Lines| |Number of Lines (Sin/Cos / TTL encoders)|
|573|0|ENC_CH3_MultiT| |Number of MultiTurn bits (absolute encoder)|
|574|0|ENC_CH3_SingleT| |Number of SingleTurn bits (absolute encoder)|
|574|0|ENC_CH3_Code| |Code selection (SSI encoder) (binary, gray)|
|576|0|ENC_CH3_Mode| |Mode selection (SSI encoder)|
|577|0|ENC_CH3_EncObsMin| |Encoder monitoring minimum, sqrt (a^2+b^2)|
|578|0|ENC_CH3_Extended| |(a^2 + b^2) ENC CH3: Extended|
|580|0|ENC_CH3_Info| |Encoder information channel 3|
|581|0|ENC_CH3_AbsEncStatus| |Error and status codes (absolute encoder)|
|582|0|ENC_CH3_PeriodLen|nm|Length of signal period (Sin/Cos linear encoder)|

# Encoder configuration channel 3 (X8) parameters (continue)

|Index|Name|Unit|Description|
|---|---|---|---|
|0|ENC_CH3_|nm|Length of one increment (linear absolute encoder)|
|0|DigitalResolution| | |
|0|ENC_CH3_MTBase| |Definition of point of discontinuity in multi-turn range|
|0|ENC_CH3_MTEnable| |Enable MultiTurn use (negative logic, 1=MToff)|
|0|ENC_CH3_Corr| |Signal correction type|
|0..4|ENC_CH3_CorrVal| |Signal correction values|
|0|ENC_CH3_EncObsAct| |Amplitude of analog signals (vector length)|
|0|ENC_CH3_HallLayout| |Hall pattern selection|
|0|ENC_CH3_Position|inc|Position encoder channel 3|
|0|ENC_CH3_Period|ms|Maximum period of interpolation (ttl encoder)|
|0|ENC_CH3_EncOnsActTF|ms|Filter time constant for amplitude of analog signals|
|0|ENC_CH3_|Sign.|Nominal increment A (distance coded abs. encoder)|
|0|ENC_CH3_|Sign.|Nominal increment B (distance coded abs. encoder)|
|0|ENC_CH3_CycleCount| |Position encoder sampling cycle (n x 125 μsec)|
|0|ENC_CH3_AbsInitMode| |Mode absolute value formation|
|0..29|ENC_ENDAT| |EnDat additional|
|0|ENC_Warning| |Encoder warning (e.g. from encoder internal memory)|
|0|ENC_Warning| |Encoder warning reset (e.g. in encoder internal memory)|
|0|ENC_Error| |Encoder error (e.g. from encoder internal memory)|
|0|ENC_ErrorReset| |Encoder error reset (e.g. in encoder internal memory)|
|0|ENC_ETS| |ETS mode, electronic nameplate|
|0|ENC_ETS_CTRL| |ETS control, electronic nameplate|
|0..15|ENC_ETS_STAT| |ETS status, electronic nameplate|
|0..511|ENC_ETS_DATA| |ETS data, electronic nameplate|
|0|ENC_CH3_TTL_| |TTL signal type selection|

# 6 Encoder

MOOG ID No.:CB40859-001 Date:11/2020

# 6.7.2 Absolute value interfaces X8

The following absolute value interfaces will be available at encoder channel Ch3 depending on the X8 option being used.

- Cyclical Sin/Cos with SSI one-time reading via X8 option: SINCOS_V2(10) - 2nd Sin/Cos encoder (V2)
- Cyclical Sin/Cos with EnDat one-time reading via X8 option: SINCOS_V2(10) - 2nd Sin/Cos encoder (V2)
- Cyclical SSI via X8 options: SINCOS_V2(10) - 2nd Sin/Cos encoder (V2) or SSI_ECSIM(3) - SSI encoder simulation
- Cyclical EnDat via X8 option: SINCOS_V2(10) - 2nd Sin/Cos encoder (V2)

See also table in Section "Channel 3: Interface X8 (optional)" on page 76. They can be selected with P 507[0] - ENC_CH3_Sel and P 570[0] - ENC_CH3_Abs. For more details, see Section "Main parameters for encoder channel Ch3" on page 80.

# 6.7.3 EnDat (cyclical) X8

Ch3: ENDAT(4) - Cyclical EnDat (2.1 or 2.2)

As the EnDat functionality of the parameters for encoder channel Ch3 is predominantly identical to that of the parameters for encoder channel Ch1, it is recommended to read the description for the Ch1 encoder channel parameters (see Section "EnDat (cyclical) X7" on page 61).

The software versions required to run the EnDat interface are the standard software versions for the MSD Servo Drive and MSD Single-Axis Servo Drive Compact.

NOTE

- Please note the limitations that apply when running EnDat and SSI encoders (see Section "Limiting for EnDat and SSI" on page 52).

|ID|Index|Name|Unit|Description|
|---|---|---|---|---|
|507|0|ENC_CH3_Sel|= 4|= ENDAT(4)|
|573|0|ENC_CH3_MultiT|Number of MultiTurn bits (absolute encoder)| |
|574|0|ENC_CH3_SingleT|Number of SingleTurn bits (absolute encoder)| |
|584|0|ENC_CH3_MTBase|Definition of point of discontinuity in multi-turn| |
|585|0|ENC_CH3_MTEnable|range|1: Use Multi-turn encoder as a single-turn encoder|
|636|0|ENC_CH3_CycleCount|Position encoder sampling cycle (n x 125 μsec)| |
|600|0|ENC_CH3_Position|inc|Position encoder channel 3|
|583|0|ENC_CH3_|nm|Length of one increment (linear absolute encoder)|
|640|0..29|DigitalResolution| | |

Table 6.22: ENC_ENDAT Channel 3 encoder configuration (X8) - EnDat (cyclical) parameters

# 6.7.4 Hall sensor X8

Encoder channel Ch3 does not support Hall effect sensors!

# 6.7.5 Sin/Cos / TTL X8

# 6.7.5.1 TTL encoder

Ch3: TTL(3) - TTL signals

TTL encoders are ...

1. ... usually pure incremental encoders without an absolute value interface. In this case, P 570[0] - ENC_CH3_Abs must be set to OFF(0).
2. ... in a few exceptional cases, incremental encoders with an SSI absolute value interface. In this case, P 570[0] - ENC_CH3_Abs must be accordingly set to SSI(1) so that it will be possible to read the absolute encoder position for the absolute value initialization routine once during the initialization phase.

# 6.7.5.1.1 Pure TTL incremental encoder

A maximum interpolation period, in ms (milliseconds), can be configured for the TTL interface using P 602[0] - ENC_CH3_Period. Within this context, Period is the maximum time of “no activity” since the last TTL counter event:

- Period = 0: Function disabled (default)
- Period > 0 (=n ms): If no counter event is registered in n ms, the speed will be set to 0.

# Zero pulse

There is no parameter for activating the zero pulse evaluation here, as this evaluation is controlled based exclusively on the homing mode (see Section "Homing" on page 249). However, setting P 571[0] - ENC_CH3_NpTest to 1 provides a test mode that can be used during commissioning in order to be able to activate the zero pulse evaluation even without homing. Scope signals 1034 and 1036 can be used to view a received zero pulse within this context. This test mode must be disabled during normal operation (P 571[0] = 0).

# Commutation

Motor operation with pure incremental encoders needs for the auto commutation function to be enabled without fail. For details see Section "Synchronous motor auto commutation" on page 156.

# 6.7.5.1.2 TTL incremental encoder with SSI absolute value interface

see Section "Sin/Cos incremental encoders with absolute value interface" on page 84 and in special Section "SSI absolute value interface" on page 86.

MOOG ID No.:CB40859-001 Date:11/2020

MSD ServoDrive - DeviceHelp

# 6 Encoder

MOOG ID No.:CB40859-001 Date:11/2020

MSD ServoDrive - DeviceHelp 84

|ID|Index Name|Unit|Description|
|---|---|---|---|
|507|0|ENC_CH3_Sel = 3|Encoder selection set to TTL(3)|
|514|0|ENC_CH3_Num|Encoder gearing: Numerator|
|515|0|ENC_CH3_Denom|Encoder gearing: Denominator|
|570|0|ENC_CH3_Abs|Selection of absolute value interface|
|571|0|ENC_CH3_NpTest|ENC CH1, TEST-MODE: Index pulse signal(s) to Scope|
|572|0|ENC_CH3_Lines|Number of lines (Sin/Cos / TTL encoders)|
|2842|0|ENC_CH3_TTL_SignalType|Channel 3: TTL signal selection|
|602|0|ENC_CH3_Period|Maximum period of interpolation (ttl encoder)|
|636|0|ENC_CH3_CycleCount|Sampling cycle in: n x 125 μ (microseconds)|

# Table 6.23: Parameters for Channel 3 (X8) - TTL encoder

6.7.5.2.2 Linear Sin/Cos incremental encoders

Linear Sin/Cos encoders are operated as rotary encoders. For linear motor operation, P 572[0] - ENC_CH3_Lines and the encoder gearing (see Section "Encoder gearing" on page 89) are used to establish the ratio for the linear motor’s pole pair subdivision (North-North) for commutation. 1 x North-North corresponds to one revolution from Lines. In this case, the motor pole pair number must be set to 1. P 582[0] - ENC_CH3_PeriodLen is not used in this case.

# 6.7.5.2 Sin/Cos encoder

Ch3: SINCOS(1) - Sin/Cos signals

Sin/Cos encoders can ...

1. Be pure incremental encoders without an absolute value interface. In this case, P 570[0] - ENC_CH3_Abs must be set to OFF(0).
2. Be incremental encoders with an absolute value interface. In this case, P 570[0] - ENC_CH3_Abs must be accordingly set to SSI(1) or EnDat(2) so that it will be possible to read the absolute encoder position for the absolute value initialization routine once during the initialization phase.

# 6.7.5.2.1 Purely Sin/Cos incremental encoders

To run these encoders as pure incremental encoders with a zero pulse on encoder channel Ch3 (without an absolute value interface), the approach is basically the same as for pure TTL operation (see Section "TTL encoder" on page 82). The same parameters apply. However, there are the following differences:

# 6.7.5.2.4 Sin/Cos incremental encoders with absolute value interface

The following table lists the parameters for cyclical Sin/Cos operation on encoder channel Ch 3 with one-time reading of the absolute encoder position via the absolute value interface, i.e. without a zero pulse:

|ID|Index Name|Unit|Description|
|---|---|---|---|
|507|ENC_CH3_Sel|1|Encoder selection set to SINCOS(1)|
|514|ENC_CH3_Num| |Encoder gearing: Numerator|
|515|ENC_CH3_Denom| |Encoder gearing: Denominator|
|570|ENC_CH3_Abs| |Absolute value interface selection (one-time reading)|
|572|ENC_CH3_Lines| |Number of Lines (Sin/Cos / TTL encoders)|
|573|ENC_CH3_MultiT| |Number of MultiTurn bits (absolute encoder)|
|574|ENC_CH3_SingleT| |Number of SingleTurn bits (absolute encoder)|
|575|ENC_CH3_Code| |Code selection (SSI encoder) (binary, gray)|
|576|ENC_CH3_Mode| |Mode selection (SSI encoder)|
|584|ENC_CH3_MTBase| |Definition of point of discontinuity in multi-turn range|
|585|ENC_CH3_MTEnable| |Enable MultiTurn use (negative logic, 1=MToff)|
|586|ENC_CH3_Corr| |Signal correction type|
|587|ENC_CH3_CorrVal| |Signal correction values|
|577|ENC_CH3_EncObsMin| |Encoder monitoring minimum, sqrt(a^2+b^2)|
|581|ENC_CH3_AbsEncStatus| |Error and status codes (absolute encoder)|
|582|ENC_CH3_PeriodLen|nm|Length of signal period (Sin/Cos linear encoder)|
|583|ENC_CH3_DigitalResolution|nm|Length of one increment (linear absolute encoder)|
|636|ENC_CH3_CycleCount| |Sampling cycle in: n x 125 μ (microseconds)|
|639|ENC_CH3_NominalincrementA| |Sign. Nominal increment A (distance coded abs. encoder)|
|637|ENC_CH3_NominalincrementB| |Sign. Nominal increment B (distance coded abs. encoder)|

# Table 6.24: Parameters for channel 3 (X8) - Sin/Cos encoder

Some parameters (e.g. Sel, Num, Denom, Abs, Lines, MultiT, SingleT, CorrVal) are self-explanatory.

The Code and Mode parameters are described in Section "SSI (cyclical) X7" on page 69.

P 584[0] - ENC_CH3_MTBase = Minimum MultiTurn position

The MTBase parameter is used to set a position in the multi-turn encoder’s travel path that defines the point of discontinuity (overflow/underflow) for the absolute value initialization (that is, the “multi-turn basis”). Assuming a bipolar encoder measuring range, all position values that fall below MTBase will be shifted “up” (the whole MT range will be added to them once). This method makes it possible to place the point of discontinuity at any point within the encoder’s entire measuring range. By default, MTBase will be set to the lowest possible value for the parameter, i.e. reliably outside of the encoder’s value range: In this case, the full bipolar range will remain unaffected, as values will never fall below this MTBase threshold (see Section "Channel 3: Interface X8 (optional)" on page 76 as well).

P 585[0] - ENC_CH3_MTEnable = MultiTurn as SingleTurn

The MTEnable parameter makes it possible to use multi-turn encoders as single-turn encoders for test purposes. Negative logic: Default MTEnable = 0 means "MultiTurn-Enable ON".

P 586[0] - ENC_CH3_Corr = Signal correction type:

The GPOC routine used for track signal correction purposes for sine/cosine signals is used to compensate for systematic errors. The routine is controlled with the Corr and CorrVal parameters (see Section "Signal correction GPOC (Gain Phase Offset Correction)" on page 74).

P 577[0] - ENC_CH3_EncObsMin = Encoder monitoring minimum, sqrt(a^2+b^2)

The parameter EncObsMin is used to scale the Sin/Cos wire break monitoring and represents the “downwards threshold” for an error message. The default setting is 0.2, corresponding to approx. 20% of the track signals’ amplitude (approx. 80% corresponds to approx. 1 Vss). If EncObsMin is set to 0, Sin/Cos wire break monitoring will be disabled (also see Section "Channel 3: Interface X8 (optional)" on page 76).

P 581[0] - ENC_CH3_AbsEncStatus = Error and status codes (absolute encoder)

P 582[0] - ENC_CH3_PeriodLen = Sin/Cos linear encoder and P 583[0] - ENC_CH3_DigitalResolution = linear absolute encoder are the length of an analog Sin/Cos signal period in nanometres and the length of a digital increment of the position from the absolute value interface in nanometres. Both parameters are used for linear EnDat encoders (instead of MultiT and SingleT bits (rotary)). In contrast, linear SSI encoders are

# 6 Encoder

MOOG ID No.:CB40859-001 Date:11/2020

# MSD ServoDrive - DeviceHelp

treated as rotary SSI encoders (in this case, it is impossible to determine that the system is a linear encoder system based on the encoder head). Likewise, linear Sin/Cos encoders without an absolute value interface are treated as “rotary” encoders (if run as commutation encoders, the number of tracks, or lines (Lines) and the encoder gearing (Num, Denom) must be used to establish the relationship to the linear motor’s magn. pole pair subdivision). Only in the case of Sin/Cos encoders with distance-coded reference marks will the system determine, based on PeriodLen > 0, that the encoder system is linear and not rotary.

# Value Initialization:

- DIG_ANA(0) - Standard: Absolute value initialization using a mix of the digital and analog components (this is the default mode)
- DIG(1) - Digital: Only the digital component will be used for the absolute value initialization.
- SEK_SEL37(2) - Automatic: Digital if ST bits > (LineBits + 8); otherwise standard
- SSI_180(3) - Same as Standard, except: In the case of SSI, the quadrant alignment of the digital value relative to the analog Sin/Cos tracks is not the same as with EnDat, but is instead offset by 180 degrees relative to EnDat, i.e. in the “natural Q alignment” for the digital value relative to the tracks.

# Encoder Information

P 580[0] - ENC_CH3_Info = Encoder Information. This parameter is available to the user so that they can enter a text of their choice (max. 31 characters). This text should be used to describe the encoder on channel Ch3.

# Sampling Cycle

P 636[0] - ENC_CH3_CycleCount = Sampling cycle in: n x 125 μs (microseconds): The CycleCount parameter can be used to slow down the timing for the cyclical SSI encoder evaluation. By default, CycleCount = 1, i.e. the default setting corresponds to 125 μs sampling and cycles for the encoder evaluation. Different settings must be viewed as special cases and accordingly must only be used when necessary. (see Section "SSI (cyclical) X8" on page 87).

# Distance Coded Absolute Encoder

P 630[0] - ENC_CH3_NominalIncrementA = distance coded absolute encoder

P 631[0] - ENC_CH3_NominalIncrementB = distance coded absolute encoder. The NominalIncrementA and NominalIncrementB parameters make it possible to run Sin/Cos incremental encoders (without an absolute value interface) with analog distance-coded reference marks. E.g. If you were using the Heidenhain ROD280C with 18000 Sin/Cos tracks per revolution and 36 distance-coded reference marks, you would need to set NominalIncrementA to 1000 signal periods and NominalIncrementB to 1001 signal periods. This functionality is enabled if NominalIncrementA > 0. (see Section "Increment-coded reference marks" on page 105).

# Mode Absolute Value Formation

P 637[0] - ENC_CH3_AbsInitMode = Mode absolute value formation. AbsInitMode can be used to select various possible settings for the absolute.

# 6.7.5.2.5 SSI Absolute Value Interface

If P 570[0] - ENC_CH3_Abs = SSI(1), which is the normal setting, the absolute SSI encoder position will be read once during the initialization phase; after this, the cyclical encoder position will be acquired based on the Sin/Cos incremental component.

# 6.7.5.2.6 EnDat Absolute Value Interface

If P 570[0] - ENC_CH3_Abs = ENDAT(2), the absolute EnDat encoder position will be read once during the initialization phase; after this, the cyclical encoder position will be acquired based on the Sin/Cos incremental component.

The parameters for the EnDat interface are described in Section "EnDat SSI encoder basics and requirements (cyclical) X7" on page 61, as are the differences in using the EnDat interface with the “cyclical” method and “one-time reading” method.

NOTE

- Special TTL encoders with commutation tracks can be run on encoder channel Ch3 (X8) by setting P 507[0] - ENC_CH3_Sel to TTL_COM(5).

# 6.7.6 SSI (cyclical) X8

# Ch3: SSI(2) - Cyclical SSI

The software versions required to run the SSI encoder interface are the standard software versions for the MSD Servo Drive and MSD Single-Axis Servo Drive Compact.

NOTE

- Please note the limitations that apply when running EnDat and SSI encoders (see Section "Limiting for EnDat and SSI" on page 52).

SSI (Synchronous Serial Interface) is a digital encoder interface that is supported by a large number of manufacturers. It is not standardized, meaning that manufacturers are free to support the interface as they like. The pseudo-standard described below has however been established for motor feedback interfaces. Moog supports this version first and foremost.

|Parameter|Description|
|---|---|
|Clock and data inactive level|HIGH|
|The current position must be internally stored|at the first falling clock edge|
|No lengthened calculation time|(in first cycle)|
|With the first rising clock edge|the encoder must shift the data to the first position bit to be transmitted (MSB)|
|Rate|1 Mbps|
|Data coding|Binary or Gray|
|Reading data after the data bits end|is permissible|
|Cycle|125 μs (i.e. internal position refresh rate ≪125 μs)|
|Monoflop time|≥ 6 μs|
|Data lines driven with logic 0|during monoflop time|
|No parity bit| |
|No error bits or other status bits| |
|MultiTurn bits|≤14|

MOOG ID No.:CB40859-001 Date:11/2020 MSD ServoDrive - DeviceHelp 87

# 6 Encoder

# 6 Encoder

MOOG ID No.:CB40859-001 Date:11/2020

# MSD ServoDrive - DeviceHelp

SSI wire break monitoring (bit monitoring during monoflop time) The Sel, Lines, MultiT and SingleT parameters are self-explanatory. If monitoring is enabled, the controller, as the SSI clock master, will read data for one more clock cycle after the data bits (reading data after the data bits end is permissible). The bit that the master reads in addition to the data bits this way comes from the SSI encoder’s monoflop time. At the time corresponding to this bit, the SSI encoder must drive the data lines with a logic 0. If the data lines on connector X8 are open, a logic 1 will be read here. The bit monitoring at this point makes it possible to determine whether the SSI data lines are being actively driven with a logic 0 at this point (no “wire break”) or are not (“wire break”). SSI wire break monitoring can be disabled by setting P 576[0] - ENC_CH3_Mode to 0001h.

# Mode parameters and CycleCount parameters

P 576[0] - ENC_CH3_Mode can be used to run a parity evaluation after the data. In addition, ENC_CH3_Mode makes it possible to run special SSI encoders that deliver one or more special bits after the data. In this case, the MSD Servo Drive will not evaluate these bits – this mode is meant to make it possible to work with SSI encoders that require for these bits to be sampled. P 636[0] - ENC_CH3_CycleCount makes it possible to run slower SSI encoders that cannot handle the required cycle of 125 μs. The control characteristics will deteriorate when using this type of SSI encoder, which is why doing so is not recommended.

Following is a list of what some of the terms in the table below stand for:

- Data = Sequence of all data bits
- EncObs = Wire break bit
- Nothing = No bit
- POdd = Odd parity bit
- PEven = Even parity bit
- Free = A free bit

**Table 6.25: Encoder configuration channel 3 (X8) - SSI parameters**
|ID|Index Name|Unit|Description|
|---|---|---|---|
|507|ENC_CH3_Sel = 2|=SSI(2)| |
|573|ENC_CH3_MultiT|Number of MultiTurn bits (absolute encoder)| |
|574|ENC_CH3_SingleT|Number of SingleTurn bits (absolute encoder)| |
|575|ENC_CH3_Code|Code selection (SSI absolute encoder)| |
|576|ENC_CH3_Mode|Mode selection (SSI absolute encoder)| |
|584|ENC_CH3_MTBase|Minimum MultiTurn position (SSI absolute encoder)| |
|585|ENC_CH3_MTEnable|encoder| |
|600|ENC_CH3_Position|inc|Position encoder channel 1|
|636|ENC_CH3_CycleCount|Channel 3: Position encoder sampling cycle (n x 125 μsec)| |

# 6 Encoder

# 6.7.7 Encoder gearing

Encoder channels Ch1 to Ch3 each feature their own encoder gearing, while encoder channel Ch4 (virtual encoders) does not feature any encoder gearing.

|ID|Value Name|
|---|---|
|576|ENC_CH3_Mode|
|0000h|Data_EncObs|
|0001h|Data_Nothing|
|0002h|Data_POdd_EncObs|
|0003h|Data_Free_POdd_EncObs|
|0004h|Data_POdd|
|0005h|Data_Free_POdd|
|0006h|Data_Free_EncObs|
|0007h|Data_Free_Free_EncObs|
|000Ch|Data_PEven_EncObs|
|000Dh|Data_Free_PEven_EncObs|
|000Eh|Data_PEven|
|000Fh|Data_Free_PEven|
|001Fh|Data_Free|
|0020h|Data_Free_Free|
|0021h|Data_Free_Free_Free|
|0022h|Data_Free_Free_Free_Free|

Table 6.26: SSI mode parameters (all other values are reserved)

P 636[0] - ENC_CH3_CycleCount = Sampling cycle in: n x 125 μs (microseconds): ENC_CH3_CycleCount can be used to slow down the timing for the cyclical SSI encoder evaluation. By default, ENC_CH3_CycleCount = 1, i.e. the default setting corresponds to 125 μs sampling and cycles for the encoder evaluation. Different settings must be viewed as special cases and must only be used when necessary.

|P No.|Index Name|Unit|Description|
|---|---|---|---|
|510|0|ENC_CH1_Num|Denominator of channel 1|
|511|0|ENC_CH1_Denom|Numerator of channel 1|
|512|0|ENC_CH2_Num|Denominator of channel 2|
|513|0|ENC_CH2_Denom|Numerator of channel 2|
|514|0|ENC_CH3_Num|Denominator of channel 3|
|515|0|ENC_CH3_Denom|Numerator of channel 3|

NOTE

Please read the general information on encoder gearing found in Section "Introduction" on page 52 beforehand.

MOOG ID No.:CB40859-001 Date:11/2020 MSD ServoDrive - DeviceHelp 89

# 6 Encoder

MOOG ID No.:CB40859-001 Date:11/2020

# MSD ServoDrive - DeviceHelp

Parameters

6.8 Channel 4: Virtual encoder

- P 500[0] - ENC_CH1_ActVal[0].SingleTurn and
- P 500[1] - ENC_CH1_ActVal[1].MultiTurn

are used, for example, to indicate the current position value at the output for encoder channel Ch1. These parameters can also be used for checking purposes during commissioning.

NOTE

- This value at the encoder channel output...

The encoder gearing ratio has a multiplicative effect on the position progress, i.e. either “expanding” or “compressing”.

A distinction can be drawn between an encoder’s motor mode and field mode:

- Motor mode: The encoder is the motor commutation encoder
- Field encoder: The encoder is not the motor commutation encoder (instead, it is an additional encoder in the “field”, e.g. used for position control purposes)

In motor mode, the encoder gearing is used exclusively to synchronize the motor shaft with the encoder shaft (default: 1:1 if the shaft is the same). In this case, a position progress value will be passed to the system at the encoder channel output. This value will be proportional to the position progress of the motor’s commutation (adjusted for the pole pair number).

In field mode, the encoder gearing can be used “freely” for scaling purposes.

Image 6.6: Virtual encoder screen

# 6.8.1 Sensorless control synchronous motor

NOTE

Sensorless control with an expanded Kalman filter requires the following firmware versions:

- MSD Servo Drive: V123-95 or higher
- MSD Single-Axis Servo Drive Compact: V1.30-98

|Value|Value replacement text|Description|
|---|---|---|
|4|START_KAL|Starts and initializes the Kalman filter without determining the noise covariance matrices and without configuring the test signal generator|
|5|STOP_KAL|Stop encoder module CH4|
|6|CALC_RQ|Calculates noise covariance matrices R and Q based on the configured motor parameters|
|0|READY|Waits for input|
|1|TAKEOVER_ENC CH1|Switches to encoder channel 1 in real-time|
|2|TAKEOVER_ENC CH4|Switches to encoder channel 4 in real-time|
|General initialization for encoder channel 4 with sensorless control; the following are carried out during this initialization routine:|General initialization for encoder channel 4 with sensorless control; the following are carried out during this initialization routine:|General initialization for encoder channel 4 with sensorless control; the following are carried out during this initialization routine:|
|3|PRESET|The test signal generator is configured|
|The Q matrix, R matrix are calculated. The Kalman filter is initialized.|The Q matrix, R matrix are calculated. The Kalman filter is initialized.|The Q matrix, R matrix are calculated. The Kalman filter is initialized.|

# Table 6.28: Control word ENC_CH4_Ctrl (P783)

|P No.|Index Name|Unit|Description|
|---|---|---|---|
|339|CON_SCON_Kalman| |Kalman: Setting|
|0|Tf_Kalman|ms|Kalman: Integration time|
|1|KpScale_Kalman|%|Kalman: Gain|
|350|CON_SCALC_SEL| |Used to select the speed calculation method|
|0|SEL_ObserverMethod| |Selection of speed calculation method|
|508|ENC_CH4_Sel| |Selection of encoder type|
|783|ENC_CH4_Ctrl| |Control|
|790|ENC_CH4_Kalman_R| |Sensorless control: R-Matrix|
|791|ENC_CH4_Kalman_Q| |Sensorless control: Q-Matrix|
|791|Q[0,0]| |Sensorless control: Q-Matrix (id)|
|791|Q[1,1]| |Sensorless control: Q-Matrix (iq)|
|791|Q[2,2]| |Sensorless control: Q-Matrix (omega)|
|791|Q[3,3]| |Sensorless control: Q-Matrix (epsilon)|
|791|Q[4,4]| |Sensorless control: Q-Matrix (T Last)|

# Table 6.29: “Sensorless synchronous motor control” parameters

|ID No.|Date|Device|
|---|---|---|
|CB40859-001|11/2020|MSD ServoDrive - DeviceHelp|

# 6 Encoder

MOOG ID No.:CB40859-001 Date:11/2020 MSD ServoDrive - DeviceHelp 92

|P No.|Index Name| |Unit|Description| |
|---|---|---|---|---|---|
|792|2 d-Amplitude sinus|A|SC test signal: d current amplitude of sinusoidal signal| | |
|792|3 q-Amplitude sinus|A|SC test signal: q current amplitude of sinusoidal signal| | |
|792|4 PRBS time| |ms|SC test signal: PRBS signal time| |
|792|5 d-Amplitude PRBS|A|SC test signal: d current amplitude of PRBS signal| | |
|792|6 q-Amplitude PRBS|A|SC test signal: q current amplitude of PRBS signal| | |
|792|7 Full signal range| |rpm|SC test signal: Full test signal amplitude range| |
|792|8 Increasing signal range| |rpm|SC test signal: Linear transition range up until which the test signal is reduced to 0| |
|792|9 d-current offset|A|SC test signal: d current offset of sinusoidal signal| | |
|794|ENC_CH4_Kalman_ICOM| | |Sensorless control: Auto commutation| |
|0 SettlingTime| | |ms|SC auto commutation: Rise time| |
|794|1 ICOM_current| |A|SC auto commutation: Current offset| |
|794|2 ICOM_time| |ms|SC auto commutation: Time (0 = OFF)| |
|794|3 ICOM_1st_L_ident| |mH|SC auto commutation: First measured inductance| |
|794|4 ICOM_2nd_L_ident| |mH|SC auto commutation: Second measured inductance| |
|796|ENC_CH4_Kalman_isd_add|Sensorless control: Additive load-dependent d current| | | |
|0 Amplitude|A| | |SC load-dependent d current: Amplitude| |
|796|1 Full signal range| | |A|SC load-dependent d current: q current at which the maximum d current is injected|
|796|2 Increasing signal range| | |A|SC load-dependent d current: Transition range up until which the d current is reduced to 0|
|796|3 PT1_Tfil| |ms|SC load-dependent d current: Filter time for d current (PT1)| |
|797|0 ENC_CH4_Kalman_| | |Sensorless control: Reference encoder| |

Table 6.29: “Sensorless synchronous motor control” parameters (continue)

P 792[1] - Frequency and P 792[2] - d-Amplitude sinus will be used as the measuring frequency and measuring amplitude. In addition, P 794[0] - SettlingTime, P 794[1] - ICOM_current and P 794[2] - ICOM_time need to be configured.

# 6.8.1.2 Test signal generator

The test signal generator is required in order to ensure that the Kalman filter will be able to estimate position and speed information even at low speeds (all the way to a stop). There are various signals available for this purpose.

The forms available are a sinusoidal signal and a 32-bit PRBS signal. The frequencies can be freely selected within a range of 100 Hz to 1000 Hz. In addition, there is the option of subjecting the d or q axis to the signals either individually (in an additive manner) or in combination (in a multiplicative manner).

P 792[0] - Signal: 0 = No measuring signal; 1 = Addition; 2 = Multiplication

When using the additive solution, each signal will have its own amplitude. In contrast, when using the combination solution, only the amplitude value of the sinusoidal signal will be used.

In addition, scaling for the test signal amplitudes has been implemented. This ensures that the signal can be applied gradually over a specified speed range. The following is recommended as a good test signal: A sinusoidal signal with a current amplitude of approx. 10% of the rated current on the d axis with a frequency of approx. 400 Hz. (P 792[0] = 1; P 792[1] = 400; P 792[2] = 10% Irated) can be defined as necessary.

In the case of problematic motors, it can be useful to inject an additive d current. This current can be configured to be dependent on the speed (P 792[9] - d current offset) or load (796). The following two diagrams use examples to illustrate the influence that the ramp parameters have on the additive d components. Please note, however, that this current will also increase motor losses, meaning it should only be used in exceptional cases.

MOOG ID No.:CB40859-001 Date:11/2020 MSD ServoDrive - DeviceHelp 93

# 6 Encoder

MOOG ID No.:CB40859-001 Date:11/2020

# MSD ServoDrive - DeviceHelp

6.8.1.3 Expanded speed control circuit

There is the option of setting up an expanded speed control circuit when using sensorless control. The reason for this is that the estimated speed from the Kalman filter cannot be calculated with steady-state accuracy, as parameter inaccuracies are inherent to the model.

Because of this, the speed from the angular derivative is used for “normal” speed control. The angular change describes the difference between two predicted angular positions from consecutive sampling steps. Dividing eps_diff by the observer’s sampling time yields speed n_eps, which, although admittedly noisier than the calculated Kalman filter speed, is accurate in a steady state. However, the heavy noise means that relatively long filter times are required, resulting in the loss of some of the control circuit’s dynamic performance.

In order to be able to use a control scheme with high dynamic performance and steady-state accuracy, a circuit must be put together using two actual speed values (the speed from the angular derivative [n_eps] and the speed from the Kalman filter [n_kal]).

# Image 6.8: Parameter 792 diagram

Id [A]

0 792[9]

# Image 6.9: Parameter 796 diagram

0 796[0]

Iq [A]

796[1]

796[2]

# 6.8.1.4 Commissioning

The first step in commissioning sensorless control is correctly determining the motor data and control parameters and configuring them accordingly. At this point, it is especially important to ensure that the inductance difference between the motor’s d and q axes is set correctly. This can be done with P 480[0] - MOT_Lsq. If this parameter is not available (older firmware), P 472[0] - MOT_LsigDiff can be used to set the difference as a percentage.

In order to obtain an accurate number, the values for the d and q inductances should:

- Be obtained from the motor manufacturer’s data sheet or the motor data set OR
- Be requested from the motor manufacturer OR
- Be measured by Moog with an “advanced motor identification” routine OR
- Be determined as an approximation for most motors with the motor identification routine

If none of these options is available, it is possible to start with a rough setting of Lq = 110% • Ld for a test with a servomotor. However, you must then be ready for limited operation within a narrow speed range.

Before being fed into the circuit, speeds n_kal and n_eps can each be smoothed with a filter (P 351[0] for n_eps and P 339[0] for n_kal). The expanded speed control circuit can be started with P 350[0] (“4” => Kalman).

The inductance difference is important when it comes to sensorless control, as the Kalman filter can determine the position based on the inductance difference in.

Image 6.10: Expanded speed controller layout

Measurements have shown that, when using the expanded control circuit, motors with a marked saliency can be operated in a sensorless manner even without a test signal.

# 6 Encoder

MOOG ID No.:CB40859-001 Date:11/2020

MSD ServoDrive - DeviceHelp 96

In combination with a test signal when the motor is stopped. In addition, the total moment of inertia resulting from the motor and the connected load must be set as accurately as possible.

The encoder communications will be used to calculate and pass the actual speed and actual position. Accordingly, in order to select the sensorless method, a value of 2 must be set for encoder channel 4 in the selector (P 508[0] - ENC_CH4_Sel = 2), and a value of 4 must be set for P 520[0] - ENC_MCon, P 521[0] - ENC_SCon and P 522[0] - ENC_PCon.

The Kalman filter needs to be configured further by following the steps below:

|Step|Action|
|---|---|
|1|Automatically configure noise covariance matrices Q and R by setting the control parameter for encoder channel 4 (P 783[0] - ENC-CH4-Ctrl) to a value of 6.|
| |Manually configure the test signal generator:|
| |Recommendation: Sinusoidal test signal in d axis|
| |P 792[09] = 1|
| |P 792[19] = 500 Hz|
| |P 792[2] = P 792[9] = 10% of rated motor current|
| |P 792[79] = 15% of rated motor speed|
| |P 792[89] = 5% of rated motor speed|
| |P 792[9] = 30% of rated motor current|
| |Set the other values to 0|
|2|Or set the control parameter for encoder channel 4 (P 783[0] - ENC-CH4-Ctrl) to a value of 3, which will trigger a general initialization routine in which steps 1 and 2, as well as encoder initialization, will be automatically carried out based on the motor parameters.|

# Table 6.30: Configuring the Kalman filter for sensorless control

# Step

# Action

In order to make the encoderless control commissioning process easier, a function used to calculate the position difference between encoderless control and a real encoder can be activated. To use this function, the encoder channel that will be used for the comparison must be selected in P 797[0] - ENC_CH4_Kalman_Compare.

As described in Section "Auto commutation" on page 92 or Recommendation:

- P 390[0] = 1
- P 392[0] = 500
- P 392[1] = 500
- P 392[2] = 500
- P 392[3] = 500
- P 393[0] = Rated motor current
- P 393[1] = Rated motor current

# Mode 2

Parameters 792.1 and 792.2 are used as the measuring frequency and measuring amplitude (see step 2)

Recommendation:

- P 794[0] = 100 ms
- P 794[1] = 50% of rated motor current
- P 794[2] = 250 ms

Starting the expanded speed control circuit is not absolutely necessary, but will result in control with better dynamic performance. The circuit can be started by setting P 350[0] - SEL_ObserverMethod to a value of 4. P 339 - CON_SCON_Kalman can be used for tuning purposes. If necessary, adjust the noise covariance matrices and the filter time constants for the expanded speed control circuit (changes will take effect in real-time).

# Table 6.30: Configuring the Kalman filter for sensorless control (continue)

MOOG ID No.:CB40859-001 Date:11/2020

MSD ServoDrive - DeviceHelp 97

# 6 Encoder

# 6 Encoder

MOOG ID No.:CB40859-001 Date:11/2020

# 6.8.2.1 Activation of sensorless control for asynchronous motors

Proceed as follows:

|No.|Activity|
|---|---|
|1|Set motor type (P 450[0] - MOT_Type) to “2 (ASM) = asynchronous motor”.|
|2|Enter the motor name (P 451[0] - MOT_Name).|
|3|Copy the motor variables from the rating plate into the appropriate input box.|
|4|Start motor identification to identify other motor parameters. In the “Encoder selection” screen (see also section "Encoder selection" on page 53) under “Encoder for commutation and torque control,” set P 520[0] - ENC_MCon to “CH4(4) = virtual encoder (Channel 4)”.|
|5|Under “virtual encoder (Channel 4)” "Encoder selection" set (P 508[0] - ENC_CH4_Sel) to "SFC(8) = take values of SFC model".|
|6|In the “Basic Control Settings” screen (see section “Basic settings” on page 101) set “Speed filter TF” (P 351[0] - CON_SCALC_Tf) to 10 ms. In the “Asynchronous motor control settings identification” screen (see also section "Asynchronous motor" on page 38) enter the “Total moment of inertia” of the system (P 1516[0] - SCD_JSum). Enter a value that is too small rather than too big to avoid a tendency to oscillate. Automatic detection is not advisable due to the control dynamics and accuracy required.|
|7|In the same screen under “Control design by stiffness” set P 1515[0] - SCD_ConDesign (Stiffness) to 10%.|

# Table 6.31: Commissioning a sensorless-controlled asynchronous motor

|P No.|Index Name|Unit|Description|
|---|---|---|---|
|351|CON_SCALC_Tf| |Speed filter|
| |0|ms|Filter time const. speed control (motor)|
| |1|ms|Filter time const. velocity (hydraulic cyl.)|
|792|2|ms|Filter time const. speed from position control.|
| |0| |EN_CH4_Kalman_SigInj Sensorless control: Test signal generator.|
| |7|Signal|FullSignalRange rpm SC test signal: Linear transition range up until|
| |8|rpm|IncreasingSignalRange which the test signal is reduced to 0.|
| |9|A|d current offset SC test signal: d current offset of sinusoidal signal.|
|1959|CON_SFC_Para| |SFC Parameter|
| |0|ms|TF_is filter time constant of isd/isq.|
| |1|%|K_ov Anti-overturning limitation factor.|
| |2|%|K_isd d-axis current control scaling.|
| |3|ms|Tstart start-up time (flux settling).|
|1973|CON_SFC_VoltageError| |Settings for SFC voltage errors model. Low voltage characteristic: must be set during the motor identification; may require some coordination effort.|
| |0|A|low-voltage characteristic: corner current|
| |1|V|low-voltage characteristic: corner voltage.|

# Table 6.32: "Sensorless control of asynchronous motor” parameter

# 6.8.2.2 Start-up of a sensorless-controlled asynchronous motor

If the stability and the torque in the proximity of standstill are inadequate, use the current/frequency mode (I/f). Set P 792[0] Switch = 2. Set the speed limits P 792[7] and P 792[8] lower than for the use of flux boost. The d current P 792 [9] must be adequate to set the maximum possible load in motion when starting.

|P No.|Index Name|Unit|Description|
|---|---|---|---|
|792|0|EN_CH4_Kalman_SigInj|Sensorless control: Test signal generator|
|792|7|Signal|FullSignalRange|
|792|8|IncreasingSignalRange|rpm SC test signal: Linear transition range up until which the test signal is reduced to 0|
|792|9|d current offset|A SC test signal: d current offset of sinusoidal signal|

# Table 6.33: Parameters for start-up of a sensorless-controlled asynchronous motor in I/f mode

Whether a setting of "2" or "3" is the better choice depends on the application. An asynchronous motor is not suitable for sensorless positioning due to its design because the rotor does not have a fixed magnetic pole. Moreover, asynchronous motors controlled without sensors tend to have unstable behaviour at low speeds and low torques in generator mode.

First attempt to use the SFC controller in the proximity of the standstill. (P 792.0 signal = 0). This allows gentle operation and an optimal torque utilization. Set the standstill behaviour with the error voltage model P 1973.1 U_err; generally, a setting of 50% of the original setting yields good results.

It is possible that a flux boost may improve the results at low speeds when a large load is set in motion from a standstill. Set P 792[0] Signal =1, P 792[1] to 50 . . .200 rpm, P 792[2] to 200 . . . 500 rpm and P 792[7] to the d current required for starting. If the motor tends to tip, then attempt to limit the permissible slip using P 1959[1] K_ov.

MOOG ID No.:CB40859-001 Date:11/2020

MSD ServoDrive - DeviceHelp 99

# 6 Encoder

MOOG ID No.:CB40859-001 Date:11/2020

# MSD ServoDrive - DeviceHelp

# 6.9 Redundant encoder

It is possible to set the position difference between the positioning encoder and a redundant encoder. To do this, the channel of the redundant position encoder must be specified in P 524[0] - ENC_EncRedPos and the maximum position tracking error must be specified, in increments, in P 597[0] - ENC_RedPos_DiffMax. Monitoring is not active if P 524[0] = 0 and the drive has been referenced. It is reset when the associated error is acknowledged or homing is executed again.

# 6.10 Axis correction

The position value delivered by the encoder system and the actual position value on the axis may vary for a number of reasons. Such non-linear inaccuracies can be compensated by axis error correction (using position- and direction-dependent correction values). For this, a correction value table is filled with values for each of the two directions. The respective correction value is produced from the current axis position and the direction of movement by means of cubic, jerk-stabilized interpolation. The position value is adapted on the basis of the corrected table. Both tables contain 250 interpolation points.

|P No.|Index Name|Unit|Description|
|---|---|---|---|
|524|0|ENC_EncRedPos|Selection of the channel (1-3) with which the position encoder is to be evaluated.|
|597|0|ENC_RedPos_DiffMax|Maximum position tracking error setting|

Table 6.34: Parameters for monitoring the position difference

The correction range is within the value range delimited by parameters P 591 - ENC_ACOR_PosStart "Start position" and P 592 - ENC_ACOR_PosEnd "End position correction". The start position is preset on the user side; the end position is determined on the drive side.

# Possible cause of deviations

- Inaccuracy of the measuring system
- Slack in mechanical elements such as the gearing, coupling, feed spindle etc.
- Thermal expansion of machine components.

# Table 6.35: Axis correction parameters (continue)

|P No.|Index|Name / Setting|Unit|Description|
|---|---|---|---|---|
|593|0|ENC_ACOR_PosDelta| |Interpolation point pitch: The positions at which the correction interpolation points are plotted are defined via parameters P 0593 ENC_ACOR_PosDelta Interpolation point pitch and P 0591 ENC_ACOR_PosStart Start position. Between the correction interpolation points, the correction values are calculated by cubic spline interpolation.|
|594|0|ENC_ACOR_Val| |Actual position|
|595|0-250|ENC_ACOR_VnegTab| |Values of the correction table for negative direction of rotation in user units.|
|596|0-250|ENC_ACOR_VposTab| |Values of the correction table for positive direction of rotation in user units.|

# Table 6.35: Axis correction parameters

|P No.|Index|Name / Setting|Unit|Description|
|---|---|---|---|---|
|530|0|ENC_Encoder1Sel| |Channel selection for the 1st encoder used|
|531|0|ENC_Encoder2Sel| |Channel selection for the 2nd encoder used|
|590|0|ENC_ACOR_Sel| |0 (= OFF) No encoder selected 1 (= 1st Encoder) 1. encoder selected 2 (= 2nd Encoder) 2. encoder selected|
|591|0|ENC_ACOR_PosStart| |Definition of correction range: The range is defined by parameters P 0591 ENC_ACOR_PosStart Start position and P 0592 ENC_ACOR_PosEnd end position.|
|592|0|ENC_ACOR_PosEnd| |The start position is user-specified; the end position is determined on the device side from the maximum value of correction table interpolation points used and the interpolation point pitch.|

MOOG ID No.:CB40859-001 Date:11/2020

MSD ServoDrive - DeviceHelp 101

# 6 Encoder

# 6 Encoder

MOOG ID No.:CB40859-001 Date:11/2020

# MSD ServoDrive - DeviceHelp

# Step Action

# Position control

1. Use P 530 - ENC_Encoder1Sel to select the channel for SERCOS: 1st encoder
2. Use P 531 - ENC_Encoder2Sel to select the channel for SERCOS: 2nd encoder
3. Selection of the encoder whose actual position value is to be changed, with P 590 - ENC_ACOR_Sel
4. Enter interpolation point pitch in P 593 - ENC_ACOR_PosDelta
5. The correction values are determined using a reference measurement system (e.g. laser interferometer). The interpolation points for the various directions within the desired correction range are approached one after another and the corresponding position error is measured.
6. The interpolation point-specific correction values are entered manually in tables P 595 - ENC_ACOR_VnegTab (neg. direction) and P 596 - ENC_ACOR_VposTab (pos. direction).
7. Save values
8. Restart the device
9. P 592 - ENC_ACOR_PosEnd now shows the position end value of the correction range.
10. Start control (in position control execute homing) and then move to any position. The momentary correction value is written to P 594 - ENC_ACOR_Val. This value is subtracted from the approached position value. This applies to all positions. End position = interpolation point pitch multiplied by number of interpolation points (table values) + start position (only if start position ≠ 0).

# Table 6.36: Axis correction procedure

# Correction factor

NOTE

|Endposition|P 0592|
|---|---|
|Startposition|P 0591|

Parameterization is carried out in the selected user unit for the position as integer values. It is advisable to use the same number of correction interpolation points for the positive and negative directions. The first and last correction values in the table must be zero in order to avoid instability (step changes) of the actual position value. Differing correction values for the positive and negative directions at the same interpolation point will lead to instability in the associated actual position value when the direction is reversed, and so possibly to a step response adjustment to the reference position.

# Correction interpolation points

|1|2|3|4|5|6|7.... max. 250|
|---|---|---|---|---|---|---|
|P 0593|Interpolation point distance|Interpolation point distance|Interpolation point distance|Interpolation point distance|Interpolation point distance|Interpolation point distance|

Legend:

- Interpolation point conter clockwise correction
- Interpolation point clockwise correction
- Incorrected Positionvalue (conter-clockwise rotation)
- Incorrected Positionvalue (clockwise rotation)

Image 6.12: Corrected position value

MOOG ID No.:CB40859-001 Date:11/2020

MSD ServoDrive - DeviceHelp 103

# 6 Encoder

# 6 Encoder

MOOG ID No.:CB40859-001 Date:11/2020 MSD ServoDrive - DeviceHelp 104

# 6.11 Oversampling

Encoder signal oversampling optimizes the accuracy of resolver and Sin/Cos signals. This function can only be used, if necessary, for low-track Sin/Cos encoders and resolvers; using it for high-track Sin/Cos encoders is not permissible.

# 6.12 Multi-turn encoder as a single-turn encoder

By way of parameters P 548[0] - ENC_CH1_MTEnable = 1 (for Channel 1) and P 585[0] - ENC_CH3_MTEnable = 1 (for Channel 3) a multi-turn encoder can be run as a single-turn encoder. This function is used primarily for testing purposes.

|ID|Index Name|Unit|Description|
|---|---|---|---|
|1956|CON_ACT_Ovrs| |Encoder signal oversampling. This function applies only to resolver and Sin/Cos signals|
|1956|0|active|Switch for activating and deactivating the function|
|1956|1|pmeas|The percentage measuring time for oversampling dependent on the sampling time.|
|1956|2|filtershift|Limit frequency for the oversampling filter|
|1956|3|sourceselect|Signal source for oversampling|
|1957|CON_ACT_Ovrs_Tracks| |Oversampled track signals|
|1957|0|Track_a| |
|1957|1|Track_b| |

# NOTE

When oversampling is enabled, instead of the normal A/D signals the oversampled signals for the encoder specified in parameter P 1956[3] - sourceselect are used. In the case of high-track Sin/Cos encoders in particular, the low limit frequency of the oversampling filters may result in quadrant errors. If the oversampling units are used, it must always be certain that the encoder does not dramatically exceed the specified limit frequencies.

Before using oversampling, consult with your project supervisor or the Moog Helpline.

# 6.13 Increment-coded reference marks

In the case of encoders with increment-coded reference marks, multiple reference marks are distributed evenly across the entire travel distance. The absolute position information, relative to a specific zero point of the measurement system, is determined by counting the individual measuring increments between two reference marks. The absolute position of the scale defined by the reference mark is assigned to precisely one measuring increment. Before an absolute reference can be created or the last selected reference point found, the reference mark must be passed over. In the worst-case scenario this requires a rotation of up to 360°. To determine the reference position over the shortest possible distance, encoders with increment-coded reference marks are supported (e.g. HEIDENHAIN ROD 280C).

The reference mark track contains multiple reference marks with defined increment differences. The tracking electronics determines the absolute reference when two adjacent reference marks are passed over after just a few degrees of rotation.

# Image 6.13: Schematic view of circular graduations with increment-coded reference

|Number of pulses (P 542)|Number of reference marks|Basic increment G Nominal Increment A (P 610)|Basic increment G Increment-coded reference measure B, large increment (1001 lines): P 611[0] -|
|---|---|---|---|
|18 x 1000 lines|18 basic marks + 18 coded marks = Σ 36|Reference measure A = 1000 lines corresponding to 20°|Reference measure B = 1001 lines|

Zero point: Parameter P 542[0] - ENC_CH1_Lines is used to enter the number of lines (e.g. 18 x 1000). A sector increment difference of +1, +2, +3 and +4 is supported. One mechanical revolution is precisely one whole multiple of the basic increment A.

# Legend for Schematic view of circular graduations with increment-coded reference marks

MOOG ID No.:CB40859-001 Date:11/2020 MSD ServoDrive - DeviceHelp 105

# 6 Encoder

MOOG ID No.:CB40859-001 Date:11/2020

# MSD ServoDrive - DeviceHelp

# 6.14 Overflow in multi-turn range

With this function the multi-turn range can be shifted in order to avoid a possible overflow. The function is available for encoder channels 1 and 3.

# Example

If a portion of the travel distance is to the left of the threshold (MT Base), it is appended to the end of the travel range (to the right of the 2048) via parameter P 547[0] - ENC_CH1_MTBase for encoder channel 1 and P 584[0] - ENC_CH3_ for encoder channel 3 (unit: increments).

For more information see Section "Main parameters for encoder channel Ch1" on page 60 and Section "Sin/Cos incremental encoders with absolute value interface" on page 65.

# Image 6.14: Schematic diagram of a linear scale

- ① Pitch periods (TP): (P 542[0] - ENC_CH1_Lines)
- ② Reference marks
- ③ Increment-coded reference measure A (small reference mark interval) (P 610[0] - ENC_CH1 Nominalinkrement A)
- ④ Increment-coded reference measure B (large reference mark interval) (P 611[0] - ENC_CH1 Nominalinkrement B)

# Legend for Schematic diagram of a linear scale

# Homing methods for increment-coded encoders

- l Method -6: Increment-coded encoders with negative direction of rotation
- l Method -7: Increment-coded encoders with positive direction of rotation

# Image 6.15: Multi-turn range shifting

# 6 Encoder

|P No.|Index Name|Unit|Description|
|---|---|---|---|
|547|0 ENC_CH1_MTBase| |Definition of point of discontinuity in multi-turn range|
|584|0 ENC_CH3_MTBase| |Definition of point of discontinuity in multi-turn range|

To enable evaluation for the zero pulse test, P 541/P 571 = ON (1) is set. On the oscilloscope it can then be depicted with the measurement variables CH1/3_Np. To make the zero pulse clearly visible, the measurement variable remains high until the next zero pulse appears. Conversely, the measurement variable remains low until another zero pulse appears. Bear in mind that the pulse width of the scope signal does not match the pulse width of the actual zero pulse.

# Table 6.39: Parameters for shifting the multi-turn overflow

Image 6.16: Zero pulse recording via measurement variable CH1/3_Np

# NOTE

- When in zero pulse test mode, zero pulse evaluation will not be available during homing.
- Regardless of this, all zero pulse events will be counted. The zero pulses are counted by counter evaluation P 411[31] for channel 1 and P 411[32] for channel 3 (under ►Actual values ►All values in the Moog DRIVEADMINISTRATOR 5).

MOOG ID No.:CB40859-001 Date:11/2020

MSD ServoDrive - DeviceHelp 107

# 7 Control

# 7.1 Overview of control structure

This chapter describes the various control types, settings and optimisation options and recommended procedures.

# Contents

- 7.1 Overview of control structure 108
- 7.2 Basic settings 110
- 7.3 Torque controller 113
- 7.4 Speed controller 131
- 7.5 Position controller settings 140
- 7.6 Asynchronous motor field weakening 143
- 7.7 Field weakening and LookUpTable (LUT), synchronous motor 146
- 7.8 Synchronous motor auto commutation 156
- 7.9 V/Hz mode 165
- 7.10 Process controller 166
- 7.11 Hydraulic control 173

Image 7.1: Overview of control structure

|Position control|Speed control|Digital filter|Current control|
|---|---|---|---|
|Interpolation and feed-forward control|Interpolation and feed-forward control|Interpolation and feed-forward control|Interpolation and feed-forward control|

MOOG ID No.:CB40859-001 Date:11/2020

MSD ServoDrive - DeviceHelp 108

# Control

MOOG ID No.:CB40859-001 Date:11/2020

# MSD ServoDrive - DeviceHelp

# Legend for figure Control Structure

# 3. Setting for position controller / Pre-control

Position Controller/Feed see 7.5 Position controller settings

# 7.1.1 Setting

Forward Control

Position controller see 7.5 Position controller settings When using a standard Moog motor data set, the control parameters are preset for the specific motor model (external mass inertia = motor inertia). If using third-party motors, a manual setting must be made for the drive by way of the motor identification or by calculation in order to define the appropriate control parameters for the motor model.

Speed controller see 7.4 Speed controller

Digital filter see 7.4.2 Digital filter

Current Controller see 7.3 Torque controller

Filter/observer see 7.3.6 Advanced torque control

Field weakening, asynchronous see 7.6 Asynchronous motor field weakening

Field weakening, synchronous see 7.7 Field weakening and LookUpTable (LUT), synchronous motor

The setting of the speed controller with the associated filters is dependent on the motor parameters (moment of inertia, torque/force constant, load inertia/mass, friction, rigidity of the connection and encoder quality). Consequently, a manual or automatic optimization is often required.

# 7.1.1.1 Speed control loop

Scanning times of the individual control circuits:

|Switching frequency|Current Controller|Sampling time|Speed controller|Position controller|
|---|---|---|---|---|
|2 kHz|250µs|250µs|250µs| |
|4 kHz (12 kHz)|125µs|125µs|125µs| |
|8 kHz (Presetting)|62.5µs|125 µs|125µs| |
|16 kHz|62.5µs|125µs|125µs| |

Table 7.1: Scanning times of the individual control circuits

The control system is set up in a cascaded configuration. The position, speed and current controllers are configured in sequence. The sequence of controller setup must always be observed in controller optimization.

1. Current controller setup
2. Speed controller setup

# 7.2 Basic settings

CAUTION! Your system/motor may be damaged if put into operation in an uncontrolled or inappropriate manner.

The basic settings for the control are selected and parametrized using the "Motor control setup" screen. This screen aids navigation to the basic settings, various controllers and the control mode.

Improper conduct can cause damage to your system/machine.

- Before the “Start” step, make absolutely sure that a valid setpoint has been entered, as the configured setpoint will be immediately transmitted to the motor after the motor control function starts, which may result in the motor accelerating unexpectedly.

# 7.2.1 Motor control basic settings

Click on the "Basic settings" button opens the wizard to determine the mass inertia, the rigidity wizard, as well as the speed and position controllers.

Image 7.2: “Motor control settings” screen

NOTE

- P 300[0] - CON_CfgCon specifies the control mode with which the drive is to be run. This parameter takes effect online. Uncontrolled online switching can cause an extreme jerk, a very high speed or an overcurrent, which may cause damage to the system.

Image 7.3: “Motor control basic settings” screen

MOOG ID No.:CB40859-001 Date:11/2020

MSD ServoDrive - DeviceHelp 110

# 7 Control

# 7 Control

MOOG ID No.:CB40859-001 Date:11/2020 MSD ServoDrive - DeviceHelp 111

# 7.2.1.1 Adjustment of the mass inertia

The speed controller gain is scaled separately using the percentage value KP Scale. The damping of the control is affected by the speed filter. If the mass inertia value is not known, the wizard can be used to determine it (see Section "Automatic inertia detection" on page 111).

Useful settings are:

- Resolver: 1-2 ms
- Sin/Cos encoder (low-track): 0.5 - 1 ms
- Sin/Cos encoder (high resolution): 0.2 - 0.6 ms

While the mass inertia is being determined the motor executes movements. There is a risk that the system and the motor may be destroyed.

NOTE

After a power-off the speed and position control settings remain stored. The percentage value for rigidity, however, is set to 100% again.

CAUTION! Your system/motor may be damaged if put into operation in an uncontrolled or inappropriate manner. Improper conduct can cause damage to your system/machine.

# 7.2.2 Automatic inertia detection

To define the mass inertia of a motor easily, the "automatic mass inertia definition" function is available. In the standard motor data set, the speed controller is preset for a moderately stiff mechanical system. The automatic mass inertia definition function is started when the hardware has been enabled. Clicking the "Automatic Inertia Definition" button enters the latest value obtained in SCD_Jsum.

# 7.2.1.2 Adaptation to the rigidity of the drive train

The settings for the speed and position control with feed forward control are determined automatically by setting the rigidity. The rigidity is stated in percent in the wizard.

- The setting &lt; 100% reduces the dynamic performance of the controller setting (e.g. for a toothed belt drive).
- The setting &gt; 100% increases the dynamic performance of the controller setting (low play and elasticity).

# CAUTION!

Your system/motor may be damaged if put into operation in an uncontrolled or inappropriate manner. Improper conduct can cause damage to your system/machine.

Before the “Start” step, make absolutely sure that a valid setpoint has been entered, as the configured setpoint will be immediately transmitted to the motor after the motor control function starts, which may result in the motor accelerating unexpectedly.

# NOTE

Image 7.4: “Determining the mass inertia” screen

This function is not recommended for horizontal axes. Attention must be paid to the mechanical end stops with this function. This function is only to be used with a freely rotating motor shaft.

# NOTE

In systems with high static friction, the inertia determination can be assigned an additional additive speed setpoint. P 404[0] - CON_SCON_AddSRamp can be used for this.

# NOTE

If no values are entered for "Hysteresis Speed" and "Hysteresis Torque", 20% of the rated speed and 20% of the rated torque is set. The distance covered results from the preset values.

# NOTE

While the mass inertia is being determined the motor executes movements. There is a risk that the system and the motor may be destroyed.

MOOG ID No.:CB40859-001 Date:11/2020

MSD ServoDrive - DeviceHelp 112

# 7 Control

MOOG ID No.:CB40859-001 Date:11/2020 MSD ServoDrive - DeviceHelp 113

# 7.3 Torque controller

# 7.3.1 Current controller optimization

The torque controller is executed as a PI controller. The gain (P-component) and the integral-action time (I-component) of the individual controllers are programmable. In order to optimize the current control loop, two rectangular reference steps are preset. The object of the optimization is a current controller with moderate dynamism and the following values:

- Current control time: &lt; 1 ms
- Overshoot: &lt; 5%

The faster the actual value approaches the setpoint, the more dynamically the controller is set. The overshoot of the actual value should not be more than 5-10 % of the setpoint (general figure) during the settling process.

- The first step (stage 1, time 1) moves the rotor to a defined position.
- The second step (stage 2, time 2) is used to optimize the torque control (step response). The magnitude of the 2nd step should not be too large, so as to ensure that the voltage setpoint will not go all the way to the limit (low-level signal response required).
- The current and time settings automatically adjust to the motor data. The current is equal to In • .
- ISDSH and ENPO (hardware enable) must be set to "High".
- Click "Start test signal" button.
- Observe the safety notice: When you confirm the safety notice a step response is executed.
- The oscilloscope is set automatically.

Image 7.5: “Current/torque controller settings” screen

# 7 Control

# 7.3.2 Creating the transfer function

The oscilloscope automatically records the amount and phase response of the controller according to the controller settings. This produces an initial estimate of the control quality. To determine the transfer function the noise amplitude (motor rated current) and the sampling time (default 0.125 ms) must be specified. Click the "Start Test Signal" button.

Image 7.7: “Noise amplitude, sampling time” screen

Image 7.6: Current controller optimization

Image 7.8: Current controller transfer function

MOOG ID No.:CB40859-001 Date:11/2020

MSD ServoDrive - DeviceHelp 114

# 7 Control

MOOG ID No.:CB40859-001 Date:11/2020

MSD ServoDrive - DeviceHelp 115

① Green curve = amount

Y-axis left = absolute value of isd/isdref

② Blue curve = phase response

Y-axis right = Phase response Isd/isdref

# 7.3.3 Decoupling

The current control has a decoupling of the d- and q-axis by means of feed-forward control of the corresponding coupling voltages. The decoupling depends on the stator inductance P 471 MOT_Lsig and can be scaled with parameter P 434.3. This is helpful, for example, if the inductance has been estimated inaccurately. If the decoupling is set too high, current control is unstable.

# 7.3.4 Current actual value filter

A first-order digital filter (PT1) can be configured in order to smooth the measured “isd” and “isq” actual current values. This is particularly useful when using drives with high speeds.

NOTE

l The control dynamic performance will be reduced when using the current actual value filter. Using the current actual value filter is not advisable for drives that require a high control dynamic performance.

The current actual value filter is configured with P 1960[0] - CON_ACT_ISDQ_TF, with the filter time constant being defined in milliseconds. Filtered actual currents “isd” and “isq” can be visualized with scope signals 25 and 26. The unfiltered values can be visualized using scope signals “isd_unfil” (129) and “isq_unfil” (130).

In speed and position-controlled operation, the ripple of the torque and power causes a current ripple in the q-current. When detent torque compensation is used, these q-current input data are imported to a teach table in the controller (teaching routine, learning). The compensation table is created from this (calculation) which is then ultimately used for the feed forward control of the q-current in the controller (compensation).

In the low speed range, these disturbance torques can be eliminated well by the control system. In the medium to high speed range, the disturbance torques can be reduced very well using the table-based compensation described here. In the high speed range, the disturbance torques can be reduced very well using the table-based compensation described here.

Image 7.9: Typical positioning sequence

speed range, however, this feed forward control with its finite resolution no longer provides an advantage: the detent torque compensation is eliminated linearly via the fade function (ramp).

In a broader sense, detent torque compensation can always be used when a disturbance torque occurs ‘regularly’ as a function of the position.

the teach table (which cannot be saved): the compensation table is filled in immediately and is ready for the compensation. After the ‘calculation' is complete, the parameter P 385[0] automatically jumps back to P 385[0] - CON_TCoggTeachCon = READY(0). The teaching and calculation are thus finished. The position source used by the teaching has been stored internally. Now the control system can (should) be stopped. The compensation table still needs to be saved, e.g. using the MDA5 button “Save setting non volatile inside device” (= persistently). The position source used by the teaching is also saved. It will later be used for the compensation once again in exactly the same manner.

The compensation (feed forward control) can now be activated using: P 382[0] - CON_TCoggComp > 0.

Caution: Of course, not every compensation parametrization fits with every previous teaching parametrization.

The input and output variables can be observed via scope signals during the teaching routine and the compensation. The signal 156_eps_comp. shows the current raw input position (source) both during the teaching routine and later during the compensation. The signal 157_eps_comp.tune gives the current input position including the input tuning (only for the functions 1). The table index and the table output can both be accessed via the scope signals 440_CON_TAB_TabIdx and 446_CON_TAB_OutVal.

Image 7.10: Detent torque compensation schematic

The parameter P 385[0] - CON_TCoggTeachCon selects the position source for the teaching and sets the teach modes (including: rotary or absolute): the teaching is activated and the compensation is deactivated. With ‘start control’ in the speed control mode, the teaching (teaching routine) begins with a slow run: e.g. <= 1 rpm (at least one revolution of ‘learning’ travel).

With the control still operating (and a slow run), the teaching is then stopped by calling the calculation function once: with P 385[0] - CON_TCoggTeachCon=CALC1(3) or with P 385[0] - CON_TCoggTeach- Con = CALC2(8). It ‘calculates’ the corresponding compensation table (which can be saved) from.

MOOG ID No.:CB40859-001 Date:11/2020 MSD ServoDrive - DeviceHelp 116

# 7 Control

# 7 Control

MOOG ID No.:CB40859-001 Date:11/2020 MSD ServoDrive - DeviceHelp 117

# 7.3.5.1 “Detent torque compensation” parameters

table. àrecurring, infinite

|ID|Index Name|Unit|Description|
|---|---|---|---|
|380|CON_TCoggAddTab|A|Anti cogging compensation table|
|380|0 to CON_TCoggAddTab|A|Delta in number of input increments per table section (one index spacing distance).|
|382|251| |à absolute|
|0|CON_TCoggComp| |Anti cogging enable compensation|
|0|CON_TCoggTeachCon| |Anti cogging control word|
|440|CON_TAB_TabIndex| |Compensation table: index|
|441|CON_TAB_TabVal|A|Compensation table: Value at CON_TAB index|
|442|CON_TAB_PosStart|specific|Comp. table start position (unit depends on source signal)|
|443|CON_TAB_PosDelta|specific|Compensation table delta position|
|445|CON_TAB_TeachDir| |Compensation table teaching direction (sign of speed)|
|446|CON_TAB_OutVal|A|Compensation table: output value|
|447|CON_TAB_Tune| |Compensation table fine-tuning|
|447|0 TimeDelayComp|specific/rpm|Time delay compensation for speed dependent phase shift|
|447|1 PosShift|specific|Compensation table position shift|
|447|2 ScaleFactor| |Compensation table amplitude scaling|
|447|3 FadeOutStart|rpm|Speed value, where cogging compensation fadeout starts|
|447|4 FadeOutEnd|rpm|Speed value, where cogging compensation fadeout ends|

As of the starting speed, the effect of the isq feed forward control is faded out linearly with the increase of the ‘slow’ speed. A ramp is used which ensures that at the ending speed, the isq feed forward control no longer has any effect (=0). The fader is activated when the starting and ending speeds are >0 and are plausible relative to each other.

There are two functions each for teaching, calculating and compensation (F1 and F2). This fulfils a series of different requirements:

Two tables each for teaching and compensation:

- One small table with 250 elements each and
- One large table with 4000 elements each.

Input mapping diagram: two different methods for the input reference:

- Input reference ‘fixed' 32-bit: incremental, ‘rotary' recurring position: The entire width of the 32-bit input position has ‘fixed mapping' over the entire ‘width' of the input position.

However, entries are made in the teach table only in the positive direction of travel in this case; in the negative direction of travel, all entries into the teach table are then suppressed.

# Index display: for teaching routine and compensation:

7.3.5.2 Settings for teaching, calculating and compensation

- P 440[0] - CON_TAB_TabIndex: Index of the table

The current table index calculated using the input position is output here both during the teaching routine and the compensation. (The parameter is accessible via the scope.)

(385) __

CON_TCoggTeachCon

# Table value display: for teaching routine and compensation:

- P 446[0] - CON_TAB_OutVal: output value (of the table)

The currently determined table value of the teach table is output here during the teaching routine. The current isq feed forward control value interpolated using the compensation table is output here during the compensation. (The parameter is accessible via the scope.)

|(3)CALC1|= Calc rotary SmallTab, Calc absolute BigTab|
|---|---|
|F1:|rotary, small TeachTab to small CompTab|
|(8)CALC2|F2: absolute, big TeachTab to big CompTab|
|= Calc rotativ BigTab|F1: rotary, big TeachTab to big CompTab|
|(4)RESET|= Reset teach table entries|
| |Reset both teach tables to No-Init-Value (1000.0)|
|(0)READY|= Teaching switched off|

# Access to the compensation tables

- Access to the small compensation table with 250 elements:

Reading and writing using parameter P 380[0..251] - CON_TCoggAddTab[0..251]. As with other parameters as well, saving takes place in the context of the parameter record being saved in the device’s special memory for parameters.

- Access to the large compensation table with 4000 elements:

Offline, i.e. when neither a teaching routine nor compensation are taking place ‘online,' the individual elements of the large compensation table can be accessed using:

|Index:|Reading and writing using parameter P 440[0] - CON_TAB_TabIndex.|
|---|---|
|Value:|Reading and writing using parameter P 441[0] - CON_TAB_TabVal.|
| |Saving takes place in conjunction with the saving of the parameter record in the device’s mass memory (limitation of the max. number of storage cycles).|

# Additional Parameters

|(1)TeachEpsRS-1|= Teach epsrs commutation angle (electrical)|
|---|---|
|- F1:|Small teach table (250)|
|- F1:|Rotary, mapping: fixed 32-bit|
|- F1:|Without teaching direction|
|- F1:|Without offset and delta, with tuning, with fader|
|Calculation:|(385)CON_TCoggTeachCon=(3)CALC1|
|Compensation:|(382)CON_TCoggComp=(1)EPSRS|
| |àsmall CompTab (380)CON_TCoggAddTab|
|(2)TeachEpsRS-2|= Teach epsrs commutation angle (electrical)|
| |as for (1)TeachEpsRS-1|
|(5)TeachUserRefPos|=Teach (277)MPRO_FG_UserRef|
|Pos:|reference position in user units|
|- F2:|Big teach table (4000)|
|- F2:|Absolute, mapping via (443)CON_TAB_PosDelta|
|- F2:|With teaching direction|
|- F2:|Without offset and delta, with tuning, without fader|
|Calculation:|(385)CON_TCoggTeachCon=(3)CALC1|
|Compensation:|(382)CON_TCoggComp=(2)APSPOS|
| |àbig CompTab, access via (440) and (441)|
|(6)TeachEpsM|=Teach epsm mechanical angle (shaft)|

# Table 7.3: Settings for teaching, calculating and compensation

MOOG ID No.:CB40859-001 Date:11/2020

MSD ServoDrive - DeviceHelp 118

# 7 Control

MOOG ID No.:CB40859-001 Date:11/2020

(385) __

# CON_TCoggTeachCon

Singleturn position from encoder for commutation

- F1: Big teach table (4000)
- F1: Rotary, mapping: fixed 32-bit
- F1: Without teaching direction
- F1: Without offset and delta, with tuning, with fader

Calculation: (385)CON_TCoggTeachCon=(8)CALC2

Compensation: (382)CON_TCoggComp=(3)EPSM

àbig CompTab, access via (440) and (441)

# TeachPosEncPcon

Teach posact from pcon encoder

Actual position from encoder for position control in reference value normalization, Scope-Signal 152

- F2: Big teach table (4000)
- F2: Absolute, mapping via (443)CON_TAB_PosDelta
- F2: With teaching direction
- F2: Without offset and delta, with tuning, without fader

Calculation: (385)CON_TCoggTeachCon=(3)CALC1

Compensation: (382)CON_TCoggComp=(2)APSPOS

àbig CompTab, access via (440) and (441)

# TeachPconEncPos

Teach (412)CON_PCON_ActPosition

Actual position from encoder for position control in reference value normalization

- F2: Big teach table (4000)
- F2: Absolute, mapping via (443)CON_TAB_PosDelta
- F2: With teaching direction
- F2: Without offset and delta, with tuning, without fader

Calculation: (385)CON_TCoggTeachCon=(3)CALC1

Compensation: (382)CON_TCoggComp=(2)APSPOS

àbig CompTab, access via (440) and (441)

# TeachPosEncRed

Teach posact from redundant encoder

Actual position from so called redundant encoder in ref value normalization, Scope-Signal 153

- F2: Big teach table (4000)
- F2: Absolute, mapping via (443)CON_TAB_PosDelta
- F2: With teaching direction
- F2: Without offset and delta, with tuning, without fader

Calculation: (385)CON_TCoggTeachCon=(3)CALC1

Compensation: (382)CON_TCoggComp=(2)APSPOS

àbig CompTab, access via (440) and (441)

# TeachSTPosPcon

Teach singleturn position from position control

Singleturn position of position control

- F1: Big teach table (4000)
- F1: Rotary, mapping: fixed 32-bit
- F1: Without teaching direction
- F1: Without offset and delta, with tuning, with fader

Calculation: (385)CON_TCoggTeachCon=(8)CALC2

Compensation: (382)CON_TCoggComp=(3)EPSM

àbig CompTab, access via (440) and (441)

# TeachEpsRS-3

Teach epsrs commutation angle (electrical)

- F1: Big teach table (4000)
- F1: Rotary, mapping: fixed 32-bit
- F1: Without teaching direction
- F1: Without offset and delta, with tuning, with fader

Calculation: (385)CON_TCoggTeachCon=(8)CALC2

Compensation: (382)CON_TCoggComp=(3)EPSM

àbig CompTab, access via (440) and (441

# Table 7.3:

Settings for teaching, calculating and compensation (continue)

The compensation (feed forward control) is activated using parameter: P 382 [0] - CON_TCoggComp > 0.

# 7.3.5.3 Procedure for detent torque compensation

The following table shows the procedure for detent torque compensation.

MOOG
ID No.:CB40859-001
Date:11/2020

# 7 Control

|No.|Action|
|---|---|
|1|Open manual mode window|
|2|Speed control mode control setting (set high rigidity, for smooth running)|
|3|Set the teaching direction if necessary: P 445[0] - CON_TAB_TeachDir Default: POS(1)= teaching routine in positive direction.|
|4|Set the offset and delta if necessary using: P 442[0] - CON_TAB_PosStart, default 0 P 443[0] - CON_TAB_PosDelta, default 1000 inc/TabElement Set the input tuning if necessary using:|
|5|P 447[0] - CON_TAB_Tune.TimeDelay, default 0 P 447[1] - CON_TAB_Tune.PosShift, default 0|
|6|Start control|
|7|Run motor at low speed (≤ 1 rpm) Set the position source for the teaching, activate teaching: Select|
|8|P 385[0] - CON_TCoggTeachCon > 0. àThe teaching routine begins (possibly only with PosStart, however).|
|9|Move at least 1 motor revolution in the same direction (internal filter time). With the control still operating, the teaching is then stopped by calling the|
|10|calculation function once: P 385[0] - CON_TCoggTeachCon = (3)CALC1 or (8)CALC2. Afterwards, parameter P 385[0] jumps back to READY(0).|

Table 7.4: Overall procedure for detent torque compensation

MSD ServoDrive - DeviceHelp 120

# 7 Control

MOOG ID No.:CB40859-001 Date:11/2020

# MSD ServoDrive - DeviceHelp

No. Action

- The teaching and calculation are thus finished.
- The position source used has been stored internally.
- The compensation table is available for use immediately.

# 11 Stop control

Start the compensation: P 382[0] - CON_TCoggComp &gt; 0

# 12

After this, the q-current feed forward control becomes active when the control is restarted.

Save device data.

# 13

The position source used by the teaching is also saved here. It will later be used for the compensation once again in exactly the same manner.

Image 7.12: After enabling detent torque compensation (with) (please keep the Y axis scaling in mind!)
# 7.3.5.3.1 Scope recording: speed ‘before' and ‘after'

Possible monitoring via scope signal (69) isqref_comp [A]: ref. current from anti-cogging --> in ‘blue' here

A significant improvement in the speed progression is noticeable in the ‘yellow’ scope signal (13): nact [rpm]: cur. speed from filter.

Image 7.11: Before detent torque compensation (without)

# 7.3.5.4 Compensation as a function of the electrical angle

# 7.3.5.5 Compensation as a function of the absolute position

|EPSRS|ABSPOS|
|---|---|
|Teaching routine and compensation à small CompTab (250er)|Teaching routine and compensation à big CompTab (4000)|
|- Incremental, ‘rotary' recurring position|- Absolute, 'linear' continuous position|
|- Without offset and delta, with tuning, with fader|- With offset and delta, with tuning, without fader|
|- (1) Teach epsrs, commutation angle (electrical)|- (3) Teach (277)MPRO_FG_UserRefPos, reference position in user units|
|No. Action|- (7) Teach posact from pcon encoder, actual position from encoder for position control loop in reference scaling, scope signal 152|
| |- (9) Teach (412)CON_PCON_ActPosition, actual position of the position control in reference scaling|
| |- (10) Teach posact from pcon encoder, actual position from so-called redundant encoder in reference scaling, scope signal 153|
|1|Open manual mode window|
|2|Speed control mode control setting (set high rigidity, for smooth running)|
|3|Start control|
|4|Run motor at low speed (≤ 1 rpm).|
|5|Set the position source for the teaching, activate teaching: Select P 385[0] - CON_TCoggTeachCon = (1)TeachEpsRS-1.àThe teaching routine begins.|
|6|Wait until at least 1 motor revolution is completed in the teaching routine (internal filter time).|
|---|Check P 440[0] - CON_TAB_TabIndex and P 446[0] - CON_TAB_OutVal|
| |With the control still operating, the teaching is then stopped by calling the calculation function once:|
|7|P 385[0] - CON_TCoggTeachCon = (3)CALC1. This imports all values into the compensation table P 380 - CON_TCoggAddTab (small table with 250 elements).|
|8|Stop control|
| |Start the compensation: P 382[0] - CON_TCoggComp = (1)EPSRS|
|9|After this, the q-current feed forward control becomes active when the control is restarted. Save device data.|
|10|- The position source used by the teaching is also saved here. It will later be used for the compensation once again in exactly the same manner.|

MOOG ID No.:CB40859-001 Date:11/2020

MSD ServoDrive - DeviceHelp 122

# 7 Control

# MOOG

ID No.: CB40859-001 Date: 11/2020

# MSD ServoDrive - DeviceHelp

|No.|Action|
|---|---|
|1|Open manual mode window.|
|2|Approach start position|
|3|Speed control mode control setting (set high rigidity, for smooth running)|
|4|Set the teaching direction if necessary: P 445[0] - CON_TAB_TeachDir Default: POS(1)= teaching routine in positive direction.|
|5|Set the offset and delta if necessary using: P 442[0] - CON_TAB_PosStart, default 0 P 443[0] - CON_TAB_PosDelta, default 1000 inc/TabElement = e.g. (endpos inc - startpos inc) / 4000 elements|
|6|Set the input tuning if necessary using: P 447[0] - CON_TAB_Tune.TimeDelay, default 0 P 447[1] - CON_TAB_Tune.PosShift, default 0|
|7|Start control|
|8|Run motor at low speed (≤ 1 rpm). Set the position source for the teaching, activate teaching: Select P 385[0] - CON_TCoggTeachCon= (5)TeachUserRefPos or select|
|9|P 385[0] - CON_TCoggTeachCon= (7)TeachPosEncPcon or select P 385[0] - CON_TCoggTeachCon= (9)TeachPconActPos or select P 385[0] - CON_TCoggTeachCon= (10)TeachPosEncRed. à The teaching routine begins (but only with PosStart).|
|10|Wait until at least 1 motor revolution is completed in the teaching routine (internal filter time).|
|11|P 385[0] - CON_TCoggTeachCon = (3)CALC1. This imports all values into the internal compensation table (big table with 4000 elements).|
|12|Stop control|
|13|Save device data. - The position source used by the teaching is also saved here. It will later be used for the compensation once again in exactly the same manner. Use the scope to monitor IsqRef_Comp|
|14|Compensation as a function of mechanical rotation (EPMS) - Incremental, ‘rotary' recurring position - Without offset and delta, with tuning, with fader - (6) Teach epsm mechanical angle (shaft), SingleTurn position from encoder for commutation - (11) Teach singleturn position from position control, SingleTurn position of the position control, + Homing + axis correction - (12) Teach epsrs, commutation angle (electrical)|

# No.  Action

|1|Open manual mode window|
|---|---|
|2|Set the speed control mode (set high stiffness, for radial true running) Set speed control mode.|
|3|Start control|
|4|Run motor at low speed (≤ 1 rpm).|
| |Set the position source for the teaching, activate teaching: Select|
|5|P 385[0] - CON_TCoggTeachCon = (6)TeachEpsMor select|
| |P 385[0] - CON_TCoggTeachCon = (11)TeachSTPosPcon. àThe teaching routine begins.|
|6|Wait until at least 1 motor revolution is completed in the teaching routine (internal filter time).|
| |Check P 440[0] - CON_TAB_TabIndex and P 446[0] - CON_TAB_OutVal|
| |With the control still operating, the teaching is then stopped by calling the calculation function once:|
|7|P 385[0] - CON_TCoggTeachCon = (8)CALC2. This imports all values into the internal compensation table (big table with 4000 elements).|
|8|Stop control|
|9|Start the compensation: P 382[0] - CON_TCoggComp = (3)EPSM|
|10|Save device data.|
| |- The position source used by the teaching is also saved here. It will later be used for the compensation once again in exactly the same manner.|
|11|Use the scope to monitor IsqRef_Comp|

# 7.3.5.7 Compensation as a function of the electrical angle (EPSRS), big table

Teaching routine and compensation à big CompTab (4000)

- Incremental, ‘rotary' recurring position
- Without offset and delta, with tuning, with fader

MOOG ID No.:CB40859-001 Date:11/2020

MSD ServoDrive - DeviceHelp 124

# 7 Control

# 7 Control

MOOG ID No.:CB40859-001 Date:11/2020

# 7.3.5.8 FadeOut function

Adaptation of torque control / Saturation characteristic (see Section "Adaptation of torque control" on page 125).

At higher speeds it usually makes sense to linearly fade the Q-current feed forward control of the detent torque compensation using the FadeOut function:

- P 447[3] - CON_TAB_Tune[3].FadeOutStart: fader starting speed
- P 447[4] - CON_TAB_Tune[4].FadeOutEnd: fader ending speed.

FadeStartSpeed

|100 %|Rastmoment-|kompensation|cogging|compensation|
|---|---|---|---|---|
|0 %| | | | |

Image 7.15: Structure of expanded torque control

FadeEndSpeed

# 7.3.6 Advanced torque control

Torque control is expanded by three functions in order to optimize the control dynamics of the current and speed controllers.

# 7.3.6.1 Adaptation of torque control

# 7.3.6.1.1 Saturation characteristic

In the overload range, saturation effects reduce the inductance of many motors. As a result, the current controller optimized to the rated current may oscillate or become unstable. In this case the gain of the current controller should be adapted to the load case by way of four interpolation points. The values for the interpolation points are entered in the screen as a percentage of the rated current. On the left are the inductance values, and on the right the values for the overload (> 100% of rated current).

# Inductance [%]

|Index [0]|100 %|
|---|---|
|Index [1]|90 %|
|Index [2]|68 %|
|Index [3]|31 %|

# Rated current

|Irated [4]|Irated [6]|[%]|
|---|---|---|
|Irated [5]|Irated [7]| |

Image 7.16: “PS motor electrical parameters” screen

Image 7.17: Diagram: “Scaling of q-inductance L in [%]”

- ① P 472[0] - [3] Lsig_q@Ix Scaling of q-stator inductance in [%]; interpolation points 0 to 3.
- ② P 472[4] - [7] MOT_CurrentIx Scaling of rated current in [%]; interpolation points 4 to 7.

# Legend for Diagram: “Scaling of q-inductance L in [%]”

NOTE

l Between the interpolation points the scaling factor is interpolated in linear mode. The current scaling of the inductance is displayed in the scope variable 74_Is_ActVal.

MOOG ID No.:CB40859-001 Date:11/2020

MSD ServoDrive - DeviceHelp 126

# Control

# MOOG

ID No.: CB40859-001 Date: 11/2020

# MSD ServoDrive - DeviceHelp

|ID|Index Name|Unit|Description|
|---|---|---|---|
|471|0 MOT_Lsig|mH|Motor leakage inductance (ASM) / stator inductance (PSM)|
|472|MOT_LsigDiff| |q-axis stator inductance variation (relative to MOT_Lsig)|
|472|0 Lsig_q@I0|%|Inductance @ CurrentI0|
|472|1 Lsig_q@I1|%|Inductance @ CurrentI1|
|472|2 Lsig_q@I2|%|Inductance @ CurrentI2|
|472|3 Lsig_q@I3|%|Inductance @ CurrentI3|
|472|4 CurrentI0|%|Current I0 relative to MOT_CNom|
|472|5 CurrentI1|%|Current I1 relative to MOT_CNom|
|472|6 CurrentI2|%|Current I2 relative to MOT_CNom|
|472|7 CurrentI3|%|Current I3 relative to MOT_CNom|

Table 7.6: “Advanced torque control - Saturation characteristic” parameters

# 7.3.6.1.2 K-T characteristic

In the overload range the output-side torque is reduced due to rising losses (iron/copper losses). This behaviour can be compensated by P 479[0] - MOT_TorqueSat.

|P No.|Index|Parameter name|Unit|Function|
|---|---|---|---|---|
|479| |MOT_TorqueSat| |Motor torque as a function of the current|
| |0 to 4| |Nm|Torque; interpolation points 0 to 4.|
| |5 to 9| |A|Current; interpolation points 5 to 9.|

Table 7.7: “K-T characteristic” parameters

# 7.3.6.2 Current observer

In the current control circuit, the calculation of voltage setpoints and PWM runtime appears as dead time. This is the main factor determining the possible performance of current control. The current observer eliminates this dead time to the greatest possible extent by predicting current by means of a scanning step. In addition, many synchronous servomotors exhibit harmonic components in the current control circuit. The current observer suppresses these harmonic components so that they cannot.

|ID|Index Name|Unit|Description|
|---|---|---|---|
|433|0 CON_CCON_ObsMode| |Select current observer mode|
|434|CON_CCON_ObsPara| |Current observer parameters|
|434|0 TF|ms|Observer time constant|
|434|1 Kp|1/s|Proportional feedback gain|
|434|2 Tn|ms|Integral feedback time constant|
|434|3 Decoup|%|Scale decoupling|
|434|4 StatFF|%|Scale static voltage feed-forward|
|434|5 DynFF|%|Scale dynamic voltage feed-forward|
|434|6 FilterFF|ms|Filter voltage feed-forward|

Table 7.8: “Advanced torque control - Observer” parameters

# 7.3.6.3 Overmodulation

The "usqref" and "usdref" components permit so-called overmodulation of the DC link voltage (limitation to hexagon instead of circle). The maximum output voltage which can be set for each phase angle results from the circle which fits in the voltage hexagon (see diagram Section "“Circle and hexagon voltages” diagram" on page 128).

By setting the hexagonal modulation to "HEX_PHASE(3)" using P 432 - CON_CCON_Mode, the length of the vector for the output voltage can be placed in the range of the DC link voltage (red). As a result only two of the three half-bridges are switched in each switching interval. The third remains at the upper or lower potential of the DC link voltage for a period of 60° of the output frequency.

This method has only two thirds of the switching losses of modulation with all three phases. Disadvantages are higher harmonics of the motor currents and thus less smooth running at high motor speeds.

Image 7.18: “Circle and hexagon voltages” diagram Representation of the eight vectors of the three-phase voltage system (3 half-bridges each with 2 states [23]). The vectors correspond to the DC link voltage UZK and form a voltage hexagon.

UN Mains voltage

UL Voltage at inductor

Uu Inverter voltage

Uzk DC link voltage

α Phase angle

# Legend for “Circle and hexagon voltages” diagram

|ID|Index Name|Unit|Description| | |
|---|---|---|---|---|---|
| |431|0|CON_CCON_VLimit|%|Voltage limit for first current controller|
| |432|0|CON_CCON_Mode| |Select current control / limitation mode|

Table 7.9: “Advanced torque control - Overmodulation” parameters

MOOG ID No.:CB40859-001 Date:11/2020

MSD ServoDrive - DeviceHelp 128

# 7 Control

MOOG ID No.:CB40859-001 Date:11/2020 MSD ServoDrive - DeviceHelp 129

# 7.3.7 Torque control with defined bandwidth

|P no.|Index|Name / Setting|Unit|Function|
|---|---|---|---|---|
|ENC_OFFSET (1)| |Start encoder offset determination (power stage will be switched on!)| | |
|MOT_ID (2)| |Start electrical motor identification (power stage will be switched on!)| | |
|IMP (3)| |Measure impedance| | |
|LH_TUNE (4)| |Tune Lm characteristics| | |
|ASM_OP (5)| |Set operation point for asynchronous motor| | |
|BANDWIDTH (6)| |Tune current controller by bandwidth| | |
|MOTPHASE (7)| |Check motor/encoder wiring| | |
|COM_ALL (8)| |Motorid., enc.-offset and inertia detection, motor phase check| | |
|J_SUM (9)| |Identification of whole inertia| | |
|CANCEL (10)| |Cancel the current action| | |

The controller gain is determined by activating test signals (Autotuning). The calculations and the relevant autotuning are carried out in the servo drive. The advanced settings are made in P 1530[0] - SCD_SetMotorControl, P 1531[0] - SCD_Action_Sel and P 1533[0] - SCD_AT_Bandwidth.

- The 3dB bandwidth of the closed loop is specified as the bandwidth.
- Advisable bandwidth settings at 8 kHz switching frequency are up to approximately 2000 Hz; at 16 kHz switching frequency up to approximately 3000 Hz.
- The P-gain CCON_Kp is calculated according to the amount optimum.
- The integral-action time CCON_Tn is interpolated between the amount optimum and the symmetrical optimum, so that the I-content is sufficient, resulting in reduced interference response.

|P no.|Index|Name / Setting|Unit|Function|
|---|---|---|---|---|
|1530|0|SCD_SetMotorControl| |Torque controller setting with defined bandwidth|
| |Fault(-1)|Error during calculation| | |
| |Ready(0)|Calculation ready| | |
| |CALC_CON(1)|Control with motor data calculation| | |
| |CALC_ASM(2)|Calculate asm motor from rated data| | |
| |BANDWIDTH(3)|Calculate current controller by bandwidth| | |
| |DEADBEAT(4)|This setting parameterizes a dead-beat controller. The structure is switched to feedback with observer, the observer is designed (to a specific equivalent time constant – for setting see P 434[0] - CON_CCON_ObsPara– and the speed controller gains are calculated accordingly.| | |
| |FAULT (-1)|Selected function stopped with fault| | |
| |READY (0)|Ready to start function / last call successfully ended| | |

# 7.3.8 Enhanced feed forward control of voltage

For high-power applications, the current control setting is often limited. If, at the same time, a high bandwidth is required for the control of test signals, for example, feed-forward voltage control is helpful.

|ID|Index|Name|Unit|Description|
|---|---|---|---|---|
|434| |CON_CCON_Para| |Current observer parameters|
|434|0|TF|ms|Current observer time constant|
|434|1|Kp|1/s|Current observer feedback gain|
|434|2|Tn|ms|Current observer feedback time constant|

Table 7.11: Parameter - Enhanced feed forward control

# 7 Control

|ID|Index Name|Unit|Description|isdref|Pi-Regler|
|---|---|---|---|---|---|
|434|3|Decoup|%|Scale decoupling|isd|
|434|4|StatFF|%|Scale static voltage feed-forward| |
|434|5|DynFF|%|Scale dynamic voltage feed-forward| |
|434|6|FilterFF|ms|Filter voltage feed-forward|-ω* Lsig*LsigDiff(isq) P 434[3] decoup|
|471|0|MOT_Lsig|mH|Motor leakage inductance (ASM) / stator|P 434[6] FilterFF|
| | | | |inductance (PSM)|Lsig*LsigDiff(isq) d/dt|
|472| |MOT_LsigDiff| |q-axis stator inductance variation (relative to|MOT_Lsig)|
|472|0|Lsig_q@I0|%|Inductance @ CurrentI0|Error-Voltage-Model|
|472|1|Lsig_q@I1|%|Inductance @ CurrentI1|ω* Lsig*LsigDiff(isq) + ω*Ψ|
|472|2|Lsig_q@I2|%|Inductance @ CurrentI2| |
|472|3|Lsig_q@I3|%|Inductance @ CurrentI3|P 434[3] decoup P 434[4] StatFF P 434[5] DynFF|
|472|4|CurrentI0|%|Current I0 relative to MOT_CNom|isqref|
|472|5|CurrentI1|%|Current I1 relative to MOT_CNom| |
|472|6|CurrentI2|%|Current I2 relative to MOT_CNom|isq|
|472|7|CurrentI3|%|Current I3 relative to MOT_CNom| |
|1976|0|CON_CCON_VFF| |Select current control / limitation mode| |

Table 7.11: Parameter - Enhanced feed forward control (continue)

Image 7.19: Extended pre-control structure shows the extended pre-control structure. This is activated with P 1976 = ON. This delays the current setpoint by one controller cycle; this is not suitable for high-performance speed control.

The feed forward control of the voltage drop across the stator resistance of the machine depends on P 470 MOT_Rstat. The feed forward control of the fault voltage of the power stage depends on P 302 CON_SwitchFreq. Both can be subjected to feed forward control and scaled with P 434.4.

The voltage to change the current over the stator inductance depends on P 471 MOT_Lsig. The feed forward control can be scaled with P 434.5.

P 434.6 enables filtering of the voltage thus set, which reduces noise. Do not set this filter too high, otherwise there will no longer be an increase in bandwidth.

MOOG                          ID No.:CB40859-001 Date:11/2020

MSD ServoDrive   - DeviceHelp     130

# 7 Control

MOOG ID No.:CB40859-001 Date:11/2020

MSD ServoDrive - DeviceHelp 131

To set these functions, use the test signal generator (not yet described - to do) to apply a sweep signal to the d-current setpoint and record the setpoint and actual values with the scope.

# 7.4 Speed controller

1. Gain (KP)
2. Integral-action time (I)
3. Scaling factor for gain
4. With these filters it is possible to filter noise in the actual speed value and increase the attenuation of resonance frequencies.
5. Advanced speed control (observer), see Section "Advanced speed control" on page 133
6. Analysis of speed control, see Section "Analysis of Speed control" on page 137
7. Actual speed filter

Legend for “Speed controller” screen

# Adaptation of parameters

Acceleration and braking phases generate a variation which the speed control has to balance out. With speed pre-control the necessary acceleration or braking moment determined from the change in speed over time is applied to the output of the speed controller.

If the travel range is not limited, it is advisable to optimize the speed controller by means of step responses. In this, the motor model must be adapted precisely to the individual motor. In the standard motor data set, the speed controller is preset for a moderately stiff mechanical system. The speed controller may need to be adjusted to the moment of inertia and the rigidity of the mechanism.

All parameters take effect online. The scaling parameter P 322[0] - CON_SCON_KpScale is transferred in defined real time (according to the speed controller sampling time).

The following steps are needed to set the speed control loop depending on the application:

|No.|Action|
|---|---|
|1|Adapt the speed controller gain to the existing external mass inertia. For this, either the known moment of inertia from the motor data can be used directly or the automatic mass inertia definition function in the Motor Identification subject area can be used.|
|2|If the system's moment of inertia is defined manually, it must be reduced to the motor.|

Legend for “Relevant variables”

|ID|Index Name|Unit|Description|
|---|---|---|---|
|2695|CON_SCON_ScaleTF| |Scaling filter time constant|
|2695|ScaleMaxSpeedFil|ms|Speed scaling filter time constant|
|2695|ScaleMaxTorqueFil|ms|Torque scaling filter time constant|
|320|CON_SCON_Kp|Nm/rpm|Speed control gain|
|321|CON_SCON_Tn|ms|Speed control integration time constant|
|322|CON_SCON_KpScale|%|Speed control gain scaling factor|
|351|CON_SCALC_TF|ms|Speed calculation filter time constant, speed control|
|371|CON_IP_RefTF|ms|Speed reference filter time constant (SCON mode)|

Table 7.12: “Speed controller” parameter

MOOG ID No.:CB40859-001 Date:11/2020

MSD ServoDrive - DeviceHelp 132

# 7 Control

# 7 Control

MOOG                          ID No.:CB40859-001 Date:11/2020                                                                                         MSD ServoDrive   - DeviceHelp      133

|ID|Index Name| |Unit|Description| |
|---|---|---|---|---|---|
|304|0|CON_SConTS|ms|Speed control sampling time| |
|2939|0|CON_SCON_TorqueTF|ms|Actual torque filter time| |
| | | | |Digital filter / speed controller settings| |
|325| |CON_SCON_FilterFreq| |Filter frequencies of digital filter| |
|325|0|CON_SCON_FilterFreq|Hz|1st center/cutoff| |
|325|1|CON_SCON_FilterFreq|Hz|1st width| |
|325|2|CON_SCON_FilterFreq|Hz|2nd center/cutoff| |
|325|3|CON_SCON_FilterFreq|Hz|2nd width| |
|326|0|CON_SCON_FilterAssi| |Digital filter design assistant| |
|327| |CON_SCON_FilterPara| |Coefficients of digital filter| |
|327|0|FilterPara b0| |b0*x(k)| |
|327|1|FilterPara b1| |b1*x(k-1)| |
|327|2|FilterPara b2| |b2*x(k-2)| |
|327|3|FilterPara b3| |b3*x(k-3)| |
|327|4|FilterPara b4| |b4*x(k-4)| |
|327|5|FilterPara a1| |a1*y(k-1)| |
|327|6|FilterPara a2| |a2*y(k-2)| |
|327|7|FilterPara a3| |a3*y(k-3)| |
|327|8|FilterPara a4| |a4*y(k-4)| |
|1550|0|SCD_NotchType| |Adaptive Notch filter: Method| |
|1551|0|SCD_NotchCntl| |Adaptive Notch filter: Control word| |
|1552| |SCD_NotchFreq| |Adaptive Notch filter: Frequencies| |
|1552|0|SCD_NotchFreq|Hz|Adaptive Notch filter: Frequency| |
|1552|1|SCD_NotchLambda|Hz/min^-2|Adaptive Notch filter: Coefficient| |
|1552|2|SCD_NotchMinFreq|Hz|Adaptive notch filter: Minimum frequency| |
|1552|3|SCD_NotchMaxFreq|Hz|Adaptive notch filter: Maximum frequency| |
|1552|4|SCD_NotchDeltaFreq|Hz|Adaptive Notch filter: Maximum frequency change (in each iteration)| |

# 7.4.1.1 Speed observer

The speed observer is a simple model of the path with motor current as input, as estimation of load torque and feedback of the estimated error from encoder position for speed control. The observer generates an estimation of motor speed that is used as an alternative to the measured, filtered speed of the axis.

# Procedure for using the observer

- Make sure that the mass inertia of the system (P 1516[0] - SCD_JSum) is known. To do so, determine the inertia of the system (see section “Section "Automatic inertia detection" on page 111”), if this has not yet been done.

# 7 Control

# 7.4.1.2 Reduction of gain at low speeds.

With speed controllers set to be very dynamic, undesirable oscillation of the speed controller may occur at low speeds or at zero speed. An appropriate setting of P 336 - CON_SCON_KpScaleSpeedZero reduces this tendency to oscillate.

# 7.4.1.3 Quick stop without sensor

In the event of a wire break on the encoder system the drive is shut down in sensorless mode on the preset quick-stop ramp (see Section "Error reactions" on page 325 and Section "Stop ramps" on page 248). Due to the lack of dynamism at low speeds, the sensorless control is very "imprecise". To enable the drive nevertheless to be run down smoothly to speed 0, as from the speed threshold parameterized in P 355[0] - LowSpeedLimit the controller switches to a current/frequency (IF) control. For stabilization, an additional, cumulative d-current must be injected that can be set via the P 355[1] - d-current Injection parameter. The speed controller gain is reduced by the factor P 355[2] - SpeedControlGainScale.

Another criterion for a reliable knowledge of mass inertia is functioning torque feed forward control (see Section "Pre-control" on page 140). Multiply the currently configured value of P 1516[0] - SCD_JSum by P 376 - CON_IP_TFFScale and set P 376 - CON_IP_TFFScale back to 100%.

Set P 350[0] - SEL_ObserverMethod = OBS1(1) and P 354[0] - CON_SCALC_ObsDesignAssi = DR(2).

Start the control. The setting parameter for the observer is the time constant P 353[0] - Tf. Use twice the time constant of the previously used speed filter P 351[0] - CON_SCALC_Tf as an initial value. Configuration is also a compromise between input signal smoothing and phase shift in the control circuit. However, the observer does not have such a great effect on phase shift in the speed control circuit as a filter.

# Image 7.23: Reduction of gain at low speeds.

# Image 7.24: Quick stop without sensor

MOOG ID No.:CB40859-001 Date:11/2020

MSD ServoDrive - DeviceHelp 134

# 7 Control

MOOG ID No.:CB40859-001 Date:11/2020

# 7.4.1.4 Parameters

|ID|Index Name|Unit|Description|
|---|---|---|---|
|352|CON_SCON_Kd| |Advanced control structure gains|
|352|CON_SCON_K_d| |D control / acceleration feedback|
|352|CON_SCON_K_dvlm| |Speed difference feedback|
|352|CON_SCON_K_dmlm| |Torsional torque feedback|
|352|CON_SCON_K_mload| |Load torque compensation|
|352|CON_SCON_TFd| |Kalman: Setting|
|352|CON_SCON_TF_d| |D control / acceleration feedback|
|352|CON_SCON_TF_dvlm| |Speed difference feedback|
|352|CON_SCON_TF_dmlm| |Torsional torque feedback|
|352|CON_SCON_TF_mload| |Load torque compensation|
|353|CON_SCON_KpScaleSpeedZero| |Adaptation of speed control gain at zero speed|
|353|KpScale_Zero| |Speed control gain for low/zero speed|
|353|SpeedLimit|rpm|Speed limit to detect zero speed|
|353|Filter_Zero|ms|Filter time for change from higher to zero speed|
|353|Filter_High|ms|Filter time for change from zero to higher speed|
|353|KvScale_Zero| |Position control gain for low/zero speed|
|353|CON_SCON_Kalman| |Kalman: Setting|
|354|Tf_Kalman|ms|Kalman: Integration time|
|354|KpScale_Kalman|%|Kalman: Gain|
|355|CON_SCALC_SEL| |Selection of speed calculation method|
|355|SEL_ObserverMethod| |Selection of speed calculation method|
|355|SEL_FeedbackMethod| |Select test or operational mode|
|355|CON_SCALC_ObsPara| |Observer parameters (effect depends on CON_SCALC_SEL)|
|355|CON_SCALC_ObsPara| | |
|2696|CON_SCALC_ObsPara| | |
|2698|CON_SCALC_ObsPara| | |
|2699|CON_SCALC_ObsPara| | |
| |CON_SCALC_ObsPara| | |
| |CON_SCALC_ObsPara| | |
| |CON_SCALC_ObsPara| | |
| |CON_SCALC_ObsPara| | |
| |CON_SCALC_ObsPara| | |
| |CON_SCALC_ObsPara| | |

Table 7.13: “Speed controller - Advanced speed control” parameter

|Index Name|Unit|Description|
|---|---|---|
|CON_SCALC_ObsPara| | |
|CON_SCALC_ObsPara| | |
|CON_SCALC_ObsPara| | |
|CON_SCALC_ObsPara| | |
|CON_SCALC_ObsPara| | |
|CON_SCALC_ObsPara| | |
|CON_SCALC_ObsPara| | |
|CON_SCALC_ObsPara| | |
|CON_SCALC_ObsPara| | |
|CON_SCALC_ObsPara| | |
|CON_SCALC_ObsPara| | |
|CON_SCALC_ObsPara| | |
|CON_SCALC_ObsPara| | |
|CON_SCALC_ObsPara| | |
|CON_SCALC_ObsPara| | |
|CON_SCALC_ObsPara| | |
|CON_SCALC_ObsPara| | |

“Speed controller - Advanced speed control” parameter (continue)

# 7.4.2 Digital filter

# Bode diagrams PT1 to PT4

# Bode plots for band-stop filters (notch filters)

To filter any noise on the actual speed value, or to damp resonance frequencies, various filter combinations can be used. A range of filter variants are available. The coefficients of the transfer function are automatically determined as soon as the values for the middle and limit frequency and the width have been entered.

**Table 7.14: Filter Bode plots**
|No.|Action|
|---|---|
|1|Scope setting: isq (unfiltered, torque-forming current) Set shortest sampling time Create scope plot without notch filtering On the oscilloscope click the "Mathematical functions" > FFT (Fourier analysis) icon. From the following pop-up menu choose isq. Disturbance frequency is displayed.|
|2|Select filter|
|3|Enter middle/limit frequency|
|4|Width: Enter the bandwidth of the limit frequency; the width has no effect when using PTx filters|
|5|Create scope plot with notch filtering|

**Table 7.15: Instructions for FFT signal analysis**
| | |
|---|---|

Image 7.25: “Speed controller - Digital filter” screen

MOOG ID No.:CB40859-001 Date:11/2020

MSD ServoDrive - DeviceHelp 136

# 7 Control

# 7 Control

MOOG ID No.:CB40859-001 Date:11/2020

# MSD ServoDrive - DeviceHelp

|FFT without filtering|FFT with filtering|ID|Index Name|Unit|Description|
|---|---|---|---|---|---|
| | |325|CON_SCON_FilterFreq| |Filter frequencies of digital filter| |
| | |0|CON_SCON_FilterFreq|Hz|1st center/cutoff|
| | |1|CON_SCON_FilterFreq|Hz|1st width|
| |2| |CON_SCON_FilterFreq|Hz|2nd center/cutoff|
| |3| |CON_SCON_FilterFreq|Hz|2nd width|
| | |0|CON_SCON_FilterAssi| |Digital filter design assistant|
| | |327|CON_SCON_FilterPara| |Coefficients of digital filter| |
| | |0|FilterPara b0| |b0*x(k)|
| | |1|FilterPara b1| |b1*x(k-1)|
| |2| |FilterPara b2| |b2*x(k-2)|
| |3| |FilterPara b3| |b3*x(k-3)|
| | |4|FilterPara b4| |b4*x(k-4)|
| | |5|FilterPara a1| |a1*y(k-1)|
| | |6|FilterPara a2| |a2*y(k-2)|
| |7| |FilterPara a3| |a3*y(k-3)|
| | |8|FilterPara a4| |a4*y(k-4)|
| |1550|0|SCD_NotchType| |Adaptive Notch filter: Method|
| |1551|0|SCD_NotchCntl| |Adaptive Notch filter: Control word|
| |1552| |SCD_NotchFreq| |Adaptive Notch filter: Frequencies|
| |1552|0|SCD_NotchFreq|Hz|Adaptive Notch filter: Frequency|
| |1552|1|SCD_NotchLambda|Hz/min|Adaptive Notch filter: Coefficient|
| |1552|2|SCD_NotchMinFreq|Hz|Adaptive notch filter: Minimum frequency|
| |1552|3|SCD_NotchMaxFreq|Hz|Adaptive notch filter: Maximum frequency|
| |1552|4|SCD_NotchDeltaFreq|Hz|Adaptive Notch filter: Maximum frequency|

NOTE

- Note that the filters not only have an effect on the amount but also on the phase of the frequency response. At lower frequencies higher-order filters (PT3, PT4) should not be used, as the phase within the control bandwidth is negatively influenced.
- The coefficients can also be specified directly via parameter P 327 - CON_SCON_FilterPara. They take effect directly, so changing them is only recommended when the control is switched off.
- A large bandwidth will result in a lower attenuation of the cut-off frequency.

# 7.4.3 Analysis of Speed control

The speed controller is executed as a PI controller. The gain (P-component) and the integral-action time (I-component) of the individual controllers are programmable. In order to optimize the speed control loop, two rectangular reference steps are preset. For automatic controller optimization the step response and transfer function wizards are available.

# Image 7.26: “Advanced analysis of the speed controller” screen

# Image 7.27: Step response to rated speed

|No.|Action|
|---|---|
|1|The speed and time settings are generated automatically from the motor data.|
|2|ISDSH and ENPO (hardware enable) must be set to "High".|
|3|Click "Start test signal" button|
|4|Observe the safety notice: When you confirm the safety notice a step response is executed.|
|5|The oscilloscope is set automatically.|
|6|The faster the actual value approaches the setpoint, the more dynamically the controller is set. The overshoot of the actual value should not be more than 5-10 % of the setpoint (general figure) during the settling process.|

# Table 7.18: Instructions for optimization of the speed controller

MOOG ID No.:CB40859-001 Date:11/2020

MSD ServoDrive - DeviceHelp 138

# 7 Control

MOOG ID No.:CB40859-001 Date:11/2020

# MSD ServoDrive - DeviceHelp

Image 7.29: Speed controller transfer function

- ① Green curve = amount

Y-axis left = absolute value of nact/ndiff
- ② Blue curve = phase response

Y-axis right = Phase response nact/ndiff

# Legend for Speed controller transfer function

Image 7.28: “Noise amplitude, sampling time” screen

|ID|Index Name|Unit|Description|
|---|---|---|---|
|401|0|CON_SCON_AddTRef|Nm (N) Additive torque reference|
|402|0|CON_SCON_AddSRef|1/min Additive speed reference value (without ramp)|

# Table 7.19: “Speed controller - Analysis of Speed control” parameter

# NOTE

- The speed control loop should be evaluated in the linear range.

Check to be sure that the torque in the recording does not reach the limitation.
- An overshoot of 40% is customary for dynamic applications.

(“Symmetrical optimum”)

# 7.5 Position controller settings

|ID|Index Name|Unit|Description| | |
|---|---|---|---|---|---|
| |276|0|MPRO_FG_UsrActPos|mDegree|Actual position in user units|
| |277|0|MPRO_FG_UsrRefPos|mDegree|Setpoint position in user units|
| |279|0|MPRO_FG_UsrPosDiff|mDegree|Position tracking error in user units|
| |305|0|CON_PConTS|ms|Position control sampling time|
| |360|0|CON_PCON_Kp|1/min|Position control gain|

Table 7.20: “Position controller” parameters

# 7.5.1 Pre-control

The pre-control of the acceleration torque relieves the strain on the speed controller and optimizes the control response of the drive. To be able to pre-control the acceleration torque, the mass inertia referred to the motor shaft must be known. If the parameter for the overall mass inertia of the system (P 1516[0] - SCD_Jsum) has a value ≠ 0, that value will be automatically used to pre-control the acceleration torque.

1. Delay time and scaling for torque pre-control
2. Delay time and scaling for speed pre-control
3. Delay time for position pre-control
4. Scaling of friction torque

The pre-control of the speed reference is set to 100% via P 375[0] - CON_IP_SFF_Scale. This value should not be changed. The acceleration torque pre-control can be optimized with P 376[0] - CON_IP_TFF_Scale. Reducing this reduces the pre-control value; conversely, increasing this value also increases the pre-control value.

The position tracking error can be further reduced by predictive torque and speed pre-control – that is, in advance of the position reference setting. The higher the dynamism of the speed controller, the more dynamically the position controller can be set and the tracking error minimized. The variables for the pre-control of the speed and position controller are additionally determined either from the change in reference values or alternatively are already calculated and outputted by the motion control.

The time-related values for the position, speed and torque are transmitted to the drive control. If the dynamic change in these values is within the limits which the drive is able to follow dynamically, the load on the controllers is significantly reduced. In order to improve the dynamism of the position controller, the following screen is provided to optimize the speed and acceleration pre-control.

MOOG ID No.:CB40859-001 Date:11/2020 MSD ServoDrive - DeviceHelp 140

# 7 Control

MOOG ID No.:CB40859-001 Date:11/2020 MSD ServoDrive - DeviceHelp 141

|ID|Index Name|Unit|Description|NOTE|
|---|---|---|---|---|
|372|0|CON_IP_SFFTF|ms|Speed feedforward filter time constant (PCON l Torque feed-forward control will be disabled if linear interpolation is used.)|
|374|0|CON_IP_EpsDly|ms|Delay pos. reference by integer no. of cycles|
|375|0|CON_IP_SFFScale|%|CON_PConTS l The overall moment of inertia in P 1516[0] - SCD_Jsum must not be changed to optimize the pre-control, because this would also have an effect on other controller settings!|
|376| |CON_IP_TFFScale| |Scaling of torque feedforward|
|376|0|TFFScale_PCON| |Scaling of torque feedforward (PCON mode)|
|376|1|TFFScale_SCON| |Scaling of torque feedforward (SCON mode) l In multi-axis applications requiring precise three-dimensional axis coordination, such as in the case of machine tools, the delay of the position signal must be equally set on all axes via P 374[0] - IP_EpsDly. Otherwise the synchronization of the axes may suffer, leading to three-dimensional path errors.|
|377| |CON_IP_EnableFF| |Enable feedforward|
|377|0|CON_IP_EnableFF| |Enable feedforward|
|377|1|CON_IP_EnableFF| |Enable feedforward|
|378|0|CON_IP_ACCFFTF|ms|Acceleration feedforward filter time constant (PCON, SCON mode)|
|379| |CON_IP_FFMode| |Feed-forward calculation mode|
|379|0|PosHighRes| |Position high resolution|
|379|1|Speed| |Speed pre-control|
|379|2|Torque| |Torque pre-control|
|386| |CON_SCON_TFric| |Dry friction comp., normalized to motor rated torque l Friction torque compensation settings|
|386|0|CON_SCON_TFric|%|Friction torque compensation settings|
|386|1|CON_SCON_TFric|%|Compensation value 1|
|386|2|CON_SCON_TFric|%|Compensation value 2|
|386|3|CON_SCON_TFric|%|Compensation value 3|
|386|4|CON_SCON_TFric|%|Compensation value 4|
|387| |CON_SCON_TFricSpeed| |Friction torque compensation: Speed limits|
|387|0|CON_SCON_TFricSpeed|rpm|Friction torque compensation: Speed limits|
|387|1|CON_SCON_TFricSpeed|rpm|Friction torque compensation: Speed limit 1|
|387|2|CON_SCON_TFricSpeed|rpm|Friction torque compensation: Speed limit 2|
|387|3|CON_SCON_TFricSpeed|rpm|Friction torque compensation: Speed limit 3|
|387|4|CON_SCON_TFricSpeed|rpm| |
|388|0|CON_SCON_TConst|%|Friction torque compensation: Constant (independent of direction)|
|1516|0|SCD_Jsum|kg|Total inertia of motor and plant m*m|

# Table 7.21: “Position controller - Pre-control” parameters

The screen view can only be used to configure P 386[0] - CON_SCON_TFric. In order to access all the friction torque compensation parameters, please switch to the list view by using the “CTRL + L” key combination.

# Image 7.31: “Position control” screen

|ID|Index Name|Unit|Description|
|---|---|---|---|
|386|CON_SCON_TFric| |Dry friction comp., normalized to motor rated torque|
|386|0|%|Friction torque compensation settings The table values 0 to 2 are always applicable while table values 3 to 4 only take effect in the acceleration range.|
|386|1|%|Compensation value 1|
|386|2|%|Compensation value 2|
|386|3|%|Compensation value 3|
|386|4|%|Compensation value 4|
|387|CON_SCON_TFricSpeed| |Friction torque compensation: Speed limits|
|387|0|rpm|Friction torque compensation: Speed limits has five basic functions, each having the Torque and Speed parameters. The basic function runs proportionally up to the point (Speed, Torque), the function value remains constant at higher speeds.|
|387|1|rpm|Friction torque compensation: Speed limits|
|387|2|rpm|Friction torque compensation: Speed limits|
|387|3|rpm|Friction torque compensation: Speed limits|
|387|4|rpm|Friction torque compensation: Speed limits|
|388|0|%|Friction torque compensation: Constant (independent of direction)|

# Table 7.22: “Position controller - Feed-forward control” parameters (friction torque compensation extract)

MOOG ID No.:CB40859-001 Date:11/2020

MSD ServoDrive - DeviceHelp 142

# 7 Control

# 7 Control

# 7.6 Asynchronous motor field weakening

Up to rated speed the asynchronous motor runs with a full magnetic field and so is able to develop a high torque. Above the rated speed, the magnetic field is reduced because the maximum output voltage of the Servo Drive has been reached. The motor is operated in the field-weakening range at reduced torque.

To use field weakening for asynchronous motors, the motor parameters must be known very accurately. This applies in particular to the dependency of the main inductance on the magnetizing current. The field-weakening mode requires that a motor identification and an optimization in the basic setting range be carried out. In the process, default values for the control circuits and the "magnetic operating point" are set based on the rated motor data and the magnetizing current presetting in P 340[0] - CON_FM_Imag. For field weakening when using an asynchronous motor, a characteristic curve is always internally calculated (independently of P 435[0] - CON_FM_FWMode) and a voltage controller is superimposed.

Configuring the characteristic curve with P 341[0] - ImagSLim:

- Variant 1: P 341[0] ≠ 0 signifies selection of the 1/n characteristic (default)
- Variant 2: P 341[0] = 0 signifies selection of the modified 1/n characteristic

isd = f(n).

Combination of "pre-control via 1/n characteristic" + voltage controller. The motor identification sets the voltage controller so that the voltage supply in a weakened field is adequate. If the Servo Drive is at the voltage limit, it reduces the d-current and thus the rotor flux. The 1/n characteristic curve is calculated with operating speed SNom * ImagSLim.

As the Servo Drive has only limited dynamism, and starts to oscillate if larger gain factors are set, it is possible to use variant 2.

Image 7.33: Structure of field weakening for asynchronous motors

# 7.6.2 Variant 2: Modified characteristic

Combination of "pre-control with modified 1/n characteristic (isd=f(n)) + voltage controller. This characteristic describes the magnetizing current as a percentage of the nominal value of P 340[0] - CON_FM_Imag dependent on the speed. The choice between the modified 1/n characteristic and the static characteristic is based on P 341[0] - CON_FM_ImagSLim. The speed is specified relative to the rated speed in P 458[0] - MOT_SNom, the d-current relative to the magnetizing current in P 340[0]. A constant magnetizing current P 340[0] is injected up to the field-weakening speed. The d current will be set as a function of speed based on the configurable characteristic curve. The characteristic curve is configured with P 342 CON_FM_SpeedTab and P 343 - CON_FM_ImagTab; when using an asynchronous motor, only values 0–7 from ImagTab will be relevant; values 8–15 are intended for synchronous motor field weakening.

| | |(0)| |100|100|
|---|---|---|---|---|---|
| | |(1)| |110|100|
| | |(2)|Inom= 120| |100|
| | |(3)|1800 rpm|130|100|
| | |(4)|Imag eff = 140| |90|
| | |(5)|100 %|150|70|
| | |(6)| |160|55|
| | |(7)| |170|0|

# 7.6.3 Voltage controller

The superimposed voltage controller will be a PI controller with gain P 345[0] - CON_FM_VConKp and reset time P 346[09] - CON_FM_VConTn. In addition, the measured DC link voltage can be smoothed with a P 344[0] - CON_FM_VConTF PT1 filter. After a motor identification the voltage controller is always active, as the rule parameters are preset. With P 345[0] - CON_FNVConKp = 0 the voltage controller is deactivated. The voltage setpoint that needs to be achieved is specified using P 347[0] - CON_FM_VRef.

| |ID|Index Name| |Unit|Description|
|---|---|---|---|---|---|
| |430|0|CON_FM_VModel| |Weighting of voltage path in field model|
|340|0|CON_FM_Imag|A Magnetizing current (RMS)| | |
| |341| |CON_FM_ImagSettings| |Settings of magnetizing behaviour|
|341|0|ImagSLim|% Speed where field-weakening starts| | |
| |341|1|Imag0|% Magnetizing current during start-up| |
| |342|CON_FM_SpeedTab| | |Speed values for magnetizing current scaling|
|342| |0|CON_FM_SpeedTab|%| |
|342| |1|CON_FM_SpeedTab|%| |
|342|2|CON_FM_SpeedTab|%| | |
|342|3|CON_FM_SpeedTab|%| | |
|342|4|CON_FM_SpeedTab|%| | |
|342|5|CON_FM_SpeedTab|%| | |

# Table 7.24: “Field-weakening” parameters

MOOG ID No.:CB40859-001 Date:11/2020

MSD ServoDrive - DeviceHelp 144

# 7 Control

MOOG ID No.:CB40859-001 Date:11/2020 MSD ServoDrive - DeviceHelp 145

|ID|Index Name|Unit|Description|ID|Index Name|Unit|Description|
|---|---|---|---|---|---|---|---|
|342|6|CON_FM_SpeedTab|%|421|CON_FM_FWTabIdx| |Table index for field weakening / reluctance torque utilization|
|342|7|CON_FM_SpeedTab|%|421|0|CON_FM_FWTabIdx|Speed index|
|343| |CON_FM_ImagTab|Magnetizing current scaling vs. speed|421|1|CON_FM_FWTabIdx|Torque index|
|343|0|CON_FM_ImagTab|%|422|0|CON_FM_FWTabId|A d-current table entry|
|343|1|CON_FM_ImagTab|%|423|0|CON_FM_FWTabIq|A q-current table entry|
|Table 7.25: “Field weakening - Interior permanent magnet synchronous motor (IPMSM)” parameters|Table 7.25: “Field weakening - Interior permanent magnet synchronous motor (IPMSM)” parameters|Table 7.25: “Field weakening - Interior permanent magnet synchronous motor (IPMSM)” parameters|Table 7.25: “Field weakening - Interior permanent magnet synchronous motor (IPMSM)” parameters|Table 7.25: “Field weakening - Interior permanent magnet synchronous motor (IPMSM)” parameters|Table 7.25: “Field weakening - Interior permanent magnet synchronous motor (IPMSM)” parameters|Table 7.25: “Field weakening - Interior permanent magnet synchronous motor (IPMSM)” parameters|Table 7.25: “Field weakening - Interior permanent magnet synchronous motor (IPMSM)” parameters|
|343|2|CON_FM_ImagTab|%| | | | |
|343|3|CON_FM_ImagTab|%| | | | |
|343|4|CON_FM_ImagTab|%| | | | |
|343|5|CON_FM_ImagTab|%| | | | |
|343|6|CON_FM_ImagTab|%| | | | |
|343|7|CON_FM_ImagTab|%| | | | |
|343|8|CON_FM_ImagTab|%| | | | |
|343|9|CON_FM_ImagTab|%| | | | |
|343|10|CON_FM_ImagTab|%| | | | |
|343|11|CON_FM_ImagTab|%| | | | |
|343|12|CON_FM_ImagTab|%| | | | |
|343|13|CON_FM_ImagTab|%| | | | |
|343|14|CON_FM_ImagTab|%| | | | |
|344|0|CON_FM_VConTF|ms| | | |Voltage control filter time constant|
|345|0|CON_FM_VConKp|A/V| | | |Voltage control gain|
|346|0|CON_FM_VConTn|ms| | | |Voltage control integration time constant|
|347|0|CON_FM_VRef|%| | | |Voltage control reference (relative to maximum voltage)|
|348|0|CON_FM_SlipCon|%| | | |Slip control gain for field weakening|
|435|0|CON_FM_FWMode| | | | |Mode of field weakening / d-current calculation|
|436|0|CON_FM_FWSpeedScale|%| | | |Speed scaling for field weakening (table mode)|
|437|0|CON_FM_FWCurrScale|%| | | |q-current scaling for field weakening (table mode)|
|438|0|CON_FM_FWMaxBackEMF|V| | | |Maximum back-EMF in field weakening mode (DC link voltage)|

Table 7.24: “Field-weakening” parameters (continue)

A certain voltage reserve is required for stable operation. This is specified using P 347[0] - CON_FM_VRef (&lt; 100%). The value should be set high (≤ 90%) where there are high demands in terms of dynamic performance. When using a lower dynamic performance instead, the maximum achievable torque can be optimized in relation to the current by using higher values (&gt; 90%).

# 7.7 Field weakening and LookUpTable (LUT)

|P No.|Index Name|Unit|Description|
|---|---|---|---|
|344|CON_FM_VConTF|ms|Time constant of voltage controller actual value synchronous motor filter|
|345|CON_FM_VConKp|A/V|Voltage controller gain factor Kp|
|346|CON_FM_VConTn|ms|Voltage controller integral-action time Tn LookUp Table, LUT|
|347|CON_FM_VRef|%|Voltage controller reference (as % of the current DC link voltage) If the value 0 % is set, the controller is not active.|
|458|MOT_SNom|rpm|Motor rated speed|

For better control of motors with a torque reluctance component. For motors with different inductances on the d and q axis, a reluctance torque can contribute to obtaining better utilization of the overall torque. The d and q current have feed forward control in dependence on the target torque and the actual speed by means of tables (LUT). As this approach also subjects the d component of the current to feed forward control in exactly the same manner as the field weakening designed to achieve higher speeds as described below, the LUT usually considers both the torque and the field weakening simultaneously for the d current.

# Field weakening

Synchronous motors can also be operated above their rated speed at rated voltage by reducing their voltage consumption through the injection of a current component.

# Features

- The method is relatively robust against parameter fluctuations.
- The voltage controller can only follow rapid speed and torque changes to a limited degree.
- A non-optimized voltage controller may cause oscillation; the controller must be optimized.

MOOG ID No.:CB40859-001 Date:11/2020

MSD ServoDrive - DeviceHelp 146

# 7 Control

MOOG ID No.:CB40859-001 Date:11/2020

MSD ServoDrive - DeviceHelp 147

# Conditions

First of all, there are two variants for field weakening with synchronous motors, variants 1 and 2. They can be selected via P 435[0] - CON_FW_FWMode.

To effectively reduce the voltage consumption, the ratio of stator inductance P 471[0] - MOT_Lsig multiplied by the rated current P 457[0] - MOT_CNom to rotor flux P 462[0] - MOT_FluxNom must be sufficiently large. In contrast to field-weakening of asynchronous motors, synchronous motors can also be operated in the field-weakening range with full rated torque at the nominal value of the q-current. Power beyond the rated power output can therefore be drawn from the machine in field-weakening mode, even at rated current. This must be taken into consideration when configuring the motor.

CNom * Lsig > Faktor * FluxNom

A value greater than 0.2 is recommended for Factor.

# Voltage demand

Rotor flux * Maximum speed (in rad/s) * Number of pole pairs * < 800 V (400 V devices)

400 V (230 V devices)

|P 458|P 328|P 462[0]|[0]|[0]|*|* P 463[0]|* < 800 V (400 V devices)|
|---|---|---|---|---|---|---|---|
|400 V (230 V devices)| | | | | | | |

CAUTION! Your system/motor may be damaged if put into operation in an uncontrolled or inappropriate manner. Improper conduct can cause damage to your system/machine.

If the speed achieved by field-weakening is so high that the induced voltage exceeds the overvoltage threshold of the device (for 400 V devices approximately 800 V, for 230 V devices approximately 400 V), this will result in destruction of the Servo Drive if no additional external safety measures are applied.

Image 7.34: Structure of field-weakening of synchronous motors

Additional modes (corresponding to P 435[0] - CON_FW_FWMode in the figure at positions 0, 1 and 2) with their feed forward control of the d current are coupled with additional multiplexer settings here as an alternative.

The voltage control implementation is active in all modes! This ensures by means of P 347 CON_FM_VRef that adequate voltage reserves are available to maintain a functional speed control at higher speeds.

# 7.7.1 Variant 1 (Table)

- Deactivate table: P 340[0] - CON_FM_Imag = 0
- Select P 435[0] - CON_FM_FWMode = TABLE(1)
- Run-up slowly to required speeds
- Set scope: Isdref / sqrt(2)*Imag = % = field-weakening speed. The maximum amount of the field-weakening d-current is defined by parameter P 340[0] - CON_FM_Imag (specification of effective value).
- Enter the values in the table; P 342[0] - CON_FM_SpeedTab

# Example

The speeds in P 342[0] - CON_FM_SpeedTab must continuously increase from index 0 -7.

**Table 7.27: Example of speeds in P 342 - CON_FM_SpeedTab**
|Index|Rated speed; P 340|Field-weakening speed P 342 (0-7) [%]|Magnetizing current in field-weakening mode P 343 (0-7) [%]|
|---|---|---|---|
|(0)|100|0| |
|(1)|110|55| |
|(2)|Irated= 120|70| |
|(3)|1800 rpm|130|90|
|(4)|Imag rms = 140|100| |
|(5)|100%|150|100|
|(6)|160|100| |
|(7)|170|100| |

# 7.7.2 Variant 2 (Calc)

In the case of very rapid speed or load changes in the field-weakening range, the setting P 435[0] - CON_FM_FwMode = CALC(2) must be selected. A characteristic for higher control dynamism is calculated internally.

# Features

- Very fast adaptations, with high dynamism, are possible (open-loop control method).
- Motor parameters must be known quite precisely.
- If continuous oscillation occurs (voltage limit) the preset negative d-current value is then not sufficient. Scaling parameter P 436[0] - CON_FW_SpeedScale > 100% is used to evaluate the map at higher speeds.

The voltage controller overlaid over the map (setting as described in variant 1). The set combination of voltage controller and map entails more commissioning commitment, but it enables the best stationary behaviour (highest torque relative to current) and the best dynamic response to be achieved.

**Table 7.28: Parameters for selecting field weakening**
|ID|Index|Name / Setting|Unit|Function|
|---|---|---|---|---|
|435|0|CON_FM_FWMode| |Selection mode for field-weakening of synchronous motors|
| | |NONE (0) = Field weakening disabled| |Field-weakening is off, regardless of other settings.|
| | |TABLE (1) = Isd set by PI controller and table| |Field-weakening is effected by a characteristic which specifies the d-current (P 343[0] - CON_FM_ImagTab) dependent on the speed (P 342[0] - CON_FM_SpeedTab).|
| | |CALC (2) = Isd set by PI controller and table| |Field-weakening is effected by way of a characteristic which is set internally via the parameter|

MOOG ID No.:CB40859-001 Date:11/2020

MSD ServoDrive - DeviceHelp 148

# 7 Control

MOOG ID No.:CB40859-001 Date:11/2020 MSD ServoDrive - DeviceHelp 149

|ID|Index|Name / Setting|Unit|Function|
|---|---|---|---|---|
| |0-7|Motor or classic table, motor parameters.| |The d-current reference is then calculated dependent on the speed AND the required q-current: isd = f(n, isq_ref). The selection concerning as of what power the operation mode is “motor-oriented” or “regenerative” is defined by P-459 MOT_PNom * P-348 CON_FM_SlipCon (%).|
|REL (3)| |Internal LookUp Table (small table)| |The voltage controller overlaid over the map (setting as described in variant 1).|
|TABLE_MOT_GEN(4)| |Table with a differentiation for motor or regenerative mode| | |
|TABLE2(5)| |Table with 8 data points at equidistant spacing| | |
|LUText(6)| |External LookUp Table (large table)| | |
|LUT(7)| |reserved| | |

# 7.7.4 Variant 5 (TABLE2)

“Table 2” has 8 data points for the field-weakening current component with an equidistant spacing between two limit speeds.

Activate table: P 435[0] - CON_FM_FWMode = TABLE2(5)

The lower limit speed is P 342[0] - CON_FM_SpeedTab[0], and the upper limit speed is P 342[1] - CON_FM_SpeedTab[1]. Both numerical values for the limits speeds are standardized relative to the nominal speed of the motor (MOT_SNom).

The table values for the field-weakening current component (-id) are specified via P 343 - CON_FM_ImagTab[0..7] and standardized to sqrt(2)*CON_FM_Imag. The interpolation values are calculated using linear interpolation.

P 343 - CON_FM_ImagTab[0] and CON_FM_ImagTab[7] are used for extrapolation outside of the limit speeds.

# 7.7.3 Variant 4 (TableMotGen)

A table that differentiates between motor and regenerative mode is used.

Activate table: P 435[0] - CON_FM_FWMode = TABLE_MOT_GEN(4)

Parameter P-343 CON_FM_ImagTab can be used to configure 16 elements.

# 7.7.5 Variants 3 and 6 (LUT)

For motors with different inductances on the d and q axis, such as an IPMSM (interior permanent magnet synchronous machine), a reluctance torque which is dependent on the d and q current can be built up. A result of the exploitation of this torque is that the control by means of q current alone (id is reduced to 0) (typical for non-salient pole PMSM) is no longer adequate to make use of the machine’s full potential. Consequently, special control structures are implemented in the MSD Servo Drive to ensure optimal control for motors of this nature.

The control works in almost the same way as for the standard control circuit of a PMSM, except that the direct axis ref. current is no longer zero, but instead, both currents are dependent on the reference torque and the actual speed. To accomplish this, the standard control circuit is enhanced to include generation of a current reference value in the form of a LookUpTable (LUT). The current reference value is generated by specifying the associated d and q currents based on the target specification for the torque and the actual speed.

|nSoll|Speed|TSoll Current reference value|id, soll Current|ud, soll|Pulse controller (LUT)|iq, soll control|uq, soll inverter|iα, ist|εist|iβ, ist|
|---|---|---|---|---|---|---|---|---|---|---|
|Image 7.35: Example of 8 data points with equidistant spacing over the speed|Image 7.35: Example of 8 data points with equidistant spacing over the speed|Image 7.35: Example of 8 data points with equidistant spacing over the speed|Image 7.35: Example of 8 data points with equidistant spacing over the speed|Image 7.35: Example of 8 data points with equidistant spacing over the speed|Image 7.35: Example of 8 data points with equidistant spacing over the speed|Image 7.35: Example of 8 data points with equidistant spacing over the speed|Image 7.35: Example of 8 data points with equidistant spacing over the speed|Image 7.35: Example of 8 data points with equidistant spacing over the speed|Image 7.35: Example of 8 data points with equidistant spacing over the speed|Image 7.35: Example of 8 data points with equidistant spacing over the speed|

Notes:

1. If you do not want to have field weakening (id=0) for low speeds |n| <= P 342 - CON_FM_SpeedTab[0], then P 343 - CON_FM_ImagTab[0] must be set to 0% (extrapolation below P 342 - CON_FM_SpeedTab[0] with a value of 0).
2. The values in P 342 - CON_FM_SpeedTab[2..7] and P 343 - CON_FM_ImagTab[8..15] are not used in this mode.

Image 7.36: Structure of the field weakening for a synchronous motor LookUp Table

These d and q-current reference values can

MOOG ID No.:CB40859-001 Date:11/2020

MSD ServoDrive - DeviceHelp 150

# 7 Control

MOOG ID No.:CB40859-001 Date:11/2020

# MSD ServoDrive - DeviceHelp

Be calculated internally by the firmware (small table), OR

Be specified externally, for example using a higher-order control (large table), OR

Be loaded via the file system (large table)

The large table has a variable size for the performance map which can be set for a minimum of [3x3] to a maximum of [128x128] table entries. It is specified externally to the servo drive. Negative torques are also possible.

Two LUTs of different sizes (small and large table) are implemented for this purpose. Activate large LUT: P 435[0] - CON_FM_FWMode = LUText(6)

Each of these tables has two performance maps, one for the direct axis ref. current and one for the q-current reference values. Each are dependent on the actual speed ‘nact’ (x-direction) and the target torque ‘Tset’ (y-direction): field[x*y].

# Small table

The small table has a fixed size for the performance map of [16x40] table entries. It is calculated internally by the servo drive. Only positive torques.

Activate small LUT: P 435[0] - CON_FM_FWMode = REL(3)

|ID|Index|Name / Setting|Unit|Function|
|---|---|---|---|---|
|P 1965|0|LUT: Use of speed|Table size in the speed direction|Factory setting: 121 Minimum: 3 Maximum: 128|
|P 1965|1|LUT: Use of torque|Table size in the torque direction|Factory setting: 31 Minimum: 3 Maximum: 128|

# Table 7.30: Specifying the size of the performance map for the large table

The scaling of the map for the d and q current reference results from the nominal torque TNom and the nominal speed SNom as well as the associated scaling parameters TMax and SMax.

The values for the two inductances must be taken from the motor data sheet or can be determined by means of the motor identification (see also section "Motor identification" on page 45).

# Table 7.29: Specifying the inductances of the d and q axis

|ID|Index|Name / Setting|Unit|Function|
|---|---|---|---|---|
|P 471|0|MOT_Lsig|mH|d axis inductance|
|P 480|0|MOT_Lsq|mH|q axis inductance|

|Example:|ID|Index|Name / Setting|Description|Unit|
|---|---|---|---|---|---|
|P 1966| |0|LUT: Tab speed maximum|3600|rpm|
|P 1966| |1|LUT: Tab speed minimum|Always 0 (**)|rpm|
|P 1966| |2|LUT: Tab torque maximum|0.45|Nm|
|P 1966| |3|LUT: Tab torque minimum|-0.45 (*)|Nm|

Table 7.31: Size of the map for the size of the table

(**) Map values with a negative torque are not supported. (The range of negative torques is mapped on the range of the positive torques by means of sign manipulation.)

Image 7.37: Example

# 7.7.5.1 Internal calculation of the small table

The possible performance maps for the q and d current reference result from this:

Select: Internal calculation of the small table

| |0.45 Nm|0.45|127| | |
|---|---|---|---|---|---|
| |Nm|...|...| | |
|Torque|...|0|...| | |
|...|...|...|...| | |
| | | |0|-0.45|0|

Nm (*) Performing initialization

| |0|1|2|3|...|127|
|---|---|---|---|---|---|---|
| |...|...|...|...|3600|rpm|
| |...|...|...|...|rpm| |

(**)

Speed Parameter P 149[0] - MPRO_DRVCOM_Init = START(1).

|ID|Index|Name / Setting|Description|Unit|
|---|---|---|---|---|
|P 149| |MPRO_DRVCOM_Init|1: Start re-initialization| |

Table 7.33: P 149, perform re-initialization

MOOG ID No.:CB40859-001 Date:11/2020

MSD ServoDrive - DeviceHelp 152

# 7 Control

# 7 Control

MOOG ID No.:CB40859-001 Date:11/2020

The d/q current values are now calculated and the small table is filled with the results. Afterwards, access to the table entries of the respective table field is possible.

The small table is not saved to the controller’s ROM. Instead, it is re-calculated when the servo drive is started or a re-initialization takes place and the results are saved to RAM.

# 7.7.5.2 Parameter interface for accessing the d/q current values of the LUT

Access to the values of the LUT can be carried out via parameters P 421, P 422 and P423:

Selecting the small table:

- Parameter P 421[2] - CON_FM_FW_TabIdx[2].Table select = 0 (internal LUT).

Selecting the large table:

- Parameter P 421[2] - CON_FM_FW_TabIdx[2].Table select = 1 (external LUT).

Selecting the index for the speed:

- Parameter P 421[0] - CON_FM_FW_TabIdx[0].Speed index select.

Selecting the index for the torque:

- Parameter P 421[1] - CON_FM_FW_TabIdx[1].Torque index select.

Table value of the LUT for the d current:

- Parameter P 422[0] - CON_FM_FW_TabId - Id in A.

Table value of the LUT for the q current:

- Parameter P 423[0] - CON_FM_FW_TabIq - Iq in A.

|ID|Index|Name / Setting|Description|Unit|
|---|---|---|---|---|
|P 421|CON_FM_FWTabIdx| | | |
|P 421|0|Speed index select|Selects index for speed| |
|P 421|1|Torque index select|Selects index for torque| |
|P 421|2|Table select|0: Selects small table 1: Selects large table| |
|P 421|3|Command|0: None 1: ClearTable 2: WriteToRom| |
|P 422|CON_FM_FWTabId| |d current table entry|A|
|P 423|CON_FM_FWTabIq| |q current table entry|A|

Table 7.34: Parameter interface for accessing the LUT

The large table is not generated in the servo drive. It must be provided to the servo drive from an external source (referred to as an “external LUT”). This can be accomplished via the parameter interface described here.

For further procedure, see also section "Internal calculation of the small table" on page 152.

# NOTE

During the internal calculation of the small table, only map fields for positive speeds and torques are calculated.

# 7.7.5.3 Saving the large table to ROM

The large table can be transferred from the volatile RAM memory of the device to the non-volatile FLASH memory in the servo drive in two ways. The next time the device is started up, the reverse process is then carried out so that the large table is available immediately.

A.) Save the parameters, for example via Moog DRIVEADMINISTRATOR 5 (MDA5)

Saving the large table to the flash memory takes place concurrently to the process of saving the device parameters, for example using the “Save setting persistently in device (RAM to ROM)” button in the MDA5.

The parameter behind this procedure is P 11[0]:

Parameter P11[0] - PARA_SetCmd[0].Save = Active(1)

In contrast to the parameter values that are transferred to the NVRAM in the servo drive, the values of the large table are transferred to the flash memory in the servo drive.

# B.) Targeted saving of a special parameter using a save command

Command: Save large table to flash memory:

Parameter P 421[3] - CON_FM_FW_TabIdx[3].Command = WriteToROM(2)

This command only works for the large table: Select the table using parameter P 421[2] - CON_FM_FW_TabIdx[2]. Table select (small or large) is redundant in this case.

CAUTION! Your system/motor may be damaged if put into operation in an uncontrolled or inappropriate manner. Improper conduct can cause damage to your system/machine.

- When developing the project, care must be taken to ensure that the function “Save the large table to ROM" is never carried out repeatedly or cyclically.
- The reason is that saving to the flash memory of the servo drive is subject to a limitation of the overall number of possible save operations.

MOOG ID No.:CB40859-001 Date:11/2020

# 7 Control

# 7.7.5.4 Deleting a table RAM

The table to be deleted must first be selected and can subsequently be deleted in your RAM cells.

1. Select the table:
2. Parameter P 421[2] - CON_FM_FW_TabIdx[2].Table select = [0, 1]

Delete the table:

# 7.7.5.5 Loading the large table via the controller’s file system

This procedure is only conceived for a special use case: the large LookUp Table (LUT) must be changed continuously during operation (in the RAM memory!). Consequently, the transfer procedure needs to run quickly.

The transfer of an individual LUT can then no longer be carried out via the parameter interface (see 2 sections ago) because that would take too long during the actively running process. The solution that has been created for this is the option of first transferring the entire large table via ftp as a *.bin file to the file system of the servo drive in its entirety and then to load it to the RAM cells of the large LUT by means of a “special command."

The map fields for the LUT can be transferred from one or several .CSV files via a converter (PC program) to the target, which is the *.bin file. The proper formatting of the *.bin file can be obtained from the manufacturer.

The manufacturer may be able to provide one example of a PC converter program of this nature (“LookUpTabConverter.exe”). At the end of the preparation process, you will then have the targeted amount of different *.bin files for the process which will run later on.

MSD ServoDrive - DeviceHelp 154

# 7 Control

MOOG ID No.:CB40859-001 Date:11/2020

MSD ServoDrive - DeviceHelp 155

The ‘special command’ for transferring the data of the large table from the controller’s file system to the RAM cells of the large LUT is:

Parameter P 2009[0] - COM_CFG_File = READ_LUT(15) (Read lookup table data file from RAM disk)

NOTE

Please contact the manufacturer for more information on this special function.

# 7.7.5.6 CRC redundancy check

One single checksum can be calculated for the entire large table.

Command for one-time calculation and saving of the checksum:

Parameter P 1965[2] - CON_FM_LUT_Para[2].LUT: Tab CRC control = Tab-Crc-NewCalculation(2).

After successful calculation, the parameter automatically switches to the monitoring mode:

Parameter P 1965[2] - CON_FM_LUT_Para[2].LUT: Tab CRC control == Tab-Crc-Monitoring(1).

The calculated checksum is stored in:

Parameter P 1965[3] - CON_FM_LUT_Para[3].LUT: Tab CRC value

Now parameter P1965 should be stored persistently in the device.

The checksum monitoring is carried out one time for each initialization, e.g. when the servo drive is started up.

If the checksum comparison returns a negative response, error 30-7 appears, see also section "Error list" on page 328.

# 7.7.5.7 Important scope variables in the Moog DRIVEADMINISTRATOR 5

The Moog DRIVEADMINISTRATOR 5 offers a series of useful scope signals for diagnosis and monitoring of the calculated or externally specified values, such as the LUT index currently in use for speed (Scope ID 150) or torque (Scope ID 151).

# 7.7.5.8 CRC algorithm and C functionality

Checksum calculation

The checksum should be of the type CRC16 generation related to CRC-CCITT.

- Type: CRC16 over one byte stream
- Polynomial: x16 + x12 + x5 + 1 which equals 1021h
- Starting value: FFFFh
- final XOR: A55Ah

# 7.7.6 Field-weakening of synchronous motor voltage controller

The voltage controller is superimposed onto the selected characteristic curve. When the voltage controller is used, a part of the available voltage is used as a control reserve. The more dynamic the operation, the more control reserve is required. In this case it may be that the voltage for rated operation is not sufficient, and also that the controller starts to oscillate.

If the voltage controller oscillates, the gain must be reduced. If substantial variations between the q-current reference and actual values occur during run-up to reference speed in the field-weakening range, the Servo Drive may be at the voltage limit. In this case, a check should first be made as to whether the preset maximum value P 340[0] - CON_FM_Imag has already been reached and can be increased. If the maximum value has not yet been reached, the voltage controller is not dynamic enough and the gain P 345[0] - CON_FM_VConKp must be increased.

If no suitable compromise can be found, the voltage threshold as from which the voltage control intervenes must be reduced by the scaling parameter P 347[0] - CON_FM_VRef. If the response with voltage controller is unproblematic and no particular demands are made in terms of dynamism, the available torque can be optimized by setting P 347[0] - CON_FM_VRef to values up to 98%.

# 7.8 Synchronous motor auto commutation

For field-oriented regulation of permanently excited synchronous motors with a purely incremental measuring system, the commutation position must be determined once when the control is started (adjustment of current rotor position to encoder zero [encoder offset]). This procedure is executed by the "Auto commutation" function after initial enabling of the control when the mains voltage has been switched on for the first time. It can also be forced during commissioning by changing a parameter, which causes a complete controller initialization (e.g. change of auto commutation parameters, change of control mode etc.). Owing to the differing requirements arising from the applications, various commutation methods are provided (P 390[0] - CON_ICOM).

To check in commissioning whether the auto commutation has been successful, P 394 - CON_ICOM_Check is provided. It comprises the current commutation angle error P 394[1] - ActVal and a parameterizable limit value P 394[0] - Limit. If the commutation angle error exceeds the specified limit value, an error is generated.

MOOG ID No.:CB40859-001 Date:11/2020

MSD ServoDrive - DeviceHelp 156

# 7 Control

MOOG ID No.:CB40859-001 Date:11/2020 MSD ServoDrive - DeviceHelp 157

CAUTION! Damage to the device as a result of incorrect operation!

|ID|Index|Name / Setting|Unit|Description|
|---|---|---|---|---|
|391|0|CON_ICOM_KpScale|%|commutation detection: scaling of control gain|
|392| |CON_ICOM_Time|ms|commutation detection: times|
|392|1|CON_ICOM_Time|ms| |
|392|2|CON_ICOM_Time|ms| |
|392|3|CON_ICOM_Time|ms| |
|393| |CON_ICOM_Current|A|commutation detection: currents|
|393|0|CON_ICOM_Current|A| |
|393|1|CON_ICOM_Current|A| |
|394| |CON_ICOM_Check| |Monitoring auto commutation|
|394|0|LIMIT|degree|Auto commutation: Angle error limit|
|394|1|ActVal|degree|Auto commutation: Angle error actual value|
|365|0|CON_ICOM_AutoOn| |auto recommutation after selected event|
|366|0|CON_ICOM_RefSpeed|rpm|commutation detection: scaling of control gain|
|390|0|CON_ICOM| |Auto commutation: Control word for selection|
| | |Off (0)| |Function disabled|
| | |IENCC (1)| |Current injection|
| | |LHMES (2)| |Saturation of inductance evaluated|
| | |IECSC (3)| |Not yet implemented|
| | |IECON (4)| |Current injection, minimized movement|
| | |HALLS (5)| |Not yet implemented|
| | |HALLSDIGITAL (6)| |Digital Hall sensor|

Table 7.36: “Auto commutation” parameters

# 7.8.1 IENCC(1) method

In this method the rotor aligns in the direction of the injected current and thus in a defined position. The relatively large movement (up to half a rotor revolution) must be taken into consideration. This method cannot be used near end stops or limit switches! For the injected current it is recommended to use the rated current Irated. The time should be set so that the rotor is at rest during the measurement. For control purposes, the commutation process can be recorded with the Scope function.

# NOTE

- Inexperienced users should always choose the rated motor current (amplitude) as the current and a time of at least 2000 ms.
- If the axis is blocked, meaning the rotor is unable to align itself, the method will not work correctly. As a result, the commutation angle will be incorrectly defined and the motor may perform uncontrolled movements.
- When calculating the data sets of linear motors the values for time and current adjust automatically.

Image 7.38: “Auto commutation IENCC(1)” screen

MOOG ID No.:CB40859-001 Date:11/2020

MSD ServoDrive - DeviceHelp 158

# 7 Control

# 7 Control

MOOG ID No.:CB40859-001 Date:11/2020 MSD ServoDrive - DeviceHelp 159

# 7.8.2 LHMES(2) method

known after the first sequence and the direction of movement after the second. This method is suitable for determining the rotor position with braked rotors or motors with a high mass inertia.

- The test signal period (measurement frequency) is defined with P 392[2] - CON_ICOM_Time. If this value is 0, the controller uses a default test signal frequency of 100 Hz (period 10 ms).
- The test signal’s amplitude (current I0) is defined with P 393[0] - CON_ICOM_Current. If the value is 0, the amplitude is derived from the motor rated current. If an amplitude greater than the switching frequency-dependent power stage current is specified, the amplitude is limited to half the power stage current.
- The test signal’s DC component (current I1) is defined with P 393[1] - CON_ICOM_Current. If this value is 0, the equal portion is determined from the motor rated current.

NOTE

- A simple parameter setting is obtained by specifying the value 0 for P 392[2] - CON_ICOM_Time, P 393[0] - CON_ICOM_Current and P 393[1] - CON_ICOM_Current. The parameters are then assigned default values which are derived from the motor/power stage current. Then the measurement is performed.
- In order to be able to use the complex LHMES auto commutation method to its full extent, you will need to consult with Moog.

# Precondition

The rotor must be securely braked so that it will not be able to move when the rated current is applied. The stator of the machine must be iron-core.

With this method, saturation effects in stator inductance are evaluated. Two test signal sequences are used for this purpose, whereby the position of the rotor axis is

Image 7.39: “Auto commutation LHMES(2)” screen

# 7 Control

|ID|Index|Description|Unit|Value|7.8.3 IECON(4) method|
|---|---|---|---|---|---|
|392|2|Test signal period|ms|3|(Measurement frequency)|
|393|0|Test signal amplitude|A|1|(Current I0)|
|393|1|Test signal direct component|A|3.1|(Current I1)|

Table 7.37: LHMES configuration example

NOTE

It is advisable to connect speed tracking error monitoring with the "Power stage off" error reaction (see Section "Error reactions" on page 325). This monitoring feature prevents the motor from racing.

Image 7.40: “Auto commutation IECON(4)” screen

MOOG ID No.:CB40859-001 Date:11/2020 MSD ServoDrive - DeviceHelp 160

# 7 Control

MOOG ID No.:CB40859-001 Date:11/2020

MSD ServoDrive - DeviceHelp 161

The motor shaft motion can be minimized by a shaft angle controller. The structure and parameters of the speed controller are used for the purpose. The gain can be scaled via P 391[0] - CON_ICOM_KpScale. The precondition is a preset speed control loop. Increasing the gain results in a reduction of the motion. An excessively high gain will result in oscillation and noise. In both methods (1) and (4), the flux forming current "Isdref" is injected as a test signal.

# 7.8.4 Test signal generator

It is possible to form various signal types and transfer them to the control. This function is independent of the control mode and has a direct effect on the control. Signal types can also be combined. The delta signal form is additionally available, though at present it is only accessible via the parameter editor. The parameters are recorded in the parameter list.

# 7.8.4.1 Overview of test signal generator

Image 7.42: TSIG output: Signal curve of TG

Image 7.41: “Test signal generator” screen

# 7 Control

|ID|Parameter / Setting|Function|Info|
|---|---|---|---|
|1500|SCD_TSIG_Con|Control word of test signal generator|The parameter is reset to the value 0 on completion of the stop procedure.|
| |OFF (0)|Test signal generator deactivated| |
| |Stop(1)|Stop test signal| |
| |Start(2)|Start test signal| |
| |STOP-Cycle(3)|TG stops at end of current square cycle|TG stops next time|
| |Stop-Zero(4)|reference value passes through zero| |
|1501|SCD_TSIG_OutSel|Test signal generator output selector| |
| |OFF (0)|Not used| |
| |isdref(1)|Flux-forming current| |
| |mref(2)|Torque| |
| |sref(3)|Speed| |
| |epsref(4)|Position| |
| |sramp(5)|Speed (ramp)| |
| |ISQREF(6)|q-current reference| |
| |ISDQREF(7)|d-current q-current reference| |

Image 7.43: Test signal generator for square signal

MOOG ID No.:CB40859-001 Date:11/2020

MSD ServoDrive - DeviceHelp 162

# 7 Control

# MOOG

ID No.: CB40859-001 Date: 11/2020

# MSD ServoDrive - DeviceHelp

163

|ID|Parameter / Setting|Function|Info|
|---|---|---|---|
|USDQREF(8)|Setpoint voltage feed-forward control| | |
|PRCREF(9)|Process controller| | |
|1502|SCD_TSIG_|Number of repeat cycles|Cycles|
|1503|SCD_TSIG_|Offset of square signal| |
| |Offset| | |
|0|Offset of square signal (Stage 1)| | |
|1|Offset of square signal (Stage 2)| | |
|2| | | |
|3| | | |
|1504|SCD_TSIG_|Period of square signal|Time|
|0|Time (t1)| | |
|1|Time (t2)| | |
|Table 7.38: Parameters of test signal generator for square and sine signal (continue)|Table 7.38: Parameters of test signal generator for square and sine signal (continue)|Table 7.38: Parameters of test signal generator for square and sine signal (continue)|Table 7.38: Parameters of test signal generator for square and sine signal (continue)|
|1505|SCD_TSIG_|Amplitude of sine signal|Amp (a)|
|1506|SCD_TSIG_|Frequency of the sine signal (f); Lower frequency of the sweep signal| |
|1507|SCD_TSIG_|Starting phase of current space phasor in VFCON and ICON mode|SetPhase|
|1508|SCD_TSIG_|PRBS signal generator, sampling time|PRBSTime|
|1509|SCD_TSIG_|PRBS signal generator, amplitude|PRBSAmp|

|ID|Parameter / Setting|Function|Info|alternating frequency.|
|---|---|---|---|---|
|1510|SCD_TSIG_SignalType|SINUS(0)|Sine wave generator| |
| | |TRIANGLE(1)|Triangle wave generator| |
| | |Sweep (2)|Sweep signal (sine wave)| |
| | |TriSweep (3)|Sweep signal (triangle wave)| |
|1511|SCD_TSIG_BreakTime|0|Break (ms) before signal cycle| |
| | |1|Break (ms) between positive and negative signal cycle segment| |
|1512|SCD_TSIG_SymVal| |Symmetry value for delta signal| |
|1513|SCD_TSIG_Freq2| |Upper frequency of the sweep signal (f)| |

Table 7.38: Parameters of test signal generator for square and sine signal (continue)

# 7.8.4.2 PRBS signal

The PRBS signal is suitable for system excitation with high bandwidth using a test signal. A feedback shift register is used to generate a binary output sequence with an amplitude that can be set in P 1509 - SCD_TSIG_PRBSAmp and a "random"

MOOG ID No.:CB40859-001 Date:11/2020 MSD ServoDrive - DeviceHelp 164

# 7 Control

# 7 Control

# 7.8.4.3 Sweep signal

Use P 1510 - SCD_TSIG_SignalType = Sweep (2) to generate a sine signal of variable frequency.

Define the lower frequency with P 1506 - SCD_TSIG_Freq and the upper frequency with P 1513 - SCD_TSIG_Freq2.

Executing a test signal from the lower to the upper frequency. Set P 1504[0] - SCD_TSIG_Time equal to the desired signal duration and P 1504[1] - SCD_TSIG_Time = 0. One pass from the lower frequency to the upper frequency is carried out.

Executing a test signal from the lower to the upper frequency and back. Alternatively you can set P 1504[1] - SCD_TSIG_Time = P 1504[0] - SCD_TSIG_Time. A pass is then made from the lower frequency to the upper frequency and back again to the lower frequency.

For repeating the test signal, use P 1502 - SCD_TSIG_Cycles.

Use P 1510 - SCD_TSIG_SignalType = TriSweep (3) to generate a triangle signal with the same frequency behaviour.

# 7.9 V/Hz mode

A simple function test can be carried out in V/Hz mode. This test will show users whether a motor is connected correctly and whether the right direction of movement will be followed.

- The direction of movement is the wrong one
- The motor is at a standstill,
- Uncontrollable motion occurs,

then the connection and the motor data need to be checked.

For testing purposes, a V/Hz control system is implemented in such a way that the closed-loop speed control circuit will be replaced by the V/Hz control. The reference is the speed reference; the actual speed is set equal to the reference. A linear characteristic with two interpolation points is implemented, with a fixed boost voltage setting P 313[0] - CON_VFC_VBoost at 0 Hertz. Starting from the rated frequency P 314[0] - CON_VFC_FNom, the output voltage will remain constant at P 315[0] - CON_VFC_VNom. This means that an asynchronous motor will automatically be driven to field weakening as the frequency rises.

# Image 7.45: “V/Hz mode” screen

| |ID|Index Name| |Unit|Description|
|---|---|---|---|---|---|
| |313|0|CON_VFC_VBoost|V|V/Hz characteristic: Boost voltage|
| |314|0|CON_VFC_FNom|Hz|V/Hz characteristic: Nominal frequency|
| |315|0|CON_VFC_VNom|V|V/Hz characteristic: Nominal voltage|

# Table 7.39: “V/Hz mode” parameters

# 7.10 Process controller

|ID|Index Name|Unit|Description|
|---|---|---|---|
|19|epsRS| |Pole width Rotor/stator electrical angle|
|20|freqRS|Hz|Rotor/stator electrical frequency|
|21|freqFS|Hz|Field/stator electrical frequency|
|29|vmot|V|Current motor voltage|
|312|CON_CCON_VMot|V|Current motor voltage (rms, phase-to-phase)|

# 7.10.1 Features

- Process controller calculation in speed controller cycle
- Process controller as PI controller with Kp adaptation
- Process controller actual value selectable via selector
- Filtering and offset correct of reference and actual values
- Process controller output can be connected to different points in the general control structure
- Process controller is usable in all control modes
- Cycle time: 125 μs (if the switching frequency is 4 kHz: 250 μs)
- The process controller state is changed with a control word
- The process controller state is indicated with a status word
- The process controller’s integral term can be reduced in a targeted manner with a control command

MOOG ID No.:CB40859-001 Date:11/2020

MSD ServoDrive - DeviceHelp 166

# 7 Control

MOOG ID No.:CB40859-001 Date:11/2020

MSD ServoDrive - DeviceHelp 167

# 7.10.2 Description of control structure

The status word, P 2682[0] - CON_PRC_StatWord, indicates the process controller’s current state.

|Bit|Name|Description|
|---|---|---|
|0|On|Process controller active|
|1|ResetIReady|Integral term reset complete|

Table 7.42: Status word P 2682[0]

Image 7.46: Schematic of process controller

# 7.10.2.1 Control and status word of process controller

The process controller can be activated either with the control word, P 2681[0] - CON_PRC_CtrlWord, or directly via a digital input (for more information on how to select a function for the digital inputs, see Section "Digital inputs" on page 290, "START_PRC(48) = Start process controller” setting).

|Bit|Name|Description|
|---|---|---|
|0|On|Enabling the process controller|
|1|Reset|Resets the integral term with a ramp (P 2680[1])|

Table 7.41: Control word P 2681[0]

Image 7.47: Process controller state machine

In addition to the process controller status word, bit 8 of the device status word, P 702[0] - MON_State, will be set when the setpoint is reached. P 2679[0] - CON_PRC_RefReached can be used to configure the “Reference value attained” window for this purpose. Bit 8 will be set to TRUE if the process controller’s deviation is less than 50% of the configured “Reference value attained” window.

# 7.10.2.2 Reference values

The process control circuit setpoint can be selected via pre-defined setpoint sources. P 2683[0] - CON_PRC_REFSEL can be used to select these setpoint sources.

|Setting|Name|Description|
|---|---|---|
|0|USER|User input via CON_PRC_REFVAL_User - P2684|
| | |Setpoint for rack and pinion control.|
|1|RPDC|Automatic input of transmitted RPDC current value|
|2|ISA00|Setpoint via analog input ISA00. Analog input ISA00 (CON_ANA_Isaf[0])|
|3|ISA01|Setpoint via analog input ISA01. Analog input ISA01 (CON_ANA_Isaf[1])|
|4|IEA02|Analog input IEA02.|
|5|IEA03|Analog input IEA03.|

* See Section "Mapping parameters and scope values" on page 169

NOTE: If the target value source is selected, the respective input must also have a function assigned to it. see also section "Function selectors" on page 304

Once the setpoint source is selected, the process controller setpoint can be set with P 2666[0] - CON_PRC_REFVAL. This setpoint can then be scaled further with P 2667[0] - CON_PRC_REFSCALE in order, for example, to incorporate decimal places and/or unit conversions.

# 7.10.2.3 Actual values

The process control circuit actual value can be selected via a number of pre-defined actual value sources. P 2668[0] - CON_PRC_ACTSEL can be used to select these actual value sources.

MOOG ID No.:CB40859-001 Date:11/2020

MSD ServoDrive - DeviceHelp 168

# 7 Control

MOOG ID No.:CB40859-001 Date:11/2020

# MSD ServoDrive - DeviceHelp

|Setting|Name|Description|Setting|Name|Description|
|---|---|---|---|---|---|
|0|ANA0|Analog input ISA00 (CON_ANA_Isaf[0])|12|POS|Actual position normalized. Position in user units|
|1|ANA1|Analog input ISA01 (CON_ANA_Isaf[1])|13|P 2981|Mappable parameter P-2981 *|
|2|FIELDBUS|CON_PRC_ACTVAL_FIELDBUS P 2677|14|P 2982|Mappable parameter P-2982 *|
|3|REFSPEED|Current speed (internal) Current speed from encoder for unfiltered speed control|15|P 2983|Mappable parameter P-2983 *|
|4|REFPOS|Current position from encoder for unfiltered position control|16|P 2984|Mappable parameter P-2984 *|
|5|ISQREF_SCON|Present setpoint for current from speed controller| | | |
|6|IEA02|Analog input IEA02| | | |
|7|IEA03|Analog input IEA03| | | |
|8|P_ACT|Actual pressure.| | | |
|9|-|not used| | | |
|10|-|not used| | | |
|11|SPEED|Actual speed normalized. Speed in user units.| | | |

Table 7.44: Selector for actual value (P 2668[0]) (continue)

NOTE: If the actual value source is selected, the respective input must also have a function assigned to it. see also section "Function selectors" on page 304

The selected actual value will be output in P 2673[0] - CON_PRC_RAW_ACTVAL. In addition, a configurable offset, P 2669[0] - CON_PRC_ACTOFFSET, can be superimposed on the actual value. The actual value can be smoothed with a configurable PT-1 filter. To use this option, the user can use P 2670[0]- CON_PRC_ACTTF to set a filter time in milliseconds. If the filter time is set to 0 ms, the filter will be disabled. Moreover, the filtered actual value can be scaled with P 2671[0] - CON_PRC_ACTSCALE in order to incorporate decimal places or unit conversions. The resulting actual value for the process controller will be indicated in P 2674[0] - CON_PRC_ACTVAL.

Mapping parameters and scope values

For scope values or other process parameter values, it is possible to carry out a mapping operation for general, readable process parameters (for fieldbus or CoDeSys access). An example would be the mapping of a process value from a parameter list or range list for SERCOS Access as an input value for the process control because no allocation of sub-indexes is possible.

# Table 7.46: Allocation of P 2980 MPRO_DATA_Map to MPRO_DATA_REAL_x

|ID|Index|Name|Unit|Description|
|---|---|---|---|---|
|2980|MPRO_DATA_Map|Data parameter for real-time scope/parameter mapping.| |- Parameter|
| | | | |- Scope|
| |Bit 0:|Mapping of a process parameter value.| | |
| |1:|Mapping of a scope value.| | |
| |Bit 2..7:|Not used.| | |
| |Bits 8..15:|Parameter sub ID; not used for mapping a scope value.| | |
| |Bits 16..31:|Parameter ID or scope ID (from the scope list)| | |
| |Example, mapping of the device temperature P 704 to P 2981| | | |
| |Bit 0 →|0|P 2668|13|
| |Bit 1..7 →|0000 000|CON_PRC_ACTSEL|14|
| |Bits 8..15 (Sub-ID: 0) →|0000 0000| |15|
| |Bits 16..31 (P704) →|0000 0010 1100 0000|IST|16|
| |Result →|0000 0010 1100 0000 0000 0000 0000 0000| | |

# Table 7.45: Parameter MPRO_DATA_Map

|ID|Index|Name|Description|
|---|---|---|---|
|2980 1|MAP_REAL_1|Mapping of REAL_1 parameter|P 2683|
|2980 2|MAP_REAL_2|Mapping of REAL_2 parameter|CON_PRC_REFSEL|
|2980 3|MAP_REAL_3|Mapping of REAL_3 parameter|SOLL|
|2980 4|MAP_REAL_4|Mapping of REAL_4 parameter| |

In dependence on the index of P 2980 [1…4] used, automatic allocation is then carried out to the parameters P 2981…. P 2984 MPRO_DATA_REAL_1..4.

The following allocation is specified:

P-2985..2988 MPRO_DATA_DINT_1..4

P-2989..2992 MPRO_DATA_UDINT_1..4

MOOG ID No.:CB40859-001 Date:11/2020

MSD ServoDrive - DeviceHelp 170

# 7 Control

# 7 Control

MOOG ID No.:CB40859-001 Date:11/2020

# 7.10.2.4 PI process controller

Deviation P 2675[0] - CON_PRC_CDIFF will be the difference between the scaled process controller setpoint and the scaled and filtered actual value. The sign for this deviation can be inverted with P 2665[0] - CON_PRC_CDIFF_SIGN (CON_PRC_CDIFF_SIGN = -1).

This deviation will be passed on to the process controller. This controller is implemented as a PI controller with output limiting and an anti-windup function. Users can set a Kp gain with P 2659[0] - CON_PRC_KP, Kp scaling with P 2660[0] - CON_PRC_KPSCALE and a reset time with P 2661[0] - CON_PRC_TN. If the integral-action time is set to the maximum parameter value, the I-component of the controller is inactive. (CON_PRC_TN = 10000 [ms]).

Moreover, an offset can be added to the signal at the controller’s output by using P 2662[0] - CON_PRC_REFOFFSET. After this, the totalled manipulated variable will be passed through a limiter. The user can parameterize the limitation via parameter P 2663[0] - CON_PRC_LIMPOS for the positive limit and P 2664[0] - CON_PRC_LIMNEG for the negative limit.

Downstream of the control variable limiter there is another limitation which limits the changes to the control variable per sampling segment. By way of field parameter P 2680 - CON_PRC_RateLimiter the limitation of the control variable steepness per millisecond can be parameterized. Subindex 0 is for the limiting used for standard process controller operation and subindex 1 is for reducing the process controller’s integral term. For more details on how to set the rate limiting, see Section "Rate Limiter" on page 171.

# 7.10.2.5 Manipulated variable

The process controller’s manipulated variable downstream of the rate limiter (P 2676[0] - CON_PRC_OUTVAL) can be mapped to various internal drive setpoint or feed-forward control values. The selection is made via P 2672[0] - CON_PRC_OUTSEL.

|Setting|Name|Description|
|---|---|---|
|0|OFF|No intervention point|
|1|REFTORQUE|Additive torque reference|
|2|REFVEL|Additive speed reference value|
|3|REFPOS|Additive position reference|
|4|MPPRO|Reference value for MotionProfile via P 2678[0] - CON_OUTSEL_MOPRO|
|5|REFVEL_RAMP|Additive speed setpoint on ramp|

When selecting the additive setpoints (1-3 and 5), it is important to make sure that they are connected to the respective position in the control structure using internal units (see "Image 7.46: Schematic of process controller").

The conversion details for converting internal units to user-specific units must be gathered from the configured user units. These user units can be found under “Motion Profile --> Standardization/Units” in the operating tool. It may be possible to track the conversion between user units and user-specific units depending on whether the user units have been set up as per CiA 402, SERCOS, or with a user-specific format. P 283[0] - MPRO_FG_Type can be used to view which setup method was used.

# 7.10.3 Rate Limiter

Downstream of the control variable limiter there is another limitation which limits the changes to the control variable per sampling segment. By P 2680[0] - CON_PRC_Rate Limiter the limitation of the control variable steepness per millisecond can be parameterized. By way of index (0) the limitation is active in standard process.

# 7.10.4 Parameters

By way of index (1) reduction of the I-component is activated (see table). With P 2672[0] - CON_PRC_OUTSEL = 3 the process controller delivers an additive position reference value. The rate limiter limits the possible control variable change. The control variable change each time interval by the process controller results in a speed change on the motor shaft.

# Example

The amount of the process controller to change the speed on the motor shaft should not be higher than 100 revolutions per minute. To achieve this, the value of parameter P 2680[0] - CON_PRC_RateLimiter must be parameterized with a value corresponding to the user unit. The unit of this parameter is [x/ms]. The x stands for the respective unit of the process controller output variable. In this example the control variable (additive position reference) has the unit "Increments" (see also P 270[0] - MPRO_FG_PosNorm). This parameter indicates how many increments correspond to one motor revolution.

# Conversion from [rpm] to [Inc/ms]

nchange
100 rpm

# P 270[0] - MPRO_FG_PosNorm in Inc/rev

Internal position resolution = 1048576 inc/rev (default)

To reduce the I-component, the same method is applicable P 2680[1] - CON_PRC_Rate Limiter [Inc/ms]).

# P 2680[0] - CON_PRC_Rate Limiter = n change*1048576 *1/60000

P 2680[0] [Inc/ms]
100 [rpm] * P 270[0] [Inc/rev] * 1/60 [min/s*] * 1/1000 [s/ms]

# Table 7.48: “Process controller” parameters

| |ID|Index Name|Unit|Description|
|---|---|---|---|---|
| |2659|0|CON_PRC_Kp|Process controller: gain|
|2660|0|CON_PRC_KP_SCALE|%|Process controller: gain scaling|
|2661|0|CON_PRC_Tn|ms|Process controller: integral action time|
|2662|0|CON_PRC_REFOFFSET| |Offset of the technological controller output|
|2663|0|CON_PRC_LIMPOS| |Positive limitation of the actuator variables|
|2664|0|CON_PRC_LIMNEG| |Negative limitation of the actuator variables|
|2665|0|CON_PRC_CDIFF_SIGN| |Process controller: sign modification|
|2666|0|CON_PRC_REFVAL| |Process controller: setpoint|
|2667|0|CON_PRC_REFSCALE| |Scaling factor for setpoint|
|2668|0|CON_PRC_ACTSEL| |Process controller: selection of the actual value|
|2669|0|CON_PRC_ACTOFFSET| |Input calibration: offset|
|2670|0|CON_PRC_ACTTF|ms|Process controller: Time constant for filtering|
|2671|0|CON_PRC_ACTSCALE| |Scaling of the filtered input signal|
|2672|0|CON_PRC_OUTSEL| |Process controller: Selection of the output variable|
|2673|0|CON_PRC_RAW_ACTVAL| |Actual value of the input signal|
|2674|0|CON_PRC_ACTVAL| |Input signal after scaling and filtering|
|2675|0|CON_PRC_CDIFF| |Process controller: control deviation|
|2676|0|CON_PRC_OUTVAL| |Process controller: output value|
|2677|0|CON_PRC_ACTVAL_FIELDBUS| |Current fieldbus value|
|2678|0|CON_PRC_OUTSEL_MOPRO| |Process controller: output value for motion profile|
|2679|0|CON_PRC_RefReached|USER|“Reference value reached” window|
|2680|0|CON_PRC_RateLimiter|x/ms|Process controller: rate limiting|
|2680|1|CON_PRC_RateLimiter|x/ms|Process controller: rate limiting, reset I-component|

MOOG ID No.:CB40859-001 Date:11/2020

MSD ServoDrive - DeviceHelp 172

# 7 Control

MOOG ID No.:CB40859-001 Date:11/2020

# MSD ServoDrive - DeviceHelp

# 7.11 Hydraulic control

|ID|Index|Name|Unit|Description|
|---|---|---|---|---|
|2681|0|CON_PRC_CtrlWord| |Process controller: control word|
|2682|0|CON_PRC_StatWord| |Process controller: status word|
|2683|0|CON_PRC_REFSEL| |Process controller: selection of the reference value|
|2684|0|CON_PRC_REFVAL_User| |Process controller: reference value from user|

Firmware with a version range of V174.xx-xx includes special hydraulic parameters in addition to the standard firmware. These can be used to control pressure, volumetric flow rate, cylinder speed, and cylinder position, making it easy to implement hydraulic system applications. The firmware is available for MSD Servo Drive, MSD Single-Axis Servo Drive Compact and MSD Servo Drive Functional Safety.

# 7.10.5 Scope signals

|ID|Index|Parameter name|Unit|Function|
|---|---|---|---|---|
|2675|0|CON_PRC_Cdiff_| |Technological controller: control deviation|
|2666|0|CON_PRC_RefVal| |Technological controller: setpoint|
|2673|0|CON_PRC_Raw_ActVal| |Actual value of input signal|
|2674|0|CON_PRC_ACTVAL| |Input signal after scaling and filtering|
|2676|0|CCON_PRC_Outval| |Technological controller: output value|

Table 7.49: Parameters relevant for visualizing the process control circuit in the scope

Image 7.49: “Hydraulic basic settings” screen

# 7.11.2 Pump setting

In the “Hydraulic basic settings” screen, under the “Basic settings” button, set selector P 165[0] - MPRO_REF_SEL for the reference setpoint to "HYDRAULIC(12) = Hydraulic application".

Image 7.50: “Hydraulic basic settings – Basic settings” screen

# Possible encoder selections

- P 520[0] - ENC_MCon: Encoder for commutation and torque control
- P 521[0] - ENC_SCon: Encoder for motor and pump speed control
- P 522[0] - ENC_PCon: Encoder for cylinder position and cylinder speed control

|ID|Index|Value|Name|Description|
|---|---|---|---|---|
|165|0| |MPRO_REF_SEL|Motion profile: Selection|
| | |12|HYDRAULIC|(HYD) = Hydraulic profile (software specific)|
|300|0| |CON_CgfCon|Select control mode|
| | |1|TCON|Torque control / Hydraulic control|
|520|0| |ENC_MCon|Channel selection for motor commutation|
|521|0| |ENC_SCon|Channel selection for speed control|
|522|0| |ENC_PCon|Channel selection for position control|

# Physical variables

- Q: Volumetric flow rate
- p: differential pressure
- n: Speed
- M: Torque

Image 7.51: “Hydraulic - Pump” screen

MOOG ID No.:CB40859-001 Date:11/2020

MSD ServoDrive - DeviceHelp

# 7 Control

MOOG ID No.:CB40859-001 Date:11/2020

# MSD ServoDrive - DeviceHelp

# Pump characteristics and data

If you specify eta_(Vol,N), the servo drive will internally calculate k_L automatically as follows:

- V_g: Geometric displacement volume (P 2851[0] (ccm/rev))
- eta_Vol,N: Volumetric efficiency at the pump’s rating point (P 2851[4] (%))
- k_L = V_g ∙ n_N ∙ (1 - eta_(Vol,N) ) ∙ p_N

Theoretical volumetric flow rate Q_th is proportional to the speed:

- Q_th = V_g ∙ n

Internal pump leakage volumetric flow rate Q_L must be subtracted from the actual volumetric flow rate:

- Q = Q_th - Q_L = V_g ∙ n - Q_L

It will typically be proportional to the pressure:

- Q_L = p ∙ k_L(ϑ)

However, pump data sheets often do not specify the leakage volume rate constant, but instead specify a “volumetric efficiency” ηvol,N for the pump’s rated point, in which case:

- Q_N = V_g ∙ n_N ∙ η_(vol,N)
- Q_N [l/min] = V_g [cm³/rev] ∙ n_N [rev/min] ∙ eta_(Vol,N) [100 %]

For the torque at the pump (= motor torque):

- M = V_g / 2π ∙ p + (M_friction); (make sure to use SI units)

NOTE

- Make sure to convert to SI units!

The friction torque is normally unknown and negligible (M_friction ~ 0). This means that a “torque constant” c_M in [Nm/bar] can be calculated using the following formula:

- c_M [Nm/bar] = 1/(20pi) * V_g [cm^3/rev] = M [Nm] / p [bar]

# Example

- eta_(Vol,N) = 95 %, n_N = 1500 rev/min, v_G = 10 cm³/rev -> Q_N = 14,2 l/min

Displacement volume V_g is usually specified in data sheets. In contrast, if there is a pressure measurement available, the torque constant is easier to determine experimentally if necessary. In this case, a constant pressure can be built up on the drive in a steady state and the delivered motor torque can be used to calculate the displacement volume.

Example                                                                                  Example

Running the pump, e.g. at a low speed “against” the built-up pressure. Scope plot (Moog DRIVEADMINISTRATOR 5) for Scope ID 11 – m_act yields a mean value of M = 15.9 [Nm]. The built-up pressure at the pressure sensor is p = 100 [bar] => c_M = 0.159 [Nm/bar] => V_g = 10 [ccm/rev]

Accordingly, both parameters (P 2851[0; 1] - HYD_Pump) can be set. However, only one of the two values should be set. The other one will be automatically calculated afterwards and will be shown accordingly.

P 2851[2] - HYD_Pump is used to set the nominal pressure. P 2851[3] - HYD_Pump specifies the volumetric efficiency at this rating point. This information will then be used to calculate the leakage volumetric flow rate, which is used internally to control the volumetric flow rate.

For pumps with variable-displacement volume, a second pump data set can be created P 2873 HYD_Pump2. This can be selected via P 2863 HYD_TabCtrl bit 8 for the respective motion block (7.11.6 Hydraulic Motion profile). Alternatively, the displacement volume can also be adjusted online via a pump scaling using P 2879 [2] Pump1_DisplScalePDO and P 2879[3] Pump2_DisplScalePDO. This allows the displacement volume to be changed variably during the process.

# 7.11.2.1 Speed limits

The pump’s minimum and maximum speeds can be set in P 2851[4; 5] - HYD_Pump. The control system will not exceed or fall below the values set there.

MOOG                       ID No.:CB40859-001 Date:11/2020                                                                            MSD ServoDrive  - DeviceHelp   176

# 7 Control

MOOG ID No.:CB40859-001 Date:11/2020 MSD ServoDrive - DeviceHelp 177

# 7.11.2.2 Pump protection functions

Meanwhile, the speed is taken into account linearly, i.e. at half the speed, half the duration will be tolerated.

# 7.11.2.2.1 P2t shutdown

Reason: The speed / the volumetric flow rate proportional to the speed results in a proportional heat removal.

Usually, the pump needs to be protected against continuous operation with built-up pressure and low speeds. To this end, a critical minimum speed n_crit can be specified so that, at nominal pressure p_N, it will only be allowed to fall below this speed for a critical duration of t_crit. The following critical limit integral is calculated continuously in the servo drive for this purpose:

l i_G = 1 / τ_crit ∙ ∫ ((p/p_N)² - n / n_crit) dt

This takes into account the power loss that has an approximately quadratic relationship to the pressure, as well as the heat removal that is proportional to the speed. If the nominal pressure were requested in a stopped state (n = 0), for example, i_G would increase to a value of 1.0 before t_crit would elapse. At half the critical speed, twice that time would be required. Meanwhile, a different pressure would have a quadratic effect, meaning that half the nominal pressure would be allowed to be present four times the critical duration time.

This function can be used to open a bypass circuit when a configurable limit (i_G = 0.9) is reached. Normally, this will result in the pump speed increasing and, after a certain hysteresis (i_G = 0.8) is fallen below, the bypass will be closed again in order to reduce the power loss. If i_G increases all the way to 1.0 instead, an error will be triggered and the drive will be stopped in order to protect the pump.

At the nominal pressure, the critical speed should not be fallen below for a time longer than the critical duration. The square of the pressure is included in the calculation here, i.e. at half the pressure, four times the duration will be tolerated.

Reason: Leakage losses have an approximately quadratic relationship to the pressure.

# Example

Critical speed: 500 bar, Nominal pressure: 100 bar, Critical time: 10 s.

- This pump can be run at 500 rpm, 100 bar as long as necessary.
- At very low speeds close to a full stop, and with a pressure of 100 bar, it would only be permissible to run the pump for 10 s. After 9 s, the bypass valve (if any) would be opened. If this did not result in the speed increasing,

an error would be triggered one second later and, normally, the drive would be stopped.

If continuous pressure is permissible even at full stop, the corresponding pressure can be entered in P 2851[10] - HYD_Pump.

# 7.11.2.2.2 Pressure-dependent speed regulation characteristic

The speed (P 2851.5 nMin and P 2851.6 nMax) from the pump configuration are used for nMin and nMax. Thus, a negative pump speed is permitted as of the set minimum pressure for high pressures. The entire speed range can be utilized above the specified maximum pressure. In the transition range from minimum to maximum pressure, the speed curve is linear. The speed characteristic of the pump then behaves as follows:

P 2851.6 nMax
P 2851.14 pMin
P 2851.15 pMax
p

For some types of pumps (e.g. internal-gear pumps), negative speeds for very low pressures (0 bar) are not permitted because in these operating areas, the lubrication of the pump gear can no longer be ensured. This is why it is possible to configure the pump characteristic curve in dependence on pressure, which makes it possible to protect the pump from mechanical destruction (P 2840.14 PumpSpdProt = 1). It is nonetheless still possible to quickly relieve a high pressure through a negative pump speed. Using P 2851[14,15]-HYD_Pump, it is possible to configure a minimum and maximum pressure for negative speeds.

MOOG ID No.:CB40859-001 Date:11/2020

MSD ServoDrive - DeviceHelp 178

# 7 Control

# 7 Control

# MOOG

ID No.: CB40859-001 Date: 11/2020

# MSD ServoDrive - DeviceHelp

179

# 7.11.2.3 Gear ratio between pump and pump motor

If there is gearing between the pump and the pump motor, the gear ratio needs to be entered in P 2851[9] - HYD_Pump. If only the direction of rotation needs to be changed (motor turns in a negative direction when the pump turns in the positive, "correct" direction), a factor of "-1" can be entered to correct the direction of rotation.

# 7.11.2.3.1 Parameters

|ID|Index Name|Unit|Description|
|---|---|---|---|
|2851|HYD_Pump|Pump parameters| |
|2851|0|displ|ccm/rev Offset|
|2851|1|cTorque|Nm/bar Torque constant|
|2851|2|pNom|bar Nominal pressure|
|2851|3|nNom|rpm Rated speed|
|2851|4|etaVol|% Volumetric efficiency at nominal pressure, rated speed|
|2851|5|nMin|rpm Minimum speed|
|2851|6|nMax|rpm Maximum speed|
|2851|7|nCritical|rpm Critical speed (@ nominal pressure)|
|2851|8|TCritical|s Max. permissible time at low speed and nominal pressure|
|2851|9|iGearPump|Gear ratio between pump and motor|
|2851|10|p0|bar Max. permissible stationary pressure at a standstill|
|2851|11|cLeakage|(l/min)/bar Leakage constant|
|2851|12|stopramp|(1/min)/s Stop ramp (during valve switching etc.)|
|2851|13|tSwValve|ms Valve switching time|
|2851|14|pMin|bar Minimum pressure (depending on pump protection function)|
|2851|15|pMax|bar Maximum pressure (depending on pump protection function)|

Table 7.51: “Hydraulic - Pump” parameters

# Hydraulic signal settings, analog inputs

- Pressure reference value (pRefSrc)
- Volumetric flow rate reference value (QRefSrc)
- Pressure actual value (pActCalc)
- Pressure limitation (Minimum/maximum values) (pMinSrc/pMaxSrc)
- Volumetric flow rate limitation (minimum/maximum values) (QMinSrc/QMaxSrc)
- Volumetric flow actual value (QActCalc)
- Leakage volumetric flow rate (QLeakEst)
- Speed reference value (nRefSrc)
- Hydraulic cylinder valve control (CylValveSwSel)

|ID|Index Name / Setting|Unit|Description|
|---|---|---|---|
|2840|HYD_Cfg| |Configure Hydraulic System Control|
|2840|0|Reserved|Reserved|
|2840|1|pRefSrc|Hydraulics: Selection of pressure reference source|
| | |0: ANA|Setpoint of analog input|
| | |1: PROFILE|Setpoint from profile|
|2840|2|QRefSrc|Flow rate, selection of reference source|
| | |0: ANA|Setpoint of analog input|
| | |1: PROFILE|Setpoint from profile|
|2840|3|pActCalc|Hydraulic: Pressure actual value calculation method|
| | |0: PACT|pAct will be used for control|
| | |1: PACT2|pAct2 will be used for control|
| | |2: DIFF_PACT_PACT2|pAct-pAct2 will be used for control|
| | |3: PRIO|Both values will be used with Current Priority|
| | |4: PMOTT|Calculation from motor torque|
| | |5: PACTSEL|Selection between pAct and pAct2 per parameter|
|2840|4|pMinSrc|Minimum pressure source selector|
| | |0: PressCon|Min. pressure value from HYD_PressCon_pMin|
| | |1: Neg_pRef|Min. pressure, negative value from HYD_Val_pRef|
| | |2: Pos_pRef|Min. pressure value from HYD_Val_pRef|
|2840|5|pMaxSrc|Maximum pressure source selector|

The signal sources for the reference values, actual values, and signal limits are selected with P 2840 - HYD_Cfg. A variety of signal sources can be set for the following variables:

Table 7.52: “Selection of signal sources” parameters

MOOG ID No.:CB40859-001 Date:11/2020

MSD ServoDrive - DeviceHelp 180

# 7 Control

# MOOG

ID No.: CB40859-001 Date: 11/2020

# MSD ServoDrive - DeviceHelp

181

# 7.11.3.2 Signal scaling

|ID|Index Name / Setting|Unit|Description|
|---|---|---|---|
|0|PressCon| |Max. pressure value from HYD_PressCon_pMax|
|1|Pos_pRef| |Max. pressure value from HYD_Val_pRef|
|2|Neg_pRef| |Max. negative pressure value from HYD_Val_pRef|
|2840|6 QMinSrc| |Minimum flow rate source selector|
|0|PressCon| |Min. pressure value from HYD_PressCon_QMin|
|1|Neg_QRef| |Min. pressure, negative value from HYD_Val_QRef|
|2|Pos_QRef| |Min. pressure value from HYD_Val_QRef|
|2840|7 QMaxSrc| |Maximum flow rate source selector|
|0|PressCon| |Max. volume flow value from HYD_PressCon_QMax|
|1|Pos_QRef| |Max. volume flow value from HYD_Val_QRef|
|2|Neg_QRef| |Max. negative volume flow value from HYD_Val_QRef|
|2840|8 QActCalc| |Flow rate calculation method|
|0|MEAS| |From the measurement|
|1|CYL| |From the cylinder speed|
|2840|9 QLeakEst| |Flow rate leakage estimation method|
|0|NONE| |No leakage compensation|
|1|OBS| |Observer|
|2|MEAS| |Directly measured|
|3|CTRL| |PI controller|
|2840|10 nRefSrc| |Pump speed reference source selector|
|0|ANA| |Setpoint from profile|
|1|PROFILE| |Reference value from profile|
|2840|11 CylValveSwSel| |Function selector for the valve switchover of the cylinder|
|0|Para| |Manual valve control|
|1|Spd| |Automatic valve switchover via speed setpoint|
|2|Tab| |Valve switchover via motion block table|
|3|Pos| |Automatic valve switching via Pos. Diff.|
|2840|12 AltPosCon| |Alternative position controller|
|2840|13 AltSpdCon| |Alternative cylinder speed controllers|
|2840|14 PumpSpdProt| |Pump speed protection|
|2840|15 PumpP2tProt| |p2t protection for pump|
|2840|16 AltPressCon| |Alternative pressure controller|
|2840|17 AltPressConLimit| |Alternative pressure limit controller|

Table 7.52: “Selection of signal sources” parameters (continue)

There are two scaling paths available for the actual pressure, actual pressure 1 (pact1) and actual pressure 2 (pact2). This allows two sensor signals to be processed. A selection between an analog input or the hydraulic motion profile as the signal source can be made for the reference pressure (pref).

The result after the scaling will be shown in P 2847 - HYD_Val. These values will also be used for control purposes.

# 7.11.3.2.2 Signal scaling, volumetric flow rate

A scaling path is available for the actual volumetric flow rate (QAct). A selection between an analog input or the hydraulic motion profile as the signal source can be made for the reference volumetric flow rate (Qref).

The result after the scaling will be shown in P 2847 - HYD_Val. These values will also be used for control purposes.

# 7.11.3.2.3 Signal scaling, pump speed

P 2845 - HYD_Input_Val displays the unscaled pump speed reference value of the pump speed control.

Further processing and scaling is carried out in P 2846 - HYD_Input_Adapt. A scaling factor, an offset, and a signal limit (nRef_Min and nRef_Max) can be set.

The actual speed is evaluated via the respective encoder input (see Section "Encoder selection" on page 53). A selection between an analog input or the hydraulic motion profile as the signal source can be made for the reference speed (nref).

The result after the scaling will be shown in P 2847 - HYD_Val. These values will also be used for control purposes.

Image 7.58: “Hydraulic signal scaling, volumetric flow rate” screen

Image 7.59: “Hydraulic signal scaling, pump speed” screen

MOOG ID No.:CB40859-001 Date:11/2020

MSD ServoDrive - DeviceHelp 182

# 7 Control

MOOG ID No.:CB40859-001 Date:11/2020

MSD ServoDrive - DeviceHelp 183

The individual parameters for configuring the signals are shown in the following table.

| | | | |ID|Index Name|Unit|Description| |
|---|---|---|---|---|---|---|---|---|
| | | | |2846|21|nRef_Offset|1/min|Offset|
| | | | |2846|22|nRef_Min|1/min|Min|
| | | | |2846|23|nRef_Max|1/min|Max|
|2845| |HYD_Input_Val| |Input values for hydraulics system| | | | |
|2845| | | | |0|pAct|bar|Hydraulics: Pressure actual value|
|2845|1|pAct2| | | |bar|Hydraulics: Pressure actual value (sensor2)| |
|2845|2| | | | |pRef|bar|Hydraulics: Pressure setpoint|
|2845| | | | |3|QRef|l/min|Flow rate, setpoint|
|2845|4|QAct|l/min|Flow rate, actual value| | | | |
|2845|5|nRef|1/min|Pump set speed| | | | |
| | | | |2847| |HYD_Val| |Hydraulics: Setpoints and actual values|
| | | | |2847|0|pAct|bar|Hydraulics: Pressure actual value|
| | | | |2847|1|pAct2|bar|Hydraulics: Pressure actual value (sensor2)|
| | | | |2847|2|pRef|bar|Hydraulics: Pressure setpoint|
| | | | |2847|3|QRef|l/min|Flow rate, setpoint|
| | | | |2847|4|QAct|l/min|Flow rate, actual value|
| | | | |2847|5|nRef|1/min|Pump set speed|

| | | | |ID|Index Name|Unit|Description|
|---|---|---|---|---|---|---|---|
|2846|0|pAct_Scale|bar|Scaling| | | |
|2846|1|pAct_Offset|bar|Offset| | | |
|2846|2|pAct_Min|bar|Min| | | |
|2846|3|pAct_Max|bar|Max| | | |
|2846|4|pAct2_Scale|bar|Scaling| | | |
|2846|5|pAct2_Offset|bar|Offset| | | |
|2846|6|pAct2_Min|bar|Min| | | |
|2846|7|pAct2_Max|bar|Max| | | |
|2846|8|pRef_Scale|bar|Scaling| | | |
|2846|9|pRef_Offset|bar|Offset| | | |
|2846|10|pRef_Min|bar|Min| | | |
|2846|11|pRef_Max|bar|Max| | | |
|2846|12|QRef_Scale|l/min|Scaling| | | |
|2846|13|QRef_Offset|l/min|Offset| | | |
|2846|14|QRef_Min|l/min|Min| | | |
|2846|15|QRef_Max|l/min|Max| | | |
|2846|16|QAct_Scale|l/min|Scaling| | | |
|2846|17|QAct_Offset|l/min|Offset| | | |
|2846|18|QAct_Min|l/min|Min| | | |
|2846|19|QAct_Max|l/min|Max| | | |
|2846|20|nRef_Scale|1/min|Scaling| | | |

Table 7.53: “Signal scaling” parameters

# 7.11.3.3 Example of application for volume/mass sensors

"negative" pressures can also be present in an application with pressure difference measurement, a negative value must also be entered or permitted in the HYD_PressCon.pMin parameter. If these pressure limits are reached, the pump speed is limited accordingly dynamically. In addition, the source of the limiting pressure value can be selected using P 2840[5] - pMaxSrc and P 2840[6] - pMinSrc.

It is possible to toggle between parameter P 2850[6] - pMax and the reference value P 2843[0] - pRef by selecting PressCon(0), Pos_pRef(1) and Neg_pRef(2). This allows the pressure limitation to be specified via the analog input of the pressure reference value, for example.

The pressure limitation control uses the same controller parameters P 2850[0] Kp and P 2850[2] Tn as the standard pressure control. However, the control structure differs from the standard pressure controller. The pressure limiting controller tends to oscillate when the control is set very dynamically. Consequently, we recommend choosing a setting with low gain factors and then increasing it according to the requirements. In addition, the setting of the integral-action time (the integral part) is absolutely necessary for the function of the limiting controller. Our recommendation is values in the high two-digit or lower three-digit range. However, these values are only a guideline. Every application will, of course, have its own requirements for dynamics and accuracy. The optimum setting must be determined during commissioning.

Image 7.60: Example of application for volume/mass sensors

For the purpose of pressure limitation during the process or in individual motion blocks, a scaling (P 2872 HYD_Tab_Limit) can be used to influence the preset limitation. (see also section "Hydraulic motion block table" on page 193 and see also section "Scaling of the hydraulic limits" on page 195)

# 7.11.4 Hydraulic Limitations

# 7.11.4.1 Pressure limit

Furthermore, the limitation can be switched to inactive by means of a higher-level control system. The five lower bits of the hydraulic control word are used for this purpose, P 2841 HYD_Ctrl bit 11 to bit 15. Setting bit 11 deactivates the pressure limitation. Bits 12 to 15 only switch off the limitation in the respective quadrant of the P/Q coordinate system. (Bit 12 = Q1, bit 13 = Q2, bit 14 = Q3, bit 15 = Q4).

It is usually necessary to limit the pressure to a maximum permissible value. This can be done either mechanically using an overpressure valve or using the pressure limitation of the servo drive. The pressure limitation allows both the maximum and the minimum permissible reference value of the pressure control to be limited.

MOOG ID No.:CB40859-001 Date:11/2020 MSD ServoDrive - DeviceHelp 184

# 7 Control

MOOG ID No.:CB40859-001 Date:11/2020

MSD ServoDrive - DeviceHelp 185

Q [l/min]

NOTE

- The limitation controllers are not active in all control modes. The following table shows which limitations can be configured for which control mode.
- Section 7.11.6 Hydraulic Motion profile describes for which control modes the scaling factor can be used.

|Control mode|Pressure limit|Volumetric flow rate limit|
|---|---|---|
|NPumpCon(4)|x|x|
|PressCon(0)|x|x|
|VolCon(5)| |x|
|VolConPlim(1)|x|x|
|SpdCon(2)| |x|
|SpdCon_plimit|x| |
|-SpdCon_PI| | |
|PosCon(3)| | |
|- PosCon_QFF|x| |
|- PosCon| | |
|- PosCon_plimit|x|x|
|- PosCon_TrackingError|x| |

Table 7.54: Hydraulic Limitations

For the purpose of volumetric flow rate limitation during the process or in individual motion blocks, a scaling factor (P 2872 HYD_Tab_Limit) can be used in some control modes (see Table) to influence the preset limitation. (see also section "Hydraulic motion block table" on page 193)

NOTE

l  The limitation controllers are not active in all control modes. The table shows which limitations can be configured for which control mode. See

# Table 7.54: Hydraulic Limitations

Image 7.62: “Pressure limit” screen

# 7.11.4.2 Volumetric flow rate limit

The minimum and maximum volumetric flow rate can be limited to suit the system requirements using the volumetric flow rate limit. Once the parametrized volumetric flow rate limits are reached, the pump speed is limited by the motor speed controller.

A selection can be made between P 2850[8] - QMax and P 2847[3] - QRef as the source of the limit value by making a source selection (QMaxSrc). P 2847[3] - QRef can be used to specify the limit via the volumetric flow rate value, which, for example, can be set variably using an analog input.

MOOG ID No.:CB40859-001 Date:11/2020

MSD ServoDrive - DeviceHelp 186

# 7 Control

# 7 Control

MOOG                          ID No.:CB40859-001 Date:11/2020

MSD ServoDrive   - DeviceHelp      187

|ID|Index|Name|Unit|Description|
|---|---|---|---|---|
|2840|4|pMinSrc| |Minimum pressure source selector|
|2840|5|pMaxSrc| |Maximum pressure source selector|
|2840|6|QMinSrc| |Minimum flow rate source selector|
|2840|7|QMaxSrc| |Maximum flow rate source selector|
|2840|8|QActCalc| |Flow rate calculation method|
|2840|9|QLeakEst| |Flow rate leakage estimation method|
|2840|10|nRefSrc| |Pump speed reference source selector|
|2840|11|CylValveSwSel| |Function selector for the valve switchover of the cylinder|
|2840|12|AltPosCon| |Alternative position controller|
|2840|13|AltSpdCon| |Alternative cylinder speed controllers|
|2840|14|PumpSpdProt| |Pump speed protection|
|2840|15|PumpP2tProt| |p2t protection for pump|
|2840|16|AltPressCon| |Alternative pressure controller|
|2840|17|AltPressConLimit| |Alternative pressure limit controller|

Table 7.55: Parameters – Configure Hydraulic System Control (continue)

|ID|Index|Name|Unit|Description|
|---|---|---|---|---|
|2850| |HYD_PressCon| |Hydraulic pressure control parameters|
|2850|0|Kp|rpm/bar|Gain|
|2850|1|KpScale| |Gain scaling|
|2850|2|Tn|ms|Integration time constant|
|2850|3|Tv|ms|Rate time|
|2850|4|Tp|ms|Integral-action time|
|2850|5|pMin|bar|Minimum permissible pressure|
|2850|6|pMax|bar|Maximum permissible pressure|
|2850|7|QMin|l/min|Minimum flow rate|
|2850|8|QMax|l/min|Maximum flow rate|
|2850|9|PressWindow|bar|Pressure control parameters|
|2850|10|decmpLvl|bar|Level for active decompression|

Table 7.56: Parameters – Pressure control parameters

|ID|Index|Name|Unit|Description|
|---|---|---|---|---|
|2850|11|decmpRate|bar/s|Rate for active decompression|
|2850|12|pActScale| |Scaling for pAct|
|2850|13|pAct2Scale| |Scaling for pAct2|
|2850|14|pRange_k|%|Pressure range threshold|
|2850|15|pRange_midpoint|bar|Pressure range midpoint|

Table 7.56: Parameters – Pressure control parameters (continue)

# 7.11.5 Cylinder configuration

If no volumetric flow rate sensor is employed, the volumetric flow rate can be calculated using a linear encoder and the cylinder geometry (P 2840.8 QActCalc). To do so, various different cylinder dimensions must be passed to the servo drive. The different surface areas of the piston and ring side must be kept in mind because either more or less medium is required for the same path depending on the power direction.

Image 7.64: “Cylinder configuration” screen

The parameters which must be set are P 2852[0] - cylArea1 and P 2852[2] - cylArea2.

Cylinder piston surface area A1 = cylAreal1 = A1 in cm²

Cylinder ring surface area A2 = cylAreal2 = A2 in cm²

MOOG ID No.:CB40859-001 Date:11/2020 MSD ServoDrive - DeviceHelp 188

# 7 Control

# 7 Control

MOOG ID No.:CB40859-001 Date:11/2020

MSD ServoDrive - DeviceHelp 189

# NOTE

For pumps which only operate with a positive speed (only one direction of rotation) and switch the direction of action of the cylinder via a directional valve, one of the two cylinder surfaces must be specified as negative (Image 7.64: “Cylinder configuration” screen). If the pump can be operated in both directions of rotation, this is not necessary.

Since in MSD Servo Drive all encoder input variables are calculated in revolutions, the hydraulics require a relationship between linear and rotary motion for the internal calculations of the cylinder model, cylinder speed and feed-forward control variables. For this purpose, the encoder resolution Sx of the linear encoder in μm per encoder revolution must be known (Para 2852.7unit_scale). In this case, one encoder revolution is the singleturn range of the respective position sensor for the cylinder position. This corresponds to 32768 μm/rev for a 16 bit linear encoder with a resolution of 0.5 μm per increment.

If the current position of the cylinder is transferred via the bus interface (P 2298 ComAngle32), the single and multiturn range is set to 16 bits each. This corresponds to 65536 μm/rev.

|ID|Index|Name|Unit|Description|
|---|---|---|---|---|
|2852|HYD_SpdCon|Speed control parameters|Speed control parameters|Speed control parameters|
|2852|0|cylArea1|cm2|Cylinder area|
|2852|1|Ife_K_scale| |Leakage Flow Estimator: Gain scaling|
|2852|2|cylArea2|cm2|Cylinder area (option 2, use neg. value for neg. direction)|
|2852|3|Ife_K_scale2| |Leakage Flow Estimator: Gain scaling (option 2)|
|2852|4|res| |Reserved|
|2852|5|res| |Reserved|
|2852|6|res| |Reserved|
|2852|7|unit_scale|um/rev|Hydraulic physical unit scaling|

Table 7.57: Parameters – Pressure control parameters

# 7.11.6 Hydraulic Motion profile

specified manually for each individual table index. In addition, the valve switching delay can be taken into account; the start of the setpoint ramp is delayed after a valve switchover (P 2851.13 - tSwValve). Once the command for the switchover of a valve has been triggered, a timer begins to run which delays the setpoint enable. If the motor still has a speed reference value at the moment of the switchover, it is run down to 0 rpm using the ramp specified in P 2851.12 - stopRamp.

# Selection of operation mode

- 0 = PARA
- Setpoint setting from table, table index (P 2860) set using parameter access (BUS, PLC, Moog DRIVEADMINISTRATOR 5, etc.) (ramp changes are applied when the index changes)
- 1 = TERM
- Setting from table, table index (P 2860) will be updated via digital inputs (ramp changes will be applied when the index changes)
- 2 = CTRL1
- Operation via control word. Only parameters from table index 0 are used in the CTRL1 mode. The control mode is set via the control word (CtrlBit 0-3) and the setpoint values can be changed directly in table index 0.
- 3 = CTRL2
- Operation via control word. Parameters from all table indexes can be used in CTRL2 mode. The respective motion block is selected using the control word (CtrlBit 0-3).
- 4 = TAB
- Setpoint setting from table, table index (P 2860) is controlled using the switching condition of the motion block table.

NOTE

- In CTRL1 and CTRL2, the setpoint is adopted cyclically independently of NewSetpoint and ramp change with rising edge at NewSetpoint or new table index.

The various different operating modes for controlling the motion sequences can be selected using P 2862[0] - OpMode. The parameter P 2840[11] -CylValveSwSel can be used to set various different modes for controlling the actuating valves. Valve switching can be performed automatically via the POS(3) mode depending on the position difference or be.

MOOG ID No.:CB40859-001 Date:11/2020 MSD ServoDrive - DeviceHelp 190

# Control

# MOOG

ID No.: CB40859-001 Date: 11/2020

# MSD ServoDrive - DeviceHelp

191

|ID|Index Name|Unit|Description|
|---|---|---|---|
|2862|0|HYD_OpMode|Hydraulic: operation mode|

Table 7.58: “Hydraulic - Operation mode” parameters

For communication with a higher-level controller in the CTRL1 and CTRL2 operating modes, some scaling factors of process variables and control parameters are summarized in P 2879 HYD_AddProcData. These parameters are PDO-capable and are created in the int16 format in order to use as little memory space as possible in the process data channel. The unit of the parameters is per mill. The value 1000 therefore corresponds to 100%.

If the direction valves should be controlled via the servo drive, the following three modes are available. In addition, the respective digital outputs on the servo drive must be assigned to the correct function. For the direction valves, HYD_CYL_POS (76) and HYD_CYL_NEG(77) must be selected. Optionally, two further valves can be controlled depending on the hydraulic setpoint table (HYD_VAL_OPT1(74) and HYD_VAL_OPT2(75)).

|ID|Index Name|Unit|Description|
|---|---|---|---|
|2879|0|PressCon1_KpScale_Pdo|0.1% Additional KpScale of press controller 1 (PDO access)|
|2879|1|PressCon2_KpScale_Pdo|0.1% Additional KpScale of press controller 2 (PDO access)|
|2879|2|Pump1_DisplScale_Pdo|0.1% Displacement scale of pump 1 (PDO access)|
|2879|3|Pump2_DisplScale_Pdo|0.1% Displacement scale of pump 2 (PDO access)|
|2879|4|PosConSw_KpScale1_|0.1% Additional KpScale1 of pos controller (PDO access)|
|2879|5|PosConSw_|0.1% Additional KpScale_InWindow of pos controller (PDO access)|
|2879|6|KpScaleInWin_Pdo| |
|2879|7|KiScaleInWin_Pdo|0.1% Additional KiScale_InWindow of pos controller (PDO access)|
|2879|8|PressCon1_KiScale_Pdo|0.1% Additional KiScale of press controller 1 (PDO access)|
|2879|9|PressCon2_KiScale_Pdo|0.1% Additional KiScale of press controller 2 (PDO access)|
|2879|10|reserved 9| |
|2879|11|reserved 10| |
|2879|12|reserved 11| |

Table 7.60: Parameter P 2879 HYD_AddProcData

|ID|Index Name|Unit|Description|
|---|---|---|---|
|2840|11|CylValveSwSel|Function selector for the valve switchover of the cylinder|

Table 7.59: “Hydraulic - Operation mode” parameters

# 7.11.6.1 Hydraulic control word and status word

# 7.11.6.1.1 Hydraulic Control word

|Bit|Operation Mode CTRL1 (Hydraulic Control Mode)|Operation Mode CTRL2 (Table index)|
|---|---|---|
|0|0000 Pressure control| |
| |0001 Volumetric flow rate control (pressure limited)|1|
| |0010 Cylinder speed control|2|
| |0011 Cylinder position control| |
| |0100 Pump speed control| |
|3|0101 Volumetric flow rate control (without pressure limited)| |
|4|NewSetPoint (ramp change with rising edge or new hydraulic control mode)| |
|5|use p_act2 (use actual pressure value 2)| |
|6|SwitchCylOpt (switchover of cylinder area, A1/A2)| |
|7 - 10|unused| |
|11|Pressure limitation inactive| |
|12|Pressure limitation in Q1 inactive| |
|13|Pressure limitation in Q2 inactive| |
|14|Pressure limitation in Q3 inactive| |
|15|Pressure limitation in Q4 inactive| |

Table 7.61: Hydraulic control word: What the bits mean

# MOOG

ID No.: CB40859-001 Date: 11/2020

# 7 Control

|ID|Index|Name|Unit|Description|
|---|---|---|---|---|
|2841|0|HYD_Ctrl| |Hydraulic: system control|

Table 7.62: “Hydraulic - Control word” parameters

# 7.11.6.1.2 Hydraulic status word

|Bit|Meaning|
|---|---|
|0| |
|1| |
|2|Hydraulic control mode|
|3| |
|4|SetPointAcknowledge (Set if there is a rising edge at NewSetPoint and the setpoint is adopted; cleared if newSetPoint = 0)|
|5|SwitchLeakBypass (leakage bypass active)|
|6|SwitchCylOpt; Cylinder area (A1/A2)|
|7|CtrlLimited; Control limit reached|
|8|RampTargetReached; Ramp target reached|
|9|CylValvePos; Valve switch positive cylinder direction|
|10|CylValveNeg; Valve switch negative cylinder direction|
|11|ValveOpt1; Valve switch option 1|
|12|ValveOpt2; Valve switch option 2|
|13|InWindow; Setpoint window reached|
|14 - 15|unused|

Table 7.63: Hydraulic status word: What the bits mean, expand the table

MSD ServoDrive - DeviceHelp 192

# 7 Control

MOOG ID No.:CB40859-001 Date:11/2020

MSD ServoDrive - DeviceHelp 193

# 7.11.6.3 Hydraulic motion block table

The motion block table contains 16 motion blocks which can be parametrized (Index 0 to 15). The control mode, reference values and ramps as well as the valve positions and switching conditions can be specified in each motion block.

If the servo drive is to be used as a stand-alone device, it is possible to set up a type of sequence control using the motion block table. To activate the transition of the motion block via the motion block table, the operating mode Tab(2) must be selected in the motion profile P 2862[0] - HYD_OpMode. This allows switching between the motion blocks to be controlled by either timing or an event. This function is enabled in the Tab(2) operation mode.

As an option, it is also possible to use operation mode CTRL2 to switch the motion blocks via a higher-order control system. These can be configured in advance for different control tasks so that during the process only setpoints and the respective table index must be selected or specified by the control system.

# 7.11.6.2 Servo pump speed ramps

|ID|Index|Name|Unit|Description|
|---|---|---|---|---|
|2842|0|HYD_State| |Hydraulic: Status of the control functions|

# Table 7.64: “Hydraulic - Status word” parameters

|ID|Index|Name|Unit|Description|
|---|---|---|---|---|
|2855| |HYD_PumpAcc|rpm/s|Hydraulic: Acceleration of the pump speed|

# Table 7.65: “Hydraulic - Pump acceleration” parameters

|ID|Index|Name|Unit|Description|
|---|---|---|---|---|
|2856| |HYD_PumpDec|rpm/s|Hydraulic: Deceleration of the pump speed|

# Table 7.66: “Hydraulic - Pump deceleration” parameters

Image 7.66: “Hydraulic motion block table” screen

# Hydraulic Control Mode

Selecting the hydraulic control mode (Para 2860 HYD_TabConMode):

- PressCon(0) = pressure control
- VolConPlim(1) = volumetric flow rate control (pressure limited)
- SpeedCon(2) = speed control
- PosCon(3) = position control
- NPumpCon(4) = pump speed control
- VolCon(5) = volumetric flow rate control (without pressure control)

**Table 7.67: “Hydraulic - Control mode” parameters**
|ID|Index Name|Unit|Description|
|---|---|---|---|
|2860|HYD_ConMode| |(Hydraulic Control Mode)|
|2860|0...15 HYD_ConMode| |(Hydraulic Control Mode)|

# Hydraulic Setpoint

Setpoint for pressure, volumetric flow rate, cylinder speed, cylinder position. The unit (HYD_UNIT) depends on the control mode and corresponds to bar for pressure control, l/min for volumetric flow rate control and rpm for pump speed control. For cylinder position and speed control, the unit corresponds to the UserUnit selected in the scaling (chapter 8.2). This also applies for derivative 1 and 2 or speed and acceleration.

**Table 7.68: “Hydraulic - Reference value” parameters**
|ID|Index Name|Unit|Description|
|---|---|---|---|
|2857|HYD_Ref| |Hydraulic: Setpoint for volumetric flow rate/pressure/speed/position|
|2857|0..15 HYD_Ref|HYD_Unit|Hydraulic: Setpoint for volumetric flow rate/pressure/speed/position|

# 1st Reference Value Derivative

Rise time/speed of the setpoint

MOOG ID No.:CB40859-001 Date:11/2020

**Table 7.69: “Hydraulic - 1st setpoint derivative” parameters**
|ID|Index Name|Unit|Description|
|---|---|---|---|
|2858|HYD_dRef| |Hydraulic: 1st setpoint derivative|
|2858|0..15 HYD_dRef|HYD_UNIT/s|Hydraulic: 1st setpoint derivative|

# 2nd Setpoint Derivative

Setpoint acceleration (this parameter is not active for pressure and volumetric flow rate)

**Table 7.70: “Hydraulic - 2nd setpoint derivative” parameters**
|ID|Index Name|Unit|Description|
|---|---|---|---|
|2859|HYD_d2Ref| |Hydraulic: 2nd setpoint derivative|
|2859|0..15 HYD_d2Ref|HYD_UNIT/s/s|Hydraulic: 2nd setpoint derivative|

# Hydraulic Control Parameters Table

For the control of the valve position, switching of the position controller settings and of the pump data set as well as for enabling the active decompression, the respective bits can be enabled in this parameter for every motion block. The active decompression prevents that a motion block is started as long as pressure is still applied. If the bit is active, the pressure is reduced via a defined ramp (P 2850.11 decmpRate) below a specified pressure level (P 2850.10 decmpLvl) before the respective motion block is started.

**Table 7.71: Control parameters table**
|Bit|Designation|Meaning|
|---|---|---|
|0|ZylArea(A1/A2)|Switchover of the cylinder Area|
|1|Reserved| |
|2|POS|Extend the hydraulic valve cylinder|
|3|neg|Retract the hydraulic valve cylinder|
|4|Opt1|Valve option 1|

# Control

MOOG ID No.:CB40859-001 Date:11/2020

# MSD ServoDrive - DeviceHelp

Bit Designation Meaning Control mode Pressure limit Volumetric flow rate limit

|5|Opt2|Valve option 2|- SpdCon_nFF|
|---|---|---|---|
|6|PosCon2|Selection for second position-controller setting P 2871 HYD_PosConAdv2|PosCon(3)|
|7|Reserved| |- PosCon_QFF|
|8|PumpSet2|Selection for second pump data set P 2873 HYD_Pump2|- PosCon_nFF|
|9|Reserved| |- PosCon_pLimit|
|10|AktivDecomp|Active decompression for the respective motion block|- PosCon_TrackingError|
|11|Reserved| | |
|12|PressCon2|Selection for second pressure-controller setting P 2874 HYD_PressCon2| |

# Table 7.71: Control parameters table (continue)

|ID|Index Name|Unit|Description|
|---|---|---|---|
|2872|HYD_TabLimit| |Hydraulic volume/pressure/speed limit|
|2863|HYD_TabCtrl| |Hydraulic Table control word|

# Table 7.72: Parameter “Hydraulic table control word”

Scaling of the hydraulic limits

Using the scaling parameter Hyd_Limit (P 2872) allows the respective currently active limit to be scaled for each motion block. This makes it possible to limit each individual process. The scaling is switched over dynamically with the respective control mode that is set. The following table shows for which control modes the scaling function is implemented.

|Control mode|Pressure limit|Volumetric flow rate limit|
|---|---|---|
|NPumpCon(4)| | |
|PressCon(0)|x| |
|VolCon(5)| | |
|VolConPlim(1)|x| |
|SpdCon(2)| | |
|- SpdCon_QFF| | |
|- SpdCon_pLimit|x| |

# Table 7.73: Hydraulic Limitations-

# Table 7.74: Parameter “Hydraulic - Limitations table"

# Table 7.75: Parameter “Hydraulic table delay time”

Wait time in Auto mode

After expiration of the waiting time, there is a branch to the motion block specified in the “subsequent motion block Time Ctrl” (2865 HYD_TabNextIdx). The respective motion block is only active for the duration of the waiting time, regardless of whether or not the target has been reached.

|ID|Index Name|Unit|Description|
|---|---|---|---|
|2864|HYD_TabWaitTime| |Hydraulic table delay time|

Subsequent motion block Time Ctrl

The motion block index provided here becomes active after expiration of the waiting time. (0 ms = No timed transition switching)

|ID|Index Name|Unit|Description|
|---|---|---|---|
|2865|HYD_TabNextIdx| |Hydraulic table next default index|

Table 7.76: Parameter “Hydraulic table next default index”

Subsequent motion block Event Ctrl

If the transition switching condition P 2867 - Hyd_TabCondType is true, a switchover is made to the motion block specified here.

|ID|Index Name|Unit|Description|
|---|---|---|---|
|2866|HYD_TabAltIdx| |Hydraulic table next alternative index|

Table 7.77: Parameter “Hydraulic table next alternative index”

NOTE

If a subsequent motion block and an alternative motion block are entered, the branch always leads to the motion block for which the condition is met first.

Switching condition

There are two different modes to choose from for the transition switching to the next motion block.

|ID|Index Name|Unit|Description|
|---|---|---|---|
|2867|HYD_TabCondType| |Hydraulic table state|

Table 7.78: Parameter “Hydraulic table state”

Optional comparison value

Comparison value for the transition switching condition (ConAddr)

|ID|Index Name|Unit|Description|
|---|---|---|---|
|2868|HYD_TabCondVal| |Hydraulic table comparison state|

Table 7.79: Parameter “Hydraulic table comparison state”

# 7.11.7 Pressure control

The pressure is controlled by a PI pressure controller using P 2850 - HYD_PressCon based on the pressure setpoint. Here you can choose between two controller structures using P 2840 [16] AltPressCon. The selection PressCon_nPump(0) outputs a pump speed at the output of the controller which is directly forwarded to the speed controller (see Image 7.67: Mask of pressure control with pump speed output). The selection PressCon_VolFlow(2) has a volumetric flow rate output in l/min and an underlying volume flow control which takes the displacement volume of the pump into account (see Image 7.68: Mask of pressure control with volumetric flow rate output.). This can be helpful for pumps with a variable displacement volume, as this means the control circuit gain remains unchanged and the controller parameters do not need to be adjusted. If during operation of the pressure control one of the specified limit values P 2850 [7] - Qmin or P 2850 [8] - Qmax is reached due to the pump speed, the actuating variable (motor speed) is limited accordingly. Moreover, the configured speed limits (P 2851.5 nMin, P2851.6 nMax) for the pump always take priority. In addition, it is possible to set the minimum and maximum system pressure via a pressure limitation. To take into account the different area ratio of a differential cylinder, the actual pressure values can be scaled to the respective area ratio using UnitScale_pAct and UnitScale_pAct2 (P 2850.12 pActScale, P 2850.13 pAct2Scale). For control systems with high dynamic performance, it may be necessary to take into account a pressure-dependent compressibility in the control system. This compressibility will decrease as the pressure increases, i.e. less fluid needs to be

# 7 Control

MOOG ID No.:CB40859-001 Date:11/2020

MSD ServoDrive - DeviceHelp 197

Pumped for the same pressure change. Accordingly, the pressure controller’s gain needs to be reduced at higher pressures in order to maintain a constant pressure control circuit dynamic performance. Because of this, pressure-dependent controller gain scaling has also been incorporated. This scaling can be configured with a characteristic curve (P 2853 - HYD_PressConScale).

The pressure controller settings were duplicated in P 2874 HYD_PressCon2. With this it is possible to select a different controller setting for a selected table motion block. The second controller data set can be selected in the table motion block using P 2863 HYD_TabCtr bit 12.

In order to provide feedback to a higher-order control system, a setpoint window for “Pressure reached” (Para 2850.9 - PressWindow) can be specified. If the actual value is within this window, the bit “InWindow” (bit 13) is set in the status word (see also section "Hydraulic Motion profile" on page 190).

Furthermore, a second KpScale P 2879[0] PressCon1_KpScalePDO, P 2879[1] PressCon2_KpScalePDO has been introduced for operation via one controller and it can be written cyclically via the PDO channel. It should be noted here that both factors act one after the other and influence each other.

Image 7.67: Mask of pressure control with pump speed output

Image 7.68: Mask of pressure control with volumetric flow rate output.

|Designation|Description|Parameters|Index|
|---|---|---|---|
|pRef|Pressure reference value pRef|2847|2|
| |Pressure actual value pAct|2847|0|
|pressAct|Pressure actual value pAct2|2847|1|
| |One of the two values, selectable using P|2847|0|
| |2840[3] Pressure difference= pAct - pAct2|2847|1|
| |Max. volumetric flow rate limit QMax| |8|
|Qmax|Max. volumetric flow rate setpoint QRef|2850|3|
| |One of the two values, selectable with|2847| |
| |P 2840[6, 7]| | |
| |Min. volumetric flow rate limit QMin| | |
|Qmin|Min. volumetric flow rate setpoint QRef|2850|7|
| |One of the two values, selectable with|2847|3|
| |P 2840[6, 7]| | |
|Kp, τn|PI(D) pressure controller (derivative term not implemented at the time of writing)|2850|0-4|
|nRefPump|Pump speed setpoint|2843|9|
|nmin|Speed limit pressure control|2851|5|
|nmax| |2851|6|
|nRefMot|Motor speed setpoint|2843|12|
|PressWindow|Pressure window “Pressure reached”|2850|9|

# Legend for “Structure of pressure control”

|ID|Index|Name|Unit|Description|
|---|---|---|---|---|
|2850| |HYD_PressCon| |Hydraulic pressure control parameters|
|2850|0|Kp|rpm/bar|Gain|
|2850|1|KpScale| |Gain scaling|
|2850|2|Tn|ms|Gain scaling|
|2850|3|Tv|ms|Integration time constant|
|2850|4|Tp|ms|Integral-action time|

# Table 7.80: “Hydraulic - pressure control” parameters

|ID|Index|Name|Unit|Description|
|---|---|---|---|---|
|2850|5|pMin|bar|Minimum permissible pressure|
|2850|6|pMax|bar|Maximum permissible pressure|
|2850|7|QMin|l/min|Minimum flow rate|
|2850|8|QMax|l/min|Maximum flow rate|
|2850|9|PressWindow|bar|Pressure control parameters|
|2850|10|decmpLvl|bar|Level for active decompression|
|2850|11|decmpRate|bar/s|Rate for active decompression|
|2850|12|pActScale| |Scaling for pAct|
|2850|13|pAct2Scale| |Scaling for pAct2|
|2850|14|pRange_k|%|Pressure range threshold|
|2850|15|pRange_midpoint|bar|Pressure range midpoint|
|2853| |HYD_PressConScale| |Scaling of the properties of the pressure control gain|
|2853|0|pMin|bar|Minimum permissible pressure of the characteristic|
|2853|1|pMax|bar|Maximum permissible pressure of the characteristic|
|2853|2|Nval| |Number of interpolation points|
|2853|3|Type| |Interpolation type|
|2853|4|Table0|%|Scaling Table Value 0|
|2853|5|Table1|%|Scaling Table Value 1|
|2853|6|Table2|%|Scaling Table Value 2|
|2853|7|Table3|%|Scaling Table Value 3|
|2853|8|Table4|%|Scaling Table Value 4|
|2853|9|Table5|%|Scaling Table Value 5|

# Table 7.80: “Hydraulic - pressure control” parameters (continue)

# 7.11.8 Volumetric flow rate control

# 7.11.8.1 Volumetric flow rate control with pressure limitation

If the reference variable for the volumetric flow rate that needs to be set is QRefInput, the implemented volumetric flow rate control can be used. Generally, QRefInput can be converted to an equivalent motor setpoint speed nRefPump using the displacement volume and QLeak can be disregarded during the process.

MSD ServoDrive - DeviceHelp 198

# 7 Control

MOOG ID No.:CB40859-001 Date:11/2020

# MSD ServoDrive - DeviceHelp

If there are stricter requirements concerning the volumetric flow rate accuracy, QLeak must be taken into account as a function of pressure and nRefPump must be increased accordingly.

In addition, limiting the pressure upwards to a maximum pressure of pmax is usually a requirement. Moreover, a minimum pressure of pmin may also be required. An additional pressure limiting control system is set up for this purpose. If the configured pressure limits are reached, the motor speed will be dynamically limited upwards or downwards accordingly.

NOTE

- To do so, the pressure regulator must also be parametrized and set.

In addition to the pressure limitation, the minimum and maximum volumetric flow rate can be set via a volumetric flow rate limitation (see Section "Hydraulic Limitations" on page 184).

# Image 7.69: “Volumetric flow rate control” screen

|Designation|Description|Parameters|Index|
|---|---|---|---|
|Pressure actual value pAct| |2847|0|
|pAct|Pressure actual value pAct2|2847|1|
|One of the two values, selectable with P 2840[3]| | | |
|QRefInput|Volumetric flow rate setpoint QRef|2847|3|
|max. pressure limit pMax| |2850|6|
|pmax|max. pressure reference value pRef|2847|2|
|One of the two values, selectable with P 2840[4, 5]| | | |

# Legend for “Volumetric flow rate control”

# 7.11.8.3 Leakage compensation

|Designation|Description|Parameters|Index|
|---|---|---|---|
|pMin|Min. pressure limit|2850|5|
|pRef|Min. pressure reference value|2847|2|
|If there is a volumetric flow rate sensor available (this can also be determined based on a measured cylinder speed as an alternative), measured value Qmess can optionally be used for leakage compensation.|If there is a volumetric flow rate sensor available (this can also be determined based on a measured cylinder speed as an alternative), measured value Qmess can optionally be used for leakage compensation.|If there is a volumetric flow rate sensor available (this can also be determined based on a measured cylinder speed as an alternative), measured value Qmess can optionally be used for leakage compensation.|If there is a volumetric flow rate sensor available (this can also be determined based on a measured cylinder speed as an alternative), measured value Qmess can optionally be used for leakage compensation.|
|PI(D)|pressure controller (derivative term not implemented at the time of writing)|2850|0-4|
|In this case, volumetric flow rate control with steady-state accuracy will be achieved.|In this case, volumetric flow rate control with steady-state accuracy will be achieved.|In this case, volumetric flow rate control with steady-state accuracy will be achieved.|In this case, volumetric flow rate control with steady-state accuracy will be achieved.|
|n*|Comment: Motor speed setpoint (gearing!):|2843|9|
|nmin|Speed limit pressure control|2851|5|
|nmax| |2851|6|
|nActPump|Comment: Actual motor speed (gearing!):|2843|12|
|QL,calc|Calculated leakage volumetric flow rate|2843|6|
|QCalc|Q,calc 0 Calculated volumetric flow rate|2843|5|
|Qth|Theoretical volumetric flow rate|2843|14|
|QLeak|Leakage volumetric flow rate| | |

# Legend for “Volumetric flow rate control” (continue)

# 7.11.8.2 Volumetric flow rate control without pressure limitation

If there is no need for a pressure limitation, a volumetric flow rate control without pressure limitation (VolCon(5) = volumetric flow rate control (without pressure limitation)) can be selected in P 2860 - HYD_TabConMode. This provides the same functions but is not linked to the pressure control. Moreover, the pressure regulator does not need to be parametrized for this control mode.

MOOG ID No.:CB40859-001 Date:11/2020

MSD ServoDrive - DeviceHelp 200

# 7 Control

# 7 Control

MOOG                          ID No.:CB40859-001 Date:11/2020

# MSD ServoDrive   - DeviceHelp      201

| | |ID|Index Name|Unit|Description| |
|---|---|---|---|---|---|---|
| | |2850|4|Tp|ms|Integral-action time|
| | |2850|5|pMin|bar|Minimum permissible pressure|
| | |2850|6|pMax|bar|Maximum permissible pressure|
| | |2850|7|QMin|l/min|Minimum flow rate|
| | |2850|8|QMax|l/min|Maximum flow rate|
| | |2850|9|PressWindow|bar|Pressure control parameters|
| | |2850|10|decmpLvl|bar|Level for active decompression|
| | |2850|11|decmpRate|bar/s|Rate for active decompression|
| | |2850|12|pActScale| |Scaling for pAct|
| | |2850|13|pAct2Scale| |Scaling for pAct2|
| | |2850|14|pRange_k|%|Pressure range threshold|
| | |2850|15|pRange_midpoint|bar|Pressure range midpoint|

Table 7.82:   “Hydraulic - Volumetric flow rate” parameters (continue)

# 7.11.9 Speed control

The speed of a hydraulic cylinder can be influenced directly with the controlled volumetric flow rate that is flowing in. The cylinder speed can be determined by means of a linear position sensor which is coupled to the cylinder. The values from the cylinder model and the cylinder speed allow the steady-state volumetric flow rate to be set with precision. (P 2840.13 - AltSpdCon = 0)

| | | | | |ID|Index Name|Unit|Description|
|---|---|---|---|---|---|---|---|---|
|2849| |HYD_Lfe| |Leakage flow estimate| | | | |
|2849|0|lfe_Qmin|l/min|Leakage flow estimate: minimum value| | | | |
|2849|1|lfe_Qmax|l/min|Leakage flow estimate: maximum value| | | | |
|2849|2|lfe_K|1/ms|Leakage flow estimate: gain| | | | |
|2849|3|lfe_Tn|ms|Leakage flow estimate: integration time constant| | | | |
|2850| |HYD_PressCon| |Hydraulic pressure control parameters| | | | |
|2850|0|Kp|rpm/bar|Gain| | | | |
|2850|1|KpScale| |Gain scaling| | | | |
|2850|2|Tn|ms|Integration time constant| | | | |
|2850|3|Tv|ms|Differential time constant| | | | |

Table 7.82:   “Hydraulic - Volumetric flow rate” parameters

Within this context, it is important to take into account that the sign will be reversed in the relationship between the volumetric flow rate and the speed and that, due to the different piston/annulus area, the relationship will change as well. The actuation of a changeover valve, as well as its consideration for the cylinder positioning, are part of the hydraulic package.

The prerequisite for speed control is that the volumetric flow rate control and the leakage compensation be set and parametrized. The SpeedCon(2) control mode must be selected to allow activation of the speed control mode. In addition, the cylinder geometries (P 2852[0] -cylArea1, P 2852[2] - cylArea2) must be known and set accordingly.

To provide speed control with pressure limitation, a special mode with a downstream pressure regulator has been implemented. In this case, the pressure limitation as well as the scaling of the pressure limitation are in effect for the individual motion blocks (P 2840.13 - AltSpdCon = 1). The prerequisite for cylinder speed control with active pressure limitation is that the pressure control be properly adjusted.

For cylinder speed control, there is a choice of two further control structures. These two alternative control types are described below. A further option is to control the cylinder speed directly via a PI controller (P 2840.13 AltSpdCon = 2). In this case, the speed is not calculated using the cylinder model and the displacement volume with feed-forward control, but is governed strictly by the PI controller. In order to take the different cylinder volumes for the ring and piston sides of the cylinder into account, two scaling factors.

MOOG ID No.:CB40859-001 Date:11/2020

MSD ServoDrive - DeviceHelp

7 Control

# Control

# MOOG

ID No.: CB40859-001 Date: 11/2020

# MSD ServoDrive - DeviceHelp 203

(P 2852.10 KpScale, P 2852.11 KpScaleNeg) for the positive and negative cylinder directions can be used to influence the gain of the controller. KpScaleNeg becomes active with the bit for the negative cylinder volume (P 2863 Hyd_TabCtrl Bit 0).

# NOTE

In this control mode, the volumetric flow rate and pressure limitation are not active.

| | | | |ID|Index Name| |Unit|Description|
|---|---|---|---|---|---|---|---|---|
| | | | |2850|2|Tn|ms|Integration time constant|
| | | | |2850|3|Tv|ms|Differential time constant|
| | | | |2850|4|Tp|ms|Integral-action time|
| | | | |2850|5|pMin|bar|Minimum permissible pressure|
| | | | |2850|6|pMax|bar|Maximum permissible pressure|
| | | | |2850|7|QMin|l/min|Minimum flow rate|
| | | | |2850|8|QMax|l/min|Maximum flow rate|
| | | | |2850|9|PressWindow|bar|Pressure control parameters|
| | | | |2850|10|decmpLvl|bar|Level for active decompression|
| | | | |2850|11|decmpRate|bar/s|Rate for active decompression|
| | | | |2850|12|pActScale| |Scaling for pAct|
| | | | |2850|13|pAct2Scale| |Scaling for pAct2|
| | | | |2850|14|pRange_k|%|Pressure range threshold|
| | | | |2850|15|pRange_midpoint|bar|Pressure range midpoint|
| | | | |2852| |HYD_SpdCon| |Speed Controller Parameters|
| | | | |2852|0|cylArea1|cm^2|Speed control parameter|
| | | | |2852|1|lfe_K_scale| |Leakage Flow Estimator: Gain scaling|
| | | | |2852|2|cylArea2|cm^2|Cylinder displacement (option 2, use neg. value for neg. direction)|
| | | | |2852|3|lfe_K_scale2| |Leakage Flow Estimator: Gain scaling (option 2)|
| | | | |2852|4|res| |Reserved|
| | | | |2852|5|res| |Reserved|
| | | | |2852|6|res| |Reserved|
| | | | |2852|7|unit_scale|um/rev|Hydraulic physical unit scaling|
| | | | |2852|8|Kp|1/min|Speed control integration time constant|
|2849|HYD_Lfe| |Leakage flow estimation| | | | | |
|2849|0|lfe_Qmin|l/min|Leakage Flow Estimator: Min value| | | | |
|2849|1|lfe_Qmax|l/min|Leakage Flow Estimator: Max value| | | | |
|2849|2|lfe_K|1/ms|Leakage Flow Estimator: Gain| | | | |
|2849|3|lfe_Tn|ms|Leakage Flow Estimator: Integrator time constant| | | | |
|2850|HYD_PressCon| |Pressure control parameters| | | | | |
|2850|0|Kp|rpm/bar|Gain| | | | |
|2850|1|KpScale| |Gain scaling| | | | |

# Table 7.83: “Hydraulic - Speed control” parameters

# 7.11.10 Position control

Position control with volumetric flow feed forward control:

The position of a hydraulic cylinder can be influenced directly with the controlled volumetric flow rate. If a position sensor is mounted on the cylinder, it can be used to determine the exact position of the cylinder. The position is preset roughly by means of a volumetric flow control. The feed-forward control variable is calculated in the hydraulic motion profile using the cylinder model and the displacement volume of the pump. Alternatively, the feed-forward control variable can also be specified in mm/s via a higher-level control system P 2881[0] HYD_AddValues. For this, selector P 2880[0] PosCon_RefSpdFF must be switched to "(1) from EXTERNAL". For better optimization and analysis, the feed forward control value can be viewed in P 2843[30] RefSpdFF as the actual value or can be recorded in the scope. The scaling factor of the feed-forward control variable P2842[2] SFF remains active. The remaining control difference can then be stabilized accurately using a steady-state PI controller.

If, in the case of double-acting cylinders, positioning is to be performed in both the positive and negative directions, the simplest application will require at least one changeover valve. Care must be taken to ensure that the force direction and valve position are compatible because otherwise an inadmissibly high volumetric flow rate and pressure will be generated by the position controller due to the unchanged control deviation. The actuating valves can be controlled in different modes (see Section "Hydraulic Motion profile" on page 190). Moreover, the volumetric flow rate control must be parametrized and the cylinder geometries must be configured.

# Position control with pressure limitation:

If it is necessary to limit the maximum permissible pressure during the positioning operation, the control structure can be expanded to include a higher-order pressure regulator (P 2840.12 - AltPosCon = PosCon_pLimit(2)). The control structure of the pressure limiting controller differs from that of the standard pressure controller, but the same parameters are used for gain and integral-action time. The structure does not allow the controller to be operated without the integrating part. Consequently, it makes sense to work with a gain factor that is not too high so as to avoid exciting the control circuit. If the pressure needs to be restricted for a certain positioning operation, a partial process or an individual motion block, a scaling factor P 2872 - HYD_TabLimit can be used to adapt the pressure limitation for each motion block.

NOTE

- To simplify the control circuit, the I component (P 2848[1] - Tn) of the controller must be set to 10000 ms and thereby has no influence on the control. The position control can thus be operated by means of feed forward control and P controller.

MOOG ID No.:CB40859-001 Date:11/2020 MSD ServoDrive - DeviceHelp 204

# 7 Control

MOOG ID No.:CB40859-001 Date:11/2020

MSD ServoDrive - DeviceHelp 205

# Image 7.75: “Hydraulic - position control” screen PosCon_pLimit(2)

# Image 7.76: “Hydraulic - position control” screen PosCon(1)

# Position control without volumetric flow control:

If the cylinder geometry is unknown, then no feed-forward control value can be calculated for the volumetric feed-forward control. In this case, a PI controller and a constant speed feed-forward control can be used to represent the position control (P 2840.12 AltPosCon = PosCon_nFF(1)). However, the different surfaces of the cylinder geometry must be taken into account because the different volumes of the cylinder chambers cause different control paths. To do so, the control parameters of the position control must be adapted. The control can be designed to suit the different cylinder surface sizes using parameters P 2870.3 KpScale and P 2870.5 KpScaleNeg.

# Position control with tracking error switchover:

For special applications, the control parameters can be changed as a function of a tracking error limit. To do so, a switchover limit (P 2878.2 PosWindowP) must be configured in which the controller gain is influenced by means of a second scaling factor (P 2878.1 KpScale2). In addition, the I-component can also be influenced by means of a scaling factor which becomes active as of a certain switchover limit. The feed forward control as well as the pressure limitation continue to remain active for this control structure.

# 7 Control

PosHysLo, P 2870.7 PosHysUp). The position controller then positions into the position window but only corrects the position again after a departure from the set hysteresis range.

Image 7.77: Hydraulic - “position control" PosCon_TrackingError(3))

Image 7.78: Position tracking error and position window

# Position monitoring:

A tracking error can be set to monitor the positioning operation. If this tracking error is exceeded due to an increased load or an error in the system, the controller switches off and reports an error reaction. Moreover, continuous readjustment of the position can be prevented by defining a position window (P 2870.0 PosWindowLo, P 2870.1 PosWindowUp). When the actual position reaches this window, the motion is stopped and the cylinder is tensioned by switching off the directional valves. In addition, the “InWindow” bit is set in the status word to provide feedback concerning the completion of the positioning operation. It is important to bear in mind that the position window is turned in dependence on the direction of the positioning operation (see Image 7.79: Position window and position hysteresis). If no readjustment of the position is desired, it is also possible to define a hysteresis in addition to the position window (P 2870.6).

Image 7.79: Position window and position hysteresis

MOOG ID No.:CB40859-001 Date:11/2020

MSD ServoDrive - DeviceHelp 206

# 7 Control

MOOG ID No.:CB40859-001 Date:11/2020

# MSD ServoDrive - DeviceHelp

|ID|Index Name|Unit|Description| |
|---|---|---|---|---|
|2848|HYD_PosCon|Position Controller Parameters| | |
|2848|0|Kp|1/min|Gain of position controller|
|2848|1|Tn|ms|Position control integration time constant|
|2848|2|SFF|%|Speed feedforward scaling|
|2848|3|PosDiffMax|um|Position tracking error monitoring|

Table 7.84: “Hydraulic - position control” parameters

# 7.11.11 Digital filter Hydraulics

For special applications the hydraulics firmware has two biquad filters connected in series with different input and output variables. For example, acceleration can be fed back to the position controller.

Image 7.80: Digital Filter Hydraulics Screen

Via P 2876 HYD_AdvFilSel the filter can be activated and the input and output sizes can be selected.

The actual pressure value P 2843.1 pressAct in bar or the cylinder speed P 2843.23 ActSpd in rpm (Cyl_nAct(2)) or in mm/s (Cyl_ActSpd(3)) are available as input variables.

An additive speed setpoint (nFF(1)) or volume flow rate setpoint (volFF(2)) can be selected at the filter output. The speed reference value is connected to the output of the pressure control and the cylinder speed control. Selecting volFF(2) acts at the output of the pressure control with volumetric flow rate output and the subordinate.

# 7 Control

volumetric flow rate control of the position controller. In addition, the filter can be switched active or inactive for every control type via 6 bits in parameter P 2884 HYD_AdvFilCtrl (filter output is active if respective bit=1).

**Table 7.85: Advanced filter settings**
|ID|Index Name|Unit|Description|
|---|---|---|---|
|2877|HYD_AdvFilCoeff| |Advanced Filter Coefficients (electronic damping)|
|2877|0| |BiQuad filter 1: a1 Hydraulic advanced filter coefficient: filter 1, a1|
|2877|1| |BiQuad filter 1: a2 Hydraulic advanced filter coefficient: filter 1, a2|
|2877|2| |BiQuad filter 1: b0 Hydraulic advanced filter coefficient: filter 1, b0|
|2877|3| |BiQuad filter 1: b1 Hydraulic advanced filter coefficient: filter 1, b1|
|2877|4| |BiQuad filter 1: b2 Hydraulic advanced filter coefficient: filter 1, b2|
|2877|5| |BiQuad filter 1: c0 Hydraulic advanced filter coefficient: filter 1, c0|
|2877|6| |BiQuad filter 2: a1 Hydraulic advanced filter coefficient: filter 2, a1|
|2877|7| |BiQuad filter 2: a2 Hydraulic advanced filter coefficient: filter 2, a2|
|2877|8| |BiQuad filter 2: b0 Hydraulic advanced filter coefficient: filter 2, b0|
|2877|9| |BiQuad filter 2: b1 Hydraulic advanced filter coefficient: filter 2, b1|
|2877|10| |BiQuad filter 2: b2 Hydraulic advanced filter coefficient: filter 2, b2|
|2877|11| |BiQuad filter 2: c0 Hydraulic advanced filter coefficient: filter 2, c0|

The coefficients a1 to b2 can be calculated using a mathematical software tool or a coefficient calculator. The coefficients c0 serve as gain factors at the output of the respective filter. To evaluate the quality of the filter, two scope variables are available for input and output variables (P 2843.24 AdvFilterOut, P 2843.31 AdvFilterIn).

# 7.11.12 Example: Pressure and pump speed control

This example shows which parameter settings need to be configured in order to operate a servo pump with pressure and pump speed control. Before configuring the parameters for the hydraulic system, the settings for the motor and encoder need to be configured first. After this, “Torque control/Hydraulic control” must be selected as the control mode and the selection of the reference setpoint must be set to “Hydraulic profile” in the hydraulic basic settings.

**Table 7.86: Parameter P 2876 HYD_AdvFilSel**
|ID|Index Name|Unit|Description|
|---|---|---|---|
|2876|HYD_AdvFilSel| |Advanced Filter Selection|
|2876|0| |Type Hydraulic advanced filter: type (0=off), (electronic damping)|
|2876|1| |Source (input filter 1) Selector of input to filter 1|
| | | |OFF (0) = no effect on control|
| | | |PressAct (1) = actual pressure value in bar|
| | | |cyl_nACT (2) = cylinder speed in rpm|
| | | |CylSpeedAct (3) = cylinder speed in mm/s|
|2876|2| |Sink (output filter 2) Selector to output from filter 2|
| | | |OFF (0) = no effect on control|
| | | |nFF (1) = Additive speed setpoint in rpm|
| | | |VolFF (2) = Additive volumetric flow rate setpoint in rpm|

MOOG ID No.:CB40859-001 Date:11/2020 MSD ServoDrive - DeviceHelp 208

# 7 Control

MOOG ID No.:CB40859-001 Date:11/2020

MSD ServoDrive - DeviceHelp 209

# Image 7.81: “Hydraulic basic settings” screen

|ID|Index|Name|Value|Unit|Description|Type|PDO|
|---|---|---|---|---|---|---|---|
|300|0|CON_CfgCon|TCON (1)| |Select control mode|uint16|x|
|159|0|MPRO_CTRL_SEL|DS402 (5)| |Motion profile: selection|uint16|x|
|165|0|MPRO_REF_SEL|HYDRAULIC| |Motion profile: selection|uint16|x|

# Image 7.82: “Pump settings” screen

# Table 7.88: Settings for control mode and motion profile

|ID|Index|Name|Value|Unit|Description|Type|PDO|
|---|---|---|---|---|---|---|---|
|2851| |HYD_Pump| | |Pump parameters| | |
|2851|0|displ|5.4|ccm/rev|Offset|float32| |
|2851|1|cTorque|0.0859437|Nm/bar|Torque constant|float32| |
|2851|2|pNom|250|bar|Nominal pressure|float32| |
|2851|3|nNom|1500|rpm|Rated speed|float32| |
|2851|4|etaVol|80|%|Volumetric efficiency at nominal pressure, rated speed|float32| |
|2851|5|nMin|0|rpm|Minimum speed|float32| |
|2851|6|nMax|2000|rpm|Maximum speed|float32| |
|2851|7|nCritical|200|rpm|Critical speed (@ nominal pressure)|float32| |
|2851|8|TCritical|10|s|Max. permissible time at low|float32| |

# Table 7.89: Pump data settings

# Table 7.90: analog inputs settings

|ID|Index|Name|Value|Unit|Description|Type|PDO|
|---|---|---|---|---|---|---|---|
|2851|9|iGearPump|-1| |Gear ratio between pump and motor|float32| |
|2851|10|p0|20|bar|Max. permissible stationary pressure at a standstill|float32|ISA01|
|2851|11|cLeakage| |(l/min)/bar|Leakage constant|float32| |
|2851|12|stopramp| |(1/min)/s|Stop ramp (during valve switching etc.)|float32| |
|2851|13|tSwValve| |ms|Valve switching time|float32| |
|2851|14|pMin| |bar|Minimum pressure (depending on pump protection function)|float32| |
|2851|15|pMax| |bar|Maximum pressure (depending on pump protection function)|float32| |

In this example, the actual pressure values will be evaluated using analog inputs ISA00 and ISA01.

# Image 7.83: “Standard analog inputs” screen

# Image 7.84: Signal settings screen

MOOG ID No.:CB40859-001 Date:11/2020

MSD ServoDrive - DeviceHelp 210

# 7 Control

# 7 Control

MOOG                          ID No.:CB40859-001 Date:11/2020                                                                                         MSD ServoDrive   - DeviceHelp      211

|ID|Index Name|Value|Unit|Description|Type|PDO|
|---|---|---|---|---|---|---|
|2840|HYD_Cfg| | |Configure Hydraulic System Control| | |
|2850|HYD_PressCon|Hydraulics: Pressure regulation| | | | |
|1|pRefSrc|PROFILE (1)| |Hydraulics: Selection of pressure reference source|uint16| |
|3|pActCalc|PACTSEL (5)| |Hydraulic: Pressure actual value calculation method|uint16| |
|4|pMinSrc|PressCon (0)| |Minimum pressure source selector|uint16| |
|5|pMaxSrc|PressCon (0)| |Maximum pressure source selector|uint16| |
|6|QMinSrc|PressCon (0)| |Minimum flow rate source selector|uint16| |
|7|QMaxSrc|PressCon (0)| |Maximum flow rate source selector|uint16| |
|8|QActCalc|NONE (0)| |Flow rate calculation method|uint16| |
|9|QLeakEst|MEAS (0)| |Flow rate leakage estimation method| | |
|10|nRefSrc|PROFILE (1)| |Pump speed reference source|uint16| |

Table 7.91: Selectors settings

Table 7.92: Dynamism and limitation settings

The “Signal configuration” area is used to scale and limit the input variables for the selector from P 2845 - HYD_Input_Val again by using P 2846 - HYD_Input_Adapt. The results can be seen in P 2847 - HYD_Val.

The control dynamic performance and the pressure and volumetric flow rate limits for the pressure control are configured in P 2850 - HYD_PressCon.

Image 7.85: “Pressure control” screen

# Table 7.93: Scaling settings (continue)

|ID|Index Name|Value|Unit|Description|Type|PDO|
|---|---|---|---|---|---|---|
|8|pRef_Scale|1|bar|Scaling|float32| |
|9|pRef_Offset|0|bar|Offset|float32| |
|10|pRef_Min|-100|bar|Min|float32| |
|11|pRef_Max|100|bar|Max|float32| |
|20|nRef_Scale|1|1/min|Scaling|float32| |
|21|nRef_Offset|0|1/min|Offset|float32| |
|22|nRef_Min|-500|1/min|Min|float32| |
|23|nRef_Max|500|1/min|Max|float32| |

The hydraulic motion profile settings are configured using the motion block table. In this example, table index 0 is used for pressure control and table index 1 for pump speed control. The index is changed with the control word. To do this, the table operating mode must be set to CTRL2. “Tab(2) = valve control via motion block table” was selected for the valve control. This means that the valve position must be specified in advance for the respective table motion block.

# Image 7.86: “Signal settings” screen

|ID|Index Name|Value|Unit|Description|Type|PDO|
|---|---|---|---|---|---|---|
|2846|HYD_Input_Adapt| | |Adaption of input values| | |
|0|pAct_Scale|1000|bar|Scaling|float32| |
|1|pAct_Offset|0|bar|Offset|float32| |
|2|pAct_Min|-500|bar|Min|float32| |
|3|pAct_Max|500|bar|Max|float32| |
|4|pAct2_Scale|1000|bar|Scaling|float32| |
|5|pAct2_Offset|-5.9|bar|Offset|float32| |
|6|pAct2_Min|0|bar|Min|float32| |
|7|pAct2_Max|500|bar|Max|float32| |

MOOG ID No.:CB40859-001 Date:11/2020

MSD ServoDrive - DeviceHelp 212

# 7 Control

MOOG ID No.:CB40859-001 Date:11/2020

# MSD ServoDrive - DeviceHelp

| |ID|Index|Name|Value|Unit|Description|Type|PDO|
|---|---|---|---|---|---|---|---|---|
| |2841|0|HYD_Ctrl|0000000000100000b|Hydraulic: system control|uint16|x| |
| |2842|0|HYD_State|0000000000000000b|Hydraulic: Status of the control functions|uint16|x| |

Table 7.95: Control and status Word

Reference values, ramp and valve settings can now be made in the motion block table.

Image 7.87: “Hydraulic Motion profile” screen

Image 7.88: “Motion block table” screen

|ID|Index|Name|Value|Unit|Description|Type|PDO|
|---|---|---|---|---|---|---|---|
|2862|0|HYD_OpMode|CTRL2|Hydraulics: Operation mode|uint8| | |

Table 7.94: Operation mode setting

Motion block 0 is enabled immediately after starting the controller. The various motion blocks can now be selected via bit 0 to bit 4 of the hydraulic control word.

# Table 7.96: Table index 0 settings

|ID|Index Name| |Value|Unit|Description|Type|PDO|
|---|---|---|---|---|---|---|---|
|2854|0|HYD_PumpRef|0|rpm|Hydraulic pump speed reference|float32|x|
|2855|0|HYD_PumpAcc|0|rpm/s|Hydraulic: Acceleration of the pump speed|float32|x|
|2856|0|HYD_PumpDec|0|rpm/s|Hydraulic: Deceleration of the pump speed|float32|x|
|2857|0|HYD_Ref|15|HYD_UNIT|Hydraulic: Setpoint for volumetric flow rate/pressure/speed/position|float32|x|
|2858|0|HYD_dRef|15|HYD_UNIT/s|Hydraulic: 1st setpoint derivative|float32|x|
|2859|0|HYD_d2Ref|0|HYD_UNIT/s/s|Hydraulic: 2nd setpoint derivative|float32|x|
|2860|0|HYD_ConMode|PRESS| |(Hydraulic Control Mode)|uint8|x|

# Table 7.97: Einstellung Tabellenindex 1

|ID|Index Name|Value|Unit|Description| | | | | | | | | | |
|---|---|---|---|---|---|---|---|---|---|---|---|---|---|---|
|2854| | | | | | | |1|HYD_PumpRef|0|rpm|Hydraulic pump speed reference|float32|x|
|2855|1|HYD_PumpAcc|0|rpm/s|Hydraulic: Acceleration of the pump speed|float32|x| | | | | | | |
|2856|1|HYD_PumpDec|0|rpm/s|Hydraulic: Deceleration of the pump speed|float32|x| | | | | | | |
|2857| |1|HYD_Ref|15|HYD_UNIT|Hydraulics: Setpoint for volumetric flow rate|float32|x| | | | | | |
|2858| |1|HYD_dRef|15|HYD_UNIT/s|Hydraulic: 1st setpoint derivative|float32|x| | | | | | |
|2859|1|HYD_d2Ref|0|HYD_UNIT/s/s|Hydraulic: 2nd setpoint derivative|float32|x| | | | | | | |
|2860|1|HYD_ConMode|PUMP_SPEED| |(Hydraulic Control Mode)|uint8|x| | | | | | | |

# 7.11.13 Example: Hydraulic position control

The next step is for the pump specifications – as found on the rating plate or data sheet – to be entered in P 2851 - HYD_Pump. This is also where the minimum and maximum speed limits for the pump, the pump displacement volume and the gear ratio between the motor and the pump are set. This example shows which parameters must be set in order to control the position and speed of a hydraulic cylinder with a linear encoder. The motor and encoder must be parametrised before the hydraulic control settings can be made.

MOOG ID No.:CB40859-001 Date:11/2020

MSD ServoDrive - DeviceHelp 214

# 7 Control

MOOG                          ID No.:CB40859-001 Date:11/2020

MSD ServoDrive   - DeviceHelp      215

|ID|Index Name|Value|Unit|Description| | |
|---|---|---|---|---|---|---|
| |2851|8|TCritical|10|s|Max. permissible time at low speed and nominal pressure|
| |2851|9|iGearPump|-1| |Gear ratio between pump and motor|
| |2851|10|p0|20|bar|Max. permissible stationary pressure at a standstill|

Table 7.99:   Pump data settings (continue)

The position and speed actual values are evaluated via the encoder inputs for position and speed. In this example, an SSI linear encoder is used which must be set to CH1(1) = X7 (e.g. Sin/Cos, channel 1) via the function selector in the encoder screen.

# NOTE

- The encoder for commutation and torque control as well as speed control are used for the motor.
- The encoder for position control is used for cylinder-position and cylinder-speed control.

Image 7.90: “Pump settings” screen

| | | | | |ID|Index Name|Value|Unit|Description|
|---|---|---|---|---|---|---|---|---|---|
|2851| |HYD_Pump| | |Pump parameters| | | | |
|2851|0|displ|5.4|ccm/rev|Offset| | | | |
|2851|1|cTorque|0.0859437|Nm/bar|Torque constant| | | | |
|2851|2|pNom|250|bar|Nominal pressure| | | | |
|2851|3|nNom|1500|rpm|Rated speed| | | | |
|2851|4|etaVol|80|%|Volumetric efficiency at nominal pressure, rated speed| | | | |
|2851|5|nMin|0|rpm|Minimum speed| | | | |
|2851|6|nMax|2000|rpm|Maximum speed| | | | |
|2851|7|nCritical|200|rpm|Critical speed (@ nominal pressure)| | | | |

Table 7.99:   Pump data settings

# Image 7.92: Encoder configuration channel 1 (X7) screen

The settings for the SSI protocol can be made in the following parameters. The following must be specified here: the SingleTurn and MultiTurn bits, die encoding, and the minimum MultiTurn position.

|ID|Index|Name|Value|Unit|Description|
|---|---|---|---|---|---|
|543|0|ENC_CH1_MultiT|5| |Number of multi-turn bits (absolute encoder)|
|544|0|ENC_CH1_SingleT|19| |Number of single-turn bits (absolute encoder)|
|545|0|ENC_CH1_Code|GRAY| |Selection of the encoding of the SSI absolute encoder|
|546|0|ENC_CH1_Mode|0001h| |Mode selection: SSI absolute encoder|
|547|0|ENC_CH1_MTBase|-| |Minimum MultiTurn position (SSI absolute encoder)|
|548|0|ENC_CH1_MTEnable|1| |Channel 1: Multi-turn as single-turn|

# Table 7.100: SSI encoder settings

MOOG ID No.:CB40859-001 Date:11/2020

MSD ServoDrive - DeviceHelp 216

# 7 Control

# 7 Control

# MOOG

ID No.: CB40859-001 Date: 11/2020

# MSD ServoDrive - DeviceHelp

|ID|Index Name|Value|Unit|Description|
|---|---|---|---|---|
|598|0|ENC_CH1_Position|4909|Channel 1: Position|
|616|0|ENC_CH1_CycleCount|8|Channel 1: Position encoder sampling cycle (n x 125µs)|
|617|0|ENC_CH1_AbsInitMode|DIG|Channel 1: Mode of absolute value initialization|

# Table 7.100: SSI encoder settings (continue)

The scaling of the units is performed in the motion profile of the standard motor control. A scaling assistant is available for this purpose (“Scaling / Units” button).

Image 7.94: Volumetric flow rate control screen

NOTE

Image 7.93: “Motion profile” screen

The cylinder geometry must be configured for the CYL(1) mode (see also section "Cylinder configuration" on page 188).

Because a volumetric flow rate control underlies the position control, the following settings must be made beforehand.

The parameter P 2840[8] - QActCal can be used to select whether the volumetric flow rate value is to be taken from a sensor (MEAS(0) = From measurement) or, as in this example, determined by means of a calculation using the cylinder speed and the pump displacement volume (CYL(1) = From cylinder speed).

# Image 7.95: “Position control” screen

|ID|Index Name|Unit|Description|
|---|---|---|---|
|2848|HYD_PosCon| |Position Controller Parameters|
|2848|0|1/s|Gain of position controller|
|2848|1|ms|Position control integration time constant|
|2848|2|%|Speed feedforward scaling|
|2848|3|um|Position tracking error monitoring|

# Table 7.101: “Hydraulic - position control” parameters

# Image 7.96: “Hydraulic Motion profile” screen

The reference values are generated using the hydraulic motion profile. This configuration is set up using the motion block table. In this example, table index 0 is used for position control and table index 1 for speed control. The index is switched by means of the motion block table using a timer. To do so, the table operating mode P 2862 - HydOpMode must be set to "Tab(4) = via motion block table". “Tab(2) = valve control via motion block table” was selected for the valve control P 2840[11] - CylValueSwSel, meaning that the valve positions must be specified for the respective table index in the motion block table (P 2863 - Hyd_TabCtrl).

# Table 7.102: Operation mode setting

|ID|Index Name|Value|Unit|Description|
|---|---|---|---|---|
|2862|0|HYD_OpMode|TAB4|Hydraulics: Operation mode|
|2840|11|CylValveSwSel|TAB2|Function selector for the valve switchover of the cylinder|

Reference values, ramps, valve positions, the respective waiting time of the table index and the subsequent motion block can now be set in the motion block table.

MOOG ID No.:CB40859-001 Date:11/2020

MSD ServoDrive - DeviceHelp 218

# Control

# MOOG

ID No.: CB40859-001 Date: 11/2020

# MSD ServoDrive - DeviceHelp

|ID|Index Name|Unit|Description|
|---|---|---|---|
|2857|HYD_Ref| |Hydraulic: Setpoint for volumetric flow rate/pressure/speed/position|

Table 7.104: “Hydraulic - Reference value” parameters

# 1st reference value derivative

|ID|Index Name|Unit|Description|
|---|---|---|---|
|2858|HYD_dRef| |Hydraulic: 1st setpoint derivative|

Table 7.105: “Hydraulic - 1st setpoint derivative” parameters

# 2nd reference value derivative (jerk limitation or acceleration in the case of a position reference)

|ID|Index Name|Unit|Description|
|---|---|---|---|
|2859|HYD_d2Ref| |Hydraulic: 2nd setpoint derivative|

Table 7.106: “Hydraulic - 2nd setpoint derivative” parameters

# Hydraulic table control word valve position

|ID|Index Name|Unit|Description|
|---|---|---|---|
|2863|HYD_TabCtrl| |Hydraulic Table control word|

Table 7.107: Parameter “Hydraulic table control word”

# Selecting the hydraulic control mode:

- PressCon(0) = Pressure control
- VolConPlim(1) = Volume flow rate control (pressure limited)
- SpeedCon(2) = Speed control
- PosCon(3) = Position control
- NPumpCon(4) = Pump speed control
- VolCon(5) = Volume flow rate control (without pressure control)

|ID|Index Name|Unit|Description|
|---|---|---|---|
|2860|HYD_ConMode| |Hydraulics: Control Mode|

Table 7.103: “Hydraulic - Control mode” parameters

Reference value (Pressure, volume, cylinder speed, cylinder position)

# Hydraulic Wait time in Auto mode

|ID|Index Name|Unit|Description|
|---|---|---|---|
|2864|HYD_TabWaitTime| |Hydraulic table delay time|

Table 7.108: Parameter “Hydraulic table delay time”

# Hydraulic: Subsequent motion block

|ID|Index Name|Unit|Description|
|---|---|---|---|
|2865|HYD_TabNextIdx| |Hydraulic table next default index|

Table 7.109: Parameter “Hydraulic table next default index”

# Hydraulic: Alternative motion block

|ID|Index Name|Unit|Description|
|---|---|---|---|
|2866|HYD_TabAltIdx| |Hydraulic table next alternative index|

Table 7.110: Parameter “Hydraulic table next alternative index”

# Hydraulic: Switching condition

|ID|Index Name|Unit|Description|
|---|---|---|---|
|2867|HYD_TabCondType| |Hydraulic table state|

Table 7.111: Parameter “Hydraulic table state”

# Hydraulic: Optional comparison value

|ID|Index Name|Unit|Description|
|---|---|---|---|
|2868|HYD_TabCondVal| |Hydraulic table comparison state|

Table 7.112: Parameter “Hydraulic table comparison state”

MOOG ID No.:CB40859-001 Date:11/2020

MSD ServoDrive - DeviceHelp 220

# Chapter overview

# 8 Motion profile

# Contents

|8.1 Settings|222|
|---|---|
|8.2 Scaling / Units|223|
|8.3 Basic settings|241|
|8.4 Stop ramps|248|
|8.5 Homing|249|
|8.6 Jog mode|264|
|8.7 Reference table|265|
|8.8 Analog channel (ISA00 und ISA01)|270|
|8.9 State machine|273|
|8.10 Touch probe|275|
|8.11 Synchronized motion|276|
|8.12 Virtual Master|286|
|8.13 Common master|287|
|8.14 Cam group (CAM switch)|288|
|8.15 Data handling|288|

Brief description: This chapter describes the available motion profiles, as well as their basic and special settings.

Navigation: ►Project tree ►Device setup ►Motion profile

MOOG ID No.:CB40859-001 Date:11/2020

MSD ServoDrive - DeviceHelp 221

# 8 Motion profile

MOOG ID No.:CB40859-001 Date:11/2020 MSD ServoDrive - DeviceHelp 222

# 8.1 Settings

When it comes to the drive settings for motion profiles, the settings that need to be configured relate to the following: control, units, and commands.

# Scaling profile

- ① Standard/CiA 402
- SERCOS
- User defined

# Setting of control and reference value channel:

- l Control/Reference
- l Profile

# ②

- l Interpolation
- l Limitation
- l Reference filter
- l Smoothing

# Stop ramps / Reaction

- l to Shutdown
- l to Disable
- l to Halt

# ③

- l to Quick-stop
- l For error

Note: For control via an external PLC, BIT 4 must be set by P 155 - MPRO_DRVCOM_CFG if the drive is to adopt the error reaction (such as quick-stop). If this bit is not set, then the controller must assume the job of error handling!

# Image 8.1: Motion profile screen

Legend for “Motion profile” screen

# 8.2 Scaling / Units

- Homing method
- Speeds (cam/zero point search)
- Acceleration
- Offset
- Homing maximum distance

# Jog speeds

- Fast jog
- Slow jog

# Synchronized motion

- Master configuration
- Electronic gearing
- Electronic cam plate

# Details

Additional settings for closed-loop control and reference

Image 8.2: “Standardization profile selection” screen

# Legend for “Motion profile” screen (continue)

The wizard helps ensure that the application’s physical data will match the Servo Drive’s data. If you are using the "Standard / CiA 402" or "SERCOS" profile, the wizard will fully support the scaling definition process. If you use “custom” scaling instead, the wizard will close, as this type of configuration can only be set up directly in the parameter editor.

|ID|Index Name|Unit|Description|
|---|---|---|---|
|283|0|MPRO_FG_Type|Factor group: Type selection DS402(0), Sercos (1), USER(2)|

Table 8.1: Parameter ""

MOOG ID No.:CB40859-001 Date:11/2020

MSD ServoDrive - DeviceHelp 223

# 8 Motion profile

MOOG ID No.:CB40859-001 Date:11/2020

MSD ServoDrive - DeviceHelp 224

# 8.2.1 Standard/CiA 402

Image 8.3: “Standardization profile - Standard/CiA 402 - Units” screen

Image 8.4: “Standardization profile - Standard/CiA 402 - Direction of rotation” screen

NOTE

l The scaling is entered using exponent syntax. Referred to the motor, the positive direction is clockwise as seen when looking at the motor shaft (A-side bearing plate).

NOTE

l When using interpolating operation modes (CSV, CSP, CST) via fieldbus, scaling must be performed using the CiA 402 scaling assistant.

# Feed constant

The path travelled is proportionate to one motor revolution or, when using a gear unit, to the output-side revolution.

# Gear ratio (if available)

Ratio of one motor revolution before the gearing to the number of revolutions on the gear output side. The values for the gear ratio are entered in the screen as integer fractions.

# Position controller single-turn resolution

The single-turn resolution of the position controller can be adapted variably to the application. A total of 32 bits are available. In the default setting, 20 of the bits are used for the single-turn position.

# Image 8.5: “Standardization profile - Standard/CiA 402 - Feed/gearing/resolution/process format” screen

MOOG ID No.:CB40859-001 Date:11/2020 MSD ServoDrive - DeviceHelp 225

# 8 Motion profile

# 8 Motion profile

MOOG ID No.:CB40859-001 Date:11/2020

MSD ServoDrive - DeviceHelp 226

|ID| | | | |Index Name| |Unit|Description|
|---|---|---|---|---|---|---|---|---|
| | | | |2252| |MPRO_402_|608FH|DS402 position encoder resolution|
| | | | |2252|0|MPRO_402_|incr|Encoder increments|
| | | | |2252|1|MPRO_402_|rev|Motor revolution|
| | | | |2253| |MPRO_402_VelEncRes|6090H|DS402 velocity encoder resolution|
| | | | |2253|0|MPRO_402_VelEncRes|incr/s|Encoder increments/s|
| | | | |2253|1|MPRO_402_VelEncRes|rev/s|Motor revolution/s|
| | | | |2254| |MPRO_402_GearRatio|6091H|DS402 gear ratio|
| | | | |2254|0|MPRO_402_GearRatio|rev| |
| | | | |2254|1|MPRO_402_GearRatio|rev| |
| | | | |2255| |MPRO_402_|6092H|DS402 feed constant|
| | | | |2255|0|Feed|mDegree|Feed|
| | | | |2255|1|DriveShaftRev|rev|Drive train revolution|
| | | | |2256| |MPRO_402_PosFact|6093H|DS402 position factor|
| | | | |2256|0|MPRO_402_PosFact|incr| |
| | | | |2256|1|MPRO_402_PosFact|mDegree| |
| | | | |2257| |MPRO_402_VelFact|6094H|DS402 velocity encoder factor|
| | | | |2257|0|MPRO_402_VelFact|incr/s| |
| | | | |2257|1|MPRO_402_VelFact|rev/min| |
| | | | |2258| |MPRO_402_VelFact1|6095H|DS402 velocity factor 1|
| | | | |2258| |0|MPRO_402_VelFact1| |
| | | | |2258| |1|MPRO_402_VelFact1| |
| | | | |2259| |MPRO_402_VelFact2|6096H|DS402 velocity factor 2|
| | | | |2259| |0|MPRO_402_VelFact2| |
| | | | |2259|1|MPRO_402_VelFact2| | |
| | | | |2260| |MPRO_402_AccFact|6097H|DS402 acceleration factor|
| | | | |2260|0|MPRO_402_AccFact|incr/s/s| |
| | | | |2260|1|MPRO_402_AccFact|rev/min/s| |

Image 8.6: “‘Modulo (rotary table)’ process format” screen

If you select “Modulo (rotary table)”, the indexing table function will be activated. For the circumferential length (= “upper position”), a limit value that defines the point at which a revolution is complete must be entered.

# Table 8.2: “Standardization / units - Standard/CiA 402” parameter

|163|0|MPRO_FG_Config|Factor group configuration|
|---|---|---|---|
|2236|0|MPRO_402_Polarity|607EH DS402 Polarity|
|2246|0|MPRO_402_PosNotInd|6089H DS402 position notation index|
|2247|0|MPRO_402_PosDimInd|608AH DS402 position dimension index|
|2248|0|MPRO_402_VelNotInd|608BH DS402 velocity notation index|
|2249|0|MPRO_402_VelDimInd|608CH DS402 velocity dimension index|
|2250|0|MPRO_402_AccNotInd|608DH DS402 acceleration notation index|
|2251|0|MPRO_402_AccDimInd|608EH DS402 acceleration dimension index|

# 8.2.1.1 “As linear” process option

The circumferential length is set to 360°. On reaching 360° the actual position is set to 0°. It is not necessary to set a negative setpoint for the direction reversal.

Image 8.7: How the “as linear” indexing table function works

Image 8.8: “‘Anticlockwise rotation’ process option” screen

# 8.2.1.2 Process option “Left/right-hand rotation”

Example of a revolution with a circumferential length of 360°, setting "Direction of rotation left/right”:

The circumferential length is set to 360°. In positive direction, after reaching 360° the actual position is set to 0°. The same applies to the negative direction. On reaching 0° the actual position is set to 360°.

Image 8.9: “‘Clockwise rotation’ process option” screen

MOOG ID No.:CB40859-001 Date:11/2020

MSD ServoDrive - DeviceHelp 227

# 8 Motion profile

MOOG ID No.:CB40859-001 Date:11/2020

MSD ServoDrive - DeviceHelp 228

# 8.2.1.3 Process option “Path - optimized”

Not path-optimized Optimized path

An absolute target position is always approached by the shortest path. Relative movements cannot be carried out with the “path – optimized” mode.

|Position range|Example|Effect|
|---|---|---|
|Target position < 120°< 360°|The drive moves to the target position|within 360°.|
|Target position = 120° = 120°|The drive remains in position.| |
|Target position > 600° - 360° =|The drive moves to the position within|240° (target position - (n x circumferential length))|

Table 8.3: Path-optimized movement

Table 8.4: Path optimization diagram

# 8.2.1.4 Infinite motion task when using indexing table function

In the case of infinite motion tasks the drive moves at constant speed, regardless of a transmitted target position, until the mode is deactivated or is overwritten by a new motion task. On switching to the next driving set (absolute or relative), the new target position is approached in the current direction of movement. A preset path optimization is ignored when the indexing table is active.

# 8.2.1.5 Relative motion task when using indexing table function

Relative driving jobs may relate to the current target position or to the actual position. For more information see "Field Buses" User Manuals. In the case of relative driving jobs greater travel distances than the circumferential length are possible.

Example without gear ratio:

- Circumferential length = 360°
- Relative target position = 800°
- Start position = 0°
- Movement: The drive will complete two motor revolutions (720°) and stop at the 3rd revolution at 80° (800° - 720°).

# 8.2.2 SERCOS

When using the SERCOS profile, scaling of the units is termed weighting. The weighting describes the physical unit and the exponent with which the numerical values of the parameters exchanged between the master control system and the drives are to be interpreted. The method of weighting is defined by the parameters for position, speed, force/torque and acceleration weighting.

**Table 8.5: “Standardization / units - SERCOS” parameter**
|ID|Index Name|Unit|Description|
|---|---|---|---|
|163|MPRO_FG_Config| |Factor group configuration|
|10043|COM_SER_| |Speed polarity parameter|
|10044|PolaritySpeed| | |
|10045|COM_SER_| |Velocity data scaling type|
|10046|COM_SER_| |Velocity data scaling factor|
|10055|0| |ScaleExpSpeed|
|10076|COM_SER_| |Position data scaling type|
|10077|COM_SER_| |Linear position data scaling factor|
|10078|COM_SER_| |Linear position data scaling exponent|
|10085|COM_SER_| |Torque polarity parameter|

MOOG ID No.:CB40859-001 Date:11/2020

MSD ServoDrive - DeviceHelp 229

# 8 Motion profile

# 8 Motion profile

MOOG                          ID No.:CB40859-001 Date:11/2020                                                                                       MSD ServoDrive   - DeviceHelp     230

|ID|Index Name|Unit|Description|
|---|---|---|---|
|10086|COM_SER_| |Torque/force data scaling type|
|10093|COM_SER_| |Torque/force data scaling factor|
|10094|COM_SER_| |Torque/force data scaling exponent|
|10103|COM_SER_ModuloVal|mDegree|Modulo value|
|10121|COM_SER_| |Input revolutions of load gear|
|10122|COM_SER_| |Output revolutions of load gear|
|10123|COM_SER_FeedConst|um/rev|Feed constant|
|10160|COM_SER_| |Acceleration data scaling type|
|10161|COM_SER_| |Acceleration data scaling factor|
|10162|COM_SER_| |Acceleration data scaling exponent|

Table 8.5:  “Standardization / units - SERCOS” parameter (continue)

Image 8.11: “Standardization profile - SERCOS - Position unit (1)” screen

# Image 8.12: “Standardization profile - SERCOS - Position unit (2)” screen

# Image 8.13: Position data weighting method

# Position polarity

The polarity of the position data can be inverted according to the application. An increasing actual position value indicates clockwise rotation (looking at the motor shaft).

# Linear weighting

|Unit|Weighting factor|Preferential weighting (LSB)|
|---|---|---|
|m|1|E-7|

Table 8.6: Weighting for linear motion (default setting)

MOOG ID No.:CB40859-001 Date:11/2020

MSD ServoDrive - DeviceHelp 231

# 8 Motion profile

# 8 Motion profile

MOOG ID No.:CB40859-001 Date:11/2020

# MSD ServoDrive - DeviceHelp

232

# Rotary weighting

# 8.2.2.2 Speed

|Unit|Weighting factor|Preferential weighting (LSB)|
|---|---|---|
|Degrees|3,600,000|0.0001 μm|

Table 8.7: Weighting for rotary motion (default setting)

Image 8.14: “Standardization profile - SERCOS - Speed (1)” screen

# Image 8.15: “Standardization profile - SERCOS - Speed (2)” screen

The “Speed data weighting method" figure below shows the structure with which the acceleration is scaled using the SERCOS wizard. A distinction must be made between linear and rotary weighting here.

# Image 8.16: Speed data weighting method

# Speed polarity

The polarity of the speed data can be inverted according to the application. A positive speed reference indicates clockwise rotation (looking at the motor shaft).

# Linear weighting

Preferential weighting

|Unit|Weighting factor (LSB)|
|---|---|
|m/min|1|
| |0.001 m/min|

# Table 8.8: Weighting for linear motion (default setting)

MOOG ID No.:CB40859-001 Date:11/2020

MSD ServoDrive - DeviceHelp 233

# 8 Motion profile

# 8 Motion profile

MOOG ID No.:CB40859-001 Date:11/2020

# MSD ServoDrive - DeviceHelp

Rotary weighting

# 8.2.2.3 Unit of torque/power

Preferential weighting

|Unit|Weighting factor (LSB)|
|---|---|
|Degrees|3,600,000|
| |0.001 m/min|

Table 8.9: Weighting for rotary motion (default setting)

Image 8.17: “Standardization profile - SERCOS torque/power(1)” screen

# Image 8.18: “Standardization profile - SERCOS torque/power(2)” screen

# Image 8.19: Force/torque weighting method

The “Power/torque weighting method" figure below shows the structure with which the acceleration is scaled using the SERCOS wizard. A distinction must be made between linear and rotary weighting here. In percentage weighting the permanently permissible standstill torque of the motor is used as the reference value. All torque/force data is given in [%] with one decimal place.

# Torque polarity

The polarity of the torque can be inverted according to the application. A positive torque reference indicates clockwise rotation (looking at the motor shaft).

**Table 8.10: Weighting for linear motion (default setting)**
|Unit|Weighting factor|
|---|---|
|Nm|1|

LSB = Unit * Exponent

MOOG ID No.:CB40859-001 Date:11/2020

MSD ServoDrive - DeviceHelp 235

# 8 Motion profile

# 8 Motion profile

MOOG ID No.:CB40859-001 Date:11/2020

MSD ServoDrive - DeviceHelp 236

# 8.2.2.4 Unit of acceleration

|Weighting|Preferential weighting|Parameter weighting|
|---|---|---|
|Unit|factor|(LSB)|
|Nm|1|0.01 Nm|
|LSB = Unit * Exponent|LSB = Unit * Exponent|LSB = Unit * Exponent|

Table 8.11: Weighting for rotary motion (default setting)

Image 8.20: “Standardization profile - SERCOS - Acceleration(1)” screen

# Image 8.21: “Standardization profile - SERCOS - Acceleration(2)” screen

The "Acceleration data weighting method" figure below shows the structure with which the acceleration is scaled using the SERCOS wizard. A distinction must be made between linear and rotary weighting here.

# Image 8.22: Acceleration weighting

|Unit|Weighting factor|Factory setting (LSB)|
|---|---|---|
|m/s2|1|E-6|

Table 8.12: Weighting for linear motion (default setting)

MOOG ID No.:CB40859-001 Date:11/2020

MSD ServoDrive - DeviceHelp 237

# 8 Motion profile

# 8 Motion profile

MOOG ID No.:CB40859-001 Date:11/2020 MSD ServoDrive - DeviceHelp 238

# Rotary weighting

|Unit|Weighting factor|Factory setting (LSB)|
|---|---|---|
|rad/s2|3,600,000|E-3|

Table 8.13: Weighting for rotary motion (default setting)

# 8.2.2.5 Modulo weighting

If Modulo (indexing table application) is to be selected (see Section "As linear" process option" on page 227), the number range of the position data (modulo value) must be entered. When the modulo value is exceeded the actual position is reset to 0.

Image 8.23: Schematic of user-defined scaling

# 8.2.3 User defined

|ID|Index Name|Unit|Description|
|---|---|---|---|
|163|0 MPRO_FG_Config| |Factor group configuration|
|270|0 MPRO_FG_PosNorm|incr/rev|internal position resolution|
|271|0 MPRO_FG_Num|rev|Factor group: Numerator (profile independent)|
|272|0 MPRO_FG_Den|mDegree|Factor group: denominator (profile independent)|
|273|0 MPRO_FG_Reverse| |Factor group: Position and speed reverse (profile independent)|
|274|0 MPRO_FG_SpeedFac|rev/min/SPEED|Factor group: speed factor (profile independent)|
|275|0 MPRO_FG_AccFac|rev/s2/ACC|Factor group: acceleration factor (profile independent)|
|284|0 MPRO_FG_PosUnit| |Unit for position values|
|285|0 MPRO_FG_PosExp| |Factor group: Position unit exponent (profile independent)|
|286|0 MPRO_FG_| |Factor group: Position unit scaling factor|

Table 8.14: “Standardization / units - Custom” parameters

# 8 Motion profile

|ID|Index Name|Unit|Description|
|---|---|---|---|
|0290|MPRO_FG_AccUnit|[m/s²]|Acceleration unit|
| |PosScaleFac| |(profile independent)|
| | | |Feed constant: 0.1 mm = 1 rev|
|287|MPRO_FG_SpeedUnit| |Unit for speed values|
| | | |Gearing: 1 drive revolution = 3 motor revs|
|288|MPRO_FG_SpeedExp| |Factor group: Velocity unit exponent (profile independent)|
|289|MPRO_FG_SpeedScaleFac| |Factor group: Velocity unit scaling factor (profile independent)|
| | | |P 0284 MPRO_FG_PosUnit = 1 μm = 1/1000 mm = 10/1000 rev (output) = 30/1000 rev (motor)|
|290|MPRO_FG_AccUnit| |Unit for acceleration and deceleration values|
|291|MPRO_FG_AccExp| |Factor group: Acceleration unit exponent (profile independent)|
|292|MPRO_FG_AccScaleFac| |Factor group: Acceleration unit scaling factor (profile independent)|
| | | |P 0287 MPRO_FG_SpeedUnit = 1 m/s = 1000 mm/s = 10 000 rev/s (output) = 30 000 rev/s (motor)*60 (min) = 1 800 000 rev/min|
|293|MPRO_FG_TorqueUnit| |Unit for torque values|
|294|MPRO_FG_TorqueExp| |Factor group: Torque unit exponent (profile independent)|
|295|MPRO_FG_TorqueScaleFac| |Factor group: Torque unit scaling factor (profile independent)|
|298|MPRO_FG_UsrActPosDly|ms|Actual position delay (multiple of CON_PConTS)|

# Table 8.14: “Standardization / units - Custom” parameters (continue)

|ID|Name|Function|Standard rotary system|
|---|---|---|---|
|270|MPRO_FG_Nom|Numerator|1[rev]|
|271|PosNom|Increments per revolution|1048576 [incr/rev]|
|272|MPRO_FG_Den|Denominator|360° [POS]|
|273|MPRO_FG_Reverse|Reverse direction|False = clockwise|
|274|MPRO_FG_SpeedFac|Speed factor|1[rpm]|
|275|MPRO_FG_AccFac|Acceleration factor|1/60 = 0.01667 [rpm/s]|

# Table 8.15: Parameters for user-defined scaling (rotary system)

1 motor revolution corresponds to 360° or 1048576 increments

Speed in [rpm]

Acceleration in [rpm/s]

Positioning in [°degrees]

Given

Position unit P 0284 MPRO_FG_PosUnit = [μm]

Speed unit P 0287 MPRO_FG_SpeedUnit = [m/s]

MOOG ID No.:CB40859-001 Date:11/2020

MSD ServoDrive - DeviceHelp 239

# 8 Motion profile

MOOG ID No.:CB40859-001 Date:11/2020 MSD ServoDrive - DeviceHelp 240

|ID|Name|Function|Standard|ID|Name|Function|Standard|
|---|---|---|---|---|---|---|---|
|284|MPRO_FG_PosUnit|Unit for position value|mdegree|273|MPRO_FG_Reverse|Reverse direction|False = clockwise|
|287|MPRO_FG_SpeetUnit|Unit for speed value|rev/min|1.875 rps| | | |
| | |Unit for| |274|MPRO_FG_SpeedFac|Speed factor|mm/s, 1/32 mm = 0.03125 rps²|
| | | | | | | |s = 1.875 rps|
| | | | | | | |1/32 mm =|
|275|MPRO_FG_AccFac|Acceleration factor|0.03125 rps²| | | |corresponding to 1mm/s²|

# 8.2.3.2 Example of scaling of a linear motor

Presetting:

- One revolution corresponds to 32 mm pitch
- Travel in [μm]
- Speed in [mm/sec]
- Acceleration in [mm/s²]

|ID|Name|Function|Standard|
|---|---|---|---|
|270|MPRO_FG_PosNom|Increments per revolution|1048576 [incr/rev]|
|271|MPRO_FG_Nom|Numerator|1 [rev]|
|272|MPRO_FG_Den|Denominator|32000 μm|

# Table 8.16: Parameters for user-defined scaling (linear system)

# 8.3 Basic settings

|ID|Index|Name|Unit|Description|
|---|---|---|---|---|
|144|0|MPRO_DRVCOM_AUTO_START| |DriveCom: Auto start of system|
|159|0|MPRO_CTRL_SEL| |Motion profile selection|
|165|0|MPRO_REF_SEL| |Motion profile selection|
|166|0|MPRO_REF_JTIME|ms|Motion profile jerk time|
|167|0|MPRO_REF_OVR|%|Motion profile override factor|
|223|0|MPRO_REF_Config| |Motion profile: Config of specific profiling behaviour|
|301|0|CON_REF_Mode| |Mode selection of setpoint profiling|
|306|0|CON_IpRefTS|ms|Sampling time (for interpolation)|
|335|0|CON_SCON_DirLock| |Direction lock for speed reference value|
|370|0|CON_IP| |Interpolation type|
|755|0|MPRO_FG_RefPosFilType| |Position reference filter type|
|756| |MPRO_FG_RefPosFilData| |Reference position filter data|
|756|0|RefFil_TimeConst|ms|Position reference filter time constant (PT1/PT2/AVG)|
|756|1|RefFil_DampConst| |Position reference filter damping constant|

Image 8.24: “Basic settings” screen

Interpolation

Table 8.17: “Motion profile - Basic settings” parameters

See Section "Interpolation" on page 246.

# 8.3.1 PG mode with speed control

NOTE

- The reference filters are initialized only after the control has been re-enabled or by a device restart.
- Select reference source
- Motion profile adaptation: scaling, ramps and smoothing time.
- In reference processing by way of the profile generator the fine interpolator is always in use.

MOOG ID No.:CB40859-001 Date:11/2020

MSD ServoDrive - DeviceHelp 241

# 8 Motion profile

# 8 Motion profile

MOOG ID No.:CB40859-001 Date:11/2020

MSD ServoDrive - DeviceHelp 242

# Profile Generator with speed control:

- Control mode P 300[0] - CON_CfgCon = speed control
- Under Profile select the profile generator (PG) P 301[0] - CON_Ref_Mode = PG(0)
- Selection of reference source/>P 165[0] - MPRO_REF_SEL
- Scaling
- Select jerk conditions
- Set stop ramps, smoothing, filter, homing

# 8.3.2 PG mode with position control

Travel commands are transmitted to the internal profile generator (see Section "Basic settings" on page 241). It is composed of the following items:

- Target position
- Maximum travel speed
- Maximum acceleration
- Maximum deceleration

The profile generator uses the P 166[0] - MPRO_REF_JTIME jerk values and a P 167[0] - MPRO_REF_OVR override factor for the travel speed in order to generate the trajectory for the position setpoint that will take the least amount of time, taking all limitations into account.

The position references are then processed with the selected interpolation method.

# 8 Motion profile

# 8.3.2.1 Motion profile / Basic settings

The position references are used to generate pre-control values for speed Interpolation (IP) mode and acceleration. These are scanned at the sampling time of the position controller (normally 125 μs) and switched to the control loops.

Reference values are interpolated in linear mode before being switched to the control loops.

- The profile generator is inactive.
- Ramps and smoothing are inactive.
- The reference values are switched directly to the closed-loop control.

CAUTION! Your system/motor may be damaged if put into operation in an uncontrolled or inappropriate manner. Improper conduct can cause damage to your system/machine.

Before the “Start” step, make absolutely sure that a valid setpoint has been entered, as the configured setpoint will be immediately transmitted to the motor after the motor control function starts, which may result in the motor accelerating unexpectedly.

# Speed control in IP mode:

- Control mode P 300[0] - CON_CfgCon = speed control or setting via Modes of Operation (CAN, EtherCAT®)
- Selection of reference source P 165[0] - MPRO_REF_SEL

Image 8.27: PG mode with position control

# 8.3.3 IP mode with speed control

In IP (Interpolation) mode the appropriate reference source and correct scaling of units are selected for the speed reference before the reference is passed via the interpolator to the control. Linear interpolation is always applied in this process.

MOOG ID No.:CB40859-001 Date:11/2020 MSD ServoDrive - DeviceHelp 243

# 8 Motion profile

MOOG ID No.:CB40859-001 Date:11/2020 MSD ServoDrive - DeviceHelp 244

|Referencevalue|P 0165|-OFF (0)|Interpolation|
|---|---|---|---|
|-ANA0 (1)|Referencevalue|Normalization|IP-Mode|
|-ANA0 (2)|Userunit|Referencevalue| |
|Referencevalue|-Tab (3)|-DS402|Increments|
|-leer (4)|-SERCOS|Samplingtime|Interpolation|
|-iPLC (5)|-User-specific|1 ms|≥ 125 µs|
|-PARA (6)|-CiA DS402 (7)|-SERCOS (8)|-PROFIBUS (9)|
|-VARAN (10)|Image 8.29: Position control in IP mode (Motion Profile subject area)|Image 8.29: Position control in IP mode (Motion Profile subject area)|Image 8.29: Position control in IP mode (Motion Profile subject area)|
|Image 8.28: Speed control in IP mode (Motion Profile subject area)|Image 8.28: Speed control in IP mode (Motion Profile subject area)|Image 8.28: Speed control in IP mode (Motion Profile subject area)|Image 8.28: Speed control in IP mode (Motion Profile subject area)|

NOTE

- In linear interpolation the pre-control is ignored.
- Linear interpolation is always applied in speed-controlled mode. Pre-control is not active.

# 8.3.5 Jerk limitation and speed offset

# 8.3.4 IP mode with position control

- Position reference values are preset by a higher-level PLC with an appropriate sampling time.
- The sampling time must be balanced between the PLC and controller P 0306 CON_IpRefTS.
- The position references are then transferred to the fine interpolator.
- Pre-control values for speed and acceleration are switched to the control loops.
- For more information on the cycle time see the field bus documentation.

# 8.3.5.1 Jerk limitation (Profile mode)

The transfer path from the motor to the mechanism may be elastic and so susceptible to oscillation. For that reason, it is advisable to also limit the maximum rate of change of the torque and thus the jerk. Due to the jerk limitation the acceleration and deceleration times rise by the smoothing P 166[0] - MPRO_REF_JTIME. The smoothing setting box appears on-screen as soon as the profile type P 2243[0] - MPRO_402_MotionProf type is set to JerkLin(3).

# 8.3.5.2 Speed offset (limitation)

With speed override P 167[0] - MPRO_REF_OVR the maximum preset speed reference is scaled in percent.

# 8 Motion profile

Image 8.30: Profile type, smoothing profile type without smoothing

Image 8.31: Maximum jerk: Red = actual speed; grey = actual position

The acceleration and braking ramp = 0, so the jerk is maximum (red curve).

The acceleration and braking ramp with preset smoothing time (smoothing time = 2000 ms, red curve)

MOOG ID No.:CB40859-001 Date:11/2020

MSD ServoDrive - DeviceHelp 245

# 8 Motion profile

MOOG ID No.:CB40859-001 Date:11/2020

MSD ServoDrive - DeviceHelp 246

By using a suitable interpolation method, the function’s values between known points can be estimated. This is termed an interpolation problem. There are a number of solutions to the problem; the user must select the appropriate functions. Depending on the functions chosen, a different interpolant is obtained. Interpolation is a kind of approximation: the function under analysis is precisely reproduced by the interpolation function at the interpolation points and at the remaining points is at least approximated. The quality of approximation depends on the method chosen. In order to estimate it, additional information above the function f is required. This information is usually obtained naturally even if f is unknown: boundedness, continuity, and differentiability can frequently be assumed.

# 8.3.6.1 Linear interpolation

If there is no analytical description available for a function, and only individual points are known instead, it will not be possible to evaluate the function at just any point.

Here two given datum points f0 and f1 are connected by a line. To n+1 differing datum point pairs there is exactly one n-th order interpolation polynomial, which matches at the specified interpolation points.

Image 8.32: Ramps with smoothing: Red = actual speed; grey = actual position

Image 8.34: Linear interpolation

Image 8.33: Known points

# 8.3.6.2 Cubic interpolation

As polynomials become more and more unstable as the order of magnitude increases – that is to say, fluctuate widely between the interpolation points – in practice polynomials of an order greater than 5 are rarely applied. Instead, large data sets are interpolated in chunks.

In the case of linear interpolation, that would be a frequency polygon; in the case of 2nd or 3rd order polynomials the usual term used is spline interpolation. In the case of sectionally defined interpolants, the question of consistency and differentiation at the interpolation points is of major importance.

# 8.3.6.3 MSD Servo Drive interpolation types

|P No.|Index|Name / Setting|Unit|Description|
|---|---|---|---|---|
|370|0|CON_IP| |Interpolation type in IP mode|
| | |NoIp(0)| |The values are transferred 1:1 to reference processing in 1 ms cycles.|
| | |Lin (1)| |In the linear interpolation method the acceleration between two points is generally zero. Pre-control of the acceleration values is thus not possible and speed jumps are always caused.|
| | |SplineExtFF(2)| |Interpolation with external pre-control: Only on request from Moog.|

Image 8.35: Interpolation polynomial, 7th degree

Image 8.36: Cubic spline interpolation

MOOG ID No.:CB40859-001 Date:11/2020

MSD ServoDrive - DeviceHelp 247

# 8 Motion profile

# 8 Motion profile

MOOG ID No.:CB40859-001 Date:11/2020 MSD ServoDrive - DeviceHelp 248

|P No.|Index|Name / Setting|Unit|Description|
|---|---|---|---|---|
| |Splinell(3)|Cubic spline interpolation:| |Only on request from Moog.|
| |NonIPSpline(4)|Cubic spline approximation:| |In this method the interpolation points are approximated by means of B-splines. The trajectory normally does not run exactly through the points specified by the control. The deviation is normally negligibly small. In the interpolation points the transitions are continuous with regard to acceleration, which becomes apparent by minor "noise". In start and target position the interpolation points always match the trajectory. Usage: minimizing noise, smoother motion, restrictions on contouring.|
| |Cos(5)|Cosine interpolation:| |The interpolation formula corresponds to a Fourier trend of the unknown interpolants.|

Table 8.18: Interpolation types MSD Servo Drive (continue)

Each reference source has its own acceleration and braking ramps. There are also the stop ramps (quick-stop ramp), according to the CiA 402 standard. The ramp functions are only effective in certain system states. The required settings can be selected from the screen. Clicking the "Error/Error reactions" button directly accesses the screen for the error reactions.

# Stop ramps in torque control

When in torque control mode (TCON), if one of the following occurs:

- The control is shut down
- The setpoint is disabled
- Stop
- Quick stop
- Error

the set ramps will be performed in rpm.

# Reaction to “Control Shutdown”

The "shutdown option code" parameter determines which action is to be executed at the transition from "Operation enable" to "Ready to Switch on" (state machine state 5 to 3).

# Reaction to “Disable Operation"

The "disable operation option code" parameter determines which action is to be executed at the transition from "Operation enable" to "Switched on" (state machine state 5 to 4).

# Reaction to "Halt"

The "Halt" command interrupts a movement. The drive remains in the "Operation enable" state. When the "Halt" command is cancelled the interrupted movement is completed.

# Reaction to “Quickstop”

If the drive needs to be shut down as rapidly as possible due to a malfunction, it must be run down to speed zero on an appropriate ramp. The "Quickstop" function brakes an ongoing movement differently from the normal braking ramp. The servo drive is in the "Quickstop" system state. This state can be quit during or after braking, depending on the status of the quick-stop command and the respective reaction.

# 8.5.1 Homing screen

The homing movement is dictated by the speed (velocity) V1 and V2, the acceleration and the maximum positioning range.

|ID|Index Name|Unit|Description|
|---|---|---|---|
|2218|0 MPRO_402_QuickStopOC| |605AH DS402 quick-stop option code|
|2219|0 MPRO_402_ShutdownOC| |605BH DS402 reaction to control shutdown|
|2220|0 MPRO_402_DisableOpOC| |605CH DS402 disable operation option code|
|2221|0 MPRO_402_HaltOC| |605DH DS402 halt option code|
|2222|0 MPRO_402_FaultReactionOC| |605EH DS402 fault reaction option code|
|2242|0 MPRO_402_QuickStopDec|rev/min/s|6085H DS402 quickstop deceleration|

Table 8.19: “Motion profile - Stop ramps” parameters

MOOG ID No.:CB40859-001 Date:11/2020 MSD ServoDrive - DeviceHelp 249

# 8 Motion profile

# 8 Motion profile

MOOG ID No.:CB40859-001 Date:11/2020 MSD ServoDrive - DeviceHelp 250

NOTE

l The reference mark signal can be optionally linked to one of the ISD05 and ISD06 fast digital inputs.

# 8.5.1.1 Homing to a limit switch:

The digital input must be set to the available selection parameter LCW(5) for a positive limit switch or to LCCW(6) for a negative limit switch.

# 8.5.1.2 Homing to a cam

Set digital input to HOMSW(10) (P 106 - MPRO_INPUT_FS_ISD06 to P 107- MPRO_INPUT_FS_ISD07).

Image 8.38: Selection of homing method

NOTE

l The homing methods (-1) to (-12) are manufacturer-specific. Homing methods (0) to (35) are defined according to CiA 402.

1. Selection of homing methods (-12) to (35)
2. Speed V1: Speed during cam search Speed V2: Speed during zero point search
3. Acceleration for V1 and V2

|ID|Index Name|Unit|Description|
|---|---|---|---|
|169|MPRO_REF_HOMING_MaxDistance|mDegree|Homing: Maximum travel (homing to block: block detection)|
|170|MPRO_REF_HOMING_Ctrl| |Homing method Control word|
|171|HOMING_Ctrl| | |
|225|MPRO_REF_HOMING_BackupPos|mDegree|Homing: backup position|
|2234|MPRO_402_HomeOffset|mDegree|607CH DS402 home offset|
|2261|MPRO_402_HomingMethod| |6098H DS402 homing method|
| | | |Limitation of positioning range for homing. On exiting the positioning range, the axis is stopped with the error message "Overrun".|

# Legend for ‘Homing method’ screen figure

# Table 8.20: “Homing” parameters

# 8.5.2 Method (-13): Absolute encoder

|ID|Index Name| |Unit|Description| | |
|---|---|---|---|---|---|---|
|2262| |MPRO_402_|6099H|DS402 homing speeds| | |
|2262|0|SpeedSwitch|rev/min|Cam search speed| | |
|2262|1|SpeedZero|rev/min|Zero pulse search speed| | |
|2263|0|MPRO_402_|rev/min/s|609AH DS402 homing acceleration| | |

Table 8.20: “Homing” parameters (continue)

Method (-13) works in a similar way to method (-5) (see Section "Method (-5): Absolute encoder" on page 254). However, in this method the home offset is used to define the machine zero point, while in method (-5) it is used to define the offset relative to the encoder’s absolute position.

The following is the difference between the machine zero points for each method:

- Method (-13): Actual value = Home offset
- Method (-5): Actual value = Absolute encoder position (first needs to be determined with home offset = 0) + new home offset

Method (-13) is significantly easier to use, as it eliminates the need to determine the encoder’s absolute position at the machine zero point and back-calculate the actual position.

Image 8.39: Set the machine homing point

MOOG ID No.:CB40859-001 Date:11/2020

MSD ServoDrive - DeviceHelp 251

# 8 Motion profile

# 8.5.3 Method (-12): Set absolute position (absolute measuring system)

To set the machine homing point, the rotor or the linear axis is moved to the machine homing point. The desired actual position is written to the parameter "Offset" P 2234 MPRO_402_Homeoffset. Afterward, the axis must be referenced once. Every time the axis is started thereafter, the absolute position is calculated automatically. Every time a new homing operation is initiated, the machine homing point is reset to the current position.

# 8.5.4 Method (-10) and Method (-11): Move to block with zero pulse

Tracking error monitoring is switched off during the homing procedure. The maximum permissible torque can be reduced specifically during the homing operation. To do so, parameter P 0225 MPRO_REF_HOMING_TMaxScale must be set in the range of 0-100%. Note that this parameter replaces parameter P 0332 CON_SCON_TMaxScale during the homing run.

# 8.5.4.1 Method (-10): Rightward direction of travel

With P 0169 MPRO_REF_HOMING_MaxDistance the positioning range in which to search for the block is specified. After approaching the block, the drive reverses the direction of rotation until a zero pulse is detected. The first zero pulse after reversing direction corresponds to the zero point. An offset can be programmed in the screen.

Image 8.40: Set the machine homing point

Image 8.41: Move to block, direction of movement right with zero pulse

# 8.5.4.2 Method (-11): Leftward direction of travel

With P 0169 MPRO_REF_HOMING_MaxDistance the positioning range in which to search for the block is specified. After approaching the block, the drive reverses the direction of rotation until a zero pulse is detected. The first zero pulse

# 8 Motion profile

# 8.5.5 Method (-8) and (-9): Move to block

after reversing direction corresponds to the zero point. An offset can be programmed in the screen.

Tracking error monitoring is switched off during the homing procedure. The maximum permissible torque can be reduced specifically during the homing operation. To do so, parameter P 0225 MPRO_REF_HOMING_TMaxScale must be set in the range of 0-100%. Note that this parameter replaces parameter P 0332 CON_SCON_TMaxScale during the homing run.

# 8.5.5.1 Method (-8): Rightward direction of travel

With P 0169 MPRO_REF_HOMING_MaxDistance the tracking error is specified in the positioning range in which the block is detected. When the block is detected, the system disengages by half the value in parameter P 0169 MPRO_REF_HOMING_MaxDistance) and the zero point is defined. An offset can be programmed in the screen.

Image 8.42: Approach block, direction of travel left, with zero pulse

Image 8.43: Approach block, direction right

MOOG ID No.:CB40859-001 Date:11/2020

MSD ServoDrive - DeviceHelp 253

# 8 Motion profile

# 8.5.5.2 Method (-9): Leftward direction of travel

# 8.5.6 Method (-7) to (0)

With P 0169 MPRO_REF_HOMING_MaxDistance the tracking error is specified in the positioning range in which the block is detected. When the block is detected, the system disengages by half the value in parameter P 0169 MPRO_REF_HOMING_MaxDistance) and the zero point is defined. An offset can be programmed in the screen.

# 8.5.6.1 Homing method for increment-coded encoders

- Method (-6): Movement in negative direction
- Method (-7): Movement in positive direction

See also Section "Increment-coded reference marks" on page 105.

# 8.5.6.2 Method (-5): Absolute encoder

These homing methods are suitable for absolute encoders (e.g. SSI multi-turn encoders). Referencing is performed immediately after a mains power up. The reference position is calculated on the basis of the encoder absolute position plus zero offset. In the case of a SSI multi-turn encoder, homing with zero point offset = 0 gives the absolute position of the SSI encoder. Referencing again without changing the setting for the zero point offset does not cause a change of the position. To set the machine reference point homing method (-12) should be used.

# 8.5.6.3 Method (-4) and method (-3): Not defined

# 8.5.6.4 Method (-2): No homing

No homing will be performed. The zero point offset is added to the current position. When the power stage is first switched on, “Homing completed” is set as the status. This method is suitable for absolute encoders, provided that no offset compensation is required. For an offset compensation, please select method (-5).

# 8.5.6.5 Method (-1): Actual position = 0

The actual position corresponds to the zero point; it is set to 0, meaning the controller performs an actual position reset. The zero offset is added.

Image 8.44: Approach block, direction left

# 8.5.7 Method (1) and Method (2): limit switch and zero pulse

# 8.5.7.1 Method 1: Negative limit switch and zero pulse

- Start movement left; at this time the hardware limit switch is inactive.
- The direction of movement reverses on an active hardware limit switch edge.
- First zero pulse after falling limit switch edge corresponds to zero/reference point.

# 8.5.7.2 Method 2: Positive limit switch and zero pulse

- Start movement right; at this time the hardware limit switch is inactive.
- The direction of movement reverses on an active hardware limit switch edge.
- First zero pulse after falling limit switch edge corresponds to zero/reference point.

MOOG ID No.:CB40859-001 Date:11/2020

MSD ServoDrive - DeviceHelp 255

# 8 Motion profile

# 8 Motion profile

MOOG ID No.:CB40859-001 Date:11/2020 MSD ServoDrive - DeviceHelp 256

# 8.5.8 Method (3) and (4): Positive reference mark and zero pulse

# 8.5.8.1 Method (3): Start movement in direction of positive (right) hardware limit switch

- Start movement in direction of positive (right) hardware limit switch; at this time the reference mark is inactive.
- The direction of movement reverses on an active edge from the reference mark.
- The first zero pulse after a falling edge from the reference mark is the zero point/homing point.

Image 8.48: Start condition for negative limit switch

# 8.5.8.2 Method 4: Start movement in direction of negative (left) hardware limit switch

- Start movement in direction of negative (left) hardware limit switch; at this time the reference mark is inactive.
- The direction of movement reverses on an active edge from the reference mark.
- The first zero pulse after a falling edge from the reference mark is the zero point/homing point.

Image 8.47: Start condition for positive limit switch

# 8.5.9 Homing methods 5 and 6: Negative reference mark

The first zero pulse after a rising edge from the reference mark is the zero point/homing point.

# 8.5.9.1 Method (5): Start movement in direction of positive (right) hardware limit switch with zero pulse

- Start movement in direction of positive (right) hardware limit switch; at this time the reference mark is inactive.
- The first zero pulse after a falling edge from the reference mark is the zero point/homing point.
- The direction of movement reverses on an active edge from the reference mark.
- Start movement in direction of the negative limit switch if the reference mark is inactive.

Image 8.49: Positive (right) hardware limit switch and zero pulse

# 8.5.9.2 Method 5: Start movement in direction of negative (left) hardware limit switch with zero pulse

- Start movement in direction of negative (left) hardware limit switch.
- The direction of movement reverses on an inactive edge from the reference mark.

Image 8.50: Negative (left) hardware limit switch and zero pulse

MOOG ID No.:CB40859-001 Date:11/2020

MSD ServoDrive - DeviceHelp 257

# 8 Motion profile

MOOG ID No.:CB40859-001 Date:11/2020 MSD ServoDrive - DeviceHelp 258

# 8.5.10 Method (7) to (10):

# 8.5.10.1 Method (7): Reference mark, zero pulse and positive limit switch

- The start movement is in the direction of the positive, right hardware limit switch. Both it and the reference mark are inactive.
- The direction of movement reverses after an active reference mark. The zero point corresponds to the first zero pulse after the falling edge.
- The start movement is in the direction of the negative, left hardware limit switch. The homing point is set at the first zero pulse after a falling edge from the reference mark.
- The first zero pulse after passing the reference mark is the zero point.

# 8.5.10.2 Method (8):

- The zero point is the first zero pulse if the reference mark is active.
- The direction of movement reverses after a falling edge from the reference mark. The zero point corresponds to the first zero pulse after a rising edge from the reference mark.
- The direction of movement reverses when the reference mark has been passed. The zero point corresponds to the first zero pulse after a rising edge.

# 8.5.10.3 Method (9):

- The direction of movement changes when the reference mark becomes inactive. The zero point corresponds to the first zero pulse after a rising edge.
- The zero point is the first zero pulse if the reference mark is active.

# 8.5.10.4 Method (10):

- Once the reference mark has been passed, the first zero pulse after the falling edge is the zero point.

# 8.5.11 Method (11) to (14): Reference mark, zero pulse and negative limit switch

- After a falling edge from the reference mark: The first zero pulse corresponds to the zero point.
- After an active reference mark: The zero point corresponds to the first zero pulse after the falling edge.

# 8.5.11.1 Method (11)

- Reversal of direction of movement after active reference mark. The zero point corresponds to the first zero pulse after the falling edge.
- Zero point at the first zero pulse after falling edge from the reference mark.
- Movement must have gone beyond the reference mark, then the first zero pulse corresponds to the zero point.

Image 8.54: Zero pulse after falling edge corresponds to the zero point.

Image 8.55: Reversal of direction of movement after active reference mark

# 8.5.11.2 Method (12)

- Zero point corresponds to the first zero pulse if the reference mark is active.
- Reversal of direction of movement after a falling edge from the reference mark. The zero point corresponds to the first zero pulse after a rising edge from the reference mark.
- Reversal of direction of movement when the reference mark has been passed. The zero point corresponds to the first zero pulse after a rising edge.

MOOG ID No.:CB40859-001 Date:11/2020

MSD ServoDrive - DeviceHelp 259

# 8 Motion profile

MOOG ID No.:CB40859-001 Date:11/2020

MSD ServoDrive - DeviceHelp 260

- The zero point corresponds to the first zero pulse after the reference mark’s falling edge.
- Reversal of direction of movement after active reference mark. The zero point corresponds to the first zero pulse after the falling edge.

Image 8.56: Zero point corresponds to first zero pulse.

# 8.5.11.3 Method (13)

- Reversal of direction of movement when the reference mark has been passed. The zero point corresponds to the first zero pulse after a rising edge.
- Reversal of direction of movement when the reference mark becomes inactive. The zero point corresponds to the first zero pulse after a rising edge.
- Zero point corresponds to the first zero pulse if the reference mark is active.

Image 8.58: Zero point corresponds to first zero pulse after...

Image 8.57: Reversal of direction of movement...

# 8.5.11.4 Method (14)

- The zero point corresponds to the first zero pulse after crossing the reference mark.

# 8.5.12 Methods (15) and (16)

These two homing methods are not defined.

# 8.5.13 Method (17) to (30): Reference mark

# 8.5.13.1 Method (17) to (30

Homing methods 17 to 30 are equivalent to methods 1 to 14. The determination of the homing point is independent of the zero pulse. It only depends on the reference mark or on the limit switches.

Image 8.59: Homing methods 17 to 30 are equivalent to methods 1 to 14

MOOG ID No.:CB40859-001 Date:11/2020

MSD ServoDrive - DeviceHelp 261

# 8 Motion profile

MOOG ID No.:CB40859-001 Date:11/2020

MSD ServoDrive - DeviceHelp 262

# 8.5.14 Methods (31) and (32)

Method 1 corresponds to method 17

Method 20 corresponds to method 4

Method 8 corresponds to method 24

The determination of the homing point is independent of the zero pulse. It only depends on the reference mark or on the limit switches.

Method 12 corresponds to method 28

Method 14 corresponds to method 30

# Table 8.21: Method comparison of the individual homing methods

# 8.5.15 Method (33) and (34): with zero pulse

# 8.5.15.1 Method (33): Leftward travel direction

The actual position corresponds to the reference point. The zero pulse corresponds to the first zero pulse to the left.

# 8.5.15.2 Method (34): Rightward travel direction

The zero pulse corresponds to the first zero pulse to the right.

MOOG ID No.:CB40859-001 Date:11/2020

MSD ServoDrive - DeviceHelp 263

# 8 Motion profile

# 8 Motion profile

MOOG ID No.:CB40859-001 Date:11/2020 MSD ServoDrive - DeviceHelp 264

# 8.6 Jog mode

- Fast jog
- Both digital inputs must be active (corresponding bits in bus mode)

Fast jog, leftward direction of travel
- Input "Jog left" and then also enable input two

Fast jog, rightward direction of travel:

Image 8.63: “Jog speeds” screen

# 8.6.2 Digital Inputs

Jog mode (setup mode) is used to record (teach-in) positions, for disengaging in the event of a fault, or for maintenance procedures. A bus system or reference sourcing via terminal can be selected as the reference. The unit corresponds to the selected user unit.

Two speeds are available for both directions. If the drive is to be moved at different speeds, both inputs must be active (relevant bits in bus operation). If the "Jog left" input is activated first and then input two, "Fast jog mode left" is used. If the "Jog right" input is the first activated of the two, "Fast jog mode right" is used.

|ID|Index Name| |Unit|Description|
|---|---|---|---|---|
|168|MPRO_REF_JogSpeeds| | |Jog mode speeds|
|168|0|FastJogSpeed|rev/min|Fast jog speed|
|168|1|SlowJogSpeed|rev/min|Slow jog speed|

# 8.6.1 Configuration

- Jog in positive and negative direction:

Image 8.64: "Digital inputs" screen

# 8.6.3 Manual mode window, "Jog mode" tab

The jog speeds in the Manual mode window are oriented to the values of the "Jog mode speed" screen. The drive is moved using the "Jog -" and "Jog +" buttons.

# 8.7 Reference table

With the reference table up to 16 reference values can be defined. In the process, the drive moves to its targets in conformance to the respective driving sets. Depending on the selected control mode, each reference in the table assigned a speed, acceleration and deceleration value. The table reference values can be used in any control mode.

Image 8.66: “Reference table” screen

The setpoints need to be provided in the distance units defined by the user (for details on how distance units are defined, see Section "Scaling / Units" on page 223).

Image 8.65: "Jog mode" window

MOOG ID No.:CB40859-001 Date:11/2020

MSD ServoDrive - DeviceHelp 265

# 8 Motion profile

# 8 Motion profile

MOOG ID No.:CB40859-001 Date:11/2020 MSD ServoDrive - DeviceHelp 266

# Control mode

- AUTO_COMPLETE (4) = via auto complete mode (parameter no. 204)
- NOTE: As with "AUTO (2)", as long as the input is set, the table will be executed. After being deactivated, the entire table will be run through to the end once more.

“Control mode” does not refer to the motor control here (see Section "Control" on page 108), but rather to the source that will specify the table index!

P 205[0] - MPRO_TAB_Mode is used to define which source will specify the table index:

- PARA (0) = via current index (parameter no. 207)
- The value written to P 207[0] - MPRO_TAB_ActIdx (via a fieldbus, for example) will immediately be applied as the current table index and the corresponding driving job will be carried out.

TERM (1) = via terminals
- A bit pattern that will be applied as the value for the table index will be specified via digital inputs. In order to be able to select all 16 table entries, four digital inputs with TAB0(23) = Binary table index 20 to TAB3(26) = Binary table index 23 need to be configured. For details on configuring the digital inputs, see Section "Digital inputs" on page 290.

AUTO (2) = via time delay (parameter no. 204)
- Automatic processing of follow-up driving jobs. The number of driving jobs entered in parameter P 206[0] - MPRO_Tab_MaxIdx is processed in sequence. This operation is repeated until the drive is stopped or the table is disabled. There will be a wait time of P 204 - MPRO_TAB_WaitTime between the individual driving jobs.

BUS (3) = via fieldbus

# 8 Motion profile

P 203 - MPRO_TAB_PMode is used to define the type of positioning used:

- ABS(0) = Absolute
Absolute positioning
- REL(1) = Relative (after “target reached”)
Relative positioning after target position reached.
- REL at once(2) = Relative (at once)
Aborts a current motion task and moves, as of the current position, to the new reference.
- SPEED(3) = Endless (speed controlled)
If a table value is set to SPEED, an infinite motion task is transmitted. If a table value with the setting ABS or REL is additionally selected, the infinite job is quit and the newly selected table value is approached from the current position.

# Speed

If the Servo Drive is run with motor control mode "PCON(3) = Position control mode" (for information on the setting, see Section "Basic settings" on page 110), the “Mode” and “Speed” lines will be added to the “Setpoint table” screen.

P 201 - MPRO_TAB_PSpd is used to define the speed for a motion task.

# Acceleration

With ...

- P 193 - MPRO_TAB_TAcc (for torque control) or
- P 196 - MPRO_TAB_SAcc (for speed control) or
- P 199 - MPRO_TAB_PAcc (for position control)

and indexes 0–15, the accelerations for moving to the setpoint for each individual motion task can be defined. The input must not be zero.

MOOG ID No.:CB40859-001 Date:11/2020

MSD ServoDrive - DeviceHelp 267

# 8 Motion profile

MOOG ID No.:CB40859-001 Date:11/2020 MSD ServoDrive - DeviceHelp 268

# Deceleration

With ...

- P 194 - MPRO_TAB_TDec (for torque control) or
- P 197 - MPRO_TAB_SDec (for speed control) or
- P 200 - MPRO_TAB_PDec (for position control)

and indexes 0–15, the deceleration for each individual motion task can be defined. The input must not be zero.

# Wait time in Auto mode

P 204 - MPRO_TAB_WaitTime is used to define the wait time before the next motion task is carried out.

# Maximum table index in Auto mode

P 206[0] - MPRO_Tab_MaxIdx is used to define the table index up to which driving jobs will be carried out in one of the auto modes.

# Current table index

P 207[0] - MPRO_Tab_ActIdx will show the index for the motion task that is currently active. If parameter P 205 MPRO_TAB_Mode is set to “Para(0)”, a driving set can be entered and approached directly.

# Activation of reference table

The following procedures can be used in order to activate the setpoint table for operation.

|ID|Index Name|Unit|Description|
|---|---|---|---|
|193|MPRO_TAB_TAcc|TAB: Torque mode acceleration|Nm/ms|
|193|0|MPRO_TAB_TAcc|Nm/ms|
|193|1 - 15|MPRO_TAB_TAcc|Nm/ms|
|194|MPRO_TAB_TDec|TAB: Torque mode deceleration| |
|194|0|MPRO_TAB_TDec|Nm/ms|
|194|1 - 15|MPRO_TAB_TDec|Nm/ms|

# Table 8.23: Activation of table references

# Table 8.24: “Setpoint table settings” parameters

# Table 8.24: “Setpoint table settings” parameters (continue)

|ID|Index Name|Unit|Description|ID|Index Name|Unit|Description|
|---|---|---|---|---|---|---|---|
|195|MPRO_TAB_TRef|Nm|TAB: Torque mode reference value|208|MPRO_TAB_OutputNo| |OSD TAB: actual table index and target|
|195|MPRO_TAB_TRef|Nm| |208|MPRO_TAB_OutputNo| | |
|196|MPRO_TAB_SAcc|rev/min/s|TAB: Speed mode acceleration|269|MPRO_TAB_Ctrl| |TAB: control word|
|196|MPRO_TAB_SAcc|rev/min/s| | | | | |
|197|MPRO_TAB_SDec|rev/min/s|TAB: Speed mode deceleration| | | | |
|197|MPRO_TAB_SDec|rev/min/s| | | | | |
|198|MPRO_TAB_SRef|rev/min|TAB: Speed mode reference value| | | | |
|198|MPRO_TAB_SRef|rev/min| | | | | |
|199|MPRO_TAB_PAcc|rev/min/s|TAB: Position control mode acceleration| | | | |
|199|MPRO_TAB_PAcc|rev/min/s| | | | | |
|200|MPRO_TAB_PDec|rev/min/s|TAB: Position control mode Acceleration| | | | |
|200|MPRO_TAB_PDec|rev/min/s| | | | | |
|201|MPRO_TAB_PSpd|rev/min|TAB: Position control mode speed| | | | |
|201|MPRO_TAB_PSpd|rev/min| | | | | |
|202|MPRO_TAB_PPos|mDegree|TAB: Position control mode reference value| | | | |
|202|MPRO_TAB_PPos|mDegree| | | | | |
|203|MPRO_TAB_PMode| |Position control table:Mode| | | | |
|203|MPRO_TAB_PMode| | | | | | |
|204|MPRO_TAB_WaitTime|ms|TAB: Wait time| | | | |
|204|MPRO_TAB_WaitTime|ms| | | | | |
|205|MPRO_TAB_Mode| |TAB mode| | | | |
|206|MPRO_Tab_MaxIdx| |TAB: Max index in AUTO mode| | | | |
|207|MPRO_TAB_ActIdx| |TAB: Actual index| | | | |

MOOG ID No.:CB40859-001 Date:11/2020

MSD ServoDrive - DeviceHelp

# 8 Motion profile

MOOG ID No.:CB40859-001 Date:11/2020

MSD ServoDrive - DeviceHelp 270

# 8.8 Analog channel (ISA00 und ISA01)

# Offset (O)

This parameter (P 174 - MPRO_ANA0_SOffset for ISA00, P 184 - MPRO_ANA1_SOffset for ISA01) compensates for component variations and is used for offset compensation purposes. Depending on the control mode being used (see Section "Basic settings" on page 110), the value will be stored in parameter index [0] (torque control), [1] (speed control) or [2] (position control).

# Backlash (B)

This parameter (P 175 - MPRO_ANA0_SThreshold for ISA00, P 185 - MPRO_ANA1_SThreshold for ISA01) can suppress axis motion close to the standstill (stop) position. Depending on the control mode being used (see Section "Basic settings" on page 110), the value will be stored in parameter index [0] (torque control), [1] (speed control) or [2] (position control).

Image 8.68: “Analog channel” screen

# Acceleration ramp

Two standard analog inputs (ISA00, ISA01) are available. These inputs can be configured...

- with negative values for analog setpoint settings
- with positive values for digital setpoint processing

(P 109[0] - MPRO_INPUT_FS_ISA00 and P 110[0] - MPRO_INPUT_FS_ISA01).

see also section "Analog Inputs" on page 303. By using the "REV(-2) = Analog setpoint" setting, an analog input voltage of ±10 V can be processed as a setpoint.

# Deceleration ramp

This parameter serves as a deceleration ramp for torque control (P 176[1] - MPRO_ANA0_TRamp for ISA00, P 186[1] - MPRO_ANA1_TRamp for ISA01) or speed control (P 177[1] - MPRO_ANA0_SRamp for ISA00, P 187[1] - MPRO_ANA1_SRamp for ISA01). Depending on the control mode being used (see Section "Basic settings" on page 110), the value will be stored in parameter index [0] (torque control), [1] (speed control) or [2] (position control).

This parameter (P 173 - MPRO_ANA0_Scale for ISA00, P 183 - MPRO_ANA1_Scale for ISA01) is used to define which speed / which torque / which position corresponds to the maximum analog value. Depending on the control mode being used (see Section "Basic settings" on page 110), the value will be stored in parameter index [0] (torque control), [1] (speed control) or [2] (position control).

# 8.8.1 Special characteristics of position control mode

A threshold value can also be specified which generates a run-on range around the last reference value. A ramp function calculates a motion profile for the position reference from pre-defined acceleration and speed limits.

The position references on the analog channel are not applied immediately, but dependent on a digital input. Accordingly, one of the ISD00 to ISD06 digital inputs must be set to a value of "REFANAEN(28) = Enable analog reference value" (see Section "Digital inputs" on page 290). The position setpoint being received will only be applied if the corresponding digital input is active. The acceleration is entered using P 173[0] - MPRO_ANA0_TScale or P 183[0] - MPRO_ANA1_TScale.

# 8.8.2 Wire Break Monitoring

P 399 - CON_ANAWireBrk_Th can be used to configure wire break monitoring for the analog inputs. For details see Section "Wire Break Monitoring" on page 306.

|Function|TLIM (-4)|OVR (-3)|REFV (-2)|leer (-1)|OFF (0)|
|---|---|---|---|---|---|
|Digital|(1)-(28)|(1)-(28)|(1)-(28)|(1)-(28)|(1)-(28)|
|Analog channel|Filter|Scale|Offset|Profile|generator|

Control

Image 8.69: Reference processing structure

MOOG ID No.:CB40859-001 Date:11/2020

MSD ServoDrive - DeviceHelp 271

# 8 Motion profile

# 8 Motion profile

MOOG ID No.:CB40859-001 Date:11/2020

|ID|Index Name|Unit|Description|ID|
|---|---|---|---|---|
|395|CON_ANA_Isaf_Scaled| |Analog inputs: Values (filt, norm, comp, scaled)|174|
|395|0 ISA00| |Scaled, compensated, filtered, normalized value|175|
|395|1 ISA01| |Scaled, compensated, filtered, normalized value| |
|396|CON_ANA_Scale_ThUpper| |Analog inputs: Upper scaling limits|175|
|396|0 ISA00|%|Upper scaling (@ 10 V) threshold|175|
|396|1 ISA01|%|Upper scaling (@ 10 V) threshold| |
|397|CON_ANA_Scale_ThZero| |Analog inputs: Zero scaling thresholds|176|
|397|0 ISA00|V|Zero scaling threshold (+/-)|176|
|397|1 ISA01|V|Zero scaling threshold (+/-)| |
|398|CON_ANA_Scale_ThLower| |Analog inputs: Lower scaling limits|177|
|398|0 ISA00|%|Lower scaling (@ zero threshold) threshold|177|
|398|1 ISA01|%|Lower scaling (@ zero threshold) threshold| |
|399|CON_ANA_WireBrk_Th| |Analog inputs: Wire break thresholds|Table 8.26:|
|399|0 ISA00|V|Wire break detection threshold| |
|399|1 ISA01|V|Wire break detection threshold| |
|405|0 CON_ANA_Filt0|ms|Analog input ISA00: Filter time constant (PT 1)|ID|
|408|CON_ANA_Isaf_Norm| |Analog inputs: Values (filt, norm)|183|
|408|0 ISA00| |Filtered, normalized value|183|
|408|1 ISA01| |Filtered, normalized value|183|

Table 8.25: “Analog channel” parameters

|ID|Index Name|Unit|Description|ID|
|---|---|---|---|---|
|173|MPRO_ANA0_Scale| |ANA0: scale factors|184|
|173|0 MPRO_ANA0_TScale|Nm|ANA0: scale factor torque reference|185|
|173|1 MPRO_ANA0_SScale|rev/min|ANA0: scale factor speed reference|185|
|173|2 MPRO_ANA0_PScale|mDegree|ANA0: scale factor position reference| |
|174|MPRO_ANA0_Offset| |ANA0: offsets|185|
|174|0 MPRO_ANA0_TOffset|Nm|ANA0: offsets for torque reference|185|

Table 8.26: “Analog channel ISA00” parameters

|Index Name|Unit|Description|
|---|---|---|
|1 MPRO_ANA0_SOffset|rev/min|ANA0: offsets for speed reference|
|2 MPRO_ANA0_POffset|mDegree|ANA0: offsets for position reference|
|MPRO_ANA0_Threshold| |ANA0: thresholds|
|0 MPRO_ANA0_TThreshold|Nm|ANA0: threshold for torque reference|
|1 MPRO_ANA0_SThreshold|rev/min|ANA0: threshold for speed reference|
|2 MPRO_ANA0_PThreshold|mDegree|ANA0: threshold for position reference|
|MPRO_ANA0_TRamp| |ANA0: Torque mode acceleration [0] and deceleration [1]|
|0 MPRO_ANA0_TRamp|Nm/s| |
|1 MPRO_ANA0_TRamp|Nm/s| |
|MPRO_ANA0_SRamp| |ANA0: Speed mode acceleration [0] and deceleration [1]|
|0 MPRO_ANA0_SRamp|SPEED/s| |
|1 MPRO_ANA0_SRamp|SPEED/s| |

“Analog channel ISA00” parameters (continue)

|Index Name|Unit|Description|
|---|---|---|
|MPRO_ANA1_Scale| |ANA1: scale factors|
|0 MPRO_ANA1_TScale|Nm|ANA0: scale factor torque reference|
|1 MPRO_ANA1_SScale|rev/min|ANA0: scale factor speed reference|
|2 MPRO_ANA1_PScale|mDegree|ANA0: scale factor position reference|
|MPRO_ANA1_Offset| |ANA1: offsets|
|0 MPRO_ANA1_TOffset|Nm|ANA1: offsets for torque reference|
|1 MPRO_ANA1_SOffset|rev/min|ANA1: offsets for speed reference|
|2 MPRO_ANA1_POffset|mDegree|ANA1: offsets for position reference|
|MPRO_ANA1_Threshold| |ANA1: thresholds|
|0 MPRO_ANA1_TThreshold|Nm|ANA1: threshold for torque reference|
|1 MPRO_ANA1_SThreshold|rev/min|ANA1: threshold for speed reference|
|2 MPRO_ANA1_PThreshold|mDegree|ANA1: threshold for position reference|

“Analog channel ISA01” parameters

# 8 Motion profile

|ID|Index Name|Unit|Description|
|---|---|---|---|
|186|MPRO_ANA1_TRamp|Nm/s|ANA1: Torque mode acceleration [0] and deceleration[1]|
|186|MPRO_ANA1_TRamp|Nm/s| |
|187|MPRO_ANA1_SRamp|SPEED/s|ANA1: Speed mode acceleration [0] and deceleration [1]|
|187|MPRO_ANA1_SRamp|SPEED/s| |

# Table 8.27: “Analog channel ISA01” parameters (continue)

Display

- System state
- Initialization on device startup
- Not ready (DC link voltage possibly too low)
- Start inhibit (DC link voltage present, power stage off)
- Starting lockout
- Ready for start
- Control initialization: Auto commutation, flux build-up etc.

# Table 8.28: Central state machine according to CiA 402 device display

MOOG ID No.:CB40859-001 Date:11/2020

MSD ServoDrive - DeviceHelp 273

# 8 Motion profile

MOOG ID No.:CB40859-001 Date:11/2020

MSD ServoDrive - DeviceHelp 274

|Display|System state|power disabled|fault|
|---|---|---|---|
|Control enabled|0|Start|7|
| |fault reaction active|0|14|
|Quick stop active|1|not ready|8|
| |to switch on|1|17|
|Error reaction active|2|switch on|disabled|
| |2|7| |
|Error state (in this state the error is indicated directly on the display.)|3|ready to|switch on|
|Device is reset (display flashes)|power enabled|3|6|
| |10|12| |
|• Number [5.] flashes when “STO” (Safe Torque Off) input is active. Display goes out when STO inactive.| | | |
|• The dot on the display flashes when the power stage is active.| | | |

Table 8.28: Central state machine according to CiA 402 device display (continue)

NOTE

l The system states indicated on the display may differ from the states in the table depending on the drive profile setting.

Image 8.70: State machine diagram based on CANopen communications

⓪ to ① State number

1 to 17 State transition (No. 17: DC link voltage cut off)

Legend for “State machine diagram based on CANopen communications” figure

# 8.10 Touch probe

|ID|Index Name / Setting|
|---|---|
|241|0 MPRO_TP_Position|
|241|1 MPRO_TP_Position|
|241|2 MPRO_TP_Position|
|241|3 MPRO_TP_Position|
|241|4 MPRO_TP_Position|
|1400|0 MPRO_TP_Config|
| |TP_TP (0)|
| |AB (1)|
| |PD_UP (2)|
| |PD_DOWN (3)|
| |PC_PC (4)|
| |PC_TP (5)|
| |TP_PC (6)|
| |ENC_ENC (7)|
| |ENC_TP (8)|
| |TP_ENC (9)|

Using the touch probe inputs, touch probe functions can be performed. In order to be able to do this, P 106[0] - MPRO_INPUT_FS_ISD05 and P 107[0] - MPRO_INPUT_FS_ISD06 must be used to set digital inputs ISD05 and ISD06 to "PROBE(15) = Touch probe (only ISD05/06)" (see Section "Digital inputs" on page 290). HTL encoders can be evaluated or pulse counters implemented using the MSD PLC.

The touch probe can be triggered with P 240 - MPRO_TP_Ctrl. This enables triggering on a positive or negative edge, or on both edges, of the signal detected on the touch probe inputs. After the measurement, the parameter jumps back to the value "NONE (0)" and the latch position is mapped in the corresponding subindex of parameter P 241 - MPRO_TP_Position. A continuous touch probe mode is not possible at present, so the touch probe has to be reactivated after the measurement.

P 1402 - MPRO_TP_Channel can be used to select various positions as actual value sources of the latch position for the touch probe functionality. The following table provides an overview of the available settings. The counters are accessed via the MSD PLC or a bus system.

|ID|Index Name / Setting|Unit|Description|
|---|---|---|---|
|240|MPRO_TP_Ctrl|Touch probe: Control| |
| |0| |NONE (0) = No function|
| |1| |POS (1) = Positive edge|
| |2| |NEG (2) = Negative edge|
| |3| |BOTH (3) = Both edges|
|240|0 MPRO_TP_Ctrl| | |
|240|1 MPRO_TP_Ctrl| | |
|240|2 MPRO_TP_Ctrl| | |
|241|MPRO_TP_Position|Probe: Pos. high/low edge of TP0/1, encoder zero pulse| |

Table 8.29: “Touch probe” parameters

MOOG ID No.:CB40859-001 Date:11/2020

# 8 Motion profile

|Unit|Description|
|---|---|
|mDegree|Touch probe: Configuration|
|mDegree|TP0, TP1 touch probe|
|mDegree|TP0, TP1 as encoder, A/B as quadrature counting|
|mDegree|TP0, TP1 as encoder, pulse (TP0) / direction (TP1), count up on direction high|
|mDegree|TP0, TP1 as encoder, pulse (TP0) / direction (TP1), count down on direction high|
|mDegree|TP0 pulse counter, TP1 pulse counter|
|mDegree|TP0 pulse counter, TP1 touch probe|
|mDegree|TP1 touch probe, TP0 pulse counter|
|mDegree|TP0 encoder counter, TP1 encoder counter|
|mDegree|TP0 encoder counter, TP1 touch probe|
|mDegree|TP0 touch probe, TP1 encoder counter|

Touch probe: Channel

|Unit|Description|
|---|---|
|ACTPOS (0)|Actual position in user units|
|ACTPOSINC (1)|Actual position in increments|
|MASTERPOS (2)|Master position in increments|
|ENCPOS_CH1 (3)|Encoder position Channel 1|
|ENCPOS_CH1_INC (4)|Encoder position Channel 1 in increments|
|ENCPOS_CH2 (5)|Encoder position Channel 2|
|ENCPOS_CH2_INC (6)|Encoder position Channel 2 in increments|

# 8 Motion profile

MOOG ID No.:CB40859-001 Date:11/2020 MSD ServoDrive - DeviceHelp 276

|ID|Index Name / Setting|Unit|Description|
|---|---|---|---|
|7|ENCPOS_CH3 (7)| |Encoder position Channel 3|
|8|ENCPOS_CH3_INC (8)| |Encoder position Channel 3 in increments|
|9|ENCPOS_CH4 (9)| |Encoder position Channel 4|
|10|ENCPOS_CH4_INC (10)| |Encoder position Channel 4 in increments|
|11|ACTPOS2 (11)| |Actual position of redundant encoder in user units|
|12|Sercos (12)| |Referred to Sercos profile parameters S-x-0426, S-x-0427|
|13|UserRefPos(13)| |Reference position in user units|
|14|MasterPosST(14)| |Master position (ECAM, EGEAR) singleturn, always steps|
|15|CommonMasterPos(15)| |Master position (ECAM, EGEAR) singleturn, always steps|
|16|CommonMasterPosST(15)| |Master position (ECAM, EGEAR) singleturn, always steps|
|1402|MPRO_TP_Channel| | |
|1402|MPRO_TP_Channel| | |
|1402|MPRO_TP_Channel| | |
|1404|MPRO_TP_Lines| |Touch probe: Lines @ pulse counter on channel x|
|1404|MPRO_TP_Lines| | |
|1404|MPRO_TP_Lines| | |

Image 8.71: “Synchronized motion” screen

There are various modes available in the “synchronization mode” drop-down menu (P 242[0] - MPRO_ECAM_SyncModMode):

- Off(0) = Synchronized motion off
- ECAM_iPlc(1) = Electronic cam plate via MSD PLC
- EGEAR_iPlc(2) = Electr. gear unit via MSD PLC
- ECAM_PARA(3) = Electronic camming via parameters
- EGEAR_PARA(4) = Electronic gearing via parameters

NOTE: For more information refer to the bus system User Manuals or the description of the MSD PLC.

# 8.11.1 Electronic cam plate

The other parameters are configured in separate screens that can be accessed with the corresponding buttons.

- Master configuration (see Section "Master configuration" on page 280)
- Electronic gearing (see Section "Electronic gearing" on page 283)
- Electronic camming (see Section "Electronic cam plate" on page 277)

P 1318[0] - MPRO_ECAM_ControlWord is the control word for “synchronized motion” (see Section "Control word for synchronized motion" on page 279).

P 1326[0] - MPRO_ECAM_StatusWord is the status word for “synchronized motion” (see Section "Status word for synchronized motion" on page 279).

# 8.11.1.1 Table selection

|ID|Index Name|Unit|Description|
|---|---|---|---|
|1300|MPRO_ECAM_CTS_| |ECAM: CamTableSelect - Master reference|
|1301|MasterRef| | |
|1305|MPRO_ECAM_CTS_| |ECAM: CamTableSelect - Method for changing the camtable|
|1306|MPRO_ECAM_CTS_| |ECAM: CamTableSelect - Mode for changing the camtable|
|1307|MPRO_ECAM_CTS_|incr|ECAM: CamTableSelect - Distance for changing the camtable|
|242|MPRO_ECAM_| |ECAM / EGEAR: Mode of synchronized motion SyncModMode|
|265|MPRO_ECAM_| |ECAM / EGEAR: Slave speed factor (1 = 100%).|
|266|CamSlave_SpeedFactor| | |
|268|MPRO_ECAM_| |ECAM / EGEAR: Mode of switching off sync. motion|

# 8.11.1.2 Synchronization

|ID|Index Name|Unit|Description|
|---|---|---|---|
|1342|MPRO_ECAM_CI_|incr|ECAM: CamIn - Synchronization position (multiturn part)|
|1343|MPRO_ECAM_CO_|incr|ECAM: CamOut - Decoupling pos. (multiturn part)|
|1303|MPRO_ECAM_CI_|incr|ECAM: CamIn - Master offset|
|1308|MPRO_ECAM_CI_| |ECAM: CamIn - Master reference|
|1309|MPRO_ECAM_CI_| |ECAM: CamIn - Slave reference|
|1310|MPRO_ECAM_CI_| |ECAM: CamIn - Coupling mode|
|1311|MPRO_ECAM_CI_|incr|ECAM: CamIn - Coupling distance|
|1312|MPRO_ECAM_CI_|incr|ECAM: CamIn - Synchronization position|

Table 8.31: “Electronic camming - Table selection” parameters

Table 8.30: “Synchronized motion” parameters

Table 8.32: “Electronic camming - Synchronization” parameters

MOOG ID No.:CB40859-001 Date:11/2020

MSD ServoDrive - DeviceHelp 277

# 8 Motion profile

MOOG ID No.:CB40859-001 Date:11/2020 MSD ServoDrive - DeviceHelp 278

|ID|Index|Name|Unit|Description|
|---|---|---|---|---|
|1313|0|MPRO_ECAM_CO_SyncPosST|(singleturn part)|ECAM: CamOut - Slave reference|
|1314|0|MPRO_ECAM_CO_DecouplingMode|63|ECAM: CamOut - Decoupling mode|
|1315|0|MPRO_ECAM_CO_BreakingPosST|incr|ECAM: CamOut - Decoupling position|
|1316|0|MPRO_ECAM_CO_DecouplingDist|incr|ECAM: CamOut - Decoupling distance|
|1317|0|MPRO_ECAM_CO_StandstillPos|mDegree|ECAM: CamOut - Slave standstill position|

# Table 8.32: “Electronic camming - Synchronization” parameters (continue)

|ID|Index|Name|Unit|Description|
|---|---|---|---|---|
|1346| |MPRO_ECAM_SP_Table| |ECAM: Setpoint table interface|
|1346|0|Index| |Index of setpoint table|
|1346|1|Value| |Value at index of setpoint table|
|1347|0 to 31|MPRO_ECAM_SP_Index| |ECAM: Setpoint segments start index|
|1348|0 to 31|MPRO_ECAM_SP_Length| |ECAM: Setpoint segments length|
|1349|0 to 31|Length| | |
|1350|0|MPRO_ECAM_SP_MaDist| |ECAM: Setpoint segments master distance|
|1351|0|MPRO_ECAM_SP_IpoType| |ECAM: Setpoint segments interpolation type|
|1352|0 to 31|Checksum| |ECAM: Setpoint table checksum|
|1353|0 to 31|GainNum| |ECAM: Setpoint segments gain numerator|
| | |GainDen| |ECAM: Setpoint segments gain denominator|

# Table 8.33: “Electronic camming - Table segments” parameters

|ID|Index|Name|Unit|Description|
|---|---|---|---|---|
|1329|0 to 63|MPRO_ECAM_SegData_IndexNext| |ECAM: Index of the following segment|
|1330|0 to 63|MPRO_ECAM_SegData_IndexPrev| |ECAM: Index of the previous segment|
|1331|0 to 63|MPRO_ECAM_SegData_ProfileMode| |ECAM: Profile mode of the current segment|
|1332|0 to 63|MPRO_ECAM_SegData_DistMaster| |ECAM: Length of the master section of the current segment|
|1333|0 to 63|MPRO_ECAM_SegData_DistSlave| |ECAM: Length of the slave section of the current segment|
|1334|0 to 63|MPRO_ECAM_SegData_Lambda| |ECAM: Lambda value of the current segment|
|1335|0 to 63|MPRO_ECAM_SegData_StatusWord| |ECAM: Status word of the current segment|
|1336|0 to 63|MPRO_ECAM_SegData_ControlWord| |ECAM: Control word of the current segment|

# 8.11.2 Control word for synchronized motion

|Bit|Function|PLC function|Bit number|Description|
|---|---|---|---|---|
|0-7|Start segment (8-bit value)|-|0-7|Actual segment (8-bit value)|
|8-15|Reserved|-| |Actual ECAM / EGEAR state machine state (4 Bit value)|
|16|Absolute (true) / relative (false) master relationship|-| |- 0: ECAM / EGEAR asynchronous
- 1: ECAM / EGEAR synchronous
|
|17|Absolute (true) / relative (false) master (CAM) relationship at cam in|-| |- 2: ECAM / EGEAR synchronizing
- 3: ECAM / EGEAR desynchronizing
|
|18|Absolute (true) / relative (false) slave (CAM) relationship at cam in|-| |- 4: ECAM / EGEAR active and waiting for going asynchronous
|
|19-23|Reserved|-| |- 5: ECAM / EGEAR inactive and waiting for going synchronous
|
|24|Change gear ratio of the electronic gear online|MCB_GearRatioChange| | |
|25|Disable master calculation|MCB_Cam_MasterEnable| | |
|26|Enable master calculation|MCB_Cam_MasterEnable| | |
|27|Select CAM table|MCB_CamTableSelect| | |
|28|Start Ecam|MCB_CamIn| | |
|29|Stop Ecam|MCB_CamOut| | |
|30|Start Egear|MCB_GearIn| | |
|31|Stop Egear|MCB_GearOut| | |

# 8.11.3 Status word for synchronized motion

|Bit|Function|PLC function|Bit number|Description|
|---|---|---|---|---|
|12-26|Reserved|-| | |
|27|ECAM / EGEAR is active|-| | |
|28|Valid segments chosen|-| | |
|29|Master data are valid|-| | |
|30|Master is initialized|-| | |
|31|Master calculation is active|-| | |

Table 8.35: Control word ECAM (P 1318[0] - MPRO_ECAM_ControlWord)

Table 8.36: ECAM status word (P 1326[0] - MPRO_ECAM_StatusWord)

MOOG ID No.:CB40859-001 Date:11/2020 MSD ServoDrive - DeviceHelp 279

# 8 Motion profile

# 8 Motion profile

MOOG ID No.:CB40859-001 Date:11/2020

MSD ServoDrive - DeviceHelp 280

# 8.11.4 Master configuration

the master encoder, you will need to set the resolution relative to a single motor revolution in P 250 - MPRO_ECAM_PARAMaster_Amplitude (see below).

- ENC CH1 (3) = Encoder channel 1 X7 (Sin/Cos)
- ENC CH2 (4) = Encoder channel 2 X6 (Resolver)
- ENC CH3 (5) = Encoder channel 3 X8 (optional)

This function is only available if an external interface X8 (option module) is present.

- TP0 (6) = Pulse counter on probe channel 0 (TP0)
- TP1 (7) = Pulse counter on probe channel 1 (TP1)
- ENC_CH4 (8) = Encoder channel 4 (p. e. fieldbus)
- TWIN_POS (9) = TWIN remote reference position (P-2607)

Image 8.72: “Master configuration” screen

# Channel selection (master encoder)

P 1319[0] - MPRO_ECAM_CamMaster_AxisType is used to define the master encoder.

- NO AXIS (0) = No axis
- VIRTUAL MASTER (1) = Virtual master

If you select this function, you will be able to configure additional settings by clicking on the enabled “Options...” button (see Section "Virtual Master" on page 286).

- PARA (2) = Master parameter interface

If you select this function because a higher-level controller is being used as

# Anti-reverse mode

Slave only starts moving along with it again as soon as the master reaches the zero position.

P 1320[0] - MPRO_ECAM_CamMaster_RevLockMode is used to define the reverse lock mode, which can be used either with or without path compensation. The dashed lines in the following diagrams indicate what the engagement distance is:

# Example:

If the master, which has moved two motor revolutions in the direction blocked for the slave, then moves in the unblocked direction again, the slave only moves off when the master has traversed the zero point.

- INACTIVE (0) = Reverse lock inactive
- ACTIVE (2) = Reverse lock enabled - without path optimization
- ACTIVE WAY COMP (1) = Reverse lock active - with way compensation

While the slave accelerates to the speed of the master during engagement, the master and slave do not move synchronously. This function needs to be selected in order to quickly catch up to the master that is running ahead.

# Example:

- Master (black line) rotates in the blocked direction
- The slave (blue line) remains stopped
- Master rotates in the unblocked direction again
- The slave follows the master directly in the unblocked direction

Assume the master has moved two motor revolutions in the direction for which the slave lock is enabled. If the master now moves in the direction for which there is no lock, the slave will immediately start running in that direction.

MOOG ID No.:CB40859-001 Date:11/2020

MSD ServoDrive - DeviceHelp 281

# 8 Motion profile

MOOG ID No.:CB40859-001 Date:11/2020 MSD ServoDrive - DeviceHelp 282

|Filter type|ID|Index Name|Unit|Description|
|---|---|---|---|---|
|When using a real master encoder, encoder signals may be subject to noise.|P 1340|1319|0|MPRO_ECAM_CamMaster_AxisType|
| | |MPRO_ECAM_CamMaster_SpeedFilTyp| |ECAM / EGEAR: Channel selection of internal master input|
| | |1320|0|MPRO_ECAM_CamMaster_RevLockMode|
| | |1321|0|MPRO_ECAM_CamMaster_Amplitude|
| | |1322|0|MPRO_ECAM_CamMaster_GearNum|
| | |1323|0|MPRO_ECAM_CamMaster_GearDen|
|Filter time|1327|0|ms|ECAM / EGEAR: Filter time constant of master|
|If P 1340[0] is used to enable a filter, P 1327[0] - MPRO_ECAM_CamMaster_SpeedTFil can be used to define the corresponding filter time.|1328|0|speed|ECAM / EGEAR: Speed factor of the internal master|
|Speed factor|1340|0| |MPRO_ECAM_CamMaster_SpeedFilTyp|
|The master encoder can be assigned an additional speed factor P 1328[0] - MPRO_ECAM_CamMaster_SpeedFactor.|1341|0|incr|ECAM / EGEAR: Master drive offset|

Table 8.37: “Synchronized motion - Master configuration” parameters (continue)

| | | |ID|Index Name|Unit|Description|
|---|---|---|---|---|---|---|
|247|0|MPRO_ECAM_ParaMaster_ActPos|incr|ECAM / EGEAR: Parameter interface master position| | |
|248|0|MPRO_ECAM_ParaMaster_ActSpeed|rpm|ECAM / EGEAR: Parameter interface master speed| | |
|249|0|MPRO_ECAM_ParaMaster_ActAcc|rpm|ECAM / EGEAR: Parameter interface master acceleration| | |
| |250|0|MPRO_ECAM_ParaMaster_Amplitude| |ECAM / EGEAR: Parameter interface master amplitude| |

Table 8.37: “Synchronized motion - Master configuration” parameters

# 8.11.5 Electronic gearing

# Gear ratio

The gear ratio is specified as a fraction. This ensures that the position references can be translated to the motor shaft with no rounding error.

- "Slave" (P 252[0] - MPRO_ECAM_Egear_GearNum) is the numerator
- "Master" (P 251[0] - MPRO_ECAM_Egear_GearDen) is the denominator

# Scaling of speed pre-control

Defined with P 265[0] - MPRO_ECAM_CamSlave_SpeedFactor definiert.

# Scaling of torque pre-control

Defined with P 266[0] - MPRO_ECAM_CamSlave_TorqueFactor.

# Engagement

See Section "Engagement" on page 284.

# Disengagement

See Section "Disengagement" on page 285.

|ID|Index Name|Unit|Description|
|---|---|---|---|
|251|0 MPRO_ECAM_Egear_GearDen| |EGEAR: Gear denominator|
|252|0 MPRO_ECAM_Egear_GearNum| |EGEAR: Numerator of gear ratio|
|1344|0 MPRO_ECAM_Egear_LimRefAcc|rpm/s|EGEAR: Acceleration limit for reference|
|1345|0 MPRO_ECAM_Egear_LimRefJerk|rpm/s²|EGEAR: Jerk limit for reference|

Table 8.38: “Synchronized motion - Electronic gearing” parameters

Image 8.73: "Electronic gearing" screen

MOOG ID No.:CB40859-001 Date:11/2020 MSD ServoDrive - DeviceHelp 283

# 8 Motion profile

# 8 Motion profile

MOOG ID No.:CB40859-001 Date:11/2020

MSD ServoDrive - DeviceHelp 284

# 8.11.6 Engagement

used to define the engagement distance (between the dashed lines).

P 253[0] - MPRO_ECAM_Egear_GearInMode is used to define the mode for engagement.

- DIRECT (0) = Direct
- Direct engagement: Angular synchronous; with jerking (no ramps).
- CROSSFADE (3) = Crossfading
- Engagement with crossfading function (5th degree polynomial): Angular synchronous; jerk-limited; speed will overshoot during engagement.
- RAMP (1) = Linear speed ramp
- Engagement with linear acceleration: Not angular synchronous; with jerking.
- FADE (2) = Engagement fade-out
- Engagement with fade-in function (5th degree polynomial): Not angular synchronous; jerk-limited. The position is ignored. There always remains a variation between reference and actual position. P 257[0] (see below) is used to define the engagement distance. The actual engagement occurs within this range (between the dashed lines).

P 255[0] - MPRO_ECAM_Egear_GearInAcc is used to define the acceleration for the "RAMP (1)” mode.

P 257[0] - MPRO_ECAM_Egear_GearInDist is used to define the engagement distance.

|ID|Index Name|Unit|Description|
|---|---|---|---|
|253|MPRO_ECAM_Egear_GearInMode| |EGEAR: GearIn - engagement mode|
|255|MPRO_ECAM_Egear_GearInAcc|rev/min/s|EGEAR: GearIn - acceleration ramp for engagement|
|257|MPRO_ECAM_Egear_GearInDist|incr|EGEAR: GearIn - engagement distance|
|263|MPRO_ECAM_Egear_GearInJerk|rpm/s2|EGEAR: GearIn - acceleration ramp jerk for engagement|

Table 8.39: “Synchronized motion - Electronic gearing - Engagement” parameters

# 8.11.7 Disengagement

l  FADE (2) = Engagement fade-out

Disengagement with fade-out function (5th order polynomial): jerk limited. The position is ignored. There always remains a variation between reference and actual position. P 254[0] - MPRO_ECAM_Egear_GearOutMode is used to define the mode for disengagement.

l  DIRECT (0) = Direct

Direct disengagement: With jerking (no ramps).

l  RAMP (1) = Linear speed ramp

Disengagement with linear deceleration: With jerking. P 256[0] (see below) is used to define the deceleration for the "RAMP (1)” mode.

P 258[0] - MPRO_ECAM_Egear_GearOutDist is used to define the disengagement distance. The actual disengagement occurs within this range (between the dashed lines).

MOOG                       ID No.:CB40859-001 Date:11/2020                                                                                  MSD ServoDrive  - DeviceHelp    285

# 8 Motion profile

# 8 Motion profile

MOOG ID No.:CB40859-001 Date:11/2020 MSD ServoDrive - DeviceHelp 286

|ID|Index Name|Unit|Description|
|---|---|---|---|
|254|MPRO_ECAM_Egear_GearOutMode| |EGEAR: GearOut - disengagement mode|
|256|MPRO_ECAM_Egear_GearOutDec|rev/min/s|EGEAR: GearOut - deceleration ramp for disengagement|
|258|MPRO_ECAM_Egear_GearOutDist|incr|EGEAR: GearOut - disengagement distance|
|264|MPRO_ECAM_Egear_GearOutJerk|rpm/s²|EGEAR: GearOut - acceleration ramp jerk for disengagement|

Table 8.40: “Synchronized motion - Electronic gearing - Disengagement” parameters

Image 8.74: "Virtual master" screen

Click "Start" to start the engagement and click "Stop" and "Halt" correspondingly to stop it.

NOTE

The virtual master must be activated by clicking the "Start" button, and remains active for operation of a synchronized movement.

# 8 Motion profile

|ID|Index Name|Unit|Description|
|---|---|---|---|
|244|0|MPRO_ECAM_VM_|Virtual master reference speed|
|245|0|MPRO_ECAM_VM_|Virtual master amplitude|
|246|0|MPRO_ECAM_VM_|Virtual master actual position|
|259|0|MPRO_ECAM_VM_|Virtual master acceleration|
|260|0|MPRO_ECAM_VM_|Virtual master deceleration|
|261|0|MPRO_ECAM_VM_|Virtual master jerk|
|262|0|MPRO_ECAM_VM_|Virtual master actual speed|
|267|0|MPRO_ECAM_VM_|Virtual master actual speed|

# Table 8.41: “Virtual master” parameters

|ID|Index Name|Unit|Description|
|---|---|---|---|
|1407|0|MPRO_CMST_|Control word|
|1408|0|MPRO_CMST_|Status word|
|1409| |MPRO_CMST_Para|Data of common master|
|1409|0|Source|Source of value processing|
|1409|1|Destination|Destination of value processing|
|1409|2|RevLoclMode|Reverse lock mode|
|1409|3|Amplitude|incr Amplitude|
|1409|4|GearNum|Gear numerator|
|1409|5|GearDen|Gear denominator|
|1409|6|SpeedFilType|Speed filter: Filter type|
|1409|7|SpeedFilTs|ms Speed filter: Filter time|
|1409|8|SpeedFactor|Speed filter: Factor|
|1409|9|Offset|incr Position offset|
|1410| |MPRO_CMST_|Data of common master phasing|
|1410|0|Position|incr Position phasing difference|
|1410|1|Velocity|rpm Position phasing velocity|
|1410|2|Acceleration|rpm/s Position phasing acceleration|
|1411| |MPRO_CMST_ActVal|Actual values of common master|
|1411|0|PosST|incr Position singleturn part|
|1411|1|PosMT|r Position multiturn part|
|1411|2|Vel|rpm Velocity|

# Table 8.42: "Common master” parameters

MOOG ID No.:CB40859-001 Date:11/2020

MSD ServoDrive - DeviceHelp 287

# 8 Motion profile

MOOG ID No.:CB40859-001 Date:11/2020 MSD ServoDrive - DeviceHelp 288

# 8.14 Cam group (CAM switch)

The function is not available as standard. It must be specially requested. Please contact Moog.

# 8.15 Data handling

|ID|Index|Name|Unit|Description|
|---|---|---|---|---|
|2920|0|MPRO_DATA_Ctrl| |Extended data control word|
|2921|0|MPRO_DATA_Stat| |Extended data status word|
|2922|0|MPRO_DATA_Act| |Actual signal value|
|2923|0|MPRO_DATA_Upper| |Reference upper limit value|
|2924|0|MPRO_DATA_Lower| |Reference lower limit value|
|2925|0|MPRO_DATA_Ref| |Reference value|
|2926|0|MPRO_DATA_Signal| |Signal selection|
|2927|0|MPRO_DATA_ActIdx| |Actual index of value|
|2928| |MPRO_DATA_Info| |Extended data information|
|2928|0|MPRO_DATA_MaxIdx| |Maximum stored values|
|2928|1|MPRO_DATA_Crc| |CRC of stored values|
|2929| |MPRO_DATA_Value| |Feed-forward calculation mode|
|2929|0|MPRO_DATA_UpperLimit| |Upper limit offset|
|2929|1|MPRO_DATA_LowerLimit| |Lower limit offset|
|2930|0|MPRO_DATA_DataName| |Name of data set|

Table 8.43: “Data handling” parameters

# 9 Inputs/Outputs settings

# Chapter overview

Pictogram

Navigation &nbsp;&nbsp;&nbsp;&nbsp;►Project tree ►Device setup ►Input/Output settings

Brief description &nbsp;&nbsp;&nbsp;&nbsp;This chapter describes how the digital inputs and outputs, the analog inputs and outputs, and the motor brake output on the MSD Servo Drive and MSD Single-Axis Servo Drive Compact work and are configured.

Image 9.1: “Inputs/Outputs settings” screen

# Contents

- 9.1 Inputs/Outputs settings &nbsp;&nbsp;&nbsp;&nbsp;289
- 9.2 Digital inputs &nbsp;&nbsp;&nbsp;&nbsp;290
- 9.3 Digital Outputs &nbsp;&nbsp;&nbsp;&nbsp;298
- 9.4 Analog Inputs &nbsp;&nbsp;&nbsp;&nbsp;303
- 9.5 Analog outputs (option only for MSD Servo Drive) &nbsp;&nbsp;&nbsp;&nbsp;307
- 9.6 Motor brake output &nbsp;&nbsp;&nbsp;&nbsp;308

The buttons on this screen can be used to access and configure the individual input and output types.

Inputs

- Before using the digital inputs, they are normally associated with a special device functionality for digital inputs with the use of function selectors.
- Likewise, before using the analog inputs, these are normally associated with a special device functionality for analog inputs. The corresponding function selectors also make it possible to select a special digital functionality instead.
- Two of the digital standard inputs on the device are what are referred to as “touch probe inputs”. These inputs are faster than the other inputs.

MOOG &nbsp;&nbsp;&nbsp;&nbsp;ID No.:CB40859-001 Date:11/2020 &nbsp;&nbsp;&nbsp;&nbsp;MSD ServoDrive - DeviceHelp &nbsp;&nbsp;&nbsp;&nbsp;289

# 9 Inputs/Outputs settings

MOOG ID No.:CB40859-001 Date:11/2020

# MSD ServoDrive - DeviceHelp 290

# Outputs

# 9.2 Digital inputs

- While function selectors can be used to assign digital outputs a wide range of special device functionalities for digital outputs, the special device functionality for analog outputs is considerably more limited and does not overlap with the digital outputs’ functionality. Moreover, analog outputs are only available when using X8 option modules!
- The motor brake output is a digital output with special hardware for driving a motor brake, which is normally found inside the motor casing.

Image 9.2: “Function selectors of the digital inputs” screen

# Digital inputs can be:

- The touch probe function is only available at ISD05 (P 106[0] - MPRO_INPUT_FS_ISD05) and ISD06 (P 107[0] - MPRO_INPUT_FS_ISD06).
- ISD0x
- Digital standard inputs on the outside of the device with a functionality that can be freely configured to the greatest extent possible (“S” standard inputs)
- ENPO
- A digital input (EnablePower) on the outside of the device that is used to enable/lock the power stage with hardware and that has a functionality that can be configured, albeit with very strict limitations
- ISDSH
- A digital input (Safe Stop) on the outside of the device that is used for an enable/lock signal by the safety stop circuit and that has a functionality that cannot be changed
- ISV0x
- “Virtual inputs” on the inside of the device with a freely configurable functionality much like that available for the ISD0x inputs
- IED0x
- In addition, there can be additional digital inputs if the X8 option is used (“E” expansion inputs)

# Status of the digital inputs

Clicking on the “Status of digital inputs” field on the input screen for the digital inputs will open a visualization showing the digital inputs’ states (see Section "Status of the digital inputs" on page 294).

# 9.2.1 Digital standard inputs

There is a selector that can be used to assign a function to each digital standard input. Certain functions will only be available for certain inputs or with specific function packages. Depending on the configured function, the “Options...” button may become enabled. If it is, this button can be used to switch to a different screen directly and define the function’s exact behaviour there.

|ID|Index Name|Unit|Description|
|---|---|---|---|
|101|MPRO_INPUT_FS_ISD00| |Function of digital input ISD00|
|102|MPRO_INPUT_FS_ISD01| |Function of digital input ISD01|
|103|MPRO_INPUT_FS_ISD02| |Function of digital input ISD02|
|104|MPRO_INPUT_FS_ISD03| |Function of digital input ISD03|
|105|MPRO_INPUT_FS_ISD04| |Function of digital input ISD04|
|106|MPRO_INPUT_FS_ISD05| |Function of digital input ISD05|
|107|MPRO_INPUT_FS_ISD06| |Function of digital input ISD06|
|108|MPRO_INPUT_FS_ISDSH| |Function of digital input ISDSH|
|113|MPRO_INPUT_FS_IEDxx| |Inputs extended digital: Function of digital inputs|
|113|IED00| |Function of digital input IED00|
|113|IED01| |Function of digital input IED01|
|113|IED02| |Function of digital input IED02|
|113|IED03| |Function of digital input IED03|

|118|MPRO_INPUT_FILTER|ms|for ENPO|
|---|---|---|---|
|118|MPRO_INPUT_FILTER|ms|for ISD00|
|118|MPRO_INPUT_FILTER|ms|for ISD01|
|118|MPRO_INPUT_FILTER|ms|for ISD02|
|118|MPRO_INPUT_FILTER|ms|for ISD03|
|118|MPRO_INPUT_FILTER|ms|for ISD04|
|118|MPRO_INPUT_FILTER|ms|for ISD05|
|118|MPRO_INPUT_FILTER|ms|for ISD06|
|118|MPRO_INPUT_FILTER|ms|for ISA00|
|118|MPRO_INPUT_FILTER|ms|for ISA01|
|118|MPRO_INPUT_FILTER|ms|for ISDSH|
|118|MPRO_INPUT_FILTER|ms|for IED00|
|118|MPRO_INPUT_FILTER|ms|for IED01|
|118|MPRO_INPUT_FILTER|ms|for IED02|

MOOG ID No.:CB40859-001 Date:11/2020 MSD ServoDrive - DeviceHelp 291

# 9 Inputs/Outputs settings

# 9 Inputs/Outputs settings

MOOG ID No.:CB40859-001 Date:11/2020

MSD ServoDrive - DeviceHelp 292

|ID|Index|Name|Unit|Description|ID|Index|Name / Setting|Unit|Description|
|---|---|---|---|---|---|---|---|---|---|
|118|14|MPRO_INPUT_FILTER|ms|for IED03|HOMST (9)| |Start homing according to the homing method parameterized in P 02261 MPRO_402_| | |
|119|0|MPRO_INPUT_STATE_FIL| |States of filtered and inverted digital inputs|Homing Method| | | | |
|120|0|MPRO_INPUT_INV| |Digital input inversion: ENPO[0], ISD00..05[1..6], SH[7], ISD06[16]|HOMSW (10)| |Homing switch to determine the zero for positioning| | |

Table 9.1: “Digital standard inputs” parameters (continue)

|ID|Index|Name / Setting|Unit|Description|
|---|---|---|---|---|
|101 - 107|0|MPRO_INPUT_FS_ISDxx| |Function selectors for the digital inputs|
| | |Off (0)| |Input without function|
| | |START (1)| |Start of control: Motor is energized. The direction of rotation depends on the reference.|
| | |INV (2)| |Inverse reference value|
| | |STOP (3)| |Carries out a quick stop as per the quick stop response (active-low)|
| | |HALT (4)| |Disable feed: The ongoing axis movement is interrupted and resumed as per the "HALT" reaction following resetting.|
| | |LCW (5)| |Limit switch positive direction: Limit switch evaluation without overrun protection, positive direction. The reaction to limit switch overrun and to interchanged limit switches can be preset.|
| | |LCCW (6)| |Limit switch negative direction: Limit switch evaluation without overrun protection, negative direction. The reaction to limit switch overrun and to interchanged limit switches can be preset.|
| | |INCH_P (7)| |Jog in positive direction|
| | |INCH_N (8)| |Jog in negative direction|

Table 9.2: Function selectors “Digital inputs”

HALT_PC (20): Disable feed with following position control (from V1.35-06)

TBEN (21): Import and execution of selected table driving set

TBTEA (22): Write actual position into selected table index: Teach-in for position references. The current position is stored in the specified table index on a rising edge. The index can be defined via the inputs in binary format (setting 23-26) or set via P 207[0] - MPRO_TAB_ActIdx. The teach-in

# 9.2.3 Hardware enable – power stage

function can also be activated by parameter P 269[0] - MPRO_TAB_Ctrl bit 0.

MSD Servo Drive Single-Axis System, MSD Servo Drive Multi-Axis System and MSD Single-Axis Servo Drive Compact support the "STO" (Safe Torque Off) safety function in accordance with the requirements of EN ISO 13849-1 and EN 61800-5-2 / IEC/EN 62061 / IEC/EN 61508.

|ID|Index|Name / Setting|Unit|Description|
|---|---|---|---|---|
|TAB0|(23)|Binary table index|2^0| |
|TAB1|(24)|Binary table index|2^1| |
|TAB2|(25)|Binary table index|2^2| |
|TAB3|(26)|Binary table index|2^3| |
|EGEAR|(27)|Start/Stop electronic gearing| | |
|REFANAEN|(28)|Enable analog reference| | |
|ENC|(29)|Use of ISD05 / ISD06 as encoder input (pulse count, pulse/direction).| | |
|JOG_EXT_POS|(34)|Jog Positive (extended mode)| | |
|JOG_EXT_NEG|(35)|Jog Negative (extended mode)| | |
|FAST_DISC|(36)|Fast discharge of DC link (using a braking resistor)| | |
|LIM_OFF|(37)|Limits off (torque and speed): Torque scaling (P 332[0] - CON_SCON_TmaxScale) and speed limiting (P 337[0] - CON_SCON_SmaxScale) will be disabled (ISDxx = "high"). If the function is not parameterized to an input (ISDxx = "low") the limits are always active.| | |
|LOCK_POS|(38)|Lock positive direction: Reversing lock, positive direction (access also via MSD PLC).| | |
|LOCK_NEG|(39)|Lock negative direction: Reversing lock, negative direction (access also via MSD PLC).| | |
|BRAKE_ON|(40)|Switch off motor break at once| | |
|PWR_REL_DIRECT|(41)|Used to manually switch the precharge relay (with 1000 ms delay) Use only after consultation with Moog.| | |
|SPINDLECLAMP_S1|(42)|Switch 1 input| | |
|SPINDLECLAMP_S2|(43)|Switch 2 input| | |
|SPINDLECLAMP_S3|(44)|Switch 3 input| | |
|SPINDLECLAMP_P|(45)|Clamping Pressurized input| | |
|SlaveBC|(46)|Brake chopper synchronization only on ISD05 and ISD06| | |
|USER2|(47)|Test case 47| | |
|START_PRC|(48)|Start process controller| | |

Table 9.2: Function selectors “Digital inputs” (continue)

MOOG ID No.:CB40859-001 Date:11/2020

MSD ServoDrive - DeviceHelp 293

# 9 Inputs/Outputs settings

# 9 Inputs/Outputs settings

MOOG ID No.:CB40859-001 Date:11/2020

MSD ServoDrive - DeviceHelp 294

# 9.2.4 Digital virtual inputs

Virtual inputs are digital software inputs actuated via MSD PLC or field bus. The virtual inputs P 111[0] - MPRO_INPUT_FS_ISV00 and P 112[0] - MPRO_INPUT_FS_ISV01 can use all digital functions which are also available to the real digital inputs.

|ID|Index|Name|Unit|Description|
|---|---|---|---|---|
|111|0|MPRO_INPUT_FS_ISV00| |Function selector ISV00|
|112|0|MPRO_INPUT_FS_ISV01| |Function selector ISV01|
|120|0|MPRO_INPUT_INV| |Digital input inversion: ENPO[0], ISD00..05[1..6], SH[7], ISD06[16]|

Table 9.4: “Digital virtual inputs” parameters

# 9.2.5 Status of the digital inputs

Clicking on the “Status of digital inputs” field on the input screen for the digital inputs will open a visualization showing the digital inputs’ states.

|ID|Index|Name|Unit|Description|
|---|---|---|---|---|
|121|0|MPRO_INPUT_STATE| |Status of digital inputs|

Table 9.5: “Status of digital inputs” parameters

# 9.2.6 Control selector switching

The function selector (MPRO_INPUT_FS_ISDxx) assigns the digital inputs their functionality. Using the setting “MAN(14)=Switch control location selector" here will make it possible to switch the control location via a terminal to the setpoint source selected in P 164[0] - MPRO_REF_SEL_MAN. This enables fast switching to manual control for setup or emergency running mode, for example.

When a digital input set to "MAN(14)" is activated, the control location P 159[0] - MPRO_REF_SEL = "TERM" switches (switch to "TERM" is not displayed in the Moog DRIVEADMINISTRATOR 5). In parallel, the reference source is set to the reference selected via parameter P 164[0] - MPRO_REF_SEL_MAN. The start signal must be connected to a digital input (ISD0x = Start). The control mode P 300[0] - CON_CfgCon cannot be switched. The "MAN(14)" mode is displayed in the field bus control word. It is not possible to switch to "MAN" mode

- when the power stage is active
- when the drive in the Moog DRIVEADMINISTRATOR 5 is operated via the manual mode window.

A level-triggered START P 144[0] - MPRO_DRVCOM_AUTO_START=LEVEL (1) is ignored in "MAN" mode. After activation of "MAN" mode, the START input must be reset. When "MAN" mode is ended the motor control also stops.

|P No.|Index|P Name / Setting|Unit|Function|
|---|---|---|---|---|
|164|0|MPRO_REF_Sel_MAN|Selection of motion profile| |
| | |OFF (0)|No profile selected| |
| | |ANA0(1)|Reference value of analog input ISA0| |
| | |ANA1(2)|Reference value of analog input ISA1| |
| | |TAB(3)|Reference from table| |
| | |PLC_BASIC(4)|Profile via PLC definition| |
| | |PLC(5)|Reference from PLC| |
| | |PARA(6)|Reference via parameter| |
| | |DS402(7)|Reference via CiA 402 IEC1131| |
| | |Sercos(8)|Reference via SERCOS| |
| | |PROFI(9)|Reference via PROFIBUS| |
| | |VARAN(10)|Reference via VARAN| |
| | |TWIN(11)|Reference via external option "TWINsync"| |
| | |HYD(12)|Hydraulic profile (software-specific)| |

Image 9.4: Time diagram of sequences

MOOG ID No.:CB40859-001 Date:11/2020

MSD ServoDrive - DeviceHelp 295

# 9 Inputs/Outputs settings

# 9 Inputs/Outputs settings

MOOG ID No.:CB40859-001 Date:11/2020

MSD ServoDrive - DeviceHelp 296

|Command|System state|
|---|---|
|① Starting lockout|ISDSH Safe Standstill (STO)|
|② Ready for start|ENPO EnablePower|
|③ On|Bit (0) = START(1)|
|④ Active control|Active control|

NOTE

l The electrical connection is made via terminals X4/20 (ISD05) and X4/21 (ISD06).

# 9.2.8 Pulse direction

Pulse direction can be realized using the MSD PLC or EGEAR (electrical gearing). With EGEAR, control is carried out in the control mode “Term (1) via terminals” as follows.

# Setting the control mode

Setting of the manner in which the control is to be carried out. Invoke Motion profile -> Basic setting. Set “Term (1) = set via terminals” under “Control via.” The setting for the reference under “Reference via” is irrelevant.

# Parameter setting for speed/direction

Set parameter P 1400 (MPRO_TP_config) to “PC_PC(4)” (= TP0, pulse counter, TP1, pulse counter). The speed, but not the direction, can be changed.

Setting P 1400 (MPRO_TP_config) to “PD_UP(2)” (TP0, TP1 as encoder; pulse (TP0) / direction (TP1), count up on direction high) means both the speed and the direction can be changed. To find out which setting is possible, see the description of the parameter. Parameter P 1404 (MPRO_TP_Lines) is used to set the resolution (pulses/revolution).

# Setting the digital standard inputs ISD05 and ISD06

NOTE

l If P 1404 (MPRO_TP_Lines) is not set [factory setting is 1 pulse = 1 revolution], then the gear ratio is important for the speed of the rotor.

# 9 Inputs/Outputs settings

Set the synchronization mode to “EGEAR_PARA(4) = Electronic gearing via

Image 9.7: Pulse direction master configuration parameters.”

In the screen, select “Electric gearing.”

Set the gear ratio.

Image 9.6: Set the EGEAR pulse direction

Select “Master configuration” in the screen.

Image 9.8: Selecting the electric gearing pulse direction

Set the channel selection and anti-reverse mode.

Enable the function with “Start E-Gear.”

# Selection options:

|TP0(6)|Pulse counter on probe channel 1 (TP0)|
|---|---|
|TP1(7)|Pulse counter on probe channel 1 (TP1)|

NOTE

l  The signals ISD06 and ISD05 are HTL signals, which is why the voltage level must be greater than 20 V. The frequency must not be higher than 300 kHz.

MOOG                        ID No.:CB40859-001 Date:11/2020

MSD ServoDrive - DeviceHelp    297

# 9 Inputs/Outputs settings

MOOG ID No.:CB40859-001 Date:11/2020

MSD ServoDrive - DeviceHelp 298

# 9.3 Digital Outputs

|ID|Index|Name|Unit|Description|
|---|---|---|---|---|
|122|0|MPRO_OUTPUT_FS_OSD00| |Function of digital output OSD00|
|123|0|MPRO_OUTPUT_FS_OSD01| |Function of digital output OSD01|
|124|0|MPRO_OUTPUT_FS_OSD02| |Function of digital output OSD02|
|142|0|MPRO_OUTPUT_INV| |Output inv. OSD0-2(0-2),MBRK(6),REL1/2(7/15),OED0-7(16-23)|

Table 9.7: “Digital standard outputs” parameters

# 9.3.2 Function selectors

|ID|Index|Name / Setting|Unit|Description|
|---|---|---|---|---|
|122-124|0|MPRO_OUTPUT_FS_OSDxx| |Function selectors for digital outputs|
| | |Off (0)| |No function|
| | |ERR (1)| |Collective error message|
| | |BRAKE (2)| |Motor brake: Output activated according to holding brake function|
| | |ACTIV (3)| |Power stage and control active|
| | |S_RDY (4)| |Device initialized: Output is activated when the device is initialized after power-on.|
| | |C_RDY (5)| |Control initialized: Output is activated when the device is "Ready to switch on" based on setting of the "ENPO" signal and no error message has occurred. Device ready - ReadyToSwitchOn flag in DriveCom status word set (in states 3, 4, 5, 6, 7)|
| | |REF (6)| |Target reached / Reference reached: The preset reference has been reached (dependent on control mode)|
| | |HOMATD (7)| |Homing point reached|
| | |E_FLW (8)| |Tracking error|
| | |ROT_R (9)| |Motor in standstill window when running right|
| | |ROT_L (10)| |Motor in standstill window when running left|
| | |ROT_0 (11)| |Motor in standstill window, depending on actual value|
| | |STOP (12)| |Drive in quickstop state|

Table 9.8: “Digital outputs” function selectors

# Table 9.8: “Digital outputs” function selectors (continue)

|ID|Index|Name / Setting|Unit|Description|ID|Index|Name / Setting|Unit|Description|
|---|---|---|---|---|---|---|---|---|---|
| |HALT (13)| | |The drive is in the HALT state: activated via CiA 402 profile, input or PROFIBUS IntermediateStop, SERCOS. Reaction according to HALT option code (P 2221[0] - MPRO_402_HaltOC).|COM_NC (40)| |Set output via field bus in NC cycle| | |
| |LIMIT (14)| | |Output is set when a reference value reaches its limit.|USER (41)| |Firmware-specific function| | |
| |T_GT_TX (15)| | |Torque greater than P 741[0]|TBREF (42)| |Selected table index executed (target reached)| | |
| |N_GT_NX (16)| | |Speed greater than P 740[0]|DS-TRIGGER (43)| |Digital Oscilloscope Trigger Event| | |
| |P_LIM_ACTIV (17)| | |Position reference limited (e.g. with parameterized software limit switches)|SM_REF (44)| |Target reached at synchronized motion| | |
| |N_LIM_ACTIV (18)| | |Speed reference limited|CAM_LINE_A (45)| |Cam switch track A| | |
| |T_LIM_ACTIV (19)| | |Torque reference limited|CAM_LINE_B (46)| |Cam switch track B| | |
| |(20)| | |Not defined|(47)| |Not defined| | |
| |ENMO (21)| | |Motor contactor output (if the motor is wired through a contactor)|(48)| |Not defined| | |
| |PLC (22)| | | |(49)| |Not defined| | |
| |WARN (23)| | |PLC sets output|(50)| |Not defined| | |
| |WUV (24)| | |Warning (Collective warning message) Warning: undervoltage in DC link|(51)| |Not defined| | |
| |WOV (25)| | |Warning: voltage overload in DC link|(52)| |Not defined| | |
| |WIIT (26)| | |Warning I2t power stage|(53)| |Not defined| | |
| |WOTM (27)| | |Warning overtemperature motor (only with KTY84-130, NTC, PT100 and PT1000)|(54)| |Brake chopper active state| | |
| |WOTI (28)| | |Servo Drive heat sink temperature warning|(55)| |Safe torque off (STO) active| | |
| |WOTD (29)| | |Servo Drive internal temperature warning|(56)| |Brake chopper error; triggered with negative edge| | |
| |WLIS (30)| | |Warning: current threshold reached|(57)| |Synchronous function of electronic gearing or cam active| | |
| |WLS (31)| | |Warning: speed threshold reached|(58)| |Logic link of “motor standstill” and "Not Ready to Switch on" state| | |
| |WIT (32)| | |Warning I2t motor protection|(59)| |Ready to switch on| | |
| |WLTQ (33)| | |Warning torque/force threshold reached|(60)| |Not defined| | |
| |TBACT (34)| | |Table positioning in "AUTO" and activated state|(61)| |Not defined| | |
| |TAB0 (35)| | |Actual table index 2^0|(62)| |Not defined| | |
| |TAB1 (36)| | |Actual table index 2^1|(63)| |Not defined| | |
| |TAB2 (37)| | |Actual table index 2^2|(64)| |Not defined| | |
| |TAB3 (38)| | |Actual table index 2^2|(65)| |Not defined| | |
| |COM_1MS (39)| | |Set output via field bus in 1 ms cycle|(70)| |Not defined| | |

MOOG ID No.:CB40859-001 Date:11/2020 MSD ServoDrive - DeviceHelp 299

# 9 Inputs/Outputs settings

MOOG                          ID No.:CB40859-001 Date:11/2020

|ID|Index|Name / Setting|Unit|Description|
|---|---|---|---|---|
| |(71)| | |Not defined|
| |(72)| | |Not defined|
| |(73)| | |Not defined|
|HYD_VAL_OPT1|(74)|Hydraulic control option 1|(software specific)| |
|HYD_VAL_OPT2|(75)|Hydraulic control option 2|(software specific)| |
|HYD_CYL_POS|(76)|Drive signal, extend hydraulic valve cylinder| | |
|HYD_CYL_NEG|(77)|Drive signal, retract hydraulic valve cylinder| | |
|HYD_LEAK_BYP|(78)|Drive signal, hydraulic valve bypass| | |
|HYD_VALVE_CD|(79)|Drive signal, hydraulic valve direction| | |
|DIS_ACT|(80)|switchover| |Fast discharge active|
|WBRC|(81)|Warning brake chopper overload| | |
|FR_ACT|(82)|Status “Fault reaction active”| | |
|F_ACT|(83)|Error active| | |
|ISD00|(84)|Status of ISD00| | |
|ISD01|(85)|Status of ISD01| | |
|ISD02|(86)|Status of ISD02| | |
|ISD03|(87)|Status of ISD03| | |
|ISD04|(88)|Status of ISD04| | |
|ISD05|(89)|Status of ISD05| | |
|ISD06|(90)|Status of ISD06| | |
|ISA00|(91)|Status of ISA00|(digital)| |
|ISA01|(92)|Status of ISA01|(digital)| |

# Table 9.8: “Digital outputs” function selectors (continue)

# 9.3.3 Relay outputs

- Relay output RELOUT1 is freely available, while the function of the second relay output, RELOUT2, is set and cannot be changed.
- There is a selector that can be used to assign a function to the relay output.
- Certain functions will only be available with specific function packages.

Depending on the configured function, the “Options...” button may become enabled. If it is, this button can be used to switch to a different screen directly and define the function’s exact behaviour there.

The relay output can be switched from “active-high” to “active-low” (bit 8 in P 142[0] - MPRO_OUTPUT_INV).

# NOTE

- Relay output RELOUT2 (P 127[0] - MPRO_OUTPUT_FS_RELOUT2) outputs the status of the STO function. Accordingly, it is set to "SH_S" and cannot be changed. Because of this, this output will not be shown on the screen.
- For basic information, as well as mandatory planning, wiring, commissioning and testing requirements for the STO function, see the “STO safety function description” for the MSD Servo Drive Single-Axis System, MSD Servo Drive Multi-Axis System and MSD Single-Axis Servo Drive Compact (ID No.: CB19388).

|ID|Index|Name|Unit|Description|
|---|---|---|---|---|
|126|0|MPRO_OUTPUT_FS_RELOUT1| |Function of digital output RELOUT1|
|127|0|MPRO_OUTPUT_FS_RELOUT2| |Function of dig. output RELOUT2 is fixed at 'Safety Hold'|
|142|0|MPRO_OUTPUT_INV| |Output inv. OSD0-2(0-2),MBRK(6),REL1/2(7/15),OED0-7(16-23)|

# Table 9.9: “Relay outputs” parameters

# 9.3.4 Digital input states

Clicking on the “Status of digital outputs” field on the input screen for the digital outputs will open a visualization showing the digital outputs’ states.

# 9 Inputs/Outputs settings

# Image 9.10: “Status of digital outputs” screen

# Image 9.11: Threshold definition

|ID|Index Name|Unit Description| |
|---|---|---|---|
|143|0|MPRO_OUTPUT_STATE|Status of digital outputs|

# Table 9.10: “Status of digital outputs” parameters

The "LIMIT(14)" function for a digital output signals when a setpoint has reached its limit. In this case the output is set. The limit values for maximum torque and maximum speed depend on the preset control system.

# 9.3.5 Reference reached REF(6)

If a digital output is set to “REF(6) = Target reached / Reference reached” for torque and speed control as well as positioning, a range can be defined in which the actual value may deviate from the reference without the "Reference reached REF(6)" message becoming inactive. Reference value fluctuations caused by reference input are thus taken into account.

# Torque control

Limit value monitoring becomes active when the torque reference exceeds the maximum torque (see Section "Limitations / Thresholds" on page 310).

# Speed control

Limit value monitoring becomes active when the speed reference value exceeds the maximum speed (see Section "Limitations / Thresholds" on page 310).

MOOG ID No.:CB40859-001 Date:11/2020

MSD ServoDrive - DeviceHelp 301

# 9 Inputs/Outputs settings

MOOG ID No.:CB40859-001 Date:11/2020

# MSD ServoDrive - DeviceHelp 302

# Positioning

NOTE

Limit value monitoring becomes active when the speed reference exceeds the maximum speed or the torque reference exceeds the maximum torque (see Section "Limitations / Thresholds" on page 310).

Additional times for the typical contact chatter on a contactor must be taken into account when specifying the time for timer P 148[0] - MPRO_DRVCOM_ENMO_Time. They may be several hundred ms, depending on contactor.

# Infinite positioning/speed mode

Monitoring is activated in infinite positioning (speed mode) when the speed reference has been reached. If an ongoing positioning operation is interrupted with "HALT", the "Reference reached" message is not sent in this phase. The message only appears after the actual target position has been reached.

# 9.3.7 Switching with motor contactor

Switching in the power cable should only be carried out in a de-energized state. Failure to follow this requirement may result in problems and damage (e.g. overvoltage or overcurrent shutdowns, pitted contacts). To ensure currentless switching, the contacts of the motor contactor must be closed before enabling the power stage. In the opposite case the contacts must remain closed until the power stage has been switched off.

Corresponding safety time periods for the motor contactor switching must be implemented in the control sequence of the machine or else the special "ENMO" software function of the servo drive must be employed.

A power contactor in the motor supply line can be directly controlled by the servo drive via parameter P 125[0] - MPRO_OUTPUT_FS_MOTOR_BRAKE = ENMO(21).

The timer P 148[0] - MPRO_DRVCOM_ENMO_Time defines the on-and-off delay of the power contactor. Based on the time delay, the reference value is applied after the power contactor is active. If the power stage is switched off, the power contactor isolates the motor from the controller.

# 9.4 Analog Inputs

- P 428[0] - ISA00 and P 428[1] - ISA01 can be used to assign an offset to each analog input separately. For more details on how to use offsets, see Section "Analog input scaling" on page 305.
- P 429[0] - ISA00_gain and P 429[1] - ISA01_gain can be used to assign a gain factor to each analog input separately. For more details on how to use gain factors, see Section "Analog input scaling" on page 305.
- P 429[2] - ISA00_limMin and P 429[3] - ISA01_limMin can be used to assign a lower limit to each analog input separately.
- P 429[4] - ISA00_limMax and P 429[5] - ISA01_limMax can be used to assign an upper limit to each analog input separately.
- The analog inputs’ compensated, filtered, and normalized values will be available in P 407 - CON_ANA_Isaf.
- P 665[0] - DV_CAL_IsaType can be used to configure the analog inputs as voltage or current inputs. This setting will apply to both inputs.

Image 9.12: “Function selector of the analog inputs” screen

# NOTE

# 9.4.1 Standard analog inputs

- The parameters are reinitialized only after the control has been re-enabled or by a device restart.
- There is a selector that can be used to assign a function to each analog standard input (P 109[0] - MPRO_INPUT_FS_ISA00 and P 110[0] - MPRO_INPUT_FS_ISA01). Certain functions will only be available with specific function packages.
- Depending on the configured function, the “Options...” button may become enabled. If it is, this button can be used to switch to a different screen directly and define the function’s exact behaviour there.
- Every analog input can be smoothed with a freely configurable filter time (P 405[0] - CON_ANA_Filt0 and P 406[0] - CON_ANA_Filt1).
- P 427[0] - CON_ANA_CalibZero can be used to trigger a zero correction routine for both analog inputs. If you use this routine, there must not be any voltage at the inputs.

|ID|Index Name|Unit|Description|
|---|---|---|---|
|109|0|MPRO_INPUT_FS_ISA00|Function of analog input ISA00|
|110|0|MPRO_INPUT_FS_ISA01|Function of analog input ISA01|
|405|0|CON_ANA_Filt0|ms Analog input ISA00: Filter time constant|
|406|0|CON_ANA_Filt1|ms Analog input ISA01: Filter time constant|
|407| |CON_ANA_Isaf|Analog inputs: Values (filt, norm, comp)|
|407|0|ISA00|Compensated, filtered, normalized value|
|407|1|ISA01|Compensated, filtered, normalized value|
|427|0|CON_ANA_CalibZero|Analog inputs: Calibration of analog channel|
|428| |CON_ANA_Offset|offset @zero input Analog inputs: Offset|
|428|0|ISA00|V Voltage offset for input ISA00|
|428|1|ISA01|V Voltage offset for input ISA01|
|429| |CON_ANA_Gain|Analog inputs: Gain scaling|

Table 9.11: “Analog inputs” parameters

MOOG ID No.:CB40859-001 Date:11/2020

MSD ServoDrive - DeviceHelp 303

# 9 Inputs/Outputs settings

# 9 Inputs/Outputs settings

MOOG                             ID No.:CB40859-001 Date:11/2020                                                                                                 MSD ServoDrive    - DeviceHelp       304

|ID|Index Name|Unit Description|ID|Index Name / Setting|Unit Description|
|---|---|---|---|---|---|
|429|0|ISA00_gain|Gain scaling for input ISA00|REFV (-2)|Analog reference|
|429|1|ISA01_gain|Gain scaling for input ISA01|(-1)|Not defined|
|429|2|ISA00_limMin|Minimum value for input ISA00|Off (0)|No function|
|429|3|ISA01_limMin|Minimum value for input ISA01|START (1)|Start motor control|
|429|4|ISA00_limMax|Maximum value for input ISA00|INV (2)|Inverse reference value|
|429|5|ISA01_limMax|Maximum value for input ISA01| | |
|665|0|DV_CAL_IsaType|Analog inputs: Switch between current/voltage|STOP (3)|Execute quickstop|
| | | | |HALT (4)|Disable feed|
| | | | |LCW (5)|Limit switch positive direction|
| | | | |LCCW (6)|Limit switch negative direction|
| | | | |INCH_P (7)|Jog Positive|
| | | | |INCH_N (8)|Jog Negative|
| | | | |HOMST (9)|Start homing|
| | | | |HOMSW (10)|Reference switch|
| | | | |E_EXT (11)|External error|
| | | | |WARN (12)|External warning|
| | | | |RSERR (13)|Reset alarm|
| | | | |MAN (14)|Switch control location selector|
|109-110|0|MPRO_INPUT_FS_|“Analog inputs” “function selectors”|(15)|Not defined|
| | |PRC_REF (-14)|Process controller reference value|PLC (16)|Used in PLC|
| | |PRC_ACT (-13)|Process controller actual value|PLC_IR (17)|PLC interrupt|
| | |ENC_ANA (-12)|Analog encoder (on channel 4)|MP_UP (18)|Motor potentiometer Negative|
| | |MP_DOWN (19)|Motor potentiometer Positive|(20) - (20)|Not defined|
| | |HYD_Q_ACT (-10)|Hydraulic actual flow (software specific)|TBEN (21)|Enable selected table index|
| | |HYD_P_ACT2 (-9)|Hydraulic actual pressure on 2nd sensor|TBTEA (22)|Write actual position into selected table index|
| | |HYD_Q_REF (-8)|Hydraulic reference flow (software specific)|TAB0 (23)|Binary table index 2^0|
| | |HYD_P_ACT (-7)|Hydraulic actual pressure (software specific)|TAB1 (24)|Binary table index 2^1|
| | |HYD_P_REF (-6)|Hydraulic reference pressure (software specific)|TAB2 (25)|Binary table index 2^2|
| | |VFC_REF_SCALE (-5)|VFC reference scaling 0-100% (software specific)|TAB3 (26)|Binary table index 2^3|
| | |TLIM (-4)|Analog torque limit 0-100%|EGEAR (27)|Start / stop Egear|
| | |OVR (-3)|Speed override 0-100% at positioning|(30)|Not defined|

# Table 9.11: “Analog inputs” parameters (continue)

# Table 9.12: “Analog inputs” function selectors

|ID|Index|Name / Setting|Unit|Description|
|---|---|---|---|---|
|(31)| |Not defined| |Change to input voltage range of analog torque scaling|
|(32)| |Not defined| |Change to input voltage range of speed override function|
|(33)| |Not defined| |Change to switching threshold of a digital input function|
|JOG_EXT_POS|(34)|Jog Positive (extended mode)| | |
|JOG_EXT_NEG|(35)|Jog Negative (extended mode)| | |
|FAST_DISC|(36)|Fast discharge| | |
|LIM_OFF|(37)|Limits (torque and velocity) off| | |
|LOCK_POS|(38)|Lock positive direction| | |
|LOCK_NEG|(39)|Lock negative direction| | |
|BRAKE_ON|(40)|Switch off motor break at once| | |
|PWR_REL_DIRECT|(41)|Direct activation of power relay (with 1000ms delay)| | |
|(42)| |Undocumented value| | |
|(43)| |Undocumented value| | |
|(44)| |Undocumented value| | |
|(45)| |Undocumented value| | |
|(46)| |Undocumented value| | |
|(47)| |Undocumented value| | |
|(48)| |Undocumented value| | |

# Table 9.12: “Analog inputs” function selectors (continue)

# 9.4.3 Analog input scaling

Analog input scaling makes it possible to convert the analog input value to the process variable by using a gain factor, offset and backlash. The illustration shows how the scaling function works. Entering the desired voltage ranges will yield the values for the offset (P 428 - CON_ANA_Offset) and gain (P 429 - CON_ANA_Gain).

Example: Analog torque scaling:

The standard setting for the controller is an input voltage range of 0 V to +10 V, corresponding to 0% to 100%. With this setting, any value between -10 V and 0 V corresponds to 0%.

Depending on the function selected for the ISAxx analog input with the function selector, it will be possible to use the “Options...” button to configure additional process variables such as “the backlash in rev/min” (when using an analog setpoint, REFV).

Say that you want an input voltage range of -10 V to +10 V, in which case -10 V would correspond to 0% of the torque and +10 V to 100% of the torque.

Inmin = -10 V, Outmin = 0 V

Inmax = +10 V, OUTmax = +10 V

MOOG ID No.:CB40859-001 Date:11/2020

MSD ServoDrive - DeviceHelp 305

# 9 Inputs/Outputs settings

# 9 Inputs/Outputs settings

MOOG ID No.:CB40859-001 Date:11/2020 MSD ServoDrive - DeviceHelp 306

# 9.4.4 Profile mode and analog inputs

Parameter P 301[0] - CON_REF_Mode determines whether the reference values are processed via the profile generator (setting “PG(0)”) or directly (setting “IP(1)”). If direct input via IP mode is selected, only the input filters are active. The analog values are scanned and filtered in the torque control cycle and then directly transferred as references for the speed or torque control.

CAUTION! Your system/motor may be damaged if put into operation in an uncontrolled or inappropriate manner. Improper conduct can cause damage to your system/machine.

Before the “Start” step, make absolutely sure that a valid setpoint has been entered, as the configured setpoint will be immediately transmitted to the motor after the motor control function starts, which may result in the motor accelerating unexpectedly.

# 9.4.5 Wire Break Monitoring

P 399 - CON_ANA_WireBrk_Th is used to define the wire break monitoring threshold (in V) (parameter index [0] for ISA00, parameter index [1] for ISA01). If the voltage falls below this limit an error message is generated. The error response can be configured using P 30[52] - Reac_Ana (see Section "Error reactions" on page 325).

|ID|Index Name|Unit|Description|
|---|---|---|---|
|399|CON_ANA_WireBrk_Th| |Analog inputs: Cable break detection limits|
|399|ISA00|V|Cable break detection limit for analog input ISA00|
|399|ISA01|V|Cable break detection limit for analog input ISA01|

NOTE

- If the analog inputs are used as feedback for control circuits, they will be sampled every 125 μs.
- If functions are assigned to the analog inputs using P 109[0]/P 110[0], the inputs will be sampled every 1 ms.
- By switching parameter P 301[0] - CON_REF_Mode from PG(0) to IP(1) mode, an analog input can be used as a "fast input" (e.g. Touch probe). The sampling time set in P 306[0] - CON_IpRefTS for the interpolation takes effect.

# 9.5 Analog outputs (option only for MSD Servo Drive)

# 9.5.1 Function selectors

|ID|Index|Name / Setting|Unit|Description|
|---|---|---|---|---|
|129, 130|0|MPRO_OUTPUT_FS_OEAxx| |Function selectors for analog outputs|
| | |OFF (0)| |No function|
| | |NACT(1)| |Actual speed|
| | |TACT(2)| |Actual torque/force|
| | |IRMS(3)| |Effective current|
| | |PARA (4)| |Value of parameter 134[0]|
| | |ACTPOS(5)| |Position actual value|
| | |VDC(6)| |DC link voltage|
| | |ACTPOS_MODULO(7)| |Actual modulo position|
| | |ACT_POWER(8)| |Power|
| | |APP_POWER(9)| |Apparent power|

Table 9.14: “Analog outputs” function selectors

NOTE

- For a full description of the analog outputs in the "CANopen+2AO" communication option (technical data, connections, configuration), see the "CANopen + 2 analog outputs Specification" (ID No.: CA79904-001).
- The technology option “CANopen + 2AO” is not available for MSD Single-Axis Servo Drive Compact.
- To determine whether your MSD Servo Drive comes with the "CANopen + 2AO" technology option, you can check the electronic rating plate (see Section "Electronic rating plate" on page 451).

MOOG ID No.:CB40859-001 Date:11/2020

MSD ServoDrive - DeviceHelp 307

# 9 Inputs/Outputs settings

# 9 Inputs/Outputs settings

MOOG ID No.:CB40859-001 Date:11/2020

MSD ServoDrive - DeviceHelp 308

# 9.6 Motor brake output

P 748[0] - MON_MotorBrkGuard can be used to activate a monitoring mechanism at the motor brake output that will monitor both wire breaks and current. The brake function can also be used in the other digital outputs, though without current and wire break monitoring.

If the output is set to BRAKE(2), the brake can be configured with the “Options...” button (see Section "Motor brake details" on page 309).

Image 9.15: “Motor brake settings” screen

|ID|Index Name|Unit|Description|
|---|---|---|---|
|125|0 MPRO_OUTPUT_FS_MOTOR_BRAKE| |Function of motor brake (X13)|
|748|0 MON_MotorBrkGuard| |Motor brake guarding|

NOTE

On the MSD Single-Axis Servo Drive Compact, the motor brake output for frame sizes 2 to 5 will be found on connector X13.

On the MSD Servo Drive (Single-Axis System and Multi-Axis System), the motor brake output...

- For frame sizes 1 to 4 will be found on connector X13
- For frame sizes 5 to 6a will be found on connector X20
- For frame size 7 will be found on connector X44

An optional holding brake built-in to motor provides protection against unwanted motion when the power is cut and in case of error. If the brake is mounted on the axis mechanism and not directly on the shaft, note that undesirably severe torsional forces may occur on sudden engagement of the brake.

The P 125[0] - MPRO_OUTPUT_FS_MOTOR_BRAKE function selector can be used to select any function (similar to those for the digital outputs) for the motor brake output. However, the special motor brake control section hardware will be used for the selected function.

However, when using a motor brake with P 125[0] - MPRO_OUTPUT_FS_MOTOR_BRAKE = BRAKE(2), the criteria for braking need to be defined. This criteria can consist of a variety of states, limits, threshold values, input signals, and fieldbus commands.

# 9.6.1 Motor brake details

| |ID|Index Name| |Unit|Description|
|---|---|---|---|---|---|
| |217|0|MPRO_BRK_LastTorqFact|%|Motor brake: factor for application of last torque|
| |218|0|MPRO_BRK_StartTorq|Nm|Motor brake: initial torque (constant)|
| |219|0|MPRO_BRK_LastTorq|Nm|Motor brake: torque sampled at last closing time|
| |220|0|MPRO_BRK_Lock| |lock brake|

Table 9.16: “Motor brake details” parameters (continue)

NOTE

Please check the settings of the stop ramps if use of a holding brake is specified (see Section "Stop ramps" on page 248).

Image 9.16: “Motor brake details” screen

The brake response can be adapted to the requirements of the application. This function can be used in both speed as well as position controlled operation.

| | | | |ID|Index Name|Unit|Description|
|---|---|---|---|---|---|---|---|
|213|0|MPRO_BRK_LiftTime|ms|Motor brake lift time| | | |
|214|0|MPRO_BRK_CloseTime|ms|Motor brake close time| | | |
|215|0|MPRO_BRK_RiseTime|ms|Motor brake: torque rise time| | | |
|216|0|MPRO_BRK_FadeTime|ms|Motor brake: Torque fade time| | | |

Table 9.16: “Motor brake details” parameters

MOOG ID No.:CB40859-001 Date:11/2020 MSD ServoDrive - DeviceHelp 309

# 9 Inputs/Outputs settings

# 10 Limitations / Thresholds

# Chapter overview

Pictogram

Navigation &nbsp;&nbsp;&nbsp;&nbsp; ►Project tree ►Device setup ►Limits / thresholds

# Brief description

This chapter describes the available limits and threshold values for the MSD Servo Drive and MSD Single-Axis Servo Drive Compact.

# Contents

- 10.1 Settings &nbsp;&nbsp;&nbsp;&nbsp; 310
- 10.2 Torque- / force limits &nbsp;&nbsp;&nbsp;&nbsp; 311
- 10.3 Speed- / velocity limits &nbsp;&nbsp;&nbsp;&nbsp; 312
- 10.4 Position limitation &nbsp;&nbsp;&nbsp;&nbsp; 312
- 10.5 Power stage &nbsp;&nbsp;&nbsp;&nbsp; 313

Image 10.1: “Limitations and thresholds” screen

To protect the device, the motor and the complete plant it is necessary to limit the variables torque, speed and position. These limits act independently of other limitations within the motion profile.

The limits are specified as percentages of the rated quantities (current, torque, speed,...), so that following calculation logical default settings are available. The defaults relate to 100% of the ratings. The parameters must therefore be adapted to application and motor. The motor quantity limits can be read out in P 338[0] - CON_SCON_ActMax.

# Limitations in closed-loop controlled mode

MOOG ID No.:CB40859-001 Date:11/2020

MSD ServoDrive - DeviceHelp 310

# 10 Limitations / Thresholds

# MOOG

ID No.: CB40859-001 Date: 11/2020

# MSD ServoDrive - DeviceHelp

l Torque- / force limits

l Speed- / velocity limits

l Position limitation

l The torque is limited to a maximum by P 329[0] - CON_SCON_TMax. In the default setting the torque limit corresponds to the rated torque of the motor.

l Power stage (see Section "Power stage" on page 313)

The possible setting range is 0-1000 %. The parameter can be changed during operation.

P 745 - MON_RefWindow and P 746[0] - MON_UsrPosWindow indicate the status of the configured limits and are incorporated into the general P 151[0] - MPRO_DRVCOM_STAT_DWord status word.

P 737[0] - MON_MNCTL and P 737[1] - MON_MNSTAT can be used to monitor and output the status of the mains connection.

|ID|Index Name|Unit|Description|
|---|---|---|---|
|338|CON_SCON_ActMax|Motor control limits| |
|338|Max_Speed_Motor|rpm|Maximum motor speed|
|338|Max_Current_Motor|A|Maximum motor current|
|338|Max_Torque_Motor|Nm|Maximum motor torque|
|338|Max_UsrSpeed_Motor|rev/min|Maximum motor speed in user units|
|338|MaxCurrent_Inverter|A|Maximum current @ actual voltage level|
|338|Reserved|-|switching freq.|
|338|Reserved|-|Reserved|
|338|MaxCurrent_Limit|A|Maximum current limit (motor or inverter)|

|ID|Index Name|Unit|Description|
|---|---|---|---|
|737|MON_MNCTL| |Monitoring control and status word|
|737|MON_MNCTL| |Monitoring control word|
|737|MON_MNSTAT| |Monitoring status word|
|745|MON_RefWindow| |Speed Setpoint reached window|
|745|TargetReached|rpm|Window for speed control target reached|
|745|Standstill|rpm|Window for motor standstill|
|745|TorqueTargetReached|Nm|Window for torque target reached|
|745|Hyst. TargetReached|rpm|Hysteresis window for speed control target reached|
|745|Hyst. Standstill|rpm|Hysteresis window for speed control standstill|
|746|MON_UsrPosWindow|mDegree|Setpoint reached pos. window|

Table 10.2: “Limits / thresholds - Torque / force limits” parameters

NOTE

l When using homing methods -8, -9, -10, and -11, P 332[0] - CON_SCON_TMaxScale is replaced by P 225[0] - MPRO_REF_HOMING_TMaxScale.

l To protect against overspeed if a requested torque is not reached, P 337[0] - CON_SCON_SMaxScale is used to limit the speed controller to a percentage of the rated speed.

# 10.3 Speed- / velocity limits

- P 328[0] - CON_SCON_SMax can be used to set the maximum speed limit. In the default setting the speed limit is the same as the rated speed of the motor. The possible setting range is 0-2000%. The parameter cannot be changed during operation. A change is only effective after restarting the control.
- P 337[0] - CON_SCON_SMaxScale enables the torque limit set in P 328[0] to be scaled online – that is, during operation.
- It is additionally possible via P 333[0] - CON_SCON_TMaxNeg and P 334[0] - CON_SCON_TMaxPos to change the torque limit for different directions of rotation during operation.
- P 744[0] - MON_SDiffMax is used to specify the permissible difference between the setpoint speed and the actual speed (tracking error) in revolutions.
- P 745[0] - MON_RefWindow is used to define the point at which the setpoint is considered to have been reached.

|ID|Index|Name|Unit|Description|
|---|---|---|---|---|
|167|0|MPRO_REF_OVR|%|Motion profile override factor|
|328|0|CON_SCON_SMax|%|Speed control maximum speed|
|333|0|CON_SCON_SMaxNeg|%|Scaling of negative motor speed limit|
|334|0|CON_SCON_SMaxPos|%|Scaling of positive motor speed limit|
|335|0|CON_SCON_DirLock| |Direction lock for speed reference value|
|337|0|CON_SCON_SMaxScale|%|Scaling of motor speed limit|
|740|0|MON_SpeedThresh|rpm|Monitoring speed threshold|
|744|0|MON_SDiffMax|rpm|Speed tracking error|

Table 10.3: “Limits / thresholds - Speed limits” parameters

MOOG ID No.:CB40859-001 Date:11/2020

# 10 Limitations / Thresholds

# 10.4 Position limitation

- Position limiting is only applicable in positioning mode and will be enabled only once homing is successfully completed (see Section "Homing" on page 249).
- P 2235[0] - MPRO_402_SoftwarePosLimit is used to define the lower position limit. P 2235[1] - MPRO_402_SoftwarePosLimit is used to define the upper position limit. This function is also referred to as “software limit switches”.
- In addition, P 743[0] - MON_UsrPosDiffMax can be used to define the maximum tracking error.
- P 746[0] - MON_UsrPosWindow can be used to define the zero speed window (position setpoint reached).

Positioning mode

Before enabling an absolute motion task, a check is made whether the target is in the valid range – that is, within the software limit switches. If the target is outside, no motion task is signalled and the programmed error reaction as per P 30 Error Reactions is executed.

This mode can only be used when using speed-controlled operation. The drive travels until a software limit switch is detected. Then the programmed error reaction is executed.

Table 10.4: Positioning mode

MSD ServoDrive - DeviceHelp 312

# 10 Limitations / Thresholds

MOOG ID No.:CB40859-001 Date:11/2020

|ID|Index Name|Unit|Description|
|---|---|---|---|
|224|0|MPRO_REF_|Target reached option code|
|743|0|TargetReachedOpC| |
| |MON_UsrPosDiffMax|mDegree|Position difference threshold|
|2235| |MPRO_402_|607DH DS402 software position limit (SW limit switch)|
|2235|0|SoftwarePosLimit|Minimum position limit (negative software limit switch)|
|2235|1|MPRO_402_|mDegree Maximum position limit (positive software limit switch)|
|746|0|SoftwarePosLimit| |

Table 10.5: “Limits / thresholds - Position limits” parameters

NOTE

- The response when a position limit is reached (P 2235 - MPRO_402_SoftwarePosLimit) will depend on the error response that has been configured (see Section "Error reactions" on page 325).

# 10.5 Power stage

- If the value for the DC link voltage exceeds the value set in parameter P 747 [0] - MON_PF_OnLimit, error ERR-34 "Power failure detected" is reported and the parameterized error reaction is triggered (see Section "Error reactions" on page 325).
- By setting a quickstop as the error reaction in the parameters using an adequately steep deceleration ramp, the DC link voltage can be maintained above the undervoltage threshold (see Section "Power failure bridging" on page 28). This reaction lasts until the drive has been braked to a lower speed.

|ID|Index Name|Unit|Description|
|---|---|---|---|
|747|0|MON_PF_ONLimit|V Voltage limit for power failure|
|749|0|MON_DevOverVoltage|V Overvoltage DC-link|
|750| |MON_CurrToGround|Fault current|
|750|0|Current to ground|A Maximum fault current to ground|
|750|1|Current in power-off|A Maximum fault current in power-off|
|757|0|MON_PwrActVal_Tf|ms Filter time constant for actual power values|

Table 10.6: “Limits / thresholds - Power stage” parameters

# 11 Alarms & warnings

# 11.1 Warning status

The status for the most important warnings can be checked with...

The “Warnings” pictogram on the quick launch toolbar or via

►Project tree ►Device setup ►Alarms & warnings ►Warning status.

A visual representation of the most important bits in status word P 34[0] - ERR_WRN_State will appear.

As soon as there is a warning, the corresponding bit will be set in status word P 34[0] and the visual representation will display it in the form of an LED with a solid light. The bits can also be displayed and recorded over time in the form of an oscilloscope signal.

The individual trigger thresholds for setting and resetting a warning are defined in P 730 - MON_WarningLevel (see Section "Warning thresholds" on page 323).

# Contents

- 11.1 Warning status 314
- 11.2 Alarms and warnings (Details) 316
- 11.3 Warning thresholds 323
- 11.4 Error display 324
- 11.5 Error reactions 325
- 11.6 Error list 328

MOOG ID No.:CB40859-001 Date:11/2020

MSD ServoDrive - DeviceHelp 314

# 11 Alarms & warnings

MOOG ID No.:CB40859-001 Date:11/2020

# MSD ServoDrive - DeviceHelp 315

|Bit-No.|Meaning|
|---|---|
|(0)|I2xt integrator (motor) warning threshold exceeded|
|(1)|Heat sink temperature|
|(2)|Motor temperature|
|(3)|Interior temperature|
|(4)|Reserved for SERCOS|
|(5)|Excessive speed|
|(6)|Reserved for SERCOS|
|(7)|Reserved for SERCOS|
|(8)|Reserved for SERCOS|
|(9)|Undervoltage|
|(10)|Reserved for SERCOS|
|(11)|Reserved for SERCOS|
|(12)|Reserved for SERCOS|
|(13)|Reserved for SERCOS|
|(14)|Reserved for SERCOS|
|(15)|Reserved for SERCOS|

Image 11.1: Warning status window

# Table 11.1: “Warning status” parameters

|ID|Index Name|Unit|Description|
|---|---|---|---|
|34|0|ERR_WRN_State|Device warning status word|

# Table 11.2: Device warning status word

|(16)|I2xt integrator (device) exceeded|
|---|---|
|(17)|Monitoring of apparent current|
|(18)|Overvoltage|

# 11.2 Alarms and warnings (Details)

|Bit-No.|Meaning|
|---|---|
|(19)|Protection of brake chopper, warning threshold exceeded|
|(20)|Overtorque|
|(21)|Spindle monitoring|
|(22)|Reserved|
|(23)|Reserved|
|(24)|Speed reference limitation active|
|(25)|Current reference limitation|
|(26)|Right limit switch active|
|(27)|Left limit switch active|
|(28)|External warning via input|
|(29)|Software limit switches positive|
|(30)|Software limit switches negative|
|(31)|Reserved|

To open an overview of the current error and a history containing the most recent 20 errors, go to ►Project tree ►Device setup ►Alarms & warnings ►Alarms & warnings (Details). The screen will also show a counter for the most common errors.

To view the entire P 34[0] status word at once, double-click on the list.

- P 33 - ActualError will describe the current error in detail, including a timestamp, the probable cause, potential fixes, etc.
- P 39[0] - ERR_ErrorID will contain the error code, which provides information regarding the error location and error type of the current error.
- P 71 - ActualErrorExt will contain information on the state of the Servo Drive at the time the current error occurred, e.g. current, voltage, speed, temperatures.

Image 11.2: Status word P 34[0] visual representation

MOOG ID No.:CB40859-001 Date:11/2020 MSD ServoDrive - DeviceHelp 316

# 11 Alarms & warnings

MOOG ID No.:CB40859-001 Date:11/2020 MSD ServoDrive - DeviceHelp 317

P 31 - ErrorStack and P 70 - ErrorStackExt will contain the history with the most recent 20 errors along with the contents from P 33 and P 71. P 31 - ErrorStack and P 70 - ErrorStackExt can also be displayed as tables (see).

P 72 - ErrorAbsCount is a counter for various pre-defined error events.

|ID|Index Name|Unit|Description|
|---|---|---|---|
|31|ErrorStack|Error history of device| |
|31|0|Cause|Error cause|
|31|1|Remedy|Error remedy|
|31|2|ID|Error id|
|31|3|Location|Error location|
|31|4|Time|Time stamp|
|31|5|CommentId|Additional comment (id)|
|31|6|CommentText|Additional comment (text)|
|31|7|Line|Line of error occurrence|
|31|8|File|Source / File|
|31|9|Cause|Error cause|
|31|10|Remedy|Error remedy|
|31|11|ID|Error id|
|31|12|Location|Error location|
|31|13|Time|Time stamp|
|31|14|CommentId|Additional comment (id)|
|31|15|CommentText|Additional comment (text)|
|31|16|Line|Line of error occurrence|
|31|17|File|Source / File|
|31|18|Cause|Error cause|
|31|19|Remedy|Error remedy|
|31|20|ID|Error id|
|31|21|Location|Error location|
|31|22|Time|Time stamp|
|31|23|CommentId|Additional comment (id)|
|31|24|CommentText|Additional comment (text)|
|31|25|Line|Line of error occurrence|

Table 11.3: “Alarms & warnings (Details)” parameters

|ID|Index Name|Unit|Description|ID|Index Name|Unit|Description|
|---|---|---|---|---|---|---|---|
|31|59|CommentId|Additional comment (id)|31|92|ID|Error id|
|31|60|CommentText|Additional comment (text)|31|93|Location|Error location|
|31|61|Line|Line of error occurrence|31|94|Time|Time stamp|
|31|62|File|Source / File|31|95|CommentId|Additional comment (id)|
|31|63|Cause|Error cause|31|96|CommentText|Additional comment (text)|
|31|64|Remedy|Error remedy|31|97|Line|Line of error occurrence|
|31|65|ID|Error id|31|98|File|Source / File|
|31|66|Location|Error location|31|99|Cause|Error cause|
|31|67|Time|Time stamp|31|100|Remedy|Error remedy|
|31|68|CommentId|Additional comment (id)|31|101|ID|Error id|
|31|69|CommentText|Additional comment (text)|31|102|Location|Error location|
|31|70|Line|Line of error occurrence|31|103|Time|Time stamp|
|31|71|File|Source / File|31|104|CommentId|Additional comment (id)|
|31|72|Cause|Error cause|31|105|CommentText|Additional comment (text)|
|31|73|Remedy|Error remedy|31|106|Line|Line of error occurrence|
|31|74|ID|Error id|31|107|File|Source / File|
|31|75|Location|Error location|31|108|Cause|Error cause|
|31|76|Time|Time stamp|31|109|Remedy|Error remedy|
|31|77|CommentId|Additional comment (id)|31|110|ID|Error id|
|31|78|CommentText|Additional comment (text)|31|111|Location|Error location|
|31|79|Line|Line of error occurrence|31|112|Time|Time stamp|
|31|80|File|Source / File|31|113|CommentId|Additional comment (id)|
|31|81|Cause|Error cause|31|114|CommentText|Additional comment (text)|
|31|82|Remedy|Error remedy|31|115|Line|Line of error occurrence|
|31|83|ID|Error id|31|116|File|Source / File|
|31|84|Location|Error location|31|117|Cause|Error cause|
|31|85|Time|Time stamp|31|118|Remedy|Error remedy|
|31|86|CommentId|Additional comment (id)|31|119|ID|Error id|
|31|87|CommentText|Additional comment (text)|31|120|Location|Error location|
|31|88|Line|Line of error occurrence|31|121|Time|Time stamp|
|31|89|File|Source / File|31|122|CommentId|Additional comment (id)|
|31|90|Cause|Error cause|31|123|CommentText|Additional comment (text)|
|31|91|Remedy|Error remedy|31|124|Line|Line of error occurrence|

# Table 11.3: “Alarms & warnings (Details)” parameters (continue)

MOOG ID No.:CB40859-001 Date:11/2020

MSD ServoDrive - DeviceHelp 318

# 11 Alarms & warnings

# 11 Alarms & warnings

# MOOG

ID No.: CB40859-001 Date: 11/2020

# MSD ServoDrive - DeviceHelp

|ID|Index Name|Unit|Description|
|---|---|---|---|
|31|125| |File|
|31|126| |Cause|
|31|127| |Remedy|
|31|128| |ID|
|31|129| |Location|
|31|130| |Time|
|31|131| |CommentId|
|31|132| |CommentText|
|31|133| |Line|
|31|134| |File|
|31|135| |Cause|
|31|136| |Remedy|
|31|137| |ID|
|31|138| |Location|
|31|139| |Time|
|31|140| |CommentId|
|31|141| |CommentText|
|31|142| |Line|
|31|143| |File|
|31|144| |Cause|
|31|145| |Remedy|
|31|146| |ID|
|31|147| |Location|
|31|148| |Time|
|31|149| |CommentId|
|31|150| |CommentText|
|31|151| |Line|
|31|152| |File|
|31|153| |Cause|
|31|154| |Remedy|
|31|155| |ID|
|31|156| |Location|
|31|157| |Time|

# ActualError

|ID|Index Name|Unit|Description|
|---|---|---|---|
|33|0| |Cause|
|33|1| |Remedy|
|33|2| |ID|
|33|3| |Location|
|33|4|s|Time|
|33|5| |CommentId|
|33|6| |CommentText|
|33|7| |Line|
|33|8| |Source file of error|

Table 11.3: “Alarms & warnings (Details)” parameters (continue)

# 11 Alarms & warnings

|ID|Index Name|Unit|Description|
|---|---|---|---|
|26|TimePowerStage| |Power stage time stamp of error event|
|27|Current|A|Actual current|
|28|Voltage|V|Actual DC voltage|
|29|ActSpeed|1/min|Actual speed|
|30|Temp_KK|deg C|Absolute temperature of cooling block|
|31|Temp_Int|deg|Absolute temperature of interior|
|32|Count|C|"Counter, if same error occurs again"|
|33|DriveComState| |Actual DriveComState|
|34|TimePowerStage| |Power stage time stamp of error event|
|35|Current|A|Actual current|
|36|Voltage|V|Actual DC voltage|
|37|ActSpeed|1/min|Actual speed|
|38|Temp_KK|deg C|Absolute temperature of cooling block|
|39|Temp_Int|deg|Absolute temperature of interior|
|40|Count|C|"Counter, if same error occurs again"|
|41|DriveComState| |Actual DriveComState|
|42|TimePowerStage| |Power stage time stamp of error event|
|43|Current|A|Actual current|
|44|Voltage|V|Actual DC voltage|
|45|ActSpeed|1/min|Actual speed|
|46|Temp_KK|deg C|Absolute temperature of cooling block|
|47|Temp_Int|deg|Absolute temperature of interior|
|48|Count|C|"Counter, if same error occurs again"|
|49|DriveComState| |Actual DriveComState|
|50|TimePowerStage| |Power stage time stamp of error event|
|51|Current|A|Actual current|
|52|Voltage|V|Actual DC voltage|
|53|ActSpeed|1/min|Actual speed|
|54|Temp_KK|deg C|Absolute temperature of cooling block|

MOOG ID No.:CB40859-001 Date:11/2020

# 11 Alarms & warnings

# MOOG

ID No.: CB40859-001 Date: 11/2020

# MSD ServoDrive - DeviceHelp

|ID|Index Name|Unit|Description|ID|Index Name|Unit|Description|
|---|---|---|---|---|---|---|---|
|70|55|Temp_Int|deg|70|82|TimePowerStage|Power stage time stamp of error event|
|70|56|Count| |70|83|Current|A|
|70|57|DriveComState| |70|84|Voltage|V|
|70|58|TimePowerStage|Power stage time stamp of error event|70|85|ActSpeed|1/min|
|70|59|Current|A|70|86|Temp_KK|deg|
|70|60|Voltage|V|70|87|Temp_Int|deg|
|70|61|ActSpeed|1/min|70|88|Count| |
|70|62|Temp_KK|deg|70|89|DriveComState| |
|70|63|Temp_Int|deg|70|90|TimePowerStage|Power stage time stamp of error event|
|70|64|Count| |70|91|Current|A|
|70|65|DriveComState| |70|92|Voltage|V|
|70|66|TimePowerStage|Power stage time stamp of error event|70|93|ActSpeed|1/min|
|70|67|Current|A|70|94|Temp_KK|deg|
|70|68|Voltage|V|70|95|Temp_Int|deg|
|70|69|ActSpeed|1/min|70|96|Count| |
|70|70|Temp_KK|deg|70|97|DriveComState| |
|70|71|Temp_Int|deg|70|98|TimePowerStage|Power stage time stamp of error event|
|70|72|Count| |70|99|Current|A|
|70|73|DriveComState| |70|100|Voltage|V|
|70|74|TimePowerStage|Power stage time stamp of error event|70|101|ActSpeed|1/min|
|70|75|Current|A|70|102|Temp_KK|deg|
|70|76|Voltage|V|70|103|Temp_Int|deg|
|70|77|ActSpeed|1/min|70|104|Count| |
|70|78|Temp_KK|deg|70|105|DriveComState| |
|70|79|Temp_Int|deg|70|106|TimePowerStage|Power stage time stamp of error event|
|70|80|Count| |70|107|Current|A|
|70|81|DriveComState| |70|108|Voltage|V|
|70|82|TimePowerStage|Power stage time stamp of error event|70|109|ActSpeed|1/min|
|70|83|Current|A|70|110|Temp_KK|deg|

Table 11.3: “Alarms & warnings (Details)” parameters (continue)

# 11 Alarms & warnings

|ID|Index Name|Unit|Description|ID|Index Name|Unit|Description|
|---|---|---|---|---|---|---|---|
|70|111|Temp_Int|deg|70|138|TimePowerStage|Power stage time stamp of error event|
|70|112|Count| |70|139|Current|A|
|70|113|DriveComState| |70|140|Voltage|V|
|70|114|TimePowerStage|Power stage time stamp of error event|70|141|ActSpeed|1/min|
|70|115|Current|A|70|142|Temp_KK|deg|
|70|116|Voltage|V|70|143|Temp_Int|deg|
|70|117|ActSpeed|1/min|70|144|Count| |
|70|118|Temp_KK|deg|70|145|DriveComState| |
|70|119|Temp_Int|deg|70|146|TimePowerStage|Power stage time stamp of error event|
|70|120|Count| |70|147|Current|A|
|70|121|DriveComState| |70|148|Voltage|V|
|70|122|TimePowerStage|Power stage time stamp of error event|70|149|ActSpeed|1/min|
|70|123|Current|A|70|150|Temp_KK|deg|
|70|124|Voltage|V|70|151|Temp_Int|deg|
|70|125|ActSpeed|1/min|70|152|Count| |
|70|126|Temp_KK|deg|70|153|DriveComState| |
|70|127|Temp_Int|deg|70|154|TimePowerStage|Power stage time stamp of error event|
|70|128|Count| |70|155|Current|A|
|70|129|DriveComState| |70|156|Voltage|V|
|70|130|TimePowerStage|Power stage time stamp of error event|70|157|ActSpeed|1/min|
|70|131|Current|A|70|158|Temp_KK|deg|
|70|132|Voltage|V|70|159|Temp_Int|deg|
|70|133|ActSpeed|1/min|71| |ActualErrorExt|Extended actual device error|
|70|134|Temp_KK|deg|71|0|DriveComState|Actual DriveComState|
|71|1|ActualTimePowerStageValue|Power stage time stamp of error event|71|2|Current|A|
|71|3|Voltage|V|71|4|ActSpeed|1/min|
|71|5|Temp_KK|deg| | | | |

Table 11.3: “Alarms & warnings (Details)” parameters (continue)

MOOG                          ID No.:CB40859-001 Date:11/2020                                                                                            MSD ServoDrive   - DeviceHelp      322

# 11 Alarms & warnings

MOOG ID No.:CB40859-001 Date:11/2020 MSD ServoDrive - DeviceHelp 323

|ID|Index Name|Unit|Description|
|---|---|---|---|
|71|6|Temp_Int|deg C Absolute temperature of interior|
|72|ErrorAbsCount| |Absolute error counters|
|72|0|Over voltage|Overvoltage|
|72|1|Over current|Overcurrent|
|72|2|Inverter overtemp.|Overheating|
|72|3|Device overtemp.|Overheating|
|72|4|I2t power amplifier|I2t power amplifier or chopper absolute errors|
|72|5|-|errors|
|72|6|-|Reserved|
|72|7|-|Reserved|

# 11.3 Warning thresholds

|ID|Index Name|Unit|Description|
|---|---|---|---|
|730|MON_WarningLevel| |Warning levels|
|730|0|UnderVoltage_ON|V DC link undervoltage|
|730|1|UnderVoltage_OFF|V DC link undervoltage|
|730|2|OverVoltage_ON|V DC link Overvoltage|
|730|3|OverVoltage_OFF|V DC link Overvoltage|
|730|4|I_ON|A Motor current|
|730|5|I_OFF|A Motor current|
|730|6|DeviceI2t_ON|% I²xt device protection|
|730|7|DeviceI2t_OFF|% I²xt device protection|
|730|8|MotorI2t_ON|% I²xt motor protection|
|730|9|MotorI2t_OFF|% I²xt motor protection|
|730|10|Torque_ON|Nm Torque limit reached|
|730|11|Torque_OFF|Nm Torque limit reached|
|730|12|Speed_ON|rpm Speed limit reached|
|730|13|Speed_OFF|rpm Speed limit reached|
|730|14|TC_ON|degC Maximum heat sink temperature reached|
|730|15|TC_OFF|degC Maximum heat sink temperature reached|
|730|16|Tint_ON|degC Maximum interior temperature reached|
|730|17|Tint_OFF|degC Maximum interior temperature reached|
|730|18|MotorTemp_ON X5|degC Maximum motor temperature reached (temperature sensor on X5)|
|730|19|MotorTemp_OFF X5|degC Maximum motor temperature reached (temperature sensor on X5)|
|730|20|MotorTemp_ON X6|degC Maximum motor temperature reached (temperature sensor on X6)|
|730|21|MotorTemp_OFF X6|degC Maximum motor temperature reached (temperature sensor on X6)|

# Table 11.4: “Warning thresholds” parameters

# 11.4 Error display

There are a number of ways of displaying an error message. An error message is indicated on the display of the servo drive (display D1/D2) or via the Moog DRIVEADMINISTRATOR 5. It provides a user-friendly readout in the "Device status" window.

# 11.4.1 Servo Drive display

The display on the Servo Drive shows the various device states and possible error messages. Two 7-segment displays are available for this purpose. To display an error number and an error, "ER" for Error flashes, then the error number, and then the number of the error location.

Example: ER ►16 ►01

|Display|Function|
|---|---|
|Attention – error message| |
|Errors marked with a dot on the display (D1/D2) can only be reset when the cause of the fault has been eliminated.| |
|Maximum speed exceeded| |

# 11.4.2 Display in the Moog DRIVEADMINISTRATOR 5

Image 11.4: Error display in the Moog DRIVEADMINISTRATOR 5

MOOG ID No.:CB40859-001 Date:11/2020

MSD ServoDrive - DeviceHelp 324

# 11 Alarms & warnings

# 11 Alarms & warnings

MOOG ID No.:CB40859-001 Date:11/2020 MSD ServoDrive - DeviceHelp 325

Immediately after an error occurs, it will be shown in a window. After closing the window by clicking on “Quit error” or “Later,” you can view the current error and the 20 most recent errors (see Section "Alarms and warnings (Details)" on page 316).

# 11.5 Error reactions

l P 30 - ErrorReactions is used to define how the Servo Drive will respond in the event of an error. These responses are defined individually for 62 different error scenarios. A selection of up to nine different responses will be available (see Section "Error reactions" on page 325).

l P 38[0] - ERR_Specific2OptCode can be used to define an additional error response if the Servo Drive features an optional function package.

|Error reaction|Function|
|---|---|
|Ignore (0)|Exception: For the HW limit switch, in which case a warning will be generated (P 34 bit 29 or bit 30)|
| |The error will be reported; the response will be carried out by the integrated PLC (V2.0 and higher)|
| |Exception: For the HW limit switch, in which case a warning will be generated (P 34 bit 29 or bit 30) and there will be a STOP request (deceleration with ramp depending on the STOP option code, without any change to the DRIVECOM system state). At standstill the relevant direction is blocked as long as the limit switch is active.|
|Specific1 (1)| |
|Specific2 (2)|The error will be reported; the response will be carried out by an external controller|

Table 11.6: Error reactions

# Error reaction

|ID|Index Name|Unit|Description|
|---|---|---|---|
|30|Reac_NoError| |Error reaction on "no error"|
|30|Reac_RunTimeError| |Error reaction on "runtime error"|
|30|Reac_ParaList| |Error reaction on "parameter list error"|
|30|Reac_Off| |Error reaction on “undervoltage” in DC link|
|30|Reac_OverVoltage| |Error reaction on “overvoltage” in DC link|
|30|Reac_OverCurrent| |Error reaction on "overcurrent"|
|30|Reac_OvertempMotor| |Error reaction on "over temperature motor"|
|30|Reac_OvertempInverter| |Error response: Power stage overtemperature|
|30|Reac_OvertempDevice| |Error response: Internal overtemperature|
|30|Reac_I2tMotor| |Error reaction: I2T error, motor|
|30|Reac_I2tPowerAmplifier| |Error response: Power stage I2T error|
|30|Reac_External| |Error response: External error|
|30|Reac_ComOptCan| |Error response: CAN communication option|
|30|Reac_ComOptSercos| |Error response: Sercos communication option|
|30|Reac_ComOptEtherCAT| |Error response: EtherCAT® communication option|
|30|Reac_Parameter| |Error response: Parameter error|
|30|Reac_SpeedDiff| |Error response: Speed tracking error|
|30|Reac_PositionDiff| |Error response: Position tracking error|
|30|Reac_MotionControl| |Error response: Control error|
|30|Reac_FatalError| |Error response: Fatal device error|
|30|Reac_HardwareLimitSwitch| |Error response: Hardware limit switch|
|30|Reac_Init| |Error response: Encoder initialization|
|30|Reac_EncCH1Init| |Error response: Channel 1 initialization encoder error|
|30|Reac_EncCH2Init| |Error response: Channel 2 initialization encoder error|
|30|Reac_EncCH3Init| |Error response: Channel 3 initialization encoder error|
|30|Reac_EncoderCycl| |Reaction on "encoder error, common, cyclic in process"|
|30|Reac_EncCH1Cycl| |Reaction on "encoder error, channel 1, cyclic in process"|

# Table 11.6: Error reactions (continue)

# Table 11.7: Parameters “Error reactions”

MOOG ID No.:CB40859-001 Date:11/2020

MSD ServoDrive - DeviceHelp 326

# 11 Alarms & warnings

# 11 Alarms & warnings

MOOG ID No.:CB40859-001 Date:11/2020 MSD ServoDrive - DeviceHelp 327

|ID|Index Name|Unit|Description|ID|Index Name|Unit|Description|
|---|---|---|---|---|---|---|---|
|30|27|Reac_EncCH2Cycl|Reaction on "encoder error, channel 2, cyclic in process"|30|54|Reac_GridFailure|Reaction on "power grid failure (by detection circuit)"|
|30|28|Reac_EncCH3Cycl|Reaction on "encoder error, channel 3, cyclic in process"|30|55|Reac_SpeedGuard|Reaction on "speed guarding error"|
|30|29|Reac_TC|Error response: Hardware error|30|56|Reac_MagBearing|Reaction on "magnetic bearing error"|
|30|30|Reac_InitCon|Error response: Control initialization|30|57|Reac_Hydraulic|Reaction on "error from Hydraulic system"|
|30|31|Reac_PLC|Reaction on "external PLC program"|30|58|Reac_FPGAMod|Reaction on "error from FPGA Modulator control"|
|30|32|Reac_ComOptDp|Error response: PROFIBUS DP communication option|30|59|Reac_ClampMonitoring|Reaction on "error from Spindle Clamp Monitoring"|
|30|33|Reac_Timing|Reaction on "internal timing error"|30|60|Reac_Reserved|Reserved|
|30|34|Reac_PowerFail|Error response: Power failure|30|61|Reac_EncMultiturnLost|Reaction on "error from Encoder-Mutliturn-is-lost"|
|30|35|Reac_EncObs|Error response: Encoder monitoring|30|62|ERR_Specific2OptCode|Error reaction specific option code|
|30|36|Reac_ComOptVARAN|Error response: VARAN communication option|38|0|Reac_SynCtrl|Error response: Synchronization controller|
|30|37|Reac_OverCurrent_BC|Error response: Braking chopper|30|39|Reac_TWIN|Error response: TWINSYNC|
|30|40|Reac_TWIN_TOPT|Error response: TWINSYNC technology option|30|41|Reac_FastDischargeTimeOut|Error response: DC link fast discharge timeout|
|30|42|Reac_EtcMaster|Error response: EtherCAT® master|30|43|Reac_Ethernet|Error response: Ethernet configuration|
|30|44|Reac_WireBreak|Error response: Wire break|30|45|Reac_LockViolate|Error response: Setpoint exceeded|
|30|46|Reac_PositionLimit|Error response: Software limit switch|30|47|Reac_FSAFE_NonSafetySystem|Reaction on "FSAFE - error in non-safety-system"|
|30|48|Reac_NmtStateChanged|Error response: NMT state change|30|49|Reac_FSAFE_SafetySystem|Reaction on "FSAFE - alarm or error in safety-system"|
|30|50|Reac_TimeOut|Reaction on "TimeOut: Allowed duration of negative speed in pressure control exceeded"|30|51|Reac_EncStatus|Reaction on "EncStatus: Warning or Errorbit set by Encoder"|
|30|52|Reac_Ana|Reaction on "error on analog input"|30|53|Reac_MotorFailure|Reaction on "motor failure"|

Table 11.7: Parameters “Error reactions” (continue)

# 11.6 Error list

# 11.6.1 Error 0: Unknown error

Cause: Error while installing a dynamic module

Suggested steps:

- No Error. An error message with the error number 0 usually does not occur. (inverse error number)
- This is probably a software issue. Please try to switch to a different version of device firmware.

# 11.6.2 Error 1: Runtime error

# 11.6.2.1 Error 1-0 (emergency code 6010h)

Cause: Unknown runtime error

Suggested steps:

- See exception message
- This is probably a software issue. Please try to switch to a different version of device firmware.
- Save your dataset and reset the axis module to factory setting. See if the error persists, or if it comes with activating a certain feature.

# 11.6.2.2 Error 1-1 (emergency code 6010h)

Cause: Error while flash initialisation / flash access

Suggested steps:

- This is probably a software issue. Please try to switch to a different version of device firmware.
- Save your dataset and reset the axis module to factory setting. See if the error persists, or if it comes with activating a certain feature.

# 11.6.2.3 Error 1-2 (emergency code 6010h)

Cause: Error while flash initialisation / flash access

Suggested steps:

- This is probably a software issue. Please try to switch to a different version of device firmware.
- Save your dataset and reset the axis module to factory setting. See if the error persists, or if it comes with activating a certain feature.

MOOG ID No.:CB40859-001 Date:11/2020

MSD ServoDrive - DeviceHelp 328

# 11 Alarms & warnings

# 11 Alarms & warnings

# 11.6.2.4 Error 1-3 (emergency code 6010h)

Cause: Error while PLC initialisation / PLC execution

Suggested steps:

- Check PLC program
- This is probably a software issue.
- Please try to switch to a different version of device firmware.
- Save your dataset and reset the axis module to factory setting. See if the error persists, or if it comes with activating a certain feature.

# 11.6.2.5 Error 1-4 (emergency code 6010h)

Cause: Run time error, not enough CPU performance, PLC scheduling stopped

Suggested steps:

- Check PLC program
- This is probably a software issue.
- Please try to switch to a different version of device firmware.
- Save your dataset and reset the axis module to factory setting. See if the error persists, or if it comes with activating a certain feature.

# 11.6.2.6 Error 1-5 (emergency code 6010h)

Cause: Unknown EXCEPTION in TC-safety

Suggested steps:

- Acknowledge error! - If the error occurs again, reset device!
- This is probably a software issue.
- Please try to switch to a different version of device firmware.
- Save your dataset and reset the axis module to factory setting. See if the error persists, or if it comes with activating a certain feature.

# 11.6.3 Error 2: Parameter list error

# 11.6.3.1 Error 2-1 (emergency code 6320h)

Cause: Parameter initalisation failed

Suggested steps:

- Switch off/on device. Please contact your service provider if this error occurs again

This issue is probably

- Save your parameter set for a later restore.
- See 'history of parameter changes' and undo the latest changes.
- Please check your parameter set for implausible settings.
- Please set device to factory setting, restart, and see if the error occurs again.
- When reporting this error to your service partner, please include your device's parameter setting.

This is probably a software issue.

- Please try to switch to a different version of device firmware.
- Save your dataset and reset the axis module to factory setting. See if the error persists, or if it comes with activating a certain feature.

MOOG ID No.:CB40859-001 Date:11/2020

# 11 Alarms & warnings

# 11.6.3.2 Error 2-2 (emergency code 6320h)

Cause: Parameter virgin initalisation failed

Suggested steps:

- Switch off/on device. Please contact your service provider if this error occurs again

This issue is probably

- Save your parameter set for a later restore.
- See 'history of parameter changes' and undo the latest changes.
- Please check your parameter set for implausible settings.
- Please set device to factory setting, restart, and see if the error occurs again.
- When reporting this error to your service partner, please include your device's parameter setting.

This is probably a software issue.

- Please try to switch to a different version of device firmware.
- Save your dataset and reset the axis module to factory setting. See if the error persists, or if it comes with activating a certain feature.

MSD ServoDrive - DeviceHelp 330

# 11 Alarms & warnings

# 11.6.3.3 Error 2-3 (emergency code 5530h)

Cause: Error in parameter saving routine

Suggested steps:

- Switch off/on device. Please contact your service provider if this error occurs again
- This issue is probably caused by an unsuitable parameter setting.
- Save your parameter set for a later restore.
- See 'history of parameter changes' and undo the latest changes.
- Please check your parameter set for implausible settings.
- Please set device to factory setting, restart, and see if the error occurs again.
- When reporting this error to your service partner, please include your device's parameter setting.

# 11.6.3.4 Error 2-4 (emergency code 6320h)

Cause: Error in paralist while adding a new parameter

Suggested steps:

- Switch off/on device. Please contact your service provider if this error occurs again
- This is probably a software issue.
- Please try to switch to a different version of device firmware.
- Save your dataset and reset the axis module to factory setting. See if the error persists, or if it comes with activating a certain feature.

# 11.6.3.5 Error 2-5 (emergency code 5530h)

Cause: Parameter check failed

Suggested steps:

- Switch off/on device. Please contact your service provider if this error occurs again
- This is probably a software issue.
- Please try to switch to a different version of device firmware.
- Save your dataset and reset the axis module to factory setting. See if the error persists, or if it comes with activating a certain feature.

# 11.6.3.6 Error 2-6 (emergency code 6320h)

Cause: Parameter ID is multiply defined

# Suggested steps:

- Switch off/on device. Please contact your service provider if this error occurs again
- This is probably a software issue.
- Please try to switch to a different version of device firmware.
- Save your dataset and reset the axis module to factory setting. See if the error persists, or if it comes with activating a certain feature.

# 11.6.3.7 Error 2-7 (emergency code 5400h)

Cause: The selected switching frequency is not supported

# Suggested steps:

- Choose different voltage level and/or switching frequency
- This issue is probably caused by an unsuitable parameter setting.
- Save your parameter set for a later restore.
- See 'history of parameter changes' and undo the latest changes.
- Please check your parameter set for implausible settings.
- Please set device to factory setting, restart, and see if the error occurs again.
- When reporting this error to your service partner, please include your device's parameter setting.
- This is probably a software issue.
- Please try to switch to a different version of device firmware.
- Save your dataset and reset the axis module to factory setting. See if the error persists, or if it comes with activating a certain feature.

MOOG ID No.:CB40859-001 Date:11/2020

MSD ServoDrive - DeviceHelp 332

# 11 Alarms & warnings

# 11 Alarms & warnings

# MOOG

ID No.: CB40859-001 Date: 11/2020

# MSD ServoDrive - DeviceHelp

11.6.3.8 Error 2-8 (emergency code 6320h)

Cause: Error in power stage initialization; selected device voltage not supported

Suggested steps:

- Choose different voltage level and/or switching frequency
- This issue is probably caused by an unsuitable parameter setting.
- Save your parameter set for a later restore.
- See 'history of parameter changes' and undo the latest changes.
- Please check your parameter set for implausible settings.
- Please set device to factory setting, restart, and see if the error occurs again.
- When reporting this error to your service partner, please include your device's parameter setting.

11.6.3.9 Error 2-9 (emergency code 6320h)

Cause: Overvoltage in DC link

Suggested steps:

- Please check parameter (749).
- An over-voltage occurred.
- Please check if the actual grid voltage matches the supply setting (parameter PST_VoltageSupply).
- Over-voltage may be caused by a decelerating axis, possibly with high inertia. Reduce deceleration ramp.
- Consider using a braking resistor with higher power. If the supply unit has an internal braking resistor, please contact your service partner.

This is probably a software issue.

- Please try to switch to a different version of device firmware.
- Save your dataset and reset the axis module to factory setting. See if the error persists, or if it comes with activating a certain feature.

# 11.6.4 Error 3: Undervoltage error

# 11.6.4.1 Error 3-1 (emergency code 3120h)

Cause: Undervoltage in DC link

Suggested steps:

- Re-start process when power is available. Please check grid conditions.
- An under-voltage occurred. Power supply was possibly switched off on the drive while this axis was switched on.
- Please check if the actual grid voltage matches the supply setting (parameter PST_VoltageSupply).
- Verify that the grid is stable under load condition.
- Over-voltage may be caused by a decelerating axis, possibly with high inertia. Reduce deceleration ramp.
- Consider using a braking resistor with higher power. If the supply unit has an internal braking resistor, please contact your service partner.

# 11.6.4.2 Error 3-2 (emergency code 3120h)

Cause: Undervoltage: Power fail function has reached minimum speed

Suggested steps:

- Re-start process when power is available. Please check grid conditions and power fail levels.
- An under-voltage occurred. Power supply was possibly switched off on the drive while this axis was switched on.
- Please check if the actual grid voltage matches the supply setting (parameter PST_VoltageSupply).
- Verify that the grid is stable under load condition.

# 11.6.5 Error 4: Overvoltage error

# 11.6.5.1 Error 4-1 (emergency code 3110h)

Cause: Overvoltage detected

Suggested steps:

- An over-voltage occurred. Please check if the actual grid voltage matches the supply setting (parameter PST_VoltageSupply).
- Over-voltage may be caused by a decelerating axis, possibly with high inertia. Reduce deceleration ramp.
- Consider using a braking resistor with higher power. If the supply unit has an internal braking resistor, please contact your service partner.

# 11.6.5.2 Error 4-2 (emergency code 3110h)

Cause: Maximum DC-link mean potential deviation detected.

Suggested steps:

- This is possibly a hardware issue. If other measures fail to solve the problem, please replace the servo drive.

MOOG ID No.:CB40859-001 Date:11/2020

MSD ServoDrive - DeviceHelp 334

# 11 Alarms & warnings

# MOOG

ID No.: CB40859-001 Date: 11/2020

# 11.6.6 Error 5: Overcurrent error

# 11.6.6.1 Error 5-1 (emergency code 2250h)

Cause: Overcurrent shut-off by hardware

Suggested steps:

- Please check power wiring and control settings
- An overcurrent was detected.
- Please check current control settings and step response.
- Check the motor's saturation settings (parameter MOT_LSigDiff). If the error occurred in high-current range, lower saturation values manually.
- If possible, reduce the needed current, especially in low-frequency range.
- If possible, lower the switching frequency or enable automatic frequency selection.
- Check if the encoder offset is set properly.
- Consider using an axis module with higher current rating.

This is possibly a hardware issue: If other measures fail to solve the problem, please replace the servo drive.

This is possibly an EMC issue: This is very likely if the problem occurs when switching on motor control and/or when connecting DC link power supply.

- Please check the device cabling for proper connection.
- Please check device grounding, i.e. the connection to a metal backplane and cabinet connection to earth.
- Check motor grounding and motor cable length.

# 11.6.6.2 Error 5-2 (emergency code 2350h)

Cause: Overcurrent shut-off (fast) by software

Suggested steps:

- Please check power wiring and control settings
- An overcurrent was detected.
- Please check current control settings and step response.
- Check the motor's saturation settings (parameter MOT_LSigDiff). If the error occurred in high-current range, lower saturation values manually.
- If possible, reduce the needed current, especially in low-frequency range.
- If possible, lower the switching frequency or enable automatic frequency selection.
- Check if the encoder offset is set properly.
- Consider using an axis module with higher current rating.

This is possibly a hardware issue: If other measures fail to solve the problem, please replace the servo drive.

This is possibly an EMC issue: This is very likely if the problem occurs when switching on motor control and/or when connecting DC link power supply.

- Please check the device cabling for proper connection.
- Please check device grounding, i.e. the connection to a metal backplane and cabinet connection to earth.
- Check motor grounding and motor cable length.

MSD ServoDrive - DeviceHelp 335

# 11.6.6.3 Error 5-3 (emergency code 2350h)

Cause: Measuring range of AD converter exceeded

# Suggested steps:

- Please check power wiring and control settings
- An overcurrent was detected.
- Please check current control settings and step response.
- Check the motor's saturation settings (parameter MOT_LSigDiff). If the error occurred in high-current range, lower saturation values manually.
- If possible, reduce the needed current, especially in low-frequency range.
- If possible, lower the switching frequency or enable automatic frequency selection.
- Check if the encoder offset is set properly.
- Consider using an axis module with higher current rating.

This is possibly a hardware issue. If other measures fail to solve the problem, please replace the servo drive.

This is possibly an EMC issue. This is very likely if the problem occurs when switching on motor control and/or when connecting DC link power supply.

- Please check the device cabling for proper connection.
- Please check device grounding, i.e. the connection to a metal backplane and cabinet connection to earth.
- Check motor grounding and motor cable length.

MOOG ID No.:CB40859-001 Date:11/2020

# 11.6.6.4 Error 5-4 (emergency code 2250h)

Cause: Short-circuit test on initialization

# Suggested steps:

- Please check power wiring for short-circuit
- An overcurrent was detected.
- Please check current control settings and step response.
- Check the motor's saturation settings (parameter MOT_LSigDiff). If the error occurred in high-current range, lower saturation values manually.
- If possible, reduce the needed current, especially in low-frequency range.
- If possible, lower the switching frequency or enable automatic frequency selection.
- Check if the encoder offset is set properly.
- Consider using an axis module with higher current rating.

This is possibly a hardware issue. If other measures fail to solve the problem, please replace the servo drive.

This is possibly an EMC issue. This is very likely if the problem occurs when switching on motor control and/or when connecting DC link power supply.

- Please check the device cabling for proper connection.
- Please check device grounding, i.e. the connection to a metal backplane and cabinet connection to earth.
- Check motor grounding and motor cable length.

MSD ServoDrive - DeviceHelp 336

# 11 Alarms & warnings

MOOG ID No.:CB40859-001 Date:11/2020

# 11.6.6.5 Error 5-5 (emergency code 2350h)

Cause: (Fast) Overcurrent shut-off "below 5 Hz"

# Suggested steps:

- Please check torque limits, speed profile and control settings
- An overcurrent was detected. Please check current control settings and step response.
- Check the motor's saturation settings (parameter MOT_LSigDiff). If the error occurred in high-current range, lower saturation values manually.
- If possible, reduce the needed current, especially in low-frequency range.
- If possible, lower the switching frequency or enable automatic frequency selection.
- Check if the encoder offset is set properly.
- Consider using an axis module with higher current rating.

This is possibly a hardware issue. If other measures fail to solve the problem, please replace the servo drive.

This is possibly an EMC issue. This is very likely if the problem occurs when switching on motor control and/or when connecting DC link power supply.

- Please check the device cabling for proper connection.
- Please check device grounding, i.e. the connection to a metal backplane and cabinet connection to earth.
- Check motor grounding and motor cable length.

# 11.6.6.6 Error 5-6 (emergency code 2350h)

Cause: Total current monitoring

# Suggested steps:

- Please check ground connection or power wiring of motor and device, check current values
- An overcurrent was detected. Please check current control settings and step response.
- Check the motor's saturation settings (parameter MOT_LSigDiff). If the error occurred in high-current range, lower saturation values manually.
- If possible, reduce the needed current, especially in low-frequency range.
- If possible, lower the switching frequency or enable automatic frequency selection.
- Check if the encoder offset is set properly.
- Consider using an axis module with higher current rating.

This is possibly a hardware issue. If other measures fail to solve the problem, please replace the servo drive.

This is possibly an EMC issue. This is very likely if the problem occurs when switching on motor control and/or when connecting DC link power supply.

- Please check the device cabling for proper connection.
- Please check device grounding, i.e. the connection to a metal backplane and cabinet connection to earth.
- Check motor grounding and motor cable length.

# 11.6.6.7 Error 5-7 (emergency code 2350h)

Cause: Fast I²t at high overload

# Suggested steps:

- Please check control and motion profile settings or reduce load
- An overcurrent was detected.
- Please check current control settings and step response.
- Check the motor's saturation settings (parameter MOT_LSigDiff). If the error occurred in high-current range, lower saturation values manually.
- If possible, reduce the needed current, especially in low-frequency range.
- If possible, lower the switching frequency or enable automatic frequency selection.
- Check if the encoder offset is set properly.
- Consider using an axis module with higher current rating.

This is possibly a hardware issue. If other measures fail to solve the problem, please replace the servo drive.

This is possibly an EMC issue. This is very likely if the problem occurs when switching on motor control and/or when connecting DC link power supply.

- Please check the device cabling for proper connection.
- Please check device grounding, i.e. the connection to a metal backplane and cabinet connection to earth.
- Check motor grounding and motor cable length.

# 11.6.6.8 Error 5-8 (emergency code 2350h)

Cause: Maximum fault current (= absolut sum current) in power-off detected

# Suggested steps:

- Please check ground connection or power wiring of motor and device, check current values
- An overcurrent was detected.
- Please check current control settings and step response.
- Check the motor's saturation settings (parameter MOT_LSigDiff). If the error occurred in high-current range, lower saturation values manually.
- If possible, reduce the needed current, especially in low-frequency range.
- If possible, lower the switching frequency or enable automatic frequency selection.
- Check if the encoder offset is set properly.
- Consider using an axis module with higher current rating.

This is possibly a hardware issue. If other measures fail to solve the problem, please replace the servo drive.

This is possibly an EMC issue. This is very likely if the problem occurs when switching on motor control and/or when connecting DC link power supply.

- Please check the device cabling for proper connection.
- Please check device grounding, i.e. the connection to a metal backplane and cabinet connection to earth.
- Check motor grounding and motor cable length.

MOOG ID No.:CB40859-001 Date:11/2020

MSD ServoDrive - DeviceHelp 338

# 11 Alarms & warnings

# MOOG

ID No.: CB40859-001 Date: 11/2020

# MSD ServoDrive - DeviceHelp

339

# 11.6.7 Error 6: Motor temperature error

# 11.6.7.1 Error 6-1 (emergency code 4310h)

Cause: Motor temperature above threshold value

# Suggested steps:

- Please let the motor cool down
- Please check motor temperature and motor temperature resistance (PTC sensors do not report the motor temperature). If the values are not plausible, check cables and sensor type.
- If you are not using a system motor, please check with the motor manufacturer if the motor can stand a higher temperature

# 11.6.7.2 Error 6-2 (emergency code 4310h)

Cause: PTC short circuit detected (DIN2)

# Suggested steps:

- Please let the motor cool down
- Please check motor temperature and motor temperature resistance (PTC sensors do not report the motor temperature). If the values are not plausible, check cables and sensor type.
- If you are not using a system motor, please check with the motor manufacturer if the motor can stand a higher temperature

# 11.6.7.3 Error 6-3 (emergency code 4310h)

Cause: PTC/TSS overtemperature, resistance higher than 3500 Ohm

# Suggested steps:

- Please let the motor cool down
- Please check motor temperature and motor temperature resistance (PTC sensors do not report the motor temperature). If the values are not plausible, check cables and sensor type.
- If you are not using a system motor, please check with the motor manufacturer if the motor can stand a higher temperature

# 11.6.7.4 Error 6-4 (emergency code 4310h)

Cause: PTC/TSS error, resistance still higher than 1650 Ohm after overtemperature

# Suggested steps:

- Wait and let motor cool down. Reduce motor load or change motion cycle.
- The motor temperature is too high.
- Please let the motor cool down.
- Please check motor temperature and motor temperature resistance (PTC sensors do not report the motor temperature). If the values are not plausible, check cables and sensor type.
- If you are not using a system motor, please check with the motor manufacturer if the motor can stand a higher temperature.

MOOG ID No.:CB40859-001 Date:11/2020

# 11 Alarms & warnings

# 11.6.7.5 Error 6-5 (emergency code 4310h)

Cause: Motor protection method not supported

# Suggested steps:

- Try to use different sensor connection, or contact your service provider.
- This issue is probably caused by an unsuitable parameter setting.
- Save your parameter set for a later restore.
- See 'history of parameter changes' and undo the latest changes.
- Please check your parameter set for implausible settings.
- Please set device to factory setting, restart, and see if the error occurs again.
- When reporting this error to your service partner, please include your device's parameter setting.

MSD ServoDrive - DeviceHelp 340

# 11 Alarms & warnings

MOOG ID No.:CB40859-001 Date:11/2020

# 11.6.8 Error 7: Device heatsink temperature error

# 11.6.8.1 Error 7-1 (emergency code 4210h)

Cause: Heat sink temperature too high

Suggested steps:

- reduce the load and check the conditions of the drive
- An overcurrent was detected. Please check current control settings and step response.
- Check the motor's saturation settings (parameter MOT_LSigDiff). If the error occurred in high-current range, lower saturation values manually.
- If possible, reduce the needed current, especially in low-frequency range.
- If possible, lower the switching frequency or enable automatic frequency selection.
- Check if the encoder offset is set properly.
- Consider using an axis module with higher current rating.

This is possibly a hardware issue. If other measures fail to solve the problem, please replace the servo drive.

# 11.6.9 Error 8: Device inside temperature error

# 11.6.9.1 Error 8-1 (emergency code 4210h)

Cause: Interior temperature monitor

Suggested steps:

- check the conditions of the drive
- An overcurrent was detected. Please check current control settings and step response.
- Check the motor's saturation settings (parameter MOT_LSigDiff). If the error occurred in high-current range, lower saturation values manually.
- If possible, reduce the needed current, especially in low-frequency range.
- If possible, lower the switching frequency or enable automatic frequency selection.
- Check if the encoder offset is set properly.
- Consider using an axis module with higher current rating.

This is possibly a hardware issue. If other measures fail to solve the problem, please replace the servo drive.

# 11.6.10 Error 9: I2t motor error

# 11.6.10.1 Error 9-1 (emergency code 2350h)

Cause: I²t motor protection limit value exceeded

Suggested steps:

- Reduce load on motor or check load cycle
- An overcurrent was detected. Please check current control settings and step response.
- Check the motor's saturation settings (parameter MOT_LSigDiff). If the error occurred in high-current range, lower saturation values manually.
- If possible, reduce the needed current, especially in low-frequency range.
- If possible, lower the switching frequency or enable automatic frequency selection.
- Check if the encoder offset is set properly.
- Consider using an axis module with higher current rating.

MOOG ID No.:CB40859-001 Date:11/2020

# 11 Alarms & warnings

# 11.6.11 Error 10: I2t power amplifier error

# 11.6.11.1 Error 10-1 (emergency code 2350h)

Cause: I²t power stage protection limit value exceeded

Suggested steps:

- Reduce load on motor or check load cycle
- An overcurrent was detected. Please check current control settings and step response.
- Check the motor's saturation settings (parameter MOT_LSigDiff). If the error occurred in high-current range, lower saturation values manually.
- If possible, reduce the needed current, especially in low-frequency range.
- If possible, lower the switching frequency or enable automatic frequency selection.
- Check if the encoder offset is set properly.
- Consider using an axis module with higher current rating.

MSD ServoDrive - DeviceHelp 342

# 11 Alarms & warnings

# MOOG

ID No.: CB40859-001 Date: 11/2020

# MSD ServoDrive - DeviceHelp

343

# 11.6.11.2 Error 10-2 (emergency code 2350h)

Cause: Internal brake resistor was overloaded

# Suggested steps:

- Use slower deceleration ramp, check for external accelerating torque, or use unit with external brake resistor
- An overcurrent was detected.

# 11.6.12 Error 11: External digital input error

# 11.6.12.1 Error 11-1 (emergency code FF00h)

Cause: External error at digital input detected

# Suggested steps:

- Please check the 24V I/O wiring, function assignment and inversion parameters.
- There is a problem with the digital/analog inputs.
- Please check connected switches for chattering. Consider using the input filter.
- If other measures fail to solve the problem, please replace the servo drive.

# 11.6.13 Error 12: CAN error

# 11.6.13.1 Error 12-1 (emergency code 8140h)

Cause: CAN option: BusOff error

# 11.6.13.2 Error 12-2 (emergency code 8130h)

Cause: CAN option: Guarding error

# Suggested steps:

- Please check the bus system connection. Try to replace the cables.
- Please try to reduce computational load on the master.
- Try to increase the master cycle time.
- Please check the device cabling for proper connection.
- Please check device grounding, i.e. the connection to a metal backplane and cabinet connection to earth.
- Check motor grounding and motor cable length.

This is possibly an EMC issue. This is very likely if the problem occurs when switching on motor control and/or when connecting DC link power supply.

MOOG ID No.:CB40859-001 Date:11/2020

MSD ServoDrive - DeviceHelp 344

# 11 Alarms & warnings

# 11 Alarms & warnings

MOOG ID No.:CB40859-001 Date:11/2020

# 11.6.13.3 Error 12-3 (emergency code 8100h)

Cause: CAN option: Message transmit failed

# Suggested steps:

- The device was probably disconnected from the master controller, or the master is overloaded.
- Please check the bus system connection. Try to replace the cables.
- Please try to reduce computational load on the master.
- Try to increase the master cycle time.
- This is possibly an EMC issue. This is very likely if the problem occurs when switching on motor control and/or when connecting DC link power supply.
- Please check the device cabling for proper connection.
- Please check device grounding, i.e. the connection to a metal backplane and cabinet connection to earth.
- Check motor grounding and motor cable length.

# 11.6.13.4 Error 12-4 (emergency code 8130h)

Cause: CAN option: Heartbeat error

# Suggested steps:

- The device was probably disconnected from the master controller, or the master is overloaded.
- Please check the bus system connection. Try to replace the cables.
- Please try to reduce computational load on the master.
- Try to increase the master cycle time.
- This is possibly an EMC issue. This is very likely if the problem occurs when switching on motor control and/or when connecting DC link power supply.
- Please check the device cabling for proper connection.
- Please check device grounding, i.e. the connection to a metal backplane and cabinet connection to earth.
- Check motor grounding and motor cable length.

# 11.6.13.5     Error 12-5 (emergency code 8100h)

Cause: CAN option: Illegal address

# Suggested steps:

- Please check the configuration of the CAN address (software and hardware settings). The parameter 2005[0] indicates the set CAN software address, The parameter 2058[0] indicates the set CAN address of the DIP switches.
- This issue is probably caused by an unsuitable parameter setting.
- Save your parameter set for a later restore.
- See 'history of parameter changes' and undo the latest changes.
- Please check your parameter set for implausible settings.
- Please set device to factory setting, restart, and see if the error occurs again.
- When reporting this error to your service partner, please include your device's parameter setting.

MOOG                       ID No.:CB40859-001 Date:11/2020

# 11.6.13.6     Error 12-6 (emergency code 8200h)

Cause: CAN option: mapping error

# Suggested steps:

- This issue is probably caused by an unsuitable parameter setting.
- Save your parameter set for a later restore.
- See 'history of parameter changes' and undo the latest changes.
- Please check your parameter set for implausible settings.
- Please set device to factory setting, restart, and see if the error occurs again.
- When reporting this error to your service partner, please include your device's parameter setting.
- The device was probably disconnected from the master controller, or the master is overloaded.
- Please check the bus system connection. Try to replace the cables.
- Please try to reduce computational load on the master.
- Try to increase the master cycle time.

MSD ServoDrive  - DeviceHelp    346

# 11 Alarms & warnings

# MOOG

ID No.: CB40859-001 Date: 11/2020

# MSD ServoDrive - DeviceHelp

347

# 11.6.13.7 Error 12-7 (emergency code 8130h)

Cause: CAN option: Sync / RxPDO timeout error

# Suggested steps:

- The device was probably disconnected from the master controller, or the master is overloaded.
- Please check the bus system connection. Try to replace the cables.
- Please try to reduce computational load on the master.
- Try to increase the master cycle time.
- This is possibly an EMC issue. This is very likely if the problem occurs when switching on motor control and/or when connecting DC link power supply.
- Please check the device cabling for proper connection.
- Please check device grounding, i.e. the connection to a metal backplane and cabinet connection to earth.
- Check motor grounding and motor cable length.

# 11.6.13.8 Error 12-8 (emergency code FF00h)

Cause: CAN option: Error while parameter initialisation

# Suggested steps:

- This issue is probably caused by an unsuitable parameter setting.
- Save your parameter set for a later restore.
- See 'history of parameter changes' and undo the latest changes.
- Please check your parameter set for implausible settings.
- Please set device to factory setting, restart, and see if the error occurs again.
- When reporting this error to your service partner, please include your device's parameter setting.

# 11.6.14 Error 13: SERCOS error

# 11.6.14.1 Error 13-1 (emergency code FF00h)

Cause: Sercos option: Error while hardware initialisation

# Suggested steps:

This is possibly a hardware issue. If other measures fail to solve the problem, please replace the servo drive.

# 11.6.14.2 Error 13-2 (emergency code FF00h)

Cause: Sercos option: Illegal communication phase

Suggested steps:

- Error during phase switching or invalid phase switching. Please check the settings in the master!
- The device was probably disconnected from the master controller, or the master is overloaded.
- Please check the device cabling for proper connection.
- Please check the bus system connection. Try to replace the cables.
- Please try to reduce computational load on the master.
- Try to increase the master cycle time.

# 11.6.14.5 Error 13-5 (emergency code FF00h)

Cause: Sercos option: MST failure

Suggested steps:

- Missing master sync telegram. Please check the wiring!
- This is possibly an EMC issue. This is very likely if the problem occurs when switching on motor control and/or when connecting DC link power supply.
- Please check device grounding, i.e. the connection to a metal backplane and cabinet connection to earth.
- Check motor grounding and motor cable length.

# 11.6.14.3 Error 13-3 (emergency code FF00h)

Cause: Sercos option: Optical fiber break

Suggested steps:

- Please check the function of the optical fibres and the correct wiring.
- The device was probably disconnected from the master controller, or the master is overloaded.
- Please try to reduce computational load on the master.
- Try to increase the master cycle time.

# 11.6.14.4 Error 13-4 (emergency code FF00h)

Cause: Sercos option: Receive data disturbed

Suggested steps:

- Disturbed receive data due to distortion. Lightwave power does not match to the cable length. Please check the cable length!

MOOG ID No.:CB40859-001 Date:11/2020

MSD ServoDrive - DeviceHelp 348

# 11 Alarms & warnings

# 11.6.14.6 Error 13-6 (emergency code FF00h)

Cause: Sercos option: MDT failure

Suggested steps:

- Missing master data telegram. Please check the wiring!
- The device was probably disconnected from the master controller, or the master is overloaded.
- Please check the bus system connection. Try to replace the cables.
- Please try to reduce computational load on the master.
- Try to increase the master cycle time.

# 11.6.14.8 Error 13-8 (emergency code FF00h)

Cause: Sercos option: Phase upshift failure

Suggested steps:

- Error during phase switching (up-shift) by master. Please check the settings in the master!
- The device was probably disconnected from the master controller, or the master is overloaded.
- Please check the bus system connection. Try to replace the cables.
- Please try to reduce computational load on the master.
- Try to increase the master cycle time.

# 11.6.14.7 Error 13-7 (emergency code FF00h)

Cause: Sercos option: 2 drives with same address in the ring

Suggested steps:

- Please check the configured SERCOS address (parameter 3000 for SERCOS II / parameter 11040 for SERCOS III)
- This issue is probably caused by an unsuitable parameter setting.
- Save your parameter set for a later restore.
- See 'history of parameter changes' and undo the latest changes.
- Please check your parameter set for implausible settings.
- Please set device to factory setting, restart, and see if the error occurs again.
- When reporting this error to your service partner, please include your device's parameter setting.

# 11.6.14.9 Error 13-9 (emergency code FF00h)

Cause: Sercos option: Phase downshift failure

Suggested steps:

- Error during phase switching (down-shift) by master. Please check the settings in the master!
- The device was probably disconnected from the master controller, or the master is overloaded.
- Please check the bus system connection. Try to replace the cables.
- Please try to reduce computational load on the master.
- Try to increase the master cycle time.

# 11.6.14.10 Error 13-10 (emergency code FF00h)

Cause: Sercos option: Phase switching without ready acknowledge

# Suggested steps:

- Error during phase switching. Switchover without or with incorrect command execution. Please check the settings in the master!
- The device was probably disconnected from the master controller, or the master is overloaded.
- Please check the bus system connection. Try to replace the cables.
- Please try to reduce computational load on the master.
- Try to increase the master cycle time.
- This issue is probably caused by an unsuitable parameter setting.
- Save your parameter set for a later restore. See 'history of parameter changes' and undo the latest changes.
- Please check your parameter set for implausible settings.
- Please set device to factory setting, restart, and see if the error occurs again.
- When reporting this error to your service partner, please include your device's parameter setting.

# MOOG ID No.:CB40859-001 Date:11/2020

# 11 Alarms & warnings

# 11.6.14.11 Error 13-11 (emergency code FF00h)

Cause: Sercos option: Error while parameter initialisation

# Suggested steps:

- This issue is probably caused by an unsuitable parameter setting.
- Save your parameter set for a later restore. See 'history of parameter changes' and undo the latest changes.
- Please check your parameter set for implausible settings.
- Please set device to factory setting, restart, and see if the error occurs again.
- When reporting this error to your service partner, please include your device's parameter setting.

# 11.6.14.12 Error 13-12 (emergency code FF00h)

Cause: Sercos option: Run time error

# Suggested steps:

- This is probably a software issue. Please try to switch to a different version of device firmware.
- Save your dataset and reset the axis module to factory setting. See if the error persists, or if it comes with activating a certain feature.
- This is possibly a hardware issue. If other measures fail to solve the problem, please replace the servo drive.

# 11 Alarms & warnings

# MOOG

ID No.: CB40859-001 Date: 11/2020

# MSD ServoDrive - DeviceHelp

# 11.6.14.13 Error 13-13 (emergency code FF00h)

Cause: Sercos option: Watchdog failure

Suggested steps:

- SERCOS controller hardware watchdog. Please check the settings in the master!
- The device was probably disconnected from the master controller, or the master is overloaded.
- Please check the bus system connection. Try to replace the cables.
- Please try to reduce computational load on the master.
- Try to increase the master cycle time.

# 11.6.14.15 Error 13-15 (emergency code FF00h)

Cause: Sercos option: Communication error

Suggested steps:

- Error in the topology detection. Topology not stable or not detected. Please check the wiring!
- This is possibly an EMC issue. This is very likely if the problem occurs when switching on motor control and/or when connecting DC link power supply.
- Please check the device cabling for proper connection.
- Please check device grounding, i.e. the connection to a metal backplane and cabinet connection to earth.
- Check motor grounding and motor cable length.

# 11.6.14.14 Error 13-14 (emergency code FF00h)

Cause: Sercos option: Error in parameter data

Suggested steps:

- This issue is probably caused by an unsuitable parameter setting.
- Save your parameter set for a later restore.
- See 'history of parameter changes' and undo the latest changes.
- Please check your parameter set for implausible settings.
- Please set device to factory setting, restart, and see if the error occurs again.
- When reporting this error to your service partner, please include your device's parameter setting.

# 11.6.15 Error 14: EtherCAT error

# 11.6.15.1 Error 14-1 (emergency code 8130h)

Cause: ECAT watchdog timeout, Sync manager 0/1 watchdog error

Suggested steps:

- This is possibly a hardware issue
- This is possibly an EMC issue. This is very likely if the problem occurs when switching on motor control and/or when connecting DC link power supply.
- The device was probably disconnected from the master controller, or the master is overloaded.

Please check the device cabling for proper connection.

Please check device grounding, i.e. the connection to a metal backplane and cabinet connection to earth.

Check motor grounding and motor cable length.

Please check the bus system connection. Try to replace the cables.

Please try to reduce computational load on the master.

Try to increase the master cycle time.

# 11.6.15.2 Error 14-2 (emergency code 8130h)

Cause: EtherCAT®: Parameter error, parameter data implausible

Suggested steps:

- This is possibly a hardware issue

If other measures fail to solve the problem, please replace the servo drive.

# 11.6.15.3 Error 14-3 (emergency code 8130h)

Cause: Internal ram error

Suggested steps:

- If other measures fail to solve the problem, please replace the servo drive.

MOOG ID No.:CB40859-001 Date:11/2020

MSD ServoDrive - DeviceHelp 352

# 11 Alarms & warnings

# 11 Alarms & warnings

MOOG ID No.:CB40859-001 Date:11/2020

# 11.6.15.4 Error 14-4 (emergency code 8130h)

Cause: Invalid Configuration, Ethercat communication controller does not support requested Sync Manager

# Suggested steps:

- Check the configuration of the SyncManager in the EtherCAT master and in the parameters 2029-2032.
- This issue is probably caused by an unsuitable parameter setting.
- Save your parameter set for a later restore.
- See 'history of parameter changes' and undo the latest changes.
- Please check your parameter set for implausible settings.
- Please set device to factory setting, restart, and see if the error occurs again.
- When reporting this error to your service partner, please include your device's parameter setting.
- Please check the bus system connection. Try to replace the cables.
- Please try to reduce computational load on the master.
- Try to increase the master cycle time.

# 11.6.15.5 Error 14-5 (emergency code 8130h)

Cause: Missing Ethercat receive process data on Sync Manager 2

# Suggested steps:

- This is possibly an EMC issue. This is very likely if the problem occurs when switching on motor control and/or when connecting DC link power supply.
- Please check the device cabling for proper connection.
- Please check device grounding, i.e. the connection to a metal backplane and cabinet connection to earth.
- Check motor grounding and motor cable length.
- The device was probably disconnected from the master controller, or the master is overloaded.
- Please check the bus system connection. Try to replace the cables.
- Please try to reduce computational load on the master.
- Try to increase the master cycle time.

# 11.6.15.6 Error 14-6 (emergency code 8130h)

Cause: Local Error, Slave has changed the EtherCAT state autonomously

# Suggested steps:

- The device was probably disconnected from the master controller, or the master is overloaded.
- Please check the bus system connection. Try to replace the cables.
- Please try to reduce computational load on the master.
- Try to increase the master cycle time.

# 11.6.16      Error 15: Parameter error

# 11.6.16.1     Error 15-1 (emergency code 2350h)

Cause:  Error while init current monitoring

# Suggested steps:

- Check the device setting! (If possible, try a different switching frequency.)
- This issue is probably caused by an unsuitable parameter setting.
- Save your parameter set for a later restore.
- See 'history of parameter changes' and undo the latest changes.
- Please check your parameter set for implausible settings.
- Please set device to factory setting, restart, and see if the error occurs again.
- When reporting this error to your service partner, please include your device's parameter setting.

MOOG                       ID No.:CB40859-001 Date:11/2020

# 11 Alarms & warnings

# 11.6.16.2     Error 15-2 (emergency code 2350h)

Cause:  Error while init I2t monitoring

# Suggested steps:

- Please check the parameter of the motor protection.
- This issue is probably caused by an unsuitable parameter setting.
- Save your parameter set for a later restore.
- See 'history of parameter changes' and undo the latest changes.
- Please check your parameter set for implausible settings.
- Please set device to factory setting, restart, and see if the error occurs again.
- When reporting this error to your service partner, please include your device's parameter setting.

MSD ServoDrive  - DeviceHelp    354

# 11 Alarms & warnings

MOOG ID No.:CB40859-001 Date:11/2020

# 11.6.16.3 Error 15-3 (emergency code FF00h)

Cause: Error: Timeout during auto commutation

Suggested steps:

- Please check auto commutation parameters
- This issue is probably caused by an unsuitable parameter setting.
- Save your parameter set for a later restore.
- See 'history of parameter changes' and undo the latest changes.
- Please check your parameter set for implausible settings.
- Please set device to factory setting, restart, and see if the error occurs again.
- When reporting this error to your service partner, please include your device's parameter setting.

# 11.6.16.4 Error 15-4 (emergency code FF00h)

Cause: Error in motor model initialization

Suggested steps:

- Please check motor parameters and motor type
- This issue is probably caused by an unsuitable parameter setting.
- Save your parameter set for a later restore.
- See 'history of parameter changes' and undo the latest changes.
- Please check your parameter set for implausible settings.
- Please set device to factory setting, restart, and see if the error occurs again.
- When reporting this error to your service partner, please include your device's parameter setting.

# 11.6.16.5

# Error 15-5 (emergency code FF00h)

Cause: Error while initializing control

# Suggested steps:

Please check switching frequency, voltage level, and device type

This issue is probably caused by an unsuitable parameter setting.

- Save your parameter set for a later restore.
- See 'history of parameter changes' and undo the latest changes.
- Please check your parameter set for implausible settings.
- Please set device to factory setting, restart, and see if the error occurs again.
- When reporting this error to your service partner, please include your device's parameter setting.

MOOG ID No.:CB40859-001 Date:11/2020

# 11 Alarms & warnings

# 11.6.16.6

# Error 15-6 (emergency code 6320h)

Cause: Error while initializing the standardization parameters

# Suggested steps:

Please check the standardization parameter settings

This issue is probably caused by an unsuitable parameter setting.

- Save your parameter set for a later restore.
- See 'history of parameter changes' and undo the latest changes.
- Please check your parameter set for implausible settings.
- Please set device to factory setting, restart, and see if the error occurs again.
- When reporting this error to your service partner, please include your device's parameter setting.

MSD ServoDrive - DeviceHelp 356

# 11 Alarms & warnings

MOOG ID No.:CB40859-001 Date:11/2020

# 11.6.16.7 Error 15-7 (emergency code 6320h)

Cause: Encoder gear ratio vs. line count out of range

# Suggested steps:

- Please check encoder parameters
- This issue is probably caused by an unsuitable parameter setting.
- Save your parameter set for a later restore.
- See 'history of parameter changes' and undo the latest changes.
- Please check your parameter set for implausible settings.
- Please set device to factory setting, restart, and see if the error occurs again.
- When reporting this error to your service partner, please include your device's parameter setting.

# 11.6.16.8 Error 15-8 (emergency code 8400h)

Cause: Unknown speed calculation method selected

# Suggested steps:

- Please check the parameters of the speed observer (P350)
- This issue is probably caused by an unsuitable parameter setting.
- Save your parameter set for a later restore.
- See 'history of parameter changes' and undo the latest changes.
- Please check your parameter set for implausible settings.
- Please set device to factory setting, restart, and see if the error occurs again.
- When reporting this error to your service partner, please include your device's parameter setting.

# 11. Alarms & warnings

# 11.6.16.9 Error 15-9 (emergency code FF00h)

Cause: Error in observer or filter initialization.

Suggested steps:

- This issue is probably caused by an unsuitable parameter setting.
- Save your parameter set for a later restore.
- See 'history of parameter changes' and undo the latest changes.
- Please check your parameter set for implausible settings.
- Please set device to factory setting, restart, and see if the error occurs again.
- When reporting this error to your service partner, please include your device's parameter setting.

# 11.6.16.10 Error 15-10 (emergency code 8300h)

Cause: Error initializing current control.

Suggested steps:

- This issue is probably caused by an unsuitable parameter setting.
- Save your parameter set for a later restore.
- See 'history of parameter changes' and undo the latest changes.
- Please check your parameter set for implausible settings.
- Please set device to factory setting, restart, and see if the error occurs again.
- When reporting this error to your service partner, please include your device's parameter setting.

An overcurrent was detected.

- Please check current control settings and step response.
- Check the motor's saturation settings (parameter MOT_LSigDiff). If the error occurred in high-current range, lower saturation values manually.
- If possible, reduce the needed current, especially in low-frequency range.
- If possible, lower the switching frequency or enable automatic frequency selection.
- Check if the encoder offset is set properly.
- Consider using an axis module with higher current rating.

MOOG ID No.:CB40859-001 Date:11/2020

MSD ServoDrive - DeviceHelp 358

# 11 Alarms & warnings

MOOG ID No.:CB40859-001 Date:11/2020

# 11.6.16.11 Error 15-12 (emergency code FF00h)

Cause: Plant inertia / mass is invalid

Suggested steps:

- Please specify motor inertia or try to identify plant inertia
- This issue is probably caused by an unsuitable parameter setting.
- Save your parameter set for a later restore.
- See 'history of parameter changes' and undo the latest changes.
- Please check your parameter set for implausible settings.
- Please set device to factory setting, restart, and see if the error occurs again.
- When reporting this error to your service partner, please include your device's parameter setting.

# 11.6.16.12 Error 15-13 (emergency code FF00h)

Cause: Drive commissioning: Watchdog failure via service tool access

Suggested steps:

- Check your network connection

# 11.6.16.13 Error 15-14 (emergency code FF00h)

Cause: Drive initialization: Unexpected error during drive initialization

Suggested steps:

- Check the drives parameter settings
- This issue is probably caused by an unsuitable parameter setting.
- Save your parameter set for a later restore.
- See 'history of parameter changes' and undo the latest changes.
- Please check your parameter set for implausible settings.
- Please set device to factory setting, restart, and see if the error occurs again.
- When reporting this error to your service partner, please include your device's parameter setting.

# 11.6.16.14 Error 15-15 (emergency code FF00h)

Cause: Parameter: Auto save to MMC failed

Suggested steps:

- Check MMC or disable function

# 11.6.16.15 Error 15-16 (emergency code FF00h)

Cause: Selected switch frequency is not possible

# Suggested steps:

- Change switch frequency or disable PWM-frequency switching
- This issue is probably caused by an unsuitable parameter setting.
- Save your parameter set for a later restore.
- See 'history of parameter changes' and undo the latest changes.
- Please check your parameter set for implausible settings.
- Please set device to factory setting, restart, and see if the error occurs again.
- When reporting this error to your service partner, please include your device's parameter setting.

# 11.6.16.16 Error 15-17 (emergency code FF00h)

Cause: Autotuning mode not supported (in this configuration)

# Suggested steps:

Please use other autotuning mode or tune by hand

# 11.6.16.17 Error 15-18 (emergency code FF00h)

Cause: Error in power fail initialization

# Suggested steps:

Check power fail parameters or disable function

# 11.6.16.18 Error 15-19 (emergency code FF00h)

Cause: Error in camming or electronic gearing initialization

# Suggested steps:

Check parameter or IEC configuration

# 11.6.16.19 Error 15-20 (emergency code FF00h)

Cause: Error in configuration of CAM module

# Suggested steps:

Check for even number of configured cam edges. All configured cam edges have to be in ascending order.

# 11.6.16.20 Error 15-21 (emergency code FF00h)

Cause: Dataset to be loaded is not valid

# Suggested steps:

- Check Parameter PRam_PARA_DataSetLdVal
- This issue is probably caused by an unsuitable parameter setting.
- Save your parameter set for a later restore.
- See 'history of parameter changes' and undo the latest changes.
- Please check your parameter set for implausible settings.
- Please set device to factory setting, restart, and see if the error occurs again.
- When reporting this error to your service partner, please include your device's parameter setting.

MOOG ID No.:CB40859-001 Date:11/2020

11 Alarms & warnings

# 11 Alarms & warnings

MOOG ID No.:CB40859-001 Date:11/2020

MSD ServoDrive - DeviceHelp 361

# 11.6.16.21 Error 15-22 (emergency code FF00h)

Cause: Invalid production data detected

# Suggested steps:

- Please contact your service provider
- This issue is probably caused by an unsuitable parameter setting.
- Save your parameter set for a later restore.
- See 'history of parameter changes' and undo the latest changes.
- Please check your parameter set for implausible settings.
- Please set device to factory setting, restart, and see if the error occurs again.
- When reporting this error to your service partner, please include your device's parameter setting.

# 11.6.16.22 Error 15-23 (emergency code FF00h)

Cause: Parameter settings requires a valid software key

# Suggested steps:

- Please contact your service provider
- This is probably a software issue.
- Please try to switch to a different version of device firmware.
- Save your dataset and reset the axis module to factory setting. See if the error persists, or if it comes with activating a certain feature.

# This is possibly a hardware issue

If other measures fail to solve the problem, please replace the servo drive.

# 11.6.17 Error 16: Speed difference error

# 11.6.17.1 Error 16-1 (emergency code 8400h)

Cause: Speed tracking error too large

# Suggested steps:

- Check your parameter P744

The control system failed to track the reference value

- Please check if the axis is blocked.
- Try to reduce acceleration or deceleration.
- If reference speed is higher than the motor rated speed, please check field weakening settings. In field-weakening range, the available torque per current is reduced.

The speed control might run away, most likely due to a wrong encoder offset.

- Please check that the encoder offset is set properly.
- If auto commutation is used, re-view the auto commutation setting and test under all possible conditions.
- If torque mode is used, reduce torque, ensure external speed limitation, or increase speed control gain for stronger limitation.

This is possibly an EMC issue. This is very likely if the problem occurs when switching on motor control and/or when connecting DC link power supply.

- Please check the device cabling for proper connection.
- Please check device grounding, i.e. the connection to a metal backplane and cabinet connection to earth.
- Check motor grounding and motor cable length.

MOOG ID No.:CB40859-001 Date:11/2020

# 11 Alarms & warnings

# 11.6.17.2 Error 16-2 (emergency code 8400h)

Cause: Current speed above maximum speed of motor > 120%

# Suggested steps:

- Check your parameter data set

The control system failed to track the reference value

- Please check if the axis is blocked.
- Try to reduce acceleration or deceleration.
- If reference speed is higher than the motor rated speed, please check field weakening settings. In field-weakening range, the available torque per current is reduced.

The speed control might run away, most likely due to a wrong encoder offset.

- Please check that the encoder offset is set properly.
- If auto commutation is used, re-view the auto commutation setting and test under all possible conditions.
- If torque mode is used, reduce torque, ensure external speed limitation, or increase speed control gain for stronger limitation.

This is possibly an EMC issue. This is very likely if the problem occurs when switching on motor control and/or when connecting DC link power supply.

- Please check the device cabling for proper connection.
- Please check device grounding, i.e. the connection to a metal backplane and cabinet connection to earth.
- Check motor grounding and motor cable length.

# 11 Alarms & warnings

# MOOG

ID No.: CB40859-001 Date: 11/2020

# MSD ServoDrive - DeviceHelp

# 11.6.18 Error 17: Position difference error

# 11.6.18.1 Error 17-1 (emergency code 8611h)

Cause: Position tracking error too large

Suggested steps:

- Check your parameter P743
- The control system failed to track the reference value
- Please check if the axis is blocked.
- Try to reduce acceleration or deceleration.
- If reference speed is higher than the motor rated speed, please check field weakening settings. In field-weakening range, the available torque per current is reduced.
- Please check that the encoder offset is set properly.
- If auto commutation is used, re-view the auto commutation setting and test under all possible conditions.
- If torque mode is used, reduce torque, ensure external speed limitation, or increase speed control gain for stronger limitation.

This is possibly an EMC issue. This is very likely if the problem occurs when switching on motor control and/or when connecting DC link power supply.

- Please check the device cabling for proper connection.
- Please check device grounding, i.e. the connection to a metal backplane and cabinet connection to earth.
- Check motor grounding and motor cable length.

# 11.6.19 Error 18: Motion control error

# 11.6.19.1 Error 18-1 (emergency code 8612h)

Cause: Homing: Limit switches interchanged

Suggested steps:

- Check limit switches
- There is a problem with the digital/analog inputs
- Please check the 24V I/O wiring, function assignment and inversion parameters.
- Please check connected switches for chattering. Consider using the input filter.

This is possibly an EMC issue. This is very likely if the problem occurs when switching on motor control and/or when connecting DC link power supply.

- Please check the device cabling for proper connection.
- Please check device grounding, i.e. the connection to a metal backplane and cabinet connection to earth.
- Check motor grounding and motor cable length.

# 11.6.19.2 Error 18-2 (emergency code 8612h)

Cause: Homing: Limit switch tripped unexpectedly

# Suggested steps:

- Please check the home switch
- There is a problem with the digital/analog inputs
- - Please check the 24V I/O wiring, function assignment and inversion parameters.
- Please check connected switches for chattering. Consider using the input filter.

This is possibly an EMC issue. This is very likely if the problem occurs when switching on motor control and/or when connecting DC link power supply.

# 11.6.19.3 Error 18-3 (emergency code 8612h)

Cause: Homing: Limit switch error

# Suggested steps:

- Please check the limit switches.
- There is a problem with the digital/analog inputs
- - Please check the 24V I/O wiring, function assignment and inversion parameters.
- Please check connected switches for chattering. Consider using the input filter.

This is possibly an EMC issue. This is very likely if the problem occurs when switching on motor control and/or when connecting DC link power supply.

# 11.6.19.4 Error 18-4 (emergency code FF00h)

Cause: Homing: Wrong homing method, homing method not available

# Suggested steps:

- Please restart the application (24V reset).
- If the error is still reported after the restart please contact your service partner.
- An error occurred at the homing method.
- Please acknowledge the error.
- Please start the homing method again.

MOOG ID No.:CB40859-001 Date:11/2020

MSD ServoDrive - DeviceHelp 364

# 11 Alarms & warnings

# 11 Alarms & warnings

MOOG ID No.:CB40859-001 Date:11/2020

# 11.6.19.5 Error 18-5 (emergency code FF00h)

Cause: Homing: Homing method available but not defined

Suggested steps: Homing is not available with this motion profile. Please select another homing method.

# 11.6.19.6 Error 18-6 (emergency code FF00h)

Cause: Homing: Drive not ready for homing: Error is triggered when the motor is not stopped, or the standstill bit is not set (Standstill window).

Suggested steps: Please stop the motor. Check the position window parameter 746 [0] (subject area limits).

# 11.6.19.7 Error 18-7 (emergency code FF00h)

Cause: Homing: Drive not ready for jog mode

Suggested steps: Please stop the motor. Check the position window parameter 746 [0] (subject area limits).

# 11.6.19.8 Error 18-8 (emergency code FF00h)

Cause: Homing: Control mode does not match homing method

Suggested steps: Homing is only possible in position control mode.

# 11.6.19.9 Error 18-9 (emergency code FF00h)

Cause: Homing: Encoder initialization error

Suggested steps: The homing during device start-up was not performed due to an internal error. Please restart the application (24V reset).

An error occurred at the homing method. Please acknowledge the error. Please start the homing method again.

# 11.6.19.10 Error 18-10 (emergency code FF00h)

Cause: Homing: Homing travel exceeded

Suggested steps:

- The zero pulse has not been reached within the permissible distance. Please check the zero pulse of the encoder and the parameter 169[0] for the maximum distance.
- Please check whether the encoder is working correctly.

# 11.6.19.11 Error 18-11 (emergency code FF00h)

Cause: Max. permissible tracking error on "Start control" exceeded

Suggested steps:

- Reset error and start again
- An error occurred at the homing method. Please acknowledge the error.
- Please start the homing method again.

MSD ServoDrive - DeviceHelp 365

# 11 Alarms & warnings

# 11.6.19.12 Error 18-12 (emergency code FF00h)

# 11.6.20 Error 19: Fatal error

Cause: Memory overflow for table values

# 11.6.20.1 Error 19-1 (emergency code 5400h)

Cause: PST: Data index too large

# Suggested steps:

- Call your service provider.
- This is probably a software issue.
- Please try to switch to a different version of device firmware.
- Save your dataset and reset the axis module to factory setting. See if the error persists, or if it comes with activating a certain feature.
- This is possibly a hardware issue.
- If other measures fail to solve the problem, please replace the servo drive.

# 11.6.19.13 Error 18-13 (emergency code FF00h)

Cause: Error initializing last actual position after restart.

# Suggested steps:

- Reset error and start again
- An error occurred at the homing method.
- Please acknowledge the error.
- Please start the homing method again.

# 11.6.20.2 Error 19-2 (emergency code 5400h)

Cause: PST: Error in switching frequency-dependent data

# Suggested steps:

- Call your service provider.
- This is probably a software issue.
- Please try to switch to a different version of device firmware.
- Save your dataset and reset the axis module to factory setting. See if the error persists, or if it comes with activating a certain feature.
- This is possibly a hardware issue.
- If other measures fail to solve the problem, please replace the servo drive.

MOOG ID No.:CB40859-001 Date:11/2020

MSD ServoDrive - DeviceHelp 366

# 11 Alarms & warnings

# MOOG

ID No.: CB40859-001 Date: 11/2020

# MSD ServoDrive - DeviceHelp

367

# 11.6.20.3 Error 19-3 (emergency code 5400h)

Cause: PST: Invalid EEPROM data

# Suggested steps:

- Call your service provider.
- This is probably a software issue.
- - Please try to switch to a different version of device firmware.
- Save your dataset and reset the axis module to factory setting. See if the error persists, or if it comes with activating a certain feature.

This is possibly a hardware issue.

# 11.6.20.4 Error 19-4 (emergency code 5400h)

Cause: PST: CRC error

# Suggested steps:

- Call your service provider.
- This is probably a software issue.
- - Please try to switch to a different version of device firmware.
- Save your dataset and reset the axis module to factory setting. See if the error persists, or if it comes with activating a certain feature.

This is possibly a hardware issue.

# 11.6.20.5 Error 19-5 (emergency code 5400h)

Cause: PST: Error reading power stage data

# Suggested steps:

- Call your service provider.
- This is probably a software issue.
- - Please try to switch to a different version of device firmware.
- Save your dataset and reset the axis module to factory setting. See if the error persists, or if it comes with activating a certain feature.

This is possibly a hardware issue.

# 11.6.20.6 Error 19-6 (emergency code 5400h)

Cause: PST: Error writing power stage data

# Suggested steps:

- Call your service provider.
- This is probably a software issue.
- - Please try to switch to a different version of device firmware.
- Save your dataset and reset the axis module to factory setting. See if the error persists, or if it comes with activating a certain feature.

This is possibly a hardware issue.

# 11 Alarms & warnings

# 11.6.20.7     Error 19-7 (emergency code 5420h)

Cause:  Current in braking resistor even though transistor switched off

Suggested steps:

- Call your service provider.
- This is possibly a hardware issue. If other measures fail to solve the problem, please replace the servo drive.

# 11.6.20.8     Error 19-8 (emergency code 5300h)

Cause:  Hardware identification failed

Suggested steps:

- Switch off/on device. Please contact your service provider if this error occurs again.
- This is probably a software issue. Please try to switch to a different version of device firmware.
- Save your dataset and reset the axis module to factory setting. See if the error persists, or if it comes with activating a certain feature.
- This is possibly a hardware issue. If other measures fail to solve the problem, please replace the servo drive.

# 11.6.20.10      Error 19-10 (emergency code 5300h)

Cause:  Initialisation of runtime system failed

Suggested steps:

- Switch off/on device. Please contact your service provider if this error occurs again.
- This is probably a software issue. Please try to switch to a different version of device firmware.
- Save your dataset and reset the axis module to factory setting. See if the error persists, or if it comes with activating a certain feature.
- This is possibly a hardware issue. If other measures fail to solve the problem, please replace the servo drive.

MOOG                       ID No.:CB40859-001 Date:11/2020

MSD ServoDrive  - DeviceHelp    368

# 11 Alarms & warnings

# MOOG

ID No.: CB40859-001 Date: 11/2020

# MSD ServoDrive - DeviceHelp

369

# 11.6.20.11 Error 19-11 (emergency code 5300h)

Cause: Software licence key or level is invalid

Suggested steps:

- Please contact your service provider
- This is probably a software issue.
- Please try to switch to a different version of device firmware.
- Save your dataset and reset the axis module to factory setting. See if the error persists, or if it comes with activating a certain feature.

# 11.6.20.12 Error 19-12 (emergency code 5300h)

Cause: No ram memory for communication option available

Suggested steps:

- Switch off/on device. Please contact your service provider if this error occurs again
- This is probably a software issue.
- Please try to switch to a different version of device firmware.
- Save your dataset and reset the axis module to factory setting. See if the error persists, or if it comes with activating a certain feature.

This is possibly a hardware issue. If other measures fail to solve the problem, please replace the servo drive.

# 11.6.20.13 Error 19-13 (emergency code 5300h)

Cause: Error while FPGA programming

Suggested steps:

- Switch off/on device. Please contact your service provider if this error occurs again
- This is probably a software issue.
- Please try to switch to a different version of device firmware.
- Save your dataset and reset the axis module to factory setting. See if the error persists, or if it comes with activating a certain feature.

This is possibly a hardware issue. If other measures fail to solve the problem, please replace the servo drive.

# 11.6.20.14 Error 19-14 (emergency code 5300h)

Cause: Error while loading a dynamic software module

Suggested steps:

- Switch off/on device. Please contact your service provider if this error occurs again
- This is probably a software issue.
- Please try to switch to a different version of device firmware.

# 11 Alarms & warnings

|11.6.20.15|Error 19-15 (emergency code 5300h)|
|---|---|
|Cause:|Error in initialization of protected memory|
|Suggested steps:|- Switch off/on device. Please contact your service provider if this error occurs again
- This is probably a software issue.
- Please try to switch to a different version of device firmware.
- Save your dataset and reset the axis module to factory setting. See if the error persists, or if it comes with activating a certain feature.
|
|11.6.20.17|Error 19-17 (emergency code 5300h)|
|Cause:|Safety-system run-up with illegal firmware!|
|Suggested steps:|- Process firmware-update and process power on (24V) reset!
- This is probably a software issue.
- Please try to switch to a different version of device firmware.
- Save your dataset and reset the axis module to factory setting. See if the error persists, or if it comes with activating a certain feature.
|
|11.6.20.16|Error 19-16 (emergency code 5300h)|
|Cause:|File access on device not complete|
|Suggested steps:|- File transfer interrupted, file maybe corrupt, login and try again!
- This is probably a software issue.
- Please try to switch to a different version of device firmware.
- Save your dataset and reset the axis module to factory setting. See if the error persists, or if it comes with activating a certain feature.
|
|11.6.20.18|Error 19-18 (emergency code 5300h)|
|Cause:|Firmware-update of safety-system failed!|
|Suggested steps:|- Process power on (24V) reset!
|
|11.6.20.19|Error 19-19 (emergency code 5300h)|
|Cause:|System run-up with illegal FPGA firmware!|
|Suggested steps:|- Update the FPGA with the correct firmware!
- This is probably a software issue.
- Please try to switch to a different version of device firmware.
- Save your dataset and reset the axis module to factory setting. See if the error persists, or if it comes with activating a certain feature.
|

MOOG ID No.:CB40859-001 Date:11/2020

MSD ServoDrive - DeviceHelp 370

# 11 Alarms & warnings

# MOOG

ID No.: CB40859-001 Date: 11/2020

# MSD ServoDrive - DeviceHelp

# 11.6.20.20 Error 19-20 (emergency code 5300h)

Cause: Safety production data invalid (no data or CRC failure)

Suggested steps:

- Update of safety production data required, contact your service provider
- This is probably a software issue.
- Please try to switch to a different version of device firmware.
- Save your dataset and reset the axis module to factory setting. See if the error persists, or if it comes with activating a certain feature.

# 11.6.20.21 Error 19-21 (emergency code 5300h)

Cause: Failure in code data area (ROM) detected

Suggested steps:

- Switch off/on device. Please contact your service provider if this error occurs again

# 11.6.20.22 Error 19-22 (emergency code 5300h)

Cause: Functionality or hardware not supported in this software version

Suggested steps:

- Please contact your service provider
- This is probably a software issue.
- Please try to switch to a different version of device firmware.
- Save your dataset and reset the axis module to factory setting. See if the error persists, or if it comes with activating a certain feature.
- This is possibly a hardware issue. If other measures fail to solve the problem, please replace the servo drive.

# 11.6.20.23 Error 19-23 (emergency code 6100h)

Cause: Fatal error on safety controller SR1 detected

Suggested steps:

- Read additional information, check safety system and switch off/on device to acknowledge error

# 11.6.20.24 Error 19-24 (emergency code 6100h)

Cause: Fatal error on safety controller SR2 detected

Suggested steps:

- Read additional information, check safety system and switch off/on device to acknowledge error

# 11.6.21 Error 20: Hardware limit switch error

# 11.6.21.1 Error 20-1 (emergency code 8612h)

Cause: Hardware limit switches interchanged

# Suggested steps:

Check your hardware

- Position was limited internally.
- Please check factor group setting and position command.
- Take a scope record to determine if the position control overshoots.

There is a problem with the digital/analog inputs

- Please check the 24V I/O wiring, function assignment and inversion parameters.
- Please check connected switches for chattering. Consider using the input filter.

The speed control might run away, most likely due to a wrong encoder offset.

- Please check that the encoder offset is set properly.
- If auto commutation is used, re-view the auto commutation setting and test under all possible conditions.
- If torque mode is used, reduce torque, ensure external speed limitation, or increase speed control gain for stronger limitation.

MOOG ID No.:CB40859-001 Date:11/2020

# 11.6.21.2 Error 20-2 (emergency code 8612h)

Cause: Positive hardware limit switch (LSW_P) detected

# Suggested steps:

Check your hardware

- Position was limited internally.
- Please check factor group setting and position command.
- Take a scope record to determine if the position control overshoots.

There is a problem with the digital/analog inputs

- Please check the 24V I/O wiring, function assignment and inversion parameters.
- Please check connected switches for chattering. Consider using the input filter.

The speed control might run away, most likely due to a wrong encoder offset.

- Please check that the encoder offset is set properly.
- If auto commutation is used, re-view the auto commutation setting and test under all possible conditions.
- If torque mode is used, reduce torque, ensure external speed limitation, or increase speed control gain for stronger limitation.

MSD ServoDrive - DeviceHelp 372

# 11 Alarms & warnings

# MOOG

ID No.: CB40859-001 Date: 11/2020

# MSD ServoDrive - DeviceHelp

373

# 11.6.21.3 Error 20-3 (emergency code 8612h)

Cause: Negative hardware limit switch (LSW_N) detected

# Suggested steps:

- Check your hardware
- Position was limited internally.
- Please check factor group setting and position command
- Take a scope record to determine if the position control overshoots.
- There is a problem with the digital/analog inputs
- Please check the 24V I/O wiring, function assignment and inversion parameters.
- Please check connected switches for chattering. Consider using the input filter.
- Please check that the encoder offset is set properly.
- If auto commutation is used, re-view the auto commutation setting and test under all possible conditions.
- If torque mode is used, reduce torque, ensure external speed limitation, or increase speed control gain for stronger limitation.

# 11.6.22.1 Error 21-2 (emergency code 7305h)

Cause: Electronic nameplate, interface, group error: no further information available.

# Suggested steps:

- Function "Electronic nameplate" not available. Please contact your service provider.
- ENP: The "Electronic Nameplate" (ENP) is located in the OEM memory of the motor encoder and contains primarily motor related data.
- In the simplest case, the ENP contains only the commutation angle (ECOFF) between motor phases and encoder mounting.

# 11.6.22.2 Error 21-3 (emergency code 7305h)

Cause: Electronic nameplate, parameterization: ENP operation is switched off.

# Suggested steps:

- Function "Electronic nameplate" not available. Please contact your service provider.
- ENP: The "Electronic Nameplate" (ENP) is located in the OEM memory of the motor encoder and contains primarily motor related data.
- In the simplest case, the ENP contains only the commutation angle (ECOFF) between motor phases and encoder mounting.

# 11.6.22 Error 21: Initialization, common error

Group error initialization

# Suggested steps:

- This is a common error number used for several initialization errors, which have no own error number.

# 11.6.22.3 Error 21-4 (emergency code 7305h)

Cause: Electronic nameplate, parameterization: ENP operation is not supported by firmware.

Suggested steps:

Function "Electronic nameplate" not available. Please contact your service provider.

ENP

- The "Electronic Nameplate" (ENP) is located in the OEM memory of the motor encoder and contains primarily motor related data.
- In the simplest case, the ENP contains only the commutation angle (ECOFF) between motor phases and encoder mounting.

# 11.6.22.4 Error 21-5 (emergency code 7305h)

Cause: Electronic nameplate, OEM data: no OEM memory defined in the encoder.

Suggested steps:

Function "Electronic nameplate" not available. Please contact your service provider.

ENP

- The "Electronic Nameplate" (ENP) is located in the OEM memory of the motor encoder and contains primarily motor related data.
- In the simplest case, the ENP contains only the commutation angle (ECOFF) between motor phases and encoder mounting.

# 11.6.22.5 Error 21-6 (emergency code 7305h)

Cause: Electronic nameplate, OEM data: no ENP defined in the OEM memory of the encoder.

Suggested steps:

Function "Electronic nameplate" not available. Please contact your service provider.

ENP

- The "Electronic Nameplate" (ENP) is located in the OEM memory of the motor encoder and contains primarily motor related data.
- In the simplest case, the ENP contains only the commutation angle (ECOFF) between motor phases and encoder mounting.

# 11.6.22.6 Error 21-7 (emergency code 7305h)

Cause: Electronic nameplate, parameterization: no order for ENP operation.

Suggested steps:

Define an order for ENP operation. Please contact your service provider.

ENP

- The "Electronic Nameplate" (ENP) is located in the OEM memory of the motor encoder and contains primarily motor related data.
- In the simplest case, the ENP contains only the commutation angle (ECOFF) between motor phases and encoder mounting.

MOOG ID No.:CB40859-001 Date:11/2020

# 11 Alarms & warnings

# 11 Alarms & warnings

MOOG ID No.:CB40859-001 Date:11/2020

# 11.6.22.7 Error 21-10 (emergency code 7305h)

Cause: Electronic nameplate, OEM data error, FindBlock: block with number BN not found.

Suggested steps:

- Function "Electronic nameplate" not available. Please contact your service provider.

ENP

- The "Electronic Nameplate" (ENP) is located in the OEM memory of the motor encoder and contains primarily motor related data.
- In the simplest case, the ENP contains only the commutation angle (ECOFF) between motor phases and encoder mounting.

# 11.6.22.8 Error 21-11 (emergency code 7305h)

Cause: Electronic nameplate, OEM data: data CRC check failed (DCRC).

Suggested steps:

- Function "Electronic nameplate" only partially available. Please contact your service provider.

ENP

- The "Electronic Nameplate" (ENP) is located in the OEM memory of the motor encoder and contains primarily motor related data.
- In the simplest case, the ENP contains only the commutation angle (ECOFF) between motor phases and encoder mounting.

# 11.6.22.9 Error 21-12 (emergency code 7305h)

Cause: Electronic nameplate, process block error: group error from short frame check of the block being read.

Suggested steps:

- Function "Electronic nameplate" not available. Please contact your service provider.

ENP

- The "Electronic Nameplate" (ENP) is located in the OEM memory of the motor encoder and contains primarily motor related data.
- In the simplest case, the ENP contains only the commutation angle (ECOFF) between motor phases and encoder mounting.

# 11.6.22.10 Error 21-13 (emergency code 7305h)

Cause: Electronic nameplate, process block error: parameter write access error (group error from return of internal parameter access).

Suggested steps:

- Function "Electronic nameplate" not available. Please contact your service provider.

ENP

- The "Electronic Nameplate" (ENP) is located in the OEM memory of the motor encoder and contains primarily motor related data.
- In the simplest case, the ENP contains only the commutation angle (ECOFF) between motor phases and encoder mounting.

# 11 Alarms & warnings

# 11.6.22.11 Error 21-21 (emergency code 7305h)

Cause: Electronic nameplate, process block error: SpecialBlock (no further information available).

Suggested steps:

Function "Electronic nameplate" not available. Please contact your service provider.

ENP

- The "Electronic Nameplate" (ENP) is located in the OEM memory of the motor encoder and contains primarily motor related data.
- In the simplest case, the ENP contains only the commutation angle (ECOFF) between motor phases and encoder mounting.

# 11.6.22.12 Error 21-22 (emergency code 7305h)

Cause: Electronic nameplate, process block error: block 2 ECOFF (no further information available).

Suggested steps:

Function "Electronic nameplate" not available. Please contact your service provider.

ENP

- The "Electronic Nameplate" (ENP) is located in the OEM memory of the motor encoder and contains primarily motor related data.
- In the simplest case, the ENP contains only the commutation angle (ECOFF) between motor phases and encoder mounting.

# 11.6.22.13 Error 21-23 (emergency code 7305h)

Cause: Electronic nameplate, process block error: block 3 MotIdent (no further information available).

Suggested steps:

Function "Electronic nameplate" not available. Please contact your service provider.

ENP

- The "Electronic Nameplate" (ENP) is located in the OEM memory of the motor encoder and contains primarily motor related data.
- In the simplest case, the ENP contains only the commutation angle (ECOFF) between motor phases and encoder mounting.

# 11.6.22.14 Error 21-24 (emergency code 7305h)

Cause: Electronic nameplate, process block error: block 4 MotDat PMSM (no further information available).

Suggested steps:

Function "Electronic nameplate" not available. Please contact your service provider.

ENP

- The "Electronic Nameplate" (ENP) is located in the OEM memory of the motor encoder and contains primarily motor related data.
- In the simplest case, the ENP contains only the commutation angle (ECOFF) between motor phases and encoder mounting.

MOOG ID No.:CB40859-001 Date:11/2020

# 11 Alarms & warnings

MOOG ID No.:CB40859-001 Date:11/2020

# 11.6.22.15 Error 21-25 (emergency code 7305h)

Cause: Electronic nameplate, process block error: block 5 EncFeedback (no further information available).

Suggested steps:

Function "Electronic nameplate" not available. Please contact your service provider.

ENP

- The "Electronic Nameplate" (ENP) is located in the OEM memory of the motor encoder and contains primarily motor related data.
- In the simplest case, the ENP contains only the commutation angle (ECOFF) between motor phases and encoder mounting.

# 11.6.22.16 Error 21-26 (emergency code 7305h)

Cause: Electronic nameplate, process block error: block 6 MotProtection (no further information available).

Suggested steps:

Function "Electronic nameplate" not available. Please contact your service provider.

ENP

- The "Electronic Nameplate" (ENP) is located in the OEM memory of the motor encoder and contains primarily motor related data.
- In the simplest case, the ENP contains only the commutation angle (ECOFF) between motor phases and encoder mounting.

# 11.6.22.17 Error 21-27 (emergency code 7305h)

Cause: Electronic nameplate, process block error: block 7 MotBreak (no further information available).

Suggested steps:

Function "Electronic nameplate" not available. Please contact your service provider.

ENP

- The "Electronic Nameplate" (ENP) is located in the OEM memory of the motor encoder and contains primarily motor related data.
- In the simplest case, the ENP contains only the commutation angle (ECOFF) between motor phases and encoder mounting.

# 11.6.22.18 Error 21-28 (emergency code 7305h)

Cause: Electronic nameplate, process block error: block 8 Actuator (no further information available).

Suggested steps:

Function "Electronic nameplate" not available. Please contact your service provider.

ENP

- The "Electronic Nameplate" (ENP) is located in the OEM memory of the motor encoder and contains primarily motor related data.
- In the simplest case, the ENP contains only the commutation angle (ECOFF) between motor phases and encoder mounting.

MSD ServoDrive - DeviceHelp 377

# 11 Alarms & warnings

# 11.6.22.19 Error 21-29 (emergency code 7305h)

Cause: Electronic nameplate, process block error: block 9 MotComp (no further information available).

Suggested steps:

Function "Electronic nameplate" not available. Please contact your service provider.

# ENP

- The "Electronic Nameplate" (ENP) is located in the OEM memory of the motor encoder and contains primarily motor related data.
- In the simplest case, the ENP contains only the commutation angle (ECOFF) between motor phases and encoder mounting.

# 11.6.22.20 Error 21-30 (emergency code 7305h)

Cause: Electronic nameplate, process block error: block 10 MotDatASM (no further information available).

Suggested steps:

Function "Electronic nameplate" not available. Please contact your service provider.

# ENP

- The "Electronic Nameplate" (ENP) is located in the OEM memory of the motor encoder and contains primarily motor related data.
- In the simplest case, the ENP contains only the commutation angle (ECOFF) between motor phases and encoder mounting.

# 11.6.22.21 Error 21-31 (emergency code 7305h)

Cause: Electronic nameplate, process block error: block 11 MotDatLin (no further information available).

Suggested steps:

Function "Electronic nameplate" not available. Please contact your service provider.

# ENP

- The "Electronic Nameplate" (ENP) is located in the OEM memory of the motor encoder and contains primarily motor related data.
- In the simplest case, the ENP contains only the commutation angle (ECOFF) between motor phases and encoder mounting.

# 11.6.22.22 Error 21-32 (emergency code 7305h)

Cause: Electronic nameplate, process block error: block 12 DevSpecDatDS2110 (no further information available).

Suggested steps:

Function "Electronic nameplate" not available. Please contact your service provider.

# ENP

- The "Electronic Nameplate" (ENP) is located in the OEM memory of the motor encoder and contains primarily motor related data.
- In the simplest case, the ENP contains only the commutation angle (ECOFF) between motor phases and encoder mounting.

MOOG ID No.:CB40859-001 Date:11/2020

# 11 Alarms & warnings

MOOG ID No.:CB40859-001 Date:11/2020

MSD ServoDrive - DeviceHelp 379

# 11.6.22.23 Error 21-33 (emergency code 7305h)

# 11.6.23 Error 22: Encoder channel 1, initialization error

Cause: Electronic nameplate, process block error: block 13 DevSpecDatServo1 (no further information available).

Suggested steps:

- Function "Electronic nameplate" not available. Please contact your service provider.

# ENP

- The "Electronic Nameplate" (ENP) is located in the OEM memory of the motor encoder and contains primarily motor related data.
- In the simplest case, the ENP contains only the commutation angle (ECOFF) between motor phases and encoder mounting.

# Initialization encoder channel 1

- Error during the initialization routines of encoder channel 1.
- In any case look at init outputs in the message window of the Moog DRIVEADMINISTRATOR 5.
- The most common cause of error is the wiring to the encoder.

# 11.6.23.1 Error 22-1 (emergency code 7305h)

Cause: Channel 1 Initialization, SinCos: Line count with SinCos absolute encoder must be 2^n

Suggested steps:

- Please enter a line count of 2^n (number of tracks).

# 11.6.23.2 Error 22-2 (emergency code 7305h)

Cause: Channel 1 Initialization, SinCos: timeout error, getting AB-SquareSum

Suggested steps:

- No further information available. Please contact your service provider.

# Initialization encoder channel 1

- Error during the initialization routines of encoder channel 1.
- In any case look at init outputs in the message window of the Moog DRIVEADMINISTRATOR 5.
- The most common cause of error is the wiring to the encoder.

# 11.6.23.3 Error 22-3 (emergency code 7305h)

Cause: Channel 1 Initialization, SinCos: error, encoder monitoring

Suggested steps:

- Please connect the encoder correctly.
- Initialization encoder
- Error during the initialization routines of channel 1 encoder channel 1.
- In any case look at init outputs in the message window of the Moog DRIVEADMINISTRATOR 5
- The most common cause of error is the wiring to the encoder.

# 11.6.23.4 Error 22-4 (emergency code 7305h)

Cause: Channel 1 Initialization, EndDat 2.1: error, no EnDat 2.1 encoder (May be, it's an SSI encoder!?)

Suggested steps:

- No further information available. Please contact your service provider.
- Initialization encoder
- Error during the initialization routines of channel 1 encoder channel 1.
- In any case look at init outputs in the message window of the Moog DRIVEADMINISTRATOR 5
- The most common cause of error is the wiring to the encoder.

# MOOG ID No.:CB40859-001 Date:11/2020

# 11 Alarms & warnings

# 11.6.23.5 Error 22-5 (emergency code 7305h)

Cause: Channel 1 Initialization, EndDat 2.1: error, 'Lines' read from encoder

Suggested steps:

- Please note additional Information in the message window of the Moog DRIVEADMINISTRATOR 5.
- Initialization encoder
- Error during the initialization routines of channel 1 encoder channel 1.
- In any case look at init outputs in the message window of the Moog DRIVEADMINISTRATOR 5.
- The most common cause of error is the wiring to the encoder.

# 11.6.23.6 Error 22-6 (emergency code 7305h)

Cause: Channel 1 Initialization, EndDat 2.1: error, 'MultiTurn' read from encoder

Suggested steps:

- Please note additional Information in the message window of the Moog DRIVEADMINISTRATOR 5.
- Initialization encoder
- Error during the initialization routines of channel 1 encoder channel 1.
- In any case look at init outputs in the message window of the Moog DRIVEADMINISTRATOR 5.
- The most common cause of error is the wiring to the encoder.

MSD ServoDrive - DeviceHelp 380

# 11 Alarms & warnings

MOOG ID No.:CB40859-001 Date:11/2020

# 11.6.23.7 Error 22-7 (emergency code 7305h)

Cause: Channel 1 Initialization, EndDat 2.1: error, 'SingleTurn' read from encoder

# Suggested steps:

- Please note additional Information in the message window of the Moog DRIVEADMINISTRATOR 5.
- Initialization encoder
- Error during the initialization routines of channel 1 encoder channel 1.
- In any case look at init outputs in the message window of the Moog DRIVEADMINISTRATOR 5.
- The most common cause of error is the wiring to the encoder.

# 11.6.23.8 Error 22-8 (emergency code 7305h)

Cause: Channel 1 Initialization, EndDat 2.1: CRC error, position data from encoder

# Suggested steps:

- The transmission is probably disturbed. Please check the wiring to the encoder.
- Initialization encoder
- Error during the initialization routines of channel 1 encoder channel 1.
- In any case look at init outputs in the message window of the Moog DRIVEADMINISTRATOR 5.
- The most common cause of error is the wiring to the encoder.

# 11.6.23.9 Error 22-9 (emergency code 7305h)

Cause: Channel 1 Initialization, EndDat 2.1: CRC error, parameter data from encoder

# Suggested steps:

- The transmission is probably disturbed. Please check the wiring to the encoder.
- Initialization encoder
- Error during the initialization routines of channel 1 encoder channel 1.
- In any case look at init outputs in the message window of the Moog DRIVEADMINISTRATOR 5.
- The most common cause of error is the wiring to the encoder.

# 11.6.23.10 Error 22-10 (emergency code 7305h)

Cause: Channel 1 Initialization, EndDat 2.1: not allowed write operation to write protected cells or protection cells of the encoder

# Suggested steps:

- No further information available. Please contact your service provider.
- Initialization encoder
- This is probably a software problem!
- In any case look at init outputs in the message window of the Moog DRIVEADMINISTRATOR 5.

MSD ServoDrive - DeviceHelp 381

# 11 Alarms & warnings

# 11.6.23.11 Error 22-15 (emergency code 7305h)

Cause: Channel 1 Initialization, SSI: 'MultiTurn' from parameter (543) ENC_CH1_MultiT

Suggested steps:

- Change the input of the multiturn bits of the parameter.
- Initialization encoder channel
- This is probably a problem of the parameterization!
- In any case look at init outputs in the message window of the Moog DRIVEADMINISTRATOR 5.

# 11.6.23.12 Error 22-16 (emergency code 7305h)

Cause: Channel 1 Initialization, SSI: 'SingleTurn' from parameter (544) ENC_CH1_SingleT

Suggested steps:

- Change the input of the singleturn bits of the parameter.
- Initialization encoder channel
- This is probably a problem of the parameterization!
- In any case look at init outputs in the message window of the Moog DRIVEADMINISTRATOR 5.

# 11.6.23.13 Error 22-17 (emergency code 7305h)

Cause: Channel 1 Initialization, SSI: parity error, position data from encoder

Suggested steps:

- Initialization encoder channel 1.
- Error during the initialization routines of encoder channel 1.
- In any case look at init outputs in the message window of the Moog DRIVEADMINISTRATOR 5.
- The most common cause of error is the wiring to the encoder.

# 11.6.23.14 Error 22-20 (emergency code 7305h)

Cause: Channel 1 Initialization, SSI: encoder monitoring

Suggested steps:

- Check whether the encoder is correctly connected.
- Initialization encoder channel 1.
- Error during the initialization routines of encoder channel 1.
- In any case look at init outputs in the message window of the Moog DRIVEADMINISTRATOR 5.
- The most common cause of error is the wiring to the encoder.

MSD ServoDrive - DeviceHelp 382

# 11 Alarms & warnings

MOOG ID No.:CB40859-001 Date:11/2020

# 11.6.23.15 Error 22-22 (emergency code 7305h)

Cause: Channel 1 Initialization, HIPERFACE: common error

# Suggested steps:

- Group error --> look at message window of the Moog DRIVEADMINISTRATOR 5
- Initialization encoder
- Error during the initialization routines of channel 1 encoder channel 1.
- In any case look at init outputs in the message window of the Moog DRIVEADMINISTRATOR 5.
- The most common cause of error is the wiring to the encoder.

# 11.6.23.16 Error 22-23 (emergency code 7305h)

Cause: Channel 1 Initialization, HIPERFACE: timeout error

# Suggested steps:

- Please check the wiring of the encoder
- Initialization encoder
- Error during the initialization routines of channel 1 encoder channel 1.
- In any case look at init outputs in the message window of the Moog DRIVEADMINISTRATOR 5.
- The most common cause of error is the wiring to the encoder.

# 11.6.23.17 Error 22-24 (emergency code 7305h)

Cause: Channel 1 Initialization, HIPERFACE: impossible COMMAND in response from encoder

# Suggested steps:

- Please look at parameter (552) ENC_CH1_AbsEncStatus
- Initialization encoder
- Error during the initialization routines of channel 1 encoder channel 1.
- In any case look at init outputs in the message window of the Moog DRIVEADMINISTRATOR 5.
- The most common cause of error is the wiring to the encoder.

# 11.6.23.18 Error 22-25 (emergency code 7305h)

Cause: Channel 1 Initialization, HIPERFACE: CRC error in error status response from encoder (communication error)

# Suggested steps:

- Please check the wiring of the encoder
- Initialization encoder
- Error during the initialization routines of channel 1 encoder channel 1.
- In any case look at init outputs in the message window of the Moog DRIVEADMINISTRATOR 5.
- The most common cause of error is the wiring to the encoder.

# 11. Alarms & warnings

# 11.6.23.19 Error 22-26 (emergency code 7305h)

Cause: Channel 1 Initialization, HIPERFACE, error status response: encoder communication error

# Suggested steps:

- Please look at parameter (552) ENC_CH1_AbsEncStatus
- Initialization encoder
- Error during the initialization routines of channel 1 encoder channel 1.
- In any case look at init outputs in the message window of the Moog DRIVEADMINISTRATOR 5.
- The most common cause of error is the wiring to the encoder.

# 11.6.23.20 Error 22-27 (emergency code 7305h)

Cause: Channel 1 Initialization, HIPERFACE, error status response: technical or process error (inside encoder)

# Suggested steps:

- Please look at parameter (552) ENC_CH1_AbsEncStatus
- Initialization encoder
- Error during the initialization routines of channel 1 encoder channel 1.
- In any case look at init outputs in the message window of the Moog DRIVEADMINISTRATOR 5.
- The most common cause of error is the wiring to the encoder.

# 11.6.23.21 Error 22-28 (emergency code 7305h)

Cause: Channel 1 Initialization, HIPERFACE: error status response from encoder with no error (error code 0)

# Suggested steps:

- No further information available. Please contact your service provider.
- Initialization encoder
- This is probably an internal problem of the channel encoder!
- In any case look at init outputs in the message window of the Moog DRIVEADMINISTRATOR 5.

# 11.6.23.22 Error 22-29 (emergency code 7305h)

Cause: Channel 1 Initialization, HIPERFACE: CRC error in response from encoder (communication error)

# Suggested steps:

- Please check the wiring of the encoder
- Initialization encoder
- Error during the initialization routines of channel 1 encoder channel 1.
- In any case look at init outputs in the message window of the Moog DRIVEADMINISTRATOR 5.
- The most common cause of error is the wiring to the encoder.

MOOG ID No.:CB40859-001 Date:11/2020

# 11 Alarms & warnings

MOOG ID No.:CB40859-001 Date:11/2020

# 11.6.23.23 Error 22-30 (emergency code 7305h)

Cause: Channel 1 Initialization, HIPERFACE, response with error bit, status: encoder communication error

# Suggested steps:

- Please look at parameter (552) ENC_CH1_AbsEncStatus
- Initialization encoder
- Error during the initialization routines of channel 1 encoder channel 1.
- In any case look at init outputs in the message window of the Moog DRIVEADMINISTRATOR 5.
- The most common cause of error is the wiring to the encoder.

# 11.6.23.24 Error 22-31 (emergency code 7305h)

Cause: Channel 1 Initialization, HIPERFACE, response with error bit, status: technical or process error (inside encoder)

# Suggested steps:

- Please look at parameter (552) ENC_CH1_AbsEncStatus
- Initialization encoder
- This is probably an internal problem of the channel encoder!
- In any case look at init outputs in the message window of the Moog DRIVEADMINISTRATOR 5.

# 11.6.23.25 Error 22-32 (emergency code 7305h)

Cause: Channel 1 Initialization, HIPERFACE, response with error bit, status: no error from encoder

# Suggested steps:

- No further information available. Please contact your service provider.
- Initialization encoder
- This is probably an internal problem of the channel encoder!
- In any case look at init outputs in the message window of the Moog DRIVEADMINISTRATOR 5.

# 11.6.23.26 Error 22-33 (emergency code 7305h)

Cause: Channel 1 Initialization, HIPERFACE: encoder status error, encoder signals communication error

# Suggested steps:

- Please look at parameter (552) ENC_CH1_AbsEncStatus
- Initialization encoder
- Error during the initialization routines of channel 1 encoder channel 1.
- In any case look at init outputs in the message window of the Moog DRIVEADMINISTRATOR 5.
- The most common cause of error is the wiring to the encoder.

# 11 Alarms & warnings

# 11.6.23.27    Error 22-34 (emergency code 7305h)

Cause: Channel 1 Initialization, HIPERFACE: encoder status error, encoder signals technical or process error

# Suggested steps:

- Please look at parameter (552) ENC_CH1_AbsEncStatus
- Initialization encoder
- This is probably an internal problem of the encoder!
- In any case look at init outputs in the message window of the Moog DRIVEADMINISTRATOR 5.

# 11.6.23.28    Error 22-35 (emergency code 7305h)

Cause: Channel 1 Initialization, HIPERFACE: type key error, encoder returned an unknown type key code

# Suggested steps:

- Please look at parameter (552) ENC_CH1_AbsEncStatus
- Initialization encoder
- This is probably a software problem!
- In any case look at init outputs in the message window of the Moog DRIVEADMINISTRATOR 5.

# 11.6.23.29     Error 22-36 (emergency code 7305h)

Cause: Channel 1 Initialization, HIPERFACE: not allowed write operation to write protected cells or protection cells of the encoder

# Suggested steps:

- No further information available. Please contact your service provider.
- Initialization encoder
- This is probably a software problem!
- In any case look at init outputs in the message window of the Moog DRIVEADMINISTRATOR 5.

# 11.6.23.30     Error 22-37 (emergency code 7305h)

Cause: Channel 1 Initialization, TTL: the processor board inside the servo drive is incompatible with this function.

# Suggested steps:

- No further information available. Please contact your service provider.
- Initialization encoder
- This is probably a hardware problem!
- In any case look at init outputs in the message window of the Moog DRIVEADMINISTRATOR 5.

MOOG                     ID No.:CB40859-001 Date:11/2020

# 11 Alarms & warnings

MOOG ID No.:CB40859-001 Date:11/2020

# 11.6.23.31 Error 22-38 (emergency code 7305h)

Cause: Channel 1 Initialization, EndDat 2.1: error, 'PositionBits' read from encoder

Suggested steps:

- Number of clocks to transmit the position from the encoder. No further information available. Please contact your service provider.
- Initialization encoder - This is probably an internal problem of the channel.
- In any case look at init outputs in the message window of the Moog DRIVEADMINISTRATOR 5.

# 11.6.23.32 Error 22-40 (emergency code 7305h)

Cause: Channel 1 Initialization, Np: error from review of parameters 'Lines' and 'NominalIncrement'

Suggested steps:

- Please check this parameters.
- Initialization encoder - This is probably a problem of the parameterization!
- In any case look at init outputs in the message window of the Moog DRIVEADMINISTRATOR 5.

# 11.6.23.33 Error 22-41 (emergency code 7300h)

Cause: Channel 1/3 Initialization, EndDat: common error

Suggested steps:

- Please note the extended information of the error message.
- Initialization encoder - Error during the initialization routines of encoder channel.
- In any case look at init outputs in the message window of the Moog DRIVEADMINISTRATOR 5.
- The most common cause of error is the wiring to the encoder.

# 11.6.23.34 Error 22-42 (emergency code 7305h)

Cause: Channel 1 Initialization, SSI: common error

Suggested steps:

- Please note the extended information of the error message.
- Initialization encoder - Error during the initialization routines of encoder channel 1.
- In any case look at init outputs in the message window of the Moog DRIVEADMINISTRATOR 5.
- The most common cause of error is the wiring to the encoder.

# 11 Alarms & warnings

# 11.6.23.35

Error 22-43 (emergency code 7305h)

Cause: Channel 1 Initialization, SinCos: common error

Suggested steps:

- Please note the extended information of the error message
- Initialization encoder

# 11.6.23.36

Error 22-44 (emergency code 7305h)

Cause: Channel 1 Initialization, LinMot: common error

Suggested steps:

- Please note the extended information of the error message
- Initialization encoder

# 11.6.23.37

Error 22-45 (emergency code 7305h)

Cause: Channel 1 Initialization: the internal multiturn resolution is too low to process ENC_CH1_MTBase correctly.

Suggested steps:

- Please reduce the internal position resolution to free bits for the internal multi-turn information.
- Initialization encoder

# 11.6.23.38

Error 22-46 reserved

# 11.6.23.39

Error 22-47 (emergency code 7305h)

Cause: Channel 1 Initialization, EndDat22: common error

Suggested steps:

- Please note the extended information of the error message
- Initialization encoder

# 11 Alarms & warnings

# MOOG

ID No.: CB40859-001 Date: 11/2020

# MSD ServoDrive - DeviceHelp

389

# 11.6.24 Error 23: Encoder channel 2, initialization error

# 11.6.24.1 Error 23-1 (emergency code 7304h)

Cause: Channel 2 Initialization, Resolver: error, encoder monitoring

Suggested steps:

- Please connect the encoder correctly.
- Initialization encoder
- Error during the initialization routines of channel 2
- In any case look at init outputs in the message window of the Moog DRIVEADMINISTRATOR 5.
- The most common cause of error is the wiring to the encoder.

# 11.6.24.2 Error 23-2 (emergency code 7304h)

Cause: Channel 2 Initialization, Resolver: timeout error, getting AB-SquareSum

Suggested steps:

- Please note the extended information of the error message
- Initialization encoder
- Error during the initialization routines of channel 2
- In any case look at init outputs in the message window of the Moog DRIVEADMINISTRATOR 5.
- The most common cause of error is the wiring to the encoder.

No further information available. Please contact your service provider.

# 11.6.24.3 Error 23-3 (emergency code 7304h)

Cause: Channel 2 Initialization, Resolver: error

Suggested steps:

- Please connect the encoder correctly.
- Initialization encoder
- Error during the initialization routines of channel 2
- In any case look at init outputs in the message window of the Moog DRIVEADMINISTRATOR 5.
- The most common cause of error is the wiring to the encoder.

# 11.6.24.4 Error 23-4 (emergency code 7306h)

Cause: Channel 2 Initialization, SinCos: error, hardware

Suggested steps:

- Please note the extended information of the error message
- Initialization encoder
- Error during the initialization routines of channel 2
- In any case look at init outputs in the message window of the Moog DRIVEADMINISTRATOR 5.
- The most common cause of error is the wiring to the encoder.

# 11.6.25 Error 24: Encoder channel 3, initialization error

# 11.6.25.1 Error 24-1 (emergency code 7307h)

Cause: Channel 3 Initialization: common error from encoder option module

Cause: Channel 3 Initialization: error, module identification failed

# Suggested steps:

- Please look at Log entry window for error code information
- Please look up, if there's placed the right hardware module in the slot of X8
- Initialization encoder
- Error during the initialization routines of channel 3
- Identification of the X8 module
- This is probably a hardware problem of the X8 module!
- Please check if the correct X8 module is installed.
- In any case look at init outputs in the message window of the Moog DRIVEADMINISTRATOR 5.
- The most common cause of error is the wiring to the encoder.

# 11.6.25.2 Error 24-2 (emergency code 7307h)

l If the error occurs again (after 24V reset), please contact your service provider.

# 11.6.25.3 Error 24-3 (emergency code 7307h)

Cause: Channel 3 Initialization, SSI: error, encoder monitoring

# Suggested steps:

- Please connect the encoder correctly.
- Initialization encoder
- Error during the initialization routines of channel 3
- In any case look at init outputs in the message window of the Moog DRIVEADMINISTRATOR 5.
- The most common cause of error is the wiring to the encoder.

MOOG ID No.:CB40859-001 Date:11/2020

MSD ServoDrive - DeviceHelp 390

# 11 Alarms & warnings

# 11 Alarms & warnings

MOOG ID No.:CB40859-001 Date:11/2020

# 11.6.25.4 Error 24-4 (emergency code 7307h)

Cause: Channel 3 Initialization, EndDat 2.1: error, no EnDat 2.1 encoder (May be, it's an SSI encoder!?)

# Suggested steps:

- No further information available. Please contact your service provider.
- Initialization encoder
- Error during the initialization routines of channel 3 encoder channel 3.
- In any case look at init outputs in the message window of the Moog DRIVEADMINISTRATOR 5.
- The most common cause of error is the wiring to the encoder.

# 11.6.25.5 Error 24-5 (emergency code 7307h)

Cause: Channel 3 Initialization, EndDat 2.1: error, 'Lines' read from encoder

# Suggested steps:

- Please note additional Information in the message window of the Moog DRIVEADMINISTRATOR 5.
- Initialization encoder
- Error during the initialization routines of channel 3 encoder channel 3.
- In any case look at init outputs in the message window of the Moog DRIVEADMINISTRATOR 5.
- The most common cause of error is the wiring to the encoder.

# 11.6.25.6 Error 24-6 (emergency code 7307h)

Cause: Channel 3 Initialization, EndDat 2.1: error, 'MultiTurn' read from encoder

# Suggested steps:

- Please note additional Information in the message window of the Moog DRIVEADMINISTRATOR 5.
- Initialization encoder
- Error during the initialization routines of channel 3 encoder channel 3.
- In any case look at init outputs in the message window of the Moog DRIVEADMINISTRATOR 5.
- The most common cause of error is the wiring to the encoder.

# 11.6.25.7 Error 24-7 (emergency code 7307h)

Cause: Channel 3 Initialization, EndDat 2.1: error, 'SingleTurn' read from encoder

# Suggested steps:

- Please note additional Information in the message window of the Moog DRIVEADMINISTRATOR 5.
- Initialization encoder
- Error during the initialization routines of channel 3 encoder channel 3.
- In any case look at init outputs in the message window of the Moog DRIVEADMINISTRATOR 5.
- The most common cause of error is the wiring to the encoder.

MSD ServoDrive - DeviceHelp 391

# 11.6.25.8 Error 24-8 (emergency code 7307h)

Cause: Channel 3 Initialization, EndDat 2.1: CRC error, position data from encoder

Suggested steps:

- The transmission is probably disturbed. Please check the wiring to the encoder.
- Initialization encoder
- Error during the initialization routines of encoder channel 3.
- In any case look at init outputs in the message window of the Moog DRIVEADMINISTRATOR 5.
- The most common cause of error is the wiring to the encoder.

# 11.6.25.9 Error 24-9 (emergency code 7307h)

Cause: Channel 3 Initialization, EndDat 2.1: CRC error, parameter data from encoder

Suggested steps:

- The transmission is probably disturbed. Please check the wiring to the encoder.
- Initialization encoder
- Error during the initialization routines of encoder channel 3.
- In any case look at init outputs in the message window of the Moog DRIVEADMINISTRATOR 5.
- The most common cause of error is the wiring to the encoder.

# 11.6.25.10 Error 24-10 (emergency code 7307h)

Cause: Channel 3 Initialization, EndDat 2.1: not allowed write operation to write protected cells or protection cells of the encoder

Suggested steps:

- No further information available. Please contact your service provider.
- Initialization encoder
- This is probably a software problem!
- In any case look at init outputs in the message window of the Moog DRIVEADMINISTRATOR 5.

# 11.6.25.11 Error 24-15 (emergency code 7307h)

Cause: Channel 3 Initialization, SSI: 'MultiTurn' from parameter (573) ENC_CH1_MultiT

Suggested steps:

- Change the input of the multiturn bits of the parameter.
- Initialization encoder
- This is probably a problem of the parameterization!
- In any case look at init outputs in the message window of the Moog DRIVEADMINISTRATOR 5.

MOOG ID No.:CB40859-001 Date:11/2020

MSD ServoDrive - DeviceHelp 392

# 11 Alarms & warnings

MOOG ID No.:CB40859-001 Date:11/2020

# 11.6.25.12 Error 24-16 (emergency code 7307h)

Cause: Channel 3 Initialization, SSI: 'SingleTurn' from parameter (574) ENC_CH1_SingleT

# Suggested steps:

- Change the input of the singleturn bits of the parameter.
- Initialization encoder channel: This is probably a problem of the parameterization!
- In any case look at init outputs in the message window of the Moog DRIVEADMINISTRATOR 5.

# 11.6.25.13 Error 24-17 (emergency code 7307h)

Cause: Channel 3 Initialization, SSI: parity error, position data from encoder

# Suggested steps:

- Initialization encoder channel 3: Error during the initialization routines of encoder channel 3.
- In any case look at init outputs in the message window of the Moog DRIVEADMINISTRATOR 5.
- The most common cause of error is the wiring to the encoder.

# 11.6.25.14 Error 24-20 (emergency code 7307h)

Cause: Channel 3 Initialization, SSI: encoder monitoring

# Suggested steps:

- Check whether the encoder is correctly connected.
- Initialization encoder channel 3: Error during the initialization routines of encoder channel 3.
- In any case look at init outputs in the message window of the Moog DRIVEADMINISTRATOR 5.
- The most common cause of error is the wiring to the encoder.

# 11.6.25.15 Error 24-38 (emergency code 7307h)

Cause: Channel 3 Initialization, EndDat 2.1: error, 'PositionBits' read from encoder

# Suggested steps:

- Number of clocks to transmit the position from the encoder. No further information available. Please contact your service provider.
- Initialization encoder channel: This is probably an internal problem of the encoder!
- In any case look at init outputs in the message window of the Moog DRIVEADMINISTRATOR 5.

MSD ServoDrive - DeviceHelp 393

# 11.6.25.16 Error 24-40 (emergency code 7307h)

Cause: Channel 3 Initialization, Np: error from review of parameters 'Lines' and 'NominalIncrement'

# Suggested steps:

- Please check this parameters.
- Initialization encoder
- This is probably a problem of the parameterization!
- In any case look at init outputs in the message window of the Moog DRIVEADMINISTRATOR 5.

# 11.6.25.17 Error 24-41 (emergency code 7307h)

Cause: Channel 1/3 Initialization, EndDat: common error

# Suggested steps:

- Please note the extended information of the error message
- Initialization encoder
- Error during the initialization routines of encoder channel.
- In any case look at init outputs in the message window of the Moog DRIVEADMINISTRATOR 5.
- The most common cause of error is the wiring to the encoder.

# 11.6.25.18 Error 24-42 (emergency code 7307h)

Cause: Channel 3 Initialization, SSI: common error

# Suggested steps:

- Please note the extended information of the error message
- Initialization encoder
- Error during the initialization routines of encoder channel 3.
- In any case look at init outputs in the message window of the Moog DRIVEADMINISTRATOR 5.
- The most common cause of error is the wiring to the encoder.

# 11.6.25.19 Error 24-43 (emergency code 7307h)

Cause: Channel 3 Initialization, SinCos: common error

# Suggested steps:

- Please note the extended information of the error message
- Initialization encoder
- Error during the initialization routines of encoder channel 3.
- In any case look at init outputs in the message window of the Moog DRIVEADMINISTRATOR 5.
- The most common cause of error is the wiring to the encoder.

MOOG ID No.:CB40859-001 Date:11/2020

MSD ServoDrive - DeviceHelp 394

# 11 Alarms & warnings

MOOG ID No.:CB40859-001 Date:11/2020

# 11.6.25.20 Error 24-44 (emergency code 7307h)

Cause: Channel 3 Initialization, LinMot: common error

# Suggested steps:

- Please note the extended information of the error message
- Initialization encoder
- Error during the initialization routines of channel 3 encoder channel 3.
- In any case look at init outputs in the message window of the Moog DRIVEADMINISTRATOR 5.
- The most common cause of error is the wiring to the encoder.

# 11.6.25.21 Error 24-45 (emergency code 7307h)

Cause: Channel 3 Initialization, SinCos: error, encoder monitoring

# Suggested steps:

- Please connect the encoder correctly.
- Initialization encoder
- Error during the initialization routines of channel 3 encoder channel 3.
- In any case look at init outputs in the message window of the Moog DRIVEADMINISTRATOR 5.
- The most common cause of error is the wiring to the encoder.

# 11.6.25.22 Error 24-46 (emergency code 7307h)

Cause: Channel 3 Initialization: the internal multiturn resolution is too low to process ENC_CH3_MTBase correctly.

# Suggested steps:

- Please reduce the internal position resolution to free bits for the internal multi-turn information.
- Initialization encoder
- This is probably a problem of the parameterization!
- In any case look at init outputs in the message window of the Moog DRIVEADMINISTRATOR 5.

# 11.6.25.23 Error 24-47 (emergency code 7307h)

Cause: Channel 3 Initialization, EndDat22: common error

# Suggested steps:

- Please note the extended information of the error message
- Initialization encoder
- Error during the initialization routines of channel 3 encoder channel 3.
- In any case look at init outputs in the message window of the Moog DRIVEADMINISTRATOR 5.
- The most common cause of error is the wiring to the encoder.

# 11.6.25.24

# Error 24-50 (emergency code 7300h)

Cause: Channel 3 Initialization, TOPT: Used FPGA version does not match TechOpt card functionality.

Suggested steps:

- Please update the FPGA to the right version or replace the TechOpt card.
- X8 option module: Firmware or FPGA version will not work.
- Please check if the correct firmware is on the servo drive.
- In any case look at init outputs in the message window of the Moog DRIVEADMINISTRATOR 5.
- The most common cause of error is the wiring to the encoder.

# Initialization HIPERFACE-DSL

Cause: Error during the initialization of HIPERFACE-DSL (HDSL).

- Probably there is a problem due to insufficient mounting of the encoder. Make sure that the encoder has been mounted correctly.
- The problem could also have been caused by mechanical vibration during initialization.
- If the error occurs again (after 24V reset), please contact your service provider.

# 11.6.25.25

# Error 24-51 (emergency code 7300h)

Cause: Channel 3 Initialization, HDSL: common error

Suggested steps:

- Initialization encoder channel 3: Error during the initialization routines of encoder channel 3.
- In any case look at init outputs in the message window of the Moog DRIVEADMINISTRATOR 5.
- The most common cause of error is the wiring to the encoder.

# MOOG

ID No.: CB40859-001 Date: 11/2020

MSD ServoDrive - DeviceHelp 396

# 11 Alarms & warnings

# 11 Alarms & warnings

MOOG ID No.:CB40859-001 Date:11/2020

# 11.6.26 Error 25: Encoder cyclic process, common error

# 11.6.26.1 Error 25-1 (emergency code FF00h)

Cause: Encoder cyclic, Getting commutation: position difference too high

Suggested steps:

- Check the Parameter of autocommutation!
- Encoder channel, cyclic evaluation
- Error during the cyclic evaluation of an encoder channel.
- In any case look at init outputs in the message window of the Moog DRIVEADMINISTRATOR 5.
- The most common cause of error is the wiring to the encoder.

# 11.6.26.2 Error 25-2 (emergency code FF00h)

Cause: Encoder cyclic, Getting commutation: offset difference outside tolerance (&gt; 30 grad)

Suggested steps:

- Check the Parameter of autocommutation!
- Encoder channel, cyclic evaluation
- Error during the cyclic evaluation of an encoder channel.
- In any case look at init outputs in the message window of the Moog DRIVEADMINISTRATOR 5.
- The most common cause of error is the wiring to the encoder.

# 11.6.26.3 Error 25-3 (emergency code FF00h)

Cause: Encoder cyclic, Getting commutation: redundant encoder, maximum tracking error exceeded

Suggested steps:

- Check parameters P524 and P597!
- Encoder channel, cyclic evaluation
- Error during the cyclic evaluation of an encoder channel.
- In any case look at init outputs in the message window of the Moog DRIVEADMINISTRATOR 5.
- The most common cause of error is the wiring to the encoder.

# 11.6.26.4 Error 25-4 (emergency code FF00h)

Cause: Encoder cyclic, Getting commutation: error with hall encoder

Suggested steps:

- Check the Parameter of Hall-Encoder / Commutation!
- Encoder channel, cyclic evaluation
- Error during the cyclic evaluation of an encoder channel.
- In any case look at init outputs in the message window of the Moog DRIVEADMINISTRATOR 5.
- The most common cause of error is the wiring to the encoder.

MSD ServoDrive - DeviceHelp 397

# 11.6.26.5    Error 25-5 (emergency code FF00h)

Cause: Encoder cyclic, ENC_PCon: missing encoder configuration for PCON mode

# Suggested steps:

- Please configure encoder channel for position control (P522).
- Initialization encoder channel: This is probably a problem of the parameterization!
- In any case look at init outputs in the message window of the Moog DRIVEADMINISTRATOR 5.

# 11.6.27     Error 26: Encoder channel 1, cyclic process error

# 11.6.27.1    Error 26-1 (emergency code 7305h)

Cause: Channel 1 cyclic, Np (distance coded): error, measured 'counter distance' is out of range

# Suggested steps:

- Please check the wiring of the encoder.
- Encoder channel, cyclic evaluation: Error during the cyclic evaluation of an encoder channel 1.
- In any case look at init outputs in the message window of the Moog DRIVEADMINISTRATOR 5.
- The most common cause of error is the wiring to the encoder.

# 11.6.27.2    Error 26-2 (emergency code 7305h)

Cause: Channel 1 cyclic, Np (distance coded): error, delta correction failed

# Suggested steps:

- Please check the wiring of the encoder, perhaps reduce the speed.
- Encoder channel, cyclic evaluation: Error during the cyclic evaluation of an encoder channel 1.
- In any case look at init outputs in the message window of the Moog DRIVEADMINISTRATOR 5.
- The most common cause of error is the wiring to the encoder.

# 11.6.27.3    Error 26-3 (emergency code 7305h)

Cause: Channel 1 cyclic, Np (distance coded): error, calculated 'delta' is out of range

# Suggested steps:

- Please check the wiring of the encoder.
- Encoder channel, cyclic evaluation: Error during the cyclic evaluation of an encoder channel 1.
- In any case look at init outputs in the message window of the Moog DRIVEADMINISTRATOR 5.
- The most common cause of error is the wiring to the encoder.

MOOG                     ID No.:CB40859-001 Date:11/2020

# 11 Alarms & warnings

# 11 Alarms & warnings

# MOOG

ID No.: CB40859-001 Date: 11/2020

# MSD ServoDrive - DeviceHelp

399

# 11.6.28 Error 28: Encoder channel 3, cyclic process error

# 11.6.28.2 Error 28-2 (emergency code 7307h)

Cause: Channel 3 cyclic, Np (distance coded): error, delta correction failed

# Suggested steps:

- Please check the wiring of the encoder, perhaps reduce the speed.
- Encoder channel, cyclic evaluation
- Error during the cyclic evaluation of an encoder channel 3.
- In any case look at init outputs in the message window of the Moog DRIVEADMINISTRATOR 5.
- The most common cause of error is the wiring to the encoder.

# 11.6.28.1 Error 28-1 (emergency code 7307h)

Cause: Channel 3 cyclic, Np (distance coded): error, measured 'counter distance' is out of range

# Suggested steps:

- Please check the wiring of the encoder
- Encoder channel, cyclic evaluation
- Error during the cyclic evaluation of an encoder channel 3.
- In any case look at init outputs in the message window of the Moog DRIVEADMINISTRATOR 5.
- The most common cause of error is the wiring to the encoder.

# 11.6.28.3 Error 28-3 (emergency code 7307h)

Cause: Channel 3 cyclic, Np (distance coded): error, calculated 'delta' is out of range

# Suggested steps:

- Please check the wiring of the encoder
- Encoder channel, cyclic evaluation
- Error during the cyclic evaluation of an encoder channel 3.
- In any case look at init outputs in the message window of the Moog DRIVEADMINISTRATOR 5.
- The most common cause of error is the wiring to the encoder.

# 11.6.29 Error 30: Control initialization error

# 11.6.29.1 Error 30-1 (emergency code 5300h)

Cause: Initialization error analog input

# Suggested steps:

- Check calibration of analog inputs
- This issue is probably caused by an unsuitable parameter setting.
- Save your parameter set for a later restore.
- See 'history of parameter changes' and undo the latest changes.
- Please check your parameter set for implausible settings.
- Please set device to factory setting, restart, and see if the error occurs again.
- When reporting this error to your service partner, please include your device's parameter setting.

MOOG ID No.:CB40859-001 Date:11/2020

# 11 Alarms & warnings

# 11.6.29.2 Error 30-2 (emergency code 5300h)

Cause: Initialization error calculating motor torque constant

# Suggested steps:

- Check motor parameters
- This issue is probably caused by an unsuitable parameter setting.
- Save your parameter set for a later restore.
- See 'history of parameter changes' and undo the latest changes.
- Please check your parameter set for implausible settings.
- Please set device to factory setting, restart, and see if the error occurs again.
- When reporting this error to your service partner, please include your device's parameter setting.

MSD ServoDrive - DeviceHelp 400

# 11 Alarms & warnings

MOOG ID No.:CB40859-001 Date:11/2020

# 11.6.29.3 Error 30-3 (emergency code 5300h)

Cause: Error while calculating flux model of asynchr. motor

# Suggested steps:

- Check motor parameters (Rrot, Lsig, Lmag) and magn.current Imag
- This issue is probably caused by an unsuitable parameter setting.
- Save your parameter set for a later restore.
- See 'history of parameter changes' and undo the latest changes.
- Please check your parameter set for implausible settings.
- Please set device to factory setting, restart, and see if the error occurs again.
- When reporting this error to your service partner, please include your device's parameter setting.

# 11.6.29.4 Error 30-4 (emergency code 5300h)

Cause: Error by setting up Imag Table

# Suggested steps:

- Check Imag, Slim and table entries of module CON_FM
- This issue is probably caused by an unsuitable parameter setting.
- Save your parameter set for a later restore.
- See 'history of parameter changes' and undo the latest changes.
- Please check your parameter set for implausible settings.
- Please set device to factory setting, restart, and see if the error occurs again.
- When reporting this error to your service partner, please include your device's parameter setting.

MSD ServoDrive - DeviceHelp 401

# 11.6.29.5 Error 30-5 (emergency code 5300h)

Cause: Error in U/f-control initialization

# Suggested steps:

- Check VFC parameters
- This issue is probably caused by an unsuitable parameter setting.

# 11.6.29.7 Error 30-7 (emergency code 5300h)

Cause: Error at lookup table (bigtab) calculation

# Suggested steps:

- Check settings of table configuration
- This issue is probably caused by an unsuitable parameter setting.

# 11.6.29.6 Error 30-6 reserved

# 11.6.30 Error 31: PLC error

# 11.6.30.1 Error 31-0 (emergency code FF00h)

Cause: User defined Error detected.

# Suggested steps:

Error was triggered by PLC application (Function: MCB_CTR_SetError). Further information is available from the programmer of the application!

MOOG ID No.:CB40859-001 Date:11/2020

MSD ServoDrive - DeviceHelp 402

# 11 Alarms & warnings

# 11 Alarms & warnings

# MOOG

ID No.: CB40859-001 Date: 11/2020

# MSD ServoDrive - DeviceHelp

403

# 11.6.31 Error 32: PROFIBUS/PROFINET error

# 11.6.31.1 Error 32-1 (emergency code 8100h)

Cause: Profibus/Profinet option: process data timeout

Suggested steps:

- This is probably a software issue.
- Please try to switch to a different version of device firmware.
- Save your dataset and reset the axis module to factory setting. See if the error persists, or if it comes with activating a certain feature.
- This is possibly an EMC issue. This is very likely if the problem occurs when switching on motor control and/or when connecting DC link power supply.
- Please check the device cabling for proper connection.
- Please check device grounding, i.e. the connection to a metal backplane and cabinet connection to earth.
- Check motor grounding and motor cable length.

# 11.6.31.2 Error 32-2 (emergency code 8100h)

Cause: Profinet IRT: No firmware on Profinet option available!

Suggested steps:

- This is possibly a hardware issue. If other measures fail to solve the problem, please replace the servo drive.
- The device was probably disconnected from the master controller, or the master is overloaded.
- Please check the bus system connection. Try to replace the cables.
- Please try to reduce computational load on the master.
- Try to increase the master cycle time.

# 11.6.31.3 Error 32-3 (emergency code 8100h)

Cause: Profinet IRT: sign of life fault!

Suggested steps:

- This is possibly an EMC issue. This is very likely if the problem occurs when switching on motor control and/or when connecting DC link power supply.
- Please check the device cabling for proper connection.
- Please check device grounding, i.e. the connection to a metal backplane and cabinet connection to earth.
- Check motor grounding and motor cable length.
- The device was probably disconnected from the master controller, or the master is overloaded.
- Please check the bus system connection. Try to replace the cables.
- Please try to reduce computational load on the master.
- Try to increase the master cycle time.

# 11. Alarms & warnings

# 11.6.32 Error 33: Internal timing error

# 11.6.32.1 Error 33-0 (emergency code 5300h)

Cause: ADC task automatically interrupted

Suggested steps:

- Please restart device.
- Computational load in time-critical task of axis module is too high.
- Please reduce computational load by removing parameters from mapping.
- De-activate features of control system or motion control.
- This is probably a software issue.
- Please try to switch to a different version of device firmware.
- Save your dataset and reset the axis module to factory setting. See if the error persists, or if it comes with activating a certain feature.

MOOG ID No.:CB40859-001 Date:11/2020

# 11.6.32.2 Error 33-1 (emergency code 5300h)

Cause: Control task exceeded scan time

Suggested steps:

- Please restart device.
- Computational load in time-critical task of axis module is too high.
- Please reduce computational load by removing parameters from mapping.
- De-activate features of control system or motion control.
- This is probably a software issue.
- Please try to switch to a different version of device firmware.
- Save your dataset and reset the axis module to factory setting. See if the error persists, or if it comes with activating a certain feature.

MSD ServoDrive - DeviceHelp 404

# 11 Alarms & warnings

# MOOG

ID No.: CB40859-001 Date: 11/2020

# MSD ServoDrive - DeviceHelp

405

# 11.6.32.3 Error 33-2 (emergency code 5300h)

Cause: Internal timing error

Suggested steps:

- Please restart device.
- Computational load in time-critical task of axis module is too high.
- Please reduce computational load by removing parameters from mapping.
- De-activate features of control system or motion control.
- This is probably a software issue.
- Please try to switch to a different version of device firmware.
- Save your dataset and reset the axis module to factory setting. See if the error persists, or if it comes with activating a certain feature.

# 11.6.32.4 Error 33-3 (emergency code 5300h)

Cause: Unknown EXCEPTION in TC-safety

Suggested steps:

- Reset device!

# 11.6.32.5 Error 33-4 (emergency code 5300h)

Cause: Internal timing error

Suggested steps:

- Run time error, not enough CPU performance, check PLC program.
- Computational load in time-critical task of axis module is too high.
- Please reduce computational load by removing parameters from mapping.
- De-activate features of control system or motion control.
- This is probably a software issue.
- Please try to switch to a different version of device firmware.
- Save your dataset and reset the axis module to factory setting. See if the error persists, or if it comes with activating a certain feature.

# 11.6.33 Error 34: Powerfail function error

# 11.6.33.1 Error 34-0 (emergency code 3220h)

Cause: Power fail initialization failed

Cause: Power fail detected and reaction active

# Suggested steps:

- Check power fail parameter settings
- Check net connection of servo
- This issue is probably caused by an unsuitable parameter setting.
- Save your parameter set for a later restore.
- See 'history of parameter changes' and undo the latest changes.
- Please check your parameter set for implausible settings.
- Please set device to factory setting, restart, and see if the error occurs again.
- When reporting this error to your service partner, please include your device's parameter setting.

An under-voltage occurred on the drive while this axis was switched on.

Power supply was possibly switched off.

Please check if the actual grid voltage matches the supply setting (parameter PST_VoltageSupply).

Verify that the grid is stable under load condition.

# 11.6.33.2 Error 34-1 (emergency code 3220h)

Cause: Returning DC-link voltage detected

# Suggested steps:

- Restart Device
- Power supply was possibly switched off.
- Please check if the actual grid voltage matches the supply setting (parameter PST_VoltageSupply).
- Verify that the grid is stable under load condition.

# 11.6.33.3 Error 34-2 (emergency code 3220h)

MOOG ID No.:CB40859-001 Date:11/2020

MSD ServoDrive - DeviceHelp 406

# 11 Alarms & warnings

# 11 Alarms & warnings

MOOG ID No.:CB40859-001 Date:11/2020

# 11.6.34 Error 35: Encoder monitoring error

# 11.6.34.1 Error 35-0 (emergency code 7300h)

Cause: Unknown encoder monitoring error

Suggested steps:

- Check encoder cables, voltage supply, and selection. Make sure unused channels are switched off.
- The encoder is not connected or not working properly.
- - If this is encoder has analog signals, please check the signal amplitude vs. parameter EncObsMin
- Check cabling. If available, please try another encoder and cable.
- See detailed error information (>>) for a more detailed description.

This issue is probably caused by an unsuitable parameter setting.

# 11.6.34.2 Error 35-1 (emergency code 7305h)

Cause: ENC CH1 SinCos: error, encoder monitoring

Suggested steps:

- Check encoder cables, voltage supply, and selection. Make sure unused channels are switched off.
- The encoder is not connected or not working properly.
- - If this is encoder has analog signals, please check the signal amplitude vs. parameter EncObsMin
- Check cabling. If available, please try another encoder and cable.
- See detailed error information (>>) for a more detailed description.

This issue is probably caused by an unsuitable parameter setting.

# 11.6.34.3 Error 35-2 (emergency code 7304h)

Cause: ENC CH2 Resolver: error, encoder monitoring

# Suggested steps:

Check encoder cables, voltage supply, and selection. Make sure unused channels are switched off.

The encoder is not connected or not working properly.

- If this encoder has analog signals, please check the signal amplitude vs. parameter EncObsMin
- Check cabling. If available, please try another encoder and cable.
- See detailed error information (>>) for a more detailed description.

This issue is probably caused by an unsuitable parameter setting.

- Save your parameter set for a later restore.
- See 'history of parameter changes' and undo the latest changes.
- Please check your parameter set for implausible settings.
- Please set device to factory setting, restart, and see if the error occurs again.
- When reporting this error to your service partner, please include your device's parameter setting.

MOOG ID No.:CB40859-001 Date:11/2020

# 11.6.34.4 Error 35-3 (emergency code 7307h)

Cause: ENC CH3 SinCos: error, encoder monitoring

# Suggested steps:

Check encoder cables, voltage supply, and selection. Make sure unused channels are switched off.

The encoder is not connected or not working properly.

- If this encoder has analog signals, please check the signal amplitude vs. parameter EncObsMin
- Check cabling. If available, please try another encoder and cable.
- See detailed error information (>>) for a more detailed description.

This issue is probably caused by an unsuitable parameter setting.

- Save your parameter set for a later restore.
- See 'history of parameter changes' and undo the latest changes.
- Please check your parameter set for implausible settings.
- Please set device to factory setting, restart, and see if the error occurs again.
- When reporting this error to your service partner, please include your device's parameter setting.

MSD ServoDrive - DeviceHelp 408

# 11 Alarms & warnings

MOOG ID No.:CB40859-001 Date:11/2020

# 11.6.34.5 Error 35-4 (emergency code 7305h)

Cause: ENC CH1 SSI: error, encoder monitoring

# Suggested steps:

- Check encoder cables, voltage supply, and selection. Make sure unused channels are switched off.
- The encoder is not connected or not working properly.
- - If this is encoder has analog signals, please check the signal amplitude vs. parameter EncObsMin
- Check cabling. If available, please try another encoder and cable.
- See detailed error information (>>) for a more detailed description.

This issue is probably caused by an unsuitable parameter setting.

# 11.6.34.6 Error 35-5 (emergency code 7305h)

Cause: ENC CH1 SSI: error, parity error

# Suggested steps:

- Check encoder cables, voltage supply, and selection. Make sure unused channels are switched off.
- The encoder is not connected or not working properly.
- - If this is encoder has analog signals, please check the signal amplitude vs. parameter EncObsMin
- Check cabling. If available, please try another encoder and cable.
- See detailed error information (>>) for a more detailed description.

This issue is probably caused by an unsuitable parameter setting.

# 11.6.34.7 Error 35-6 (emergency code 7307h)

Cause: ENC CH3 SSI: error, encoder monitoring

# Suggested steps:

Check encoder cables, voltage supply, and selection. Make sure unused channels are switched off.

The encoder is not connected or not working properly.

- If this is encoder has analog signals, please check the signal amplitude vs. parameter EncObsMin
- Check cabling. If available, please try another encoder and cable.
- See detailed error information (>>) for a more detailed description.

This issue is probably caused by an unsuitable parameter setting.

- Save your parameter set for a later restore.
- See 'history of parameter changes' and undo the latest changes.
- Please check your parameter set for implausible settings.
- Please set device to factory setting, restart, and see if the error occurs again.
- When reporting this error to your service partner, please include your device's parameter setting.

MOOG ID No.:CB40859-001 Date:11/2020

# 11.6.34.8 Error 35-7 (emergency code 7307h)

Cause: ENC CH3 SSI: error, parity error

# Suggested steps:

Check encoder cables, voltage supply, and selection. Make sure unused channels are switched off.

The encoder is not connected or not working properly.

- If this is encoder has analog signals, please check the signal amplitude vs. parameter EncObsMin
- Check cabling. If available, please try another encoder and cable.
- See detailed error information (>>) for a more detailed description.

This issue is probably caused by an unsuitable parameter setting.

- Save your parameter set for a later restore.
- See 'history of parameter changes' and undo the latest changes.
- Please check your parameter set for implausible settings.
- Please set device to factory setting, restart, and see if the error occurs again.
- When reporting this error to your service partner, please include your device's parameter setting.

MSD ServoDrive - DeviceHelp 410

# 11 Alarms & warnings

MOOG ID No.:CB40859-001 Date:11/2020

# 11.6.34.9 Error 35-8 (emergency code 7305h)

Cause: ENC CH1: wire break on digital encoder

# Suggested steps:

Check encoder cables, voltage supply, and selection. Make sure unused channels are switched off.

- The encoder is not connected or not working properly.
- If this encoder has analog signals, please check the signal amplitude vs. parameter EncObsMin.
- Check cabling. If available, please try another encoder and cable.
- See detailed error information (>>) for a more detailed description.

This issue is probably caused by an unsuitable parameter setting.

- Save your parameter set for a later restore.
- See 'history of parameter changes' and undo the latest changes.
- Please check your parameter set for implausible settings.
- Please set device to factory setting, restart, and see if the error occurs again.
- When reporting this error to your service partner, please include your device's parameter setting.

# 11.6.34.10 Error 35-9 (emergency code 7307h)

Cause: ENC CH3: wire break on digital encoder

# Suggested steps:

Check encoder cables, voltage supply, and selection. Make sure unused channels are switched off.

- The encoder is not connected or not working properly.
- If this encoder has analog signals, please check the signal amplitude vs. parameter EncObsMin.
- Check cabling. If available, please try another encoder and cable.
- See detailed error information (>>) for a more detailed description.

This issue is probably caused by an unsuitable parameter setting.

- Save your parameter set for a later restore.
- See 'history of parameter changes' and undo the latest changes.
- Please check your parameter set for implausible settings.
- Please set device to factory setting, restart, and see if the error occurs again.
- When reporting this error to your service partner, please include your device's parameter setting.

# 11.6.34.11     Error 35-10 (emergency code 7305h)

Cause: ENC CH1 ENDAT: error, diagnosis

# Suggested steps:

- endat encoder cyclic diagnosis monitoring error, check encoder
- The encoder is not connected or not working properly.
- If this encoder has analog signals, please check the signal amplitude vs. parameter EncObsMin
- Check cabling. If available, please try another encoder and cable.
- See detailed error information (>>) for a more detailed description.

# 11.6.34.12     Error 35-11 (emergency code 7307h)

Cause: ENC CH3 ENDAT: error, diagnosis

# Suggested steps:

- endat encoder cyclic diagnosis monitoring error, check encoder
- The encoder is not connected or not working properly.
- If this encoder has analog signals, please check the signal amplitude vs. parameter EncObsMin
- Check cabling. If available, please try another encoder and cable.
- See detailed error information (>>) for a more detailed description.

# 11.6.34.13     Error 35-12 (emergency code 7307h)

Cause: Channel 3 cyclic, HDSL: status error --> position invalid

# Suggested steps:

- Please check the encoder and wiring.
- Error during the cyclic evaluation of an encoder channel 3.
- In any case look at init outputs in the message window of the Moog DRIVEADMINISTRATOR 5.
- The most common cause of error is the wiring to the encoder.

# 11.6.34.14     Error 35-11 (emergency code 7307h)

Cause: ENC CH3 ENDAT: error, diagnosis

# Suggested steps:

- If this encoder has analog signals, please check the signal amplitude vs. parameter EncObsMin
- Check cabling. If available, please try another encoder and cable.
- See detailed error information (>>) for a more detailed description.

MOOG ID No.:CB40859-001 Date:11/2020

MSD ServoDrive - DeviceHelp 412

# 11 Alarms & warnings

# 11 Alarms & warnings

MOOG ID No.:CB40859-001 Date:11/2020

# 11.6.35 Error 37: Syncronization controller error

# 11.6.35.1 Error 37-1 (emergency code 6100h)

Cause: Wrong ratio between interpolation-, synchonization- or velocity control time

# Suggested steps:

- Check the set cycle times in parameter 306, as well as according to the used bus system 2015 or 2266. Please pay attention to the different units!
- This issue is probably caused by an unsuitable parameter setting.
- Save your parameter set for a later restore.
- See 'history of parameter changes' and undo the latest changes.
- Please check your parameter set for implausible settings.
- Please set device to factory setting, restart, and see if the error occurs again.
- When reporting this error to your service partner, please include your device's parameter setting.

# 11.6.36 Error 38: Braking chopper error

# 11.6.36.1 Error 38-1 (emergency code 4210h)

Cause: P*t-integrator value exceeds maximum

# Suggested steps:

- Check/reduce the load of the chopper

# 11.6.37 Error 39: TWIN monitoring error

# 11.6.37.1 Error 39-0 (emergency code 7300h)

Cause: TWIN-Monitoring: speed difference between master and slave is too large

# Suggested steps:

- The control system failed to track the reference value
- Please check if the axis is blocked.
- Try to reduce acceleration or deceleration.
- If reference speed is higher than the motor rated speed, please check field weakening settings. In field-weakening range, the available torque per current is reduced.
- This issue is probably caused by an unsuitable parameter setting.
- Save your parameter set for a later restore.
- See 'history of parameter changes' and undo the latest changes.
- Please check your parameter set for implausible settings.
- Please set device to factory setting, restart, and see if the error occurs again.
- When reporting this error to your service partner, please include your device's parameter setting.

# 11.6.37.2     Error 39-1 (emergency code 7300h)

Cause: TWIN-Monitoring: torque difference between master and slave is too large

# Suggested steps:

- The control system failed to track the reference value
- Please check if the axis is blocked.
- Try to reduce acceleration or deceleration.
- If reference speed is higher than the motor rated speed, please check field weakening settings. In field-weakening range, the available torque per current is reduced.
- This issue is probably caused by an unsuitable parameter setting.
- Save your parameter set for a later restore.
- See 'history of parameter changes' and undo the latest changes.
- Please check your parameter set for implausible settings.
- Please set device to factory setting, restart, and see if the error occurs again.
- When reporting this error to your service partner, please include your device's parameter setting.

MOOG                       ID No.:CB40859-001 Date:11/2020

# 11 Alarms & warnings

# 11.6.37.3     Error 39-2 (emergency code 7300h)

Cause: Tech-Option remote error

# Suggested steps:

- The control system failed to track the reference value
- Please check if the axis is blocked.
- Try to reduce acceleration or deceleration.
- If reference speed is higher than the motor rated speed, please check field weakening settings. In field-weakening range, the available torque per current is reduced.
- This issue is probably caused by an unsuitable parameter setting.
- Save your parameter set for a later restore.
- See 'history of parameter changes' and undo the latest changes.
- Please check your parameter set for implausible settings.
- Please set device to factory setting, restart, and see if the error occurs again.
- When reporting this error to your service partner, please include your device's parameter setting.

MSD ServoDrive  - DeviceHelp    414

# 11 Alarms & warnings

MOOG ID No.:CB40859-001 Date:11/2020

# 11.6.37.4 Error 39-3 (emergency code 2350h)

Cause: Maximum phase difference detected

Suggested steps:

- The control system failed to track the reference value
- Please check if the axis is blocked.
- Try to reduce acceleration or deceleration.
- If reference speed is higher than the motor rated speed, please check field weakening settings. In field-weakening range, the available torque per current is reduced.

This issue is probably caused by an unsuitable parameter setting.

- Save your parameter set for a later restore.
- See 'history of parameter changes' and undo the latest changes.
- Please check your parameter set for implausible settings.
- Please set device to factory setting, restart, and see if the error occurs again.
- When reporting this error to your service partner, please include your device's parameter setting.

# 11.6.37.5 Error 39-4 (emergency code 2350h)

Cause: TWIN-Monitoring: position difference between master and slave is too large

Suggested steps:

- The control system failed to track the reference value
- Please check if the axis is blocked.
- Try to reduce acceleration or deceleration.
- If reference speed is higher than the motor rated speed, please check field weakening settings. In field-weakening range, the available torque per current is reduced.

This issue is probably caused by an unsuitable parameter setting.

- Save your parameter set for a later restore.
- See 'history of parameter changes' and undo the latest changes.
- Please check your parameter set for implausible settings.
- Please set device to factory setting, restart, and see if the error occurs again.
- When reporting this error to your service partner, please include your device's parameter setting.

# 11.6.37.6 Error 39-5 (emergency code 2350h)

Cause: TWIN-Monitoring: Power fail on remote device

Suggested steps:

- -

# 11.6.38 Error 40: Tech option error

# 11.6.38.1 Error 40-0 (emergency code 7300h)

Cause: Tech-Option communication error

Suggested steps:

- TWIN communication lost, check wiring or framing errors of TWIN option
- This issue is probably caused by an unsuitable parameter setting.
- Save your parameter set for a later restore.
- See 'history of parameter changes' and undo the latest changes.
- Please check your parameter set for implausible settings.
- Please set device to factory setting, restart, and see if the error occurs again.
- When reporting this error to your service partner, please include your device's parameter setting.

MOOG ID No.:CB40859-001 Date:11/2020

# 11 Alarms & warnings

# 11.6.38.2 Error 40-1 (emergency code 7300h)

Cause: Tech-Option communication error

Suggested steps:

- Tech-Option switching-frequency discrepancy
- This issue is probably caused by an unsuitable parameter setting.
- Save your parameter set for a later restore.
- See 'history of parameter changes' and undo the latest changes.
- Please check your parameter set for implausible settings.
- Please set device to factory setting, restart, and see if the error occurs again.
- When reporting this error to your service partner, please include your device's parameter setting.

MSD ServoDrive - DeviceHelp 416

# 11 Alarms & warnings

MOOG ID No.:CB40859-001 Date:11/2020

# 11.6.38.3 Error 40-2 (emergency code 7300h)

Cause: Tech-Option mode conflict

This issue is probably caused by an unsuitable parameter setting.

- Save your parameter set for a later restore.
- See 'history of parameter changes' and undo the latest changes.
- Please check your parameter set for implausible settings.
- Please set device to factory setting, restart, and see if the error occurs again.
- When reporting this error to your service partner, please include your device's parameter setting.

# 11.6.38.4 Error 40-3 (emergency code 7300h)

Cause: Tech-Option remote error

This issue is probably caused by an unsuitable parameter setting.

- Save your parameter set for a later restore.
- See 'history of parameter changes' and undo the latest changes.
- Please check your parameter set for implausible settings.
- Please set device to factory setting, restart, and see if the error occurs again.
- When reporting this error to your service partner, please include your device's parameter setting.

MSD ServoDrive - DeviceHelp 417

# 11. Alarms & warnings

# 11.6.38.5 Error 40-4 (emergency code 7300h)

Cause: Tech-Option communication error

Suggested steps:

- This issue is probably caused by an unsuitable parameter setting.
- Save your parameter set for a later restore.
- See 'history of parameter changes' and undo the latest changes.
- Please check your parameter set for implausible settings.
- Please set device to factory setting, restart, and see if the error occurs again.
- When reporting this error to your service partner, please include your device's parameter setting.

MOOG ID No.:CB40859-001 Date:11/2020

# 11.6.38.6 Error 40-5 (emergency code 7300h)

Cause: Tech-Option communication error

Suggested steps:

- This issue is probably caused by an unsuitable parameter setting.
- Save your parameter set for a later restore.
- See 'history of parameter changes' and undo the latest changes.
- Please check your parameter set for implausible settings.
- Please set device to factory setting, restart, and see if the error occurs again.
- When reporting this error to your service partner, please include your device's parameter setting.

MSD ServoDrive - DeviceHelp 418

# 11 Alarms & warnings

MOOG ID No.:CB40859-001 Date:11/2020

# 11.6.38.7 Error 40-6 (emergency code 7300h)

Cause: Tech-Option initialisation error

Suggested steps:

- This issue is probably caused by an unsuitable parameter setting.
- Save your parameter set for a later restore.
- See 'history of parameter changes' and undo the latest changes.
- Please check your parameter set for implausible settings.
- Please set device to factory setting, restart, and see if the error occurs again.
- When reporting this error to your service partner, please include your device's parameter setting.

# 11.6.38.8 Error 40-7 reserved

# 11.6.38.9 Error 40-8 (emergency code 7300h)

Cause: Tech-Option initialisation error

Suggested steps:

- This issue is probably caused by an unsuitable parameter setting.
- Save your parameter set for a later restore.
- See 'history of parameter changes' and undo the latest changes.
- Please check your parameter set for implausible settings.
- Please set device to factory setting, restart, and see if the error occurs again.
- When reporting this error to your service partner, please include your device's parameter setting.

MSD ServoDrive - DeviceHelp 419

# 11 Alarms & warnings

# 11.6.39

Error 41: Fast discharge monitoring error (dc-link)

# 11.6.39.1

Error 41-0 (emergency code 7300h)

Cause: Maximum period for fast discharge exceeded (35 s)

Suggested steps:

- This issue is probably caused by an unsuitable parameter setting.
- Save your parameter set for a later restore.
- See 'history of parameter changes' and undo the latest changes.
- Please check your parameter set for implausible settings.
- Please set device to factory setting, restart, and see if the error occurs again.
- When reporting this error to your service partner, please include your device's parameter setting.

# 11.6.40

Error 43: Ethernet error

# 11.6.40.1

Error 43-0 (emergency code 6100h)

Cause: Unknown error in Ethernet interface

Suggested steps:

- Please try to switch to a different version of device firmware.
- Save your dataset and reset the axis module to factory setting. See if the error persists, or if it comes with activating a certain feature.
- This is probably a software issue.
- If other measures fail to solve the problem, please replace the servo drive.
- Switch off/on device. Please contact your service provider if this error occurs again.

MOOG ID No.:CB40859-001 Date:11/2020

MSD ServoDrive - DeviceHelp 420

# 11 Alarms & warnings

MOOG ID No.:CB40859-001 Date:11/2020

# 11.6.40.2 Error 43-1 (emergency code 6100h)

Cause: Plausibility error between IP address and subnetmask, subnetmask was corrected!

# Suggested steps:

- Check the settings of the IP address and the subnetmask of the Ethernet interface (X3/X9) in the parameters 671 and 688.
- This issue is probably caused by an unsuitable parameter setting.
- Save your parameter set for a later restore.
- See 'history of parameter changes' and undo the latest changes.
- Please check your parameter set for implausible settings.
- Please set device to factory setting, restart, and see if the error occurs again.
- When reporting this error to your service partner, please include your device's parameter setting.

# 11.6.41 Error 44: Wire break, common error

# 11.6.41.1 Error 44-1 (emergency code 6100h)

Cause: Motor brake not connected on X13

# Suggested steps:

- Check motor brake or other device connected on X13, or disable guarding.

# 11.6.42 Error 45: Lock violation error

# 11.6.42.1 Error 45-0 (emergency code 8612h)

Cause: Unknown lock violate error

# Suggested steps:

- Switch off/on device. Please contact your service provider if this error occurs again.
- The reference value violates a lock or limit switch.
- Please check reference values. If this axis is working in cyclic synchronous mode, make a scope record.
- Check factor group settings.
- Check mode of operation.
- This issue is probably caused by an unsuitable parameter setting.
- Save your parameter set for a later restore.
- See 'history of parameter changes' and undo the latest changes.
- Please check your parameter set for implausible settings.
- Please set device to factory setting, restart, and see if the error occurs again.
- When reporting this error to your service partner, please include your device's parameter setting.

# 11.6.42.2     Error 45-1 (emergency code 8612h)

Cause:

Movement requested which was limited by reversing lock, limit switch or reference value limitation.

# Suggested steps:

- Quit error and change reference value
- The reference value violates a lock or limit switch. Please check reference values. If this axis is working in cyclic synchronous mode, make a scope record.
- Check factor group settings.
- Check mode of operation.

This issue is probably caused by an unsuitable parameter setting.

- Save your parameter set for a later restore.
- See 'history of parameter changes' and undo the latest changes.
- Please check your parameter set for implausible settings.
- Please set device to factory setting, restart, and see if the error occurs again.
- When reporting this error to your service partner, please include your device's parameter setting.

MOOG                       ID No.:CB40859-001 Date:11/2020

# 11 Alarms & warnings

# 11.6.42.3     Error 45-2 (emergency code FF00h)

Cause:

Movement requested which was limited by reversing lock, limit switch or reference value limitation. Lock active in both directions.

# Suggested steps:

- Check plausibility of limit switches and/or software limits
- The reference value violates a lock or limit switch. Please check reference values. If this axis is working in cyclic synchronous mode, make a scope record.
- Check factor group settings.
- Check mode of operation.

This issue is probably caused by an unsuitable parameter setting.

- Save your parameter set for a later restore.
- See 'history of parameter changes' and undo the latest changes.
- Please check your parameter set for implausible settings.
- Please set device to factory setting, restart, and see if the error occurs again.
- When reporting this error to your service partner, please include your device's parameter setting.

MSD ServoDrive  - DeviceHelp    422

# 11 Alarms & warnings

MOOG ID No.:CB40859-001 Date:11/2020

# 11.6.42.4 Error 45-3 (emergency code 8612h)

Cause: Software limit switch overtravel detected, traversing task rejected

# Suggested steps:

- Quit error and change reference value
- The reference value violates a lock or limit switch.
- Please check reference values. If this axis is working in cyclic synchronous mode, make a scope record.
- Check factor group settings.
- Check mode of operation.
- This issue is probably caused by an unsuitable parameter setting.
- Save your parameter set for a later restore.
- See 'history of parameter changes' and undo the latest changes.
- Please check your parameter set for implausible settings.
- Please set device to factory setting, restart, and see if the error occurs again.
- When reporting this error to your service partner, please include your device's parameter setting.

# 11.6.43 Error 46: Position limit error

# 11.6.43.1 Error 46-0 (emergency code 8612h)

Cause: Unknown position limit error

# Suggested steps:

- Switch off/on device. Please contact your service provider if this error occurs again
- Position was limited internally.
- Please check factor group setting and position command
- Take a scope record to determine if the position control overshoots.
- The speed control might run away, most likely due to a wrong encoder offset.
- Please check that the encoder offset is set properly.
- If auto commutation is used, re-view the auto commutation setting and test under all possible conditions.
- If torque mode is used, reduce torque, ensure external speed limitation, or increase speed control gain for stronger limitation.

# 11. Alarms & warnings

# 11.6.43.2 Error 46-1 (emergency code 8612h)

Cause: Negative software limit switch is exceeded (negative position limit)

Suggested steps:

- Quit error and change reference value
- Position was limited internally. Please check factor group setting and position command
- Take a scope record to determine if the position control overshoots.
- The speed control might run away, most likely due to a wrong encoder offset.
- Please check that the encoder offset is set properly.
- If auto commutation is used, re-view the auto commutation setting and test under all possible conditions.
- If torque mode is used, reduce torque, ensure external speed limitation, or increase speed control gain for stronger limitation.

MOOG ID No.:CB40859-001 Date:11/2020

# 11.6.43.3 Error 46-2 (emergency code 8612h)

Cause: Positive software limit switch is exceeded (positive position limit)

Suggested steps:

- Quit error and change reference value
- Position was limited internally. Please check factor group setting and position command
- Take a scope record to determine if the position control overshoots.
- The speed control might run away, most likely due to a wrong encoder offset.
- Please check that the encoder offset is set properly.
- If auto commutation is used, re-view the auto commutation setting and test under all possible conditions.
- If torque mode is used, reduce torque, ensure external speed limitation, or increase speed control gain for stronger limitation.

MSD ServoDrive - DeviceHelp 424

# 11 Alarms & warnings

MOOG ID No.:CB40859-001 Date:11/2020

# 11.6.43.4 Error 46-3 (emergency code 8612h)

Cause: Software limit switch overtravel detected

# Suggested steps:

Quit error and change reference value

- Position was limited internally.
- Please check factor group setting and position command
- Take a scope record to determine if the position control overshoots.
- The speed control might run away, most likely due to a wrong encoder offset.
- Please check that the encoder offset is set properly.
- If auto commutation is used, re-view the auto commutation setting and test under all possible conditions.
- If torque mode is used, reduce torque, ensure external speed limitation, or increase speed control gain for stronger limitation.

# 11.6.43.5 Error 46-4 (emergency code 8612h)

Cause: Position reference value out of range

# Suggested steps:

Quit error and change reference value

- Position was limited internally.
- Please check factor group setting and position command
- Take a scope record to determine if the position control overshoots.
- The speed control might run away, most likely due to a wrong encoder offset.
- Please check that the encoder offset is set properly.
- If auto commutation is used, re-view the auto commutation setting and test under all possible conditions.
- If torque mode is used, reduce torque, ensure external speed limitation, or increase speed control gain for stronger limitation.

MSD ServoDrive - DeviceHelp 425

# 11.6.44 Error 47: Functional safety, common error

# 11.6.44.1 Error 47-0 (emergency code 6100h)

Cause: Unknown error in functional safety interface detected

Suggested steps:

- Acknowledge error, if the error occurs again, reset device
- An error occurred in the communication to the safety system.
- This is probably a software issue.
- Please acknowledge the error.
- If the error occurs again please restart the application (24V reset).
- Please try to switch to a different version of device firmware.
- Save your dataset and reset the axis module to factory setting. See if the error persists, or if it comes with activating a certain feature.

This is possibly a hardware issue. If other measures fail to solve the problem, please replace the servo drive.

# 11.6.44.2 Error 47-1 (emergency code 6100h)

Cause: Communication error to safety system detected

Suggested steps:

- Acknowledge error, if the error occurs again, reset device
- An error occurred in the communication to the safety system.
- This is probably a software issue.
- Please acknowledge the error.
- If the error occurs again please restart the application (24V reset).
- Please try to switch to a different version of device firmware.
- Save your dataset and reset the axis module to factory setting. See if the error persists, or if it comes with activating a certain feature.

# 11.6.44.3 Error 47-2 (emergency code 6100h)

Cause: Error while requesting data from safety system

Suggested steps:

- Acknowledge error and try download again
- An error occurred at the up- or download of the safety program.
- Please check the security program.
- Please check the connection settings of your safety system in Safe PLC.
- Please reload or download the safety program again.

# 11.6.44.4 Error 47-3 (emergency code 6100h)

Cause: Download of safe PLC application file failed

Suggested steps:

- Acknowledge error and try download again
- An error occurred at the up- or download of the safety program.
- Please check the security program.
- Please check the connection settings of your safety system in Safe PLC.
- Please reload or download the safety program again.

MOOG ID No.:CB40859-001 Date:11/2020

MSD ServoDrive - DeviceHelp 426

# 11 Alarms & warnings

# MOOG

ID No.: CB40859-001 Date: 11/2020

# MSD ServoDrive - DeviceHelp

427

# 11.6.44.5 Error 47-4 (emergency code 6100h)

# 11.6.45 Error 49: Safety system error

Cause: Upload of safe PLC application file failed

# 11.6.45.1 Error 49-0 (emergency code 6100h)

Cause: Unknown fatal error in functional safety interface

# Suggested steps:

- Acknowledge error and try upload again
- An error occurred at the upload or download of the safety program.
- Please check the security program.
- Please check the connection settings of your safety system in Safe PLC.
- Please reload or download the safety program again.

This is probably a software issue.

- Please try to switch to a different version of device firmware.
- Save your dataset and reset the axis module to factory setting. See if the error persists, or if it comes with activating a certain feature.

# 11.6.44.6 Error 47-5 (emergency code 6100h)

Cause: Safety firmware invalid (no firmware or CRC failure)

# Suggested steps:

- Update of safety firmware required, contact your service provider
- Invalid safety firmware.
- An update of the required safety firmware is necessary.
- Please report this error to your service partner.

# 11 Alarms & warnings

# 11.6.45.2 Error 49-1 (emergency code 6100h)

Cause: Alarm on safety drive SR1 of master or local device detected

Suggested steps:

- Read additional information, check safety system or wiring and acknowledge alarm/error
- Extended diagnosis of safety errors/alarms.
- Further information on the error/alarm code can be found in the "MSD Servo Drive Software with Safety PLC Function".
- An alarm occurred at the safety controller.
- Please check the safety program and the wiring of the safety system.
- Please acknowledge the alarm at the safety master. The safety master acknowledges all slave alarms and resets the network status to "RUN".

MOOG ID No.:CB40859-001 Date:11/2020

# 11.6.45.3 Error 49-2 (emergency code 6100h)

Cause: Alarm on safety drive SR2 of master or local device detected

Suggested steps:

- Read additional information, check safety system or wiring and acknowledge alarm/error
- Extended diagnosis of safety errors/alarms.
- Further information on the error/alarm code can be found in the "MSD Servo Drive Software with Safety PLC Function".
- An alarm occurred at the safety controller.
- Please check the safety program and the wiring of the safety system.
- Please acknowledge the alarm at the safety master. The safety master acknowledges all slave alarms and resets the network status to "RUN".

# 11 Alarms & warnings

MOOG ID No.:CB40859-001 Date:11/2020

# 11.6.45.4 Error 49-3 (emergency code 6100h)

Cause: Alarm on safety drive SR1 of Slave 1 detected

# Suggested steps:

- Read additional information, check safety system or wiring and acknowledge alarm/error
- Extended diagnosis of safety errors/alarms.
- Further information on the error/alarm code can be found in the "MSD Servo Drive Software with Safety PLC Function".
- An alarm occurred at the safety controller.
- Please check the safety program and the wiring of the safety system.
- Please acknowledge the alarm at the safety master. The safety master acknowledges all slave alarms and resets the network status to "RUN".

# 11.6.45.5 Error 49-4 (emergency code 6100h)

Cause: Alarm on safety drive SR2 of Slave 1 detected

# Suggested steps:

- Read additional information, check safety system or wiring and acknowledge alarm/error
- Extended diagnosis of safety errors/alarms.
- Further information on the error/alarm code can be found in the "MSD Servo Drive Software with Safety PLC Function".
- An alarm occurred at the safety controller.
- Please check the safety program and the wiring of the safety system.
- Please acknowledge the alarm at the safety master. The safety master acknowledges all slave alarms and resets the network status to "RUN".

MSD ServoDrive - DeviceHelp 429

# 11 Alarms & warnings

# 11.6.45.6 Error 49-5 (emergency code 6100h)

Cause: Alarm on safety drive SR1 of Slave 2 detected

# Suggested steps:

- Read additional information, check safety system or wiring and acknowledge alarm/error
- Extended diagnosis of safety errors/alarms.
- Further information on the error/alarm code can be found in the "MSD Servo Drive Software with Safety PLC Function".
- An alarm occurred at the safety controller.
- Please check the safety program and the wiring of the safety system.
- Please acknowledge the alarm at the safety master. The safety master acknowledges all slave alarms and resets the network status to "RUN".

MOOG ID No.:CB40859-001 Date:11/2020

# 11.6.45.7 Error 49-6 (emergency code 6100h)

Cause: Alarm on safety drive SR2 of Slave 2 detected

# Suggested steps:

- Read additional information, check safety system or wiring and acknowledge alarm/error
- Extended diagnosis of safety errors/alarms.
- Further information on the error/alarm code can be found in the "MSD Servo Drive Software with Safety PLC Function".
- An alarm occurred at the safety controller.
- Please check the safety program and the wiring of the safety system.
- Please acknowledge the alarm at the safety master. The safety master acknowledges all slave alarms and resets the network status to "RUN".

MSD ServoDrive - DeviceHelp 430

# 11 Alarms & warnings

MOOG ID No.:CB40859-001 Date:11/2020

# 11.6.45.8 Error 49-7 (emergency code 6100h)

Cause: Alarm on safety drive SR1 of Slave 3 detected

# Suggested steps:

- Read additional information, check safety system or wiring and acknowledge alarm/error
- Extended diagnosis of safety errors/alarms.
- Further information on the error/alarm code can be found in the "MSD Servo Drive Software with Safety PLC Function".
- An alarm occurred at the safety controller.
- Please check the safety program and the wiring of the safety system.
- Please acknowledge the alarm at the safety master. The safety master acknowledges all slave alarms and resets the network status to "RUN".

# 11.6.45.9 Error 49-8 (emergency code 6100h)

Cause: Alarm on safety drive SR2 of Slave 3 detected

# Suggested steps:

- Read additional information, check safety system or wiring and acknowledge alarm/error
- Extended diagnosis of safety errors/alarms.
- Further information on the error/alarm code can be found in the "MSD Servo Drive Software with Safety PLC Function".
- An alarm occurred at the safety controller.
- Please check the safety program and the wiring of the safety system.
- Please acknowledge the alarm at the safety master. The safety master acknowledges all slave alarms and resets the network status to "RUN".

# 11 Alarms & warnings

# 11.6.45.10 Error 49-9 (emergency code 6100h)

Cause: Alarm on safety drive SR1 of Slave 4 detected

Suggested steps:

- Read additional information, check safety system or wiring and acknowledge alarm/error
- Extended diagnosis of safety errors/alarms.
- Further information on the error/alarm code can be found in the "MSD Servo Drive Software with Safety PLC Function".
- An alarm occurred at the safety controller.
- Please check the safety program and the wiring of the safety system.
- Please acknowledge the alarm at the safety master. The safety master acknowledges all slave alarms and resets the network status to "RUN".

MOOG ID No.:CB40859-001 Date:11/2020

# 11.6.45.11 Error 49-10 (emergency code 6100h)

Cause: Alarm on safety drive SR2 of Slave 4 detected

Suggested steps:

- Read additional information, check safety system or wiring and acknowledge alarm/error
- Extended diagnosis of safety errors/alarms.
- Further information on the error/alarm code can be found in the "MSD Servo Drive Software with Safety PLC Function".
- An alarm occurred at the safety controller.
- Please check the safety program and the wiring of the safety system.
- Please acknowledge the alarm at the safety master. The safety master acknowledges all slave alarms and resets the network status to "RUN".

MSD ServoDrive - DeviceHelp 432

# 11 Alarms & warnings

MOOG ID No.:CB40859-001 Date:11/2020

# 11.6.45.12 Error 49-11 (emergency code 6100h)

Cause: Alarm on safety drive SR1 of Slave 5 detected

# Suggested steps:

- Read additional information, check safety system or wiring and acknowledge alarm/error
- Extended diagnosis of safety errors/alarms.
- Further information on the error/alarm code can be found in the "MSD Servo Drive Software with Safety PLC Function".
- An alarm occurred at the safety controller.
- Please check the safety program and the wiring of the safety system.
- Please acknowledge the alarm at the safety master. The safety master acknowledges all slave alarms and resets the network status to "RUN".

# 11.6.45.13 Error 49-12 (emergency code 6100h)

Cause: Alarm on safety drive SR2 of Slave 5 detected

# Suggested steps:

- Read additional information, check safety system or wiring and acknowledge alarm/error
- Extended diagnosis of safety errors/alarms.
- Further information on the error/alarm code can be found in the "MSD Servo Drive Software with Safety PLC Function".
- An alarm occurred at the safety controller.
- Please check the safety program and the wiring of the safety system.
- Please acknowledge the alarm at the safety master. The safety master acknowledges all slave alarms and resets the network status to "RUN".

# 11 Alarms & warnings

# 11.6.45.14 Error 49-13 (emergency code 6100h)

Cause: Error on safety drive SR1 detected

Suggested steps:

- Read additional information, check safety system or wiring and acknowledge alarm/error
- Extended diagnosis of safety errors/alarms.
- Further information on the error/alarm code can be found in the "MSD Servo Drive Software with Safety PLC Function".
- An error occurred at the safety controller.
- Please check the safety program and the wiring of the security system.
- Please acknowledge the error on the affected device. Subsequently the alarm must be acknowledged at the safety master to reset the network status to "RUN".
- Please restart the application (24V reset).

MOOG ID No.:CB40859-001 Date:11/2020

# 11.6.45.15 Error 49-14 (emergency code 6100h)

Cause: Error on safety drive SR2 detected

Suggested steps:

- Read additional information, check safety system or wiring and acknowledge alarm/error
- Extended diagnosis of safety errors/alarms.
- Further information on the error/alarm code can be found in the "MSD Servo Drive Software with Safety PLC Function".
- An error occurred at the safety controller.
- Please check the safety program and the wiring of the security system.
- Please acknowledge the error on the affected device. Subsequently the alarm must be acknowledged at the safety master to reset the network status to "RUN".
- Please restart the application (24V reset).

# 11 Alarms & warnings

MOOG ID No.:CB40859-001 Date:11/2020

MSD ServoDrive - DeviceHelp 435

# 11.6.45.16 Error 49-15 (emergency code 6100h)

Cause: Safety network alarm, initiated by safety master

# Suggested steps:

- Read additional information, check safety system or wiring and acknowledge alarm/error
- Extended diagnosis of safety errors/alarms.
- An error occurred at the safety controller.
- Further information on the error/alarm code can be found in the "MSD Servo Drive Software with Safety PLC Function".
- Please check the safety program and the wiring of the security system.
- Please acknowledge the error on the affected device. Subsequently, the alarm must be acknowledged at the safety master to reset the network status to "RUN".
- Please restart the application (24V reset).

# 11.6.46 Error 51: Encoder status, common error

# 11.6.46.1 Error 51-1 (emergency code 7305h)

Cause: Channel 1, Status from encoder: warning or error bit set by encoder

# Suggested steps:

- Please check encoder manual for further information.
- Encoder channel, internal status from digital encoder
- Error during reading from a digital encoder.
- Warning information or error status information reported by the encoder.
- In any case look at init outputs in the message window of the Moog DRIVEADMINISTRATOR 5.

# 11.6.46.2 Error 51-2 (emergency code 7307h)

Cause: Channel 3, Status from encoder: warning or error bit set by encoder

# Suggested steps:

- Please check encoder manual for further information.
- Encoder channel, internal status from digital encoder
- Error during reading from a digital encoder.
- Warning information or error status information reported by the encoder.
- In any case look at init outputs in the message window of the Moog DRIVEADMINISTRATOR 5.

# 11.6.47 Error 52: Analog inputs error

# 11.6.47.1 Error 52-1 (emergency code FF00h)

Cause: Analog input: Wire break detected

Suggested steps:

- Check analog input configuration
- There is a problem with the digital/analog inputs
- Please check the 24V I/O wiring, function assignment and inversion parameters.
- Please check connected switches for chattering. Consider using the input filter.

This is possibly a hardware issue

If other measures fail to solve the problem, please replace the servo drive.

# 11.6.48 Error 53: Motor failure error

# 11.6.48.1 Error 53-1 (emergency code 6100h)

Cause: At least one motor phase missing

Suggested steps:

- Check motor wiring

This is possibly a hardware issue

If other measures fail to solve the problem, please replace the servo drive.

# 11.6.49 Error 54: Power grid failure error

# 11.6.49.1 Error 54-1 (emergency code 6100h)

Cause: At least one grid phase missing

Suggested steps:

- Check grid wiring
- There was an under-voltage occurred on the drive while this axis was switched on.
- Power supply was possibly switched off.
- Please check if the actual grid voltage matches the supply setting (parameter PST_VoltageSupply)
- Verify that the grid is stable under load condition.

MOOG ID No.:CB40859-001 Date:11/2020

MSD ServoDrive - DeviceHelp 436

# 11 Alarms & warnings

# 11 Alarms & warnings

MOOG ID No.:CB40859-001 Date:11/2020

# 11.6.50 Error 55: Speed guarding error

# 11.6.50.1 Error 55-1 (emergency code 6100h)

Cause: Speed guarding digital input

Suggested steps:

- Check digital inputs
- This issue is probably caused by an unsuitable parameter setting.
- Save your parameter set for a later restore.
- See 'history of parameter changes' and undo the latest changes.
- Please check your parameter set for implausible settings.
- Please set device to factory setting, restart, and see if the error occurs again.
- When reporting this error to your service partner, please include your device's parameter setting.
- Please check that the encoder offset is set properly.
- If auto commutation is used, re-view the auto commutation setting and test under all possible conditions.
- If torque mode is used, reduce torque, ensure external speed limitation, or increase speed control gain for stronger limitation.

# 11.6.51 Error 57: reserved

# 11.6.52 Error 58: HYDRAULIC, common error

# 11.6.52.1 Error 58-1 (emergency code 6100h)

Cause: Hydraulics, p2t: overload of hydraulic pump

Suggested steps:

- Please reduce the load.
- Hydraulics, cyclic processing: Error during the cyclic execution of the hydraulics.
- In any case look at init outputs in the message window of the Moog DRIVEADMINISTRATOR 5.

# 11.6.52.2 Error 58-2 (emergency code 6100h)

Cause: Hydraulics, tracking error monitoring: maximum tracking error exceeded

Suggested steps:

- Please check the parameterization.
- Hydraulics, cyclic processing: Error during the cyclic execution of the hydraulics.
- In any case look at init outputs in the message window of the Moog DRIVEADMINISTRATOR 5.

# 11.6.53 Error 60: Spindle clamping system monitoring error

# 11.6.53.1   Error 60-1 (emergency code 6100h)

# 11.6.55   Error 62: Battery buffered encoder

Cause: Tool not clamped correctly while in operation

# 11.6.55.1   Error 62-1 (emergency code 7305h)

Cause: Encoder channel 1: Endat22, Error 'M-ALL-Power-Down' (BAT)

# Suggested steps:

- Do not switch on drive while tool is not clamped correctly

# 11.6.53.2   Error 60-2 (emergency code 6100h)

Cause: Unknown combination of input signals

# Suggested steps:

Multiturn position is lost! Please perform a new homing of the drive. Please reset the encoder internal warnings and errors with parameters (642) and (644).

'M-ALL-Power-Down' (BAT)

- A sensor with implementation of the multi-turn part via battery buffer is connected.
- The error occurs when both voltages, on the one hand the normal encoder supply voltage and on the other hand the auxiliary battery voltage, had failed at the same time at the encoder.
- In this case, the multiturn part of the position is lost.

# 11.6.53.3   Error 60-3 (emergency code 6100h)

Cause: Clamping pressure was not applied properly

# Suggested steps:

- Check clamping pressure generation

# 11.6.54   Error 61: End damping error

# 11.6.54.1   Error 61-1 (emergency code 6100h)

Cause: End damping speed limitation error

# Suggested steps:

- Switch off/on device. Please contact your service provider if this error occurs again

MOOG                     ID No.:CB40859-001 Date:11/2020

MSD ServoDrive - DeviceHelp  438

# 11 Alarms & warnings

# 11 Alarms & warnings

MOOG ID No.:CB40859-001 Date:11/2020

MSD ServoDrive - DeviceHelp 439

# 11.6.55.2 Error 62-3 (emergency code 7307h)

Cause: Encoder channel 3: Endat22, Error 'M-ALL-Power-Down' (BAT)

Suggested steps:

- Multiturn position is lost! Please perform a new homing of the drive.
- Please reset the encoder internal warnings and errors with parameters (642) and (644).

'M-ALL-Power-Down' (BAT)

- A sensor with implementation of the multi-turn part via battery buffer is connected.
- The error occurs when both voltages, on the one hand the normal encoder supply voltage and on the other hand the auxiliary battery voltage, had failed at the same time at the encoder.
- In this case, the multiturn part of the position is lost.

# 11.6.56 Error 63: Error brake monitoring

# 11.6.56.1 Error 63-1 (emergency code 6100h)

Cause: Brake monitoring error, cannot reach target torque, brake remains closed

Suggested steps:

- Check torque or system limits, control settings or motor data set
- This is possibly a hardware issue
- If other measures fail to solve the problem, please replace the servo drive.

# 12.1 CANopen / EtherCAT®

NOTE

- For a full description of the CANopen / EtherCAT® fieldbus option for the MSD Servo Drive and MSD Single-Axis Servo Drive Compact (operation, system requirements, connection, operating modes, configuration, commissioning), see the CANopen / EtherCAT® User Manual (ID No.: CA65647-001).
- CANopen is standardized in EN 50325-4.
- For general information on CANopen, please visit www.canopen.org.
- EtherCAT® is defined in IEC/EN 61158 and IEC 61784.
- For general information on EtherCAT®, please visit www.ethercat.org.
- EtherCAT® is a registered trademark and patented technology licensed by Beckhoff Automation GmbH, Germany.

# Chapter overview

This chapter describes the configuration options for various fieldbuses and makes reference to the corresponding User Manuals where appropriate.

# Contents

1. 12.1 CANopen / EtherCAT®
2. 12.2 SERCOS
3. 12.3 PROFIBUS / PROFINET
4. 12.4 Synchronization / Configuration
5. 12.5 EDS file generator

MOOG ID No.:CB40859-001 Date:11/2020

MSD ServoDrive - DeviceHelp 440

# 12 Fieldbus

MOOG ID No.:CB40859-001 Date:11/2020

# 12.2 SERCOS

NOTE

- For a full description of the SERCOS fieldbus option for the MSD Servo Drive and MSD Single-Axis Servo Drive Compact (operation, system requirements, connection, operating modes, configuration, commissioning), see the SERCOS II and III User Manual (ID No.: CA65648-001 and CA97557-001 available in EN only).
- SERCOS is defined in IEC 61784, IEC/EN 61158 and IEC/EN 61800-7.
- Refer to www.sercos.org for general information about SERCOS.

# 12.3 PROFIBUS / PROFINET

NOTE

- For a full description of the PROFIBUS and PROFINET fieldbus options for the MSD Servo Drive and MSD Single-Axis Servo Drive Compact (operation, system requirements, connection, operating modes, configuration, commissioning), see the PROFIBUS and PROFINET User Manual (ID No.: CA65645-001).
- PROFIBUS and PROFINET are defined in IEC/EN 61158 and IEC 61784.
- For general information on PROFIBUS and PROFINET, please visit www.profibus.com.

MSD ServoDrive - DeviceHelp 441

# 12.4 Synchronization / Configuration

This function is used to synchronize the internal controller clock with an external sync signal (e.g. from a fieldbus). When applications are experiencing a lot of jitter, this function makes it possible to eliminate it to the greatest extent possible.

NOTE

- If you are under the impression that your application requires the use of this special function, please contact your project engineer.

# 12.5 EDS file generator

Image 12.1: EDS file generator screen

To be able to integrate a MSD Servo Drive or MSD Single-Axis Servo Drive Compact into a CANopen fieldbus network, you will need an EDS file. This EDS file can:

1. Be generated with the help of the EDS file generator for the current firmware on the device
2. Be downloaded from our website, http://www.moogsoftwaredownload.com/msd.html.

NOTE

- The CANopen fieldbus system is one of the options available for the MSD Single-Axis Servo Drive Compact, MSD Servo Drive Single-Axis System and Multi-Axis System series. It is only available if installed at the factory, and cannot be retrofitted.

**Table 12.1: Synchronization / Configuration parameters**
|ID|Index Name|Unit|Description|
|---|---|---|---|
|2008|COM_SYNC_CTRL| |Set-up of fieldbus synchronization control|
|2008|COM_SYNC_CTRL_Ref|15ns|Reference time for incoming sync telegrams|
|2008|COM_SYNC_CTRL_Wnd|15ns|Window for detecting axis synchronization|
|2008|COM_SYNC_CTRL_kp| |DC link controller: Gain|
|2008|COM_SYNC_CTRL_ki|ms|integration|
|2008|COM_SYNC_CTRL_max|us|Maximum control output value|
|2008|COM_SYNC_CTRL_min|us|min control output|
|2008|COM_SYNC_CTRL_Tfil|ms|synchronization filter time|
|2008|COM_SYNC_CTRL_____|-| |
|155|MPRO_DRVCOM_CFG| |DriveCom: Device configuration (requires restart)|
|2009|COM_CFG_File| |Generates fieldbus specific config file|

MOOG ID No.:CB40859-001 Date:11/2020

MSD ServoDrive - DeviceHelp 442

# 12 Fieldbus

# 13 Technology options (X8)

# Chapter overview

Pictogram

Navigation &nbsp;&nbsp;&nbsp;&nbsp; ►Project tree ►Device setup ►Technology options (X8)

# Brief description

This chapter provides information on the technology options available for connector X8.

# Contents

- 13.1 Selection of modules &nbsp;&nbsp;&nbsp;&nbsp; 443 &nbsp;&nbsp;&nbsp;&nbsp; Image 13.1: “Technology options (X8) settings” screen
- 13.2 Second Sin/Cos encoder &nbsp;&nbsp;&nbsp;&nbsp; 444 &nbsp;&nbsp;&nbsp;&nbsp; Option X8 (available only from the factory; cannot be retrofitted) supports the following options:
- 13.3 Sin/Cos encoder &nbsp;&nbsp;&nbsp;&nbsp; 444
- 13.4 TTL with encoder simulation &nbsp;&nbsp;&nbsp;&nbsp; 445 &nbsp;&nbsp;&nbsp;&nbsp; l Sin/Cos module (see Section "Channel 3: Interface X8 (optional)" on page 76)
- 13.5 SSI encoder simulation &nbsp;&nbsp;&nbsp;&nbsp; 445 &nbsp;&nbsp;&nbsp;&nbsp; l TTL encoder/simulation (see Section "TTL with encoder simulation" on page 445)
- 13.6 TwinSync &nbsp;&nbsp;&nbsp;&nbsp; 446 &nbsp;&nbsp;&nbsp;&nbsp; l TTL encoder with commutation signals
- &nbsp;&nbsp;&nbsp;&nbsp; l SSI module (see Section "SSI encoder simulation" on page 445)
- &nbsp;&nbsp;&nbsp;&nbsp; l TWINsync module (see Section "TwinSync" on page 446)

For the encoder types that can be evaluated, see Section "Channel 3: Interface X8 (optional)" on page 76.

MOOG ID No.:CB40859-001 Date:11/2020 MSD ServoDrive - DeviceHelp 443

# 13 Technology options (X8)

MOOG ID No.:CB40859-001 Date:11/2020

MSD ServoDrive - DeviceHelp 444

# 13.2 Second Sin/Cos encoder

NOTE

l For a full description of the “Second Sin/Cos encoder” technology option (technical data, connections, configuration), see the “Specification Option 2 - Technology, second Sin/Cos encoder” (ID No.: CA79903-001).

# 13.3 Sin/Cos encoder

NOTE

l For a full description of the “Sin/Cos encoder” technology option (technical data, connections, configuration), see the “Specification Option 2 - Technology, Sin/Cos encoder” (ID No.: CB13516-001).

# 13.4 TTL with encoder simulation

NOTE

For a full description of the “TTL with encoder simulation” technology option (technical data, connections, configuration), see ...

- For the MSD Servo Drive with hardware version up to .1 and firmware version V2.15 or higher: The “Option 2 - Technology, TTL encoder / TTL encoder simulation Specification” (ID No.: CB08758-001)
- For the MSD Servo Drive with hardware version .2 or higher and any firmware version, as well as the MSD Single-Axis Servo Drive Compact with hardware version .1 or higher and firmware version V1.10 or higher: The “Option 2 - Technology, TTL encoder simulation / TTL master encoder Specification” (ID No.: CB32164-001).

# 13.5 SSI encoder simulation

NOTE

For a full description of the “SSI encoder option” technology option (technical data, connections, configuration), see the “Option 2 - Technology, SSI encoder simulation Specification” (ID No.: CB08760-001).

# 13.5.1 Parameters

SSI encoder simulation is enabled by setting P 2800[0] - TOPT_SSI_Mode to 1.

|ID|Index Name|Unit|Description|
|---|---|---|---|
|2800|TOPT_SSI_Mode| |Operation mode of SSI option|
|2801|TOPT_SSI_MultiT|bit|Number of multiturn bits|
|2802|TOPT_SSI_SingleT|bit|Number of singleturn bits|
|2803|TOPT_SSI_Polarity| |SSI polarity|
|2804|TOPT_SSI_Phase| |SSI phase|
|2805|TOPT_SSI_ParityEnable| |SSI parity enable|
|2806|TOPT_SSI_ParityType| |SSI type of parity bit|
|2807|TOPT_SSI_SyncOffset|us|SSI synchronization offset|
|2808|TOPT_SSI_SyncUse| |Synchronize to SSI cycle|
|2809|TOPT_SSI_InSync| |SSI synchronization status|
|2810|TOPT_SSI_EncobsUse| |Transmit encoder observation bit|
|2811|TOPT_InOut_EncSim_Source| |Encoder simulation, signal source|
|2820|TOPT_SSI_GrayCode| |Use Gray coding|
|2821|TOPT_SSI_Baudrate| |SSI Baud rate|
|2822|TOPT_SSI_MultiturnVal| |actual SSI multiturn value|
|2823|TOPT_SSI_SingleturnVal| |actual SSI singleturn value|

Table 13.1: SSI encoder simulation parameters

MOOG ID No.:CB40859-001 Date:11/2020

MSD ServoDrive - DeviceHelp 445

# 13 Technology options (X8)

MOOG ID No.:CB40859-001 Date:11/2020

MSD ServoDrive - DeviceHelp 446

# 13.6 TwinSync

NOTE

For a full description of the “TWINsync” technology option (technical data, connections, configuration), see the “Option 2 - Technology, TWINsync option Specification” (ID No.: CB08759-001).

# 14 Device status

To select various status and control signals for viewing in the oscilloscope or as trigger signals, click on the “Scope signals of Device status” (at the very top of the window).

Comprehensive error information can be accessed using the “Error History” button (see Section "Alarms and warnings (Details)" on page 316.)

If an error is currently present, it can be confirmed by clicking on the “Quit error” button.

# Chapter overview

This chapter describes the options available for viewing the device status.

# Contents

- 14.1 Device status
- 14.2 Status bits
- 14.3 Load factor

|ID|Index Name|Unit|Description|
|---|---|---|---|
|150|0| |Numerical status - Current numerical device status|
|152|0| |Textual status - Current device status|
|153|0| |Fault reset - Fault reset command|

NOTE: On the device, the device statuses are shown on the 7-segment display. See Operation Manuals MSD Servo Drive and MSD Single-Axis Servo Drive Compact.

MOOG ID No.:CB40859-001 Date:11/2020

# 14 Device status

MOOG ID No.:CB40859-001 Date:11/2020 MSD ServoDrive - DeviceHelp 448

# 14.2 Status bits

To select the DriveCom status word (P 151[0]) for viewing in the oscilloscope, click on the “Scope signals of Status bits” (at the very top of the window).

|ID|Index Name|Unit|Description|
|---|---|---|---|
|151|0|MPRO_DRVCOM_STAT_DWord|DriveCom status word (32Bit)|

# Table 14.2: “Device status - Status bits” parameters

| | |ID|Index Name| |Unit|Description|
|---|---|---|---|---|---|---|
| | |1651|0|LU_Timing|ms|Control ISR|
| | |1651|1|LU_Timing|ms|Asynchronous 1ms Task|
| | |1651|2|LU_Timing|ms|Initialization Task|
| | |1651|3|LU_Timing|ms|Control COM Handler|
| | |1651|4|LU_Timing|ms|Service COM Handler|
| | |1651|5|LU_Timing|ms|CoDeSys RTS Task|
| | |1651|6|LU_Timing|ms|Motion 1ms Task|
| | |1652|0|LU_Timing_Avg| |SW Timing: Average times|
| | |1652|0|LU_Timing|ms|Control ISR|
| | |1652|1|LU_Timing|ms|Asynchronous 1ms Task|
| | |1652|2|LU_Timing|ms|Initialization Task|
| | |1652|3|LU_Timing|ms|Control COM Handler|
| | |1652|4|LU_Timing|ms|Service COM Handler|
| | |1652|5|LU_Timing|ms|CoDeSys RTS Task|
| | |1652|6|LU_Timing|ms|Motion 1ms Task|
| | |1653|0|LU_Timing_Reset| |Reset maximal and average timing values|
| | |1654|0|LU_Timing_Total|%|Total computer load|
| | |1661|0|LU_MemoryLoad| |SW Memory: Memory Load|
| | |1661|0|LU_Memory|%|Context Save Area|
| | |1661|1|LU_Memory|%|Dynamic program memory total|
| | |1661|2|LU_Memory|%|Dynamic program memory ICODE|
| | |1661|3|LU_Memory|%|Dynamic program memory SCODE|

# Table 14.3: “Device status - Load” parameters

# 15 Manual mode

NOTE

- Read, comply with, and confirm the safety prompt!
- As soon as the “Manual mode” window opens, all unrelated device settings will be disabled. These device settings will be re-enabled after the “Manual mode” window is closed.

The manual mode window will appear, but be disabled at first. Once you click on the “Activate manual mode” button, a safety prompt that needs to be confirmed will appear.

# Chapter overview

# Pictogram

# Navigation

►Project tree ►Device setup ►Manual mode

# Brief description

This chapter describes the configuration and control options for the “Manual mode” window.

# Contents

- 15.1 Manual mode window 449
- 15.2 Manual mode control status 450

Image 15.1: Safety information

MOOG ID No.:CB40859-001 Date:11/2020

MSD ServoDrive - DeviceHelp 449

# Manual mode

MOOG ID No.:CB40859-001 Date:11/2020

# MSD ServoDrive - DeviceHelp

Once the safety prompt is confirmed, the “Manual mode” window will be enabled, after which you can select a control mode and configure it for manual operation. Depending on the control mode you selected, one to four configuration tabs will appear:

- A table with the parameters that are specific to the relevant control mode but that will only apply when using manual mode (e.g. acceleration, deceleration, setpoint, speed, etc.)
- Homing (see Section "Homing" on page 249)
- Jog mode, which can be used to move the motor step-by-step in a positive or negative direction with two different speeds.
- Reversing operation, in which the motor can be moved back and forth with adjustable accelerations and speeds.

# 15.2 Manual mode control status

Double-clicking on “Manual mode control status” will open a window that will show the status word for the MSD Servo Drive in hexadecimal format.

| | | | |ID|Index Name|Unit|Description|
|---|---|---|---|---|---|---|---|
| | | | |229|0|MPRO_PARA_CTRL|Drive commissioning: Control word|
|230|0|MPRO_PARA_PRef|mDegree|Drive commissioning: Position reference value / amplitude| | | |
|231|0|MPRO_PARA_SRef|rev/min|Drive commissioning: Speed reference value / amplitude| | | |
|232|0|MPRO_PARA_Acc|rev/min/s|Drive commissioning: Acceleration| | | |
|233|0|MPRO_PARA_Dec|rev/min/s|Drive commissioning: Deceleration| | | |
|234|0|MPRO_PARA_TRef|Nm|Drive commissioning: Torque reference value| | | |
|235|0|MPRO_PARA_Frequency|Hz|Drive commissioning: Frequency of test signal in IP mode| | | |
|236|0|MPRO_PARA_SignalType| |Drive commissioning: Type of test signal in IP mode| | | |
|237|0|MPRO_PARA_WatchDog|ms|Drive commissioning: Watchdog tick| | | |
|238|0|MPRO_PARA_Time|ms|Drive commissioning: Reverse control timer| | | |
|297|0|MPRO_FG_ActualSpeedFac| |Factor group: actual speed factor (1/min to user speed)| | | |

Table 15.2: “Manual mode control status” parameters

Table 15.1: “Manual mode” parameters

# 16 Drive description

The electronic rating plate provides a variety of information concerning the MSD Servo Drive, including the device model, serial number, communication and technology options, hardware and software versions, and operating time. This information is also available in the form of parameters.

# Contents

16.1 Electronic rating plate

# 16.1 Electronic rating plate

|ID|Index Name|Unit|Description|
|---|---|---|---|
|1|0|DV_DeviceId|Device family/series ID|
|2|0|DV_DeviceName|Device name / product name|
|3|0|DV_DeviceAliasName|Application-specific device name alias|
|4|0|DV_SwVersion|Firmware version of the device in plain text.|
|5|0|DV_DeviceFamilyName|Total software version of device (plain text) Device family name|
|6|0|DV_SwVersionId|Firmware version of the device|
|7|0|DV_SwModulVersion|Version numbers of supported software modules which have a parameter interface|
|7|1|DV_SwModulVersion| |
|7|2|DV_SwModulVersion| |
|7|3|DV_SwModulVersion| |
|8|0|DV_VendorName|Manufacturer name|
|49|0|DV_SwStatus|Flag representation of several software functions|
|59|0|DV_SwOptionX11Ver|Software version option on X11|
|63|0|DV_BuildDate|Build date and firmware info|
|79|0|DV_LoadedParamDataSet|Name of the currently loaded parameter data set|
|662|0|DV_CAL_ChopperGuard|Internal chopper guarding enable|
|672|0|DV_CAL_SerialNumServo|Production information: serial number of device|
|679|0|DV_CAL_ArticleNumber|Controller board article number|
|697|0|DV_CAL_SafeFirmDataCrc|Safety firmware data CRC|
|707|0|MON_OpTime_Raw|Operation time|
|708|0|MON_OpEnTime_Raw|Operation enabled time|

MOOG ID No.:CB40859-001 Date:11/2020 MSD ServoDrive - DeviceHelp 451

# 16 Drive description

MOOG ID No.:CB40859-001 Date:11/2020 MSD ServoDrive - DeviceHelp 452

|ID|Index|Name|Unit|Description|
|---|---|---|---|---|
|9|0|DV_SwVersionVar| |Software version variant of device (plain text)|
|24| |USB_IO_Statistic| |Statistic data of USB-IO Infineon driver|
|80|0|DV_SwBootVersion| |Bootloader information, version|
|24|0|uReset| |Reset statistics data|
|24|1|uIntEp0| | |
|24|2|uIntEp1| |Calling count of handler for end point 1 ACK interrupts|
|24|3|uIntEp2| |Calling count of handler for end point 2 interrupts|
|24|4|uSetup| |Calling count of SUI setup handler|
|24|5|uConfiguration| |Calling count of CFI configuration handler|
|24|6|uRxMsgCnt| |Number of received data packets|
|24|7|uRxMsgBytes| |Number of received data bytes|
|24|8|uTxMsgCnt| |Number of transmitted data packets|
|24|9|uTxMsgBytes| |Number of transmitted data bytes|
|24|10|uRxAck| |Calling count of receive acknowledge interrupt|
|24|11|uTxAck| |Calling count of transmit acknowledge interrupt|
|24|12|uIntTmtEp0| |Calling count of endpoint 0 transmit interrupt|
|24|13|uIntWrn| |Calling count of warning level interrupt|
|24|14|iRetryCount| |Number of second attempts to transmit a data packet|
|24|15|ResetCount| |Number of received reset command sequences|
|24|16|CriticalErrorCount| |Number of critical basic USB driver errors|
|24|17|CriticalErrorCount1| |Number of critical basic USB driver errors|
|24|18|CriticalErrorCount2| |Number of critical basic USB driver errors|
|24|19|CriticalErrorCount3| |Number of critical basic USB driver errors|
|24|20|CriticalErrorCount4| |Number of critical basic USB driver errors|
|24|21|AppliErrorCount| |Number of critical errors in application layer|
|24|22|RxFifoHandlerCnt| |Calling count of receive handler|
|24|23|USBdriveMode| |ID of USB driver mode (0 = none, 1 = old, 2 = secure)|
|24|24|BlockChecksumError| |Number of failed 64 byte blocks|
|60|0|DV_SwOptionX12ID| |ID software option on X12|
|64|0|DV_SwBaseVersion| |Software base version|
|65|0|DV_SwCompatibilityLevel| |Software compatibility level|

# Table 16.2: “Drive description - Software details” parameters

# Table 16.3: Parameter “Drive description - Hardware version"

# Table 16.4: Parameter “Drive description - Interface"

# Drive description

|ID|Index Name|Unit|Description|ID|
|---|---|---|---|---|
|15|11|GroupId|Identification number of parameter group to which this parameter belongs to|19|
|15|12|SaveGroups|Flag representation of device save group to|19|
|16| |PARA_DSC_SubPara|which this parameter belongs|20|
|16|0|ParaId|Description of a single sub parameter|20|
|16|1|SubParaId|Sub parameters no.|20|
|16|2|Name|Sub parameters name|20|
|16|3|Unit|Sub parameters unit|20|
|16|4|Introduction|Sub parameters short introduction|20|
|16|5|DataType|Sub parameters data type identification|20|
|16|6|DataTypeName|Sub parameters data type name|20|
|16|7|Attributes|Sub parameter attributes|20|
|16|8|Minimum|Sub parameter minimum value as float32|20|
|16|9|Maximum|Sub parameter maximum value as float32| |
|16|10|Default|Sub parameter default value as float32|20|
|16|11|StringMinimum|Minimum value as text| |
|16|12|StringMaximum|Maximum value as text|20|
|16|13|StringDefault|Manufacture-specific default value as text|20|
|16|14|NativeMinimum|Native sub parameter minimum value as 4-byte data stream|20|
|16|15|NativeMaximum|Native sub parameter maximum value as 4-byte data stream|21|
|16|16|NativeDefault|Native sub parameter default value as 4-byte data stream|21|
|17| |PARA_DSC_Groups|List of names of parameter groups|21|
|17|0|PARA_DSC_Groups| |21|
|17|...|PARA_DSC_Groups| |21|
|17|21|PARA_DSC_Groups| |21|
|18| |PARA_DSC_SaveGroups|List of names of parameter save groups|21|
|18|0|PARA_DSC_SaveGroup| |21|
|18|...|PARA_DSC_SaveGroup| |21|
|18|12|PARA_DSC_SaveGroup| |21|

# Table 16.4: Parameter “Drive description - Interface" (continue)

# MOOG ID No.:CB40859-001 Date:11/2020

# Device description concerning parameter list

|Index Name|Unit|Description|
|---|---|---|
|PARA_DSC_Device| |Device description concerning parameter list|
|0|ParaCount|Number of registered parameters|
|1|GroupCount|Number of parameter groups|
|2|SaveGroupCount|Number of parameter save groups|

# Detailed description of a parameter

| |Index|ID|SubParameterCount|Name|Introduction|ReadLevel|WriteLevel|Attributes|DisplayAttributes|IsComplex|IsInteractive|GroupId|SaveGroups|
|---|---|---|---|---|---|---|---|---|---|---|---|---|---|
| |PARA_DSC_Para2| |Detailed description of a parameter| | | | | | | | | | |
|0|Index|Index (consecutive numbering) of parameter in actual parameter listing| | | | | | | | | | | |
|1|ID|Parameter identification number| | | | | | | | | | | |
|2|SubParameterCount|Number of sub parameters| | | | | | | | | | | |
|3|Name|Parameter name| | | | | | | | | | | |
|4|Introduction|Short parameter introduction| | | | | | | | | | | |
|5|ReadLevel| |Essential level for parameter read access| | | | | | | | | | |
|6|WriteLevel| |Essential level for parameter write access| | | | | | | | | | |
|7|Attributes|Manufacturer dependent attributes| | | | | | | | | | | |
|8|DisplayAttributes|Harmonized attributes for parameter representation| | | | | | | | | | | |
|9|IsComplex|True if parameter consists of individually different sub parameters| | | | | | | | | | | |
|10|IsInteractive| |True if parameter access triggers an interactive| | | | | | | | | | |
| |11|GroupId|Identification number of parameter group to| | | | | | | | | | |
| |12|SaveGroups|Flag representation of device save group to| | | | | | | | | | |

# Short description of a single sub parameter

|ParaId|SubParaId|Name|Unit|Introduction|DataType|DataTypeName|Attributes|Minimum|
|---|---|---|---|---|---|---|---|---|
| |PARA_DSC_SubPara2| |Short description of a single sub parameter| | | | | |
|0|ParaId| |Short description of a single sub parameter| | | | | |
|1| |SubParaId|Sub parameters no.| | | | | |
| | |2|Name|Sub parameters name| | | | |
| | |3|Unit|Sub parameters unit| | | | |
| | |4|Introduction|Sub parameters short introduction| | | | |
| | |5|DataType|Sub parameters data type identification| | | | |
|6| |DataTypeName|Sub parameters data type name| | | | | |
|7|Attributes| |Sub parameter’s attributes| | | | | |
|8|Minimum| |Sub parameters minimum value as float32| | | | | |

# Drive description

MOOG ID No.:CB40859-001 Date:11/2020 MSD ServoDrive - DeviceHelp 454

|ID|Index Name|Unit|Description|
|---|---|---|---|
|21|9| |Maximum - Sub parameters maximum value as float32|
|21|10| |Default - Sub parameters default value as float32|
|21|11| |StringDefault - Manufacture-specific default value as text|
|21|12| |NativeMinimum - Native sub parameter minimum value as 4-byte data stream|
|21|13| |NativeMaximum - Native sub parameter maximum value as 4-byte data stream|
|21|14| |NativeDefault - Native sub parameter default value as 4-byte data stream|
|22|PARA_DSC_Groups2| |List of names of parameter groups|
|22|0| |PARA_DSC_Groups|
|22|...| |PARA_DSC_Groups|
|22|21| |PARA_DSC_Groups|
|48|PARA_DSC_| |List of names of parameter save groups|
|48|0| |PARA_DSC_SaveGroup|
|48|...| |PARA_DSC_SaveGroup|
|48|12| |PARA_DSC_SaveGroup|

Table 16.4: Parameter “Drive description - Interface" (continue)

# 17 Enhanced/additional functions

# 17.1 Reloading individual parameters

The parameters P 97 - PARA_DataSetLdCfg, P 98 - PARA_DataSetLdID and P 99 - PARA_DataSetLdVal provide the option of adapting individual parameter values as needed.

The parameters and values to be loaded can be defined by means of special character strings and assigned to an associated data set ID. Determination of the data set ID can be accomplished by means of digital inputs or a parameter, for example. One possible application would be storing two motor data sets in one device which can be switched over in dependence on a certain event.

# 17.1.1 Parameters used

P 97 - PARA_DataSetLdCfg

The parameter P 97 - PARA_DataSetLdCfg is used to activate the function and to make the general settings for the generation of the data set ID.

P 98 - PARA_DataSetLdID

The desired data set IDs are entered in P 98 - PARA_DataSetLdID. Up to 100 entries can be made (subindex 0 ....99). The parameter ID entered here makes reference to the subindex in PARA_DataSetLdVal via the associated subindex of PARA_DataSelLdID.

P 99 - PARA_DataSetLdVal

The character strings associated with the respective data set IDs (linked via the subindex with P 98) which define the parameters and values to be loaded are entered in P 99 - PARA_DataSetLdVal.

MOOG ID No.:CB40859-001 Date:11/2020

MSD ServoDrive - DeviceHelp 455

# Enhanced/additional functions

# MOOG

ID No.: CB40859-001 Date: 11/2020

# MSD ServoDrive - DeviceHelp

Parameter list

The parameter P 97 - PARA_DataSetLdCfg[1] FS is the function selector and specifies which source is used for determining the data set ID.

|ID|Index|Name/Setting|Unit|Description|
|---|---|---|---|---|
|97|PARA_DataSetLdCfg|DataSet Loader Configuration| |The parameter P 97 - PARA_DataSetLdCfg[2] (= PARA_DataSetLd_Mask) functions in this case as the bitmask for selecting (e.g. the desired digital inputs).|
| |0|Opt| |Configuration options|
| | |OFF (0)| |Function not active|
| | |ON(1)| |Activate function|
| |1|FS:| |Function selector|
| | |0 = OFF| |No data set ID is determined.|
| | |1 = TERM| |Determination via digital inputs (MPRO_INPUT_STATE & PARA_DataSetLdCfg[1])|
| | |2 = PARA| |The data set ID is determined from a selectable parameter. The value of the parameter (Para_ID/ParaSubID) is used to generate the data set ID.|
| |2|Mask| |Bitmask|
| |3|ActID| |Currently selected data set ID|
| |4|Para_ID| |Parameter index for generating the data set ID (if FS=PARA)|
| |5|Para_SubID| |Parameter subindex for generating the data set ID (if FS=PARA)|
| |6|Para_Scale| |The parameter value is scaled (multiplication) for the generation of the data set ID using the value indicated.|
| |7|Para_Offset| |Parameter offset for generating the data set ID|
|98|PARA_DataSetLdID| | |Automatic data set ID determination|
| |0 -99|PARA_DataSetLdID| |List of the possible data set IDs|
|99|PARA_DataSetLdVal| | |Associated character strings which describe parameters and values which are to be changed|

# Table 16.5: Parameter “Reloading individual parameters”

Activation

The function is activated by the setting of the parameter P 97 - PARA_DataSetLdCfg[0] Opt = 1.

# Determining the data set ID

Using P 97 - PARA_DataSetLdCfg[6] - Para_Scale and P 97 - PARA_DataSetLdCfg[7] - Para_Offset, the parameter value is now first multiplied by “Para_Scale” and then “Para_Offset” is added. The resulting value is rounded to the nearest integer to obtain the data set ID.

NOTE

Currently, only float32 parameters are supported. If the specified parameter cannot be read or if it is not a float32 parameter, the data set ID generated is always “0”.

# Configuring the data set for the determined data set ID

The settings in parameters P 98 and P 99 must now be made for the data set ID that has been determined.

P 97 - PARA_DataSetLd [3] = ActId shows the currently determined or entered data set ID.

Enter this data set ID under P 98 - PARA_DataSetLdID - Index X for the required subindex. The system then uses the subindex of P 98 to branch to the subindex of P 99 - PARA_DataSetLdVal - Index X. The configuration data for the new parameters must be entered in this index.

Select parameter P 99 - PARA_DataSetLdVal - Index X. This must be the same index as the index selected under P 98 - PARA_DataSetLdID - Index X.

Then enter the configuration data for the parameters for the selected index of P 99 - Para_DataSelLdVal under "Value". This must have the syntax <INDEX>,<SUBINDEX>,<VALUE>;<INDEX>,<SUBINDEX>,<VALUE>; ….

# 17 Enhanced/additional functions

# 17.1.3 Procedure

Activate the function using:

P 97 - PARA_DataSetLdCfg[0] = 1

Generate the data set ID using:

P 97 - PARA_DataSetLdCfg[1] = 2

Set Para_ID and Para_SubID using P 97 - PARA_DataSetLdCfg[4] and P 97 - PARA_DataSetLdCfg[5].

Set Para_Scale and Para_Offset using P 97 - PARA_DataSetLdCfg[6] and P 97 - PARA_DataSetLdCfg[7].

The data set ID is now displayed under P 97 - PARA_DataSetLdCfg[2] = ActID.

Enter the determined data set ID under P 98 - PARA_DataSetLdID[x] = Subindex X.

Now enter the configuration of the parameter under P 99 - PARA_DataSetLdID[x] = Subindex X.

Compare the data set ID with elements of P 98- PARA_DataSetLdID[x]

The parameter P 98 - PARA_DataSetLdID[x], which consists of 100 elements (0 . . . 99), is run through completely and the values of the elements are compared to the determined data set ID (determination as described above).

If the data set ID in parameter P 98- PARA_DataSetLdID[x] was not found at least once, an error 15-21 is triggered (“Dataset to be loaded is not valid!”). This error can be acknowledged and the drive can subsequently be put into operation.

If the data set ID is found in element x, the string in the associated parameter P 99 - PARA_DataSetLdVal[x] is interpreted. This must have the format <INDEX>,<SUBINDEX>,<VALUE>;<INDEX>,<SUBINDEX>,<VALUE>;…

MSD ServoDrive - DeviceHelp 457

# 17 Enhanced/additional functions

MOOG ID No.:CB40859-001 Date:11/2020

# MSD ServoDrive - DeviceHelp

(length: max 100 characters each). The consecutively specified parameter values are loaded accordingly. If, for example, a data set ID with the ID “123” is determined, the parameters 456 are loaded accordingly. If the string cannot be interpreted due to input errors, an error message is generated.

It is possible to specify the same data set ID in several elements, x1, x2, x3.... In this case, all strings are interpreted from P 99 - PARA_DataSetLdVal[x1], P 99 - PARA_DataSetLdVal[x2]…. If a parameter is written more than once here, the last value specified is valid.

# Loading the data set

Loading of the parameters is initiated by:

- starting the device
- a change in data set ID.

# Functional example:

|P 98 - PARA_DataSetLdlD[x]|SubID|P 98|SubID|P 99|P 99 - PARA_DataSetLdVal[x]| | |
|---|---|---|---|---|---|---|---|
|123|0|ßà|0|456,0,300;451,0,Testmotor| | | |
|456|1|ßà|1|456,0,350; 451,0,Supermotor| | | |
|456|2|ßà|2|320,0,0.01;;;; 321,0,20;| | | |
| | | |456|3|ßà|3| |
|65535|4|ßà|4| | | | |
|65535|5|ßà|5| | | | |
|65535|6|ßà|6| | | | |
|456|7|ßà|7|360,0,1e3| | | |
|65535|8|ßà|8| | | | |
|123|9|ßà|9| | | | |
|789|10|ßà|10| | | | |
|65535|11|ßà|11| | | | |
|...|...|ßà|...| | | | |
|..|..|ßà|..| | | | |
| |99|ßà|99| | | | |

Table 16.6: Functional example

# 17.2 Upload and download of parameter data sets

No. Action

Assign name for the parameter data set:

1. With byte 0 of P 2010[0] - COM_CFG_ID: Specifies the name of the parameter data set. The parameters P 2009[0] - COM_CFG_File and P 2010[0] - COM_CFG_ID can be used to write the configuration of the servo drive to the file system of the servo drive as a parameter data set or read it from there. The parameter data set is saved in a file with the syntax PDSxx.dmd. The xx in the filename stands for the data set number. Up to 100 data sets (0 to 99) can be saved.

This allows various different configurations to be saved in a servo drive as parameter data sets and then be called up as needed for the respective operational situation.

The parameter data sets can be loaded to the PC using an FTP script or from there back to the servo drive.

Specify options:

1. Using byte 1 of P 2010[0] - COM_CFG_ID specifies the options for the parameter data set.

Create parameter data set:

P 2009[0] - COM_CFG_File = 18

1. Create a parameter data set in the file system /para/PDS00.dmd. The parameter data set is now saved in the servo drive with the selected name.

Transfer the parameter data set to the PC using the FTP script:

The following script can be used to transfer the parameter data set from the servo drive to the PC.

open 192.168.39.5
get /para/PDS00.dmd
quit

P No. Index Name Unit Description

|2009|0|COM_CFG_File|Access to the file system: Loading and saving of configuration files|
|---|---|---|---|
| | | |-2 (ERROR) Error during RAM or MMC access|
| | | |-1 (Running) = File creation is running|
| | | |0 (Ready) = File creation is finished|
| | | |18 Create parameter data set on FS.|
| | | |19 Read parameter data set from FS and write to device parameters.|
|2010|0|COM_CFG_ID|Access to file system: Assign additional parameter data set ID.|
| | | |With byte 0: Specification of the parameter data set number.|
| | | |Bit 0 of 2010[0] to bit 7 of 2010[0]|
| | | |With byte 1: Specification of the options|
| | | |Bit 0 = 1: Remove fieldbus-specific parameters from the data set.|
| | | |Bit 1 = 1: Remove scope parameters from the data set.|

# 17.2.1 Write parameter data set to the file system

MOOG ID No.:CB40859-001 Date:11/2020

MSD ServoDrive - DeviceHelp 459

# 17 Enhanced/additional functions

# 17 Enhanced/additional functions

# 17.2.2 Loading the parameter data set from the file system

|No.|Action|
|---|---|
|1|Load the parameter set from the PC to the file system of the servo drive via FTP script:|
| |open 192.168.39.5|
| |Servo Drive|
| |mkdir /para|
| |cd /para|
| |put PDS00.dmd|
| |quit|
| |The parameter data set is now present in the servo drive file system.|
|2|Enter the name of the parameter data set to be read with byte 0 of P 2010[0] - COM_CFG_ID: Specifies the name of the data set to be read. 0-99 means PDS00...PDS99.|
|3|Specify options with byte 1 of P 2010[0] - COM_CFG_ID: Specification of the options. Bit 0 = 1: Save the data set permanently to the non-volatile servo drive.|
|4|Read the parameter data from the file system and write to the device parameters. P 2009[0] - COM_CFG_File = 19.|
|5|If everything has worked properly, P 2009[0] - COM_CFG_File is automatically set to 0 = Ready once again. If there is an error, P 2009[0] - COM_CFG_File is set to -2 = error.|

# Index

|Technology option|Page|
|---|---|
|Touch probe|292|
|Channel 1|59|
|Channel 2|72|
|Channel 3|76|
|Absolute interface|59, 63-67, 69, 72, 78-79, 82, 87|
|Channel 4|90|
|Acceleration|267|
|Alarms & warnings|314, 316|
|Analog channel|270, See also Inputs, Analog|
|Asynchronous motor|See Motor, Asynchronous|
|Asynchronous motor I²t monitoring|44|
|Automatic test|22|
|Wizard|17|
|Common master|287|
|CAM|288|
|Compensation| |
|Control word|279|
|Function selectors|299|
|Parameters|278|
|Detent torque|115|
|Control|108, See also Torque control; Speed control; Position control|
|CANopen|21, 440|
|EDS file|442|
|State machine|274|
|Shutdown|249|

MOOG ID No.:CB40859-001 Date:11/2020

MSD ServoDrive - DeviceHelp 461

# Index

MOOG ID No.:CB40859-001 Date:11/2020

# MSD ServoDrive - DeviceHelp

Control location selector 294 D

# Control word

- Auto commutation 157
- Deceleration 268
- Fieldbus 295
- Device status 447
- Homing 250
- Digital filter 136
- Hydraulic 190, 192, 212 E
- Process controller 166-167
- Electronic cam plate 277
- Reference table 268-269
- Sensorless control 91
- Speed control 135
- Synchronized motion 277, 279
- Test signal generator 162
- Touch probe 275

Copyright 3

- Encoder 51, 447, 451
- Current control See Torque control
- Gearing 71, 75, 89
- Current Controller
- Sampling time 109
- Current observer 127
- Pin assignment 55
- Selection 53

# Index

# EnDat

- Connection 57-58
- Interface 67
- Hall sensor 62, 82
- Limitation 52
- Hardware requirements 17
- Linear 66
- Homing 249
- On X8 technology option 78, 81-82, 84-86
- Pin assignment 57-58
- Signal correction 60

# EPMS

- Method (-10) 252
- Method (-11) 252
- Method (-12) 252
- Method (-13) 251
- Error Method (-7) to (0) 254
- Display 324
- Reactions 325

# EtherCAT®

- Method (1) 255

# Exclusion of Liability

- 11

# F

- Method (11) 259
- Method (12) 259
- Method (13) 259

# Field weakening

- Asynchronous motor 143, 145
- Synchronous motor 146, 156

# Fieldbus

- 440, See also CANopen; EtherCAT®; SERCOS; PROFIBUS; PROFINET
- Method (17) to (30) 261

# MOOG

ID No.:CB40859-001 Date:11/2020

# MSD ServoDrive - DeviceHelp

463

# Index

MOOG ID No.:CB40859-001 Date:11/2020

# MSD ServoDrive - DeviceHelp

|Method (2)|255|Interpolation types|246|
|---|---|---|---|
|Method (3)|256|J| |
|Method (31)|262| | |
|Method (32)|262|Jog mode|264|
|Method (33)|263|L| |
|Method (34)|263| | |
|Method (35)|263| | |
|LHMES(2) method|159| | |
|Method (4)|256|Limit switch|255|
|Method (5)|257|negative|259|
|Method (6)|257|Limitations|310|
|Method (7) to (10)|258|Jerk|244|
| | |Position|312|
| | |Setting|310|
|IECON(4) method|160|Speed|312|
|IENCC(1)|158|Load factor|448|
|Inputs|289|M| |
|Analog|303, See also Analog channel|Profile mode|306|
| | |Scaling|305|
|Digital|290| | |
| | |Manual mode|449-450|
| | |Mass inertia| |
| | |Adaptation|111|

# Index

|Determining|111|Third-party|33|
|---|---|---|---|
|Master configuration|280|Multi-turn encoder|106|
|Modulo weighting|238|as single-turn encoder|104|
|Motion profile|221|Multi-turn overflow|106|
|Basic settings|241| | |
|Data handling|288| | |
|Settings|222|Operating time|451|
|Motor|32|Outputs|289|
|Asynchronous|38|Analog|307|
|Electronic data|39|Digital|298, 323|
|Brake|309|Motor brake|308|
|Output|308|Overmodulation|128|
|Configuration|32|Oversampling|104|
|Identification|45|P| |
|Protection|40, 302|I²t|43|
|Synchronous|33, 35|Position control| |
|IP mode|244|PG mode|242|
|Reference table|266-268|Reference value limitation|302|

MOOG ID No.:CB40859-001 Date:11/2020

MSD ServoDrive - DeviceHelp 465

# Index

# MOOG

ID No.: CB40859-001 Date: 11/2020

# MSD ServoDrive - DeviceHelp

Setting

|Position controller|Sampling time|Position polarity|Power-up sequence|Power failure response|Power stage|Settings|PRBS signal|Pre-control|Process controller|
|---|---|---|---|---|---|---|---|---|---|
|Limitation|Shutdown|Table|Reference mark|Increment-coded|Negative|Resolver cables|Responsibility|Restart|Rigidity of the drive train|
|Power stage|25|25|164|140|166|21, 441|441|249|111|
|Quick stop|249|Sensorless|134|Rate limiter|171|Safe Torque Off|See STO (Safe Torque Off)|Safety|15|

# References

Reference: 266, 301

Shutdown: 249

Reference mark: 66, 86, 256, 259, 261

Increment-coded: 105

Negative: 257

Resolver cables: 73

Responsibility: 16

Restart: 102

Rigidity of the drive train: 111

Infinite motion task: 229

Process option: 227-228

Relative motion task: 229

# Index

|Scaling|223, See also Weighting|
|---|---|
|Acceleration|236|
|Position unit|230|
|Speed|232|
|User defined|238|
|SERCOS|21, 441|
|‘Halt’ status|299|
|Axis correction|102|
|Device warning status word|315|
|Error reaction|326|
|Motion profile|222|
|Reference via|295|
|Scaling|223, 229|
|Touch probe|276|
|Sin/Cos|52, 63-67, 72, 82, 84, 86|
|Connection|57-58|
|Oversampling|104|
|Pin assignment|57-58|
|Pulses per revolution|59, 79|
|Second on X8 technology option|76, 78, 443-444|
|MOOG|ID No.:CB40859-001 Date:11/2020|
|MSD ServoDrive - DeviceHelp|467|

# Index

MOOG ID No.:CB40859-001 Date:11/2020

|Reference value reached|301|
|---|---|
|Rigidity of the drive train|111|
|Setting|20, 125|
|Together with position control|109, 140|
|With linear synchronous motor|36|
|With setpoint via analog channel|270|
|Speed controller| |
|Sampling time|109|
|Speed factor|282|
|Speed observer|133|
|SSI|69, 87|
|Encoder simulation|445|
|State machine|273|
|Status bits|448|
|Status word| |
|Commissioning|450|
|Device warning|314|
|DriveCom|298, 311, 448|
|Hydraulic|192, 213|
|Process controller|166-167|
|MSD ServoDrive - DeviceHelp|468|
|Synchronized motion|277, 279|
|STO (Safe Torque Off)|16, 293, 296, 299-300|
|Stop|249|
|Stop ramps|248|
|Synchronized motion|276, See also Electronic cam plate; Electronic gearing|
|Synchronous motor|See Motor, Synchronous|
|Target Group|9|
|Technology options (X8)|76, 79, 443|
|CANopen + 2AO|307|
|Connections|55|
|Pin assignment|55|
|Second Sin/Cos encoder|444|
|Selection of modules|443|
|SSI encoder simulation|445|
|TTL with encoder simulation|445|
|TwinSync|446|
|Temperature sensors| |
|Connection|42|

# Index

|Insulation|56|Encoder for|53-55, 98|
|---|---|---|---|
|Motor|40|Expanded|125|
|Warning threshold|323|For hydraulic systems|173, 208|
|Test signal generator|161|Optimization|113|
|Thresholds|310|Reference table|266-268|
|Torque| |Reference value limitation|301|
|During homing|252-253|Reference value reached|301|
|Field weakening|143, 145-146, 148, 156|Setting|23, 113|
|K-T characteristic|127|Stop ramps|248|
|Limitation|293, 299, 301, 310-311|With setpoint via analog channel|270|
|Pre-control|140|Touch probe|275|
|Scaling|229, 234, 305|Transfer function|114, 138|
|Synchronous motor (linear)|38|TTL|52, 63, 82-83, 87|
|Synchronous motor (rotary)|35|Connection|57-58|
|Test signal generator|162|Encoder simulation|76, 78|
|With analog setpoint setting|270|Hall|62|
|With speed control|109|Master encoder|76, 78|
|Torque control| |Pin assignment|57-58|
|Adaption|125|Pulses per revolution|59, 79|
|Defined bandwidth|129|with commutation signals|76, 78|

MOOG ID No.:CB40859-001 Date:11/2020

MSD ServoDrive - DeviceHelp 469

# Index

# MOOG

ID No.: CB40859-001 Date: 11/2020

# MSD ServoDrive - DeviceHelp

470

# U

Wire break monitoring 271, 306

Activation 54

# Units

See Scaling

# V

Z

Zero pulse 107, 255, 257, 259, 263

V/Hz mode 165

# Versions

Hardware 451

Software 451

Virtual Master 286

# W

Warning status 314

Warning thresholds 323

Warnings 15

Weighting See also Scaling

linear 231

rotary 232

# Wire break

See Wire break monitoring

# TAKE A CLOSE LOOK:

# MOOG

# Moog GmbH

Moog solutions are available worldwide. You can obtain more information on our website or from a Moog branch office in your vicinity.

Hanns-Klemm-Strasse 28

D-71034 Böblingen

Phone +49 7031 622-0

Fax +49 7031 622 100

|Australia|India|The Netherlands|
|---|---|---|
|+61 3 9561 6044|+91 80 4057 6666|+31 252 462 000|
|Service +61 3 8545 2140|Service +91 80 4057 6604|info.thenetherlands@moog.com|
|info.australia@moog.com|info.india@moog.com|service.netherlands@moog.com|
|service.australia@moog.com|service.india@moog.com| |

|Brazil|Ireland|Russia|
|---|---|---|
|+55 11 3572 0400|+353 21 451 9000|+7 8 31 713 1811|
|info.brazil@moog.com|info.ireland@moog.com|Service +7 8 31 764 5540|
|service.brazil@moog.com| |info.russia@moog.com|
| | |service.russia@moog.com|

|China|Italy|Sweden|
|---|---|---|
|+86 21 2893 1600|+39 0332 421 111|+46 31 680 060|
|Service +86 21 2893 1626|Service 800 815 692|info.sweden@moog.com|
|info.china@moog.com|info.italy@moog.com|service.sweden@moog.com|
|service.china@moog.com|service.italy@moog.com| |

|Germany|Japan|Singapore|
|---|---|---|
|+49 7031 622 0|+81 46 355 3767|+65 677 36238|
|Service +49 7031 622 197|info.japan@moog.com|Service +65 651 37889|
|info.germany@moog.com|service.japan@moog.com|service.singapore@moog.com|
|service.germany@moog.com| | |

|France|Canada|Spain|
|---|---|---|
|+33 1 4560 7000|+1 716 652 2000|+34 902 133 240|
|Service +33 1 4560 7015|info.canada@moog.com|info.spain@moog.com|
|info.france@moog.com|service.france@moog.com| |

|United Kingdom|Korea|South Africa|
|---|---|---|
|+44 (0) 1684 858000|+82 31 764 6711|+27 12 653 6768|
|Service +44 (0) 1684 858000|info.korea@moog.com|info.southafrica@moog.com|
|info.uk@moog.com|service.korea@moog.com| |
|service.uk@moog.com| | |

|Hong Kong|Luxembourg|Turkey|
|---|---|---|
|+852 2 635 3200|+352 40 46 401|+90 216 663 6020|
|info.hongkong@moog.com|info.luxembourg@moog.com|info.turkey@moog.com|

USA

+1 716 652 2000

info.usa@moog.com

service.usa@moog.com

MOOG

ID No.:CB40859-001 Date:11/2020

MSD ServoDrive - DeviceHelp 471

Moog is a registered trademark of Moog, Inc. and their branches. All of the trademarks listed here are the property of Moog Inc. and their branches. All rights reserved.

© 2020 Moog GmbH. Subject to technical change without notice.

The content of our documentation was compiled with the greatest care and attention, and based on the latest information available to us. We should nevertheless point out that this document cannot always be updated in line with ongoing technical developments in our products.

Information and specifications may be subject to change at any time. For information on the latest version, please visit drives-support@moog.com.

The German version is the original version of this documentation.

# MOOG

ID No.: CB40859-001

Date: 11/2020

# MSD ServoDrive - DeviceHelp

472