,NODE_FILE_NAME,NODE_NUMBER,NODE_HASH,NODE_TEXT,Q,A1,A2,A3,A4,A5
0,msd_servo_drive.txt,29,8b7b14207d0506f3f75c9a63fb98a68193e71ed0f7337bac8f26cb3596e2b576,"3: “TTL encoder simulation / TTL master encoder”
- No. 4: “SSI encoder simulation”
- No. 5: “TTL encoder with commutation signals”

NOTE

- For information on the connector, pinout, technical data, configuration, and the encoder models (if any) that can be evaluated with the included technology option, please consult the Specification specified in the “Documentation” column.

The following table shows how the X8 options that can be used for encoder evaluation can be identified and selected.

|“No.” column|As per the table above.|
|---|---|
|“Hardware ID” column|The texts in this column can be viewed in the Moog DRIVEADMINISTRATOR 5 using P 53[0] - DV_HwOptionX12ID by going to ►Drive description ►Hardware version if the corresponding technology option is present.|
|“Selection” column|In certain cases, several different encoder types can be run on a technology option and selected with P 507 - ENC_CH3_Sel. Even if a technology option that does not match is equipped, most values can only be selected with P 507 - ENC_CH3_Sel. If an impermissible combination is selected, this will be indicated by means of error messages during the initialization phase.|

MOOG ID No.:CB40859-001 Date:11/2020

MSD ServoDrive - DeviceHelp 77

# 6 Encoder

MOOG ID No.:CB40859-001 Date:11/2020

# MSD ServoDrive - DeviceHelp

|No.|Technology option name|Hardware ID|Selection|
|---|---|---|---|
|0|No module|NONE(0) - No technology option|OFF (0)|
| | |SINCOS(1) - Sin/Cos cyclic *)| |
| | |- Without absolute value interface, Abs=OFF(0), with zero pulse| |
| | |- With SSI one-time reading, Abs=SSI(1)| |
|1|Second Sin/Cos encoder|SINCOS_V2(10) - 2nd Sin/Cos encoder (V2)|- With EnDat one-time reading, Abs=ENDAT(2)|
| | |SSI(2) - Cyclical SSI (without analog tracks)| |
| | |TTL(3) - TTL evaluation, with zero pulse| |
| | |ENDAT(4) - Cyclical EnDat (without analog tracks)| |
|3|TTL encoder simulation / TTL master encoder|TTL_ECSIM_V2(9) - TTL Encodersimulation (V2)|TTL(3)|
|4|SSI encoder simulation|SSI_ECSIM(3) - SSI encodersimulation|SSI(2) - Cyclical SSI (without analog tracks)|
|5|TTL encoder with commutation signals|TTL_COM(11) - TTL + Hall option|TTL(3)|
| | |TTL_COM(5)| |

Table 6.19: Options for X8 interface that can be used to evaluate encoders via encoder channel Ch3

*) SINCOS(1) is set via the P 507[0] - ENC_CH3_Sel main interface. The auxiliary interface, P 570[0] - ENC_CH3_Abs, can be optionally used to set the one-time reading for the absolute position during initialization.

# NOTE

- Only one encoder with a purely digital EnDat or SSI interface can be used on connector X8 or X7.
- If two EnDat encoders are used and one of them is purely digital, it is necessary to ensure that the purely digital encoder is connected to X8. This is important, as the EnDat encoder with Sin/Cos tracks must be initialized before the purely digital encoder.

# Encoder Configuration

To see which technology option your Servo Drive features (if any), go to Project Select from database tree ► Device setup ► Drive description in Moog DRIVEADMINISTRATOR 5 and check under “Technology option” in the “Hardware” section.

# Encoder Name

You can use this field to enter your own information for describing the encoder (maximum of 31 characters) (P 580[0] - ENC_CH3_Info).

# Cyclic Position Via

This drop-down menu is used to select the “main interface” (P 507[0] - ENC_CH3_Sel).

# Pulses Per Revolution

Once SINCOS(1), TTL(3) or TTL_COM(5) is selected as the “main interface,” this field will appear so that you can enter the number of analog Sin/Cos tracks per revolution (TTL tracks as well).

# Absolute Interface

This drop-down menu is used to select the “auxiliary interface” (P 570[0] - ENC_CH3_Abs).

# Image 6.5: Encoder Configuration Channel 3 (X8) Screen

This screen is used to select the encoder for channel Ch3. This channel uses the encoder’s “main interface” to measure position changes periodically and add them up cyclically – this is referred to as “cyclical evaluation.”

Encoders with a main interface that only makes it possible to measure the cyclical position incrementally often feature an additional absolute value interface referred to as an “auxiliary interface.” For this interface, the absolute position is measured once during the initialization phase and is then used for absolute value initialization purposes.

# Note

l Selecting an “auxiliary interface” is redundant if, for example, SSI (2) is selected as the “main interface” (corresponds to cyclical evaluation via SSI). In this case, the absolute value initialization will also be carried out via the SSI interface, regardless of the selected “auxiliary interface.”

# Gear Ratio

These fields can be used to define a gear ratio for the encoder (in the output side). For more details, see Section ""Encoder gearing"" on page 89.

MOOG ID No.:CB40859-001 Date:11/2020

MSD ServoDrive - DeviceHelp 79

# 6 Encoder

MOOG ID No.:CB40859-001 Date:11/2020

# MSD ServoDrive - DeviceHelp

Signal correction (GPOC) l P 577[0] - ENC_CH3_EncObsMin

If you set EncObsMin to 0, Sin/Cos wire break monitoring will be disabled.

GPOC is a special Moog online process for improving the quality of Sin/Cos signals before they are used to calculate a position. If “SINCOS(1)” is selected as the “main interface,” this process may be useful. For details see Section ""Signal correction GPOC (Gain Phase Offset Correction)"" on page 74.

The default value is 0.2 (20%) and stands for a calculated amplitude value (calculated using the two Sin/Cos signals) of x = sqrt(a² + b²). If the Sin/Cos signals are equal to approx. 1 Vss when compared, approx. 0.8 will be calculated here (approx. 80% magnitude at the A-D converters; approx. 0.25 Vss Sin/Cos will yield approx. 0.2 here (20% magnitude at the A-D converter)). The error threshold can be adjusted with EncObsMin.

# 6.7.1 Main parameters for encoder channel Ch3

The following table lists the most important parameters for the Ch3 encoder channel. These parameters are described in the chapters that go over selecting the various encoders with P 507[0] - ENC_CH3_Sel and P 570[0] - ENC_CH3_Abs.

When used with its default setting, this parameter will ensure that the absolute value initialization “starts up with plus-minus”. I.e. the encoder’s multi-turn value range from 0 to max will be mapped to -½ max to +½ max. The range from +½ max to max will be initialized as negative; in this case, the point of discontinuity will be found at ½ max. This can be changed with MTBase. When MTBase = 0, the absolute value initialization will, for example, “start up with zero to max”. I.e. the encoder’s multi-turn value range from 0 to max will be mapped to 0 to max. The range from +½ max to max will be initialized as positive; in this case, the point of discontinuity will be found at 0.

l P 585[0] - ENC_CH3_MTEnable

If you set MTEnable to 1, you can use an available multi-turn rotary encoder as a single-turn rotary encoder, which can come in handy for testing purposes.

|P No.|Index|Name / Setting|Unit|Description|
|---|---|---|---|---|
|507|0|ENC_CH3_Sel| |Main selection on encoder channel Ch3|
|570|0|ENC_CH3_Abs| |Absolute value interface for one-time reading|
|572|0|ENC_CH3_Lines| |Number of analog Sin/Cos lines per revolution (TTL lines as well)|
|573|0|ENC_CH3_MultiT| |Number of multi-turn bits for the digital interface|
|574|0|ENC_CH3_SingleT| |Number of single-turn bits for the digital interface|
|575|0|ENC_CH3_Code| |Code selection (for SSI encoders) (binary, Gray)|
|576|0|ENC_CH3_Mode| |Mode selection (for SSI encoders)|
|583|0|ENC_CH3_|nm|Linear encoders: Length of a digital increment in|
|584|0|DigitalResolution|nm (nanometres)| |
|585|0|ENC_CH3_MTBase| |Definition of point of discontinuity in multi-turn range|
|636|0|ENC_CH3_MTEnable| |Enable MultiTurn use (negative logic, 1=MToff)|
|636|0|ENC_CH3_CycleCount| |Sampling cycle in: n x 125 μ (microseconds)|

NOTE: As there are various protocol modes available for SSI encoders (with/without wire break monitoring, with/without parity bit, etc.), consult with your project supervisor or the Helpline provided by Moog before using any special SSI protocol modes.

As the functionality of the parameters for encoder channel Ch3 is predominantly identical to that of the parameters for encoder channel Ch1, it is recommended to read the description for the Ch1 encoder channel parameters.

Accordingly, the following table starts by listing all the parameters for the Ch3 encoder channel. If the functionality of a parameter is different from that of the corresponding parameter for encoder channel Ch1, the parameter will be described in the chapters that go over selecting a special encoder with (507) ENC_CH3_Sel and (570) ENC_CH3_Abs.

Parameters Lines, MultiT, SingleT, etc. are self-explanatory. Most of the following parameters are explained in the information for encoder channel Ch1 (see Section ""Channel 1: Interface X7"" on page 59).

# Table 6.21: Encoder configuration channel 3 (X8) parameters

|ID|Index|Name|Unit|Description|
|---|---|---|---|---|
|349|0|CON_FM_MConOffset| |Commutation offset|
|502|0..3|ENC_CH3_ActVal| |Current position value at encoder channel Ch3 output|
|507|0|ENC_CH3_Sel| |Main selection on encoder channel Ch3|
|514|0|ENC_CH3_Num| |Encoder gearing: Numerator|
|515|0|ENC_CH3_Denom| |Encoder gearing: Denominator|
|520|0|ENC_MCon| |=3, channel selection for motor commutation|
|521|0|ENC_SCon| |=3, channel selection for speed control|
|522|0|ENC_PCon| |=3, channel selection for position control|
|570|0|ENC_CH3_Abs| |Absolute value interface selection (one-time reading)|
|571|0|ENC_CH3_NpTest| |TEST-MODE: Index pulse signal(s) to Scope|
|572|0|ENC_CH3_Lines| |Number of Lines (Sin/Cos / TTL encoders)|
|573|0|ENC_CH3_MultiT| |Number of MultiTurn bits (absolute encoder)|
|574|0|ENC_CH3_SingleT| |Number of SingleTurn bits (absolute encoder)|
|574|0|ENC_CH3_Code| |Code selection (SSI encoder) (binary, gray)|
|576|0|ENC_CH3_Mode| |Mode selection (SSI encoder)|
|577|0|ENC_CH3_EncObsMin| |Encoder monitoring minimum, sqrt (a^2+b^2)|
|578|0|ENC_CH3_Extended| |(a^2 + b^2) ENC CH3: Extended|
|580|0|ENC_CH3_Info| |Encoder information channel 3|
|581|0|ENC_CH3_AbsEncStatus| |Error and status codes (absolute encoder)|
|582|0|ENC_CH3_PeriodLen|nm|Length of signal period (Sin/Cos linear encoder)|

# Encoder configuration channel 3 (X8) parameters (continue)

|Index|Name|Unit|Description|
|---|---|---|---|
|0|ENC_CH3_|nm|Length of one increment (linear absolute encoder)|
|0|DigitalResolution| | |
|0|ENC_CH3_MTBase| |Definition of point of discontinuity in multi-turn range|
|0|ENC_CH3_MTEnable| |Enable MultiTurn use (negative logic, 1=MToff)|
|0|ENC_CH3_Corr| |Signal correction type|
|0..4|ENC_CH3_CorrVal| |Signal correction values|
|0|ENC_CH3_EncObsAct| |Amplitude of analog signals (vector length)|
|0|ENC_CH3_HallLayout| |Hall pattern selection|
|0|ENC_CH3_Position|inc|Position encoder channel 3|
|0|ENC_CH3_Period|ms|Maximum period of interpolation (ttl encoder)|
|0|ENC_CH3_EncOnsActTF|ms|Filter time constant for amplitude of analog signals|
|0|ENC_CH3_|Sign.|Nominal increment A (distance coded abs. encoder)|
|0|ENC_CH3_|Sign.|Nominal increment B (distance coded abs. encoder)|
|0|ENC_CH3_CycleCount| |Position encoder sampling cycle (n x 125 μsec)|
|0|ENC_CH3_AbsInitMode| |Mode absolute value formation|
|0..29|ENC_ENDAT| |EnDat additional|
|0|ENC_Warning| |Encoder warning (e.g. from encoder internal memory)|
|0|ENC_Warning| |Encoder warning reset (e.g. in encoder internal memory)|
|0|ENC_Error| |Encoder error (e.g. from encoder internal memory)|
|0|ENC_ErrorReset| |Encoder error reset (e.g. in encoder internal memory)|
|0|ENC_ETS| |ETS mode, electronic nameplate|
|0|ENC_ETS_CTRL| |ETS control, electronic nameplate|
|0..15|ENC_ETS_STAT| |ETS status, electronic nameplate|
|0..511|ENC_ETS_DATA| |ETS data, electronic nameplate|
|0|ENC_CH3_TTL_| |TTL signal type selection|

# 6 Encoder

MOOG ID No.:CB40859-001 Date:11/2020

# 6.7.2 Absolute value interfaces X8

The following absolute value interfaces will be available at encoder channel Ch3 depending on the X8 option being used.

- Cyclical Sin/Cos with SSI one-time reading via X8 option: SINCOS_V2(10) - 2nd Sin/Cos encoder (V2)
- Cyclical Sin/Cos with EnDat one-time reading via X8 option: SINCOS_V2(10) - 2nd Sin/Cos encoder (V2)
- Cyclical SSI via X8 options: SINCOS_V2(10) - 2nd Sin/Cos encoder (V2) or SSI_ECSIM(3) - SSI encoder simulation
- Cyclical EnDat via X8 option: SINCOS_V2(10) - 2nd Sin/Cos encoder (V2)

See also table in Section ""Channel 3: Interface X8 (optional)"" on page 76. They can be selected with P 507[0] - ENC_CH3_Sel and P 570[0] - ENC_CH3_Abs. For more details, see Section ""Main parameters for encoder channel Ch3"" on page 80.

# 6.7.3 EnDat (cyclical) X8

Ch3: ENDAT(4) - Cyclical EnDat (2.1 or 2.2)

As the EnDat functionality of the parameters for encoder channel Ch3 is predominantly identical to that of the parameters for encoder channel Ch1, it is recommended to read the description for the Ch1 encoder channel parameters (see Section ""EnDat (cyclical) X7"" on page 61).

The software versions required to run the EnDat interface are the standard software versions for the MSD Servo Drive and MSD Single-Axis Servo Drive Compact.

NOTE

- Please note the limitations that apply when running EnDat and SSI encoders (see Section ""Limiting for EnDat and SSI"" on page 52).

|ID|Index|Name|Unit|Description|
|---|---|---|---|---|
|507|0|ENC_CH3_Sel|= 4|= ENDAT(4)|
|573|0|ENC_CH3_MultiT|Number of MultiTurn bits (absolute encoder)| |
|574|0|ENC_CH3_SingleT|Number of SingleTurn bits (absolute encoder)| |
|584|0|ENC_CH3_MTBase|Definition of point of discontinuity in multi-turn| |
|585|0|ENC_CH3_MTEnable|range|1: Use Multi-turn encoder as a single-turn encoder|
|636|0|ENC_CH3_CycleCount|Position encoder sampling cycle (n x 125 μsec)| |
|600|0|ENC_CH3_Position|inc|Position encoder channel 3|
|583|0|ENC_CH3_|nm|Length of one increment (linear absolute encoder)|
|640|0..29|DigitalResolution| | |

Table 6.22: ENC_ENDAT Channel 3 encoder configuration (X8) - EnDat (cyclical) parameters

# 6.7.4 Hall sensor X8

Encoder channel Ch3 does not support Hall effect sensors!

# 6.7.5 Sin/Cos / TTL X8

# 6.7.5.1 TTL encoder

Ch3: TTL(3) - TTL signals

TTL encoders are ...

1. ... usually pure incremental encoders without an absolute value interface. In this case, P 570[0] - ENC_CH3_Abs must be set to OFF(0).
2. ... in a few exceptional cases, incremental encoders with an SSI absolute value interface. In this case, P 570[0] - ENC_CH3_Abs must be accordingly set to SSI(1) so that it will be possible to read the absolute encoder position for the absolute value initialization routine once during the initialization phase.

# 6.7.5.1.1 Pure TTL incremental encoder

A maximum interpolation period, in ms (milliseconds), can be configured for the TTL interface using P 602[0] - ENC_CH3_Period. Within this context, Period is the maximum time of “no activity” since the last TTL counter event:

- Period = 0: Function disabled (default)
- Period > 0 (=n ms): If no counter event is registered in n ms, the speed will be set to 0.

# Zero pulse

There is no parameter for activating the zero pulse evaluation here, as this evaluation is controlled based exclusively on the homing mode (see Section ""Homing"" on page 249). However, setting P 571[0] - ENC_CH3_NpTest to 1 provides a test mode that can be used during commissioning in order to be able to activate the zero pulse evaluation even without homing. Scope signals 1034 and 1036 can be used to view a received zero pulse within this context. This test mode must be disabled during normal operation (P 571[0] = 0).

# Commutation

Motor operation with pure incremental encoders needs for the auto commutation function to be enabled without fail. For details see Section ""Synchronous motor auto commutation"" on page 156.

# 6.7.5.1.2 TTL incremental encoder with SSI absolute value interface

see Section ""Sin/Cos incremental encoders with absolute value interface"" on page 84 and in special Section ""SSI absolute value interface"" on page 86.

MOOG ID No.:CB40859-001 Date:11/2020

MSD ServoDrive - DeviceHelp

# 6 Encoder

MOOG ID No.:CB40859-001 Date:11/2020

MSD ServoDrive - DeviceHelp 84

|ID|Index Name|Unit|Description|
|---|---|---|---|
|507|0|ENC_CH3_Sel = 3|Encoder selection set to TTL(3)|
|514|0|ENC_CH3_Num|Encoder gearing: Numerator|
|515|0|ENC_CH3_Denom|Encoder gearing: Denominator|
|570|0|ENC_CH3_Abs|Selection of absolute value interface|
|571|0|ENC_CH3_NpTest|ENC CH1, TEST-MODE: Index pulse signal(s) to Scope|
|572|0|ENC_CH3_Lines|Number of lines (Sin/Cos / TTL encoders)|
|2842|0|ENC_CH3_TTL_SignalType|Channel 3: TTL signal selection|
|602|0|ENC_CH3_Period|Maximum period of interpolation (ttl encoder)|
|636|0|ENC_CH3_CycleCount|Sampling cycle in: n x 125 μ (microseconds)|

# Table 6.23: Parameters for Channel 3 (X8) - TTL encoder

6.7.5.2.2 Linear Sin/Cos incremental encoders

Linear Sin/Cos encoders are operated as rotary encoders. For linear motor operation, P 572[0] - ENC_CH3_Lines and the encoder gearing (see Section ""Encoder gearing"" on page 89) are used to establish the ratio for the linear motor’s pole pair subdivision (North-North) for commutation. 1 x North-North corresponds to one revolution from Lines. In this case, the motor pole pair number must be set to 1. P 582[0] - ENC_CH3_PeriodLen is not used in this case.

# 6.7.5.2 Sin/Cos encoder

Ch3: SINCOS(1) - Sin/Cos signals

Sin/Cos encoders can ...

1. Be pure incremental encoders without an absolute value interface. In this case, P 570[0] - ENC_CH3_Abs must be set to OFF(0).
2. Be incremental encoders with an absolute value interface. In this case, P 570[0] - ENC_CH3_Abs must be accordingly set to SSI(1) or EnDat(2) so that it will be possible to read the absolute encoder position for the absolute value initialization routine once during the initialization phase.

# 6.7.5.2.1 Purely Sin/Cos incremental encoders

To run these encoders as pure incremental encoders with a zero pulse on encoder channel Ch3 (without an absolute value interface), the approach is basically the same as for pure TTL operation (see Section ""TTL encoder"" on page 82). The same parameters apply. However, there are the following differences:

# 6.7.5.2.4 Sin/Cos incremental encoders with absolute value interface

The following table lists the parameters for cyclical Sin/Cos operation on encoder channel Ch 3 with one-time reading of the absolute encoder position via the absolute value interface, i.e. without a zero pulse:

|ID|Index Name|Unit|Description|
|---|---|---|---|
|507|ENC_CH3_Sel|1|Encoder selection set to SINCOS(1)|
|514|ENC_CH3_Num| |Encoder gearing: Numerator|
|515|ENC_CH3_Denom| |Encoder gearing: Denominator|
|570|ENC_CH3_Abs| |Absolute value interface selection (one-time reading)|
|572|ENC_CH3_Lines| |Number of Lines (Sin/Cos / TTL encoders)|
|573|ENC_CH3_MultiT| |Number of MultiTurn bits (absolute encoder)|
|574|ENC_CH3_SingleT| |Number of SingleTurn bits (absolute encoder)|
|575|ENC_CH3_Code| |Code selection (SSI encoder) (binary, gray)|
|576|ENC_CH3_Mode| |Mode selection (SSI encoder)|
|584|ENC_CH3_MTBase| |Definition of point of discontinuity in multi-turn range|
|585|ENC_CH3_MTEnable| |Enable MultiTurn use (negative logic, 1=MToff)|
|586|ENC_CH3_Corr| |Signal correction type|
|587|ENC_CH3_CorrVal| |Signal correction values|
|577|ENC_CH3_EncObsMin| |Encoder monitoring minimum, sqrt(a^2+b^2)|
|581|ENC_CH3_AbsEncStatus| |Error and status codes (absolute encoder)|
|582|ENC_CH3_PeriodLen|nm|Length of signal period (Sin/Cos linear encoder)|
|583|ENC_CH3_DigitalResolution|nm|Length of one increment (linear absolute encoder)|
|636|ENC_CH3_CycleCount| |Sampling cycle in: n x 125 μ (microseconds)|
|639|ENC_CH3_NominalincrementA| |Sign. Nominal increment A (distance coded abs. encoder)|
|637|ENC_CH3_NominalincrementB| |Sign. Nominal increment B (distance coded abs. encoder)|

# Table 6.24: Parameters for channel 3 (X8) - Sin/Cos encoder

Some parameters (e.g. Sel, Num, Denom, Abs, Lines, MultiT, SingleT, CorrVal) are self-explanatory.

The Code and Mode parameters are described in Section ""SSI (cyclical) X7"" on page 69.

P 584[0] - ENC_CH3_MTBase = Minimum MultiTurn position

The MTBase parameter is used to set a position in the multi-turn encoder’s travel path that defines the point of discontinuity (overflow/underflow) for the absolute value initialization (that is, the “multi-turn basis”). Assuming a bipolar encoder measuring range, all position values that fall below MTBase will be shifted “up” (the whole MT range will be added to them once). This method makes it possible to place the point of discontinuity at any point within the encoder’s entire measuring range. By default, MTBase will be set to the lowest possible value for the parameter, i.e. reliably outside of the encoder’s value range: In this case, the full bipolar range will remain unaffected, as values will never fall below this MTBase threshold (see Section ""Channel 3: Interface X8 (optional)"" on page 76 as well).

P 585[0] - ENC_CH3_MTEnable = MultiTurn as SingleTurn

The MTEnable parameter makes it possible to use multi-turn encoders as single-turn encoders for test purposes. Negative logic: Default MTEnable = 0 means ""MultiTurn-Enable ON"".

P 586[0] - ENC_CH3_Corr = Signal correction type:

The GPOC routine used for track signal correction purposes for sine/cosine signals is used to compensate for systematic errors. The routine is controlled with the Corr and CorrVal parameters (see Section ""Signal correction GPOC (Gain Phase Offset Correction)"" on page 74).

P 577[0] - ENC_CH3_EncObsMin = Encoder monitoring minimum, sqrt(a^2+b^2)

The parameter EncObsMin is used to scale the Sin/Cos wire break monitoring and represents the “downwards threshold” for an error message. The default setting is 0.2, corresponding to approx. ",What are the technology options available for encoder evaluation on the X8 interface as per the 'MSD ServoDrive - DeviceHelp' document?,"The technology options include 'No module', 'Second Sin/Cos encoder', 'TTL encoder simulation / TTL master encoder', 'SSI encoder simulation', and 'TTL encoder with commutation signals'.","Options for encoder evaluation on X8 are: 0-No module, 1-Second Sin/Cos encoder, 3-TTL encoder simulation / TTL master encoder, 4-SSI encoder simulation, and 5-TTL encoder with commutation signals.","In the 'MSD ServoDrive - DeviceHelp' document, the X8 interface supports encoder evaluation with options like a second Sin/Cos encoder, TTL and SSI encoder simulations, and TTL encoder with commutation signals.","Available technology options for X8 encoder evaluation are listed as No.0 to No.5, covering no module, second Sin/Cos encoder, TTL and SSI simulations, and TTL with commutation.","The document specifies five technology options for X8 encoder evaluation, ranging from no module to specific encoder types like TTL and SSI, including their simulation versions."
1,msd_servo_drive.txt,29,8b7b14207d0506f3f75c9a63fb98a68193e71ed0f7337bac8f26cb3596e2b576,"3: “TTL encoder simulation / TTL master encoder”
- No. 4: “SSI encoder simulation”
- No. 5: “TTL encoder with commutation signals”

NOTE

- For information on the connector, pinout, technical data, configuration, and the encoder models (if any) that can be evaluated with the included technology option, please consult the Specification specified in the “Documentation” column.

The following table shows how the X8 options that can be used for encoder evaluation can be identified and selected.

|“No.” column|As per the table above.|
|---|---|
|“Hardware ID” column|The texts in this column can be viewed in the Moog DRIVEADMINISTRATOR 5 using P 53[0] - DV_HwOptionX12ID by going to ►Drive description ►Hardware version if the corresponding technology option is present.|
|“Selection” column|In certain cases, several different encoder types can be run on a technology option and selected with P 507 - ENC_CH3_Sel. Even if a technology option that does not match is equipped, most values can only be selected with P 507 - ENC_CH3_Sel. If an impermissible combination is selected, this will be indicated by means of error messages during the initialization phase.|

MOOG ID No.:CB40859-001 Date:11/2020

MSD ServoDrive - DeviceHelp 77

# 6 Encoder

MOOG ID No.:CB40859-001 Date:11/2020

# MSD ServoDrive - DeviceHelp

|No.|Technology option name|Hardware ID|Selection|
|---|---|---|---|
|0|No module|NONE(0) - No technology option|OFF (0)|
| | |SINCOS(1) - Sin/Cos cyclic *)| |
| | |- Without absolute value interface, Abs=OFF(0), with zero pulse| |
| | |- With SSI one-time reading, Abs=SSI(1)| |
|1|Second Sin/Cos encoder|SINCOS_V2(10) - 2nd Sin/Cos encoder (V2)|- With EnDat one-time reading, Abs=ENDAT(2)|
| | |SSI(2) - Cyclical SSI (without analog tracks)| |
| | |TTL(3) - TTL evaluation, with zero pulse| |
| | |ENDAT(4) - Cyclical EnDat (without analog tracks)| |
|3|TTL encoder simulation / TTL master encoder|TTL_ECSIM_V2(9) - TTL Encodersimulation (V2)|TTL(3)|
|4|SSI encoder simulation|SSI_ECSIM(3) - SSI encodersimulation|SSI(2) - Cyclical SSI (without analog tracks)|
|5|TTL encoder with commutation signals|TTL_COM(11) - TTL + Hall option|TTL(3)|
| | |TTL_COM(5)| |

Table 6.19: Options for X8 interface that can be used to evaluate encoders via encoder channel Ch3

*) SINCOS(1) is set via the P 507[0] - ENC_CH3_Sel main interface. The auxiliary interface, P 570[0] - ENC_CH3_Abs, can be optionally used to set the one-time reading for the absolute position during initialization.

# NOTE

- Only one encoder with a purely digital EnDat or SSI interface can be used on connector X8 or X7.
- If two EnDat encoders are used and one of them is purely digital, it is necessary to ensure that the purely digital encoder is connected to X8. This is important, as the EnDat encoder with Sin/Cos tracks must be initialized before the purely digital encoder.

# Encoder Configuration

To see which technology option your Servo Drive features (if any), go to Project Select from database tree ► Device setup ► Drive description in Moog DRIVEADMINISTRATOR 5 and check under “Technology option” in the “Hardware” section.

# Encoder Name

You can use this field to enter your own information for describing the encoder (maximum of 31 characters) (P 580[0] - ENC_CH3_Info).

# Cyclic Position Via

This drop-down menu is used to select the “main interface” (P 507[0] - ENC_CH3_Sel).

# Pulses Per Revolution

Once SINCOS(1), TTL(3) or TTL_COM(5) is selected as the “main interface,” this field will appear so that you can enter the number of analog Sin/Cos tracks per revolution (TTL tracks as well).

# Absolute Interface

This drop-down menu is used to select the “auxiliary interface” (P 570[0] - ENC_CH3_Abs).

# Image 6.5: Encoder Configuration Channel 3 (X8) Screen

This screen is used to select the encoder for channel Ch3. This channel uses the encoder’s “main interface” to measure position changes periodically and add them up cyclically – this is referred to as “cyclical evaluation.”

Encoders with a main interface that only makes it possible to measure the cyclical position incrementally often feature an additional absolute value interface referred to as an “auxiliary interface.” For this interface, the absolute position is measured once during the initialization phase and is then used for absolute value initialization purposes.

# Note

l Selecting an “auxiliary interface” is redundant if, for example, SSI (2) is selected as the “main interface” (corresponds to cyclical evaluation via SSI). In this case, the absolute value initialization will also be carried out via the SSI interface, regardless of the selected “auxiliary interface.”

# Gear Ratio

These fields can be used to define a gear ratio for the encoder (in the output side). For more details, see Section ""Encoder gearing"" on page 89.

MOOG ID No.:CB40859-001 Date:11/2020

MSD ServoDrive - DeviceHelp 79

# 6 Encoder

MOOG ID No.:CB40859-001 Date:11/2020

# MSD ServoDrive - DeviceHelp

Signal correction (GPOC) l P 577[0] - ENC_CH3_EncObsMin

If you set EncObsMin to 0, Sin/Cos wire break monitoring will be disabled.

GPOC is a special Moog online process for improving the quality of Sin/Cos signals before they are used to calculate a position. If “SINCOS(1)” is selected as the “main interface,” this process may be useful. For details see Section ""Signal correction GPOC (Gain Phase Offset Correction)"" on page 74.

The default value is 0.2 (20%) and stands for a calculated amplitude value (calculated using the two Sin/Cos signals) of x = sqrt(a² + b²). If the Sin/Cos signals are equal to approx. 1 Vss when compared, approx. 0.8 will be calculated here (approx. 80% magnitude at the A-D converters; approx. 0.25 Vss Sin/Cos will yield approx. 0.2 here (20% magnitude at the A-D converter)). The error threshold can be adjusted with EncObsMin.

# 6.7.1 Main parameters for encoder channel Ch3

The following table lists the most important parameters for the Ch3 encoder channel. These parameters are described in the chapters that go over selecting the various encoders with P 507[0] - ENC_CH3_Sel and P 570[0] - ENC_CH3_Abs.

When used with its default setting, this parameter will ensure that the absolute value initialization “starts up with plus-minus”. I.e. the encoder’s multi-turn value range from 0 to max will be mapped to -½ max to +½ max. The range from +½ max to max will be initialized as negative; in this case, the point of discontinuity will be found at ½ max. This can be changed with MTBase. When MTBase = 0, the absolute value initialization will, for example, “start up with zero to max”. I.e. the encoder’s multi-turn value range from 0 to max will be mapped to 0 to max. The range from +½ max to max will be initialized as positive; in this case, the point of discontinuity will be found at 0.

l P 585[0] - ENC_CH3_MTEnable

If you set MTEnable to 1, you can use an available multi-turn rotary encoder as a single-turn rotary encoder, which can come in handy for testing purposes.

|P No.|Index|Name / Setting|Unit|Description|
|---|---|---|---|---|
|507|0|ENC_CH3_Sel| |Main selection on encoder channel Ch3|
|570|0|ENC_CH3_Abs| |Absolute value interface for one-time reading|
|572|0|ENC_CH3_Lines| |Number of analog Sin/Cos lines per revolution (TTL lines as well)|
|573|0|ENC_CH3_MultiT| |Number of multi-turn bits for the digital interface|
|574|0|ENC_CH3_SingleT| |Number of single-turn bits for the digital interface|
|575|0|ENC_CH3_Code| |Code selection (for SSI encoders) (binary, Gray)|
|576|0|ENC_CH3_Mode| |Mode selection (for SSI encoders)|
|583|0|ENC_CH3_|nm|Linear encoders: Length of a digital increment in|
|584|0|DigitalResolution|nm (nanometres)| |
|585|0|ENC_CH3_MTBase| |Definition of point of discontinuity in multi-turn range|
|636|0|ENC_CH3_MTEnable| |Enable MultiTurn use (negative logic, 1=MToff)|
|636|0|ENC_CH3_CycleCount| |Sampling cycle in: n x 125 μ (microseconds)|

NOTE: As there are various protocol modes available for SSI encoders (with/without wire break monitoring, with/without parity bit, etc.), consult with your project supervisor or the Helpline provided by Moog before using any special SSI protocol modes.

As the functionality of the parameters for encoder channel Ch3 is predominantly identical to that of the parameters for encoder channel Ch1, it is recommended to read the description for the Ch1 encoder channel parameters.

Accordingly, the following table starts by listing all the parameters for the Ch3 encoder channel. If the functionality of a parameter is different from that of the corresponding parameter for encoder channel Ch1, the parameter will be described in the chapters that go over selecting a special encoder with (507) ENC_CH3_Sel and (570) ENC_CH3_Abs.

Parameters Lines, MultiT, SingleT, etc. are self-explanatory. Most of the following parameters are explained in the information for encoder channel Ch1 (see Section ""Channel 1: Interface X7"" on page 59).

# Table 6.21: Encoder configuration channel 3 (X8) parameters

|ID|Index|Name|Unit|Description|
|---|---|---|---|---|
|349|0|CON_FM_MConOffset| |Commutation offset|
|502|0..3|ENC_CH3_ActVal| |Current position value at encoder channel Ch3 output|
|507|0|ENC_CH3_Sel| |Main selection on encoder channel Ch3|
|514|0|ENC_CH3_Num| |Encoder gearing: Numerator|
|515|0|ENC_CH3_Denom| |Encoder gearing: Denominator|
|520|0|ENC_MCon| |=3, channel selection for motor commutation|
|521|0|ENC_SCon| |=3, channel selection for speed control|
|522|0|ENC_PCon| |=3, channel selection for position control|
|570|0|ENC_CH3_Abs| |Absolute value interface selection (one-time reading)|
|571|0|ENC_CH3_NpTest| |TEST-MODE: Index pulse signal(s) to Scope|
|572|0|ENC_CH3_Lines| |Number of Lines (Sin/Cos / TTL encoders)|
|573|0|ENC_CH3_MultiT| |Number of MultiTurn bits (absolute encoder)|
|574|0|ENC_CH3_SingleT| |Number of SingleTurn bits (absolute encoder)|
|574|0|ENC_CH3_Code| |Code selection (SSI encoder) (binary, gray)|
|576|0|ENC_CH3_Mode| |Mode selection (SSI encoder)|
|577|0|ENC_CH3_EncObsMin| |Encoder monitoring minimum, sqrt (a^2+b^2)|
|578|0|ENC_CH3_Extended| |(a^2 + b^2) ENC CH3: Extended|
|580|0|ENC_CH3_Info| |Encoder information channel 3|
|581|0|ENC_CH3_AbsEncStatus| |Error and status codes (absolute encoder)|
|582|0|ENC_CH3_PeriodLen|nm|Length of signal period (Sin/Cos linear encoder)|

# Encoder configuration channel 3 (X8) parameters (continue)

|Index|Name|Unit|Description|
|---|---|---|---|
|0|ENC_CH3_|nm|Length of one increment (linear absolute encoder)|
|0|DigitalResolution| | |
|0|ENC_CH3_MTBase| |Definition of point of discontinuity in multi-turn range|
|0|ENC_CH3_MTEnable| |Enable MultiTurn use (negative logic, 1=MToff)|
|0|ENC_CH3_Corr| |Signal correction type|
|0..4|ENC_CH3_CorrVal| |Signal correction values|
|0|ENC_CH3_EncObsAct| |Amplitude of analog signals (vector length)|
|0|ENC_CH3_HallLayout| |Hall pattern selection|
|0|ENC_CH3_Position|inc|Position encoder channel 3|
|0|ENC_CH3_Period|ms|Maximum period of interpolation (ttl encoder)|
|0|ENC_CH3_EncOnsActTF|ms|Filter time constant for amplitude of analog signals|
|0|ENC_CH3_|Sign.|Nominal increment A (distance coded abs. encoder)|
|0|ENC_CH3_|Sign.|Nominal increment B (distance coded abs. encoder)|
|0|ENC_CH3_CycleCount| |Position encoder sampling cycle (n x 125 μsec)|
|0|ENC_CH3_AbsInitMode| |Mode absolute value formation|
|0..29|ENC_ENDAT| |EnDat additional|
|0|ENC_Warning| |Encoder warning (e.g. from encoder internal memory)|
|0|ENC_Warning| |Encoder warning reset (e.g. in encoder internal memory)|
|0|ENC_Error| |Encoder error (e.g. from encoder internal memory)|
|0|ENC_ErrorReset| |Encoder error reset (e.g. in encoder internal memory)|
|0|ENC_ETS| |ETS mode, electronic nameplate|
|0|ENC_ETS_CTRL| |ETS control, electronic nameplate|
|0..15|ENC_ETS_STAT| |ETS status, electronic nameplate|
|0..511|ENC_ETS_DATA| |ETS data, electronic nameplate|
|0|ENC_CH3_TTL_| |TTL signal type selection|

# 6 Encoder

MOOG ID No.:CB40859-001 Date:11/2020

# 6.7.2 Absolute value interfaces X8

The following absolute value interfaces will be available at encoder channel Ch3 depending on the X8 option being used.

- Cyclical Sin/Cos with SSI one-time reading via X8 option: SINCOS_V2(10) - 2nd Sin/Cos encoder (V2)
- Cyclical Sin/Cos with EnDat one-time reading via X8 option: SINCOS_V2(10) - 2nd Sin/Cos encoder (V2)
- Cyclical SSI via X8 options: SINCOS_V2(10) - 2nd Sin/Cos encoder (V2) or SSI_ECSIM(3) - SSI encoder simulation
- Cyclical EnDat via X8 option: SINCOS_V2(10) - 2nd Sin/Cos encoder (V2)

See also table in Section ""Channel 3: Interface X8 (optional)"" on page 76. They can be selected with P 507[0] - ENC_CH3_Sel and P 570[0] - ENC_CH3_Abs. For more details, see Section ""Main parameters for encoder channel Ch3"" on page 80.

# 6.7.3 EnDat (cyclical) X8

Ch3: ENDAT(4) - Cyclical EnDat (2.1 or 2.2)

As the EnDat functionality of the parameters for encoder channel Ch3 is predominantly identical to that of the parameters for encoder channel Ch1, it is recommended to read the description for the Ch1 encoder channel parameters (see Section ""EnDat (cyclical) X7"" on page 61).

The software versions required to run the EnDat interface are the standard software versions for the MSD Servo Drive and MSD Single-Axis Servo Drive Compact.

NOTE

- Please note the limitations that apply when running EnDat and SSI encoders (see Section ""Limiting for EnDat and SSI"" on page 52).

|ID|Index|Name|Unit|Description|
|---|---|---|---|---|
|507|0|ENC_CH3_Sel|= 4|= ENDAT(4)|
|573|0|ENC_CH3_MultiT|Number of MultiTurn bits (absolute encoder)| |
|574|0|ENC_CH3_SingleT|Number of SingleTurn bits (absolute encoder)| |
|584|0|ENC_CH3_MTBase|Definition of point of discontinuity in multi-turn| |
|585|0|ENC_CH3_MTEnable|range|1: Use Multi-turn encoder as a single-turn encoder|
|636|0|ENC_CH3_CycleCount|Position encoder sampling cycle (n x 125 μsec)| |
|600|0|ENC_CH3_Position|inc|Position encoder channel 3|
|583|0|ENC_CH3_|nm|Length of one increment (linear absolute encoder)|
|640|0..29|DigitalResolution| | |

Table 6.22: ENC_ENDAT Channel 3 encoder configuration (X8) - EnDat (cyclical) parameters

# 6.7.4 Hall sensor X8

Encoder channel Ch3 does not support Hall effect sensors!

# 6.7.5 Sin/Cos / TTL X8

# 6.7.5.1 TTL encoder

Ch3: TTL(3) - TTL signals

TTL encoders are ...

1. ... usually pure incremental encoders without an absolute value interface. In this case, P 570[0] - ENC_CH3_Abs must be set to OFF(0).
2. ... in a few exceptional cases, incremental encoders with an SSI absolute value interface. In this case, P 570[0] - ENC_CH3_Abs must be accordingly set to SSI(1) so that it will be possible to read the absolute encoder position for the absolute value initialization routine once during the initialization phase.

# 6.7.5.1.1 Pure TTL incremental encoder

A maximum interpolation period, in ms (milliseconds), can be configured for the TTL interface using P 602[0] - ENC_CH3_Period. Within this context, Period is the maximum time of “no activity” since the last TTL counter event:

- Period = 0: Function disabled (default)
- Period > 0 (=n ms): If no counter event is registered in n ms, the speed will be set to 0.

# Zero pulse

There is no parameter for activating the zero pulse evaluation here, as this evaluation is controlled based exclusively on the homing mode (see Section ""Homing"" on page 249). However, setting P 571[0] - ENC_CH3_NpTest to 1 provides a test mode that can be used during commissioning in order to be able to activate the zero pulse evaluation even without homing. Scope signals 1034 and 1036 can be used to view a received zero pulse within this context. This test mode must be disabled during normal operation (P 571[0] = 0).

# Commutation

Motor operation with pure incremental encoders needs for the auto commutation function to be enabled without fail. For details see Section ""Synchronous motor auto commutation"" on page 156.

# 6.7.5.1.2 TTL incremental encoder with SSI absolute value interface

see Section ""Sin/Cos incremental encoders with absolute value interface"" on page 84 and in special Section ""SSI absolute value interface"" on page 86.

MOOG ID No.:CB40859-001 Date:11/2020

MSD ServoDrive - DeviceHelp

# 6 Encoder

MOOG ID No.:CB40859-001 Date:11/2020

MSD ServoDrive - DeviceHelp 84

|ID|Index Name|Unit|Description|
|---|---|---|---|
|507|0|ENC_CH3_Sel = 3|Encoder selection set to TTL(3)|
|514|0|ENC_CH3_Num|Encoder gearing: Numerator|
|515|0|ENC_CH3_Denom|Encoder gearing: Denominator|
|570|0|ENC_CH3_Abs|Selection of absolute value interface|
|571|0|ENC_CH3_NpTest|ENC CH1, TEST-MODE: Index pulse signal(s) to Scope|
|572|0|ENC_CH3_Lines|Number of lines (Sin/Cos / TTL encoders)|
|2842|0|ENC_CH3_TTL_SignalType|Channel 3: TTL signal selection|
|602|0|ENC_CH3_Period|Maximum period of interpolation (ttl encoder)|
|636|0|ENC_CH3_CycleCount|Sampling cycle in: n x 125 μ (microseconds)|

# Table 6.23: Parameters for Channel 3 (X8) - TTL encoder

6.7.5.2.2 Linear Sin/Cos incremental encoders

Linear Sin/Cos encoders are operated as rotary encoders. For linear motor operation, P 572[0] - ENC_CH3_Lines and the encoder gearing (see Section ""Encoder gearing"" on page 89) are used to establish the ratio for the linear motor’s pole pair subdivision (North-North) for commutation. 1 x North-North corresponds to one revolution from Lines. In this case, the motor pole pair number must be set to 1. P 582[0] - ENC_CH3_PeriodLen is not used in this case.

# 6.7.5.2 Sin/Cos encoder

Ch3: SINCOS(1) - Sin/Cos signals

Sin/Cos encoders can ...

1. Be pure incremental encoders without an absolute value interface. In this case, P 570[0] - ENC_CH3_Abs must be set to OFF(0).
2. Be incremental encoders with an absolute value interface. In this case, P 570[0] - ENC_CH3_Abs must be accordingly set to SSI(1) or EnDat(2) so that it will be possible to read the absolute encoder position for the absolute value initialization routine once during the initialization phase.

# 6.7.5.2.1 Purely Sin/Cos incremental encoders

To run these encoders as pure incremental encoders with a zero pulse on encoder channel Ch3 (without an absolute value interface), the approach is basically the same as for pure TTL operation (see Section ""TTL encoder"" on page 82). The same parameters apply. However, there are the following differences:

# 6.7.5.2.4 Sin/Cos incremental encoders with absolute value interface

The following table lists the parameters for cyclical Sin/Cos operation on encoder channel Ch 3 with one-time reading of the absolute encoder position via the absolute value interface, i.e. without a zero pulse:

|ID|Index Name|Unit|Description|
|---|---|---|---|
|507|ENC_CH3_Sel|1|Encoder selection set to SINCOS(1)|
|514|ENC_CH3_Num| |Encoder gearing: Numerator|
|515|ENC_CH3_Denom| |Encoder gearing: Denominator|
|570|ENC_CH3_Abs| |Absolute value interface selection (one-time reading)|
|572|ENC_CH3_Lines| |Number of Lines (Sin/Cos / TTL encoders)|
|573|ENC_CH3_MultiT| |Number of MultiTurn bits (absolute encoder)|
|574|ENC_CH3_SingleT| |Number of SingleTurn bits (absolute encoder)|
|575|ENC_CH3_Code| |Code selection (SSI encoder) (binary, gray)|
|576|ENC_CH3_Mode| |Mode selection (SSI encoder)|
|584|ENC_CH3_MTBase| |Definition of point of discontinuity in multi-turn range|
|585|ENC_CH3_MTEnable| |Enable MultiTurn use (negative logic, 1=MToff)|
|586|ENC_CH3_Corr| |Signal correction type|
|587|ENC_CH3_CorrVal| |Signal correction values|
|577|ENC_CH3_EncObsMin| |Encoder monitoring minimum, sqrt(a^2+b^2)|
|581|ENC_CH3_AbsEncStatus| |Error and status codes (absolute encoder)|
|582|ENC_CH3_PeriodLen|nm|Length of signal period (Sin/Cos linear encoder)|
|583|ENC_CH3_DigitalResolution|nm|Length of one increment (linear absolute encoder)|
|636|ENC_CH3_CycleCount| |Sampling cycle in: n x 125 μ (microseconds)|
|639|ENC_CH3_NominalincrementA| |Sign. Nominal increment A (distance coded abs. encoder)|
|637|ENC_CH3_NominalincrementB| |Sign. Nominal increment B (distance coded abs. encoder)|

# Table 6.24: Parameters for channel 3 (X8) - Sin/Cos encoder

Some parameters (e.g. Sel, Num, Denom, Abs, Lines, MultiT, SingleT, CorrVal) are self-explanatory.

The Code and Mode parameters are described in Section ""SSI (cyclical) X7"" on page 69.

P 584[0] - ENC_CH3_MTBase = Minimum MultiTurn position

The MTBase parameter is used to set a position in the multi-turn encoder’s travel path that defines the point of discontinuity (overflow/underflow) for the absolute value initialization (that is, the “multi-turn basis”). Assuming a bipolar encoder measuring range, all position values that fall below MTBase will be shifted “up” (the whole MT range will be added to them once). This method makes it possible to place the point of discontinuity at any point within the encoder’s entire measuring range. By default, MTBase will be set to the lowest possible value for the parameter, i.e. reliably outside of the encoder’s value range: In this case, the full bipolar range will remain unaffected, as values will never fall below this MTBase threshold (see Section ""Channel 3: Interface X8 (optional)"" on page 76 as well).

P 585[0] - ENC_CH3_MTEnable = MultiTurn as SingleTurn

The MTEnable parameter makes it possible to use multi-turn encoders as single-turn encoders for test purposes. Negative logic: Default MTEnable = 0 means ""MultiTurn-Enable ON"".

P 586[0] - ENC_CH3_Corr = Signal correction type:

The GPOC routine used for track signal correction purposes for sine/cosine signals is used to compensate for systematic errors. The routine is controlled with the Corr and CorrVal parameters (see Section ""Signal correction GPOC (Gain Phase Offset Correction)"" on page 74).

P 577[0] - ENC_CH3_EncObsMin = Encoder monitoring minimum, sqrt(a^2+b^2)

The parameter EncObsMin is used to scale the Sin/Cos wire break monitoring and represents the “downwards threshold” for an error message. The default setting is 0.2, corresponding to approx. ",How can the hardware ID for a technology option be viewed in the Moog DRIVEADMINISTRATOR 5?,By navigating to ►Drive description ►Hardware version in Moog DRIVEADMINISTRATOR 5 and viewing P 53[0] - DV_HwOptionX12ID if the corresponding technology option is present.,"The hardware ID is visible in Moog DRIVEADMINISTRATOR 5 under Drive description > Hardware version, specifically in parameter P 53[0] - DV_HwOptionX12ID.","To view the hardware ID, access the Drive description section in Moog DRIVEADMINISTRATOR 5, then Hardware version, and check P 53[0] - DV_HwOptionX12ID for the equipped technology option.","In Moog DRIVEADMINISTRATOR 5, the hardware ID for a technology option can be found in the Drive description's Hardware version section under parameter DV_HwOptionX12ID.",Check P 53[0] - DV_HwOptionX12ID in the Hardware version section of Drive description within Moog DRIVEADMINISTRATOR 5 to see the hardware ID for any present technology option.
2,msd_servo_drive.txt,29,8b7b14207d0506f3f75c9a63fb98a68193e71ed0f7337bac8f26cb3596e2b576,"3: “TTL encoder simulation / TTL master encoder”
- No. 4: “SSI encoder simulation”
- No. 5: “TTL encoder with commutation signals”

NOTE

- For information on the connector, pinout, technical data, configuration, and the encoder models (if any) that can be evaluated with the included technology option, please consult the Specification specified in the “Documentation” column.

The following table shows how the X8 options that can be used for encoder evaluation can be identified and selected.

|“No.” column|As per the table above.|
|---|---|
|“Hardware ID” column|The texts in this column can be viewed in the Moog DRIVEADMINISTRATOR 5 using P 53[0] - DV_HwOptionX12ID by going to ►Drive description ►Hardware version if the corresponding technology option is present.|
|“Selection” column|In certain cases, several different encoder types can be run on a technology option and selected with P 507 - ENC_CH3_Sel. Even if a technology option that does not match is equipped, most values can only be selected with P 507 - ENC_CH3_Sel. If an impermissible combination is selected, this will be indicated by means of error messages during the initialization phase.|

MOOG ID No.:CB40859-001 Date:11/2020

MSD ServoDrive - DeviceHelp 77

# 6 Encoder

MOOG ID No.:CB40859-001 Date:11/2020

# MSD ServoDrive - DeviceHelp

|No.|Technology option name|Hardware ID|Selection|
|---|---|---|---|
|0|No module|NONE(0) - No technology option|OFF (0)|
| | |SINCOS(1) - Sin/Cos cyclic *)| |
| | |- Without absolute value interface, Abs=OFF(0), with zero pulse| |
| | |- With SSI one-time reading, Abs=SSI(1)| |
|1|Second Sin/Cos encoder|SINCOS_V2(10) - 2nd Sin/Cos encoder (V2)|- With EnDat one-time reading, Abs=ENDAT(2)|
| | |SSI(2) - Cyclical SSI (without analog tracks)| |
| | |TTL(3) - TTL evaluation, with zero pulse| |
| | |ENDAT(4) - Cyclical EnDat (without analog tracks)| |
|3|TTL encoder simulation / TTL master encoder|TTL_ECSIM_V2(9) - TTL Encodersimulation (V2)|TTL(3)|
|4|SSI encoder simulation|SSI_ECSIM(3) - SSI encodersimulation|SSI(2) - Cyclical SSI (without analog tracks)|
|5|TTL encoder with commutation signals|TTL_COM(11) - TTL + Hall option|TTL(3)|
| | |TTL_COM(5)| |

Table 6.19: Options for X8 interface that can be used to evaluate encoders via encoder channel Ch3

*) SINCOS(1) is set via the P 507[0] - ENC_CH3_Sel main interface. The auxiliary interface, P 570[0] - ENC_CH3_Abs, can be optionally used to set the one-time reading for the absolute position during initialization.

# NOTE

- Only one encoder with a purely digital EnDat or SSI interface can be used on connector X8 or X7.
- If two EnDat encoders are used and one of them is purely digital, it is necessary to ensure that the purely digital encoder is connected to X8. This is important, as the EnDat encoder with Sin/Cos tracks must be initialized before the purely digital encoder.

# Encoder Configuration

To see which technology option your Servo Drive features (if any), go to Project Select from database tree ► Device setup ► Drive description in Moog DRIVEADMINISTRATOR 5 and check under “Technology option” in the “Hardware” section.

# Encoder Name

You can use this field to enter your own information for describing the encoder (maximum of 31 characters) (P 580[0] - ENC_CH3_Info).

# Cyclic Position Via

This drop-down menu is used to select the “main interface” (P 507[0] - ENC_CH3_Sel).

# Pulses Per Revolution

Once SINCOS(1), TTL(3) or TTL_COM(5) is selected as the “main interface,” this field will appear so that you can enter the number of analog Sin/Cos tracks per revolution (TTL tracks as well).

# Absolute Interface

This drop-down menu is used to select the “auxiliary interface” (P 570[0] - ENC_CH3_Abs).

# Image 6.5: Encoder Configuration Channel 3 (X8) Screen

This screen is used to select the encoder for channel Ch3. This channel uses the encoder’s “main interface” to measure position changes periodically and add them up cyclically – this is referred to as “cyclical evaluation.”

Encoders with a main interface that only makes it possible to measure the cyclical position incrementally often feature an additional absolute value interface referred to as an “auxiliary interface.” For this interface, the absolute position is measured once during the initialization phase and is then used for absolute value initialization purposes.

# Note

l Selecting an “auxiliary interface” is redundant if, for example, SSI (2) is selected as the “main interface” (corresponds to cyclical evaluation via SSI). In this case, the absolute value initialization will also be carried out via the SSI interface, regardless of the selected “auxiliary interface.”

# Gear Ratio

These fields can be used to define a gear ratio for the encoder (in the output side). For more details, see Section ""Encoder gearing"" on page 89.

MOOG ID No.:CB40859-001 Date:11/2020

MSD ServoDrive - DeviceHelp 79

# 6 Encoder

MOOG ID No.:CB40859-001 Date:11/2020

# MSD ServoDrive - DeviceHelp

Signal correction (GPOC) l P 577[0] - ENC_CH3_EncObsMin

If you set EncObsMin to 0, Sin/Cos wire break monitoring will be disabled.

GPOC is a special Moog online process for improving the quality of Sin/Cos signals before they are used to calculate a position. If “SINCOS(1)” is selected as the “main interface,” this process may be useful. For details see Section ""Signal correction GPOC (Gain Phase Offset Correction)"" on page 74.

The default value is 0.2 (20%) and stands for a calculated amplitude value (calculated using the two Sin/Cos signals) of x = sqrt(a² + b²). If the Sin/Cos signals are equal to approx. 1 Vss when compared, approx. 0.8 will be calculated here (approx. 80% magnitude at the A-D converters; approx. 0.25 Vss Sin/Cos will yield approx. 0.2 here (20% magnitude at the A-D converter)). The error threshold can be adjusted with EncObsMin.

# 6.7.1 Main parameters for encoder channel Ch3

The following table lists the most important parameters for the Ch3 encoder channel. These parameters are described in the chapters that go over selecting the various encoders with P 507[0] - ENC_CH3_Sel and P 570[0] - ENC_CH3_Abs.

When used with its default setting, this parameter will ensure that the absolute value initialization “starts up with plus-minus”. I.e. the encoder’s multi-turn value range from 0 to max will be mapped to -½ max to +½ max. The range from +½ max to max will be initialized as negative; in this case, the point of discontinuity will be found at ½ max. This can be changed with MTBase. When MTBase = 0, the absolute value initialization will, for example, “start up with zero to max”. I.e. the encoder’s multi-turn value range from 0 to max will be mapped to 0 to max. The range from +½ max to max will be initialized as positive; in this case, the point of discontinuity will be found at 0.

l P 585[0] - ENC_CH3_MTEnable

If you set MTEnable to 1, you can use an available multi-turn rotary encoder as a single-turn rotary encoder, which can come in handy for testing purposes.

|P No.|Index|Name / Setting|Unit|Description|
|---|---|---|---|---|
|507|0|ENC_CH3_Sel| |Main selection on encoder channel Ch3|
|570|0|ENC_CH3_Abs| |Absolute value interface for one-time reading|
|572|0|ENC_CH3_Lines| |Number of analog Sin/Cos lines per revolution (TTL lines as well)|
|573|0|ENC_CH3_MultiT| |Number of multi-turn bits for the digital interface|
|574|0|ENC_CH3_SingleT| |Number of single-turn bits for the digital interface|
|575|0|ENC_CH3_Code| |Code selection (for SSI encoders) (binary, Gray)|
|576|0|ENC_CH3_Mode| |Mode selection (for SSI encoders)|
|583|0|ENC_CH3_|nm|Linear encoders: Length of a digital increment in|
|584|0|DigitalResolution|nm (nanometres)| |
|585|0|ENC_CH3_MTBase| |Definition of point of discontinuity in multi-turn range|
|636|0|ENC_CH3_MTEnable| |Enable MultiTurn use (negative logic, 1=MToff)|
|636|0|ENC_CH3_CycleCount| |Sampling cycle in: n x 125 μ (microseconds)|

NOTE: As there are various protocol modes available for SSI encoders (with/without wire break monitoring, with/without parity bit, etc.), consult with your project supervisor or the Helpline provided by Moog before using any special SSI protocol modes.

As the functionality of the parameters for encoder channel Ch3 is predominantly identical to that of the parameters for encoder channel Ch1, it is recommended to read the description for the Ch1 encoder channel parameters.

Accordingly, the following table starts by listing all the parameters for the Ch3 encoder channel. If the functionality of a parameter is different from that of the corresponding parameter for encoder channel Ch1, the parameter will be described in the chapters that go over selecting a special encoder with (507) ENC_CH3_Sel and (570) ENC_CH3_Abs.

Parameters Lines, MultiT, SingleT, etc. are self-explanatory. Most of the following parameters are explained in the information for encoder channel Ch1 (see Section ""Channel 1: Interface X7"" on page 59).

# Table 6.21: Encoder configuration channel 3 (X8) parameters

|ID|Index|Name|Unit|Description|
|---|---|---|---|---|
|349|0|CON_FM_MConOffset| |Commutation offset|
|502|0..3|ENC_CH3_ActVal| |Current position value at encoder channel Ch3 output|
|507|0|ENC_CH3_Sel| |Main selection on encoder channel Ch3|
|514|0|ENC_CH3_Num| |Encoder gearing: Numerator|
|515|0|ENC_CH3_Denom| |Encoder gearing: Denominator|
|520|0|ENC_MCon| |=3, channel selection for motor commutation|
|521|0|ENC_SCon| |=3, channel selection for speed control|
|522|0|ENC_PCon| |=3, channel selection for position control|
|570|0|ENC_CH3_Abs| |Absolute value interface selection (one-time reading)|
|571|0|ENC_CH3_NpTest| |TEST-MODE: Index pulse signal(s) to Scope|
|572|0|ENC_CH3_Lines| |Number of Lines (Sin/Cos / TTL encoders)|
|573|0|ENC_CH3_MultiT| |Number of MultiTurn bits (absolute encoder)|
|574|0|ENC_CH3_SingleT| |Number of SingleTurn bits (absolute encoder)|
|574|0|ENC_CH3_Code| |Code selection (SSI encoder) (binary, gray)|
|576|0|ENC_CH3_Mode| |Mode selection (SSI encoder)|
|577|0|ENC_CH3_EncObsMin| |Encoder monitoring minimum, sqrt (a^2+b^2)|
|578|0|ENC_CH3_Extended| |(a^2 + b^2) ENC CH3: Extended|
|580|0|ENC_CH3_Info| |Encoder information channel 3|
|581|0|ENC_CH3_AbsEncStatus| |Error and status codes (absolute encoder)|
|582|0|ENC_CH3_PeriodLen|nm|Length of signal period (Sin/Cos linear encoder)|

# Encoder configuration channel 3 (X8) parameters (continue)

|Index|Name|Unit|Description|
|---|---|---|---|
|0|ENC_CH3_|nm|Length of one increment (linear absolute encoder)|
|0|DigitalResolution| | |
|0|ENC_CH3_MTBase| |Definition of point of discontinuity in multi-turn range|
|0|ENC_CH3_MTEnable| |Enable MultiTurn use (negative logic, 1=MToff)|
|0|ENC_CH3_Corr| |Signal correction type|
|0..4|ENC_CH3_CorrVal| |Signal correction values|
|0|ENC_CH3_EncObsAct| |Amplitude of analog signals (vector length)|
|0|ENC_CH3_HallLayout| |Hall pattern selection|
|0|ENC_CH3_Position|inc|Position encoder channel 3|
|0|ENC_CH3_Period|ms|Maximum period of interpolation (ttl encoder)|
|0|ENC_CH3_EncOnsActTF|ms|Filter time constant for amplitude of analog signals|
|0|ENC_CH3_|Sign.|Nominal increment A (distance coded abs. encoder)|
|0|ENC_CH3_|Sign.|Nominal increment B (distance coded abs. encoder)|
|0|ENC_CH3_CycleCount| |Position encoder sampling cycle (n x 125 μsec)|
|0|ENC_CH3_AbsInitMode| |Mode absolute value formation|
|0..29|ENC_ENDAT| |EnDat additional|
|0|ENC_Warning| |Encoder warning (e.g. from encoder internal memory)|
|0|ENC_Warning| |Encoder warning reset (e.g. in encoder internal memory)|
|0|ENC_Error| |Encoder error (e.g. from encoder internal memory)|
|0|ENC_ErrorReset| |Encoder error reset (e.g. in encoder internal memory)|
|0|ENC_ETS| |ETS mode, electronic nameplate|
|0|ENC_ETS_CTRL| |ETS control, electronic nameplate|
|0..15|ENC_ETS_STAT| |ETS status, electronic nameplate|
|0..511|ENC_ETS_DATA| |ETS data, electronic nameplate|
|0|ENC_CH3_TTL_| |TTL signal type selection|

# 6 Encoder

MOOG ID No.:CB40859-001 Date:11/2020

# 6.7.2 Absolute value interfaces X8

The following absolute value interfaces will be available at encoder channel Ch3 depending on the X8 option being used.

- Cyclical Sin/Cos with SSI one-time reading via X8 option: SINCOS_V2(10) - 2nd Sin/Cos encoder (V2)
- Cyclical Sin/Cos with EnDat one-time reading via X8 option: SINCOS_V2(10) - 2nd Sin/Cos encoder (V2)
- Cyclical SSI via X8 options: SINCOS_V2(10) - 2nd Sin/Cos encoder (V2) or SSI_ECSIM(3) - SSI encoder simulation
- Cyclical EnDat via X8 option: SINCOS_V2(10) - 2nd Sin/Cos encoder (V2)

See also table in Section ""Channel 3: Interface X8 (optional)"" on page 76. They can be selected with P 507[0] - ENC_CH3_Sel and P 570[0] - ENC_CH3_Abs. For more details, see Section ""Main parameters for encoder channel Ch3"" on page 80.

# 6.7.3 EnDat (cyclical) X8

Ch3: ENDAT(4) - Cyclical EnDat (2.1 or 2.2)

As the EnDat functionality of the parameters for encoder channel Ch3 is predominantly identical to that of the parameters for encoder channel Ch1, it is recommended to read the description for the Ch1 encoder channel parameters (see Section ""EnDat (cyclical) X7"" on page 61).

The software versions required to run the EnDat interface are the standard software versions for the MSD Servo Drive and MSD Single-Axis Servo Drive Compact.

NOTE

- Please note the limitations that apply when running EnDat and SSI encoders (see Section ""Limiting for EnDat and SSI"" on page 52).

|ID|Index|Name|Unit|Description|
|---|---|---|---|---|
|507|0|ENC_CH3_Sel|= 4|= ENDAT(4)|
|573|0|ENC_CH3_MultiT|Number of MultiTurn bits (absolute encoder)| |
|574|0|ENC_CH3_SingleT|Number of SingleTurn bits (absolute encoder)| |
|584|0|ENC_CH3_MTBase|Definition of point of discontinuity in multi-turn| |
|585|0|ENC_CH3_MTEnable|range|1: Use Multi-turn encoder as a single-turn encoder|
|636|0|ENC_CH3_CycleCount|Position encoder sampling cycle (n x 125 μsec)| |
|600|0|ENC_CH3_Position|inc|Position encoder channel 3|
|583|0|ENC_CH3_|nm|Length of one increment (linear absolute encoder)|
|640|0..29|DigitalResolution| | |

Table 6.22: ENC_ENDAT Channel 3 encoder configuration (X8) - EnDat (cyclical) parameters

# 6.7.4 Hall sensor X8

Encoder channel Ch3 does not support Hall effect sensors!

# 6.7.5 Sin/Cos / TTL X8

# 6.7.5.1 TTL encoder

Ch3: TTL(3) - TTL signals

TTL encoders are ...

1. ... usually pure incremental encoders without an absolute value interface. In this case, P 570[0] - ENC_CH3_Abs must be set to OFF(0).
2. ... in a few exceptional cases, incremental encoders with an SSI absolute value interface. In this case, P 570[0] - ENC_CH3_Abs must be accordingly set to SSI(1) so that it will be possible to read the absolute encoder position for the absolute value initialization routine once during the initialization phase.

# 6.7.5.1.1 Pure TTL incremental encoder

A maximum interpolation period, in ms (milliseconds), can be configured for the TTL interface using P 602[0] - ENC_CH3_Period. Within this context, Period is the maximum time of “no activity” since the last TTL counter event:

- Period = 0: Function disabled (default)
- Period > 0 (=n ms): If no counter event is registered in n ms, the speed will be set to 0.

# Zero pulse

There is no parameter for activating the zero pulse evaluation here, as this evaluation is controlled based exclusively on the homing mode (see Section ""Homing"" on page 249). However, setting P 571[0] - ENC_CH3_NpTest to 1 provides a test mode that can be used during commissioning in order to be able to activate the zero pulse evaluation even without homing. Scope signals 1034 and 1036 can be used to view a received zero pulse within this context. This test mode must be disabled during normal operation (P 571[0] = 0).

# Commutation

Motor operation with pure incremental encoders needs for the auto commutation function to be enabled without fail. For details see Section ""Synchronous motor auto commutation"" on page 156.

# 6.7.5.1.2 TTL incremental encoder with SSI absolute value interface

see Section ""Sin/Cos incremental encoders with absolute value interface"" on page 84 and in special Section ""SSI absolute value interface"" on page 86.

MOOG ID No.:CB40859-001 Date:11/2020

MSD ServoDrive - DeviceHelp

# 6 Encoder

MOOG ID No.:CB40859-001 Date:11/2020

MSD ServoDrive - DeviceHelp 84

|ID|Index Name|Unit|Description|
|---|---|---|---|
|507|0|ENC_CH3_Sel = 3|Encoder selection set to TTL(3)|
|514|0|ENC_CH3_Num|Encoder gearing: Numerator|
|515|0|ENC_CH3_Denom|Encoder gearing: Denominator|
|570|0|ENC_CH3_Abs|Selection of absolute value interface|
|571|0|ENC_CH3_NpTest|ENC CH1, TEST-MODE: Index pulse signal(s) to Scope|
|572|0|ENC_CH3_Lines|Number of lines (Sin/Cos / TTL encoders)|
|2842|0|ENC_CH3_TTL_SignalType|Channel 3: TTL signal selection|
|602|0|ENC_CH3_Period|Maximum period of interpolation (ttl encoder)|
|636|0|ENC_CH3_CycleCount|Sampling cycle in: n x 125 μ (microseconds)|

# Table 6.23: Parameters for Channel 3 (X8) - TTL encoder

6.7.5.2.2 Linear Sin/Cos incremental encoders

Linear Sin/Cos encoders are operated as rotary encoders. For linear motor operation, P 572[0] - ENC_CH3_Lines and the encoder gearing (see Section ""Encoder gearing"" on page 89) are used to establish the ratio for the linear motor’s pole pair subdivision (North-North) for commutation. 1 x North-North corresponds to one revolution from Lines. In this case, the motor pole pair number must be set to 1. P 582[0] - ENC_CH3_PeriodLen is not used in this case.

# 6.7.5.2 Sin/Cos encoder

Ch3: SINCOS(1) - Sin/Cos signals

Sin/Cos encoders can ...

1. Be pure incremental encoders without an absolute value interface. In this case, P 570[0] - ENC_CH3_Abs must be set to OFF(0).
2. Be incremental encoders with an absolute value interface. In this case, P 570[0] - ENC_CH3_Abs must be accordingly set to SSI(1) or EnDat(2) so that it will be possible to read the absolute encoder position for the absolute value initialization routine once during the initialization phase.

# 6.7.5.2.1 Purely Sin/Cos incremental encoders

To run these encoders as pure incremental encoders with a zero pulse on encoder channel Ch3 (without an absolute value interface), the approach is basically the same as for pure TTL operation (see Section ""TTL encoder"" on page 82). The same parameters apply. However, there are the following differences:

# 6.7.5.2.4 Sin/Cos incremental encoders with absolute value interface

The following table lists the parameters for cyclical Sin/Cos operation on encoder channel Ch 3 with one-time reading of the absolute encoder position via the absolute value interface, i.e. without a zero pulse:

|ID|Index Name|Unit|Description|
|---|---|---|---|
|507|ENC_CH3_Sel|1|Encoder selection set to SINCOS(1)|
|514|ENC_CH3_Num| |Encoder gearing: Numerator|
|515|ENC_CH3_Denom| |Encoder gearing: Denominator|
|570|ENC_CH3_Abs| |Absolute value interface selection (one-time reading)|
|572|ENC_CH3_Lines| |Number of Lines (Sin/Cos / TTL encoders)|
|573|ENC_CH3_MultiT| |Number of MultiTurn bits (absolute encoder)|
|574|ENC_CH3_SingleT| |Number of SingleTurn bits (absolute encoder)|
|575|ENC_CH3_Code| |Code selection (SSI encoder) (binary, gray)|
|576|ENC_CH3_Mode| |Mode selection (SSI encoder)|
|584|ENC_CH3_MTBase| |Definition of point of discontinuity in multi-turn range|
|585|ENC_CH3_MTEnable| |Enable MultiTurn use (negative logic, 1=MToff)|
|586|ENC_CH3_Corr| |Signal correction type|
|587|ENC_CH3_CorrVal| |Signal correction values|
|577|ENC_CH3_EncObsMin| |Encoder monitoring minimum, sqrt(a^2+b^2)|
|581|ENC_CH3_AbsEncStatus| |Error and status codes (absolute encoder)|
|582|ENC_CH3_PeriodLen|nm|Length of signal period (Sin/Cos linear encoder)|
|583|ENC_CH3_DigitalResolution|nm|Length of one increment (linear absolute encoder)|
|636|ENC_CH3_CycleCount| |Sampling cycle in: n x 125 μ (microseconds)|
|639|ENC_CH3_NominalincrementA| |Sign. Nominal increment A (distance coded abs. encoder)|
|637|ENC_CH3_NominalincrementB| |Sign. Nominal increment B (distance coded abs. encoder)|

# Table 6.24: Parameters for channel 3 (X8) - Sin/Cos encoder

Some parameters (e.g. Sel, Num, Denom, Abs, Lines, MultiT, SingleT, CorrVal) are self-explanatory.

The Code and Mode parameters are described in Section ""SSI (cyclical) X7"" on page 69.

P 584[0] - ENC_CH3_MTBase = Minimum MultiTurn position

The MTBase parameter is used to set a position in the multi-turn encoder’s travel path that defines the point of discontinuity (overflow/underflow) for the absolute value initialization (that is, the “multi-turn basis”). Assuming a bipolar encoder measuring range, all position values that fall below MTBase will be shifted “up” (the whole MT range will be added to them once). This method makes it possible to place the point of discontinuity at any point within the encoder’s entire measuring range. By default, MTBase will be set to the lowest possible value for the parameter, i.e. reliably outside of the encoder’s value range: In this case, the full bipolar range will remain unaffected, as values will never fall below this MTBase threshold (see Section ""Channel 3: Interface X8 (optional)"" on page 76 as well).

P 585[0] - ENC_CH3_MTEnable = MultiTurn as SingleTurn

The MTEnable parameter makes it possible to use multi-turn encoders as single-turn encoders for test purposes. Negative logic: Default MTEnable = 0 means ""MultiTurn-Enable ON"".

P 586[0] - ENC_CH3_Corr = Signal correction type:

The GPOC routine used for track signal correction purposes for sine/cosine signals is used to compensate for systematic errors. The routine is controlled with the Corr and CorrVal parameters (see Section ""Signal correction GPOC (Gain Phase Offset Correction)"" on page 74).

P 577[0] - ENC_CH3_EncObsMin = Encoder monitoring minimum, sqrt(a^2+b^2)

The parameter EncObsMin is used to scale the Sin/Cos wire break monitoring and represents the “downwards threshold” for an error message. The default setting is 0.2, corresponding to approx. ",What is the purpose of the 'Selection' column in the table describing X8 options for encoder evaluation?,The 'Selection' column indicates how different encoder types can be selected with P 507 - ENC_CH3_Sel when multiple types are supported by a technology option.,"It specifies the selection method for encoder types on a technology option, primarily through parameter P 507 - ENC_CH3_Sel, including handling impermissible combinations.","This column details the selection process for encoder types via P 507 - ENC_CH3_Sel, highlighting the procedure for choosing among supported encoders and identifying errors.","The 'Selection' column explains the use of P 507 - ENC_CH3_Sel to choose between different encoder types available on a technology option, noting error indications for wrong selections.","It outlines how to select encoder types with P 507 - ENC_CH3_Sel for a technology option, including the consequences of selecting incompatible encoder types."
3,msd_servo_drive.txt,29,8b7b14207d0506f3f75c9a63fb98a68193e71ed0f7337bac8f26cb3596e2b576,"3: “TTL encoder simulation / TTL master encoder”
- No. 4: “SSI encoder simulation”
- No. 5: “TTL encoder with commutation signals”

NOTE

- For information on the connector, pinout, technical data, configuration, and the encoder models (if any) that can be evaluated with the included technology option, please consult the Specification specified in the “Documentation” column.

The following table shows how the X8 options that can be used for encoder evaluation can be identified and selected.

|“No.” column|As per the table above.|
|---|---|
|“Hardware ID” column|The texts in this column can be viewed in the Moog DRIVEADMINISTRATOR 5 using P 53[0] - DV_HwOptionX12ID by going to ►Drive description ►Hardware version if the corresponding technology option is present.|
|“Selection” column|In certain cases, several different encoder types can be run on a technology option and selected with P 507 - ENC_CH3_Sel. Even if a technology option that does not match is equipped, most values can only be selected with P 507 - ENC_CH3_Sel. If an impermissible combination is selected, this will be indicated by means of error messages during the initialization phase.|

MOOG ID No.:CB40859-001 Date:11/2020

MSD ServoDrive - DeviceHelp 77

# 6 Encoder

MOOG ID No.:CB40859-001 Date:11/2020

# MSD ServoDrive - DeviceHelp

|No.|Technology option name|Hardware ID|Selection|
|---|---|---|---|
|0|No module|NONE(0) - No technology option|OFF (0)|
| | |SINCOS(1) - Sin/Cos cyclic *)| |
| | |- Without absolute value interface, Abs=OFF(0), with zero pulse| |
| | |- With SSI one-time reading, Abs=SSI(1)| |
|1|Second Sin/Cos encoder|SINCOS_V2(10) - 2nd Sin/Cos encoder (V2)|- With EnDat one-time reading, Abs=ENDAT(2)|
| | |SSI(2) - Cyclical SSI (without analog tracks)| |
| | |TTL(3) - TTL evaluation, with zero pulse| |
| | |ENDAT(4) - Cyclical EnDat (without analog tracks)| |
|3|TTL encoder simulation / TTL master encoder|TTL_ECSIM_V2(9) - TTL Encodersimulation (V2)|TTL(3)|
|4|SSI encoder simulation|SSI_ECSIM(3) - SSI encodersimulation|SSI(2) - Cyclical SSI (without analog tracks)|
|5|TTL encoder with commutation signals|TTL_COM(11) - TTL + Hall option|TTL(3)|
| | |TTL_COM(5)| |

Table 6.19: Options for X8 interface that can be used to evaluate encoders via encoder channel Ch3

*) SINCOS(1) is set via the P 507[0] - ENC_CH3_Sel main interface. The auxiliary interface, P 570[0] - ENC_CH3_Abs, can be optionally used to set the one-time reading for the absolute position during initialization.

# NOTE

- Only one encoder with a purely digital EnDat or SSI interface can be used on connector X8 or X7.
- If two EnDat encoders are used and one of them is purely digital, it is necessary to ensure that the purely digital encoder is connected to X8. This is important, as the EnDat encoder with Sin/Cos tracks must be initialized before the purely digital encoder.

# Encoder Configuration

To see which technology option your Servo Drive features (if any), go to Project Select from database tree ► Device setup ► Drive description in Moog DRIVEADMINISTRATOR 5 and check under “Technology option” in the “Hardware” section.

# Encoder Name

You can use this field to enter your own information for describing the encoder (maximum of 31 characters) (P 580[0] - ENC_CH3_Info).

# Cyclic Position Via

This drop-down menu is used to select the “main interface” (P 507[0] - ENC_CH3_Sel).

# Pulses Per Revolution

Once SINCOS(1), TTL(3) or TTL_COM(5) is selected as the “main interface,” this field will appear so that you can enter the number of analog Sin/Cos tracks per revolution (TTL tracks as well).

# Absolute Interface

This drop-down menu is used to select the “auxiliary interface” (P 570[0] - ENC_CH3_Abs).

# Image 6.5: Encoder Configuration Channel 3 (X8) Screen

This screen is used to select the encoder for channel Ch3. This channel uses the encoder’s “main interface” to measure position changes periodically and add them up cyclically – this is referred to as “cyclical evaluation.”

Encoders with a main interface that only makes it possible to measure the cyclical position incrementally often feature an additional absolute value interface referred to as an “auxiliary interface.” For this interface, the absolute position is measured once during the initialization phase and is then used for absolute value initialization purposes.

# Note

l Selecting an “auxiliary interface” is redundant if, for example, SSI (2) is selected as the “main interface” (corresponds to cyclical evaluation via SSI). In this case, the absolute value initialization will also be carried out via the SSI interface, regardless of the selected “auxiliary interface.”

# Gear Ratio

These fields can be used to define a gear ratio for the encoder (in the output side). For more details, see Section ""Encoder gearing"" on page 89.

MOOG ID No.:CB40859-001 Date:11/2020

MSD ServoDrive - DeviceHelp 79

# 6 Encoder

MOOG ID No.:CB40859-001 Date:11/2020

# MSD ServoDrive - DeviceHelp

Signal correction (GPOC) l P 577[0] - ENC_CH3_EncObsMin

If you set EncObsMin to 0, Sin/Cos wire break monitoring will be disabled.

GPOC is a special Moog online process for improving the quality of Sin/Cos signals before they are used to calculate a position. If “SINCOS(1)” is selected as the “main interface,” this process may be useful. For details see Section ""Signal correction GPOC (Gain Phase Offset Correction)"" on page 74.

The default value is 0.2 (20%) and stands for a calculated amplitude value (calculated using the two Sin/Cos signals) of x = sqrt(a² + b²). If the Sin/Cos signals are equal to approx. 1 Vss when compared, approx. 0.8 will be calculated here (approx. 80% magnitude at the A-D converters; approx. 0.25 Vss Sin/Cos will yield approx. 0.2 here (20% magnitude at the A-D converter)). The error threshold can be adjusted with EncObsMin.

# 6.7.1 Main parameters for encoder channel Ch3

The following table lists the most important parameters for the Ch3 encoder channel. These parameters are described in the chapters that go over selecting the various encoders with P 507[0] - ENC_CH3_Sel and P 570[0] - ENC_CH3_Abs.

When used with its default setting, this parameter will ensure that the absolute value initialization “starts up with plus-minus”. I.e. the encoder’s multi-turn value range from 0 to max will be mapped to -½ max to +½ max. The range from +½ max to max will be initialized as negative; in this case, the point of discontinuity will be found at ½ max. This can be changed with MTBase. When MTBase = 0, the absolute value initialization will, for example, “start up with zero to max”. I.e. the encoder’s multi-turn value range from 0 to max will be mapped to 0 to max. The range from +½ max to max will be initialized as positive; in this case, the point of discontinuity will be found at 0.

l P 585[0] - ENC_CH3_MTEnable

If you set MTEnable to 1, you can use an available multi-turn rotary encoder as a single-turn rotary encoder, which can come in handy for testing purposes.

|P No.|Index|Name / Setting|Unit|Description|
|---|---|---|---|---|
|507|0|ENC_CH3_Sel| |Main selection on encoder channel Ch3|
|570|0|ENC_CH3_Abs| |Absolute value interface for one-time reading|
|572|0|ENC_CH3_Lines| |Number of analog Sin/Cos lines per revolution (TTL lines as well)|
|573|0|ENC_CH3_MultiT| |Number of multi-turn bits for the digital interface|
|574|0|ENC_CH3_SingleT| |Number of single-turn bits for the digital interface|
|575|0|ENC_CH3_Code| |Code selection (for SSI encoders) (binary, Gray)|
|576|0|ENC_CH3_Mode| |Mode selection (for SSI encoders)|
|583|0|ENC_CH3_|nm|Linear encoders: Length of a digital increment in|
|584|0|DigitalResolution|nm (nanometres)| |
|585|0|ENC_CH3_MTBase| |Definition of point of discontinuity in multi-turn range|
|636|0|ENC_CH3_MTEnable| |Enable MultiTurn use (negative logic, 1=MToff)|
|636|0|ENC_CH3_CycleCount| |Sampling cycle in: n x 125 μ (microseconds)|

NOTE: As there are various protocol modes available for SSI encoders (with/without wire break monitoring, with/without parity bit, etc.), consult with your project supervisor or the Helpline provided by Moog before using any special SSI protocol modes.

As the functionality of the parameters for encoder channel Ch3 is predominantly identical to that of the parameters for encoder channel Ch1, it is recommended to read the description for the Ch1 encoder channel parameters.

Accordingly, the following table starts by listing all the parameters for the Ch3 encoder channel. If the functionality of a parameter is different from that of the corresponding parameter for encoder channel Ch1, the parameter will be described in the chapters that go over selecting a special encoder with (507) ENC_CH3_Sel and (570) ENC_CH3_Abs.

Parameters Lines, MultiT, SingleT, etc. are self-explanatory. Most of the following parameters are explained in the information for encoder channel Ch1 (see Section ""Channel 1: Interface X7"" on page 59).

# Table 6.21: Encoder configuration channel 3 (X8) parameters

|ID|Index|Name|Unit|Description|
|---|---|---|---|---|
|349|0|CON_FM_MConOffset| |Commutation offset|
|502|0..3|ENC_CH3_ActVal| |Current position value at encoder channel Ch3 output|
|507|0|ENC_CH3_Sel| |Main selection on encoder channel Ch3|
|514|0|ENC_CH3_Num| |Encoder gearing: Numerator|
|515|0|ENC_CH3_Denom| |Encoder gearing: Denominator|
|520|0|ENC_MCon| |=3, channel selection for motor commutation|
|521|0|ENC_SCon| |=3, channel selection for speed control|
|522|0|ENC_PCon| |=3, channel selection for position control|
|570|0|ENC_CH3_Abs| |Absolute value interface selection (one-time reading)|
|571|0|ENC_CH3_NpTest| |TEST-MODE: Index pulse signal(s) to Scope|
|572|0|ENC_CH3_Lines| |Number of Lines (Sin/Cos / TTL encoders)|
|573|0|ENC_CH3_MultiT| |Number of MultiTurn bits (absolute encoder)|
|574|0|ENC_CH3_SingleT| |Number of SingleTurn bits (absolute encoder)|
|574|0|ENC_CH3_Code| |Code selection (SSI encoder) (binary, gray)|
|576|0|ENC_CH3_Mode| |Mode selection (SSI encoder)|
|577|0|ENC_CH3_EncObsMin| |Encoder monitoring minimum, sqrt (a^2+b^2)|
|578|0|ENC_CH3_Extended| |(a^2 + b^2) ENC CH3: Extended|
|580|0|ENC_CH3_Info| |Encoder information channel 3|
|581|0|ENC_CH3_AbsEncStatus| |Error and status codes (absolute encoder)|
|582|0|ENC_CH3_PeriodLen|nm|Length of signal period (Sin/Cos linear encoder)|

# Encoder configuration channel 3 (X8) parameters (continue)

|Index|Name|Unit|Description|
|---|---|---|---|
|0|ENC_CH3_|nm|Length of one increment (linear absolute encoder)|
|0|DigitalResolution| | |
|0|ENC_CH3_MTBase| |Definition of point of discontinuity in multi-turn range|
|0|ENC_CH3_MTEnable| |Enable MultiTurn use (negative logic, 1=MToff)|
|0|ENC_CH3_Corr| |Signal correction type|
|0..4|ENC_CH3_CorrVal| |Signal correction values|
|0|ENC_CH3_EncObsAct| |Amplitude of analog signals (vector length)|
|0|ENC_CH3_HallLayout| |Hall pattern selection|
|0|ENC_CH3_Position|inc|Position encoder channel 3|
|0|ENC_CH3_Period|ms|Maximum period of interpolation (ttl encoder)|
|0|ENC_CH3_EncOnsActTF|ms|Filter time constant for amplitude of analog signals|
|0|ENC_CH3_|Sign.|Nominal increment A (distance coded abs. encoder)|
|0|ENC_CH3_|Sign.|Nominal increment B (distance coded abs. encoder)|
|0|ENC_CH3_CycleCount| |Position encoder sampling cycle (n x 125 μsec)|
|0|ENC_CH3_AbsInitMode| |Mode absolute value formation|
|0..29|ENC_ENDAT| |EnDat additional|
|0|ENC_Warning| |Encoder warning (e.g. from encoder internal memory)|
|0|ENC_Warning| |Encoder warning reset (e.g. in encoder internal memory)|
|0|ENC_Error| |Encoder error (e.g. from encoder internal memory)|
|0|ENC_ErrorReset| |Encoder error reset (e.g. in encoder internal memory)|
|0|ENC_ETS| |ETS mode, electronic nameplate|
|0|ENC_ETS_CTRL| |ETS control, electronic nameplate|
|0..15|ENC_ETS_STAT| |ETS status, electronic nameplate|
|0..511|ENC_ETS_DATA| |ETS data, electronic nameplate|
|0|ENC_CH3_TTL_| |TTL signal type selection|

# 6 Encoder

MOOG ID No.:CB40859-001 Date:11/2020

# 6.7.2 Absolute value interfaces X8

The following absolute value interfaces will be available at encoder channel Ch3 depending on the X8 option being used.

- Cyclical Sin/Cos with SSI one-time reading via X8 option: SINCOS_V2(10) - 2nd Sin/Cos encoder (V2)
- Cyclical Sin/Cos with EnDat one-time reading via X8 option: SINCOS_V2(10) - 2nd Sin/Cos encoder (V2)
- Cyclical SSI via X8 options: SINCOS_V2(10) - 2nd Sin/Cos encoder (V2) or SSI_ECSIM(3) - SSI encoder simulation
- Cyclical EnDat via X8 option: SINCOS_V2(10) - 2nd Sin/Cos encoder (V2)

See also table in Section ""Channel 3: Interface X8 (optional)"" on page 76. They can be selected with P 507[0] - ENC_CH3_Sel and P 570[0] - ENC_CH3_Abs. For more details, see Section ""Main parameters for encoder channel Ch3"" on page 80.

# 6.7.3 EnDat (cyclical) X8

Ch3: ENDAT(4) - Cyclical EnDat (2.1 or 2.2)

As the EnDat functionality of the parameters for encoder channel Ch3 is predominantly identical to that of the parameters for encoder channel Ch1, it is recommended to read the description for the Ch1 encoder channel parameters (see Section ""EnDat (cyclical) X7"" on page 61).

The software versions required to run the EnDat interface are the standard software versions for the MSD Servo Drive and MSD Single-Axis Servo Drive Compact.

NOTE

- Please note the limitations that apply when running EnDat and SSI encoders (see Section ""Limiting for EnDat and SSI"" on page 52).

|ID|Index|Name|Unit|Description|
|---|---|---|---|---|
|507|0|ENC_CH3_Sel|= 4|= ENDAT(4)|
|573|0|ENC_CH3_MultiT|Number of MultiTurn bits (absolute encoder)| |
|574|0|ENC_CH3_SingleT|Number of SingleTurn bits (absolute encoder)| |
|584|0|ENC_CH3_MTBase|Definition of point of discontinuity in multi-turn| |
|585|0|ENC_CH3_MTEnable|range|1: Use Multi-turn encoder as a single-turn encoder|
|636|0|ENC_CH3_CycleCount|Position encoder sampling cycle (n x 125 μsec)| |
|600|0|ENC_CH3_Position|inc|Position encoder channel 3|
|583|0|ENC_CH3_|nm|Length of one increment (linear absolute encoder)|
|640|0..29|DigitalResolution| | |

Table 6.22: ENC_ENDAT Channel 3 encoder configuration (X8) - EnDat (cyclical) parameters

# 6.7.4 Hall sensor X8

Encoder channel Ch3 does not support Hall effect sensors!

# 6.7.5 Sin/Cos / TTL X8

# 6.7.5.1 TTL encoder

Ch3: TTL(3) - TTL signals

TTL encoders are ...

1. ... usually pure incremental encoders without an absolute value interface. In this case, P 570[0] - ENC_CH3_Abs must be set to OFF(0).
2. ... in a few exceptional cases, incremental encoders with an SSI absolute value interface. In this case, P 570[0] - ENC_CH3_Abs must be accordingly set to SSI(1) so that it will be possible to read the absolute encoder position for the absolute value initialization routine once during the initialization phase.

# 6.7.5.1.1 Pure TTL incremental encoder

A maximum interpolation period, in ms (milliseconds), can be configured for the TTL interface using P 602[0] - ENC_CH3_Period. Within this context, Period is the maximum time of “no activity” since the last TTL counter event:

- Period = 0: Function disabled (default)
- Period > 0 (=n ms): If no counter event is registered in n ms, the speed will be set to 0.

# Zero pulse

There is no parameter for activating the zero pulse evaluation here, as this evaluation is controlled based exclusively on the homing mode (see Section ""Homing"" on page 249). However, setting P 571[0] - ENC_CH3_NpTest to 1 provides a test mode that can be used during commissioning in order to be able to activate the zero pulse evaluation even without homing. Scope signals 1034 and 1036 can be used to view a received zero pulse within this context. This test mode must be disabled during normal operation (P 571[0] = 0).

# Commutation

Motor operation with pure incremental encoders needs for the auto commutation function to be enabled without fail. For details see Section ""Synchronous motor auto commutation"" on page 156.

# 6.7.5.1.2 TTL incremental encoder with SSI absolute value interface

see Section ""Sin/Cos incremental encoders with absolute value interface"" on page 84 and in special Section ""SSI absolute value interface"" on page 86.

MOOG ID No.:CB40859-001 Date:11/2020

MSD ServoDrive - DeviceHelp

# 6 Encoder

MOOG ID No.:CB40859-001 Date:11/2020

MSD ServoDrive - DeviceHelp 84

|ID|Index Name|Unit|Description|
|---|---|---|---|
|507|0|ENC_CH3_Sel = 3|Encoder selection set to TTL(3)|
|514|0|ENC_CH3_Num|Encoder gearing: Numerator|
|515|0|ENC_CH3_Denom|Encoder gearing: Denominator|
|570|0|ENC_CH3_Abs|Selection of absolute value interface|
|571|0|ENC_CH3_NpTest|ENC CH1, TEST-MODE: Index pulse signal(s) to Scope|
|572|0|ENC_CH3_Lines|Number of lines (Sin/Cos / TTL encoders)|
|2842|0|ENC_CH3_TTL_SignalType|Channel 3: TTL signal selection|
|602|0|ENC_CH3_Period|Maximum period of interpolation (ttl encoder)|
|636|0|ENC_CH3_CycleCount|Sampling cycle in: n x 125 μ (microseconds)|

# Table 6.23: Parameters for Channel 3 (X8) - TTL encoder

6.7.5.2.2 Linear Sin/Cos incremental encoders

Linear Sin/Cos encoders are operated as rotary encoders. For linear motor operation, P 572[0] - ENC_CH3_Lines and the encoder gearing (see Section ""Encoder gearing"" on page 89) are used to establish the ratio for the linear motor’s pole pair subdivision (North-North) for commutation. 1 x North-North corresponds to one revolution from Lines. In this case, the motor pole pair number must be set to 1. P 582[0] - ENC_CH3_PeriodLen is not used in this case.

# 6.7.5.2 Sin/Cos encoder

Ch3: SINCOS(1) - Sin/Cos signals

Sin/Cos encoders can ...

1. Be pure incremental encoders without an absolute value interface. In this case, P 570[0] - ENC_CH3_Abs must be set to OFF(0).
2. Be incremental encoders with an absolute value interface. In this case, P 570[0] - ENC_CH3_Abs must be accordingly set to SSI(1) or EnDat(2) so that it will be possible to read the absolute encoder position for the absolute value initialization routine once during the initialization phase.

# 6.7.5.2.1 Purely Sin/Cos incremental encoders

To run these encoders as pure incremental encoders with a zero pulse on encoder channel Ch3 (without an absolute value interface), the approach is basically the same as for pure TTL operation (see Section ""TTL encoder"" on page 82). The same parameters apply. However, there are the following differences:

# 6.7.5.2.4 Sin/Cos incremental encoders with absolute value interface

The following table lists the parameters for cyclical Sin/Cos operation on encoder channel Ch 3 with one-time reading of the absolute encoder position via the absolute value interface, i.e. without a zero pulse:

|ID|Index Name|Unit|Description|
|---|---|---|---|
|507|ENC_CH3_Sel|1|Encoder selection set to SINCOS(1)|
|514|ENC_CH3_Num| |Encoder gearing: Numerator|
|515|ENC_CH3_Denom| |Encoder gearing: Denominator|
|570|ENC_CH3_Abs| |Absolute value interface selection (one-time reading)|
|572|ENC_CH3_Lines| |Number of Lines (Sin/Cos / TTL encoders)|
|573|ENC_CH3_MultiT| |Number of MultiTurn bits (absolute encoder)|
|574|ENC_CH3_SingleT| |Number of SingleTurn bits (absolute encoder)|
|575|ENC_CH3_Code| |Code selection (SSI encoder) (binary, gray)|
|576|ENC_CH3_Mode| |Mode selection (SSI encoder)|
|584|ENC_CH3_MTBase| |Definition of point of discontinuity in multi-turn range|
|585|ENC_CH3_MTEnable| |Enable MultiTurn use (negative logic, 1=MToff)|
|586|ENC_CH3_Corr| |Signal correction type|
|587|ENC_CH3_CorrVal| |Signal correction values|
|577|ENC_CH3_EncObsMin| |Encoder monitoring minimum, sqrt(a^2+b^2)|
|581|ENC_CH3_AbsEncStatus| |Error and status codes (absolute encoder)|
|582|ENC_CH3_PeriodLen|nm|Length of signal period (Sin/Cos linear encoder)|
|583|ENC_CH3_DigitalResolution|nm|Length of one increment (linear absolute encoder)|
|636|ENC_CH3_CycleCount| |Sampling cycle in: n x 125 μ (microseconds)|
|639|ENC_CH3_NominalincrementA| |Sign. Nominal increment A (distance coded abs. encoder)|
|637|ENC_CH3_NominalincrementB| |Sign. Nominal increment B (distance coded abs. encoder)|

# Table 6.24: Parameters for channel 3 (X8) - Sin/Cos encoder

Some parameters (e.g. Sel, Num, Denom, Abs, Lines, MultiT, SingleT, CorrVal) are self-explanatory.

The Code and Mode parameters are described in Section ""SSI (cyclical) X7"" on page 69.

P 584[0] - ENC_CH3_MTBase = Minimum MultiTurn position

The MTBase parameter is used to set a position in the multi-turn encoder’s travel path that defines the point of discontinuity (overflow/underflow) for the absolute value initialization (that is, the “multi-turn basis”). Assuming a bipolar encoder measuring range, all position values that fall below MTBase will be shifted “up” (the whole MT range will be added to them once). This method makes it possible to place the point of discontinuity at any point within the encoder’s entire measuring range. By default, MTBase will be set to the lowest possible value for the parameter, i.e. reliably outside of the encoder’s value range: In this case, the full bipolar range will remain unaffected, as values will never fall below this MTBase threshold (see Section ""Channel 3: Interface X8 (optional)"" on page 76 as well).

P 585[0] - ENC_CH3_MTEnable = MultiTurn as SingleTurn

The MTEnable parameter makes it possible to use multi-turn encoders as single-turn encoders for test purposes. Negative logic: Default MTEnable = 0 means ""MultiTurn-Enable ON"".

P 586[0] - ENC_CH3_Corr = Signal correction type:

The GPOC routine used for track signal correction purposes for sine/cosine signals is used to compensate for systematic errors. The routine is controlled with the Corr and CorrVal parameters (see Section ""Signal correction GPOC (Gain Phase Offset Correction)"" on page 74).

P 577[0] - ENC_CH3_EncObsMin = Encoder monitoring minimum, sqrt(a^2+b^2)

The parameter EncObsMin is used to scale the Sin/Cos wire break monitoring and represents the “downwards threshold” for an error message. The default setting is 0.2, corresponding to approx. ",What does the 'MSD ServoDrive - DeviceHelp' document say about using two EnDat encoders?,"If two EnDat encoders are used and one is purely digital, the purely digital encoder must be connected to X8 to ensure proper initialization order.","The document specifies that with two EnDat encoders, the purely digital one should be on X8, as the Sin/Cos tracks encoder must initialize first.","For two EnDat encoders, the purely digital one needs to be on X8 interface to allow the Sin/Cos tracks encoder to initialize before it.","The requirement is to connect the purely digital EnDat encoder to X8 when using two EnDat encoders, ensuring Sin/Cos tracks encoder initializes first.","It mandates that in a setup with two EnDat encoders, the purely digital encoder is connected to X8, prioritizing Sin/Cos encoder initialization."
4,msd_servo_drive.txt,29,8b7b14207d0506f3f75c9a63fb98a68193e71ed0f7337bac8f26cb3596e2b576,"3: “TTL encoder simulation / TTL master encoder”
- No. 4: “SSI encoder simulation”
- No. 5: “TTL encoder with commutation signals”

NOTE

- For information on the connector, pinout, technical data, configuration, and the encoder models (if any) that can be evaluated with the included technology option, please consult the Specification specified in the “Documentation” column.

The following table shows how the X8 options that can be used for encoder evaluation can be identified and selected.

|“No.” column|As per the table above.|
|---|---|
|“Hardware ID” column|The texts in this column can be viewed in the Moog DRIVEADMINISTRATOR 5 using P 53[0] - DV_HwOptionX12ID by going to ►Drive description ►Hardware version if the corresponding technology option is present.|
|“Selection” column|In certain cases, several different encoder types can be run on a technology option and selected with P 507 - ENC_CH3_Sel. Even if a technology option that does not match is equipped, most values can only be selected with P 507 - ENC_CH3_Sel. If an impermissible combination is selected, this will be indicated by means of error messages during the initialization phase.|

MOOG ID No.:CB40859-001 Date:11/2020

MSD ServoDrive - DeviceHelp 77

# 6 Encoder

MOOG ID No.:CB40859-001 Date:11/2020

# MSD ServoDrive - DeviceHelp

|No.|Technology option name|Hardware ID|Selection|
|---|---|---|---|
|0|No module|NONE(0) - No technology option|OFF (0)|
| | |SINCOS(1) - Sin/Cos cyclic *)| |
| | |- Without absolute value interface, Abs=OFF(0), with zero pulse| |
| | |- With SSI one-time reading, Abs=SSI(1)| |
|1|Second Sin/Cos encoder|SINCOS_V2(10) - 2nd Sin/Cos encoder (V2)|- With EnDat one-time reading, Abs=ENDAT(2)|
| | |SSI(2) - Cyclical SSI (without analog tracks)| |
| | |TTL(3) - TTL evaluation, with zero pulse| |
| | |ENDAT(4) - Cyclical EnDat (without analog tracks)| |
|3|TTL encoder simulation / TTL master encoder|TTL_ECSIM_V2(9) - TTL Encodersimulation (V2)|TTL(3)|
|4|SSI encoder simulation|SSI_ECSIM(3) - SSI encodersimulation|SSI(2) - Cyclical SSI (without analog tracks)|
|5|TTL encoder with commutation signals|TTL_COM(11) - TTL + Hall option|TTL(3)|
| | |TTL_COM(5)| |

Table 6.19: Options for X8 interface that can be used to evaluate encoders via encoder channel Ch3

*) SINCOS(1) is set via the P 507[0] - ENC_CH3_Sel main interface. The auxiliary interface, P 570[0] - ENC_CH3_Abs, can be optionally used to set the one-time reading for the absolute position during initialization.

# NOTE

- Only one encoder with a purely digital EnDat or SSI interface can be used on connector X8 or X7.
- If two EnDat encoders are used and one of them is purely digital, it is necessary to ensure that the purely digital encoder is connected to X8. This is important, as the EnDat encoder with Sin/Cos tracks must be initialized before the purely digital encoder.

# Encoder Configuration

To see which technology option your Servo Drive features (if any), go to Project Select from database tree ► Device setup ► Drive description in Moog DRIVEADMINISTRATOR 5 and check under “Technology option” in the “Hardware” section.

# Encoder Name

You can use this field to enter your own information for describing the encoder (maximum of 31 characters) (P 580[0] - ENC_CH3_Info).

# Cyclic Position Via

This drop-down menu is used to select the “main interface” (P 507[0] - ENC_CH3_Sel).

# Pulses Per Revolution

Once SINCOS(1), TTL(3) or TTL_COM(5) is selected as the “main interface,” this field will appear so that you can enter the number of analog Sin/Cos tracks per revolution (TTL tracks as well).

# Absolute Interface

This drop-down menu is used to select the “auxiliary interface” (P 570[0] - ENC_CH3_Abs).

# Image 6.5: Encoder Configuration Channel 3 (X8) Screen

This screen is used to select the encoder for channel Ch3. This channel uses the encoder’s “main interface” to measure position changes periodically and add them up cyclically – this is referred to as “cyclical evaluation.”

Encoders with a main interface that only makes it possible to measure the cyclical position incrementally often feature an additional absolute value interface referred to as an “auxiliary interface.” For this interface, the absolute position is measured once during the initialization phase and is then used for absolute value initialization purposes.

# Note

l Selecting an “auxiliary interface” is redundant if, for example, SSI (2) is selected as the “main interface” (corresponds to cyclical evaluation via SSI). In this case, the absolute value initialization will also be carried out via the SSI interface, regardless of the selected “auxiliary interface.”

# Gear Ratio

These fields can be used to define a gear ratio for the encoder (in the output side). For more details, see Section ""Encoder gearing"" on page 89.

MOOG ID No.:CB40859-001 Date:11/2020

MSD ServoDrive - DeviceHelp 79

# 6 Encoder

MOOG ID No.:CB40859-001 Date:11/2020

# MSD ServoDrive - DeviceHelp

Signal correction (GPOC) l P 577[0] - ENC_CH3_EncObsMin

If you set EncObsMin to 0, Sin/Cos wire break monitoring will be disabled.

GPOC is a special Moog online process for improving the quality of Sin/Cos signals before they are used to calculate a position. If “SINCOS(1)” is selected as the “main interface,” this process may be useful. For details see Section ""Signal correction GPOC (Gain Phase Offset Correction)"" on page 74.

The default value is 0.2 (20%) and stands for a calculated amplitude value (calculated using the two Sin/Cos signals) of x = sqrt(a² + b²). If the Sin/Cos signals are equal to approx. 1 Vss when compared, approx. 0.8 will be calculated here (approx. 80% magnitude at the A-D converters; approx. 0.25 Vss Sin/Cos will yield approx. 0.2 here (20% magnitude at the A-D converter)). The error threshold can be adjusted with EncObsMin.

# 6.7.1 Main parameters for encoder channel Ch3

The following table lists the most important parameters for the Ch3 encoder channel. These parameters are described in the chapters that go over selecting the various encoders with P 507[0] - ENC_CH3_Sel and P 570[0] - ENC_CH3_Abs.

When used with its default setting, this parameter will ensure that the absolute value initialization “starts up with plus-minus”. I.e. the encoder’s multi-turn value range from 0 to max will be mapped to -½ max to +½ max. The range from +½ max to max will be initialized as negative; in this case, the point of discontinuity will be found at ½ max. This can be changed with MTBase. When MTBase = 0, the absolute value initialization will, for example, “start up with zero to max”. I.e. the encoder’s multi-turn value range from 0 to max will be mapped to 0 to max. The range from +½ max to max will be initialized as positive; in this case, the point of discontinuity will be found at 0.

l P 585[0] - ENC_CH3_MTEnable

If you set MTEnable to 1, you can use an available multi-turn rotary encoder as a single-turn rotary encoder, which can come in handy for testing purposes.

|P No.|Index|Name / Setting|Unit|Description|
|---|---|---|---|---|
|507|0|ENC_CH3_Sel| |Main selection on encoder channel Ch3|
|570|0|ENC_CH3_Abs| |Absolute value interface for one-time reading|
|572|0|ENC_CH3_Lines| |Number of analog Sin/Cos lines per revolution (TTL lines as well)|
|573|0|ENC_CH3_MultiT| |Number of multi-turn bits for the digital interface|
|574|0|ENC_CH3_SingleT| |Number of single-turn bits for the digital interface|
|575|0|ENC_CH3_Code| |Code selection (for SSI encoders) (binary, Gray)|
|576|0|ENC_CH3_Mode| |Mode selection (for SSI encoders)|
|583|0|ENC_CH3_|nm|Linear encoders: Length of a digital increment in|
|584|0|DigitalResolution|nm (nanometres)| |
|585|0|ENC_CH3_MTBase| |Definition of point of discontinuity in multi-turn range|
|636|0|ENC_CH3_MTEnable| |Enable MultiTurn use (negative logic, 1=MToff)|
|636|0|ENC_CH3_CycleCount| |Sampling cycle in: n x 125 μ (microseconds)|

NOTE: As there are various protocol modes available for SSI encoders (with/without wire break monitoring, with/without parity bit, etc.), consult with your project supervisor or the Helpline provided by Moog before using any special SSI protocol modes.

As the functionality of the parameters for encoder channel Ch3 is predominantly identical to that of the parameters for encoder channel Ch1, it is recommended to read the description for the Ch1 encoder channel parameters.

Accordingly, the following table starts by listing all the parameters for the Ch3 encoder channel. If the functionality of a parameter is different from that of the corresponding parameter for encoder channel Ch1, the parameter will be described in the chapters that go over selecting a special encoder with (507) ENC_CH3_Sel and (570) ENC_CH3_Abs.

Parameters Lines, MultiT, SingleT, etc. are self-explanatory. Most of the following parameters are explained in the information for encoder channel Ch1 (see Section ""Channel 1: Interface X7"" on page 59).

# Table 6.21: Encoder configuration channel 3 (X8) parameters

|ID|Index|Name|Unit|Description|
|---|---|---|---|---|
|349|0|CON_FM_MConOffset| |Commutation offset|
|502|0..3|ENC_CH3_ActVal| |Current position value at encoder channel Ch3 output|
|507|0|ENC_CH3_Sel| |Main selection on encoder channel Ch3|
|514|0|ENC_CH3_Num| |Encoder gearing: Numerator|
|515|0|ENC_CH3_Denom| |Encoder gearing: Denominator|
|520|0|ENC_MCon| |=3, channel selection for motor commutation|
|521|0|ENC_SCon| |=3, channel selection for speed control|
|522|0|ENC_PCon| |=3, channel selection for position control|
|570|0|ENC_CH3_Abs| |Absolute value interface selection (one-time reading)|
|571|0|ENC_CH3_NpTest| |TEST-MODE: Index pulse signal(s) to Scope|
|572|0|ENC_CH3_Lines| |Number of Lines (Sin/Cos / TTL encoders)|
|573|0|ENC_CH3_MultiT| |Number of MultiTurn bits (absolute encoder)|
|574|0|ENC_CH3_SingleT| |Number of SingleTurn bits (absolute encoder)|
|574|0|ENC_CH3_Code| |Code selection (SSI encoder) (binary, gray)|
|576|0|ENC_CH3_Mode| |Mode selection (SSI encoder)|
|577|0|ENC_CH3_EncObsMin| |Encoder monitoring minimum, sqrt (a^2+b^2)|
|578|0|ENC_CH3_Extended| |(a^2 + b^2) ENC CH3: Extended|
|580|0|ENC_CH3_Info| |Encoder information channel 3|
|581|0|ENC_CH3_AbsEncStatus| |Error and status codes (absolute encoder)|
|582|0|ENC_CH3_PeriodLen|nm|Length of signal period (Sin/Cos linear encoder)|

# Encoder configuration channel 3 (X8) parameters (continue)

|Index|Name|Unit|Description|
|---|---|---|---|
|0|ENC_CH3_|nm|Length of one increment (linear absolute encoder)|
|0|DigitalResolution| | |
|0|ENC_CH3_MTBase| |Definition of point of discontinuity in multi-turn range|
|0|ENC_CH3_MTEnable| |Enable MultiTurn use (negative logic, 1=MToff)|
|0|ENC_CH3_Corr| |Signal correction type|
|0..4|ENC_CH3_CorrVal| |Signal correction values|
|0|ENC_CH3_EncObsAct| |Amplitude of analog signals (vector length)|
|0|ENC_CH3_HallLayout| |Hall pattern selection|
|0|ENC_CH3_Position|inc|Position encoder channel 3|
|0|ENC_CH3_Period|ms|Maximum period of interpolation (ttl encoder)|
|0|ENC_CH3_EncOnsActTF|ms|Filter time constant for amplitude of analog signals|
|0|ENC_CH3_|Sign.|Nominal increment A (distance coded abs. encoder)|
|0|ENC_CH3_|Sign.|Nominal increment B (distance coded abs. encoder)|
|0|ENC_CH3_CycleCount| |Position encoder sampling cycle (n x 125 μsec)|
|0|ENC_CH3_AbsInitMode| |Mode absolute value formation|
|0..29|ENC_ENDAT| |EnDat additional|
|0|ENC_Warning| |Encoder warning (e.g. from encoder internal memory)|
|0|ENC_Warning| |Encoder warning reset (e.g. in encoder internal memory)|
|0|ENC_Error| |Encoder error (e.g. from encoder internal memory)|
|0|ENC_ErrorReset| |Encoder error reset (e.g. in encoder internal memory)|
|0|ENC_ETS| |ETS mode, electronic nameplate|
|0|ENC_ETS_CTRL| |ETS control, electronic nameplate|
|0..15|ENC_ETS_STAT| |ETS status, electronic nameplate|
|0..511|ENC_ETS_DATA| |ETS data, electronic nameplate|
|0|ENC_CH3_TTL_| |TTL signal type selection|

# 6 Encoder

MOOG ID No.:CB40859-001 Date:11/2020

# 6.7.2 Absolute value interfaces X8

The following absolute value interfaces will be available at encoder channel Ch3 depending on the X8 option being used.

- Cyclical Sin/Cos with SSI one-time reading via X8 option: SINCOS_V2(10) - 2nd Sin/Cos encoder (V2)
- Cyclical Sin/Cos with EnDat one-time reading via X8 option: SINCOS_V2(10) - 2nd Sin/Cos encoder (V2)
- Cyclical SSI via X8 options: SINCOS_V2(10) - 2nd Sin/Cos encoder (V2) or SSI_ECSIM(3) - SSI encoder simulation
- Cyclical EnDat via X8 option: SINCOS_V2(10) - 2nd Sin/Cos encoder (V2)

See also table in Section ""Channel 3: Interface X8 (optional)"" on page 76. They can be selected with P 507[0] - ENC_CH3_Sel and P 570[0] - ENC_CH3_Abs. For more details, see Section ""Main parameters for encoder channel Ch3"" on page 80.

# 6.7.3 EnDat (cyclical) X8

Ch3: ENDAT(4) - Cyclical EnDat (2.1 or 2.2)

As the EnDat functionality of the parameters for encoder channel Ch3 is predominantly identical to that of the parameters for encoder channel Ch1, it is recommended to read the description for the Ch1 encoder channel parameters (see Section ""EnDat (cyclical) X7"" on page 61).

The software versions required to run the EnDat interface are the standard software versions for the MSD Servo Drive and MSD Single-Axis Servo Drive Compact.

NOTE

- Please note the limitations that apply when running EnDat and SSI encoders (see Section ""Limiting for EnDat and SSI"" on page 52).

|ID|Index|Name|Unit|Description|
|---|---|---|---|---|
|507|0|ENC_CH3_Sel|= 4|= ENDAT(4)|
|573|0|ENC_CH3_MultiT|Number of MultiTurn bits (absolute encoder)| |
|574|0|ENC_CH3_SingleT|Number of SingleTurn bits (absolute encoder)| |
|584|0|ENC_CH3_MTBase|Definition of point of discontinuity in multi-turn| |
|585|0|ENC_CH3_MTEnable|range|1: Use Multi-turn encoder as a single-turn encoder|
|636|0|ENC_CH3_CycleCount|Position encoder sampling cycle (n x 125 μsec)| |
|600|0|ENC_CH3_Position|inc|Position encoder channel 3|
|583|0|ENC_CH3_|nm|Length of one increment (linear absolute encoder)|
|640|0..29|DigitalResolution| | |

Table 6.22: ENC_ENDAT Channel 3 encoder configuration (X8) - EnDat (cyclical) parameters

# 6.7.4 Hall sensor X8

Encoder channel Ch3 does not support Hall effect sensors!

# 6.7.5 Sin/Cos / TTL X8

# 6.7.5.1 TTL encoder

Ch3: TTL(3) - TTL signals

TTL encoders are ...

1. ... usually pure incremental encoders without an absolute value interface. In this case, P 570[0] - ENC_CH3_Abs must be set to OFF(0).
2. ... in a few exceptional cases, incremental encoders with an SSI absolute value interface. In this case, P 570[0] - ENC_CH3_Abs must be accordingly set to SSI(1) so that it will be possible to read the absolute encoder position for the absolute value initialization routine once during the initialization phase.

# 6.7.5.1.1 Pure TTL incremental encoder

A maximum interpolation period, in ms (milliseconds), can be configured for the TTL interface using P 602[0] - ENC_CH3_Period. Within this context, Period is the maximum time of “no activity” since the last TTL counter event:

- Period = 0: Function disabled (default)
- Period > 0 (=n ms): If no counter event is registered in n ms, the speed will be set to 0.

# Zero pulse

There is no parameter for activating the zero pulse evaluation here, as this evaluation is controlled based exclusively on the homing mode (see Section ""Homing"" on page 249). However, setting P 571[0] - ENC_CH3_NpTest to 1 provides a test mode that can be used during commissioning in order to be able to activate the zero pulse evaluation even without homing. Scope signals 1034 and 1036 can be used to view a received zero pulse within this context. This test mode must be disabled during normal operation (P 571[0] = 0).

# Commutation

Motor operation with pure incremental encoders needs for the auto commutation function to be enabled without fail. For details see Section ""Synchronous motor auto commutation"" on page 156.

# 6.7.5.1.2 TTL incremental encoder with SSI absolute value interface

see Section ""Sin/Cos incremental encoders with absolute value interface"" on page 84 and in special Section ""SSI absolute value interface"" on page 86.

MOOG ID No.:CB40859-001 Date:11/2020

MSD ServoDrive - DeviceHelp

# 6 Encoder

MOOG ID No.:CB40859-001 Date:11/2020

MSD ServoDrive - DeviceHelp 84

|ID|Index Name|Unit|Description|
|---|---|---|---|
|507|0|ENC_CH3_Sel = 3|Encoder selection set to TTL(3)|
|514|0|ENC_CH3_Num|Encoder gearing: Numerator|
|515|0|ENC_CH3_Denom|Encoder gearing: Denominator|
|570|0|ENC_CH3_Abs|Selection of absolute value interface|
|571|0|ENC_CH3_NpTest|ENC CH1, TEST-MODE: Index pulse signal(s) to Scope|
|572|0|ENC_CH3_Lines|Number of lines (Sin/Cos / TTL encoders)|
|2842|0|ENC_CH3_TTL_SignalType|Channel 3: TTL signal selection|
|602|0|ENC_CH3_Period|Maximum period of interpolation (ttl encoder)|
|636|0|ENC_CH3_CycleCount|Sampling cycle in: n x 125 μ (microseconds)|

# Table 6.23: Parameters for Channel 3 (X8) - TTL encoder

6.7.5.2.2 Linear Sin/Cos incremental encoders

Linear Sin/Cos encoders are operated as rotary encoders. For linear motor operation, P 572[0] - ENC_CH3_Lines and the encoder gearing (see Section ""Encoder gearing"" on page 89) are used to establish the ratio for the linear motor’s pole pair subdivision (North-North) for commutation. 1 x North-North corresponds to one revolution from Lines. In this case, the motor pole pair number must be set to 1. P 582[0] - ENC_CH3_PeriodLen is not used in this case.

# 6.7.5.2 Sin/Cos encoder

Ch3: SINCOS(1) - Sin/Cos signals

Sin/Cos encoders can ...

1. Be pure incremental encoders without an absolute value interface. In this case, P 570[0] - ENC_CH3_Abs must be set to OFF(0).
2. Be incremental encoders with an absolute value interface. In this case, P 570[0] - ENC_CH3_Abs must be accordingly set to SSI(1) or EnDat(2) so that it will be possible to read the absolute encoder position for the absolute value initialization routine once during the initialization phase.

# 6.7.5.2.1 Purely Sin/Cos incremental encoders

To run these encoders as pure incremental encoders with a zero pulse on encoder channel Ch3 (without an absolute value interface), the approach is basically the same as for pure TTL operation (see Section ""TTL encoder"" on page 82). The same parameters apply. However, there are the following differences:

# 6.7.5.2.4 Sin/Cos incremental encoders with absolute value interface

The following table lists the parameters for cyclical Sin/Cos operation on encoder channel Ch 3 with one-time reading of the absolute encoder position via the absolute value interface, i.e. without a zero pulse:

|ID|Index Name|Unit|Description|
|---|---|---|---|
|507|ENC_CH3_Sel|1|Encoder selection set to SINCOS(1)|
|514|ENC_CH3_Num| |Encoder gearing: Numerator|
|515|ENC_CH3_Denom| |Encoder gearing: Denominator|
|570|ENC_CH3_Abs| |Absolute value interface selection (one-time reading)|
|572|ENC_CH3_Lines| |Number of Lines (Sin/Cos / TTL encoders)|
|573|ENC_CH3_MultiT| |Number of MultiTurn bits (absolute encoder)|
|574|ENC_CH3_SingleT| |Number of SingleTurn bits (absolute encoder)|
|575|ENC_CH3_Code| |Code selection (SSI encoder) (binary, gray)|
|576|ENC_CH3_Mode| |Mode selection (SSI encoder)|
|584|ENC_CH3_MTBase| |Definition of point of discontinuity in multi-turn range|
|585|ENC_CH3_MTEnable| |Enable MultiTurn use (negative logic, 1=MToff)|
|586|ENC_CH3_Corr| |Signal correction type|
|587|ENC_CH3_CorrVal| |Signal correction values|
|577|ENC_CH3_EncObsMin| |Encoder monitoring minimum, sqrt(a^2+b^2)|
|581|ENC_CH3_AbsEncStatus| |Error and status codes (absolute encoder)|
|582|ENC_CH3_PeriodLen|nm|Length of signal period (Sin/Cos linear encoder)|
|583|ENC_CH3_DigitalResolution|nm|Length of one increment (linear absolute encoder)|
|636|ENC_CH3_CycleCount| |Sampling cycle in: n x 125 μ (microseconds)|
|639|ENC_CH3_NominalincrementA| |Sign. Nominal increment A (distance coded abs. encoder)|
|637|ENC_CH3_NominalincrementB| |Sign. Nominal increment B (distance coded abs. encoder)|

# Table 6.24: Parameters for channel 3 (X8) - Sin/Cos encoder

Some parameters (e.g. Sel, Num, Denom, Abs, Lines, MultiT, SingleT, CorrVal) are self-explanatory.

The Code and Mode parameters are described in Section ""SSI (cyclical) X7"" on page 69.

P 584[0] - ENC_CH3_MTBase = Minimum MultiTurn position

The MTBase parameter is used to set a position in the multi-turn encoder’s travel path that defines the point of discontinuity (overflow/underflow) for the absolute value initialization (that is, the “multi-turn basis”). Assuming a bipolar encoder measuring range, all position values that fall below MTBase will be shifted “up” (the whole MT range will be added to them once). This method makes it possible to place the point of discontinuity at any point within the encoder’s entire measuring range. By default, MTBase will be set to the lowest possible value for the parameter, i.e. reliably outside of the encoder’s value range: In this case, the full bipolar range will remain unaffected, as values will never fall below this MTBase threshold (see Section ""Channel 3: Interface X8 (optional)"" on page 76 as well).

P 585[0] - ENC_CH3_MTEnable = MultiTurn as SingleTurn

The MTEnable parameter makes it possible to use multi-turn encoders as single-turn encoders for test purposes. Negative logic: Default MTEnable = 0 means ""MultiTurn-Enable ON"".

P 586[0] - ENC_CH3_Corr = Signal correction type:

The GPOC routine used for track signal correction purposes for sine/cosine signals is used to compensate for systematic errors. The routine is controlled with the Corr and CorrVal parameters (see Section ""Signal correction GPOC (Gain Phase Offset Correction)"" on page 74).

P 577[0] - ENC_CH3_EncObsMin = Encoder monitoring minimum, sqrt(a^2+b^2)

The parameter EncObsMin is used to scale the Sin/Cos wire break monitoring and represents the “downwards threshold” for an error message. The default setting is 0.2, corresponding to approx. ",How is the encoder for channel Ch3 selected in the 'MSD ServoDrive - DeviceHelp' document?,The encoder for channel Ch3 is selected using the 'main interface' parameter P 507[0] - ENC_CH3_Sel in the encoder configuration screen.,"Selection is done via P 507[0] - ENC_CH3_Sel, designated as the 'main interface' for choosing the encoder type on channel Ch3.","Through the 'main interface' parameter ENC_CH3_Sel (P 507[0]), users can select the appropriate encoder for channel Ch3.","The document describes using P 507[0] - ENC_CH3_Sel, the 'main interface', to configure the encoder selection for channel Ch3.","Encoder selection for Ch3 involves setting the 'main interface' with P 507[0] - ENC_CH3_Sel, as outlined in the encoder configuration section."
5,msd_servo_drive.txt,29,8b7b14207d0506f3f75c9a63fb98a68193e71ed0f7337bac8f26cb3596e2b576,"3: “TTL encoder simulation / TTL master encoder”
- No. 4: “SSI encoder simulation”
- No. 5: “TTL encoder with commutation signals”

NOTE

- For information on the connector, pinout, technical data, configuration, and the encoder models (if any) that can be evaluated with the included technology option, please consult the Specification specified in the “Documentation” column.

The following table shows how the X8 options that can be used for encoder evaluation can be identified and selected.

|“No.” column|As per the table above.|
|---|---|
|“Hardware ID” column|The texts in this column can be viewed in the Moog DRIVEADMINISTRATOR 5 using P 53[0] - DV_HwOptionX12ID by going to ►Drive description ►Hardware version if the corresponding technology option is present.|
|“Selection” column|In certain cases, several different encoder types can be run on a technology option and selected with P 507 - ENC_CH3_Sel. Even if a technology option that does not match is equipped, most values can only be selected with P 507 - ENC_CH3_Sel. If an impermissible combination is selected, this will be indicated by means of error messages during the initialization phase.|

MOOG ID No.:CB40859-001 Date:11/2020

MSD ServoDrive - DeviceHelp 77

# 6 Encoder

MOOG ID No.:CB40859-001 Date:11/2020

# MSD ServoDrive - DeviceHelp

|No.|Technology option name|Hardware ID|Selection|
|---|---|---|---|
|0|No module|NONE(0) - No technology option|OFF (0)|
| | |SINCOS(1) - Sin/Cos cyclic *)| |
| | |- Without absolute value interface, Abs=OFF(0), with zero pulse| |
| | |- With SSI one-time reading, Abs=SSI(1)| |
|1|Second Sin/Cos encoder|SINCOS_V2(10) - 2nd Sin/Cos encoder (V2)|- With EnDat one-time reading, Abs=ENDAT(2)|
| | |SSI(2) - Cyclical SSI (without analog tracks)| |
| | |TTL(3) - TTL evaluation, with zero pulse| |
| | |ENDAT(4) - Cyclical EnDat (without analog tracks)| |
|3|TTL encoder simulation / TTL master encoder|TTL_ECSIM_V2(9) - TTL Encodersimulation (V2)|TTL(3)|
|4|SSI encoder simulation|SSI_ECSIM(3) - SSI encodersimulation|SSI(2) - Cyclical SSI (without analog tracks)|
|5|TTL encoder with commutation signals|TTL_COM(11) - TTL + Hall option|TTL(3)|
| | |TTL_COM(5)| |

Table 6.19: Options for X8 interface that can be used to evaluate encoders via encoder channel Ch3

*) SINCOS(1) is set via the P 507[0] - ENC_CH3_Sel main interface. The auxiliary interface, P 570[0] - ENC_CH3_Abs, can be optionally used to set the one-time reading for the absolute position during initialization.

# NOTE

- Only one encoder with a purely digital EnDat or SSI interface can be used on connector X8 or X7.
- If two EnDat encoders are used and one of them is purely digital, it is necessary to ensure that the purely digital encoder is connected to X8. This is important, as the EnDat encoder with Sin/Cos tracks must be initialized before the purely digital encoder.

# Encoder Configuration

To see which technology option your Servo Drive features (if any), go to Project Select from database tree ► Device setup ► Drive description in Moog DRIVEADMINISTRATOR 5 and check under “Technology option” in the “Hardware” section.

# Encoder Name

You can use this field to enter your own information for describing the encoder (maximum of 31 characters) (P 580[0] - ENC_CH3_Info).

# Cyclic Position Via

This drop-down menu is used to select the “main interface” (P 507[0] - ENC_CH3_Sel).

# Pulses Per Revolution

Once SINCOS(1), TTL(3) or TTL_COM(5) is selected as the “main interface,” this field will appear so that you can enter the number of analog Sin/Cos tracks per revolution (TTL tracks as well).

# Absolute Interface

This drop-down menu is used to select the “auxiliary interface” (P 570[0] - ENC_CH3_Abs).

# Image 6.5: Encoder Configuration Channel 3 (X8) Screen

This screen is used to select the encoder for channel Ch3. This channel uses the encoder’s “main interface” to measure position changes periodically and add them up cyclically – this is referred to as “cyclical evaluation.”

Encoders with a main interface that only makes it possible to measure the cyclical position incrementally often feature an additional absolute value interface referred to as an “auxiliary interface.” For this interface, the absolute position is measured once during the initialization phase and is then used for absolute value initialization purposes.

# Note

l Selecting an “auxiliary interface” is redundant if, for example, SSI (2) is selected as the “main interface” (corresponds to cyclical evaluation via SSI). In this case, the absolute value initialization will also be carried out via the SSI interface, regardless of the selected “auxiliary interface.”

# Gear Ratio

These fields can be used to define a gear ratio for the encoder (in the output side). For more details, see Section ""Encoder gearing"" on page 89.

MOOG ID No.:CB40859-001 Date:11/2020

MSD ServoDrive - DeviceHelp 79

# 6 Encoder

MOOG ID No.:CB40859-001 Date:11/2020

# MSD ServoDrive - DeviceHelp

Signal correction (GPOC) l P 577[0] - ENC_CH3_EncObsMin

If you set EncObsMin to 0, Sin/Cos wire break monitoring will be disabled.

GPOC is a special Moog online process for improving the quality of Sin/Cos signals before they are used to calculate a position. If “SINCOS(1)” is selected as the “main interface,” this process may be useful. For details see Section ""Signal correction GPOC (Gain Phase Offset Correction)"" on page 74.

The default value is 0.2 (20%) and stands for a calculated amplitude value (calculated using the two Sin/Cos signals) of x = sqrt(a² + b²). If the Sin/Cos signals are equal to approx. 1 Vss when compared, approx. 0.8 will be calculated here (approx. 80% magnitude at the A-D converters; approx. 0.25 Vss Sin/Cos will yield approx. 0.2 here (20% magnitude at the A-D converter)). The error threshold can be adjusted with EncObsMin.

# 6.7.1 Main parameters for encoder channel Ch3

The following table lists the most important parameters for the Ch3 encoder channel. These parameters are described in the chapters that go over selecting the various encoders with P 507[0] - ENC_CH3_Sel and P 570[0] - ENC_CH3_Abs.

When used with its default setting, this parameter will ensure that the absolute value initialization “starts up with plus-minus”. I.e. the encoder’s multi-turn value range from 0 to max will be mapped to -½ max to +½ max. The range from +½ max to max will be initialized as negative; in this case, the point of discontinuity will be found at ½ max. This can be changed with MTBase. When MTBase = 0, the absolute value initialization will, for example, “start up with zero to max”. I.e. the encoder’s multi-turn value range from 0 to max will be mapped to 0 to max. The range from +½ max to max will be initialized as positive; in this case, the point of discontinuity will be found at 0.

l P 585[0] - ENC_CH3_MTEnable

If you set MTEnable to 1, you can use an available multi-turn rotary encoder as a single-turn rotary encoder, which can come in handy for testing purposes.

|P No.|Index|Name / Setting|Unit|Description|
|---|---|---|---|---|
|507|0|ENC_CH3_Sel| |Main selection on encoder channel Ch3|
|570|0|ENC_CH3_Abs| |Absolute value interface for one-time reading|
|572|0|ENC_CH3_Lines| |Number of analog Sin/Cos lines per revolution (TTL lines as well)|
|573|0|ENC_CH3_MultiT| |Number of multi-turn bits for the digital interface|
|574|0|ENC_CH3_SingleT| |Number of single-turn bits for the digital interface|
|575|0|ENC_CH3_Code| |Code selection (for SSI encoders) (binary, Gray)|
|576|0|ENC_CH3_Mode| |Mode selection (for SSI encoders)|
|583|0|ENC_CH3_|nm|Linear encoders: Length of a digital increment in|
|584|0|DigitalResolution|nm (nanometres)| |
|585|0|ENC_CH3_MTBase| |Definition of point of discontinuity in multi-turn range|
|636|0|ENC_CH3_MTEnable| |Enable MultiTurn use (negative logic, 1=MToff)|
|636|0|ENC_CH3_CycleCount| |Sampling cycle in: n x 125 μ (microseconds)|

NOTE: As there are various protocol modes available for SSI encoders (with/without wire break monitoring, with/without parity bit, etc.), consult with your project supervisor or the Helpline provided by Moog before using any special SSI protocol modes.

As the functionality of the parameters for encoder channel Ch3 is predominantly identical to that of the parameters for encoder channel Ch1, it is recommended to read the description for the Ch1 encoder channel parameters.

Accordingly, the following table starts by listing all the parameters for the Ch3 encoder channel. If the functionality of a parameter is different from that of the corresponding parameter for encoder channel Ch1, the parameter will be described in the chapters that go over selecting a special encoder with (507) ENC_CH3_Sel and (570) ENC_CH3_Abs.

Parameters Lines, MultiT, SingleT, etc. are self-explanatory. Most of the following parameters are explained in the information for encoder channel Ch1 (see Section ""Channel 1: Interface X7"" on page 59).

# Table 6.21: Encoder configuration channel 3 (X8) parameters

|ID|Index|Name|Unit|Description|
|---|---|---|---|---|
|349|0|CON_FM_MConOffset| |Commutation offset|
|502|0..3|ENC_CH3_ActVal| |Current position value at encoder channel Ch3 output|
|507|0|ENC_CH3_Sel| |Main selection on encoder channel Ch3|
|514|0|ENC_CH3_Num| |Encoder gearing: Numerator|
|515|0|ENC_CH3_Denom| |Encoder gearing: Denominator|
|520|0|ENC_MCon| |=3, channel selection for motor commutation|
|521|0|ENC_SCon| |=3, channel selection for speed control|
|522|0|ENC_PCon| |=3, channel selection for position control|
|570|0|ENC_CH3_Abs| |Absolute value interface selection (one-time reading)|
|571|0|ENC_CH3_NpTest| |TEST-MODE: Index pulse signal(s) to Scope|
|572|0|ENC_CH3_Lines| |Number of Lines (Sin/Cos / TTL encoders)|
|573|0|ENC_CH3_MultiT| |Number of MultiTurn bits (absolute encoder)|
|574|0|ENC_CH3_SingleT| |Number of SingleTurn bits (absolute encoder)|
|574|0|ENC_CH3_Code| |Code selection (SSI encoder) (binary, gray)|
|576|0|ENC_CH3_Mode| |Mode selection (SSI encoder)|
|577|0|ENC_CH3_EncObsMin| |Encoder monitoring minimum, sqrt (a^2+b^2)|
|578|0|ENC_CH3_Extended| |(a^2 + b^2) ENC CH3: Extended|
|580|0|ENC_CH3_Info| |Encoder information channel 3|
|581|0|ENC_CH3_AbsEncStatus| |Error and status codes (absolute encoder)|
|582|0|ENC_CH3_PeriodLen|nm|Length of signal period (Sin/Cos linear encoder)|

# Encoder configuration channel 3 (X8) parameters (continue)

|Index|Name|Unit|Description|
|---|---|---|---|
|0|ENC_CH3_|nm|Length of one increment (linear absolute encoder)|
|0|DigitalResolution| | |
|0|ENC_CH3_MTBase| |Definition of point of discontinuity in multi-turn range|
|0|ENC_CH3_MTEnable| |Enable MultiTurn use (negative logic, 1=MToff)|
|0|ENC_CH3_Corr| |Signal correction type|
|0..4|ENC_CH3_CorrVal| |Signal correction values|
|0|ENC_CH3_EncObsAct| |Amplitude of analog signals (vector length)|
|0|ENC_CH3_HallLayout| |Hall pattern selection|
|0|ENC_CH3_Position|inc|Position encoder channel 3|
|0|ENC_CH3_Period|ms|Maximum period of interpolation (ttl encoder)|
|0|ENC_CH3_EncOnsActTF|ms|Filter time constant for amplitude of analog signals|
|0|ENC_CH3_|Sign.|Nominal increment A (distance coded abs. encoder)|
|0|ENC_CH3_|Sign.|Nominal increment B (distance coded abs. encoder)|
|0|ENC_CH3_CycleCount| |Position encoder sampling cycle (n x 125 μsec)|
|0|ENC_CH3_AbsInitMode| |Mode absolute value formation|
|0..29|ENC_ENDAT| |EnDat additional|
|0|ENC_Warning| |Encoder warning (e.g. from encoder internal memory)|
|0|ENC_Warning| |Encoder warning reset (e.g. in encoder internal memory)|
|0|ENC_Error| |Encoder error (e.g. from encoder internal memory)|
|0|ENC_ErrorReset| |Encoder error reset (e.g. in encoder internal memory)|
|0|ENC_ETS| |ETS mode, electronic nameplate|
|0|ENC_ETS_CTRL| |ETS control, electronic nameplate|
|0..15|ENC_ETS_STAT| |ETS status, electronic nameplate|
|0..511|ENC_ETS_DATA| |ETS data, electronic nameplate|
|0|ENC_CH3_TTL_| |TTL signal type selection|

# 6 Encoder

MOOG ID No.:CB40859-001 Date:11/2020

# 6.7.2 Absolute value interfaces X8

The following absolute value interfaces will be available at encoder channel Ch3 depending on the X8 option being used.

- Cyclical Sin/Cos with SSI one-time reading via X8 option: SINCOS_V2(10) - 2nd Sin/Cos encoder (V2)
- Cyclical Sin/Cos with EnDat one-time reading via X8 option: SINCOS_V2(10) - 2nd Sin/Cos encoder (V2)
- Cyclical SSI via X8 options: SINCOS_V2(10) - 2nd Sin/Cos encoder (V2) or SSI_ECSIM(3) - SSI encoder simulation
- Cyclical EnDat via X8 option: SINCOS_V2(10) - 2nd Sin/Cos encoder (V2)

See also table in Section ""Channel 3: Interface X8 (optional)"" on page 76. They can be selected with P 507[0] - ENC_CH3_Sel and P 570[0] - ENC_CH3_Abs. For more details, see Section ""Main parameters for encoder channel Ch3"" on page 80.

# 6.7.3 EnDat (cyclical) X8

Ch3: ENDAT(4) - Cyclical EnDat (2.1 or 2.2)

As the EnDat functionality of the parameters for encoder channel Ch3 is predominantly identical to that of the parameters for encoder channel Ch1, it is recommended to read the description for the Ch1 encoder channel parameters (see Section ""EnDat (cyclical) X7"" on page 61).

The software versions required to run the EnDat interface are the standard software versions for the MSD Servo Drive and MSD Single-Axis Servo Drive Compact.

NOTE

- Please note the limitations that apply when running EnDat and SSI encoders (see Section ""Limiting for EnDat and SSI"" on page 52).

|ID|Index|Name|Unit|Description|
|---|---|---|---|---|
|507|0|ENC_CH3_Sel|= 4|= ENDAT(4)|
|573|0|ENC_CH3_MultiT|Number of MultiTurn bits (absolute encoder)| |
|574|0|ENC_CH3_SingleT|Number of SingleTurn bits (absolute encoder)| |
|584|0|ENC_CH3_MTBase|Definition of point of discontinuity in multi-turn| |
|585|0|ENC_CH3_MTEnable|range|1: Use Multi-turn encoder as a single-turn encoder|
|636|0|ENC_CH3_CycleCount|Position encoder sampling cycle (n x 125 μsec)| |
|600|0|ENC_CH3_Position|inc|Position encoder channel 3|
|583|0|ENC_CH3_|nm|Length of one increment (linear absolute encoder)|
|640|0..29|DigitalResolution| | |

Table 6.22: ENC_ENDAT Channel 3 encoder configuration (X8) - EnDat (cyclical) parameters

# 6.7.4 Hall sensor X8

Encoder channel Ch3 does not support Hall effect sensors!

# 6.7.5 Sin/Cos / TTL X8

# 6.7.5.1 TTL encoder

Ch3: TTL(3) - TTL signals

TTL encoders are ...

1. ... usually pure incremental encoders without an absolute value interface. In this case, P 570[0] - ENC_CH3_Abs must be set to OFF(0).
2. ... in a few exceptional cases, incremental encoders with an SSI absolute value interface. In this case, P 570[0] - ENC_CH3_Abs must be accordingly set to SSI(1) so that it will be possible to read the absolute encoder position for the absolute value initialization routine once during the initialization phase.

# 6.7.5.1.1 Pure TTL incremental encoder

A maximum interpolation period, in ms (milliseconds), can be configured for the TTL interface using P 602[0] - ENC_CH3_Period. Within this context, Period is the maximum time of “no activity” since the last TTL counter event:

- Period = 0: Function disabled (default)
- Period > 0 (=n ms): If no counter event is registered in n ms, the speed will be set to 0.

# Zero pulse

There is no parameter for activating the zero pulse evaluation here, as this evaluation is controlled based exclusively on the homing mode (see Section ""Homing"" on page 249). However, setting P 571[0] - ENC_CH3_NpTest to 1 provides a test mode that can be used during commissioning in order to be able to activate the zero pulse evaluation even without homing. Scope signals 1034 and 1036 can be used to view a received zero pulse within this context. This test mode must be disabled during normal operation (P 571[0] = 0).

# Commutation

Motor operation with pure incremental encoders needs for the auto commutation function to be enabled without fail. For details see Section ""Synchronous motor auto commutation"" on page 156.

# 6.7.5.1.2 TTL incremental encoder with SSI absolute value interface

see Section ""Sin/Cos incremental encoders with absolute value interface"" on page 84 and in special Section ""SSI absolute value interface"" on page 86.

MOOG ID No.:CB40859-001 Date:11/2020

MSD ServoDrive - DeviceHelp

# 6 Encoder

MOOG ID No.:CB40859-001 Date:11/2020

MSD ServoDrive - DeviceHelp 84

|ID|Index Name|Unit|Description|
|---|---|---|---|
|507|0|ENC_CH3_Sel = 3|Encoder selection set to TTL(3)|
|514|0|ENC_CH3_Num|Encoder gearing: Numerator|
|515|0|ENC_CH3_Denom|Encoder gearing: Denominator|
|570|0|ENC_CH3_Abs|Selection of absolute value interface|
|571|0|ENC_CH3_NpTest|ENC CH1, TEST-MODE: Index pulse signal(s) to Scope|
|572|0|ENC_CH3_Lines|Number of lines (Sin/Cos / TTL encoders)|
|2842|0|ENC_CH3_TTL_SignalType|Channel 3: TTL signal selection|
|602|0|ENC_CH3_Period|Maximum period of interpolation (ttl encoder)|
|636|0|ENC_CH3_CycleCount|Sampling cycle in: n x 125 μ (microseconds)|

# Table 6.23: Parameters for Channel 3 (X8) - TTL encoder

6.7.5.2.2 Linear Sin/Cos incremental encoders

Linear Sin/Cos encoders are operated as rotary encoders. For linear motor operation, P 572[0] - ENC_CH3_Lines and the encoder gearing (see Section ""Encoder gearing"" on page 89) are used to establish the ratio for the linear motor’s pole pair subdivision (North-North) for commutation. 1 x North-North corresponds to one revolution from Lines. In this case, the motor pole pair number must be set to 1. P 582[0] - ENC_CH3_PeriodLen is not used in this case.

# 6.7.5.2 Sin/Cos encoder

Ch3: SINCOS(1) - Sin/Cos signals

Sin/Cos encoders can ...

1. Be pure incremental encoders without an absolute value interface. In this case, P 570[0] - ENC_CH3_Abs must be set to OFF(0).
2. Be incremental encoders with an absolute value interface. In this case, P 570[0] - ENC_CH3_Abs must be accordingly set to SSI(1) or EnDat(2) so that it will be possible to read the absolute encoder position for the absolute value initialization routine once during the initialization phase.

# 6.7.5.2.1 Purely Sin/Cos incremental encoders

To run these encoders as pure incremental encoders with a zero pulse on encoder channel Ch3 (without an absolute value interface), the approach is basically the same as for pure TTL operation (see Section ""TTL encoder"" on page 82). The same parameters apply. However, there are the following differences:

# 6.7.5.2.4 Sin/Cos incremental encoders with absolute value interface

The following table lists the parameters for cyclical Sin/Cos operation on encoder channel Ch 3 with one-time reading of the absolute encoder position via the absolute value interface, i.e. without a zero pulse:

|ID|Index Name|Unit|Description|
|---|---|---|---|
|507|ENC_CH3_Sel|1|Encoder selection set to SINCOS(1)|
|514|ENC_CH3_Num| |Encoder gearing: Numerator|
|515|ENC_CH3_Denom| |Encoder gearing: Denominator|
|570|ENC_CH3_Abs| |Absolute value interface selection (one-time reading)|
|572|ENC_CH3_Lines| |Number of Lines (Sin/Cos / TTL encoders)|
|573|ENC_CH3_MultiT| |Number of MultiTurn bits (absolute encoder)|
|574|ENC_CH3_SingleT| |Number of SingleTurn bits (absolute encoder)|
|575|ENC_CH3_Code| |Code selection (SSI encoder) (binary, gray)|
|576|ENC_CH3_Mode| |Mode selection (SSI encoder)|
|584|ENC_CH3_MTBase| |Definition of point of discontinuity in multi-turn range|
|585|ENC_CH3_MTEnable| |Enable MultiTurn use (negative logic, 1=MToff)|
|586|ENC_CH3_Corr| |Signal correction type|
|587|ENC_CH3_CorrVal| |Signal correction values|
|577|ENC_CH3_EncObsMin| |Encoder monitoring minimum, sqrt(a^2+b^2)|
|581|ENC_CH3_AbsEncStatus| |Error and status codes (absolute encoder)|
|582|ENC_CH3_PeriodLen|nm|Length of signal period (Sin/Cos linear encoder)|
|583|ENC_CH3_DigitalResolution|nm|Length of one increment (linear absolute encoder)|
|636|ENC_CH3_CycleCount| |Sampling cycle in: n x 125 μ (microseconds)|
|639|ENC_CH3_NominalincrementA| |Sign. Nominal increment A (distance coded abs. encoder)|
|637|ENC_CH3_NominalincrementB| |Sign. Nominal increment B (distance coded abs. encoder)|

# Table 6.24: Parameters for channel 3 (X8) - Sin/Cos encoder

Some parameters (e.g. Sel, Num, Denom, Abs, Lines, MultiT, SingleT, CorrVal) are self-explanatory.

The Code and Mode parameters are described in Section ""SSI (cyclical) X7"" on page 69.

P 584[0] - ENC_CH3_MTBase = Minimum MultiTurn position

The MTBase parameter is used to set a position in the multi-turn encoder’s travel path that defines the point of discontinuity (overflow/underflow) for the absolute value initialization (that is, the “multi-turn basis”). Assuming a bipolar encoder measuring range, all position values that fall below MTBase will be shifted “up” (the whole MT range will be added to them once). This method makes it possible to place the point of discontinuity at any point within the encoder’s entire measuring range. By default, MTBase will be set to the lowest possible value for the parameter, i.e. reliably outside of the encoder’s value range: In this case, the full bipolar range will remain unaffected, as values will never fall below this MTBase threshold (see Section ""Channel 3: Interface X8 (optional)"" on page 76 as well).

P 585[0] - ENC_CH3_MTEnable = MultiTurn as SingleTurn

The MTEnable parameter makes it possible to use multi-turn encoders as single-turn encoders for test purposes. Negative logic: Default MTEnable = 0 means ""MultiTurn-Enable ON"".

P 586[0] - ENC_CH3_Corr = Signal correction type:

The GPOC routine used for track signal correction purposes for sine/cosine signals is used to compensate for systematic errors. The routine is controlled with the Corr and CorrVal parameters (see Section ""Signal correction GPOC (Gain Phase Offset Correction)"" on page 74).

P 577[0] - ENC_CH3_EncObsMin = Encoder monitoring minimum, sqrt(a^2+b^2)

The parameter EncObsMin is used to scale the Sin/Cos wire break monitoring and represents the “downwards threshold” for an error message. The default setting is 0.2, corresponding to approx. ",What is the significance of the 'Pulses Per Revolution' field in the encoder configuration for channel Ch3?,"This field appears when SINCOS(1), TTL(3), or TTL_COM(5) is selected as the 'main interface', allowing entry of the number of analog Sin/Cos or TTL tracks per revolution.","It enables specifying the number of analog Sin/Cos or TTL tracks per revolution for encoders selected via SINCOS(1), TTL(3), or TTL_COM(5) as the main interface.",The 'Pulses Per Revolution' field is used to input the count of analog tracks per revolution for certain encoder types selected on the main interface.,"For encoders with SINCOS(1), TTL(3), or TTL_COM(5) as the main interface, this field sets the analog tracks per revolution.","It specifies the analog Sin/Cos or TTL tracks per revolution for encoders chosen through the main interface options SINCOS(1), TTL(3), or TTL_COM(5)."
6,msd_servo_drive.txt,29,8b7b14207d0506f3f75c9a63fb98a68193e71ed0f7337bac8f26cb3596e2b576,"3: “TTL encoder simulation / TTL master encoder”
- No. 4: “SSI encoder simulation”
- No. 5: “TTL encoder with commutation signals”

NOTE

- For information on the connector, pinout, technical data, configuration, and the encoder models (if any) that can be evaluated with the included technology option, please consult the Specification specified in the “Documentation” column.

The following table shows how the X8 options that can be used for encoder evaluation can be identified and selected.

|“No.” column|As per the table above.|
|---|---|
|“Hardware ID” column|The texts in this column can be viewed in the Moog DRIVEADMINISTRATOR 5 using P 53[0] - DV_HwOptionX12ID by going to ►Drive description ►Hardware version if the corresponding technology option is present.|
|“Selection” column|In certain cases, several different encoder types can be run on a technology option and selected with P 507 - ENC_CH3_Sel. Even if a technology option that does not match is equipped, most values can only be selected with P 507 - ENC_CH3_Sel. If an impermissible combination is selected, this will be indicated by means of error messages during the initialization phase.|

MOOG ID No.:CB40859-001 Date:11/2020

MSD ServoDrive - DeviceHelp 77

# 6 Encoder

MOOG ID No.:CB40859-001 Date:11/2020

# MSD ServoDrive - DeviceHelp

|No.|Technology option name|Hardware ID|Selection|
|---|---|---|---|
|0|No module|NONE(0) - No technology option|OFF (0)|
| | |SINCOS(1) - Sin/Cos cyclic *)| |
| | |- Without absolute value interface, Abs=OFF(0), with zero pulse| |
| | |- With SSI one-time reading, Abs=SSI(1)| |
|1|Second Sin/Cos encoder|SINCOS_V2(10) - 2nd Sin/Cos encoder (V2)|- With EnDat one-time reading, Abs=ENDAT(2)|
| | |SSI(2) - Cyclical SSI (without analog tracks)| |
| | |TTL(3) - TTL evaluation, with zero pulse| |
| | |ENDAT(4) - Cyclical EnDat (without analog tracks)| |
|3|TTL encoder simulation / TTL master encoder|TTL_ECSIM_V2(9) - TTL Encodersimulation (V2)|TTL(3)|
|4|SSI encoder simulation|SSI_ECSIM(3) - SSI encodersimulation|SSI(2) - Cyclical SSI (without analog tracks)|
|5|TTL encoder with commutation signals|TTL_COM(11) - TTL + Hall option|TTL(3)|
| | |TTL_COM(5)| |

Table 6.19: Options for X8 interface that can be used to evaluate encoders via encoder channel Ch3

*) SINCOS(1) is set via the P 507[0] - ENC_CH3_Sel main interface. The auxiliary interface, P 570[0] - ENC_CH3_Abs, can be optionally used to set the one-time reading for the absolute position during initialization.

# NOTE

- Only one encoder with a purely digital EnDat or SSI interface can be used on connector X8 or X7.
- If two EnDat encoders are used and one of them is purely digital, it is necessary to ensure that the purely digital encoder is connected to X8. This is important, as the EnDat encoder with Sin/Cos tracks must be initialized before the purely digital encoder.

# Encoder Configuration

To see which technology option your Servo Drive features (if any), go to Project Select from database tree ► Device setup ► Drive description in Moog DRIVEADMINISTRATOR 5 and check under “Technology option” in the “Hardware” section.

# Encoder Name

You can use this field to enter your own information for describing the encoder (maximum of 31 characters) (P 580[0] - ENC_CH3_Info).

# Cyclic Position Via

This drop-down menu is used to select the “main interface” (P 507[0] - ENC_CH3_Sel).

# Pulses Per Revolution

Once SINCOS(1), TTL(3) or TTL_COM(5) is selected as the “main interface,” this field will appear so that you can enter the number of analog Sin/Cos tracks per revolution (TTL tracks as well).

# Absolute Interface

This drop-down menu is used to select the “auxiliary interface” (P 570[0] - ENC_CH3_Abs).

# Image 6.5: Encoder Configuration Channel 3 (X8) Screen

This screen is used to select the encoder for channel Ch3. This channel uses the encoder’s “main interface” to measure position changes periodically and add them up cyclically – this is referred to as “cyclical evaluation.”

Encoders with a main interface that only makes it possible to measure the cyclical position incrementally often feature an additional absolute value interface referred to as an “auxiliary interface.” For this interface, the absolute position is measured once during the initialization phase and is then used for absolute value initialization purposes.

# Note

l Selecting an “auxiliary interface” is redundant if, for example, SSI (2) is selected as the “main interface” (corresponds to cyclical evaluation via SSI). In this case, the absolute value initialization will also be carried out via the SSI interface, regardless of the selected “auxiliary interface.”

# Gear Ratio

These fields can be used to define a gear ratio for the encoder (in the output side). For more details, see Section ""Encoder gearing"" on page 89.

MOOG ID No.:CB40859-001 Date:11/2020

MSD ServoDrive - DeviceHelp 79

# 6 Encoder

MOOG ID No.:CB40859-001 Date:11/2020

# MSD ServoDrive - DeviceHelp

Signal correction (GPOC) l P 577[0] - ENC_CH3_EncObsMin

If you set EncObsMin to 0, Sin/Cos wire break monitoring will be disabled.

GPOC is a special Moog online process for improving the quality of Sin/Cos signals before they are used to calculate a position. If “SINCOS(1)” is selected as the “main interface,” this process may be useful. For details see Section ""Signal correction GPOC (Gain Phase Offset Correction)"" on page 74.

The default value is 0.2 (20%) and stands for a calculated amplitude value (calculated using the two Sin/Cos signals) of x = sqrt(a² + b²). If the Sin/Cos signals are equal to approx. 1 Vss when compared, approx. 0.8 will be calculated here (approx. 80% magnitude at the A-D converters; approx. 0.25 Vss Sin/Cos will yield approx. 0.2 here (20% magnitude at the A-D converter)). The error threshold can be adjusted with EncObsMin.

# 6.7.1 Main parameters for encoder channel Ch3

The following table lists the most important parameters for the Ch3 encoder channel. These parameters are described in the chapters that go over selecting the various encoders with P 507[0] - ENC_CH3_Sel and P 570[0] - ENC_CH3_Abs.

When used with its default setting, this parameter will ensure that the absolute value initialization “starts up with plus-minus”. I.e. the encoder’s multi-turn value range from 0 to max will be mapped to -½ max to +½ max. The range from +½ max to max will be initialized as negative; in this case, the point of discontinuity will be found at ½ max. This can be changed with MTBase. When MTBase = 0, the absolute value initialization will, for example, “start up with zero to max”. I.e. the encoder’s multi-turn value range from 0 to max will be mapped to 0 to max. The range from +½ max to max will be initialized as positive; in this case, the point of discontinuity will be found at 0.

l P 585[0] - ENC_CH3_MTEnable

If you set MTEnable to 1, you can use an available multi-turn rotary encoder as a single-turn rotary encoder, which can come in handy for testing purposes.

|P No.|Index|Name / Setting|Unit|Description|
|---|---|---|---|---|
|507|0|ENC_CH3_Sel| |Main selection on encoder channel Ch3|
|570|0|ENC_CH3_Abs| |Absolute value interface for one-time reading|
|572|0|ENC_CH3_Lines| |Number of analog Sin/Cos lines per revolution (TTL lines as well)|
|573|0|ENC_CH3_MultiT| |Number of multi-turn bits for the digital interface|
|574|0|ENC_CH3_SingleT| |Number of single-turn bits for the digital interface|
|575|0|ENC_CH3_Code| |Code selection (for SSI encoders) (binary, Gray)|
|576|0|ENC_CH3_Mode| |Mode selection (for SSI encoders)|
|583|0|ENC_CH3_|nm|Linear encoders: Length of a digital increment in|
|584|0|DigitalResolution|nm (nanometres)| |
|585|0|ENC_CH3_MTBase| |Definition of point of discontinuity in multi-turn range|
|636|0|ENC_CH3_MTEnable| |Enable MultiTurn use (negative logic, 1=MToff)|
|636|0|ENC_CH3_CycleCount| |Sampling cycle in: n x 125 μ (microseconds)|

NOTE: As there are various protocol modes available for SSI encoders (with/without wire break monitoring, with/without parity bit, etc.), consult with your project supervisor or the Helpline provided by Moog before using any special SSI protocol modes.

As the functionality of the parameters for encoder channel Ch3 is predominantly identical to that of the parameters for encoder channel Ch1, it is recommended to read the description for the Ch1 encoder channel parameters.

Accordingly, the following table starts by listing all the parameters for the Ch3 encoder channel. If the functionality of a parameter is different from that of the corresponding parameter for encoder channel Ch1, the parameter will be described in the chapters that go over selecting a special encoder with (507) ENC_CH3_Sel and (570) ENC_CH3_Abs.

Parameters Lines, MultiT, SingleT, etc. are self-explanatory. Most of the following parameters are explained in the information for encoder channel Ch1 (see Section ""Channel 1: Interface X7"" on page 59).

# Table 6.21: Encoder configuration channel 3 (X8) parameters

|ID|Index|Name|Unit|Description|
|---|---|---|---|---|
|349|0|CON_FM_MConOffset| |Commutation offset|
|502|0..3|ENC_CH3_ActVal| |Current position value at encoder channel Ch3 output|
|507|0|ENC_CH3_Sel| |Main selection on encoder channel Ch3|
|514|0|ENC_CH3_Num| |Encoder gearing: Numerator|
|515|0|ENC_CH3_Denom| |Encoder gearing: Denominator|
|520|0|ENC_MCon| |=3, channel selection for motor commutation|
|521|0|ENC_SCon| |=3, channel selection for speed control|
|522|0|ENC_PCon| |=3, channel selection for position control|
|570|0|ENC_CH3_Abs| |Absolute value interface selection (one-time reading)|
|571|0|ENC_CH3_NpTest| |TEST-MODE: Index pulse signal(s) to Scope|
|572|0|ENC_CH3_Lines| |Number of Lines (Sin/Cos / TTL encoders)|
|573|0|ENC_CH3_MultiT| |Number of MultiTurn bits (absolute encoder)|
|574|0|ENC_CH3_SingleT| |Number of SingleTurn bits (absolute encoder)|
|574|0|ENC_CH3_Code| |Code selection (SSI encoder) (binary, gray)|
|576|0|ENC_CH3_Mode| |Mode selection (SSI encoder)|
|577|0|ENC_CH3_EncObsMin| |Encoder monitoring minimum, sqrt (a^2+b^2)|
|578|0|ENC_CH3_Extended| |(a^2 + b^2) ENC CH3: Extended|
|580|0|ENC_CH3_Info| |Encoder information channel 3|
|581|0|ENC_CH3_AbsEncStatus| |Error and status codes (absolute encoder)|
|582|0|ENC_CH3_PeriodLen|nm|Length of signal period (Sin/Cos linear encoder)|

# Encoder configuration channel 3 (X8) parameters (continue)

|Index|Name|Unit|Description|
|---|---|---|---|
|0|ENC_CH3_|nm|Length of one increment (linear absolute encoder)|
|0|DigitalResolution| | |
|0|ENC_CH3_MTBase| |Definition of point of discontinuity in multi-turn range|
|0|ENC_CH3_MTEnable| |Enable MultiTurn use (negative logic, 1=MToff)|
|0|ENC_CH3_Corr| |Signal correction type|
|0..4|ENC_CH3_CorrVal| |Signal correction values|
|0|ENC_CH3_EncObsAct| |Amplitude of analog signals (vector length)|
|0|ENC_CH3_HallLayout| |Hall pattern selection|
|0|ENC_CH3_Position|inc|Position encoder channel 3|
|0|ENC_CH3_Period|ms|Maximum period of interpolation (ttl encoder)|
|0|ENC_CH3_EncOnsActTF|ms|Filter time constant for amplitude of analog signals|
|0|ENC_CH3_|Sign.|Nominal increment A (distance coded abs. encoder)|
|0|ENC_CH3_|Sign.|Nominal increment B (distance coded abs. encoder)|
|0|ENC_CH3_CycleCount| |Position encoder sampling cycle (n x 125 μsec)|
|0|ENC_CH3_AbsInitMode| |Mode absolute value formation|
|0..29|ENC_ENDAT| |EnDat additional|
|0|ENC_Warning| |Encoder warning (e.g. from encoder internal memory)|
|0|ENC_Warning| |Encoder warning reset (e.g. in encoder internal memory)|
|0|ENC_Error| |Encoder error (e.g. from encoder internal memory)|
|0|ENC_ErrorReset| |Encoder error reset (e.g. in encoder internal memory)|
|0|ENC_ETS| |ETS mode, electronic nameplate|
|0|ENC_ETS_CTRL| |ETS control, electronic nameplate|
|0..15|ENC_ETS_STAT| |ETS status, electronic nameplate|
|0..511|ENC_ETS_DATA| |ETS data, electronic nameplate|
|0|ENC_CH3_TTL_| |TTL signal type selection|

# 6 Encoder

MOOG ID No.:CB40859-001 Date:11/2020

# 6.7.2 Absolute value interfaces X8

The following absolute value interfaces will be available at encoder channel Ch3 depending on the X8 option being used.

- Cyclical Sin/Cos with SSI one-time reading via X8 option: SINCOS_V2(10) - 2nd Sin/Cos encoder (V2)
- Cyclical Sin/Cos with EnDat one-time reading via X8 option: SINCOS_V2(10) - 2nd Sin/Cos encoder (V2)
- Cyclical SSI via X8 options: SINCOS_V2(10) - 2nd Sin/Cos encoder (V2) or SSI_ECSIM(3) - SSI encoder simulation
- Cyclical EnDat via X8 option: SINCOS_V2(10) - 2nd Sin/Cos encoder (V2)

See also table in Section ""Channel 3: Interface X8 (optional)"" on page 76. They can be selected with P 507[0] - ENC_CH3_Sel and P 570[0] - ENC_CH3_Abs. For more details, see Section ""Main parameters for encoder channel Ch3"" on page 80.

# 6.7.3 EnDat (cyclical) X8

Ch3: ENDAT(4) - Cyclical EnDat (2.1 or 2.2)

As the EnDat functionality of the parameters for encoder channel Ch3 is predominantly identical to that of the parameters for encoder channel Ch1, it is recommended to read the description for the Ch1 encoder channel parameters (see Section ""EnDat (cyclical) X7"" on page 61).

The software versions required to run the EnDat interface are the standard software versions for the MSD Servo Drive and MSD Single-Axis Servo Drive Compact.

NOTE

- Please note the limitations that apply when running EnDat and SSI encoders (see Section ""Limiting for EnDat and SSI"" on page 52).

|ID|Index|Name|Unit|Description|
|---|---|---|---|---|
|507|0|ENC_CH3_Sel|= 4|= ENDAT(4)|
|573|0|ENC_CH3_MultiT|Number of MultiTurn bits (absolute encoder)| |
|574|0|ENC_CH3_SingleT|Number of SingleTurn bits (absolute encoder)| |
|584|0|ENC_CH3_MTBase|Definition of point of discontinuity in multi-turn| |
|585|0|ENC_CH3_MTEnable|range|1: Use Multi-turn encoder as a single-turn encoder|
|636|0|ENC_CH3_CycleCount|Position encoder sampling cycle (n x 125 μsec)| |
|600|0|ENC_CH3_Position|inc|Position encoder channel 3|
|583|0|ENC_CH3_|nm|Length of one increment (linear absolute encoder)|
|640|0..29|DigitalResolution| | |

Table 6.22: ENC_ENDAT Channel 3 encoder configuration (X8) - EnDat (cyclical) parameters

# 6.7.4 Hall sensor X8

Encoder channel Ch3 does not support Hall effect sensors!

# 6.7.5 Sin/Cos / TTL X8

# 6.7.5.1 TTL encoder

Ch3: TTL(3) - TTL signals

TTL encoders are ...

1. ... usually pure incremental encoders without an absolute value interface. In this case, P 570[0] - ENC_CH3_Abs must be set to OFF(0).
2. ... in a few exceptional cases, incremental encoders with an SSI absolute value interface. In this case, P 570[0] - ENC_CH3_Abs must be accordingly set to SSI(1) so that it will be possible to read the absolute encoder position for the absolute value initialization routine once during the initialization phase.

# 6.7.5.1.1 Pure TTL incremental encoder

A maximum interpolation period, in ms (milliseconds), can be configured for the TTL interface using P 602[0] - ENC_CH3_Period. Within this context, Period is the maximum time of “no activity” since the last TTL counter event:

- Period = 0: Function disabled (default)
- Period > 0 (=n ms): If no counter event is registered in n ms, the speed will be set to 0.

# Zero pulse

There is no parameter for activating the zero pulse evaluation here, as this evaluation is controlled based exclusively on the homing mode (see Section ""Homing"" on page 249). However, setting P 571[0] - ENC_CH3_NpTest to 1 provides a test mode that can be used during commissioning in order to be able to activate the zero pulse evaluation even without homing. Scope signals 1034 and 1036 can be used to view a received zero pulse within this context. This test mode must be disabled during normal operation (P 571[0] = 0).

# Commutation

Motor operation with pure incremental encoders needs for the auto commutation function to be enabled without fail. For details see Section ""Synchronous motor auto commutation"" on page 156.

# 6.7.5.1.2 TTL incremental encoder with SSI absolute value interface

see Section ""Sin/Cos incremental encoders with absolute value interface"" on page 84 and in special Section ""SSI absolute value interface"" on page 86.

MOOG ID No.:CB40859-001 Date:11/2020

MSD ServoDrive - DeviceHelp

# 6 Encoder

MOOG ID No.:CB40859-001 Date:11/2020

MSD ServoDrive - DeviceHelp 84

|ID|Index Name|Unit|Description|
|---|---|---|---|
|507|0|ENC_CH3_Sel = 3|Encoder selection set to TTL(3)|
|514|0|ENC_CH3_Num|Encoder gearing: Numerator|
|515|0|ENC_CH3_Denom|Encoder gearing: Denominator|
|570|0|ENC_CH3_Abs|Selection of absolute value interface|
|571|0|ENC_CH3_NpTest|ENC CH1, TEST-MODE: Index pulse signal(s) to Scope|
|572|0|ENC_CH3_Lines|Number of lines (Sin/Cos / TTL encoders)|
|2842|0|ENC_CH3_TTL_SignalType|Channel 3: TTL signal selection|
|602|0|ENC_CH3_Period|Maximum period of interpolation (ttl encoder)|
|636|0|ENC_CH3_CycleCount|Sampling cycle in: n x 125 μ (microseconds)|

# Table 6.23: Parameters for Channel 3 (X8) - TTL encoder

6.7.5.2.2 Linear Sin/Cos incremental encoders

Linear Sin/Cos encoders are operated as rotary encoders. For linear motor operation, P 572[0] - ENC_CH3_Lines and the encoder gearing (see Section ""Encoder gearing"" on page 89) are used to establish the ratio for the linear motor’s pole pair subdivision (North-North) for commutation. 1 x North-North corresponds to one revolution from Lines. In this case, the motor pole pair number must be set to 1. P 582[0] - ENC_CH3_PeriodLen is not used in this case.

# 6.7.5.2 Sin/Cos encoder

Ch3: SINCOS(1) - Sin/Cos signals

Sin/Cos encoders can ...

1. Be pure incremental encoders without an absolute value interface. In this case, P 570[0] - ENC_CH3_Abs must be set to OFF(0).
2. Be incremental encoders with an absolute value interface. In this case, P 570[0] - ENC_CH3_Abs must be accordingly set to SSI(1) or EnDat(2) so that it will be possible to read the absolute encoder position for the absolute value initialization routine once during the initialization phase.

# 6.7.5.2.1 Purely Sin/Cos incremental encoders

To run these encoders as pure incremental encoders with a zero pulse on encoder channel Ch3 (without an absolute value interface), the approach is basically the same as for pure TTL operation (see Section ""TTL encoder"" on page 82). The same parameters apply. However, there are the following differences:

# 6.7.5.2.4 Sin/Cos incremental encoders with absolute value interface

The following table lists the parameters for cyclical Sin/Cos operation on encoder channel Ch 3 with one-time reading of the absolute encoder position via the absolute value interface, i.e. without a zero pulse:

|ID|Index Name|Unit|Description|
|---|---|---|---|
|507|ENC_CH3_Sel|1|Encoder selection set to SINCOS(1)|
|514|ENC_CH3_Num| |Encoder gearing: Numerator|
|515|ENC_CH3_Denom| |Encoder gearing: Denominator|
|570|ENC_CH3_Abs| |Absolute value interface selection (one-time reading)|
|572|ENC_CH3_Lines| |Number of Lines (Sin/Cos / TTL encoders)|
|573|ENC_CH3_MultiT| |Number of MultiTurn bits (absolute encoder)|
|574|ENC_CH3_SingleT| |Number of SingleTurn bits (absolute encoder)|
|575|ENC_CH3_Code| |Code selection (SSI encoder) (binary, gray)|
|576|ENC_CH3_Mode| |Mode selection (SSI encoder)|
|584|ENC_CH3_MTBase| |Definition of point of discontinuity in multi-turn range|
|585|ENC_CH3_MTEnable| |Enable MultiTurn use (negative logic, 1=MToff)|
|586|ENC_CH3_Corr| |Signal correction type|
|587|ENC_CH3_CorrVal| |Signal correction values|
|577|ENC_CH3_EncObsMin| |Encoder monitoring minimum, sqrt(a^2+b^2)|
|581|ENC_CH3_AbsEncStatus| |Error and status codes (absolute encoder)|
|582|ENC_CH3_PeriodLen|nm|Length of signal period (Sin/Cos linear encoder)|
|583|ENC_CH3_DigitalResolution|nm|Length of one increment (linear absolute encoder)|
|636|ENC_CH3_CycleCount| |Sampling cycle in: n x 125 μ (microseconds)|
|639|ENC_CH3_NominalincrementA| |Sign. Nominal increment A (distance coded abs. encoder)|
|637|ENC_CH3_NominalincrementB| |Sign. Nominal increment B (distance coded abs. encoder)|

# Table 6.24: Parameters for channel 3 (X8) - Sin/Cos encoder

Some parameters (e.g. Sel, Num, Denom, Abs, Lines, MultiT, SingleT, CorrVal) are self-explanatory.

The Code and Mode parameters are described in Section ""SSI (cyclical) X7"" on page 69.

P 584[0] - ENC_CH3_MTBase = Minimum MultiTurn position

The MTBase parameter is used to set a position in the multi-turn encoder’s travel path that defines the point of discontinuity (overflow/underflow) for the absolute value initialization (that is, the “multi-turn basis”). Assuming a bipolar encoder measuring range, all position values that fall below MTBase will be shifted “up” (the whole MT range will be added to them once). This method makes it possible to place the point of discontinuity at any point within the encoder’s entire measuring range. By default, MTBase will be set to the lowest possible value for the parameter, i.e. reliably outside of the encoder’s value range: In this case, the full bipolar range will remain unaffected, as values will never fall below this MTBase threshold (see Section ""Channel 3: Interface X8 (optional)"" on page 76 as well).

P 585[0] - ENC_CH3_MTEnable = MultiTurn as SingleTurn

The MTEnable parameter makes it possible to use multi-turn encoders as single-turn encoders for test purposes. Negative logic: Default MTEnable = 0 means ""MultiTurn-Enable ON"".

P 586[0] - ENC_CH3_Corr = Signal correction type:

The GPOC routine used for track signal correction purposes for sine/cosine signals is used to compensate for systematic errors. The routine is controlled with the Corr and CorrVal parameters (see Section ""Signal correction GPOC (Gain Phase Offset Correction)"" on page 74).

P 577[0] - ENC_CH3_EncObsMin = Encoder monitoring minimum, sqrt(a^2+b^2)

The parameter EncObsMin is used to scale the Sin/Cos wire break monitoring and represents the “downwards threshold” for an error message. The default setting is 0.2, corresponding to approx. ",What does the 'Absolute Interface' drop-down menu in the encoder configuration for channel Ch3 allow?,It selects the 'auxiliary interface' (P 570[0] - ENC_CH3_Abs) for one-time reading of the absolute position during initialization.,"This menu sets the 'auxiliary interface' via P 570[0] - ENC_CH3_Abs, used for absolute position reading once at initialization.","The 'Absolute Interface' menu configures P 570[0] - ENC_CH3_Abs, the auxiliary interface for initial absolute position measurement.","Through this menu, the auxiliary interface P 570[0] - ENC_CH3_Abs is selected for initial absolute position reading.",It allows selection of the auxiliary interface (ENC_CH3_Abs) for one-time absolute position reading during the initialization phase.
7,msd_servo_drive.txt,29,8b7b14207d0506f3f75c9a63fb98a68193e71ed0f7337bac8f26cb3596e2b576,"3: “TTL encoder simulation / TTL master encoder”
- No. 4: “SSI encoder simulation”
- No. 5: “TTL encoder with commutation signals”

NOTE

- For information on the connector, pinout, technical data, configuration, and the encoder models (if any) that can be evaluated with the included technology option, please consult the Specification specified in the “Documentation” column.

The following table shows how the X8 options that can be used for encoder evaluation can be identified and selected.

|“No.” column|As per the table above.|
|---|---|
|“Hardware ID” column|The texts in this column can be viewed in the Moog DRIVEADMINISTRATOR 5 using P 53[0] - DV_HwOptionX12ID by going to ►Drive description ►Hardware version if the corresponding technology option is present.|
|“Selection” column|In certain cases, several different encoder types can be run on a technology option and selected with P 507 - ENC_CH3_Sel. Even if a technology option that does not match is equipped, most values can only be selected with P 507 - ENC_CH3_Sel. If an impermissible combination is selected, this will be indicated by means of error messages during the initialization phase.|

MOOG ID No.:CB40859-001 Date:11/2020

MSD ServoDrive - DeviceHelp 77

# 6 Encoder

MOOG ID No.:CB40859-001 Date:11/2020

# MSD ServoDrive - DeviceHelp

|No.|Technology option name|Hardware ID|Selection|
|---|---|---|---|
|0|No module|NONE(0) - No technology option|OFF (0)|
| | |SINCOS(1) - Sin/Cos cyclic *)| |
| | |- Without absolute value interface, Abs=OFF(0), with zero pulse| |
| | |- With SSI one-time reading, Abs=SSI(1)| |
|1|Second Sin/Cos encoder|SINCOS_V2(10) - 2nd Sin/Cos encoder (V2)|- With EnDat one-time reading, Abs=ENDAT(2)|
| | |SSI(2) - Cyclical SSI (without analog tracks)| |
| | |TTL(3) - TTL evaluation, with zero pulse| |
| | |ENDAT(4) - Cyclical EnDat (without analog tracks)| |
|3|TTL encoder simulation / TTL master encoder|TTL_ECSIM_V2(9) - TTL Encodersimulation (V2)|TTL(3)|
|4|SSI encoder simulation|SSI_ECSIM(3) - SSI encodersimulation|SSI(2) - Cyclical SSI (without analog tracks)|
|5|TTL encoder with commutation signals|TTL_COM(11) - TTL + Hall option|TTL(3)|
| | |TTL_COM(5)| |

Table 6.19: Options for X8 interface that can be used to evaluate encoders via encoder channel Ch3

*) SINCOS(1) is set via the P 507[0] - ENC_CH3_Sel main interface. The auxiliary interface, P 570[0] - ENC_CH3_Abs, can be optionally used to set the one-time reading for the absolute position during initialization.

# NOTE

- Only one encoder with a purely digital EnDat or SSI interface can be used on connector X8 or X7.
- If two EnDat encoders are used and one of them is purely digital, it is necessary to ensure that the purely digital encoder is connected to X8. This is important, as the EnDat encoder with Sin/Cos tracks must be initialized before the purely digital encoder.

# Encoder Configuration

To see which technology option your Servo Drive features (if any), go to Project Select from database tree ► Device setup ► Drive description in Moog DRIVEADMINISTRATOR 5 and check under “Technology option” in the “Hardware” section.

# Encoder Name

You can use this field to enter your own information for describing the encoder (maximum of 31 characters) (P 580[0] - ENC_CH3_Info).

# Cyclic Position Via

This drop-down menu is used to select the “main interface” (P 507[0] - ENC_CH3_Sel).

# Pulses Per Revolution

Once SINCOS(1), TTL(3) or TTL_COM(5) is selected as the “main interface,” this field will appear so that you can enter the number of analog Sin/Cos tracks per revolution (TTL tracks as well).

# Absolute Interface

This drop-down menu is used to select the “auxiliary interface” (P 570[0] - ENC_CH3_Abs).

# Image 6.5: Encoder Configuration Channel 3 (X8) Screen

This screen is used to select the encoder for channel Ch3. This channel uses the encoder’s “main interface” to measure position changes periodically and add them up cyclically – this is referred to as “cyclical evaluation.”

Encoders with a main interface that only makes it possible to measure the cyclical position incrementally often feature an additional absolute value interface referred to as an “auxiliary interface.” For this interface, the absolute position is measured once during the initialization phase and is then used for absolute value initialization purposes.

# Note

l Selecting an “auxiliary interface” is redundant if, for example, SSI (2) is selected as the “main interface” (corresponds to cyclical evaluation via SSI). In this case, the absolute value initialization will also be carried out via the SSI interface, regardless of the selected “auxiliary interface.”

# Gear Ratio

These fields can be used to define a gear ratio for the encoder (in the output side). For more details, see Section ""Encoder gearing"" on page 89.

MOOG ID No.:CB40859-001 Date:11/2020

MSD ServoDrive - DeviceHelp 79

# 6 Encoder

MOOG ID No.:CB40859-001 Date:11/2020

# MSD ServoDrive - DeviceHelp

Signal correction (GPOC) l P 577[0] - ENC_CH3_EncObsMin

If you set EncObsMin to 0, Sin/Cos wire break monitoring will be disabled.

GPOC is a special Moog online process for improving the quality of Sin/Cos signals before they are used to calculate a position. If “SINCOS(1)” is selected as the “main interface,” this process may be useful. For details see Section ""Signal correction GPOC (Gain Phase Offset Correction)"" on page 74.

The default value is 0.2 (20%) and stands for a calculated amplitude value (calculated using the two Sin/Cos signals) of x = sqrt(a² + b²). If the Sin/Cos signals are equal to approx. 1 Vss when compared, approx. 0.8 will be calculated here (approx. 80% magnitude at the A-D converters; approx. 0.25 Vss Sin/Cos will yield approx. 0.2 here (20% magnitude at the A-D converter)). The error threshold can be adjusted with EncObsMin.

# 6.7.1 Main parameters for encoder channel Ch3

The following table lists the most important parameters for the Ch3 encoder channel. These parameters are described in the chapters that go over selecting the various encoders with P 507[0] - ENC_CH3_Sel and P 570[0] - ENC_CH3_Abs.

When used with its default setting, this parameter will ensure that the absolute value initialization “starts up with plus-minus”. I.e. the encoder’s multi-turn value range from 0 to max will be mapped to -½ max to +½ max. The range from +½ max to max will be initialized as negative; in this case, the point of discontinuity will be found at ½ max. This can be changed with MTBase. When MTBase = 0, the absolute value initialization will, for example, “start up with zero to max”. I.e. the encoder’s multi-turn value range from 0 to max will be mapped to 0 to max. The range from +½ max to max will be initialized as positive; in this case, the point of discontinuity will be found at 0.

l P 585[0] - ENC_CH3_MTEnable

If you set MTEnable to 1, you can use an available multi-turn rotary encoder as a single-turn rotary encoder, which can come in handy for testing purposes.

|P No.|Index|Name / Setting|Unit|Description|
|---|---|---|---|---|
|507|0|ENC_CH3_Sel| |Main selection on encoder channel Ch3|
|570|0|ENC_CH3_Abs| |Absolute value interface for one-time reading|
|572|0|ENC_CH3_Lines| |Number of analog Sin/Cos lines per revolution (TTL lines as well)|
|573|0|ENC_CH3_MultiT| |Number of multi-turn bits for the digital interface|
|574|0|ENC_CH3_SingleT| |Number of single-turn bits for the digital interface|
|575|0|ENC_CH3_Code| |Code selection (for SSI encoders) (binary, Gray)|
|576|0|ENC_CH3_Mode| |Mode selection (for SSI encoders)|
|583|0|ENC_CH3_|nm|Linear encoders: Length of a digital increment in|
|584|0|DigitalResolution|nm (nanometres)| |
|585|0|ENC_CH3_MTBase| |Definition of point of discontinuity in multi-turn range|
|636|0|ENC_CH3_MTEnable| |Enable MultiTurn use (negative logic, 1=MToff)|
|636|0|ENC_CH3_CycleCount| |Sampling cycle in: n x 125 μ (microseconds)|

NOTE: As there are various protocol modes available for SSI encoders (with/without wire break monitoring, with/without parity bit, etc.), consult with your project supervisor or the Helpline provided by Moog before using any special SSI protocol modes.

As the functionality of the parameters for encoder channel Ch3 is predominantly identical to that of the parameters for encoder channel Ch1, it is recommended to read the description for the Ch1 encoder channel parameters.

Accordingly, the following table starts by listing all the parameters for the Ch3 encoder channel. If the functionality of a parameter is different from that of the corresponding parameter for encoder channel Ch1, the parameter will be described in the chapters that go over selecting a special encoder with (507) ENC_CH3_Sel and (570) ENC_CH3_Abs.

Parameters Lines, MultiT, SingleT, etc. are self-explanatory. Most of the following parameters are explained in the information for encoder channel Ch1 (see Section ""Channel 1: Interface X7"" on page 59).

# Table 6.21: Encoder configuration channel 3 (X8) parameters

|ID|Index|Name|Unit|Description|
|---|---|---|---|---|
|349|0|CON_FM_MConOffset| |Commutation offset|
|502|0..3|ENC_CH3_ActVal| |Current position value at encoder channel Ch3 output|
|507|0|ENC_CH3_Sel| |Main selection on encoder channel Ch3|
|514|0|ENC_CH3_Num| |Encoder gearing: Numerator|
|515|0|ENC_CH3_Denom| |Encoder gearing: Denominator|
|520|0|ENC_MCon| |=3, channel selection for motor commutation|
|521|0|ENC_SCon| |=3, channel selection for speed control|
|522|0|ENC_PCon| |=3, channel selection for position control|
|570|0|ENC_CH3_Abs| |Absolute value interface selection (one-time reading)|
|571|0|ENC_CH3_NpTest| |TEST-MODE: Index pulse signal(s) to Scope|
|572|0|ENC_CH3_Lines| |Number of Lines (Sin/Cos / TTL encoders)|
|573|0|ENC_CH3_MultiT| |Number of MultiTurn bits (absolute encoder)|
|574|0|ENC_CH3_SingleT| |Number of SingleTurn bits (absolute encoder)|
|574|0|ENC_CH3_Code| |Code selection (SSI encoder) (binary, gray)|
|576|0|ENC_CH3_Mode| |Mode selection (SSI encoder)|
|577|0|ENC_CH3_EncObsMin| |Encoder monitoring minimum, sqrt (a^2+b^2)|
|578|0|ENC_CH3_Extended| |(a^2 + b^2) ENC CH3: Extended|
|580|0|ENC_CH3_Info| |Encoder information channel 3|
|581|0|ENC_CH3_AbsEncStatus| |Error and status codes (absolute encoder)|
|582|0|ENC_CH3_PeriodLen|nm|Length of signal period (Sin/Cos linear encoder)|

# Encoder configuration channel 3 (X8) parameters (continue)

|Index|Name|Unit|Description|
|---|---|---|---|
|0|ENC_CH3_|nm|Length of one increment (linear absolute encoder)|
|0|DigitalResolution| | |
|0|ENC_CH3_MTBase| |Definition of point of discontinuity in multi-turn range|
|0|ENC_CH3_MTEnable| |Enable MultiTurn use (negative logic, 1=MToff)|
|0|ENC_CH3_Corr| |Signal correction type|
|0..4|ENC_CH3_CorrVal| |Signal correction values|
|0|ENC_CH3_EncObsAct| |Amplitude of analog signals (vector length)|
|0|ENC_CH3_HallLayout| |Hall pattern selection|
|0|ENC_CH3_Position|inc|Position encoder channel 3|
|0|ENC_CH3_Period|ms|Maximum period of interpolation (ttl encoder)|
|0|ENC_CH3_EncOnsActTF|ms|Filter time constant for amplitude of analog signals|
|0|ENC_CH3_|Sign.|Nominal increment A (distance coded abs. encoder)|
|0|ENC_CH3_|Sign.|Nominal increment B (distance coded abs. encoder)|
|0|ENC_CH3_CycleCount| |Position encoder sampling cycle (n x 125 μsec)|
|0|ENC_CH3_AbsInitMode| |Mode absolute value formation|
|0..29|ENC_ENDAT| |EnDat additional|
|0|ENC_Warning| |Encoder warning (e.g. from encoder internal memory)|
|0|ENC_Warning| |Encoder warning reset (e.g. in encoder internal memory)|
|0|ENC_Error| |Encoder error (e.g. from encoder internal memory)|
|0|ENC_ErrorReset| |Encoder error reset (e.g. in encoder internal memory)|
|0|ENC_ETS| |ETS mode, electronic nameplate|
|0|ENC_ETS_CTRL| |ETS control, electronic nameplate|
|0..15|ENC_ETS_STAT| |ETS status, electronic nameplate|
|0..511|ENC_ETS_DATA| |ETS data, electronic nameplate|
|0|ENC_CH3_TTL_| |TTL signal type selection|

# 6 Encoder

MOOG ID No.:CB40859-001 Date:11/2020

# 6.7.2 Absolute value interfaces X8

The following absolute value interfaces will be available at encoder channel Ch3 depending on the X8 option being used.

- Cyclical Sin/Cos with SSI one-time reading via X8 option: SINCOS_V2(10) - 2nd Sin/Cos encoder (V2)
- Cyclical Sin/Cos with EnDat one-time reading via X8 option: SINCOS_V2(10) - 2nd Sin/Cos encoder (V2)
- Cyclical SSI via X8 options: SINCOS_V2(10) - 2nd Sin/Cos encoder (V2) or SSI_ECSIM(3) - SSI encoder simulation
- Cyclical EnDat via X8 option: SINCOS_V2(10) - 2nd Sin/Cos encoder (V2)

See also table in Section ""Channel 3: Interface X8 (optional)"" on page 76. They can be selected with P 507[0] - ENC_CH3_Sel and P 570[0] - ENC_CH3_Abs. For more details, see Section ""Main parameters for encoder channel Ch3"" on page 80.

# 6.7.3 EnDat (cyclical) X8

Ch3: ENDAT(4) - Cyclical EnDat (2.1 or 2.2)

As the EnDat functionality of the parameters for encoder channel Ch3 is predominantly identical to that of the parameters for encoder channel Ch1, it is recommended to read the description for the Ch1 encoder channel parameters (see Section ""EnDat (cyclical) X7"" on page 61).

The software versions required to run the EnDat interface are the standard software versions for the MSD Servo Drive and MSD Single-Axis Servo Drive Compact.

NOTE

- Please note the limitations that apply when running EnDat and SSI encoders (see Section ""Limiting for EnDat and SSI"" on page 52).

|ID|Index|Name|Unit|Description|
|---|---|---|---|---|
|507|0|ENC_CH3_Sel|= 4|= ENDAT(4)|
|573|0|ENC_CH3_MultiT|Number of MultiTurn bits (absolute encoder)| |
|574|0|ENC_CH3_SingleT|Number of SingleTurn bits (absolute encoder)| |
|584|0|ENC_CH3_MTBase|Definition of point of discontinuity in multi-turn| |
|585|0|ENC_CH3_MTEnable|range|1: Use Multi-turn encoder as a single-turn encoder|
|636|0|ENC_CH3_CycleCount|Position encoder sampling cycle (n x 125 μsec)| |
|600|0|ENC_CH3_Position|inc|Position encoder channel 3|
|583|0|ENC_CH3_|nm|Length of one increment (linear absolute encoder)|
|640|0..29|DigitalResolution| | |

Table 6.22: ENC_ENDAT Channel 3 encoder configuration (X8) - EnDat (cyclical) parameters

# 6.7.4 Hall sensor X8

Encoder channel Ch3 does not support Hall effect sensors!

# 6.7.5 Sin/Cos / TTL X8

# 6.7.5.1 TTL encoder

Ch3: TTL(3) - TTL signals

TTL encoders are ...

1. ... usually pure incremental encoders without an absolute value interface. In this case, P 570[0] - ENC_CH3_Abs must be set to OFF(0).
2. ... in a few exceptional cases, incremental encoders with an SSI absolute value interface. In this case, P 570[0] - ENC_CH3_Abs must be accordingly set to SSI(1) so that it will be possible to read the absolute encoder position for the absolute value initialization routine once during the initialization phase.

# 6.7.5.1.1 Pure TTL incremental encoder

A maximum interpolation period, in ms (milliseconds), can be configured for the TTL interface using P 602[0] - ENC_CH3_Period. Within this context, Period is the maximum time of “no activity” since the last TTL counter event:

- Period = 0: Function disabled (default)
- Period > 0 (=n ms): If no counter event is registered in n ms, the speed will be set to 0.

# Zero pulse

There is no parameter for activating the zero pulse evaluation here, as this evaluation is controlled based exclusively on the homing mode (see Section ""Homing"" on page 249). However, setting P 571[0] - ENC_CH3_NpTest to 1 provides a test mode that can be used during commissioning in order to be able to activate the zero pulse evaluation even without homing. Scope signals 1034 and 1036 can be used to view a received zero pulse within this context. This test mode must be disabled during normal operation (P 571[0] = 0).

# Commutation

Motor operation with pure incremental encoders needs for the auto commutation function to be enabled without fail. For details see Section ""Synchronous motor auto commutation"" on page 156.

# 6.7.5.1.2 TTL incremental encoder with SSI absolute value interface

see Section ""Sin/Cos incremental encoders with absolute value interface"" on page 84 and in special Section ""SSI absolute value interface"" on page 86.

MOOG ID No.:CB40859-001 Date:11/2020

MSD ServoDrive - DeviceHelp

# 6 Encoder

MOOG ID No.:CB40859-001 Date:11/2020

MSD ServoDrive - DeviceHelp 84

|ID|Index Name|Unit|Description|
|---|---|---|---|
|507|0|ENC_CH3_Sel = 3|Encoder selection set to TTL(3)|
|514|0|ENC_CH3_Num|Encoder gearing: Numerator|
|515|0|ENC_CH3_Denom|Encoder gearing: Denominator|
|570|0|ENC_CH3_Abs|Selection of absolute value interface|
|571|0|ENC_CH3_NpTest|ENC CH1, TEST-MODE: Index pulse signal(s) to Scope|
|572|0|ENC_CH3_Lines|Number of lines (Sin/Cos / TTL encoders)|
|2842|0|ENC_CH3_TTL_SignalType|Channel 3: TTL signal selection|
|602|0|ENC_CH3_Period|Maximum period of interpolation (ttl encoder)|
|636|0|ENC_CH3_CycleCount|Sampling cycle in: n x 125 μ (microseconds)|

# Table 6.23: Parameters for Channel 3 (X8) - TTL encoder

6.7.5.2.2 Linear Sin/Cos incremental encoders

Linear Sin/Cos encoders are operated as rotary encoders. For linear motor operation, P 572[0] - ENC_CH3_Lines and the encoder gearing (see Section ""Encoder gearing"" on page 89) are used to establish the ratio for the linear motor’s pole pair subdivision (North-North) for commutation. 1 x North-North corresponds to one revolution from Lines. In this case, the motor pole pair number must be set to 1. P 582[0] - ENC_CH3_PeriodLen is not used in this case.

# 6.7.5.2 Sin/Cos encoder

Ch3: SINCOS(1) - Sin/Cos signals

Sin/Cos encoders can ...

1. Be pure incremental encoders without an absolute value interface. In this case, P 570[0] - ENC_CH3_Abs must be set to OFF(0).
2. Be incremental encoders with an absolute value interface. In this case, P 570[0] - ENC_CH3_Abs must be accordingly set to SSI(1) or EnDat(2) so that it will be possible to read the absolute encoder position for the absolute value initialization routine once during the initialization phase.

# 6.7.5.2.1 Purely Sin/Cos incremental encoders

To run these encoders as pure incremental encoders with a zero pulse on encoder channel Ch3 (without an absolute value interface), the approach is basically the same as for pure TTL operation (see Section ""TTL encoder"" on page 82). The same parameters apply. However, there are the following differences:

# 6.7.5.2.4 Sin/Cos incremental encoders with absolute value interface

The following table lists the parameters for cyclical Sin/Cos operation on encoder channel Ch 3 with one-time reading of the absolute encoder position via the absolute value interface, i.e. without a zero pulse:

|ID|Index Name|Unit|Description|
|---|---|---|---|
|507|ENC_CH3_Sel|1|Encoder selection set to SINCOS(1)|
|514|ENC_CH3_Num| |Encoder gearing: Numerator|
|515|ENC_CH3_Denom| |Encoder gearing: Denominator|
|570|ENC_CH3_Abs| |Absolute value interface selection (one-time reading)|
|572|ENC_CH3_Lines| |Number of Lines (Sin/Cos / TTL encoders)|
|573|ENC_CH3_MultiT| |Number of MultiTurn bits (absolute encoder)|
|574|ENC_CH3_SingleT| |Number of SingleTurn bits (absolute encoder)|
|575|ENC_CH3_Code| |Code selection (SSI encoder) (binary, gray)|
|576|ENC_CH3_Mode| |Mode selection (SSI encoder)|
|584|ENC_CH3_MTBase| |Definition of point of discontinuity in multi-turn range|
|585|ENC_CH3_MTEnable| |Enable MultiTurn use (negative logic, 1=MToff)|
|586|ENC_CH3_Corr| |Signal correction type|
|587|ENC_CH3_CorrVal| |Signal correction values|
|577|ENC_CH3_EncObsMin| |Encoder monitoring minimum, sqrt(a^2+b^2)|
|581|ENC_CH3_AbsEncStatus| |Error and status codes (absolute encoder)|
|582|ENC_CH3_PeriodLen|nm|Length of signal period (Sin/Cos linear encoder)|
|583|ENC_CH3_DigitalResolution|nm|Length of one increment (linear absolute encoder)|
|636|ENC_CH3_CycleCount| |Sampling cycle in: n x 125 μ (microseconds)|
|639|ENC_CH3_NominalincrementA| |Sign. Nominal increment A (distance coded abs. encoder)|
|637|ENC_CH3_NominalincrementB| |Sign. Nominal increment B (distance coded abs. encoder)|

# Table 6.24: Parameters for channel 3 (X8) - Sin/Cos encoder

Some parameters (e.g. Sel, Num, Denom, Abs, Lines, MultiT, SingleT, CorrVal) are self-explanatory.

The Code and Mode parameters are described in Section ""SSI (cyclical) X7"" on page 69.

P 584[0] - ENC_CH3_MTBase = Minimum MultiTurn position

The MTBase parameter is used to set a position in the multi-turn encoder’s travel path that defines the point of discontinuity (overflow/underflow) for the absolute value initialization (that is, the “multi-turn basis”). Assuming a bipolar encoder measuring range, all position values that fall below MTBase will be shifted “up” (the whole MT range will be added to them once). This method makes it possible to place the point of discontinuity at any point within the encoder’s entire measuring range. By default, MTBase will be set to the lowest possible value for the parameter, i.e. reliably outside of the encoder’s value range: In this case, the full bipolar range will remain unaffected, as values will never fall below this MTBase threshold (see Section ""Channel 3: Interface X8 (optional)"" on page 76 as well).

P 585[0] - ENC_CH3_MTEnable = MultiTurn as SingleTurn

The MTEnable parameter makes it possible to use multi-turn encoders as single-turn encoders for test purposes. Negative logic: Default MTEnable = 0 means ""MultiTurn-Enable ON"".

P 586[0] - ENC_CH3_Corr = Signal correction type:

The GPOC routine used for track signal correction purposes for sine/cosine signals is used to compensate for systematic errors. The routine is controlled with the Corr and CorrVal parameters (see Section ""Signal correction GPOC (Gain Phase Offset Correction)"" on page 74).

P 577[0] - ENC_CH3_EncObsMin = Encoder monitoring minimum, sqrt(a^2+b^2)

The parameter EncObsMin is used to scale the Sin/Cos wire break monitoring and represents the “downwards threshold” for an error message. The default setting is 0.2, corresponding to approx. ",How is the gear ratio for the encoder defined in the 'MSD ServoDrive - DeviceHelp' document?,The gear ratio is defined using the numerator (P 514[0] - ENC_CH3_Num) and denominator (P 515[0] - ENC_CH3_Denom) fields in the encoder configuration.,"By setting the numerator and denominator in P 514[0] - ENC_CH3_Num and P 515[0] - ENC_CH3_Denom, the encoder's gear ratio is established.",The document specifies using ENC_CH3_Num and ENC_CH3_Denom parameters to define the encoder gear ratio in the output side.,Encoder gearing is configured with numerator (ENC_CH3_Num) and denominator (ENC_CH3_Denom) parameters for the desired gear ratio.,"It involves inputting values into P 514[0] and P 515[0] for the numerator and denominator, respectively, to set the encoder's gear ratio."
8,msd_servo_drive.txt,29,8b7b14207d0506f3f75c9a63fb98a68193e71ed0f7337bac8f26cb3596e2b576,"3: “TTL encoder simulation / TTL master encoder”
- No. 4: “SSI encoder simulation”
- No. 5: “TTL encoder with commutation signals”

NOTE

- For information on the connector, pinout, technical data, configuration, and the encoder models (if any) that can be evaluated with the included technology option, please consult the Specification specified in the “Documentation” column.

The following table shows how the X8 options that can be used for encoder evaluation can be identified and selected.

|“No.” column|As per the table above.|
|---|---|
|“Hardware ID” column|The texts in this column can be viewed in the Moog DRIVEADMINISTRATOR 5 using P 53[0] - DV_HwOptionX12ID by going to ►Drive description ►Hardware version if the corresponding technology option is present.|
|“Selection” column|In certain cases, several different encoder types can be run on a technology option and selected with P 507 - ENC_CH3_Sel. Even if a technology option that does not match is equipped, most values can only be selected with P 507 - ENC_CH3_Sel. If an impermissible combination is selected, this will be indicated by means of error messages during the initialization phase.|

MOOG ID No.:CB40859-001 Date:11/2020

MSD ServoDrive - DeviceHelp 77

# 6 Encoder

MOOG ID No.:CB40859-001 Date:11/2020

# MSD ServoDrive - DeviceHelp

|No.|Technology option name|Hardware ID|Selection|
|---|---|---|---|
|0|No module|NONE(0) - No technology option|OFF (0)|
| | |SINCOS(1) - Sin/Cos cyclic *)| |
| | |- Without absolute value interface, Abs=OFF(0), with zero pulse| |
| | |- With SSI one-time reading, Abs=SSI(1)| |
|1|Second Sin/Cos encoder|SINCOS_V2(10) - 2nd Sin/Cos encoder (V2)|- With EnDat one-time reading, Abs=ENDAT(2)|
| | |SSI(2) - Cyclical SSI (without analog tracks)| |
| | |TTL(3) - TTL evaluation, with zero pulse| |
| | |ENDAT(4) - Cyclical EnDat (without analog tracks)| |
|3|TTL encoder simulation / TTL master encoder|TTL_ECSIM_V2(9) - TTL Encodersimulation (V2)|TTL(3)|
|4|SSI encoder simulation|SSI_ECSIM(3) - SSI encodersimulation|SSI(2) - Cyclical SSI (without analog tracks)|
|5|TTL encoder with commutation signals|TTL_COM(11) - TTL + Hall option|TTL(3)|
| | |TTL_COM(5)| |

Table 6.19: Options for X8 interface that can be used to evaluate encoders via encoder channel Ch3

*) SINCOS(1) is set via the P 507[0] - ENC_CH3_Sel main interface. The auxiliary interface, P 570[0] - ENC_CH3_Abs, can be optionally used to set the one-time reading for the absolute position during initialization.

# NOTE

- Only one encoder with a purely digital EnDat or SSI interface can be used on connector X8 or X7.
- If two EnDat encoders are used and one of them is purely digital, it is necessary to ensure that the purely digital encoder is connected to X8. This is important, as the EnDat encoder with Sin/Cos tracks must be initialized before the purely digital encoder.

# Encoder Configuration

To see which technology option your Servo Drive features (if any), go to Project Select from database tree ► Device setup ► Drive description in Moog DRIVEADMINISTRATOR 5 and check under “Technology option” in the “Hardware” section.

# Encoder Name

You can use this field to enter your own information for describing the encoder (maximum of 31 characters) (P 580[0] - ENC_CH3_Info).

# Cyclic Position Via

This drop-down menu is used to select the “main interface” (P 507[0] - ENC_CH3_Sel).

# Pulses Per Revolution

Once SINCOS(1), TTL(3) or TTL_COM(5) is selected as the “main interface,” this field will appear so that you can enter the number of analog Sin/Cos tracks per revolution (TTL tracks as well).

# Absolute Interface

This drop-down menu is used to select the “auxiliary interface” (P 570[0] - ENC_CH3_Abs).

# Image 6.5: Encoder Configuration Channel 3 (X8) Screen

This screen is used to select the encoder for channel Ch3. This channel uses the encoder’s “main interface” to measure position changes periodically and add them up cyclically – this is referred to as “cyclical evaluation.”

Encoders with a main interface that only makes it possible to measure the cyclical position incrementally often feature an additional absolute value interface referred to as an “auxiliary interface.” For this interface, the absolute position is measured once during the initialization phase and is then used for absolute value initialization purposes.

# Note

l Selecting an “auxiliary interface” is redundant if, for example, SSI (2) is selected as the “main interface” (corresponds to cyclical evaluation via SSI). In this case, the absolute value initialization will also be carried out via the SSI interface, regardless of the selected “auxiliary interface.”

# Gear Ratio

These fields can be used to define a gear ratio for the encoder (in the output side). For more details, see Section ""Encoder gearing"" on page 89.

MOOG ID No.:CB40859-001 Date:11/2020

MSD ServoDrive - DeviceHelp 79

# 6 Encoder

MOOG ID No.:CB40859-001 Date:11/2020

# MSD ServoDrive - DeviceHelp

Signal correction (GPOC) l P 577[0] - ENC_CH3_EncObsMin

If you set EncObsMin to 0, Sin/Cos wire break monitoring will be disabled.

GPOC is a special Moog online process for improving the quality of Sin/Cos signals before they are used to calculate a position. If “SINCOS(1)” is selected as the “main interface,” this process may be useful. For details see Section ""Signal correction GPOC (Gain Phase Offset Correction)"" on page 74.

The default value is 0.2 (20%) and stands for a calculated amplitude value (calculated using the two Sin/Cos signals) of x = sqrt(a² + b²). If the Sin/Cos signals are equal to approx. 1 Vss when compared, approx. 0.8 will be calculated here (approx. 80% magnitude at the A-D converters; approx. 0.25 Vss Sin/Cos will yield approx. 0.2 here (20% magnitude at the A-D converter)). The error threshold can be adjusted with EncObsMin.

# 6.7.1 Main parameters for encoder channel Ch3

The following table lists the most important parameters for the Ch3 encoder channel. These parameters are described in the chapters that go over selecting the various encoders with P 507[0] - ENC_CH3_Sel and P 570[0] - ENC_CH3_Abs.

When used with its default setting, this parameter will ensure that the absolute value initialization “starts up with plus-minus”. I.e. the encoder’s multi-turn value range from 0 to max will be mapped to -½ max to +½ max. The range from +½ max to max will be initialized as negative; in this case, the point of discontinuity will be found at ½ max. This can be changed with MTBase. When MTBase = 0, the absolute value initialization will, for example, “start up with zero to max”. I.e. the encoder’s multi-turn value range from 0 to max will be mapped to 0 to max. The range from +½ max to max will be initialized as positive; in this case, the point of discontinuity will be found at 0.

l P 585[0] - ENC_CH3_MTEnable

If you set MTEnable to 1, you can use an available multi-turn rotary encoder as a single-turn rotary encoder, which can come in handy for testing purposes.

|P No.|Index|Name / Setting|Unit|Description|
|---|---|---|---|---|
|507|0|ENC_CH3_Sel| |Main selection on encoder channel Ch3|
|570|0|ENC_CH3_Abs| |Absolute value interface for one-time reading|
|572|0|ENC_CH3_Lines| |Number of analog Sin/Cos lines per revolution (TTL lines as well)|
|573|0|ENC_CH3_MultiT| |Number of multi-turn bits for the digital interface|
|574|0|ENC_CH3_SingleT| |Number of single-turn bits for the digital interface|
|575|0|ENC_CH3_Code| |Code selection (for SSI encoders) (binary, Gray)|
|576|0|ENC_CH3_Mode| |Mode selection (for SSI encoders)|
|583|0|ENC_CH3_|nm|Linear encoders: Length of a digital increment in|
|584|0|DigitalResolution|nm (nanometres)| |
|585|0|ENC_CH3_MTBase| |Definition of point of discontinuity in multi-turn range|
|636|0|ENC_CH3_MTEnable| |Enable MultiTurn use (negative logic, 1=MToff)|
|636|0|ENC_CH3_CycleCount| |Sampling cycle in: n x 125 μ (microseconds)|

NOTE: As there are various protocol modes available for SSI encoders (with/without wire break monitoring, with/without parity bit, etc.), consult with your project supervisor or the Helpline provided by Moog before using any special SSI protocol modes.

As the functionality of the parameters for encoder channel Ch3 is predominantly identical to that of the parameters for encoder channel Ch1, it is recommended to read the description for the Ch1 encoder channel parameters.

Accordingly, the following table starts by listing all the parameters for the Ch3 encoder channel. If the functionality of a parameter is different from that of the corresponding parameter for encoder channel Ch1, the parameter will be described in the chapters that go over selecting a special encoder with (507) ENC_CH3_Sel and (570) ENC_CH3_Abs.

Parameters Lines, MultiT, SingleT, etc. are self-explanatory. Most of the following parameters are explained in the information for encoder channel Ch1 (see Section ""Channel 1: Interface X7"" on page 59).

# Table 6.21: Encoder configuration channel 3 (X8) parameters

|ID|Index|Name|Unit|Description|
|---|---|---|---|---|
|349|0|CON_FM_MConOffset| |Commutation offset|
|502|0..3|ENC_CH3_ActVal| |Current position value at encoder channel Ch3 output|
|507|0|ENC_CH3_Sel| |Main selection on encoder channel Ch3|
|514|0|ENC_CH3_Num| |Encoder gearing: Numerator|
|515|0|ENC_CH3_Denom| |Encoder gearing: Denominator|
|520|0|ENC_MCon| |=3, channel selection for motor commutation|
|521|0|ENC_SCon| |=3, channel selection for speed control|
|522|0|ENC_PCon| |=3, channel selection for position control|
|570|0|ENC_CH3_Abs| |Absolute value interface selection (one-time reading)|
|571|0|ENC_CH3_NpTest| |TEST-MODE: Index pulse signal(s) to Scope|
|572|0|ENC_CH3_Lines| |Number of Lines (Sin/Cos / TTL encoders)|
|573|0|ENC_CH3_MultiT| |Number of MultiTurn bits (absolute encoder)|
|574|0|ENC_CH3_SingleT| |Number of SingleTurn bits (absolute encoder)|
|574|0|ENC_CH3_Code| |Code selection (SSI encoder) (binary, gray)|
|576|0|ENC_CH3_Mode| |Mode selection (SSI encoder)|
|577|0|ENC_CH3_EncObsMin| |Encoder monitoring minimum, sqrt (a^2+b^2)|
|578|0|ENC_CH3_Extended| |(a^2 + b^2) ENC CH3: Extended|
|580|0|ENC_CH3_Info| |Encoder information channel 3|
|581|0|ENC_CH3_AbsEncStatus| |Error and status codes (absolute encoder)|
|582|0|ENC_CH3_PeriodLen|nm|Length of signal period (Sin/Cos linear encoder)|

# Encoder configuration channel 3 (X8) parameters (continue)

|Index|Name|Unit|Description|
|---|---|---|---|
|0|ENC_CH3_|nm|Length of one increment (linear absolute encoder)|
|0|DigitalResolution| | |
|0|ENC_CH3_MTBase| |Definition of point of discontinuity in multi-turn range|
|0|ENC_CH3_MTEnable| |Enable MultiTurn use (negative logic, 1=MToff)|
|0|ENC_CH3_Corr| |Signal correction type|
|0..4|ENC_CH3_CorrVal| |Signal correction values|
|0|ENC_CH3_EncObsAct| |Amplitude of analog signals (vector length)|
|0|ENC_CH3_HallLayout| |Hall pattern selection|
|0|ENC_CH3_Position|inc|Position encoder channel 3|
|0|ENC_CH3_Period|ms|Maximum period of interpolation (ttl encoder)|
|0|ENC_CH3_EncOnsActTF|ms|Filter time constant for amplitude of analog signals|
|0|ENC_CH3_|Sign.|Nominal increment A (distance coded abs. encoder)|
|0|ENC_CH3_|Sign.|Nominal increment B (distance coded abs. encoder)|
|0|ENC_CH3_CycleCount| |Position encoder sampling cycle (n x 125 μsec)|
|0|ENC_CH3_AbsInitMode| |Mode absolute value formation|
|0..29|ENC_ENDAT| |EnDat additional|
|0|ENC_Warning| |Encoder warning (e.g. from encoder internal memory)|
|0|ENC_Warning| |Encoder warning reset (e.g. in encoder internal memory)|
|0|ENC_Error| |Encoder error (e.g. from encoder internal memory)|
|0|ENC_ErrorReset| |Encoder error reset (e.g. in encoder internal memory)|
|0|ENC_ETS| |ETS mode, electronic nameplate|
|0|ENC_ETS_CTRL| |ETS control, electronic nameplate|
|0..15|ENC_ETS_STAT| |ETS status, electronic nameplate|
|0..511|ENC_ETS_DATA| |ETS data, electronic nameplate|
|0|ENC_CH3_TTL_| |TTL signal type selection|

# 6 Encoder

MOOG ID No.:CB40859-001 Date:11/2020

# 6.7.2 Absolute value interfaces X8

The following absolute value interfaces will be available at encoder channel Ch3 depending on the X8 option being used.

- Cyclical Sin/Cos with SSI one-time reading via X8 option: SINCOS_V2(10) - 2nd Sin/Cos encoder (V2)
- Cyclical Sin/Cos with EnDat one-time reading via X8 option: SINCOS_V2(10) - 2nd Sin/Cos encoder (V2)
- Cyclical SSI via X8 options: SINCOS_V2(10) - 2nd Sin/Cos encoder (V2) or SSI_ECSIM(3) - SSI encoder simulation
- Cyclical EnDat via X8 option: SINCOS_V2(10) - 2nd Sin/Cos encoder (V2)

See also table in Section ""Channel 3: Interface X8 (optional)"" on page 76. They can be selected with P 507[0] - ENC_CH3_Sel and P 570[0] - ENC_CH3_Abs. For more details, see Section ""Main parameters for encoder channel Ch3"" on page 80.

# 6.7.3 EnDat (cyclical) X8

Ch3: ENDAT(4) - Cyclical EnDat (2.1 or 2.2)

As the EnDat functionality of the parameters for encoder channel Ch3 is predominantly identical to that of the parameters for encoder channel Ch1, it is recommended to read the description for the Ch1 encoder channel parameters (see Section ""EnDat (cyclical) X7"" on page 61).

The software versions required to run the EnDat interface are the standard software versions for the MSD Servo Drive and MSD Single-Axis Servo Drive Compact.

NOTE

- Please note the limitations that apply when running EnDat and SSI encoders (see Section ""Limiting for EnDat and SSI"" on page 52).

|ID|Index|Name|Unit|Description|
|---|---|---|---|---|
|507|0|ENC_CH3_Sel|= 4|= ENDAT(4)|
|573|0|ENC_CH3_MultiT|Number of MultiTurn bits (absolute encoder)| |
|574|0|ENC_CH3_SingleT|Number of SingleTurn bits (absolute encoder)| |
|584|0|ENC_CH3_MTBase|Definition of point of discontinuity in multi-turn| |
|585|0|ENC_CH3_MTEnable|range|1: Use Multi-turn encoder as a single-turn encoder|
|636|0|ENC_CH3_CycleCount|Position encoder sampling cycle (n x 125 μsec)| |
|600|0|ENC_CH3_Position|inc|Position encoder channel 3|
|583|0|ENC_CH3_|nm|Length of one increment (linear absolute encoder)|
|640|0..29|DigitalResolution| | |

Table 6.22: ENC_ENDAT Channel 3 encoder configuration (X8) - EnDat (cyclical) parameters

# 6.7.4 Hall sensor X8

Encoder channel Ch3 does not support Hall effect sensors!

# 6.7.5 Sin/Cos / TTL X8

# 6.7.5.1 TTL encoder

Ch3: TTL(3) - TTL signals

TTL encoders are ...

1. ... usually pure incremental encoders without an absolute value interface. In this case, P 570[0] - ENC_CH3_Abs must be set to OFF(0).
2. ... in a few exceptional cases, incremental encoders with an SSI absolute value interface. In this case, P 570[0] - ENC_CH3_Abs must be accordingly set to SSI(1) so that it will be possible to read the absolute encoder position for the absolute value initialization routine once during the initialization phase.

# 6.7.5.1.1 Pure TTL incremental encoder

A maximum interpolation period, in ms (milliseconds), can be configured for the TTL interface using P 602[0] - ENC_CH3_Period. Within this context, Period is the maximum time of “no activity” since the last TTL counter event:

- Period = 0: Function disabled (default)
- Period > 0 (=n ms): If no counter event is registered in n ms, the speed will be set to 0.

# Zero pulse

There is no parameter for activating the zero pulse evaluation here, as this evaluation is controlled based exclusively on the homing mode (see Section ""Homing"" on page 249). However, setting P 571[0] - ENC_CH3_NpTest to 1 provides a test mode that can be used during commissioning in order to be able to activate the zero pulse evaluation even without homing. Scope signals 1034 and 1036 can be used to view a received zero pulse within this context. This test mode must be disabled during normal operation (P 571[0] = 0).

# Commutation

Motor operation with pure incremental encoders needs for the auto commutation function to be enabled without fail. For details see Section ""Synchronous motor auto commutation"" on page 156.

# 6.7.5.1.2 TTL incremental encoder with SSI absolute value interface

see Section ""Sin/Cos incremental encoders with absolute value interface"" on page 84 and in special Section ""SSI absolute value interface"" on page 86.

MOOG ID No.:CB40859-001 Date:11/2020

MSD ServoDrive - DeviceHelp

# 6 Encoder

MOOG ID No.:CB40859-001 Date:11/2020

MSD ServoDrive - DeviceHelp 84

|ID|Index Name|Unit|Description|
|---|---|---|---|
|507|0|ENC_CH3_Sel = 3|Encoder selection set to TTL(3)|
|514|0|ENC_CH3_Num|Encoder gearing: Numerator|
|515|0|ENC_CH3_Denom|Encoder gearing: Denominator|
|570|0|ENC_CH3_Abs|Selection of absolute value interface|
|571|0|ENC_CH3_NpTest|ENC CH1, TEST-MODE: Index pulse signal(s) to Scope|
|572|0|ENC_CH3_Lines|Number of lines (Sin/Cos / TTL encoders)|
|2842|0|ENC_CH3_TTL_SignalType|Channel 3: TTL signal selection|
|602|0|ENC_CH3_Period|Maximum period of interpolation (ttl encoder)|
|636|0|ENC_CH3_CycleCount|Sampling cycle in: n x 125 μ (microseconds)|

# Table 6.23: Parameters for Channel 3 (X8) - TTL encoder

6.7.5.2.2 Linear Sin/Cos incremental encoders

Linear Sin/Cos encoders are operated as rotary encoders. For linear motor operation, P 572[0] - ENC_CH3_Lines and the encoder gearing (see Section ""Encoder gearing"" on page 89) are used to establish the ratio for the linear motor’s pole pair subdivision (North-North) for commutation. 1 x North-North corresponds to one revolution from Lines. In this case, the motor pole pair number must be set to 1. P 582[0] - ENC_CH3_PeriodLen is not used in this case.

# 6.7.5.2 Sin/Cos encoder

Ch3: SINCOS(1) - Sin/Cos signals

Sin/Cos encoders can ...

1. Be pure incremental encoders without an absolute value interface. In this case, P 570[0] - ENC_CH3_Abs must be set to OFF(0).
2. Be incremental encoders with an absolute value interface. In this case, P 570[0] - ENC_CH3_Abs must be accordingly set to SSI(1) or EnDat(2) so that it will be possible to read the absolute encoder position for the absolute value initialization routine once during the initialization phase.

# 6.7.5.2.1 Purely Sin/Cos incremental encoders

To run these encoders as pure incremental encoders with a zero pulse on encoder channel Ch3 (without an absolute value interface), the approach is basically the same as for pure TTL operation (see Section ""TTL encoder"" on page 82). The same parameters apply. However, there are the following differences:

# 6.7.5.2.4 Sin/Cos incremental encoders with absolute value interface

The following table lists the parameters for cyclical Sin/Cos operation on encoder channel Ch 3 with one-time reading of the absolute encoder position via the absolute value interface, i.e. without a zero pulse:

|ID|Index Name|Unit|Description|
|---|---|---|---|
|507|ENC_CH3_Sel|1|Encoder selection set to SINCOS(1)|
|514|ENC_CH3_Num| |Encoder gearing: Numerator|
|515|ENC_CH3_Denom| |Encoder gearing: Denominator|
|570|ENC_CH3_Abs| |Absolute value interface selection (one-time reading)|
|572|ENC_CH3_Lines| |Number of Lines (Sin/Cos / TTL encoders)|
|573|ENC_CH3_MultiT| |Number of MultiTurn bits (absolute encoder)|
|574|ENC_CH3_SingleT| |Number of SingleTurn bits (absolute encoder)|
|575|ENC_CH3_Code| |Code selection (SSI encoder) (binary, gray)|
|576|ENC_CH3_Mode| |Mode selection (SSI encoder)|
|584|ENC_CH3_MTBase| |Definition of point of discontinuity in multi-turn range|
|585|ENC_CH3_MTEnable| |Enable MultiTurn use (negative logic, 1=MToff)|
|586|ENC_CH3_Corr| |Signal correction type|
|587|ENC_CH3_CorrVal| |Signal correction values|
|577|ENC_CH3_EncObsMin| |Encoder monitoring minimum, sqrt(a^2+b^2)|
|581|ENC_CH3_AbsEncStatus| |Error and status codes (absolute encoder)|
|582|ENC_CH3_PeriodLen|nm|Length of signal period (Sin/Cos linear encoder)|
|583|ENC_CH3_DigitalResolution|nm|Length of one increment (linear absolute encoder)|
|636|ENC_CH3_CycleCount| |Sampling cycle in: n x 125 μ (microseconds)|
|639|ENC_CH3_NominalincrementA| |Sign. Nominal increment A (distance coded abs. encoder)|
|637|ENC_CH3_NominalincrementB| |Sign. Nominal increment B (distance coded abs. encoder)|

# Table 6.24: Parameters for channel 3 (X8) - Sin/Cos encoder

Some parameters (e.g. Sel, Num, Denom, Abs, Lines, MultiT, SingleT, CorrVal) are self-explanatory.

The Code and Mode parameters are described in Section ""SSI (cyclical) X7"" on page 69.

P 584[0] - ENC_CH3_MTBase = Minimum MultiTurn position

The MTBase parameter is used to set a position in the multi-turn encoder’s travel path that defines the point of discontinuity (overflow/underflow) for the absolute value initialization (that is, the “multi-turn basis”). Assuming a bipolar encoder measuring range, all position values that fall below MTBase will be shifted “up” (the whole MT range will be added to them once). This method makes it possible to place the point of discontinuity at any point within the encoder’s entire measuring range. By default, MTBase will be set to the lowest possible value for the parameter, i.e. reliably outside of the encoder’s value range: In this case, the full bipolar range will remain unaffected, as values will never fall below this MTBase threshold (see Section ""Channel 3: Interface X8 (optional)"" on page 76 as well).

P 585[0] - ENC_CH3_MTEnable = MultiTurn as SingleTurn

The MTEnable parameter makes it possible to use multi-turn encoders as single-turn encoders for test purposes. Negative logic: Default MTEnable = 0 means ""MultiTurn-Enable ON"".

P 586[0] - ENC_CH3_Corr = Signal correction type:

The GPOC routine used for track signal correction purposes for sine/cosine signals is used to compensate for systematic errors. The routine is controlled with the Corr and CorrVal parameters (see Section ""Signal correction GPOC (Gain Phase Offset Correction)"" on page 74).

P 577[0] - ENC_CH3_EncObsMin = Encoder monitoring minimum, sqrt(a^2+b^2)

The parameter EncObsMin is used to scale the Sin/Cos wire break monitoring and represents the “downwards threshold” for an error message. The default setting is 0.2, corresponding to approx. ",What is the purpose of the 'Signal correction (GPOC)' mentioned in the 'MSD ServoDrive - DeviceHelp' document?,"GPOC is a Moog online process for improving Sin/Cos signal quality before position calculation, controlled by Corr and CorrVal parameters.","It's a process to enhance Sin/Cos signal quality via gain, phase, and offset correction, managed by specific parameters for accurate position calculation.","GPOC corrects systematic errors in Sin/Cos signals using parameters like Corr and CorrVal, ensuring better position calculation accuracy.","The document describes GPOC as a method to correct Sin/Cos signals through gain, phase, and offset adjustments for precise positioning.","Aimed at improving signal quality, GPOC adjusts Sin/Cos signals via specified parameters to facilitate accurate position determination."
9,msd_servo_drive.txt,29,8b7b14207d0506f3f75c9a63fb98a68193e71ed0f7337bac8f26cb3596e2b576,"3: “TTL encoder simulation / TTL master encoder”
- No. 4: “SSI encoder simulation”
- No. 5: “TTL encoder with commutation signals”

NOTE

- For information on the connector, pinout, technical data, configuration, and the encoder models (if any) that can be evaluated with the included technology option, please consult the Specification specified in the “Documentation” column.

The following table shows how the X8 options that can be used for encoder evaluation can be identified and selected.

|“No.” column|As per the table above.|
|---|---|
|“Hardware ID” column|The texts in this column can be viewed in the Moog DRIVEADMINISTRATOR 5 using P 53[0] - DV_HwOptionX12ID by going to ►Drive description ►Hardware version if the corresponding technology option is present.|
|“Selection” column|In certain cases, several different encoder types can be run on a technology option and selected with P 507 - ENC_CH3_Sel. Even if a technology option that does not match is equipped, most values can only be selected with P 507 - ENC_CH3_Sel. If an impermissible combination is selected, this will be indicated by means of error messages during the initialization phase.|

MOOG ID No.:CB40859-001 Date:11/2020

MSD ServoDrive - DeviceHelp 77

# 6 Encoder

MOOG ID No.:CB40859-001 Date:11/2020

# MSD ServoDrive - DeviceHelp

|No.|Technology option name|Hardware ID|Selection|
|---|---|---|---|
|0|No module|NONE(0) - No technology option|OFF (0)|
| | |SINCOS(1) - Sin/Cos cyclic *)| |
| | |- Without absolute value interface, Abs=OFF(0), with zero pulse| |
| | |- With SSI one-time reading, Abs=SSI(1)| |
|1|Second Sin/Cos encoder|SINCOS_V2(10) - 2nd Sin/Cos encoder (V2)|- With EnDat one-time reading, Abs=ENDAT(2)|
| | |SSI(2) - Cyclical SSI (without analog tracks)| |
| | |TTL(3) - TTL evaluation, with zero pulse| |
| | |ENDAT(4) - Cyclical EnDat (without analog tracks)| |
|3|TTL encoder simulation / TTL master encoder|TTL_ECSIM_V2(9) - TTL Encodersimulation (V2)|TTL(3)|
|4|SSI encoder simulation|SSI_ECSIM(3) - SSI encodersimulation|SSI(2) - Cyclical SSI (without analog tracks)|
|5|TTL encoder with commutation signals|TTL_COM(11) - TTL + Hall option|TTL(3)|
| | |TTL_COM(5)| |

Table 6.19: Options for X8 interface that can be used to evaluate encoders via encoder channel Ch3

*) SINCOS(1) is set via the P 507[0] - ENC_CH3_Sel main interface. The auxiliary interface, P 570[0] - ENC_CH3_Abs, can be optionally used to set the one-time reading for the absolute position during initialization.

# NOTE

- Only one encoder with a purely digital EnDat or SSI interface can be used on connector X8 or X7.
- If two EnDat encoders are used and one of them is purely digital, it is necessary to ensure that the purely digital encoder is connected to X8. This is important, as the EnDat encoder with Sin/Cos tracks must be initialized before the purely digital encoder.

# Encoder Configuration

To see which technology option your Servo Drive features (if any), go to Project Select from database tree ► Device setup ► Drive description in Moog DRIVEADMINISTRATOR 5 and check under “Technology option” in the “Hardware” section.

# Encoder Name

You can use this field to enter your own information for describing the encoder (maximum of 31 characters) (P 580[0] - ENC_CH3_Info).

# Cyclic Position Via

This drop-down menu is used to select the “main interface” (P 507[0] - ENC_CH3_Sel).

# Pulses Per Revolution

Once SINCOS(1), TTL(3) or TTL_COM(5) is selected as the “main interface,” this field will appear so that you can enter the number of analog Sin/Cos tracks per revolution (TTL tracks as well).

# Absolute Interface

This drop-down menu is used to select the “auxiliary interface” (P 570[0] - ENC_CH3_Abs).

# Image 6.5: Encoder Configuration Channel 3 (X8) Screen

This screen is used to select the encoder for channel Ch3. This channel uses the encoder’s “main interface” to measure position changes periodically and add them up cyclically – this is referred to as “cyclical evaluation.”

Encoders with a main interface that only makes it possible to measure the cyclical position incrementally often feature an additional absolute value interface referred to as an “auxiliary interface.” For this interface, the absolute position is measured once during the initialization phase and is then used for absolute value initialization purposes.

# Note

l Selecting an “auxiliary interface” is redundant if, for example, SSI (2) is selected as the “main interface” (corresponds to cyclical evaluation via SSI). In this case, the absolute value initialization will also be carried out via the SSI interface, regardless of the selected “auxiliary interface.”

# Gear Ratio

These fields can be used to define a gear ratio for the encoder (in the output side). For more details, see Section ""Encoder gearing"" on page 89.

MOOG ID No.:CB40859-001 Date:11/2020

MSD ServoDrive - DeviceHelp 79

# 6 Encoder

MOOG ID No.:CB40859-001 Date:11/2020

# MSD ServoDrive - DeviceHelp

Signal correction (GPOC) l P 577[0] - ENC_CH3_EncObsMin

If you set EncObsMin to 0, Sin/Cos wire break monitoring will be disabled.

GPOC is a special Moog online process for improving the quality of Sin/Cos signals before they are used to calculate a position. If “SINCOS(1)” is selected as the “main interface,” this process may be useful. For details see Section ""Signal correction GPOC (Gain Phase Offset Correction)"" on page 74.

The default value is 0.2 (20%) and stands for a calculated amplitude value (calculated using the two Sin/Cos signals) of x = sqrt(a² + b²). If the Sin/Cos signals are equal to approx. 1 Vss when compared, approx. 0.8 will be calculated here (approx. 80% magnitude at the A-D converters; approx. 0.25 Vss Sin/Cos will yield approx. 0.2 here (20% magnitude at the A-D converter)). The error threshold can be adjusted with EncObsMin.

# 6.7.1 Main parameters for encoder channel Ch3

The following table lists the most important parameters for the Ch3 encoder channel. These parameters are described in the chapters that go over selecting the various encoders with P 507[0] - ENC_CH3_Sel and P 570[0] - ENC_CH3_Abs.

When used with its default setting, this parameter will ensure that the absolute value initialization “starts up with plus-minus”. I.e. the encoder’s multi-turn value range from 0 to max will be mapped to -½ max to +½ max. The range from +½ max to max will be initialized as negative; in this case, the point of discontinuity will be found at ½ max. This can be changed with MTBase. When MTBase = 0, the absolute value initialization will, for example, “start up with zero to max”. I.e. the encoder’s multi-turn value range from 0 to max will be mapped to 0 to max. The range from +½ max to max will be initialized as positive; in this case, the point of discontinuity will be found at 0.

l P 585[0] - ENC_CH3_MTEnable

If you set MTEnable to 1, you can use an available multi-turn rotary encoder as a single-turn rotary encoder, which can come in handy for testing purposes.

|P No.|Index|Name / Setting|Unit|Description|
|---|---|---|---|---|
|507|0|ENC_CH3_Sel| |Main selection on encoder channel Ch3|
|570|0|ENC_CH3_Abs| |Absolute value interface for one-time reading|
|572|0|ENC_CH3_Lines| |Number of analog Sin/Cos lines per revolution (TTL lines as well)|
|573|0|ENC_CH3_MultiT| |Number of multi-turn bits for the digital interface|
|574|0|ENC_CH3_SingleT| |Number of single-turn bits for the digital interface|
|575|0|ENC_CH3_Code| |Code selection (for SSI encoders) (binary, Gray)|
|576|0|ENC_CH3_Mode| |Mode selection (for SSI encoders)|
|583|0|ENC_CH3_|nm|Linear encoders: Length of a digital increment in|
|584|0|DigitalResolution|nm (nanometres)| |
|585|0|ENC_CH3_MTBase| |Definition of point of discontinuity in multi-turn range|
|636|0|ENC_CH3_MTEnable| |Enable MultiTurn use (negative logic, 1=MToff)|
|636|0|ENC_CH3_CycleCount| |Sampling cycle in: n x 125 μ (microseconds)|

NOTE: As there are various protocol modes available for SSI encoders (with/without wire break monitoring, with/without parity bit, etc.), consult with your project supervisor or the Helpline provided by Moog before using any special SSI protocol modes.

As the functionality of the parameters for encoder channel Ch3 is predominantly identical to that of the parameters for encoder channel Ch1, it is recommended to read the description for the Ch1 encoder channel parameters.

Accordingly, the following table starts by listing all the parameters for the Ch3 encoder channel. If the functionality of a parameter is different from that of the corresponding parameter for encoder channel Ch1, the parameter will be described in the chapters that go over selecting a special encoder with (507) ENC_CH3_Sel and (570) ENC_CH3_Abs.

Parameters Lines, MultiT, SingleT, etc. are self-explanatory. Most of the following parameters are explained in the information for encoder channel Ch1 (see Section ""Channel 1: Interface X7"" on page 59).

# Table 6.21: Encoder configuration channel 3 (X8) parameters

|ID|Index|Name|Unit|Description|
|---|---|---|---|---|
|349|0|CON_FM_MConOffset| |Commutation offset|
|502|0..3|ENC_CH3_ActVal| |Current position value at encoder channel Ch3 output|
|507|0|ENC_CH3_Sel| |Main selection on encoder channel Ch3|
|514|0|ENC_CH3_Num| |Encoder gearing: Numerator|
|515|0|ENC_CH3_Denom| |Encoder gearing: Denominator|
|520|0|ENC_MCon| |=3, channel selection for motor commutation|
|521|0|ENC_SCon| |=3, channel selection for speed control|
|522|0|ENC_PCon| |=3, channel selection for position control|
|570|0|ENC_CH3_Abs| |Absolute value interface selection (one-time reading)|
|571|0|ENC_CH3_NpTest| |TEST-MODE: Index pulse signal(s) to Scope|
|572|0|ENC_CH3_Lines| |Number of Lines (Sin/Cos / TTL encoders)|
|573|0|ENC_CH3_MultiT| |Number of MultiTurn bits (absolute encoder)|
|574|0|ENC_CH3_SingleT| |Number of SingleTurn bits (absolute encoder)|
|574|0|ENC_CH3_Code| |Code selection (SSI encoder) (binary, gray)|
|576|0|ENC_CH3_Mode| |Mode selection (SSI encoder)|
|577|0|ENC_CH3_EncObsMin| |Encoder monitoring minimum, sqrt (a^2+b^2)|
|578|0|ENC_CH3_Extended| |(a^2 + b^2) ENC CH3: Extended|
|580|0|ENC_CH3_Info| |Encoder information channel 3|
|581|0|ENC_CH3_AbsEncStatus| |Error and status codes (absolute encoder)|
|582|0|ENC_CH3_PeriodLen|nm|Length of signal period (Sin/Cos linear encoder)|

# Encoder configuration channel 3 (X8) parameters (continue)

|Index|Name|Unit|Description|
|---|---|---|---|
|0|ENC_CH3_|nm|Length of one increment (linear absolute encoder)|
|0|DigitalResolution| | |
|0|ENC_CH3_MTBase| |Definition of point of discontinuity in multi-turn range|
|0|ENC_CH3_MTEnable| |Enable MultiTurn use (negative logic, 1=MToff)|
|0|ENC_CH3_Corr| |Signal correction type|
|0..4|ENC_CH3_CorrVal| |Signal correction values|
|0|ENC_CH3_EncObsAct| |Amplitude of analog signals (vector length)|
|0|ENC_CH3_HallLayout| |Hall pattern selection|
|0|ENC_CH3_Position|inc|Position encoder channel 3|
|0|ENC_CH3_Period|ms|Maximum period of interpolation (ttl encoder)|
|0|ENC_CH3_EncOnsActTF|ms|Filter time constant for amplitude of analog signals|
|0|ENC_CH3_|Sign.|Nominal increment A (distance coded abs. encoder)|
|0|ENC_CH3_|Sign.|Nominal increment B (distance coded abs. encoder)|
|0|ENC_CH3_CycleCount| |Position encoder sampling cycle (n x 125 μsec)|
|0|ENC_CH3_AbsInitMode| |Mode absolute value formation|
|0..29|ENC_ENDAT| |EnDat additional|
|0|ENC_Warning| |Encoder warning (e.g. from encoder internal memory)|
|0|ENC_Warning| |Encoder warning reset (e.g. in encoder internal memory)|
|0|ENC_Error| |Encoder error (e.g. from encoder internal memory)|
|0|ENC_ErrorReset| |Encoder error reset (e.g. in encoder internal memory)|
|0|ENC_ETS| |ETS mode, electronic nameplate|
|0|ENC_ETS_CTRL| |ETS control, electronic nameplate|
|0..15|ENC_ETS_STAT| |ETS status, electronic nameplate|
|0..511|ENC_ETS_DATA| |ETS data, electronic nameplate|
|0|ENC_CH3_TTL_| |TTL signal type selection|

# 6 Encoder

MOOG ID No.:CB40859-001 Date:11/2020

# 6.7.2 Absolute value interfaces X8

The following absolute value interfaces will be available at encoder channel Ch3 depending on the X8 option being used.

- Cyclical Sin/Cos with SSI one-time reading via X8 option: SINCOS_V2(10) - 2nd Sin/Cos encoder (V2)
- Cyclical Sin/Cos with EnDat one-time reading via X8 option: SINCOS_V2(10) - 2nd Sin/Cos encoder (V2)
- Cyclical SSI via X8 options: SINCOS_V2(10) - 2nd Sin/Cos encoder (V2) or SSI_ECSIM(3) - SSI encoder simulation
- Cyclical EnDat via X8 option: SINCOS_V2(10) - 2nd Sin/Cos encoder (V2)

See also table in Section ""Channel 3: Interface X8 (optional)"" on page 76. They can be selected with P 507[0] - ENC_CH3_Sel and P 570[0] - ENC_CH3_Abs. For more details, see Section ""Main parameters for encoder channel Ch3"" on page 80.

# 6.7.3 EnDat (cyclical) X8

Ch3: ENDAT(4) - Cyclical EnDat (2.1 or 2.2)

As the EnDat functionality of the parameters for encoder channel Ch3 is predominantly identical to that of the parameters for encoder channel Ch1, it is recommended to read the description for the Ch1 encoder channel parameters (see Section ""EnDat (cyclical) X7"" on page 61).

The software versions required to run the EnDat interface are the standard software versions for the MSD Servo Drive and MSD Single-Axis Servo Drive Compact.

NOTE

- Please note the limitations that apply when running EnDat and SSI encoders (see Section ""Limiting for EnDat and SSI"" on page 52).

|ID|Index|Name|Unit|Description|
|---|---|---|---|---|
|507|0|ENC_CH3_Sel|= 4|= ENDAT(4)|
|573|0|ENC_CH3_MultiT|Number of MultiTurn bits (absolute encoder)| |
|574|0|ENC_CH3_SingleT|Number of SingleTurn bits (absolute encoder)| |
|584|0|ENC_CH3_MTBase|Definition of point of discontinuity in multi-turn| |
|585|0|ENC_CH3_MTEnable|range|1: Use Multi-turn encoder as a single-turn encoder|
|636|0|ENC_CH3_CycleCount|Position encoder sampling cycle (n x 125 μsec)| |
|600|0|ENC_CH3_Position|inc|Position encoder channel 3|
|583|0|ENC_CH3_|nm|Length of one increment (linear absolute encoder)|
|640|0..29|DigitalResolution| | |

Table 6.22: ENC_ENDAT Channel 3 encoder configuration (X8) - EnDat (cyclical) parameters

# 6.7.4 Hall sensor X8

Encoder channel Ch3 does not support Hall effect sensors!

# 6.7.5 Sin/Cos / TTL X8

# 6.7.5.1 TTL encoder

Ch3: TTL(3) - TTL signals

TTL encoders are ...

1. ... usually pure incremental encoders without an absolute value interface. In this case, P 570[0] - ENC_CH3_Abs must be set to OFF(0).
2. ... in a few exceptional cases, incremental encoders with an SSI absolute value interface. In this case, P 570[0] - ENC_CH3_Abs must be accordingly set to SSI(1) so that it will be possible to read the absolute encoder position for the absolute value initialization routine once during the initialization phase.

# 6.7.5.1.1 Pure TTL incremental encoder

A maximum interpolation period, in ms (milliseconds), can be configured for the TTL interface using P 602[0] - ENC_CH3_Period. Within this context, Period is the maximum time of “no activity” since the last TTL counter event:

- Period = 0: Function disabled (default)
- Period > 0 (=n ms): If no counter event is registered in n ms, the speed will be set to 0.

# Zero pulse

There is no parameter for activating the zero pulse evaluation here, as this evaluation is controlled based exclusively on the homing mode (see Section ""Homing"" on page 249). However, setting P 571[0] - ENC_CH3_NpTest to 1 provides a test mode that can be used during commissioning in order to be able to activate the zero pulse evaluation even without homing. Scope signals 1034 and 1036 can be used to view a received zero pulse within this context. This test mode must be disabled during normal operation (P 571[0] = 0).

# Commutation

Motor operation with pure incremental encoders needs for the auto commutation function to be enabled without fail. For details see Section ""Synchronous motor auto commutation"" on page 156.

# 6.7.5.1.2 TTL incremental encoder with SSI absolute value interface

see Section ""Sin/Cos incremental encoders with absolute value interface"" on page 84 and in special Section ""SSI absolute value interface"" on page 86.

MOOG ID No.:CB40859-001 Date:11/2020

MSD ServoDrive - DeviceHelp

# 6 Encoder

MOOG ID No.:CB40859-001 Date:11/2020

MSD ServoDrive - DeviceHelp 84

|ID|Index Name|Unit|Description|
|---|---|---|---|
|507|0|ENC_CH3_Sel = 3|Encoder selection set to TTL(3)|
|514|0|ENC_CH3_Num|Encoder gearing: Numerator|
|515|0|ENC_CH3_Denom|Encoder gearing: Denominator|
|570|0|ENC_CH3_Abs|Selection of absolute value interface|
|571|0|ENC_CH3_NpTest|ENC CH1, TEST-MODE: Index pulse signal(s) to Scope|
|572|0|ENC_CH3_Lines|Number of lines (Sin/Cos / TTL encoders)|
|2842|0|ENC_CH3_TTL_SignalType|Channel 3: TTL signal selection|
|602|0|ENC_CH3_Period|Maximum period of interpolation (ttl encoder)|
|636|0|ENC_CH3_CycleCount|Sampling cycle in: n x 125 μ (microseconds)|

# Table 6.23: Parameters for Channel 3 (X8) - TTL encoder

6.7.5.2.2 Linear Sin/Cos incremental encoders

Linear Sin/Cos encoders are operated as rotary encoders. For linear motor operation, P 572[0] - ENC_CH3_Lines and the encoder gearing (see Section ""Encoder gearing"" on page 89) are used to establish the ratio for the linear motor’s pole pair subdivision (North-North) for commutation. 1 x North-North corresponds to one revolution from Lines. In this case, the motor pole pair number must be set to 1. P 582[0] - ENC_CH3_PeriodLen is not used in this case.

# 6.7.5.2 Sin/Cos encoder

Ch3: SINCOS(1) - Sin/Cos signals

Sin/Cos encoders can ...

1. Be pure incremental encoders without an absolute value interface. In this case, P 570[0] - ENC_CH3_Abs must be set to OFF(0).
2. Be incremental encoders with an absolute value interface. In this case, P 570[0] - ENC_CH3_Abs must be accordingly set to SSI(1) or EnDat(2) so that it will be possible to read the absolute encoder position for the absolute value initialization routine once during the initialization phase.

# 6.7.5.2.1 Purely Sin/Cos incremental encoders

To run these encoders as pure incremental encoders with a zero pulse on encoder channel Ch3 (without an absolute value interface), the approach is basically the same as for pure TTL operation (see Section ""TTL encoder"" on page 82). The same parameters apply. However, there are the following differences:

# 6.7.5.2.4 Sin/Cos incremental encoders with absolute value interface

The following table lists the parameters for cyclical Sin/Cos operation on encoder channel Ch 3 with one-time reading of the absolute encoder position via the absolute value interface, i.e. without a zero pulse:

|ID|Index Name|Unit|Description|
|---|---|---|---|
|507|ENC_CH3_Sel|1|Encoder selection set to SINCOS(1)|
|514|ENC_CH3_Num| |Encoder gearing: Numerator|
|515|ENC_CH3_Denom| |Encoder gearing: Denominator|
|570|ENC_CH3_Abs| |Absolute value interface selection (one-time reading)|
|572|ENC_CH3_Lines| |Number of Lines (Sin/Cos / TTL encoders)|
|573|ENC_CH3_MultiT| |Number of MultiTurn bits (absolute encoder)|
|574|ENC_CH3_SingleT| |Number of SingleTurn bits (absolute encoder)|
|575|ENC_CH3_Code| |Code selection (SSI encoder) (binary, gray)|
|576|ENC_CH3_Mode| |Mode selection (SSI encoder)|
|584|ENC_CH3_MTBase| |Definition of point of discontinuity in multi-turn range|
|585|ENC_CH3_MTEnable| |Enable MultiTurn use (negative logic, 1=MToff)|
|586|ENC_CH3_Corr| |Signal correction type|
|587|ENC_CH3_CorrVal| |Signal correction values|
|577|ENC_CH3_EncObsMin| |Encoder monitoring minimum, sqrt(a^2+b^2)|
|581|ENC_CH3_AbsEncStatus| |Error and status codes (absolute encoder)|
|582|ENC_CH3_PeriodLen|nm|Length of signal period (Sin/Cos linear encoder)|
|583|ENC_CH3_DigitalResolution|nm|Length of one increment (linear absolute encoder)|
|636|ENC_CH3_CycleCount| |Sampling cycle in: n x 125 μ (microseconds)|
|639|ENC_CH3_NominalincrementA| |Sign. Nominal increment A (distance coded abs. encoder)|
|637|ENC_CH3_NominalincrementB| |Sign. Nominal increment B (distance coded abs. encoder)|

# Table 6.24: Parameters for channel 3 (X8) - Sin/Cos encoder

Some parameters (e.g. Sel, Num, Denom, Abs, Lines, MultiT, SingleT, CorrVal) are self-explanatory.

The Code and Mode parameters are described in Section ""SSI (cyclical) X7"" on page 69.

P 584[0] - ENC_CH3_MTBase = Minimum MultiTurn position

The MTBase parameter is used to set a position in the multi-turn encoder’s travel path that defines the point of discontinuity (overflow/underflow) for the absolute value initialization (that is, the “multi-turn basis”). Assuming a bipolar encoder measuring range, all position values that fall below MTBase will be shifted “up” (the whole MT range will be added to them once). This method makes it possible to place the point of discontinuity at any point within the encoder’s entire measuring range. By default, MTBase will be set to the lowest possible value for the parameter, i.e. reliably outside of the encoder’s value range: In this case, the full bipolar range will remain unaffected, as values will never fall below this MTBase threshold (see Section ""Channel 3: Interface X8 (optional)"" on page 76 as well).

P 585[0] - ENC_CH3_MTEnable = MultiTurn as SingleTurn

The MTEnable parameter makes it possible to use multi-turn encoders as single-turn encoders for test purposes. Negative logic: Default MTEnable = 0 means ""MultiTurn-Enable ON"".

P 586[0] - ENC_CH3_Corr = Signal correction type:

The GPOC routine used for track signal correction purposes for sine/cosine signals is used to compensate for systematic errors. The routine is controlled with the Corr and CorrVal parameters (see Section ""Signal correction GPOC (Gain Phase Offset Correction)"" on page 74).

P 577[0] - ENC_CH3_EncObsMin = Encoder monitoring minimum, sqrt(a^2+b^2)

The parameter EncObsMin is used to scale the Sin/Cos wire break monitoring and represents the “downwards threshold” for an error message. The default setting is 0.2, corresponding to approx. ",What parameters are listed as most important for the Ch3 encoder channel in the 'MSD ServoDrive - DeviceHelp' document?,"Key parameters include P 507[0] - ENC_CH3_Sel, P 570[0] - ENC_CH3_Abs, P 572[0] - ENC_CH3_Lines, and P 585[0] - ENC_CH3_MTEnable, among others.","The document highlights ENC_CH3_Sel, ENC_CH3_Abs, ENC_CH3_Lines, and ENC_CH3_MTEnable as crucial for configuring the Ch3 encoder channel.","Important parameters for Ch3 are the main and auxiliary interface selections, lines per revolution, and multi-turn enable settings.","For Ch3, essential parameters cover encoder selection, absolute interface, lines count, and multi-turn functionality configurations.","The most important Ch3 parameters involve encoder type selection, absolute position interface, track lines, and multi-turn usage options."
